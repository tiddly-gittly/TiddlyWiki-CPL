{"title":"$:/plugins/oeyoews/notebook-theme-sidebar-resizer","description":"notebook-theme-sidebar-resizer","author":"oeyoews","version":"0.3.0","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"notebook theme sidebar resizer","meat#disabled":"yes","qrcode":"yes","created":"2023-12-19","list":"readme","dependents":"","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/readme\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/readme\",\"text\":\"!! Notebook theme sidebar resizer\\n\\n> support left/right sidebar resizer\\n\\n> 可拖动调整侧边栏宽度.\\n\\n> 最初仅仅是为了支持 notebook theme 而写的 sidebar resizer, 后来开始支持 vanilla(and based vanilla sidebar theme), captivate, whitespace, leftbar 等插件, 布局或主题.\\n\\n<!-- 在切换主题时，theme 会覆盖掉同名非系统文件，所以需要手动修改 -->\\n\\n!! For Leftbar\\n\\nneed add `<$nbresizer position=\\\"left\\\" widthTiddler=\\\"$:/xp/leftopentab/metrics/width\\\" statusTiddler=\\\"$:/config/LeftOpenTab/Status\\\" close=\\\"hide\\\"/>` in [[$:/xp/ui/PageTemplate/leftsidebar]] tiddler.\\n\\n```html\\n<!-- here -->\\n<$nbresizer position=\\\"left\\\" widthTiddler=\\\"$:/xp/leftopentab/metrics/width\\\" statusTiddler=\\\"$:/config/LeftOpenTab/Status\\\" close=\\\"hide\\\"/>\\n\\n</$scrollable>\\n\\n</$reveal>\\n```\\n\\n!! For captivate theme\\n\\nneed add `<$nbresizer />` in [[$:/themes/cdr/captivate/ui/SideBar]] tiddler.\\n\\n```html\\n<<sidebarTabs>>\\n<!-- here -->\\n<$nbresizer />\\n```\\n\\n!! For Whitespace theme\\n\\n> whitespace theme for two 5.1.17 and 5.1.22 version, if use latest version, maybe have some ui problems.\\n\\nneed add `<$nbresizer />` in [[$:/themes/jd/Whitespace/template/sidebar]] tiddler.\\n\\n```html\\n<!-- add resizer widget here  -->\\n\\n<$transclude/>\\n<$nbresizer />\\n```\\n\\n> 如果你在不同的主题切换, 你会发现一些 UI 上的异常, 那是因为 这个 tiddler 被修改后变成了 shadow tiddler, 在所有的主题下都会起作用.\\n\\n!! Recipes\\n\\n* 之所以部分主题需要手动修改 tiddler, 是因为他们的 sidebar 模板是写死的, 无法通过动态嵌入 tiddler. 这一点建议 学习 notebook theme\\n\\n!! TODO\\n\\n* resizer widget 暴露出对应的参数, 支持用户自定义\"},\"$:/themes/nico/notebook/ui/Sidebar/resizer\":{\"title\":\"$:/themes/nico/notebook/ui/Sidebar/resizer\",\"tags\":\"$:/themes/nico/notebook/tags/Sidebar $:/tags/SideBarSegment\",\"text\":\"<$nbresizer />\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/default-sidebar-width\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/default-sidebar-width\",\"text\":\"300px\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/en.js\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/en.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/en.js\\ntype: application/javascript\\nmodule-type: library\\n\\nnotebook-theme-sidebar-resizer locale en\\n\\\\*/\\nmodule.exports={pluginname:\\\"notebook-theme-sidebar-resizer\\\",warning:\\\"[notebook-theme-sidebar-resizer]: requires the 'tiddlywiki/tailwindcss-plus' plugin to be installed\\\"};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/zh.js\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/zh.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/notebook-theme-sidebar-resizer/locales/zh.js\\ntype: application/javascript\\nmodule-type: library\\n\\nnotebook-theme-sidebar-resizer locale zh\\n\\\\*/\\nmodule.exports={pluginname:\\\"侧边栏宽度调整插件\\\",warning:\\\"需要安装 tailwindcss\\\"};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/style.css\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/style.css\",\"text\":\".oresizer-left {\\n  left: 0;\\n}\\n.oresizer-right {\\n  right: 0;\\n}\\n\\n.oresizer {\\n  width: 5px;\\n  border-radius: 5px;\\n  height: 100%;\\n  position: absolute;\\n  top: 0;\\n  background-color: #f3f4f6;\\n  animation-duration: 200ms;\\n}\\n\\n.oresizer:hover {\\n  cursor: e-resize;\\n  background-color: #e5e7eb;\\n  transition: all;\\n}\\n\\n.dark .oresizer {\\n  background-color: #6b7280;\\n}\\n.dark .oresizer:hover {\\n  background-color: #9d9fa4;\\n}\\n\",\"type\":\"text/css\",\"tags\":\"$:/tags/Stylesheet\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nnotebook-theme-sidebar-resizer widget\\n\\\\*/\\nconst{widget:t}=require(\\\"$:/core/modules/widgets/widget.js\\\");require(\\\"./locales/en\\\"),exports.nbresizer=class extends t{constructor(t,e){super(t,e),this.leftClass=\\\"oresizer-left\\\",this.rightClass=\\\"oresizer-right\\\",this.VANILLA=\\\"vanilla\\\",this.NOTEBOOK=\\\"notebook\\\",this.LEFT=\\\"left\\\",this.RIGHT=\\\"right\\\",this.defaultWidthTiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth\\\",this.nbWidthTiddler=\\\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/default-sidebar-width\\\",this.themeTiddler=\\\"$:/theme\\\",this.theme=null,this.isResizing=!1,this.width=0,this.defaultStateTiddler=\\\"$:/state/sidebar\\\",this.notebook={name:\\\"NOTEBOOK\\\",theme:[\\\"$:/themes/nico/notebook\\\",\\\"$:/themes/oeyoews/notebook-plus\\\"],stateTiddler:\\\"$:/state/notebook-sidebar\\\",widthTiddler:\\\"$:/themes/nico/notebook/metrics/sidebar-width\\\",positionTiddler:\\\"$:/themes/nico/notebook/metrics/sidebar-position\\\"},this.whitespace={name:\\\"WHITESPACE\\\",theme:\\\"$:/themes/jd/Whitespace\\\",positionTiddler:\\\"$:/config/Whitespace/sidebar\\\",widthTiddler:this.defaultWidthTiddler},this.sidebarLayoutTiddler=\\\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\\\",this.user={widthTiddler:\\\"\\\",statusTiddler:\\\"\\\",close:\\\"\\\"},this.listenTiddlers=[this.notebook.positionTiddler,\\\"$:/language\\\",\\\"$:/layout\\\",this.themeTiddler,this.whitespace.positionTiddler,this.sidebarLayoutTiddler,this.user.statusTiddler],this.position=this.RIGHT}render(t,e){if(!$tw.browser)return;this.parentDomNode=t,this.computeAttributes(),this.execute();const i=$tw.utils.domMaker;this.checkTheme(),this.updatePosition(),this.presetForVanillaTheme();const{position:s,widthTiddler:h,close:d,statusTiddler:o}=this.attributes;s&&(this.position=s),h&&(this.user.widthTiddler=h),d&&(this.user.close=d),o&&(this.user.statusTiddler=o);const r=i(\\\"div\\\",{class:\\\"oresizer\\\"});this.LEFT===this.position?r.classList.add(this.rightClass):r.classList.add(this.leftClass),r.addEventListener(\\\"pointerdown\\\",(t=>{t.preventDefault(),this.isResizing=!0,document.addEventListener(\\\"pointermove\\\",(t=>this.resize(t))),document.addEventListener(\\\"pointerup\\\",(t=>this.stopResize(t)))})),t.insertBefore(r,e),this.domNodes.push(r)}checkTheme(){switch(this.getText(this.themeTiddler)||this.VANILLA){case this.notebook.theme[0]:case this.notebook.theme[1]:this.theme=this.notebook.name;break;case this.whitespace.theme:this.theme=this.whitespace.name;break;case this.VANILLA:this.theme=this.VANILLA}}presetForVanillaTheme(){const t=this.getText(this.sidebarLayoutTiddler);this.theme===this.VANILLA&&\\\"fluid-fixed\\\"!==t&&(console.warn(\\\"you should set sidebar layout to fluid-fixed\\\"),$tw.wiki.setText(this.sidebarLayoutTiddler,\\\"text\\\",null,\\\"fluid-fixed\\\"))}updatePosition(){if(\\\"$:/themes/cdr/captivate\\\"!==this.getText(this.themeTiddler))switch(this.theme){case this.whitespace.name:$tw.wiki.tiddlerExists(this.whitespace.positionTiddler)||(this.position=this.LEFT),this.position=this.getText(this.whitespace.positionTiddler);break;case this.notebook.name:if($tw.wiki.tiddlerExists(this.notebook.positionTiddler)){const{position:t=this.LEFT}=$tw.wiki.getTiddler(this.notebook.positionTiddler).fields;this.position=t}else this.position=this.LEFT;break;case this.VANILLA:this.position=this.RIGHT}else this.position=this.LEFT}getDefaultSidebarWidth(){return this.getText(this.nbWidthTiddler).replace(\\\"px\\\",\\\"\\\")}getText(t){return $tw.wiki.getTiddlerText(t)}resize(t){const e=t.clientX;if(this.isResizing){if(this.position===this.LEFT?this.width=e:this.width=window.innerWidth-e,this.width/window.innerWidth>.5)return;if(this.width/window.innerWidth<.05)return this.closeSidebar(),void(this.isResizing=!1);this.updateSidebarWidth(this.width)}}stopResize(t){this.isResizing=!1,document.removeEventListener(\\\"pointermove\\\",(t=>this.resize(t)))}closeSidebar(){let t=this.theme===this.notebook.name?this.notebook.stateTiddler:this.defaultStateTiddler;this.user.statusTiddler?(t=this.user.statusTiddler,$tw.wiki.setText(t,\\\"text\\\",null,this.user.close)):($tw.wiki.setText(t,\\\"text\\\",null,\\\"no\\\"),this.updateSidebarWidth(this.getDefaultSidebarWidth()))}updateSidebarWidth(t){let e=this.theme===this.notebook.name?this.notebook.widthTiddler:this.defaultWidthTiddler;this.user.widthTiddler&&(e=this.user.widthTiddler),requestAnimationFrame((()=>{$tw.wiki.setText(e,null,null,`${Number(t).toFixed(0)}px`,{suppressTimestamp:!0})}))}\\n/*   checker() {\\n    const logger = new $tw.utils.Logger(en.pluginname);\\n    if (!$tw.modules.titles['tailwindcss.min.js']) {\\n      logger.alert(en.warning);\\n    }\\n  }\\n */shouldRefresh(t,e){const i=Object.keys(t);return e.some((t=>i.includes(t)))}refresh(t){return!!this.shouldRefresh(t,this.listenTiddlers)&&(this.refreshSelf(),!0)}};\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}