{"title":"$:/plugins/oeyoews/vue-copy","description":"vue-copy","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"vue-copy","meat#disabled":"yes","qrcode":"yes","created":"2024-03-21","dependents":"$:/plugins/oeyoews/neotw-vue3 $:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/vue-copy/templates/app.vue\":{\"text\":\"<template>\\n  <div>\\n    <div class=\\\"flex gap-2\\\">\\n      <button @click=\\\"fetchClipboard\\\">点击读取粘贴板内容</button>\\n      <button @click=\\\"clean\\\" :disabled=\\\"clipboardContent === ''\\\">清空内容 </button>\\n      <button @click=\\\"importTiddler\\\" :disabled=\\\"clipboardContent === ''\\\">\\n        导入\\n      </button>\\n      <button @click=\\\"importTiddler\\\" :disabled=\\\"clipboardContent === ''\\\">\\n        导入并编辑\\n      </button>\\n    </div>\\n\\n    <!-- <title v-model=\\\"title\\\">\\n      {{title}}\\n    </title> -->\\n\\n    <!-- // 使用 modal 的形式？？？ -->\\n    <Transition>\\n      <div v-show=\\\"clipboardContent\\\">\\n        <h3>粘贴板内容预览：</h3>\\n        <h2></h2>\\n        <div\\n          class=\\\"antialiased prose prose-gray max-w-none prose-img:my-0 prose-a:no-underline prose-h2:mt-4 prose-blockquote:not-italic dark:prose-invert dark:prose-pre:bg-[#282c34] dark:prose-pre:text-white prose-p:mt-0\\\">\\n          <p v-html=\\\"html\\\"></p>\\n        </div>\\n    </Transition>\\n\\n  </div>\\n  </div>\\n</template>\",\"title\":\"$:/plugins/oeyoews/vue-copy/templates/app.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/vue-copy/plugins/TiddlyWikiVue.js\":{\"text\":\"module.exports = {\\n  install(app, options) {\\n    app.component('TiddlyWikiVue', {\\n      template: `<button> {{ msg }} </button>`,\\n      props: {\\n        msg: String\\n      }\\n    });\\n  }\\n};\\n\",\"title\":\"$:/plugins/oeyoews/vue-copy/plugins/TiddlyWikiVue.js\",\"module-type\":\"library\",\"type\":\"application/javascript\"},\"$:/plugins/oeyoews/vue-copy/components/Version.js\":{\"text\":\"module.exports = {\\n  name: 'Version',\\n  props: {\\n    version: {\\n      type: String,\\n      default: '5.3.2'\\n    }\\n  },\\n  template: `<span> {{ version }} </span>`\\n};\\n\",\"title\":\"$:/plugins/oeyoews/vue-copy/components/Version.js\",\"module-type\":\"library\",\"type\":\"application/javascript\"},\"$:/plugins/oeyoews/vue-copy/readme\":{\"title\":\"$:/plugins/oeyoews/vue-copy/readme\",\"description\":\"vue-copy\",\"text\":\"WIP\\n\\n<!-- plugin template readme -->\\n\\n<!-- !! Motivation -->\\n\\n<!-- your plugin motivation, or why you write this plugin -->\\n\"},\"$:/plugins/oeyoews/vue-copy/app.js\":{\"title\":\"$:/plugins/oeyoews/vue-copy/app.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-copy/app.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\n\\nconst { ref } = window.Vue;\\nconst clipboardTiddler = '$:/temp/oeyoews/clipboard';\\nconst getTemplate = require('$:/plugins/oeyoews/neotw-vue3/getTemplate.js');\\n\\nconst Version = require('./components/Version');\\n\\nconst app = () => {\\n  const component = {\\n    setup() {\\n      const clipboardContent = ref('');\\n      const html = ref('');\\n      const title = ref('');\\n\\n      // watch(title, (newVal) => { })\\n\\n      return {\\n        ref,\\n        html,\\n        title,\\n        clipboardContent,\\n      };\\n    },\\n\\n    methods: {\\n      clean() {\\n        this.html = '';\\n        $tw.wiki.deleteTiddler(clipboardTiddler);\\n        this.clipboardContent = '';\\n      },\\n      importTiddler() {\\n        $tw.rootWidget.dispatchEvent({\\n          type: 'tm-navigate',\\n          navigateTo: clipboardTiddler,\\n        });\\n\\n        new $tw.Story().navigateTiddler(clipboardTiddler);\\n      },\\n      fetchClipboard() {\\n        if (!navigator.clipboard?.readText) {\\n          console.error('当前浏览器不支持读取粘贴板内容');\\n          return;\\n        }\\n        navigator.clipboard\\n          .readText()\\n          .then((clipText) => {\\n            if (!clipText.trim()) return;\\n            if (clipText === this.clipboardContent) return;\\n\\n            $tw.wiki.setText(clipboardTiddler, 'text', null, clipText);\\n\\n            this.clipboardContent = clipText;\\n            this.html = $tw.wiki.renderTiddler('text/html', clipboardTiddler);\\n          })\\n\\n          .catch((error) => {\\n            console.error('读取粘贴板内容时出错：', error.message);\\n          });\\n      },\\n    },\\n\\n    template: getTemplate('$:/plugins/oeyoews/vue-copy/templates/app.vue'),\\n\\n    components: {\\n      Version,\\n    },\\n  };\\n  return component;\\n};\\n\\nmodule.exports = app;\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/vue-copy/widget.js\":{\"title\":\"$:/plugins/oeyoews/vue-copy/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-copy/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nvue-copy widget\\n\\n\\\\*/\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\n\\nclass ExampleWidget extends Widget {\\n  constructor(parseTreeNode, options) {\\n    super(parseTreeNode, options);\\n  }\\n\\n  render(parent, nextSibling) {\\n    if (!$tw.browser) return;\\n\\n    this.computeAttributes();\\n    this.execute();\\n\\n    const ssr = this.document.isTiddlyWikiFakeDom;\\n    if (ssr) return;\\n\\n    const vuelib = '$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js';\\n\\n    if (!window.Vue) {\\n      window.Vue = require(vuelib);\\n    }\\n\\n    const { createApp } = window.Vue;\\n    const component = require('./app');\\n    const domNode = this.document.createElement('div');\\n    const TiddlyWikiVue = require('./plugins/TiddlyWikiVue');\\n\\n    try {\\n      const app = createApp(component());\\n\\n      app.use(TiddlyWikiVue);\\n\\n      app.config.errorHandler = (err) => {\\n        const text = `[Vue3](${app.version}): ` + err;\\n        console.error(text);\\n        domNode.textContent = text;\\n        domNode.style.color = 'red';\\n      };\\n\\n      // 挂载\\n      app.mount(domNode);\\n\\n      parent.insertBefore(domNode, nextSibling);\\n      this.domNodes.push(domNode);\\n    } catch (e) {\\n      console.error(e.message);\\n    }\\n  }\\n\\n  // TIP: 界面由 vue 接管， 不要在这里刷新\\n  refresh() {\\n    return false;\\n  }\\n}\\n\\n/** @description vue-copy widget */\\nexports['vue-copy'] = ExampleWidget;\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}