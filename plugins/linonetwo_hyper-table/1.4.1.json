{"author":"LinOnetwo","core-version":">=5.1.22","dependents":"","description":"Present large amounts of data beautifully and efficiently, generate pivot tables and other advanced table presentations for tiddlers.","list":"readme ParametersTable tree","plugin-type":"plugin","text":"{\"tiddlers\":{\"$:/plugins/linonetwo/hyper-table/ParametersTable\":{\"title\":\"$:/plugins/linonetwo/hyper-table/ParametersTable\",\"caption\":\"<<lingo ParametersTable/Caption $:/plugins/linonetwo/hyper-table/language/>>\",\"text\":\"\\\\define lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\n<<lingo ParametersTable>>\\n\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/ParametersTable\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/ParametersTable\",\"text\":\"\\\\procedure lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\\\procedure columns()\\n  [\\n    {\\n      field: 'field',\\n      title: 'Options Field',\\n      width: 'auto',\\n      sort: true,\\n    },\\n    {\\n      field: 'description',\\n      title: 'Description',\\n      width: 400,\\n      style: {\\n        // wrap text take effect only when `defaultRowHeight` is enabled\\n        autoWrapText: true,\\n      },\\n    },\\n    {\\n      field: 'example',\\n      title: 'Example usage',\\n      width: 400,\\n      style: {\\n        autoWrapText: true,\\n      },\\n    },\\n    {\\n      field: 'url',\\n      title: 'Document URL',\\n      width: 'auto',\\n      cellType: 'link',\\n      sort: true,\\n    },\\n    {\\n      field: 'title',\\n      title: 'Tiddler',\\n      width: 300,\\n      style: {\\n        autoWrapText: true,\\n      },\\n    },\\n  ]\\n\\\\end\\n\\n!!! BasicTable\\n\\n<$basic-table\\n  filter=\\\"[all[shadows]prefix[$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/]tag[BasicTable]]\\\"\\n  columns=<<columns>>\\n  options=\\\"{ defaultRowHeight: 60 }\\\"\\n/>\\n\\n!!! PivotTable\\n\\n<$basic-table\\n  filter=\\\"[all[shadows]prefix[$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/]tag[PivotTable]]\\\"\\n  columns=<<columns>>\\n  options=\\\"{ defaultRowHeight: 60 }\\\"\\n/>\\n\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/basic-columns\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/basic-columns\",\"tags\":\"BasicTable\",\"field\":\"columns\",\"description\":\"Table column configuration, each column needs to set configuration items separately, and the configuration items differ slightly depending on the cellType. cellType can support: 'text' | 'link' | 'image' | 'video' | 'sparkline' | 'progressbar' | 'chart . The abbreviated way of writing \\\"|\\\" separated field names is also supported.\",\"example\":\"[{ field: 'title', title: 'Title', width: 'auto' }] or title|caption|description\",\"url\":\"https://visactor.io/vtable/option/ListTable#columns\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/darkTheme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/darkTheme\",\"tags\":\"BasicTable PivotTable\",\"field\":\"darkTheme\",\"description\":\"Themes to use when dark\",\"example\":\"The themes available are DARK BRIGHT ARCO DEFAULT SIMPLIFY, default to DARK\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/editable\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/editable\",\"tags\":\"BasicTable\",\"field\":\"editable\",\"description\":\"Whether editing table content is allowed. Default is 'no'. Fill in 'yes' to allow editing on double-click.\",\"example\":\"yes no\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/filter\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/filter\",\"tags\":\"BasicTable PivotTable\",\"field\":\"filter\",\"description\":\"Table data source filter\",\"example\":\"Filter to get a list of titles, the widget auto converts the list of title into a JSON list of their fields, populating the records field of the table options as the data source. When the filter field exists, it will override the records field of table widget.\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/height\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/height\",\"tags\":\"BasicTable PivotTable\",\"field\":\"height\",\"description\":\"The width of the table container, similar to the CSS height.\",\"example\":\"100% 500px\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/lightTheme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/lightTheme\",\"tags\":\"BasicTable PivotTable\",\"field\":\"lightTheme\",\"description\":\"Themes to use when bright colors\",\"example\":\"The themes available are DARK BRIGHT ARCO DEFAULT SIMPLIFY, default to DEFAULT\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/omitTags\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/omitTags\",\"tags\":\"BasicTable\",\"field\":\"omitTags\",\"description\":\"Not displaying tags\",\"example\":\"Accepts a filter expression, e.g. if you want to ignore the `Tasks` tag when displaying a to-do list, you can pass a filter expression like `[[Tasks]]`.\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/options\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/options\",\"tags\":\"BasicTable PivotTable\",\"field\":\"options\",\"description\":\"Add other configuration items, either in JS syntax or JSON. the configuration items here will override the default configuration items.\",\"example\":\"Use features such as tooltip, see the visactor documentation for details.\",\"url\":\"https://visactor.io/vtable/option/\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-columns\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-columns\",\"tags\":\"PivotTable\",\"field\":\"columns\",\"description\":\"The style and format configuration corresponding to the header of each level of dimensions should be set separately for each dimension. The configuration items will vary slightly depending on the headerType. Supported headerType values are: 'text' | 'link' | 'image' | 'video'\",\"example\":\"Configuration is complex, see the official documentation for details. However, you can use a simple array of strings to indicate which fields in the data to use, e.g. ['name', 'age'].\",\"url\":\"https://visactor.io/vtable/option/PivotChart#columns\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-indicators\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-indicators\",\"tags\":\"PivotTable\",\"field\":\"indicators\",\"description\":\"The specific configuration of each indicator in the perspective combination chart, such as style, format, title, etc., is different from the pivot table. The indicator type here only supports the configuration of the chart type.\",\"example\":\"Configuration is complex, see the official documentation for details. However, you can use a simple array of strings to indicate which fields in the data to use, e.g. ['created', 'modified'].\",\"url\":\"https://visactor.io/vtable/option/PivotChart#indicators\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-rows\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/pivot-rows\",\"tags\":\"PivotTable\",\"field\":\"rows\",\"description\":\"The row header corresponds to the style and format configuration of each level of dimension. Each type of dimension needs to be set separately. The configuration items have slight differences according to the headerType. The supported headerTypes are: 'text' | 'link' | 'image' | 'video'\",\"example\":\"Configuration is complex, see the official documentation for details. However, it is possible to use a simple array of strings to indicate which fields in the data are to be used, e.g. ['title']\",\"url\":\"https://visactor.io/vtable/option/PivotChart#rows\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/records\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/records\",\"tags\":\"BasicTable PivotTable\",\"field\":\"records\",\"description\":\"Table data source JSON\",\"example\":\"JSON data can be entered as a multi-line string or embedded. JS syntax can be used (e.g., tailing commas, omitting quotes from field names, `new Date()`, etc.).\",\"url\":\"https://visactor.io/vtable/option/ListTable#records\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/search\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/search\",\"tags\":\"BasicTable PivotTable\",\"field\":\"search\",\"description\":\"Enable search or not, default is `no`. Fill in `search-bar` to display a search box at the bottom of the table, or `search-bar-top` to display it at the top.\",\"example\":\"search-bar-top\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/sort\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/sort\",\"tags\":\"BasicTable PivotTable\",\"field\":\"sort\",\"description\":\"Which field to sort by, default is `modified` of tiddler. Can use any tiddler's field, or fill in `no` to indicate no additional sorting, and follow the order of filter result or data given.\",\"example\":\"no created modified\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/titleNav\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/titleNav\",\"tags\":\"BasicTable PivotTable\",\"field\":\"titleNav\",\"description\":\"Enabled by default, for `title` fields, when clicked, jumps to the corresponding tiddler\",\"example\":\"yes no\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/width\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/width\",\"tags\":\"BasicTable PivotTable\",\"field\":\"width\",\"description\":\"The width of the table container, used similarly to width in CSS. note that this is not exactly the width of the table, it is determined by the widthMode field.\",\"example\":\"100% 300px\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/widthMode\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Parameters/widthMode\",\"tags\":\"BasicTable PivotTable\",\"field\":\"widthMode\",\"description\":\"Table column width calculation mode\",\"example\":\"can be 'standard' (standard mode), 'adaptive' (container width adaptive mode) or 'autoWidth' (automatic width mode), default is 'adaptive'.\",\"url\":\"https://visactor.io/vtable/option/ListTable#widthMode('standard'%20%7C%20'adaptive'%20%7C%20'autoWidth')%20=%20'standard'\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Readme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Readme\",\"text\":\"\\\\define lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\n! <<lingo Name>>\\n\\n<<lingo Description>>\\n\\n!! Use Widget\\n\\nThis plugin provides several widgets:\\n\\n# Basic Table\\n#* A basic table is a common form of visual data used to present and organize data. It consists of a grid-like structure of rows and columns that presents large amounts of data in a clear, structured manner. Basic tables often provide some interaction and visualization capabilities that enable users to find, sort, paginate, and format data.\\n#* widget is `<$basic-table />`\\n# Pivot Table\\n#* Pivot table, also known as multidimensional analysis table, cross table, Pivot table, refers to a table that can put one or more Dimensions in row Dimensions and column Dimensions to display the relationship between Dimensions. Users can analyze various scenarios at a glance Metirc and comparison, designed to help business analysis drive decision-making.\\n#* widget is `<$pivot-table />`\\n\\n!!! <<lingo ParametersTable/Caption>>\\n\\nThere are a variety of parameters that can be used on the Widget, and you can start by checking out the use cases on the documentation site to learn from the examples, or by piecing together your own parameters based on the parameter list.\\n\\n[[Read the Parameters Table|$:/plugins/linonetwo/hyper-table/ParametersTable]]\\n\\n!! Troubleshooting\\n\\n* The table does not display, and the width is found to be 0\\n** Try adding `width: 100%` to the parent container, because the table will try to adapt to the width of the parent container, and if the parent container is initially 0, it will be like this.\\n\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Name\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Name\",\"text\":\"High-Dimensional Tables\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/Description\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/Description\",\"text\":\"Present large amounts of data beautifully and efficiently, generate pivot tables and other advanced table presentations for tiddlers.\"},\"$:/plugins/linonetwo/hyper-table/language/en-GB/ParametersTable/Caption\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/en-GB/ParametersTable/Caption\",\"text\":\"Widget Parameters Table\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/ParametersTable\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/ParametersTable\",\"text\":\"\\\\procedure lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\\\procedure columns()\\n  [\\n    {\\n      field: 'field',\\n      title: '配置项字段',\\n      width: 200,\\n      sort: true,\\n    },\\n    {\\n      field: 'description',\\n      title: '描述',\\n      width: 400,\\n      style: {\\n        // 启用 `defaultRowHeight` 的时候，换行才生效\\n        autoWrapText: true,\\n      },\\n    },\\n    {\\n      field: 'example',\\n      title: '例子',\\n      width: 400,\\n      style: {\\n        autoWrapText: true,\\n      },\\n    },\\n    {\\n      field: 'url',\\n      title: '文档地址',\\n      width: 200,\\n      cellType: 'link',\\n      sort: true,\\n    },\\n    {\\n      field: 'title',\\n      title: '条目',\\n      width: 300,\\n      style: {\\n        autoWrapText: true,\\n      },\\n    },\\n  ]\\n\\\\end\\n\\n!!! 基本表格\\n\\n<$basic-table\\n  filter=\\\"[all[shadows]prefix[$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/]tag[BasicTable]]\\\"\\n  columns=<<columns>>\\n  options=\\\"{ defaultRowHeight: 60 }\\\"\\n/>\\n\\n!!! 数据透视表\\n\\n<$basic-table\\n  filter=\\\"[all[shadows]prefix[$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/]tag[PivotTable]]\\\"\\n  columns=<<columns>>\\n  options=\\\"{ defaultRowHeight: 60 }\\\"\\n/>\\n\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/basic-columns\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/basic-columns\",\"tags\":\"BasicTable\",\"field\":\"columns\",\"description\":\"表格每一列的配置，每一列需要分别设置配置项，配置项根据cellType不同有略微差别，cellType可支持：'text' | 'link' | 'image' | 'video' | 'sparkline' | 'progressbar' | 'chart ，默认为 text。也支持竖线 `|` 分隔的字段名这种简略写法。\",\"example\":\"[{ field: 'title', title: 'Title', width: 'auto' }] 或 title|caption|description\",\"url\":\"https://visactor.io/vtable/option/ListTable#columns\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/darkTheme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/darkTheme\",\"tags\":\"BasicTable PivotTable\",\"field\":\"darkTheme\",\"description\":\"暗色时使用的主题\",\"example\":\"可选主题有 DARK BRIGHT ARCO DEFAULT SIMPLIFY，默认为 DARK\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/editable\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/editable\",\"tags\":\"BasicTable\",\"field\":\"editable\",\"description\":\"是否允许编辑表格内容，默认是 'no'。可以填 'yes' 允许双击编辑。\",\"example\":\"yes no\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/filter\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/filter\",\"tags\":\"BasicTable PivotTable\",\"field\":\"filter\",\"description\":\"表格数据源筛选器\",\"example\":\"筛选出标题列表即可，微件会自动转换标题列表为字段 JSON 列表，填入表格选项的 records 字段，作为数据源。当 filter 存在时，会覆盖 records 字段。\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/height\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/height\",\"tags\":\"BasicTable PivotTable\",\"field\":\"height\",\"description\":\"表格容器的宽度，用法类似 CSS 的 height\",\"example\":\"100% 500px\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/lightTheme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/lightTheme\",\"tags\":\"BasicTable PivotTable\",\"field\":\"lightTheme\",\"description\":\"亮色时使用的主题\",\"example\":\"可选主题有 DARK BRIGHT ARCO DEFAULT SIMPLIFY，默认为 DEFAULT\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/omitTags\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/omitTags\",\"tags\":\"BasicTable\",\"field\":\"omitTags\",\"description\":\"不展示标签\",\"example\":\"接受一个筛选器表达式，例如你在展示待办列表时，希望忽略 `任务` 标签，则可以传入 `[[任务]]` 这样的筛选器表达式。\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/options\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/options\",\"tags\":\"BasicTable PivotTable\",\"field\":\"options\",\"description\":\"补充其它配置项，可以使用 JS 语法，也可以是 JSON。这里的配置项会覆盖默认配置项。\",\"example\":\"使用例如 tooltip 等功能，详见 visactor 的文档\",\"url\":\"https://visactor.io/vtable/option/\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-columns\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-columns\",\"tags\":\"PivotTable\",\"field\":\"columns\",\"description\":\"表格每一列的配置，每一列需要分别设置配置项，配置项根据cellType不同有略微差别，cellType可支持：'text' | 'link' | 'image' | 'video' ，默认为 text\",\"example\":\"配置较为复杂，具体详见官方文档。不过可以使用简单的字符串数组表明要使用数据里的哪些字段，例如 ['name', 'age']\",\"url\":\"https://visactor.io/vtable/option/PivotChart#columns\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-indicators\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-indicators\",\"tags\":\"PivotTable\",\"field\":\"indicators\",\"description\":\"透视组合图中各个指标的具体配置，如样式，format，title 等，区别透视表，这里的指标类型仅支持配置 chart 类型。\",\"example\":\"配置较为复杂，具体详见官方文档。不过可以使用简单的字符串数组表明要使用数据里的哪些字段，例如 ['created', 'modified']\",\"url\":\"https://visactor.io/vtable/option/PivotChart#indicators\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-rows\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/pivot-rows\",\"tags\":\"PivotTable\",\"field\":\"rows\",\"description\":\"行表头对应各级维度的样式及format配置，每中维度需要分别设置配置项，配置项根据headerType不同有略微差别，headerType可支持：'text' | 'link' | 'image' | 'video'\",\"example\":\"配置较为复杂，具体详见官方文档。不过可以使用简单的字符串数组表明要使用数据里的哪些字段，例如 ['title']\",\"url\":\"https://visactor.io/vtable/option/PivotChart#rows\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/records\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/records\",\"tags\":\"BasicTable PivotTable\",\"field\":\"records\",\"description\":\"表格数据源 JSON\",\"example\":\"可以用多行字符串或嵌入的方式，输入 JSON 数据。可以使用 JS 语法（如行尾都加逗号、省略字段名的引号、`new Date()` 等）。\",\"url\":\"https://visactor.io/vtable/option/ListTable#records\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/search\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/search\",\"tags\":\"BasicTable PivotTable\",\"field\":\"search\",\"description\":\"是否展示搜索栏，默认是 `no`。填 `search-bar` 会在表格底部展示一个搜索框，填 `search-bar-top` 则在顶部。\",\"example\":\"search-bar-top\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/sort\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/sort\",\"tags\":\"BasicTable PivotTable\",\"field\":\"sort\",\"description\":\"用哪个字段排序，默认是根据条目修改时间。可以填条目上会有的任何字段，或填 `no` 表示不做额外排序，而完全按照筛选器或者数据给定的顺序来展示。\",\"example\":\"no created modified\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/titleNav\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/titleNav\",\"tags\":\"BasicTable PivotTable\",\"field\":\"titleNav\",\"description\":\"默认启用，对于 title 字段，点击时跳转到相应条目\",\"example\":\"yes no\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/width\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/width\",\"tags\":\"BasicTable PivotTable\",\"field\":\"width\",\"description\":\"表格容器的宽度，用法类似 CSS 的 width。注意这不完全是表格的宽度，根据 widthMode 字段决定。\",\"example\":\"100% 300px\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/widthMode\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Parameters/widthMode\",\"tags\":\"BasicTable PivotTable\",\"field\":\"widthMode\",\"description\":\"表格列宽度的计算模式\",\"example\":\"可以是 'standard'（标准模式）、'adaptive'（自适应容器宽度模式）或 'autoWidth'（自动宽度模式），默认为 'adaptive'，会占满表格容器的宽度。\",\"url\":\"https://visactor.io/vtable/option/ListTable#widthMode('standard'%20%7C%20'adaptive'%20%7C%20'autoWidth')%20=%20'standard'\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Readme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Readme\",\"text\":\"\\\\define lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\n! <<lingo Name>>\\n\\n<<lingo Description>>\\n\\n!! 使用微件\\n\\n本插件提供几种微件：\\n\\n# 基本表格\\n#* 基本表格是一种常见的可视化数据形式，用于展示和组织数据。它由行和列的网格状结构组成，以清晰、结构化的方式呈现大量数据。基本表格通常提供一些交互和可视化功能，使用户能够对数据进行查找、排序、分页和格式化等操作。\\n#* 微件为 `<$basic-table />`\\n# 数据透视表\\n#* 数据透视表又名多维分析表、交叉表、Pivot Table，指的是可以在行维度和列维度放入一个或多个维度，显示维度之间相互关系的一种表格。用户可以一目了然地分析出各种场景指标以及对比，旨在帮助业务分析推动决策。\\n#* 微件为 `<$pivot-table />`\\n\\n!!! <<lingo ParametersTable/Caption>>\\n\\n微件上可以使用各种参数，你可以先在文档网站上查看用例，从例子中学习，或根据参数表自己拼凑参数。\\n\\n[[查看参数表|$:/plugins/linonetwo/hyper-table/ParametersTable]]\\n\\n!! 问题排查\\n\\n* 表格不展示，检查发现宽度为 0\\n** 试着给父容器加上 `width: 100%`，因为表格会尝试适配父容器宽度，而如果父容器一开始宽度为 0 就会这样了。\\n\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Name\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Name\",\"text\":\"高维表格\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Description\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/Description\",\"text\":\"美观高效地展示大量数据，为你的条目生成数据透视表等高级表格展示方式。\"},\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/ParametersTable/Caption\":{\"title\":\"$:/plugins/linonetwo/hyper-table/language/zh-Hans/ParametersTable/Caption\",\"text\":\"微件参数表\"},\"$:/plugins/linonetwo/hyper-table/readme\":{\"title\":\"$:/plugins/linonetwo/hyper-table/readme\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\define lingo-base() $:/plugins/linonetwo/hyper-table/language/\\n\\n<<lingo Readme>>\\n\"},\"$:/plugins/linonetwo/hyper-table/tree\":{\"title\":\"$:/plugins/linonetwo/hyper-table/tree\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<<tree prefix:\\\"$:/plugins/linonetwo/hyper-table/\\\">>\"},\"$:/plugins/linonetwo/hyper-table/widgets/search-bar/searchBar.css.tid\":{\"title\":\"$:/plugins/linonetwo/hyper-table/widgets/search-bar/searchBar.css.tid\",\"tags\":\"$:/tags/Stylesheet\",\"text\":\"\\\\rules except horizrule dash\\n\\n.tc-hyper-table-search-btn,\\n.tc-hyper-table-next-btn,\\n.tc-hyper-table-prev-btn {\\n  color: <<colour button-foreground>>;\\n}\\n.tc-hyper-table-search-top {\\n  border-bottom: 1px solid <<colour tab-divider>>;\\n}\\n\\n.tc-hyper-table-search-bottom {\\n  border-top: 1px solid <<colour tab-divider>>;\\n}\\n\"},\"$:/plugins/linonetwo/hyper-table/widgets/widget-loader.js\":{\"title\":\"$:/plugins/linonetwo/hyper-table/widgets/widget-loader.js\",\"text\":\"!function hyperTableWidgetIIFE(){if($tw.browser)try{var{ListTableWidget:e,PivotTableWidget:t}=require(\\\"$:/plugins/linonetwo/hyper-table/widgets/table.js\\\");exports[\\\"basic-table\\\"]=e,exports[\\\"pivot-table\\\"]=t}catch(r){console.error(\\\"Error loading hyperTable widget\\\",r)}}();\",\"type\":\"application/javascript\",\"module-type\":\"widget\",\"hide-body\":\"yes\"},\"$:/plugins/linonetwo/hyper-table/widgets/table.js\":{\"title\":\"$:/plugins/linonetwo/hyper-table/widgets/table.js\",\"type\":\"application/javascript\",\"module-type\":\"library\",\"hide-body\":\"yes\",\"Modern.TiddlyDev#Origin\":\"widgets/table.ts\",\"text\":\"\\\"use strict\\\";var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__esm=(e,t)=>function(){return t=e?(0,e[__getOwnPropNames(e)[0]])(e=0):t},__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__export=(e,t)=>{for(var i in t)__defProp(e,i,{get:t[i],enumerable:!0})},__copyProps=(t,i,r,o)=>{if(i&&\\\"object\\\"==typeof i||\\\"function\\\"==typeof i)for(let e of __getOwnPropNames(i))__hasOwnProp.call(t,e)||e===r||__defProp(t,e,{get:()=>i[e],enumerable:!(o=__getOwnPropDesc(i,e))||o.enumerable});return t},__toESM=(e,t,i)=>(i=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?i:__defProp(i,\\\"default\\\",{value:e,enumerable:!0}),e)),init_esbuild_inject=__esm({\\\"node_modules/.pnpm/tiddlywiki-plugin-dev@0.3.2_postcss-load-config@4.0.2_postcss@8.5.3_ts-node@10.9.2_@typ_3849af3bdcb93a2faf9d723deb83e4aa/node_modules/tiddlywiki-plugin-dev/dist/js/esbuild-inject.js\\\"(){}}),require_eventemitter3=__commonJS({\\\"node_modules/.pnpm/eventemitter3@4.0.7/node_modules/eventemitter3/index.js\\\"(e,t){init_esbuild_inject();var r=Object.prototype.hasOwnProperty,g=\\\"~\\\";function i(){}function l(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,r,o){if(\\\"function\\\"!=typeof i)throw new TypeError(\\\"The listener must be a function\\\");var n=new l(i,r||e,o),a=g?g+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],n]:e._events[a].push(n):(e._events[a]=n,e._eventsCount++),e}function h(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function n(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(g=!1)),n.prototype.eventNames=function(){var e,t,i=[];if(0===this._eventsCount)return i;for(t in e=this._events)r.call(e,t)&&i.push(g?t.slice(1):t);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},n.prototype.listeners=function(e){var t=g?g+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,n=new Array(o);r<o;r++)n[r]=i[r].fn;return n},n.prototype.listenerCount=function(e){var t=g?g+e:e,t=this._events[t];return t?t.fn?1:t.length:0},n.prototype.emit=function(e,t,i,r,o,n){var a=g?g+e:e;if(!this._events[a])return!1;var l,s=this._events[a],h=arguments.length;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),h){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,i),!0;case 4:return s.fn.call(s.context,t,i,r),!0;case 5:return s.fn.call(s.context,t,i,r,o),!0;case 6:return s.fn.call(s.context,t,i,r,o,n),!0}for(c=1,l=new Array(h-1);c<h;c++)l[c-1]=arguments[c];s.fn.apply(s.context,l)}else for(var d,u=s.length,c=0;c<u;c++)switch(s[c].once&&this.removeListener(e,s[c].fn,void 0,!0),h){case 1:s[c].fn.call(s[c].context);break;case 2:s[c].fn.call(s[c].context,t);break;case 3:s[c].fn.call(s[c].context,t,i);break;case 4:s[c].fn.call(s[c].context,t,i,r);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];s[c].fn.apply(s[c].context,l)}return!0},n.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},n.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},n.prototype.removeListener=function(e,t,i,r){var o=g?g+e:e;if(this._events[o])if(t){var n=this._events[o];if(n.fn)n.fn!==t||r&&!n.once||i&&n.context!==i||h(this,o);else{for(var a=0,l=[],s=n.length;a<s;a++)(n[a].fn!==t||r&&!n[a].once||i&&n[a].context!==i)&&l.push(n[a]);l.length?this._events[o]=1===l.length?l[0]:l:h(this,o)}}else h(this,o);return this},n.prototype.removeAllListeners=function(e){var t;return e?(t=g?g+e:e,this._events[t]&&h(this,t)):(this._events=new i,this._eventsCount=0),this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prefixed=g,n.EventEmitter=n,void 0!==t&&(t.exports=n)}}),require_lib=__commonJS({\\\"node_modules/.pnpm/js-binary-schema-parser@2.0.3/node_modules/js-binary-schema-parser/lib/index.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.loop=e.conditional=e.parse=void 0;e.parse=function n(t,e){var i,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:r;return Array.isArray(e)?e.forEach(function(e){return n(t,e,r,o)}):\\\"function\\\"==typeof e?e(t,r,o,n):(i=Object.keys(e)[0],Array.isArray(e[i])?(o[i]={},n(t,e[i],r,o[i])):o[i]=e[i](t,r,o,n)),r},e.conditional=function(o,n){return function(e,t,i,r){n(e,t,i)&&r(e,o,t,i)}};e.loop=function(l,s){return function(e,t,i,r){for(var o=[],n=e.pos;s(e,t,i);){var a={};if(r(e,l,t,a),e.pos===n)break;n=e.pos,o.push(a)}return o}}}}),require_uint8=__commonJS({\\\"node_modules/.pnpm/js-binary-schema-parser@2.0.3/node_modules/js-binary-schema-parser/lib/parsers/uint8.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.readBits=e.readArray=e.readUnsigned=e.readString=e.peekBytes=e.readBytes=e.peekByte=e.readByte=e.buildStream=void 0;e.buildStream=function(e){return{data:e,pos:0}};var n=function(){return function(e){return e.data[e.pos++]}},h=(e.readByte=n,e.peekByte=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(e){return e.data[e.pos+t]}},function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}});e.readBytes=h,e.peekBytes=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}},e.readString=function(t){return function(e){return Array.from(h(t)(e)).map(function(e){return String.fromCharCode(e)}).join(\\\"\\\")}},e.readUnsigned=function(i){return function(e){var t=h(2)(e);return i?(t[1]<<8)+t[0]:(t[0]<<8)+t[1]}},e.readArray=function(l,s){return function(e,t,i){for(var r=\\\"function\\\"==typeof s?s(e,t,i):s,o=h(l),n=new Array(r),a=0;a<r;a++)n[a]=o(e);return n}};e.readBits=function(o){return function(e){for(var t=n()(e),r=new Array(8),i=0;i<8;i++)r[7-i]=!!(t&1<<i);return Object.keys(o).reduce(function(e,t){var i=o[t];return i.length?e[t]=function(e,t,i){for(var r=0,o=0;o<i;o++)r+=e[t+o]&&Math.pow(2,i-o-1);return r}(r,i.index,i.length):e[t]=r[i.index],e},{})}}}}),require_gif=__commonJS({\\\"node_modules/.pnpm/js-binary-schema-parser@2.0.3/node_modules/js-binary-schema-parser/lib/schemas/gif.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e[\\\"default\\\"]=void 0;var t=require_lib(),h=require_uint8(),i={blocks:function(e){for(var t=[],i=e.data.length,r=0,o=(0,h.readByte)()(e);0!==o&&o;o=(0,h.readByte)()(e)){if(e.pos+o>=i){var n=i-e.pos;t.push((0,h.readBytes)(n)(e)),r+=n;break}t.push((0,h.readBytes)(o)(e)),r+=o}for(var a=new Uint8Array(r),l=0,s=0;s<t.length;s++)a.set(t[s],l),l+=t[s].length;return a}},r=(0,t.conditional)({gce:[{codes:(0,h.readBytes)(2)},{byteSize:(0,h.readByte)()},{extras:(0,h.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,h.readUnsigned)(!0)},{transparentColorIndex:(0,h.readByte)()},{terminator:(0,h.readByte)()}]},function(e){var t=(0,h.peekBytes)(2)(e);return 33===t[0]&&249===t[1]}),o=(0,t.conditional)({image:[{code:(0,h.readByte)()},{descriptor:[{left:(0,h.readUnsigned)(!0)},{top:(0,h.readUnsigned)(!0)},{width:(0,h.readUnsigned)(!0)},{height:(0,h.readUnsigned)(!0)},{lct:(0,h.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,h.readArray)(3,function(e,t,i){return Math.pow(2,i.descriptor.lct.size+1)})},function(e,t,i){return i.descriptor.lct.exists}),{data:[{minCodeSize:(0,h.readByte)()},i]}]},function(e){return 44===(0,h.peekByte)()(e)}),n=(0,t.conditional)({text:[{codes:(0,h.readBytes)(2)},{blockSize:(0,h.readByte)()},{preData:function(e,t,i){return(0,h.readBytes)(i.text.blockSize)(e)}},i]},function(e){var t=(0,h.peekBytes)(2)(e);return 33===t[0]&&1===t[1]}),a=(0,t.conditional)({application:[{codes:(0,h.readBytes)(2)},{blockSize:(0,h.readByte)()},{id:function(e,t,i){return(0,h.readString)(i.blockSize)(e)}},i]},function(e){var t=(0,h.peekBytes)(2)(e);return 33===t[0]&&255===t[1]}),i=(0,t.conditional)({comment:[{codes:(0,h.readBytes)(2)},i]},function(e){var t=(0,h.peekBytes)(2)(e);return 33===t[0]&&254===t[1]}),t=[{header:[{signature:(0,h.readString)(3)},{version:(0,h.readString)(3)}]},{lsd:[{width:(0,h.readUnsigned)(!0)},{height:(0,h.readUnsigned)(!0)},{gct:(0,h.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,h.readByte)()},{pixelAspectRatio:(0,h.readByte)()}]},(0,t.conditional)({gct:(0,h.readArray)(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},function(e,t){return t.lsd.gct.exists}),{frames:(0,t.loop)([r,a,i,o,n],function(e){var t=(0,h.peekByte)()(e);return 33===t||44===t})}];e[\\\"default\\\"]=t}}),require_deinterlace=__commonJS({\\\"node_modules/.pnpm/gifuct-js@2.1.2/node_modules/gifuct-js/lib/deinterlace.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.deinterlace=void 0;e.deinterlace=function(e,t){for(var i,r,o,n=new Array(e.length),a=e.length/t,l=[0,4,2,1],s=[8,8,4,2],h=0,d=0;d<4;d++)for(var u=l[d];u<a;u+=s[d])i=u,r=h,o=void 0,o=e.slice(r*t,(r+1)*t),n.splice.apply(n,[i*t,t].concat(o)),h++;return n}}}),require_lzw=__commonJS({\\\"node_modules/.pnpm/gifuct-js@2.1.2/node_modules/gifuct-js/lib/lzw.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.lzw=void 0;e.lzw=function(e,t,i){for(var r,o,n,a,l,s,h,d,u=4096,c=i,g=new Array(i),p=new Array(u),f=new Array(u),m=new Array(4097),b=e,C=1<<b,v=1+C,y=2+C,w=-1,_=b+1,S=(1<<_)-1,x=0;x<C;x++)p[x]=0,f[x]=x;for(o=n=a=l=s=h=d=0;o<c;){if(0===s){if(a<_){n+=t[d]<<a,a+=8,d++;continue}if(x=n&S,n>>=_,a-=_,y<x||x==v)break;if(x==C){S=(1<<(_=b+1))-1,y=2+C,w=-1;continue}if(-1==w){m[s++]=f[x],l=w=x;continue}for((r=x)==y&&(m[s++]=l,x=w);C<x;)m[s++]=f[x],x=p[x];l=255&f[x],m[s++]=l,y<u&&(p[y]=w,f[y]=l,0==(++y&S))&&y<u&&(_++,S+=y),w=r}s--,g[h++]=m[s],o++}for(o=h;o<c;o++)g[o]=0;return g}}}),require_lib2=__commonJS({\\\"node_modules/.pnpm/gifuct-js@2.1.2/node_modules/gifuct-js/lib/index.js\\\"(e){init_esbuild_inject(),Object.defineProperty(e,\\\"__esModule\\\",{value:!0}),e.decompressFrames=e.decompressFrame=e.parseGIF=void 0;var t,i=(t=require_gif())&&t.__esModule?t:{\\\"default\\\":t},r=require_lib(),o=require_uint8(),n=require_deinterlace(),a=require_lzw();e.parseGIF=function(e){var t=new Uint8Array(e);return(0,r.parse)((0,o.buildStream)(t),i[\\\"default\\\"])};var l=function(e,t,i){var r,o;if(e.image)return o=(r=e.image).descriptor.width*r.descriptor.height,o=(0,a.lzw)(r.data.minCodeSize,r.data.blocks,o),o={pixels:o=r.descriptor.lct.interlaced?(0,n.deinterlace)(o,r.descriptor.width):o,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}},r.descriptor.lct&&r.descriptor.lct.exists?o.colorTable=r.lct:o.colorTable=t,e.gce&&(o.delay=10*(e.gce.delay||10),o.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven)&&(o.transparentIndex=e.gce.transparentColorIndex),i&&(o.patch=function(e){for(var t=e.pixels.length,i=new Uint8ClampedArray(4*t),r=0;r<t;r++){var o=4*r,n=e.pixels[r],a=e.colorTable[n]||[0,0,0];i[o]=a[0],i[1+o]=a[1],i[2+o]=a[2],i[3+o]=n!==e.transparentIndex?255:0}return i}(o)),o;console.warn(\\\"gif frame does not have associated image.\\\")};e.decompressFrame=l;e.decompressFrames=function(t,i){return t.frames.filter(function(e){return e.image}).map(function(e){return l(e,t.gct,i)})}}}),require_isArray=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isArray.js\\\"(e,t){init_esbuild_inject();var i=Array.isArray;t.exports=i}}),require_freeGlobal=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_freeGlobal.js\\\"(e,t){init_esbuild_inject();var i=\\\"object\\\"==typeof global&&global&&global.Object===Object&&global;t.exports=i}}),require_root=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_root.js\\\"(e,t){init_esbuild_inject();var i=require_freeGlobal(),r=\\\"object\\\"==typeof self&&self&&self.Object===Object&&self,i=i||r||Function(\\\"return this\\\")();t.exports=i}}),require_Symbol=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Symbol.js\\\"(e,t){init_esbuild_inject();var i=require_root().Symbol;t.exports=i}}),require_getRawTag=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getRawTag.js\\\"(e,t){init_esbuild_inject();var i=require_Symbol(),r=Object.prototype,a=r.hasOwnProperty,l=r.toString,s=i?i.toStringTag:void 0;t.exports=function(e){var t=a.call(e,s),i=e[s];try{var r=!(e[s]=void 0)}catch(n){}var o=l.call(e);return r&&(t?e[s]=i:delete e[s]),o}}}),require_objectToString=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_objectToString.js\\\"(e,t){init_esbuild_inject();var i=Object.prototype.toString;t.exports=function(e){return i.call(e)}}}),require_baseGetTag=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGetTag.js\\\"(e,t){init_esbuild_inject();var i=require_Symbol(),r=require_getRawTag(),o=require_objectToString(),n=i?i.toStringTag:void 0;t.exports=function(e){return null==e?void 0===e?\\\"[object Undefined]\\\":\\\"[object Null]\\\":(n&&n in Object(e)?r:o)(e)}}}),require_isObjectLike=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObjectLike.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e){return null!=e&&\\\"object\\\"==typeof e}}}),require_isSymbol=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isSymbol.js\\\"(e,t){init_esbuild_inject();var i=require_baseGetTag(),r=require_isObjectLike();t.exports=function(e){return\\\"symbol\\\"==typeof e||r(e)&&\\\"[object Symbol]\\\"==i(e)}}}),require_isKey=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isKey.js\\\"(e,t){init_esbuild_inject();var r=require_isArray(),o=require_isSymbol(),n=/\\\\.|\\\\[(?:[^[\\\\]]*|([\\\"'])(?:(?!\\\\1)[^\\\\\\\\]|\\\\\\\\.)*?\\\\1)\\\\]/,a=/^\\\\w*$/;t.exports=function(e,t){var i;return!r(e)&&(!(\\\"number\\\"!=(i=typeof e)&&\\\"symbol\\\"!=i&&\\\"boolean\\\"!=i&&null!=e&&!o(e))||a.test(e)||!n.test(e)||null!=t&&e in Object(t))}}}),require_isObject=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isObject.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e){var t=typeof e;return null!=e&&(\\\"object\\\"==t||\\\"function\\\"==t)}}}),require_isFunction=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/isFunction.js\\\"(e,t){init_esbuild_inject();var i=require_baseGetTag(),r=require_isObject();t.exports=function(e){var t;return!!r(e)&&(\\\"[object Function]\\\"==(t=i(e))||\\\"[object GeneratorFunction]\\\"==t||\\\"[object AsyncFunction]\\\"==t||\\\"[object Proxy]\\\"==t)}}}),require_coreJsData=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_coreJsData.js\\\"(e,t){init_esbuild_inject();var i=require_root()[\\\"__core-js_shared__\\\"];t.exports=i}}),require_isMasked=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isMasked.js\\\"(e,t){init_esbuild_inject();var i=require_coreJsData(),r=(i=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||\\\"\\\"))?\\\"Symbol(src)_1.\\\"+i:\\\"\\\";t.exports=function(e){return!!r&&r in e}}}),require_toSource=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_toSource.js\\\"(e,t){init_esbuild_inject();var i=Function.prototype.toString;t.exports=function(e){if(null!=e){try{return i.call(e)}catch(t){}try{return e+\\\"\\\"}catch(t){}}return\\\"\\\"}}}),require_baseIsNative=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseIsNative.js\\\"(e,t){init_esbuild_inject();var i=require_isFunction(),r=require_isMasked(),o=require_isObject(),n=require_toSource(),a=/^\\\\[object .+?Constructor\\\\]$/,l=Function.prototype,s=Object.prototype,l=l.toString,s=s.hasOwnProperty,h=RegExp(\\\"^\\\"+l.call(s).replace(/[\\\\\\\\^$.*+?()[\\\\]{}|]/g,\\\"\\\\\\\\$&\\\").replace(/hasOwnProperty|(function).*?(?=\\\\\\\\\\\\()| for .+?(?=\\\\\\\\\\\\])/g,\\\"$1.*?\\\")+\\\"$\\\");t.exports=function(e){return!(!o(e)||r(e))&&(i(e)?h:a).test(n(e))}}}),require_getValue=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getValue.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e,t){return null==e?void 0:e[t]}}}),require_getNative=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getNative.js\\\"(e,t){init_esbuild_inject();var r=require_baseIsNative(),o=require_getValue();t.exports=function(e,t){var i=o(e,t);return r(i)?i:void 0}}}),require_nativeCreate=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_nativeCreate.js\\\"(e,t){init_esbuild_inject();var i=require_getNative()(Object,\\\"create\\\");t.exports=i}}),require_hashClear=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashClear.js\\\"(e,t){init_esbuild_inject();var i=require_nativeCreate();t.exports=function(){this.__data__=i?i(null):{},this.size=0}}}),require_hashDelete=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashDelete.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}}}),require_hashGet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashGet.js\\\"(e,t){init_esbuild_inject();var r=require_nativeCreate(),o=Object.prototype.hasOwnProperty;t.exports=function(e){var t,i=this.__data__;return r?\\\"__lodash_hash_undefined__\\\"===(t=i[e])?void 0:t:o.call(i,e)?i[e]:void 0}}}),require_hashHas=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashHas.js\\\"(e,t){init_esbuild_inject();var i=require_nativeCreate(),r=Object.prototype.hasOwnProperty;t.exports=function(e){var t=this.__data__;return i?void 0!==t[e]:r.call(t,e)}}}),require_hashSet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_hashSet.js\\\"(e,t){init_esbuild_inject();var r=require_nativeCreate();t.exports=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=r&&void 0===t?\\\"__lodash_hash_undefined__\\\":t,this}}}),require_Hash=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Hash.js\\\"(e,t){init_esbuild_inject();var i=require_hashClear(),r=require_hashDelete(),o=require_hashGet(),n=require_hashHas(),a=require_hashSet();function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=i,l.prototype[\\\"delete\\\"]=r,l.prototype.get=o,l.prototype.has=n,l.prototype.set=a,t.exports=l}}),require_listCacheClear=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheClear.js\\\"(e,t){init_esbuild_inject(),t.exports=function(){this.__data__=[],this.size=0}}}),require_eq=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/eq.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e,t){return e===t||e!=e&&t!=t}}}),require_assocIndexOf=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_assocIndexOf.js\\\"(e,t){init_esbuild_inject();var r=require_eq();t.exports=function(e,t){for(var i=e.length;i--;)if(r(e[i][0],t))return i;return-1}}}),require_listCacheDelete=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheDelete.js\\\"(e,t){init_esbuild_inject();var r=require_assocIndexOf(),o=Array.prototype.splice;t.exports=function(e){var t=this.__data__,i=r(t,e);return!(i<0||(i==t.length-1?t.pop():o.call(t,i,1),--this.size,0))}}}),require_listCacheGet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheGet.js\\\"(e,t){init_esbuild_inject();var r=require_assocIndexOf();t.exports=function(e){var t=this.__data__,i=r(t,e);return i<0?void 0:t[i][1]}}}),require_listCacheHas=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheHas.js\\\"(e,t){init_esbuild_inject();var i=require_assocIndexOf();t.exports=function(e){return-1<i(this.__data__,e)}}}),require_listCacheSet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_listCacheSet.js\\\"(e,t){init_esbuild_inject();var o=require_assocIndexOf();t.exports=function(e,t){var i=this.__data__,r=o(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this}}}),require_ListCache=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_ListCache.js\\\"(e,t){init_esbuild_inject();var i=require_listCacheClear(),r=require_listCacheDelete(),o=require_listCacheGet(),n=require_listCacheHas(),a=require_listCacheSet();function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=i,l.prototype[\\\"delete\\\"]=r,l.prototype.get=o,l.prototype.has=n,l.prototype.set=a,t.exports=l}}),require_Map=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_Map.js\\\"(e,t){init_esbuild_inject();var i=require_getNative()(require_root(),\\\"Map\\\");t.exports=i}}),require_mapCacheClear=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheClear.js\\\"(e,t){init_esbuild_inject();var i=require_Hash(),r=require_ListCache(),o=require_Map();t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(o||r),string:new i}}}}),require_isKeyable=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_isKeyable.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e){var t=typeof e;return\\\"string\\\"==t||\\\"number\\\"==t||\\\"symbol\\\"==t||\\\"boolean\\\"==t?\\\"__proto__\\\"!==e:null===e}}}),require_getMapData=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_getMapData.js\\\"(e,t){init_esbuild_inject();var r=require_isKeyable();t.exports=function(e,t){var i=e.__data__;return r(t)?i[\\\"string\\\"==typeof t?\\\"string\\\":\\\"hash\\\"]:i.map}}}),require_mapCacheDelete=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheDelete.js\\\"(e,t){init_esbuild_inject();var i=require_getMapData();t.exports=function(e){var t=i(this,e)[\\\"delete\\\"](e);return this.size-=t?1:0,t}}}),require_mapCacheGet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheGet.js\\\"(e,t){init_esbuild_inject();var i=require_getMapData();t.exports=function(e){return i(this,e).get(e)}}}),require_mapCacheHas=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheHas.js\\\"(e,t){init_esbuild_inject();var i=require_getMapData();t.exports=function(e){return i(this,e).has(e)}}}),require_mapCacheSet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_mapCacheSet.js\\\"(e,t){init_esbuild_inject();var o=require_getMapData();t.exports=function(e,t){var i=o(this,e),r=i.size;return i.set(e,t),this.size+=i.size==r?0:1,this}}}),require_MapCache=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_MapCache.js\\\"(e,t){init_esbuild_inject();var i=require_mapCacheClear(),r=require_mapCacheDelete(),o=require_mapCacheGet(),n=require_mapCacheHas(),a=require_mapCacheSet();function l(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=i,l.prototype[\\\"delete\\\"]=r,l.prototype.get=o,l.prototype.has=n,l.prototype.set=a,t.exports=l}}),require_memoize=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/memoize.js\\\"(e,t){init_esbuild_inject();var i=require_MapCache();function a(r,o){if(\\\"function\\\"!=typeof r||null!=o&&\\\"function\\\"!=typeof o)throw new TypeError(\\\"Expected a function\\\");var n=function(){var e=arguments,t=o?o.apply(this,e):e[0],i=n.cache;return i.has(t)?i.get(t):(e=r.apply(this,e),n.cache=i.set(t,e)||i,e)};return n.cache=new(a.Cache||i),n}a.Cache=i,t.exports=a}}),require_memoizeCapped=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_memoizeCapped.js\\\"(e,t){init_esbuild_inject();var r=require_memoize();t.exports=function(e){var t=r(e,function(e){return 500===i.size&&i.clear(),e}),i=t.cache;return t}}}),require_stringToPath=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_stringToPath.js\\\"(e,t){init_esbuild_inject();var i=require_memoizeCapped(),r=/[^.[\\\\]]+|\\\\[(?:(-?\\\\d+(?:\\\\.\\\\d+)?)|([\\\"'])((?:(?!\\\\2)[^\\\\\\\\]|\\\\\\\\.)*?)\\\\2)\\\\]|(?=(?:\\\\.|\\\\[\\\\])(?:\\\\.|\\\\[\\\\]|$))/g,n=/\\\\\\\\(\\\\\\\\)?/g,i=i(function(e){var o=[];return 46===e.charCodeAt(0)&&o.push(\\\"\\\"),e.replace(r,function(e,t,i,r){o.push(i?r.replace(n,\\\"$1\\\"):t||e)}),o});t.exports=i}}),require_arrayMap=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_arrayMap.js\\\"(e,t){init_esbuild_inject(),t.exports=function(e,t){for(var i=-1,r=null==e?0:e.length,o=Array(r);++i<r;)o[i]=t(e[i],i,e);return o}}}),require_baseToString=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseToString.js\\\"(e,t){init_esbuild_inject();var i=require_Symbol(),r=require_arrayMap(),o=require_isArray(),n=require_isSymbol(),i=i?i.prototype:void 0,a=i?i.toString:void 0;t.exports=function l(e){var t;return\\\"string\\\"==typeof e?e:o(e)?r(e,l)+\\\"\\\":n(e)?a?a.call(e):\\\"\\\":\\\"0\\\"==(t=e+\\\"\\\")&&1/e==-1/0?\\\"-0\\\":t}}}),require_toString=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/toString.js\\\"(e,t){init_esbuild_inject();var i=require_baseToString();t.exports=function(e){return null==e?\\\"\\\":i(e)}}}),require_castPath=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_castPath.js\\\"(e,t){init_esbuild_inject();var i=require_isArray(),r=require_isKey(),o=require_stringToPath(),n=require_toString();t.exports=function(e,t){return i(e)?e:r(e,t)?[e]:o(n(e))}}}),require_toKey=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_toKey.js\\\"(e,t){init_esbuild_inject();var i=require_isSymbol();t.exports=function(e){var t;return\\\"string\\\"==typeof e||i(e)?e:\\\"0\\\"==(t=e+\\\"\\\")&&1/e==-1/0?\\\"-0\\\":t}}}),require_baseGet=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/_baseGet.js\\\"(e,t){init_esbuild_inject();var o=require_castPath(),n=require_toKey();t.exports=function(e,t){for(var i=0,r=(t=o(t,e)).length;null!=e&&i<r;)e=e[n(t[i++])];return i&&i==r?e:void 0}}}),require_get=__commonJS({\\\"node_modules/.pnpm/lodash@4.17.21/node_modules/lodash/get.js\\\"(e,t){init_esbuild_inject();var o=require_baseGet();t.exports=function(e,t,i){var r=null==e?void 0:o(e,t);return void 0===r?i:r}}}),require_cssfontparser=__commonJS({\\\"node_modules/.pnpm/cssfontparser@1.2.1/node_modules/cssfontparser/index.js\\\"(e,t){init_esbuild_inject();var c={},g=new RegExp([\\\"^\\\\\\\\s*(?=(?:(?:[-a-z]+\\\\\\\\s*){0,2}(italic|oblique))?)\\\",\\\"(?=(?:(?:[-a-z]+\\\\\\\\s*){0,2}(small-caps))?)\\\",\\\"(?=(?:(?:[-a-z]+\\\\\\\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)\\\",\\\"(?:(?:normal|\\\\\\\\1|\\\\\\\\2|\\\\\\\\3)\\\\\\\\s*){0,3}((?:xx?-)?\\\",\\\"(?:small|large)|medium|smaller|larger|[\\\\\\\\.\\\\\\\\d]+(?:\\\\\\\\%|in|[cem]m|ex|p[ctx]))\\\",\\\"(?:\\\\\\\\s*\\\\\\\\/\\\\\\\\s*(normal|[\\\\\\\\.\\\\\\\\d]+(?:\\\\\\\\%|in|[cem]m|ex|p[ctx])?))\\\",`?\\\\\\\\s*([-,\\\\\\\\\\\"\\\\\\\\'\\\\\\\\sa-z]+?)\\\\\\\\s*$`].join(\\\"\\\"),\\\"i\\\"),p=[\\\"style\\\",\\\"variant\\\",\\\"weight\\\",\\\"size\\\",\\\"lineHeight\\\",\\\"family\\\"],n=/([\\\\.0-9]+)(.*)/,i=function(e,t,i){var r=e.match(n);if(r){e=parseFloat(r[1]);var r=r[2].toLowerCase().trim(),o=Math.round(e);switch(o===e&&(e=o),r){case\\\"em\\\":return null===t?void 0:e*t;case\\\"px\\\":return e;case\\\"pt\\\":return e/(72/i);case\\\"pc\\\":return e/(6/i);case\\\"mm\\\":return e*(i/25.4);case\\\"cm\\\":return e*(i/2.54);case\\\"in\\\":return e*i;case\\\"%\\\":return null===t?void 0:t*(e/100)}}},f={size:i,lineHeight:i},m={serif:1,\\\"sans-serif\\\":1,cursive:1,fantasy:1,monospace:1},b=t.exports=function(e,t,i){var r=e+\\\"-\\\"+(t||\\\"null\\\")+\\\"@\\\"+i;if(i=i||96,\\\"undefined\\\"!=typeof c[r])return c[r];if(t=t&&b(t,null,i),\\\"inherit\\\"===e)return t;var o=g.exec(e);if(o){o.shift();for(var n={},a=0;a<o.length;a++){var l,s=p[a],h=o[a];if(f[s]&&h&&(l=t&&t[s]||null,h=void 0===(l=f[s](h,l,i))&&\\\"lineHeight\\\"===s&&h?n.size*parseFloat(h):l),h&&\\\"normal\\\"!==h){if(\\\"inherit\\\"===h){if(!t)return;h=t[s]}h.trim&&(h=h.trim()),n[s]=h}}Object.keys(n).length||(n=null),c[r]=n;var d=[],u=(n.style&&d.push(n.style),n.variant&&d.push(n.variant),n.weight&&\\\"400\\\"!==n.weight&&\\\"normal\\\"!==n.weight&&d.push(n.weight),d.push(n.size+\\\"px\\\"),n.lineHeight&&(d[d.length-1]+=\\\"/\\\"+n.lineHeight+\\\"px\\\"),n.family.split(\\\",\\\"));return n.family=u.map(function(e){return e=e.trim(),e=m[e.toLowerCase()]?e.toLowerCase():e}),d.push(n.family),Object.defineProperty(n,\\\"toString\\\",{value:function(){return d.map(function(e){return Array.isArray(e)?e.map(function(e){return-1<e.indexOf(\\\" \\\")?'\\\"'+e.replace(/[\\\"']/g,\\\"\\\")+'\\\"':e}).join(\\\", \\\"):e}).join(\\\" \\\")}}),n}c[r]=null};t.exports.generics=m}}),import_widget=(init_esbuild_inject(),require(\\\"$:/core/modules/widgets/widget.js\\\")),Generator=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class Fg{static GenAutoIncrementId(){return Fg.auto_increment_id++}}),ContainerModule=(Generator.auto_increment_id=0,class{constructor(e){this.id=Generator.GenAutoIncrementId(),this.registry=e}}),NAMED_TAG=(init_esbuild_inject(),init_esbuild_inject(),\\\"named\\\"),INJECT_TAG=\\\"inject\\\",MULTI_INJECT_TAG=\\\"multi_inject\\\",TAGGED=\\\"inversify:tagged\\\",PARAM_TYPES=\\\"inversify:paramtypes\\\";function getNonCustomTagKeys(){return[\\\"inject\\\",\\\"multi_inject\\\",\\\"name\\\",\\\"unmanaged\\\",\\\"named\\\",\\\"optional\\\"]}var NON_CUSTOM_TAG_KEYS=getNonCustomTagKeys(),Metadata=(init_esbuild_inject(),init_esbuild_inject(),class{constructor(e,t){this.key=e,this.value=t}toString(){return this.key===NAMED_TAG?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}),Reflect_metadata_default=(init_esbuild_inject(),function(e){var i;{var i=e,t=function(e,t){\\\"function\\\"!=typeof i[e]&&Object.defineProperty(i,e,{configurable:!0,writable:!0,value:t})};Object.prototype.hasOwnProperty;const g=\\\"function\\\"==typeof Symbol,p=g&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:\\\"@@toPrimitive\\\",f=(g&&void 0!==Symbol.iterator&&Symbol.iterator,Object.getPrototypeOf(Function)),m=(\\\"object\\\"==typeof process&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Map),b=(Set,new WeakMap);function o(e,t,i){let r=b.get(e);if(l(r)){if(!i)return;r=new m,b.set(e,r)}let o=r.get(t);if(l(o)){if(!i)return;o=new m,r.set(t,o)}return o}function n(e,t,i){var r=o(t,i,!1);return!l(r)&&!!r.has(e)}function a(e,t,i){var r=o(t,i,!1);if(!l(r))return r.get(e)}function l(e){return void 0===e}function s(e){return null===e}function h(e){return\\\"object\\\"==typeof e?null!==e:\\\"function\\\"==typeof e}function r(e,t){switch(function(e){if(null===e)return 1;switch(typeof e){case\\\"undefined\\\":return 0;case\\\"boolean\\\":return 2;case\\\"string\\\":return 3;case\\\"symbol\\\":return 4;case\\\"number\\\":return 5;case\\\"object\\\":return null===e?1:6;default:return 6}}(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?\\\"string\\\":5===t?\\\"number\\\":\\\"default\\\",r=function(e,t){var i=e[t];if(null!=i){if(u(i))return i;throw new TypeError}}(e,p);if(void 0===r){t=e;if(\\\"string\\\"===(\\\"default\\\"==i?\\\"number\\\":i)){var o=t.toString;if(u(o)){o=o.call(t);if(!h(o))return o}o=t.valueOf;if(u(o)){o=o.call(t);if(!h(o))return o}}else{o=t.valueOf;if(u(o)){var n=o.call(t);if(!h(n))return n}n=t.toString;if(u(n)){var a=n.call(t);if(!h(a))return a}}throw new TypeError}a=r.call(e,i);if(h(a))throw new TypeError;return a}function d(e){var t=r(e,3);return\\\"symbol\\\"==typeof t?t:\\\"\\\"+t}function u(e){return\\\"function\\\"==typeof e}function c(e){var t,i=Object.getPrototypeOf(e);return\\\"function\\\"!=typeof e||e===f||i!==f||null==(t=(t=e.prototype)&&Object.getPrototypeOf(t))||t===Object.prototype||\\\"function\\\"!=typeof(t=t.constructor)||t===e?i:t}t(\\\"defineMetadata\\\",function(e,t,i,r){if(!h(i))throw new TypeError;e=e,t=t,o(i,r,!0).set(e,t)}),t(\\\"hasMetadata\\\",function(e,t,i){if(h(t))return function o(e,t,i){if(n(e,t,i))return!0;const r=c(t);return!s(r)&&o(e,r,i)}(e,t,i=l(i)?i:d(i));throw new TypeError}),t(\\\"hasOwnMetadata\\\",function(e,t,i){if(h(t))return n(e,t,i=l(i)?i:d(i));throw new TypeError}),t(\\\"getMetadata\\\",function(e,t,i){if(h(t))return function o(e,t,i){if(n(e,t,i))return a(e,t,i);const r=c(t);return s(r)?void 0:o(e,r,i)}(e,t,i=l(i)?i:d(i));throw new TypeError})}return e}({}));function _tagParameterOrProperty(e,t,i,r){var o=[r];let n={},a=(n=Reflect_metadata_default.hasOwnMetadata(e,t)?Reflect_metadata_default.getMetadata(e,t):n)[i];(a=void 0===a?[]:a).push(...o),n[i]=a,Reflect_metadata_default.defineMetadata(e,n,t)}function tagParameter(e,t,i,r){_tagParameterOrProperty(TAGGED,e,i.toString(),r)}function createTaggedDecorator(r){return(e,t,i)=>{tagParameter(e,t,i,r)}}function injectBase(o){return r=>(e,t,i)=>createTaggedDecorator(new Metadata(o,r))(e,t,i)}var inject=injectBase(INJECT_TAG),multiInject=(init_esbuild_inject(),injectBase(MULTI_INJECT_TAG));function injectable(){return function(e){return Reflect_metadata_default.defineMetadata(PARAM_TYPES,null,e),e}}function named(e){return createTaggedDecorator(new Metadata(NAMED_TAG,e))}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var BindingScopeEnum={Singleton:\\\"Singleton\\\",Transient:\\\"Transient\\\"},BindingTypeEnum={ConstantValue:\\\"ConstantValue\\\",Constructor:\\\"Constructor\\\",DynamicValue:\\\"DynamicValue\\\",Factory:\\\"Factory\\\",Function:\\\"Function\\\",Instance:\\\"Instance\\\",Invalid:\\\"Invalid\\\",Provider:\\\"Provider\\\"},Binding=class a7{constructor(e,t){this.id=Generator.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=BindingTypeEnum.Invalid,this.constraint=e=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){var e=new a7(this.serviceIdentifier,this.scope);return e.activated=e.scope===BindingScopeEnum.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}},MetadataReader=(init_esbuild_inject(),class{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect_metadata_default.getMetadata(PARAM_TYPES,e),userGeneratedMetadata:Reflect_metadata_default.getMetadata(TAGGED,e)||{}}}getPropertiesMetadata(e){throw new Error(\\\"暂未实现\\\")}}),taggedConstraint=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),o=>r=>{var e=t=>{if(null!=t){if(t.key===o&&t.value===r)return!0;if(null!=t.constructorArgsMetadata){var i=t.constructorArgsMetadata;for(let e=0;e<i.length;e++)if(i[e].key===o&&i[e].value===r)return!0}}return!1};return e.metaData=new Metadata(o,r),e}),namedConstraint=taggedConstraint(NAMED_TAG),BindingInSyntax=class{constructor(e){this._binding=e}inRequestScope(){throw new Error(\\\"暂未实现\\\")}inSingletonScope(){return this._binding.scope=BindingScopeEnum.Singleton,this}inTransientScope(){return this._binding.scope=BindingScopeEnum.Transient,this}whenTargetNamed(e){return this._binding.constraint=namedConstraint(e),this}},BindingToSyntax=class{constructor(e){this._binding=e}to(e){return this._binding.type=BindingTypeEnum.Instance,this._binding.implementationType=e,new BindingInSyntax(this._binding)}toSelf(){var e=this._binding.serviceIdentifier;return this.to(e)}toDynamicValue(e){return this._binding.type=BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new BindingInSyntax(this._binding)}toConstantValue(e){return this._binding.type=BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=BindingScopeEnum.Singleton,new BindingInSyntax(this._binding)}toFactory(e){return this._binding.type=BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=BindingScopeEnum.Singleton,new BindingInSyntax(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}},Container=class{constructor(e){var t=e||{};t.defaultScope=t.defaultScope||BindingScopeEnum.Transient,this.options=t,this.id=Generator.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new MetadataReader}load(e){var t=this._getContainerModuleHelpersFactory()(e.id);e.registry(t.bindFunction,t.unbindFunction,t.isboundFunction,t.rebindFunction)}get(e){var t=this._getNotAllArgs(e,!1);return this._get(t)}getAll(e){var t=this._getAllArgs(e);return this._get(t)}getTagged(e,t,i){var r=this._getNotAllArgs(e,!1,t,i);return this._get(r)}getNamed(e,t){return this.getTagged(e,NAMED_TAG,t)}isBound(e){return this._bindingDictionary.has(e)}bind(e){var t=this.options.defaultScope,t=new Binding(e,t),i=this._bindingDictionary.get(e)||[];return i.push(t),this._bindingDictionary.set(e,i),new BindingToSyntax(t)}unbind(e){this._bindingDictionary[\\\"delete\\\"](e)}rebind(e){return this.unbind(e),this.bind(e)}_getContainerModuleHelpersFactory(){const r=(e,t)=>{e._binding.moduleId=t},t=i=>e=>{var t=this.bind(e);return r(t,i),t},i=()=>e=>this.unbind(e),o=()=>e=>this.isBound(e),n=i=>e=>{var t=this.rebind(e);return r(t,i),t};return e=>({bindFunction:t(e),isboundFunction:o(),rebindFunction:n(e),unbindFunction:i(),unbindAsyncFunction:e=>null})}_getNotAllArgs(e,t,i,r){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:i,value:r}}_getAllArgs(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}}_get(t){const i=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(e=>e.constraint(t)).forEach(e=>{i.push(this._resolveFromBinding(e))}),t.isMultiInject||1!==i.length?i:i[0]}_getChildRequest(e){var t=e.implementationType,i=this._metadataReader.getConstructorMetadata(t).userGeneratedMetadata,r=Object.keys(i),o=[];for(let n=0;n<r.length;n++){const a=i[n],l={},s=(a.forEach(e=>{l[e.key]=e.value}),{inject:l[INJECT_TAG],multiInject:l[MULTI_INJECT_TAG]}),h=s.inject||s.multiInject,d={serviceIdentifier:h,constructorArgsMetadata:a},u={injectIdentifier:h,metadata:a,bindings:this._bindingDictionary.get(h).filter(e=>e.constraint(d))};o.push(u)}return o}_resolveFromBinding(e){var t=this._getResolvedFromBinding(e);return this._saveToScope(e,t),t}_getResolvedFromBinding(e){let t;switch(e.type){case BindingTypeEnum.ConstantValue:case BindingTypeEnum.Function:t=e.cache;break;case BindingTypeEnum.Instance:t=this._resolveInstance(e,e.implementationType);break;default:t=e.dynamicValue({container:this})}return t}_resolveInstance(e,t){var i;return e.activated?e.cache:(i=this._getChildRequest(e),this._createInstance(t,i))}_createInstance(e,t){return t.length?new e(...this._resolveRequests(t)):new e}_resolveRequests(e){return e.map(e=>1<e.bindings.length?e.bindings.map(e=>this._resolveFromBinding(e)):this._resolveFromBinding(e.bindings[0]))}_saveToScope(e,t){e.scope===BindingScopeEnum.Singleton&&(e.cache=t,e.activated=!0)}},ContributionProvider=(init_esbuild_inject(),init_esbuild_inject(),Symbol(\\\"ContributionProvider\\\")),ContributionProviderCache=class{constructor(e,t){this.serviceIdentifier=e,this.container=t}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}};function bindContributionProvider(e,t){e(ContributionProvider).toDynamicValue(({container:e})=>new ContributionProviderCache(t,e)).inSingletonScope().whenTargetNamed(t)}function bindContributionProviderNoSingletonScope(e,t){e(ContributionProvider).toDynamicValue(({container:e})=>new ContributionProviderCache(t,e)).whenTargetNamed(t)}init_esbuild_inject(),init_esbuild_inject();var MeasureModeEnum,Hook=class{constructor(e,t){this._args=e,this.name=t,this.taps=[]}tap(e,t){this._tap(\\\"sync\\\",e,t)}unTap(e,t){const i=\\\"string\\\"==typeof e?e.trim():e.name;i&&(this.taps=this.taps.filter(e=>!(e.name===i&&(!t||e.fn===t))))}_parseOptions(e,t,i){let r;if(\\\"string\\\"==typeof t)r={name:t.trim()};else if(\\\"object\\\"!=typeof t||null===t)throw new Error(\\\"Invalid tap options\\\");if(\\\"string\\\"!=typeof r.name||\\\"\\\"===r.name)throw new Error(\\\"Missing name for tap\\\");return r=Object.assign({type:e,fn:i},r)}_tap(e,t,i){this._insert(this._parseOptions(e,t,i))}_insert(e){let t,i=(\\\"string\\\"==typeof e.before?t=new Set([e.before]):Array.isArray(e.before)&&(t=new Set(e.before)),0),r=(\\\"number\\\"==typeof e.stage&&(i=e.stage),this.taps.length);for(;0<r;){r--;var o=this.taps[r],n=(this.taps[r+1]=o).stage||0;if(t){if(t.has(o.name)){t[\\\"delete\\\"](o.name);continue}if(0<t.size)continue}if(!(n>i)){r++;break}}this.taps[r]=e}},SyncHook=class extends Hook{call(...t){this.taps.map(e=>e.fn).forEach(e=>e(...t))}},EnvContribution=(init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"EnvContribution\\\")),VGlobal=Symbol[\\\"for\\\"](\\\"VGlobal\\\"),DEFAULT_TEXT_FONT_FAMILY=\\\"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol\\\",__decorate=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param=function(i,r){return function(e,t){r(e,t,i)}},__awaiter=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},DefaultGlobal=class{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(e){this._isImageAnonymous=e}get devicePixelRatio(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportEvent}set supportEvent(e){this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportEvent=e}get supportsTouchEvents(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(e){this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsTouchEvents=e}get supportsPointerEvents(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(e){this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsPointerEvents=e}get supportsMouseEvents(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(e){this._env||this.setEnv(\\\"browser\\\"),this.envContribution.supportsMouseEvents=e}get applyStyles(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.applyStyles}set applyStyles(e){this._env||this.setEnv(\\\"browser\\\"),this.envContribution.applyStyles=e}constructor(e){this.contributions=e,this._isImageAnonymous=!0,this.id=Generator.GenAutoIncrementId(),this.hooks={onSetEnv:new SyncHook([\\\"lastEnv\\\",\\\"env\\\",\\\"global\\\"])},this.measureTextMethod=\\\"native\\\",this.optimizeVisible=!1}bindContribution(i){const r=[];if(this.contributions.getContributions().forEach(e=>{var t=e.configure(this,i);t&&t.then&&r.push(t)}),r.length)return Promise.all(r)}getDynamicCanvasCount(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getStaticCanvasCount()}setEnv(e,t){if(t&&!0===t.force||this._env!==e)return this.deactiveCurrentEnv(),this.activeEnv(e,t)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(e,t){const i=this._env;this._env=e;var r=this.bindContribution(t);if(r&&r.then)return r.then(()=>{this.envParams=t,this.hooks.onSetEnv.call(i,e,this)});this.envParams=t,this.hooks.onSetEnv.call(i,e,this)}setActiveEnvContribution(e){this.envContribution=e}createCanvas(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.createCanvas(e)}createOffscreenCanvas(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.createOffscreenCanvas(e)}releaseCanvas(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.releaseCanvas(e)}addEventListener(e,t,i){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.addEventListener(e,t,i)}removeEventListener(e,t,i){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.removeEventListener(e,t,i)}dispatchEvent(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.dispatchEvent(e)}getRequestAnimationFrame(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getRequestAnimationFrame()}getCancelAnimationFrame(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getCancelAnimationFrame()}getElementById(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getElementById?this.envContribution.getElementById(e):null}getRootElement(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(e,t){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(e,t):null}loadImage(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadImage(e)}loadSvg(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadSvg(e)}loadJson(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadJson(e)}loadArrayBuffer(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadArrayBuffer(e)}loadBlob(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadBlob(e)}loadFont(e,t,i){return __awaiter(this,void 0,void 0,function*(){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.loadFont(e,t,i)})}isChrome(){return null==this._isChrome&&(this._env||this.setEnv(\\\"browser\\\"),this._isChrome=\\\"browser\\\"===this._env&&-1<navigator.userAgent.indexOf(\\\"Chrome\\\")),this._isChrome}isSafari(){return null==this._isSafari&&(this._env||this.setEnv(\\\"browser\\\"),this._isSafari=\\\"browser\\\"===this._env&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getNativeAABBBounds(e)}removeDom(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.removeDom(e)}createDom(e){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.createDom(e)}updateDom(e,t){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.updateDom(e,t)}getElementTop(e,t=!1){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getElementTop(e,t)}getElementLeft(e,t=!1){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getElementLeft(e,t)}getElementTopLeft(e,t=!1){return this._env||this.setEnv(\\\"browser\\\"),this.envContribution.getElementTopLeft(e,t)}},DefaultGlobal=__decorate([injectable(),__param(0,inject(ContributionProvider)),__param(0,named(EnvContribution)),__metadata(\\\"design:paramtypes\\\",[Object])],DefaultGlobal),import_eventemitter3=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),!function(e){e[e.estimate=0]=\\\"estimate\\\",e[e.actualBounding=1]=\\\"actualBounding\\\",e[e.fontBounding=2]=\\\"fontBounding\\\"}(MeasureModeEnum=MeasureModeEnum||{}),init_esbuild_inject(),init_esbuild_inject(),__toESM(require_eventemitter3())),isType=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),(e,t)=>Object.prototype.toString.call(e)===`[object ${t}]`),isType_default=isType,isBoolean=(e,t=!1)=>t?\\\"boolean\\\"==typeof e:!0===e||!1===e||isType_default(e,\\\"Boolean\\\"),isBoolean_default=isBoolean,isFunction=(init_esbuild_inject(),e=>\\\"function\\\"==typeof e),isFunction_default=isFunction,isNil=(init_esbuild_inject(),e=>null==e),isNil_default=isNil,isValid=(init_esbuild_inject(),e=>null!=e),isValid_default=isValid,isObject=(init_esbuild_inject(),e=>{var t=typeof e;return null!==e&&\\\"object\\\"==t||\\\"function\\\"==t}),isObject_default=isObject,isObjectLike=(init_esbuild_inject(),e=>\\\"object\\\"==typeof e&&null!==e),isObjectLike_default=isObjectLike,isPlainObject=(init_esbuild_inject(),function(e){if(!isObjectLike_default(e)||!isType_default(e,\\\"Object\\\"))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}),isPlainObject_default=isPlainObject,isUndefined=(init_esbuild_inject(),e=>void 0===e),isUndefined_default=isUndefined,isString=(init_esbuild_inject(),(e,t=!1)=>{var i=typeof e;return t?\\\"string\\\"==i:\\\"string\\\"==i||isType_default(e,\\\"String\\\")}),isString_default=isString,isArray=(init_esbuild_inject(),e=>Array.isArray?Array.isArray(e):isType_default(e,\\\"Array\\\")),isArray_default=isArray,isArrayLike=(init_esbuild_inject(),function(e){return null!==e&&\\\"function\\\"!=typeof e&&Number.isFinite(e.length)}),isArrayLike_default=isArrayLike,isDate=(init_esbuild_inject(),e=>isType_default(e,\\\"Date\\\")),isDate_default=isDate,isNumber=(init_esbuild_inject(),(e,t=!1)=>{var i=typeof e;return t?\\\"number\\\"==i:\\\"number\\\"==i||isType_default(e,\\\"Number\\\")}),isNumber_default=isNumber,isValidNumber=(init_esbuild_inject(),e=>isNumber_default(e)&&Number.isFinite(e)),isValidNumber_default=isValidNumber,isValidUrl=(init_esbuild_inject(),e=>new RegExp(/^(http(s)?:\\\\/\\\\/)\\\\w+[^\\\\s]+(\\\\.[^\\\\s]+){1,}$/).test(e)),isValidUrl_default=isValidUrl,isBase64=(init_esbuild_inject(),e=>new RegExp(/^data:image\\\\/(?:gif|png|jpeg|bmp|webp|svg\\\\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(e)),isBase64_default=isBase64,getType=(init_esbuild_inject(),init_esbuild_inject(),e=>({}).toString.call(e).replace(/^\\\\[object /,\\\"\\\").replace(/]$/,\\\"\\\")),getType_default=getType,objectProto=(init_esbuild_inject(),Object.prototype),isPrototype=function(e){var t=e&&e.constructor;return e===(\\\"function\\\"==typeof t&&t.prototype||objectProto)},isPrototype_default=isPrototype,hasOwnProperty=Object.prototype.hasOwnProperty;function isEmpty(e){if(!isNil_default(e)){if(isArrayLike_default(e))return!e.length;var t=getType_default(e);if(\\\"Map\\\"===t||\\\"Set\\\"===t)return!e.size;if(isPrototype_default(e))return!Object.keys(e).length;for(const i in e)if(hasOwnProperty.call(e,i))return!1}return!0}var isEmpty_default=isEmpty,hasOwnProperty2=(init_esbuild_inject(),Object.prototype.hasOwnProperty),has=(e,t)=>null!=e&&hasOwnProperty2.call(e,t),has_default=has;function cloneDeep(e,t,i){if(!isValid_default(e)||\\\"object\\\"!=typeof e||t&&t(e))return e;var r=isArray_default(e),o=e.length,n=r?new Array(o):\\\"object\\\"==typeof e?{}:isBoolean_default(e)||isNumber_default(e)||isString_default(e)?e:isDate_default(e)?new Date(+e):void 0,a=r?void 0:Object.keys(Object(e));let l=-1;if(n)for(;++l<(a||e).length;){var s=a?a[l]:l,h=e[s];i&&i.includes(s.toString())?n[s]=h:n[s]=cloneDeep(h,t,i)}return n}function baseMerge(i,r,o=!1,n=!1){if(r&&i!==r&&isValid_default(r)&&\\\"object\\\"==typeof r){var a=Object(r),l=[];for(const h in a)l.push(h);let e=l.length,t=-1;for(;e--;){var s=l[++t];!isValid_default(a[s])||\\\"object\\\"!=typeof a[s]||n&&isArray_default(i[s])?assignMergeValue(i,s,a[s]):baseMergeDeep(i,r,s,o,n)}}}function baseMergeDeep(e,t,i,r=!1,o=!1){var n=e[i],a=t[i];let l=t[i],s=!0;if(isArray_default(a)){if(r)l=[];else if(isArray_default(n))l=n;else if(isArrayLike_default(n)){l=new Array(n.length);let e=-1;for(var h=n.length;++e<h;)l[e]=n[e]}}else isPlainObject_default(a)?l=\\\"function\\\"!=typeof n&&\\\"object\\\"==typeof n&&null!=n?n:{}:s=!1;s&&baseMerge(l,a,r,o),assignMergeValue(e,i,l)}function assignMergeValue(e,t,i){(void 0===i||eq(e[t],i))&&(void 0!==i||t in e)||(e[t]=i)}function eq(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function merge(e,...t){let i=-1;for(var r=t.length;++i<r;)baseMerge(e,t[i],!0);return e}function objToString(e){return Object.prototype.toString.call(e)}function objectKeys(e){return Object.keys(e)}function isEqual(i,r,o){if(i!==r){if(typeof i!=typeof r)return!1;if(null==i||null==r)return!1;if(!Number.isNaN(i)||!Number.isNaN(r)){if(objToString(i)!==objToString(r))return!1;if(isFunction_default(i))return!(null==o||!o.skipFunction);if(\\\"object\\\"!=typeof i)return!1;if(isArray_default(i)){if(i.length!==r.length)return!1;for(let e=i.length-1;0<=e;e--)if(!isEqual(i[e],r[e],o))return!1}else{if(!isPlainObject_default(i))return!1;var n=objectKeys(i),a=objectKeys(r);if(n.length!==a.length)return!1;n.sort(),a.sort();for(let e=n.length-1;0<=e;e--)if(n[e]!=a[e])return!1;for(let t=n.length-1;0<=t;t--){var l=n[t];if(!isEqual(i[l],r[l],o))return!1}}}}return!0}function arrayEqual(e,t){if(!isArray_default(e)||!isArray_default(t))return!1;if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var LoggerLevel,hasConsole=\\\"undefined\\\"!=typeof console;function log(e,t,i){var r=[t].concat([].slice.call(i));hasConsole&&console[e].apply(console,r)}!function(e){e[e.None=0]=\\\"None\\\",e[e.Error=1]=\\\"Error\\\",e[e.Warn=2]=\\\"Warn\\\",e[e.Info=3]=\\\"Info\\\",e[e.Debug=4]=\\\"Debug\\\"}(LoggerLevel=LoggerLevel||{});var Logger=class Ik{static getInstance(e,t){return Ik._instance&&isNumber_default(e)?Ik._instance.level(e):Ik._instance||(Ik._instance=new Ik(e,t)),Ik._instance}static setInstance(e){return Ik._instance=e}static setInstanceLevel(e){Ik._instance?Ik._instance.level(e):Ik._instance=new Ik(e)}static clearInstance(){Ik._instance=null}constructor(e=LoggerLevel.None,t){this._onErrorHandler=[],this._level=e,this._method=t}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){var e=this._onErrorHandler.findIndex(e=>e===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=LoggerLevel.Info}canLogDebug(){return this._level>=LoggerLevel.Debug}canLogError(){return this._level>=LoggerLevel.Error}canLogWarn(){return this._level>=LoggerLevel.Warn}level(e){return arguments.length?(this._level=+e,this):this._level}error(...e){var t;return this._level>=LoggerLevel.Error&&(this._onErrorHandler.length?this.callErrorHandler(...e):log(null!=(t=this._method)?t:\\\"error\\\",\\\"ERROR\\\",e)),this}warn(...e){return this._level>=LoggerLevel.Warn&&log(this._method||\\\"warn\\\",\\\"WARN\\\",e),this}info(...e){return this._level>=LoggerLevel.Info&&log(this._method||\\\"log\\\",\\\"INFO\\\",e),this}debug(...e){return this._level>=LoggerLevel.Debug&&log(this._method||\\\"log\\\",\\\"DEBUG\\\",e),this}},DEFAULT_ABSOLUTE_TOLERATE=(Logger._instance=null,init_esbuild_inject(),1e-10),DEFAULT_RELATIVE_TOLERATE=1e-10;function isNumberClose(e,t,i=DEFAULT_RELATIVE_TOLERATE,r=DEFAULT_ABSOLUTE_TOLERATE){var o=r,n=i*Math.max(e,t);return Math.abs(e-t)<=Math.max(o,n)}init_esbuild_inject();var clamp=function(e,t,i){return e<t?t:i<e?i:e},clamp_default=clamp,clampRange=(init_esbuild_inject(),(e,t,i)=>{let[r,o]=e;o<r&&(r=e[1],o=e[0]);var n=o-r;return i-t<=n?[t,i]:[r=Math.min(Math.max(r,t),i-n),r+n]}),clampRange_default=clampRange,hasRaf=(init_esbuild_inject(),!1);try{hasRaf=\\\"function\\\"==typeof requestAnimationFrame&&\\\"function\\\"==typeof cancelAnimationFrame}catch(err){hasRaf=!1}function debounce(r,o,e){let n,a,l,s,h,d,u=0,c=!1,g=!1,t=!0;const i=!o&&0!==o&&hasRaf;if(\\\"function\\\"!=typeof r)throw new TypeError(\\\"Expected a function\\\");function p(e){var t=n,i=a;return n=a=void 0,u=e,s=r.apply(i,t)}function f(e,t){return i?(cancelAnimationFrame(h),requestAnimationFrame(e)):setTimeout(e,t)}function m(e){var t=e-d;return void 0===d||o<=t||t<0||g&&e-u>=l}function b(){var e,t,i=Date.now();if(m(i))return C(i);h=f(b,(i=(e=i)-u,t=o-(e-d),g?Math.min(t,l-i):t))}function C(e){return h=void 0,t&&n?p(e):(n=a=void 0,s)}function v(...e){var t=Date.now(),i=m(t);if(n=e,a=this,d=t,i){if(void 0===h)return e=d,u=e,h=f(b,o),c?p(e):s;if(g)return h=f(b,o),p(d)}return void 0===h&&(h=f(b,o)),s}return o=+o||0,isObject_default(e)&&(c=!!e.leading,(g=\\\"maxWait\\\"in e)&&(l=Math.max(isValidNumber_default(e.maxWait)?e.maxWait:0,o)),t=\\\"trailing\\\"in e?!!e.trailing:t),v.cancel=function(){var e;void 0!==h&&(e=h,(i?cancelAnimationFrame:clearTimeout)(e)),u=0,n=d=a=h=void 0},v.flush=function(){return void 0===h?s:C(Date.now())},v.pending=function(){return void 0!==h},v}var hasRaf=!1,debounce_default=debounce;function throttle(e,t,i){let r=!0,o=!0;if(\\\"function\\\"!=typeof e)throw new TypeError(\\\"Expected a function\\\");return isObject_default(i)&&(r=\\\"leading\\\"in i?!!i.leading:r,o=\\\"trailing\\\"in i?!!i.trailing:o),debounce_default(e,t,{leading:r,trailing:o,maxWait:t})}init_esbuild_inject();var throttle_default=throttle,epsilon=(init_esbuild_inject(),init_esbuild_inject(),1e-12),pi=Math.PI,halfPi=pi/2,tau=2*pi,pi2=2*Math.PI,abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max=Math.max,min=Math.min,sin=Math.sin,sqrt=Math.sqrt,pow=Math.pow;function acos(e){return 1<e?0:e<-1?pi:Math.acos(e)}function asin(e){return 1<=e?halfPi:e<=-1?-halfPi:Math.asin(e)}function pointAt(e,t,i,r,o){let n=i,a=r;return\\\"number\\\"==typeof e&&\\\"number\\\"==typeof i&&(n=(1-o)*e+o*i),\\\"number\\\"==typeof t&&\\\"number\\\"==typeof r&&(a=(1-o)*t+o*r),{x:n,y:a}}var Point=class mm{constructor(e=0,t=0,i,r){this.x=0,this.y=0,this.x=e,this.y=t,this.x1=i,this.y1=r}clone(){return new mm(this.x,this.y)}copyFrom(e){return this.x=e.x,this.y=e.y,this.x1=e.x1,this.y1=e.y1,this.defined=e.defined,this.context=e.context,this}set(e,t){return this.x=e,this.y=t,this}add(e){return isNumber_default(e)?(this.x+=e,void(this.y+=e)):(this.x+=e.x,this.y+=e.y,this)}sub(e){return isNumber_default(e)?(this.x-=e,void(this.y-=e)):(this.x-=e.x,this.y-=e.y,this)}multi(e){throw new Error(\\\"暂不支持\\\")}div(e){throw new Error(\\\"暂不支持\\\")}},PointService=class{static distancePP(e,t){return sqrt(pow(e.x-t.x,2)+pow(e.y-t.y,2))}static distanceNN(e,t,i,r){return sqrt(pow(e-i,2)+pow(t-r,2))}static distancePN(e,t,i){return sqrt(pow(t-e.x,2)+pow(i-e.y,2))}static pointAtPP(e,t,i){return new Point((t.x-e.x)*i+e.x,(t.y-e.y)*i+e.y)}};function degreeToRadian(e){return e*(Math.PI/180)}function radianToDegree(e){return 180*e/Math.PI}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var InnerBBox,clampRadian=(e=0)=>{if(e<0)for(;e<-tau;)e+=tau;else if(0<e)for(;tau<e;)e-=tau;return e},clampAngleByRadian=clampRadian;function getRectIntersect(e,t,i){var r,o,n,a,l,s,h,d;return null===e?t:null===t?e:(({x11:r,x12:o,y11:n,y12:a,x21:l,x22:s,y21:h,y22:d}=formatTwoBBox(e,t,i)),s<=r||o<=l||d<=n||a<=h?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(r,l),y1:Math.max(n,h),x2:Math.min(o,s),y2:Math.min(a,d)})}!function(e){e[e.NONE=0]=\\\"NONE\\\",e[e.BBOX1=1]=\\\"BBOX1\\\",e[e.BBOX2=2]=\\\"BBOX2\\\"}(InnerBBox=InnerBBox||{});var formatTwoBBox=(e,t,i)=>{let r=e.x1,o=e.x2,n=e.y1,a=e.y2,l=t.x1,s=t.x2,h=t.y1,d=t.y2;return i&&(r>o&&([r,o]=[o,r]),n>a&&([n,a]=[a,n]),l>s&&([l,s]=[s,l]),h>d)&&([h,d]=[d,h]),{x11:r,x12:o,y11:n,y12:a,x21:l,x22:s,y21:h,y22:d}};function rectInsideAnotherRect(e,t,i){var r,o,n,a,l,s,h,d;return e&&t?(({x11:r,x12:o,y11:n,y12:a,x21:l,x22:s,y21:h,y22:d}=formatTwoBBox(e,t,i)),l<r&&o<s&&h<n&&a<d?InnerBBox.BBOX1:r<l&&s<o&&n<h&&d<a?InnerBBox.BBOX2:InnerBBox.NONE):InnerBBox.NONE}function isRectIntersect(e,t,i){var r,o,n,a,l,s,h,d;return!(e&&t&&(i?(({x11:r,x12:o,y11:n,y12:a,x21:l,x22:s,y21:h,y22:d}=formatTwoBBox(e,t,!0)),s<r||o<l||d<n||a<h):e.x1>t.x2||e.x2<t.x1||e.y1>t.y2||e.y2<t.y1))}function getProjectionRadius(e,t){return Math.abs(t[0]*e[0]+t[1]*e[1])}function rotatePoint({x:e,y:t},i,r={x:0,y:0}){return{x:(e-r.x)*Math.cos(i)-(t-r.y)*Math.sin(i)+r.x,y:(e-r.x)*Math.sin(i)+(t-r.y)*Math.cos(i)+r.y}}function getCenterPoint(e){return{x:(e.x1+e.x2)/2,y:(e.y1+e.y2)/2}}function toRect(e,t){var i=t?degreeToRadian(e.angle):e.angle,r=getCenterPoint(e);return[rotatePoint({x:e.x1,y:e.y1},i,r),rotatePoint({x:e.x2,y:e.y1},i,r),rotatePoint({x:e.x2,y:e.y2},i,r),rotatePoint({x:e.x1,y:e.y2},i,r)]}function isRotateAABBIntersect(e,t,i=!1){const r=toRect(e,i),o=toRect(t,i),n=(e,t)=>[t.x-e.x,t.y-e.y],a=n(getCenterPoint(e),getCenterPoint(t)),l=n(r[0],r[1]),s=n(r[1],r[2]),h=n(o[0],o[1]),d=n(o[1],o[2]),u=i?degreeToRadian(e.angle):e.angle;let c=i?degreeToRadian(90-e.angle):e.angle+halfPi;var g=i?degreeToRadian(t.angle):t.angle;let p=i?degreeToRadian(90-t.angle):t.angle+halfPi;c>pi2&&(c-=pi2),p>pi2&&(p-=pi2);var f=(e,t,i,r)=>{var o=[Math.cos(t),Math.sin(t)];return e+(getProjectionRadius(o,i)+getProjectionRadius(o,r))/2>getProjectionRadius(o,a)};return f((e.x2-e.x1)/2,u,h,d)&&f((e.y2-e.y1)/2,c,h,d)&&f((t.x2-t.x1)/2,g,l,s)&&f((t.y2-t.y1)/2,p,l,s)}init_esbuild_inject();var eastAsianCharacterInfo=e=>{let t=e.charCodeAt(0),i=2===e.length?e.charCodeAt(1):0,r=t;return 55296<=t&&t<=56319&&56320<=i&&i<=57343&&(t&=1023,i&=1023,r=t<<10|i,r+=65536),12288===r||65281<=r&&r<=65376||65504<=r&&r<=65510?\\\"F\\\":8361===r||65377<=r&&r<=65470||65474<=r&&r<=65479||65482<=r&&r<=65487||65490<=r&&r<=65495||65498<=r&&r<=65500||65512<=r&&r<=65518?\\\"H\\\":4352<=r&&r<=4447||4515<=r&&r<=4519||4602<=r&&r<=4607||9001<=r&&r<=9002||11904<=r&&r<=11929||11931<=r&&r<=12019||12032<=r&&r<=12245||12272<=r&&r<=12283||12289<=r&&r<=12350||12353<=r&&r<=12438||12441<=r&&r<=12543||12549<=r&&r<=12589||12593<=r&&r<=12686||12688<=r&&r<=12730||12736<=r&&r<=12771||12784<=r&&r<=12830||12832<=r&&r<=12871||12880<=r&&r<=13054||13056<=r&&r<=19903||19968<=r&&r<=42124||42128<=r&&r<=42182||43360<=r&&r<=43388||44032<=r&&r<=55203||55216<=r&&r<=55238||55243<=r&&r<=55291||63744<=r&&r<=64255||65040<=r&&r<=65049||65072<=r&&r<=65106||65108<=r&&r<=65126||65128<=r&&r<=65131||110592<=r&&r<=110593||127488<=r&&r<=127490||127504<=r&&r<=127546||127552<=r&&r<=127560||127568<=r&&r<=127569||131072<=r&&r<=194367||177984<=r&&r<=196605||196608<=r&&r<=262141?\\\"W\\\":32<=r&&r<=126||162<=r&&r<=163||165<=r&&r<=166||172===r||175===r||10214<=r&&r<=10221||10629<=r&&r<=10630?\\\"Na\\\":161===r||164===r||167<=r&&r<=168||170===r||173<=r&&r<=174||176<=r&&r<=180||182<=r&&r<=186||188<=r&&r<=191||198===r||208===r||215<=r&&r<=216||222<=r&&r<=225||230===r||232<=r&&r<=234||236<=r&&r<=237||240===r||242<=r&&r<=243||247<=r&&r<=250||252===r||254===r||257===r||273===r||275===r||283===r||294<=r&&r<=295||299===r||305<=r&&r<=307||312===r||319<=r&&r<=322||324===r||328<=r&&r<=331||333===r||338<=r&&r<=339||358<=r&&r<=359||363===r||462===r||464===r||466===r||468===r||470===r||472===r||474===r||476===r||593===r||609===r||708===r||711===r||713<=r&&r<=715||717===r||720===r||728<=r&&r<=731||733===r||735===r||768<=r&&r<=879||913<=r&&r<=929||931<=r&&r<=937||945<=r&&r<=961||963<=r&&r<=969||1025===r||1040<=r&&r<=1103||1105===r||8208===r||8211<=r&&r<=8214||8216<=r&&r<=8217||8220<=r&&r<=8221||8224<=r&&r<=8226||8228<=r&&r<=8231||8240===r||8242<=r&&r<=8243||8245===r||8251===r||8254===r||8308===r||8319===r||8321<=r&&r<=8324||8364===r||8451===r||8453===r||8457===r||8467===r||8470===r||8481<=r&&r<=8482||8486===r||8491===r||8531<=r&&r<=8532||8539<=r&&r<=8542||8544<=r&&r<=8555||8560<=r&&r<=8569||8585===r||8592<=r&&r<=8601||8632<=r&&r<=8633||8658===r||8660===r||8679===r||8704===r||8706<=r&&r<=8707||8711<=r&&r<=8712||8715===r||8719===r||8721===r||8725===r||8730===r||8733<=r&&r<=8736||8739===r||8741===r||8743<=r&&r<=8748||8750===r||8756<=r&&r<=8759||8764<=r&&r<=8765||8776===r||8780===r||8786===r||8800<=r&&r<=8801||8804<=r&&r<=8807||8810<=r&&r<=8811||8814<=r&&r<=8815||8834<=r&&r<=8835||8838<=r&&r<=8839||8853===r||8857===r||8869===r||8895===r||8978===r||9312<=r&&r<=9449||9451<=r&&r<=9547||9552<=r&&r<=9587||9600<=r&&r<=9615||9618<=r&&r<=9621||9632<=r&&r<=9633||9635<=r&&r<=9641||9650<=r&&r<=9651||9654<=r&&r<=9655||9660<=r&&r<=9661||9664<=r&&r<=9665||9670<=r&&r<=9672||9675===r||9678<=r&&r<=9681||9698<=r&&r<=9701||9711===r||9733<=r&&r<=9734||9737===r||9742<=r&&r<=9743||9748<=r&&r<=9749||9756===r||9758===r||9792===r||9794===r||9824<=r&&r<=9825||9827<=r&&r<=9829||9831<=r&&r<=9834||9836<=r&&r<=9837||9839===r||9886<=r&&r<=9887||9918<=r&&r<=9919||9924<=r&&r<=9933||9935<=r&&r<=9953||9955===r||9960<=r&&r<=9983||10045===r||10071===r||10102<=r&&r<=10111||11093<=r&&r<=11097||12872<=r&&r<=12879||57344<=r&&r<=63743||65024<=r&&r<=65039||65533===r||127232<=r&&r<=127242||127248<=r&&r<=127277||127280<=r&&r<=127337||127344<=r&&r<=127386||917760<=r&&r<=917999||983040<=r&&r<=1048573||1048576<=r&&r<=1114109?\\\"A\\\":\\\"N\\\"};function getContextFont(e,t={},i){var{fontStyle:r=t.fontStyle,fontVariant:o=t.fontVariant,fontWeight:n=t.fontWeight,fontSize:a=t.fontSize,fontFamily:l=t.fontFamily}=e;return(r?r+\\\" \\\":\\\"\\\")+(o?o+\\\" \\\":\\\"\\\")+(n?n+\\\" \\\":\\\"\\\")+a*(i=i||1)+\\\"px \\\"+(l||\\\"sans-serif\\\")}init_esbuild_inject(),init_esbuild_inject();var TextMeasure=class yo{constructor(e,t){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'\\\"~`,this._option=e,this._userSpec=null!=t?t:{},this.textSpec=this._initSpec(),isValid_default(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=(isValid_default(e.getTextBounds)?this.fullMeasure:this.measureWithNaiveCanvas).bind(this)}initContext(){var e;return!this._notSupportCanvas&&(isNil_default(this._canvas)&&(isValid_default(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),isNil_default(this._canvas))&&\\\"undefined\\\"!=typeof window&&void 0!==window.document&&globalThis&&isValid_default(globalThis.document)&&(this._canvas=globalThis.document.createElement(\\\"canvas\\\")),isNil_default(this._context)&&isValid_default(this._canvas)&&(e=this._canvas.getContext(\\\"2d\\\"),isValid_default(e))&&(e.save(),e.font=getContextFont(this.textSpec),this._contextSaved=!0,this._context=e),!isNil_default(this._context)||!(this._notSupportCanvas=!0))}_initSpec(){var e,{defaultFontParams:t={}}=this._option,{fontStyle:i=t.fontStyle,fontVariant:r=t.fontVariant,fontWeight:o=null!=(o=t.fontWeight)?o:\\\"normal\\\",fontSize:n=null!=(n=t.fontSize)?n:12,fontFamily:t=null!=(t=t.fontFamily)?t:\\\"sans-serif\\\",align:a,textAlign:a=null!=a?a:\\\"center\\\",baseline:l,textBaseline:l=null!=l?l:\\\"middle\\\",ellipsis:s,limit:h}=this._userSpec;let{lineHeight:d=n}=this._userSpec;return isString_default(d)&&\\\"%\\\"===d[d.length-1]&&(e=Number.parseFloat(d.substring(0,d.length-1))/100,d=n*e),{fontStyle:i,fontVariant:r,fontFamily:t,fontSize:n,fontWeight:o,textAlign:a,textBaseline:l,ellipsis:s,limit:h,lineHeight:d}}measure(e,t){switch(t){case\\\"vrender\\\":case\\\"canopus\\\":return this.fullMeasure(e);case\\\"canvas\\\":return this.measureWithNaiveCanvas(e);case\\\"simple\\\":return this.quickMeasureWithoutCanvas(e);default:return this.quickMeasure(e)}}fullMeasure(e){if(isNil_default(e))return{width:0,height:0};if(isNil_default(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(e);var{fontFamily:t,fontSize:i,fontWeight:r,textAlign:o,textBaseline:n,ellipsis:a,limit:l,lineHeight:s}=this.textSpec;let h;try{var d=this._option.getTextBounds({text:e,fontFamily:t,fontSize:i,fontWeight:r,textAlign:o,textBaseline:n,ellipsis:!!a,maxLineWidth:l||1/0,lineHeight:s});h={width:d.width(),height:d.height()}}catch(u){this._notSupportVRender=!0,h=this.measureWithNaiveCanvas(e)}return h}measureWithNaiveCanvas(e){return this._measureReduce(e,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(e){var t,i,r;return this.initContext()?(t=this._context.measureText(e),({fontSize:i,lineHeight:r}=this.textSpec),{width:t.width,height:null!=(r=r)?r:i,fontBoundingBoxAscent:t.fontBoundingBoxAscent,fontBoundingBoxDescent:t.fontBoundingBoxDescent}):this._quickMeasureWithoutCanvas(e)}quickMeasure(e){return this._measureReduce(e,this._quickMeasure.bind(this))}_quickMeasure(t){var i={width:0,height:0};for(let o=0;o<t.length;o++){var r=t[o];let e=this._measureSpecialChar(r);isNil_default(e)&&yo.NUMBERS_CHAR_SET.includes(r)&&(e=this._measureNumberChar()),isNil_default(e)&&[\\\"F\\\",\\\"W\\\"].includes(eastAsianCharacterInfo(r))&&(e=this._measureFullSizeChar()),isNil_default(e)&&(e=this._measureLetterChar()),i.width+=e.width,i.height=Math.max(i.height,e.height),isNil_default(e.fontBoundingBoxAscent)||(i.fontBoundingBoxAscent=e.fontBoundingBoxAscent),isNil_default(e.fontBoundingBoxDescent)||(i.fontBoundingBoxDescent=e.fontBoundingBoxDescent)}return i}quickMeasureWithoutCanvas(e){return this._measureReduce(e,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(e){var t={width:0,height:0},{fontSize:i,lineHeight:r}=this.textSpec;for(let n=0;n<e.length;n++){var o=e[n],o=[\\\"F\\\",\\\"W\\\"].includes(eastAsianCharacterInfo(o))?1:.53;t.width+=o*i}return t.height=null!=(r=r)?r:i,t}_measureReduce(e,i){var t,{fontSize:r,lineHeight:o}=this.textSpec,n={width:0,height:0};return isNil_default(e)?n:isArray_default(e)?0===(t=e.filter(isValid_default).map(e=>e.toString())).length?n:1===t.length?i(t[0]):{width:t.reduce((e,t)=>Math.max(e,i(t).width),0),height:t.length*((null!=(n=o)?n:r)+1)+1}:i(e.toString())}_measureNumberChar(){var e;return isNil_default(this._numberCharSize)&&(e=this._standardMethod(yo.NUMBERS_CHAR_SET),this._numberCharSize={width:e.width/yo.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}),this._numberCharSize}_measureFullSizeChar(){return isNil_default(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(yo.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){var e;return isNil_default(this._letterCharSize)&&(e=this._standardMethod(yo.ALPHABET_CHAR_SET),this._letterCharSize={width:e.width/yo.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}),this._letterCharSize}_measureSpecialChar(e){return isValid_default(this._specialCharSizeMap[e])?this._specialCharSizeMap[e]:this.specialCharSet.includes(e)?(this._specialCharSizeMap[e]=this._standardMethod(e),this._specialCharSizeMap[e]):null}release(){isValid_default(this._canvas)&&(this._canvas=null),isValid_default(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}};function transformBoundsWithMatrix(e,t,i){var{x1:r,y1:o,x2:n,y2:a}=t;return i.onlyTranslate()?(e!==t&&e.setValue(t.x1,t.y1,t.x2,t.y2),e.translate(i.e,i.f)):(e.clear(),e.add(i.a*r+i.c*o+i.e,i.b*r+i.d*o+i.f),e.add(i.a*n+i.c*o+i.e,i.b*n+i.d*o+i.f),e.add(i.a*n+i.c*a+i.e,i.b*n+i.d*a+i.f),e.add(i.a*r+i.c*a+i.e,i.b*r+i.d*a+i.f)),t}TextMeasure.ALPHABET_CHAR_SET=\\\"abcdefghijklmnopqrstuvwxyz\\\",TextMeasure.NUMBERS_CHAR_SET=\\\"0123456789\\\",TextMeasure.FULL_SIZE_CHAR=\\\"字\\\";var Bounds=class Up{constructor(e){e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}clone(){return new Up(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}setValue(e=0,t=0,i=0,r=0){return this.x1=e,this.y1=t,this.x2=i,this.y2=r,this}set(e=0,t=0,i=0,r=0){return i<e?(this.x2=e,this.x1=i):(this.x1=e,this.x2=i),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this}add(e=0,t=0){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this}expand(e=0){return isArray_default(e)?(this.y1-=e[0],this.x2+=e[1],this.y2+=e[2],this.x1-=e[3]):(this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(e=0,t=0){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this}rotate(e=0,t=0,i=0){var r=this.rotatedPoints(e,t,i);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])}scale(e=0,t=0,i=0,r=0){var o=this.scalePoints(e,t,i,r);return this.clear().add(o[0],o[1]).add(o[2],o[3])}union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this}intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this}encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2}alignsWith(e){return e&&(this.x1===e.x1||this.x2===e.x2||this.y1===e.y1||this.y2===e.y2)}intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)}contains(e=0,t=0){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)}containsPoint(e){return!(e.x<this.x1||e.x>this.x2||e.y<this.y1||e.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(e=0){return this.x1*=e,this.x2*=e,this}scaleY(e=0){return this.y1*=e,this.y2*=e,this}transformWithMatrix(e){return transformBoundsWithMatrix(this,this,e),this}copy(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this}rotatedPoints(e,t,i){var{x1:r,y1:o,x2:n,y2:a}=this,l=Math.cos(e),s=Math.sin(e),h=t-t*l+i*s,d=i-t*s-i*l;return[l*r-s*o+h,s*r+l*o+d,l*r-s*a+h,s*r+l*a+d,l*n-s*o+h,s*n+l*o+d,l*n-s*a+h,s*n+l*a+d]}scalePoints(e,t,i,r){var{x1:o,y1:n,x2:a,y2:l}=this;return[e*o+(1-e)*i,t*n+(1-t)*r,e*a+(1-e)*i,t*l+(1-t)*r]}},AABBBounds=class extends Bounds{},OBBBounds=class Xq extends Bounds{constructor(e,t=0){var i;super(e),e&&(this.angle=null!=(i=e.angle)?i:t)}intersects(e){return isRotateAABBIntersect(this,e)}setValue(e=0,t=0,i=0,r=0,o=0){return super.setValue(e,t,i,r),this.angle=o,this}clone(){return new Xq(this)}},Matrix=(init_esbuild_inject(),class fr{constructor(e=1,t=0,i=0,r=1,o=0,n=0){this.a=e,this.b=t,this.c=i,this.d=r,this.e=o,this.f=n}equalToMatrix(e){return!(this.e!==e.e||this.f!==e.f||this.a!==e.a||this.d!==e.d||this.b!==e.b||this.c!==e.c)}equalTo(e,t,i,r,o,n){return!(this.e!==o||this.f!==n||this.a!==e||this.d!==r||this.b!==t||this.c!==i)}setValue(e,t,i,r,o,n){return this.a=e,this.b=t,this.c=i,this.d=r,this.e=o,this.f=n,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){var e=this.a,t=this.b,i=this.c,r=this.d,o=this.e,n=this.f,a=new fr,l=e*r-t*i;return a.a=r/l,a.b=-t/l,a.c=-i/l,a.d=e/l,a.e=(i*n-r*o)/l,a.f=-(e*n-t*o)/l,a}rotate(e){var t=Math.cos(e),i=Math.sin(e),r=this.a*t+this.c*i,o=this.b*t+this.d*i,n=this.a*-i+this.c*t,i=this.b*-i+this.d*t;return this.a=r,this.b=o,this.c=n,this.d=i,this}rotateByCenter(e,t,i){var r=Math.cos(e),o=Math.sin(e),n=r*this.a-o*this.b,a=o*this.a+r*this.b,l=r*this.c-o*this.d,s=o*this.c+r*this.d,h=r*this.e-o*this.f+((1-r)*t+o*i),r=o*this.e+r*this.f+((1-r)*i-o*t);return this.a=n,this.b=a,this.c=l,this.d=s,this.e=h,this.f=r,this}scale(e,t){return this.a*=e,this.b*=e,this.c*=t,this.d*=t,this}setScale(e,t){return this.b=this.b/this.a*e,this.c=this.c/this.d*t,this.a=e,this.d=t,this}transform(e,t,i,r,o,n){return this.multiply(e,t,i,r,o,n),this}translate(e,t){return this.e+=this.a*e+this.c*t,this.f+=this.b*e+this.d*t,this}transpose(){var{a:e,b:t,c:i,d:r,e:o,f:n}=this;return this.a=t,this.b=e,this.c=r,this.d=i,this.e=n,this.f=o,this}multiply(e,t,i,r,o,n){var a=this.a,l=this.b,s=this.c,h=this.d,d=l*e+h*t,u=a*i+s*r,c=l*i+h*r,g=a*o+s*n+this.e,l=l*o+h*n+this.f;return this.a=a*e+s*t,this.b=d,this.c=u,this.d=c,this.e=g,this.f=l,this}interpolate(e,t){var i=new fr;return i.a=this.a+(e.a-this.a)*t,i.b=this.b+(e.b-this.b)*t,i.c=this.c+(e.c-this.c)*t,i.d=this.d+(e.d-this.d)*t,i.e=this.e+(e.e-this.e)*t,i.f=this.f+(e.f-this.f)*t,i}transformPoint(e,t){var{a:i,b:r,c:o,d:n,e:a,f:l}=this,s=i*n-r*o,h=-r/s,d=i/s,i=-(i*l-r*a)/s,{x:r,y:u}=e;t.x=r*(n/s)+u*(-o/s)+(o*l-n*a)/s,t.y=r*h+u*d+i}onlyTranslate(e=1){return this.a===e&&0===this.b&&0===this.c&&this.d===e}clone(){return new fr(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){var e,t=this.a,i=this.b,r=this.c,o=this.d,n=t*o-i*r,a={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};return 0!==t||0!==i?(e=Math.sqrt(t*t+i*i),a.rotateDeg=0<i?Math.acos(t/e):-Math.acos(t/e),a.scaleX=e,a.scaleY=n/e,a.skewX=(t*r+i*o)/n,a.skewY=0):0===r&&0===o||(e=Math.sqrt(r*r+o*o),a.rotateDeg=Math.PI/2-(0<o?Math.acos(-r/e):-Math.acos(r/e)),a.scaleX=n/e,a.scaleY=e,a.skewX=0,a.skewY=(t*r+i*o)/n),a.rotateDeg=radianToDegree(a.rotateDeg),a}});function normalTransform(e,t,i,r,o,n,a,l){var s=t.a,h=t.b,d=t.c,u=t.d,c=t.e,g=t.f,p=cos(a),f=sin(a);let m,b;b=l?(m=l[0],l[1]):(m=i,r);var C=m-i,v=b-r,y=s*p+d*f,w=h*p+u*f,_=d*p-s*f,p=u*p-h*f;e.a=o*y,e.b=o*w,e.c=n*_,e.d=n*p,e.e=c+s*m+d*b-y*C-_*v,e.f=g+h*m+u*b-w*C-p*v}init_esbuild_inject();var LRU=class{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(t,e){let{CLEAN_THRESHOLD:i=this.CLEAN_THRESHOLD,L_TIME:r=this.L_TIME,R_COUNT:o=this.R_COUNT}=e;if(t.size<i)return 0;let n=0;const a=e=>{n++,t[\\\"delete\\\"](e)},l=Date.now();return t.forEach((e,t)=>{if(e.timestamp.length<o)return a(t);let i=0;for(;l-e.timestamp[e.timestamp.length-1-i]<r&&!(++i>=o););if(i<o)return a(t);for(;l-e.timestamp[0]>r;)e.timestamp.shift()}),n}addLimitedTimestamp(e,t,i){var{R_TIMESTAMP_MAX_SIZE:r=this.R_TIMESTAMP_MAX_SIZE}=i;e.timestamp.length>r&&e.timestamp.shift(),e.timestamp.push(t)}clearTimeStamp(e,t){let{L_TIME:i=this.L_TIME}=t,r=Date.now();e.forEach(e=>{for(;r-e.timestamp[0]>i;)e.timestamp.shift()})}clearItemTimestamp(e,t){for(var{L_TIME:i=this.L_TIME}=t,r=Date.now();r-e.timestamp[0]>i;)e.timestamp.shift()}};function hslToRgb(e,t,i){t/=100,i/=100;var r=(1-Math.abs(2*i-1))*t,o=r*(1-Math.abs(e/60%2-1)),n=i-r/2;let a=0,l=0,s=0;return 0<=e&&e<60?(a=r,l=o,s=0):60<=e&&e<120?(a=o,l=r,s=0):120<=e&&e<180?(a=0,l=r,s=o):180<=e&&e<240?(a=0,l=o,s=r):240<=e&&e<300?(a=o,l=0,s=r):300<=e&&e<360&&(a=r,l=0,s=o),a=Math.round(255*(a+n)),l=Math.round(255*(l+n)),s=Math.round(255*(s+n)),{r:a,g:l,b:s}}function rgbToHsl(e,t,i){e/=255,t/=255,i/=255;var r=Math.min(e,t,i),o=Math.max(e,t,i),n=o-r;let a=0,l,s;return a=0==n?0:o===e?(t-i)/n%6:o===t?(i-e)/n+2:(e-t)/n+4,(a=Math.round(60*a))<0&&(a+=360),s=(o+r)/2,l=+(100*(0==n?0:n/(1-Math.abs(2*s-1)))).toFixed(1),s=+(100*s).toFixed(1),{h:a,s:l,l:s}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var REG_HEX=/^#([0-9a-f]{3,8})$/,DEFAULT_COLORS_OPACITY={transparent:4294967040},DEFAULT_COLORS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?\\\"0\\\":\\\"\\\")+e.toString(16)}function rgb(e){return isNumber_default(e)?new RGB(e>>16,e>>8&255,255&e,1):isArray_default(e)?new RGB(e[0],e[1],e[2]):new RGB(255,255,255)}function rgba(e){return isNumber_default(e)?new RGB(e>>>24,e>>>16&255,e>>>8&255,255&e):isArray_default(e)?new RGB(e[0],e[1],e[2],e[3]):new RGB(255,255,255,1)}function SRGBToLinear(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function LinearToSRGB(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var setHex=(e,t)=>{var i,r=REG_HEX.exec(e);if(t||r)return i=parseInt(r[1],16),3===(r=r[1].length)?new RGB((i>>8&15)+((i>>8&15)<<4),(i>>4&15)+((i>>4&15)<<4),(15&i)+((15&i)<<4),1):6===r?rgb(i):8===r?new RGB(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):null},Color=class Gu{static Brighter(e,t=1){return 1===t?e:new Gu(e).brighter(t).toRGBA()}static SetOpacity(e,t=1){return 1===t?e:new Gu(e).setOpacity(t).toRGBA()}static getColorBrightness(e,t=\\\"hsl\\\"){var i=e instanceof Gu?e:new Gu(e);switch(t){case\\\"hsv\\\":default:return i.getHSVBrightness();case\\\"hsl\\\":return i.getHSLBrightness();case\\\"lum\\\":return i.getLuminance();case\\\"lum2\\\":return i.getLuminance2();case\\\"lum3\\\":return i.getLuminance3();case\\\"wcag\\\":return i.getLuminanceWCAG()}}static parseColorString(e){var t,i;return isValid_default(DEFAULT_COLORS_OPACITY[e])?rgba(DEFAULT_COLORS_OPACITY[e]):isValid_default(DEFAULT_COLORS[e])?rgb(DEFAULT_COLORS[e]):(i=(\\\"\\\"+e).trim().toLowerCase(),void 0!==(t=setHex(i))?t:/^(rgb|RGB|rgba|RGBA)/.test(i)?(t=i.replace(/(?:\\\\(|\\\\)|rgba|RGBA|rgb|RGB)*/g,\\\"\\\").split(\\\",\\\"),new RGB(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),parseFloat(t[3]))):/^(hsl|HSL|hsla|HSLA)/.test(i)?(t=i.replace(/(?:\\\\(|\\\\)|hsla|HSLA|hsl|HSL)*/g,\\\"\\\").split(\\\",\\\"),i=hslToRgb(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)),new RGB(i.r,i.g,i.b,parseFloat(t[3]))):void 0)}constructor(e){var t=Gu.parseColorString(e);t?this.color=t:(console.warn(`Warn: 传入${e}无法解析为Color`),this.color=new RGB(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(e){var{r:t,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(t*e))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*e))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*e))),this}add(e){var{r:t,g:i,b:r}=this.color;return this.color.r+=Math.min(255,t+e.color.r),this.color.g+=Math.min(255,i+e.color.g),this.color.b+=Math.min(255,r+e.color.b),this}sub(e){return this.color.r=Math.max(0,this.color.r-e.color.r),this.color.g=Math.max(0,this.color.g-e.color.g),this.color.b=Math.max(0,this.color.b-e.color.b),this}multiply(e){var{r:t,g:i,b:r}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(t*e.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(i*e.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(r*e.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return.5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(e,t,i){var r=this.color.opacity,o=rgbToHsl(this.color.r,this.color.g,this.color.b),o=hslToRgb(isNil_default(e)?o.h:clamp_default(e,0,360),isNil_default(t)?o.s:0<=t&&t<=1?100*t:t,isNil_default(i)?o.l:i<=1&&0<=i?100*i:i);return this.color=new RGB(o.r,o.g,o.b,r),this}setRGB(e,t,i){return isNil_default(e)||(this.color.r=e),isNil_default(t)||(this.color.g=t),isNil_default(i)||(this.color.b=i),this}setHex(e){var t=(\\\"\\\"+e).trim().toLowerCase(),t=setHex(t,!0);return null!=t?t:this}setColorName(e){var t=DEFAULT_COLORS[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn(\\\"THREE.Color: Unknown color \\\"+e),this}setScalar(e){return this.color.r=e,this.color.g=e,this.color.b=e,this}setOpacity(e=1){return this.color.opacity=e,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){var e=this.color.r/255,t=this.color.g/255,i=this.color.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((.055+i)/1.055,2.4))}clone(){return new Gu(this.color.toString())}copyGammaToLinear(e,t=2){return this.color.r=Math.pow(e.color.r,t),this.color.g=Math.pow(e.color.g,t),this.color.b=Math.pow(e.color.b,t),this}copyLinearToGamma(e,t=2){var i=0<t?1/t:1;return this.color.r=Math.pow(e.color.r,i),this.color.g=Math.pow(e.color.g,i),this.color.b=Math.pow(e.color.b,i),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.color.r=SRGBToLinear(e.color.r),this.color.g=SRGBToLinear(e.color.g),this.color.b=SRGBToLinear(e.color.b),this}copyLinearToSRGB(e){return this.color.r=LinearToSRGB(e.color.r),this.color.g=LinearToSRGB(e.color.g),this.color.b=LinearToSRGB(e.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}},RGB=class{constructor(e,t,i,r){this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.b=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),isValid_default(r)?this.opacity=isNaN(+r)?1:Math.max(0,Math.min(1,+r)):this.opacity=1}formatHex(){return\\\"#\\\"+(hex(this.r)+hex(this.g)+hex(this.b)+(1===this.opacity?\\\"\\\":hex(255*this.opacity)))}formatRgb(){var e=this.opacity;return(1===e?\\\"rgb(\\\":\\\"rgba(\\\")+this.r+`,${this.g},`+this.b+(1===e?\\\")\\\":`,${e})`)}formatHsl(){var e=this.opacity,{h:t,s:i,l:r}=rgbToHsl(this.r,this.g,this.b);return(1===e?\\\"hsl(\\\":\\\"hsla(\\\")+t+`,${i}%,${r}%`+(1===e?\\\")\\\":`,${e})`)}toString(){return this.formatHex()}};function normalizePadding(e){if(isValidNumber_default(e))return[e,e,e,e];if(isArray_default(e)){var t=e.length;if(1===t)return[i=e[0],i,i,i];if(2===t)return([i,o]=e),[i,o,i,o];if(3===t)return([i,o,r]=e),[i,o,r,o];if(4===t)return e}var i,r,o;return isObject_default(e)?(({top:i=0,right:r=0,bottom:o=0,left:t=0}=e),[i,r,o,t]):[0,0,0,0]}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var currPath,coordsStr,commandChar,coordStr,coordNumber,standardCommandLen,UpdateTag,IContainPointMode,AttributeUpdateType,AnimateStatus,AnimateMode,AnimateStepType,Direction,CurveTypeEnum,BaseRenderContributionTime,circleThreshold=tau-1e-8,BoundsContext=class{constructor(e){this.init(e)}init(e){this.bounds=e}arc(s,h,d,u,c,g){if(Math.abs(c-u)>circleThreshold)this.bounds.add(s-d,h-d),this.bounds.add(s+d,h+d);else{let e,t,i,r,o=1/0,n=-1/0,a=1/0,l=-1/0;if(p(u),p(c),c!==u)if((u%=tau)<0&&(u+=tau),(c%=tau)<0&&(c+=tau),c<u&&(g=!g,e=u,u=c,c=e),g)for(c-=tau,e=u-u%halfPi,t=0;t<4&&e>c;++t,e-=halfPi)p(e);else for(e=u-u%halfPi+halfPi,t=0;t<4&&e<c;++t,e+=halfPi)p(e);function p(e){i=d*Math.cos(e),r=d*Math.sin(e),i<o&&(o=i),i>n&&(n=i),r<a&&(a=r),r>l&&(l=r)}this.bounds.add(s+o,h+a),this.bounds.add(s+n,h+l)}}arcTo(e,t,i,r,o){this.bounds.add(e,t)}bezierCurveTo(e,t,i,r,o,n){this.bounds.add(e,t),this.bounds.add(i,r),this.bounds.add(o,n)}closePath(){}ellipse(){throw new Error(\\\"不支持ellipse\\\")}lineTo(e,t){this.bounds.add(e,t)}moveTo(e,t){this.bounds.add(e,t)}quadraticCurveTo(e,t,i,r){this.bounds.add(e,t),this.bounds.add(i,r)}rect(e,t,i,r){this.bounds.add(e,t),this.bounds.add(e+i,t+r)}clear(){this.bounds.clear()}release(){}},CurvePath=(init_esbuild_inject(),class{constructor(){this.curves=[],this.bounds=new AABBBounds}getCurveLengths(){return this.curves.map(e=>e.getLength())}getPointAt(e){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}),rePathCommand=(init_esbuild_inject(),/([-+]?((\\\\d+\\\\.\\\\d+)|((\\\\d+)|(\\\\.\\\\d+)))(?:[eE][-+]?\\\\d+)?)/gi),commandLengths={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},enumCommandMap={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};function parseSvgPath(e){if(!e)return[];var n,i,t=e.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(null===t)return[];var a=[];for(let r=0,o=t.length;r<o;r++)if(currPath=t[r],coordsStr=currPath.slice(1),n=[commandChar=currPath[0]],null!==(i=coordsStr.match(rePathCommand))){for(let e=0,t=i.length;e<t;e++)coordStr=i[e],coordNumber=parseFloat(coordStr),Number.isNaN(coordNumber)||n.push(coordNumber);if((standardCommandLen=commandLengths[commandChar])<n.length-1){let i,r=commandChar;for(let o=1,e=n.length;o<e;o+=standardCommandLen){i=[r];for(let e=o,t=o+standardCommandLen;e<t;e++)i.push(n[e]);a.push(i),\\\"m\\\"===r?r=\\\"l\\\":\\\"M\\\"===r&&(r=\\\"L\\\")}}else a.push(n)}else a.push(n);return a}function segments(e,t,i,r,o,n,a,l,s){var h=degreeToRadian(a),d=Math.sin(h),u=Math.cos(h),h=u*(l-e)*.5+d*(s-t)*.5,c=u*(s-t)*.5-d*(l-e)*.5,h=h*h/((i=Math.abs(i))*i)+c*c/((r=Math.abs(r))*r),c=(1<h&&(i*=h=Math.sqrt(h),r*=h),u/i),h=d/i,g=-d/r,p=u/r,f=c*l+h*s,m=g*l+p*s,c=c*e+h*t,h=g*e+p*t;let b=1/((c-f)*(c-f)+(h-m)*(h-m))-.25,C=(b<0&&(b=0),Math.sqrt(b));var v=.5*(f+c)-(C=n===o?-C:C)*(h-m),y=.5*(m+h)+C*(c-f),w=Math.atan2(m-y,f-v);let _=Math.atan2(h-y,c-v)-w;_<0&&1===n?_+=tau:0<_&&0===n&&(_-=tau);var S=Math.ceil(Math.abs(_/(halfPi+.001))),x=[];for(let A=0;A<S;++A){var R=w+A*_/S,T=w+(A+1)*_/S;x[A]=[v,y,R,T,i,r,d,u]}return x}function bezier(e){var t=e[0],i=e[1],r=e[2],o=e[3],n=e[4],a=e[5],l=e[6],s=e[7],h=s*n,d=-l*a,l=l*n,n=s*a,s=Math.cos(r),a=Math.sin(r),u=Math.cos(o),c=Math.sin(o),o=.5*(o-r),r=Math.sin(.5*o),r=8/3*r*r/Math.sin(o),o=t+s-r*a,a=i+a+r*s,s=t+u,t=i+c,i=s+r*c,c=t-r*u;return[h*o+d*a,l*o+n*a,h*i+d*c,l*i+n*c,h*s+d*t,l*s+n*t]}function drawArc(e,t,i,r){var o=segments(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,i);for(let a=0;a<o.length;++a){var n=bezier(o[a]);e.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}init_esbuild_inject(),function(e){e[e.NONE=0]=\\\"NONE\\\",e[e.UPDATE_BOUNDS=1]=\\\"UPDATE_BOUNDS\\\",e[e.UPDATE_SHAPE=2]=\\\"UPDATE_SHAPE\\\",e[e.CLEAR_SHAPE=253]=\\\"CLEAR_SHAPE\\\",e[e.UPDATE_SHAPE_AND_BOUNDS=3]=\\\"UPDATE_SHAPE_AND_BOUNDS\\\",e[e.INIT=179]=\\\"INIT\\\",e[e.CLEAR_BOUNDS=254]=\\\"CLEAR_BOUNDS\\\",e[e.UPDATE_GLOBAL_MATRIX=32]=\\\"UPDATE_GLOBAL_MATRIX\\\",e[e.CLEAR_GLOBAL_MATRIX=223]=\\\"CLEAR_GLOBAL_MATRIX\\\",e[e.UPDATE_LOCAL_MATRIX=16]=\\\"UPDATE_LOCAL_MATRIX\\\",e[e.CLEAR_LOCAL_MATRIX=239]=\\\"CLEAR_LOCAL_MATRIX\\\",e[e.UPDATE_GLOBAL_LOCAL_MATRIX=48]=\\\"UPDATE_GLOBAL_LOCAL_MATRIX\\\",e[e.UPDATE_LAYOUT=128]=\\\"UPDATE_LAYOUT\\\",e[e.CLEAR_LAYOUT=127]=\\\"CLEAR_LAYOUT\\\"}(UpdateTag=UpdateTag||{}),function(e){e[e.GLOBAL=1]=\\\"GLOBAL\\\",e[e.LOCAL=16]=\\\"LOCAL\\\",e[e.GLOBAL_ACCURATE=3]=\\\"GLOBAL_ACCURATE\\\",e[e.LOCAL_ACCURATE=48]=\\\"LOCAL_ACCURATE\\\"}(IContainPointMode=IContainPointMode||{}),function(e){e[e.INIT=0]=\\\"INIT\\\",e[e.DEFAULT=1]=\\\"DEFAULT\\\",e[e.STATE=2]=\\\"STATE\\\",e[e.ANIMATE_BIND=10]=\\\"ANIMATE_BIND\\\",e[e.ANIMATE_PLAY=11]=\\\"ANIMATE_PLAY\\\",e[e.ANIMATE_START=12]=\\\"ANIMATE_START\\\",e[e.ANIMATE_UPDATE=13]=\\\"ANIMATE_UPDATE\\\",e[e.ANIMATE_END=14]=\\\"ANIMATE_END\\\",e[e.TRANSLATE=20]=\\\"TRANSLATE\\\",e[e.TRANSLATE_TO=21]=\\\"TRANSLATE_TO\\\",e[e.SCALE=22]=\\\"SCALE\\\",e[e.SCALE_TO=23]=\\\"SCALE_TO\\\",e[e.ROTATE=24]=\\\"ROTATE\\\",e[e.ROTATE_TO=25]=\\\"ROTATE_TO\\\"}(AttributeUpdateType=AttributeUpdateType||{}),function(e){e[e.INITIAL=0]=\\\"INITIAL\\\",e[e.RUNNING=1]=\\\"RUNNING\\\",e[e.PAUSED=2]=\\\"PAUSED\\\",e[e.END=3]=\\\"END\\\"}(AnimateStatus=AnimateStatus||{}),function(e){e[e.NORMAL=0]=\\\"NORMAL\\\",e[e.SET_ATTR_IMMEDIATELY=1]=\\\"SET_ATTR_IMMEDIATELY\\\"}(AnimateMode=AnimateMode||{}),function(e){e.wait=\\\"wait\\\",e.from=\\\"from\\\",e.to=\\\"to\\\",e.customAnimate=\\\"customAnimate\\\"}(AnimateStepType=AnimateStepType||{}),function(e){e[e.ROW=1]=\\\"ROW\\\",e[e.COLUMN=2]=\\\"COLUMN\\\"}(Direction=Direction||{}),function(e){e[e.CubicBezierCurve=0]=\\\"CubicBezierCurve\\\",e[e.QuadraticBezierCurve=1]=\\\"QuadraticBezierCurve\\\",e[e.ArcCurve=2]=\\\"ArcCurve\\\",e[e.LineCurve=3]=\\\"LineCurve\\\",e[e.EllipseCurve=4]=\\\"EllipseCurve\\\",e[e.MoveCurve=5]=\\\"MoveCurve\\\"}(CurveTypeEnum=CurveTypeEnum||{}),function(e){e[e.beforeFillStroke=0]=\\\"beforeFillStroke\\\",e[e.afterFillStroke=1]=\\\"afterFillStroke\\\"}(BaseRenderContributionTime=BaseRenderContributionTime||{}),init_esbuild_inject();var addArcToBezierPath=(e,t,i,r,o,n,a)=>{var l=Math.abs(i-t),s=l>.5*Math.PI?Math.ceil(2*l/Math.PI):1,h=(i-t)/s;for(let v=0;v<s;v++){var d=t+h*v,u=t+h*(v+1),c=4*Math.tan(Math.abs(h)/4)/3,g=u<d?-1:1,p=Math.cos(d),d=Math.sin(d),f=Math.cos(u),u=Math.sin(u),m=f*n+r,b=u*a+o,C=n*c*g,c=a*c*g;e.push(p*n+r-C*d,d*a+o+c*p,m+C*u,b-c*f,m,b)}},commandFuncs=(init_esbuild_inject(),[(e,t,i,r,o,n,a)=>t.arc(e[1]*o+i,e[2]*n+r,e[3]*(o+n)/2,e[4],e[5],e[6],a),(e,t,i,r,o,n,a)=>t.arcTo(e[1]*o+i,e[2]*n+r,e[3]*o+i,e[4]*n+r,e[5]*(o+n)/2,a),(e,t,i,r,o,n,a)=>t.bezierCurveTo(e[1]*o+i,e[2]*n+r,e[3]*o+i,e[4]*n+r,e[5]*o+i,e[6]*n+r,a),(e,t,i,r)=>t.closePath(),(e,t,i,r,o,n)=>t.ellipse(e[1]*o+i,e[2]*n+r,e[3]*o,e[4]*n,e[5],e[6],e[7],e[8]),(e,t,i,r,o,n,a)=>t.lineTo(e[1]*o+i,e[2]*n+r,a),(e,t,i,r,o,n,a)=>t.moveTo(e[1]*o+i,e[2]*n+r,a),(e,t,i,r,o,n,a)=>t.quadraticCurveTo(e[1]*o+i,e[2]*n+r,e[3]*o+i,e[4]*n+r,a),(e,t,i,r,o,n,a)=>t.rect(e[1]*o+i,e[2]*n+r,e[3]*o,e[4]*n,a)]);function renderCommandList(e,t,i=0,r=0,o=1,n=1,a){for(let s=0;s<e.length;s++){var l=e[s];commandFuncs[l[0]](l,t,i,r,o,n,a)}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Curve=class{getLength(e){return null!=e?this.calcProjLength(e):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}};function snapLength(e,t){let i=0;var r=e.length;for(let s=0;s<r;s++){var o=e[s],n=t[s],a=e[(s+1)%r],l=t[(s+1)%r];i+=PointService.distanceNN(o,n,a,l)}return i/2}function cubicLength(e,t,i,r,o){return snapLength([e.x,t.x,i.x,r.x],[e.y,t.y,i.y,r.y])}function cubicCalc(e,t,i,r,o){var n=1-o;return n*n*n*e+3*t*o*n*n+3*i*o*o*n+r*o*o*o}function cubicPointAt(e,t,i,r,o){var n=cubicCalc(e.x,t.x,i.x,r.x,o),a=cubicCalc(e.y,t.y,i.y,r.y,o);return new Point(n,a)}function divideCubic(e,t){var{p0:i,p1:r,p2:o,p3:n}=e,a=cubicPointAt(i,r,o,n,t),l=PointService.pointAtPP(i,r,t),r=PointService.pointAtPP(r,o,t),o=PointService.pointAtPP(o,n,t),s=PointService.pointAtPP(l,r,t),r=PointService.pointAtPP(r,o,t);return[new CubicBezierCurve(i,l,s,a),new CubicBezierCurve(a,r,o,n)]}init_esbuild_inject();var CubicBezierCurve=class extends Curve{constructor(e,t,i,r){super(),this.type=CurveTypeEnum.CubicBezierCurve,this.p0=e,this.p1=t,this.p2=i,this.p3=r}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(e){if(!1!==this.defined)return cubicPointAt(this.p0,this.p1,this.p2,this.p3,e);throw new Error(\\\"defined为false的点不能getPointAt\\\")}calcLength(){return this._validPoint()?cubicLength(this.p0,this.p1,this.p2,this.p3,0):60}calcProjLength(e){return e===Direction.ROW?abs(this.p0.x-this.p3.x):e===Direction.COLUMN?abs(this.p0.y-this.p3.y):0}getAngleAt(e){var t=max(e-.01,0),i=min(e+.01,1),t=this.getPointAt(t),i=this.getPointAt(i);return atan2(i.y-t.y,i.x-t.x)}};function divideLinear(e,t){var{p0:i,p1:r}=e,o=PointService.pointAtPP(i,r,t);return[new LineCurve(i,o),new LineCurve(o,r)]}init_esbuild_inject();var LineCurve=class extends Curve{constructor(e,t){super(),this.type=CurveTypeEnum.LineCurve,this.p0=e,this.p1=t}getPointAt(e){if(!1!==this.defined)return PointService.pointAtPP(this.p0,this.p1,e);throw new Error(\\\"defined为false的点不能getPointAt\\\")}getAngleAt(e){return null==this.angle&&(this.angle=atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?PointService.distancePP(this.p0,this.p1):60}calcProjLength(e){return e===Direction.ROW?abs(this.p0.x-this.p1.x):e===Direction.COLUMN?abs(this.p0.y-this.p1.y):0}},SegContext=class{get endX(){return this._lastX}get endY(){return this._lastY}constructor(e,t){this.init(e,t)}init(e,t){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=e,this.direction=t,this.curves=[]}bezierCurveTo(e,t,i,r,o,n,a,l){var s=new CubicBezierCurve(new Point(this._lastX,this._lastY),new Point(e,t),new Point(i,r),new Point(o,n));s.originP1=this._lastOriginP,s.originP2=l,s.defined=a,this.curves.push(s),this._lastX=o,this._lastY=n,this._lastOriginP=l}closePath(){var e;this.curves.length<2||(e=this.curves[this.curves.length-1],this.lineTo(this._startX,this._startY,e.defined,this._startOriginP))}ellipse(){throw new Error(\\\"SegContext不支持调用ellipse\\\")}lineTo(e,t,i,r){var o=this.addLinearCurve(e,t,i,this._lastOriginP,r);this.curves.push(o),this._lastX=e,this._lastY=t,this._lastOriginP=r}moveTo(e,t,i){return this._lastX=this._startX=e,this._lastY=this._startY=t,this._lastOriginP=i,this._startOriginP=i,this}quadraticCurveTo(e,t,i,r){throw new Error(\\\"SegContext不支持调用quadraticCurveTo\\\")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(e){return this.getLength(e)}addLinearCurve(e,t,i,r,o){var n=new LineCurve(new Point(this._lastX,this._lastY),new Point(e,t));return n.originP1=r,n.originP2=o,n.defined=i,n}getPointAt(e){throw new Error(\\\"暂未实现\\\")}getCurveLengths(){return[]}getLength(e){var t,i,r;return e===Direction.COLUMN?this.curves.length?(i=this.curves[0],r=null!=(r=(t=this.curves[this.curves.length-1]).p3)?r:t.p1,abs(i.p0.y-r.y)):0:e===Direction.ROW?this.curves.length?(t=this.curves[0],r=null!=(r=(i=this.curves[this.curves.length-1]).p3)?r:i.p1,abs(t.p0.x-r.x)):0:(Number.isFinite(this.length)||(this.length=this.curves.reduce((e,t)=>e+t.getLength(),0)),this.length)}},ReflectSegContext=class extends SegContext{bezierCurveTo(e,t,i,r,o,n,a,l){return super.bezierCurveTo(t,e,r,i,n,o,a,l)}lineTo(e,t,i,r){return super.lineTo(t,e,i,r)}moveTo(e,t,i){return super.moveTo(t,e,i)}clear(){return super.clear()}};function genCurveSegments(e,t,i=0){let r=!1;for(let o=0,n=t.length;o<=n;o++)o>=n===r&&((r=!r)?e.lineStart():e.lineEnd()),r&&e.point(t[o])}function genSegContext(e,t,i){var r=null!=t?t:abs(i[i.length-1].x-i[0].x)>abs(i[i.length-1].y-i[0].y)?Direction.ROW:Direction.COLUMN;return new(\\\"monotoneY\\\"===e?ReflectSegContext:SegContext)(e,r)}var Linear=class{constructor(e,t){this.context=e,t&&(this.startPoint=t)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(e){var t=e.x,i=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(t,i,!1!==this._lastDefined&&!1!==e.defined,e):this.context.moveTo(t,i,e);break;case 1:this._point=2;default:this.context.lineTo(t,i,!1!==this._lastDefined&&!1!==e.defined,e)}this._lastDefined=e.defined}tryUpdateLength(){return this.context.tryUpdateLength()}};function genLinearSegments(e,t={}){var{direction:i,startPoint:r}=t;return e.length<2-Number(!!r)?null:(i=genSegContext(\\\"linear\\\",i,e),genLinearTypeSegments(new Linear(i,r),e),i)}function genLinearTypeSegments(e,t){return genCurveSegments(e,t,1)}function point(e,t,i,r,o){e.context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6,r,e.lastPoint1)}init_esbuild_inject();var Basis=class{constructor(e,t){this.context=e,this.startPoint=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){2===this._point&&point(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(e){var t=e.x,i=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(t,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,e):this.context.moveTo(t,i,e);break;case 1:this._point=2;break;default:point(this,t,i,!1!==this._lastDefined1&&!1!==this._lastDefined2,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}};function genBasisTypeSegments(e,t){return genCurveSegments(e,t,2)}function genBasisSegments(e,t={}){var{direction:i,startPoint:r}=t;return e.length<2-Number(!!r)?null:e.length<3-Number(!!r)?genLinearSegments(e,t):(i=genSegContext(\\\"basis\\\",i,e),genBasisTypeSegments(new Basis(i,r),e),i)}function sign(e){return e<0?-1:1}function slope3(e,t,i){var r=e._x1-e._x0,o=t-e._x1,n=(e._y1-e._y0)/(r||Number(o<0&&-0)),a=(i-e._y1)/(o||Number(r<0&&-0)),r=(n*o+a*r)/(r+o);return(sign(n)+sign(a))*Math.min(Math.abs(n),Math.abs(a),.5*Math.abs(r))||0}function slope2(e,t){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-t)/2:t}function point2(e,t,i,r,o){var n=e._x0,a=e._x1,l=e._y1,s=(a-n)/3;e.context.bezierCurveTo(n+s,e._y0+s*t,a-s,l-s*i,a,l,r,e.lastPoint1)}init_esbuild_inject();var MonotoneX=class{constructor(e,t){this.context=e,this.startPoint=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:point2(this,this._t0,slope2(this,this._t0),!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1)}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(e){let t=NaN;var i=e.x,r=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined1&&!1!==this._lastDefined2,e):this.context.moveTo(i,r,e);break;case 1:this._point=2;break;case 2:this._point=3,point2(this,slope2(this,t=slope3(this,i,r)),t,!1!==this._lastDefined1&&!1!==this._lastDefined2,e);break;default:point2(this,this._t0,t=slope3(this,i,r),!1!==this._lastDefined1&&!1!==this._lastDefined2,e)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=r,this._t0=t,this._lastDefined1=this._lastDefined2,this._lastDefined2=!1!==e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}},MonotoneY=class extends MonotoneX{constructor(e,t){super(e,t)}point(e){return super.point({y:e.x,x:e.y,defined:e.defined})}};function genMonotoneXTypeSegments(e,t){return genCurveSegments(e,t,2)}function genMonotoneXSegments(e,t={}){var{direction:i,startPoint:r}=t;return e.length<2-Number(!!r)?null:e.length<3-Number(!!r)?genLinearSegments(e,t):(i=genSegContext(\\\"monotoneX\\\",i,e),genMonotoneXTypeSegments(new MonotoneX(i,r),e),i)}function genMonotoneYTypeSegments(e,t){return genCurveSegments(e,t,2)}function genMonotoneYSegments(e,t={}){var{direction:i,startPoint:r}=t;return e.length<2-Number(!!r)?null:e.length<3-Number(!!r)?genLinearSegments(e,t):(i=genSegContext(\\\"monotoneY\\\",i,e),genMonotoneYTypeSegments(new MonotoneY(i,r),e),i)}init_esbuild_inject();var Step=class{constructor(e,t=.5,i){this.context=e,this._t=t,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&2===this._point&&this.context.lineTo(this._x,this._y,!1!==this._lastDefined,this.lastPoint),(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)}point(e){var t,i=e.x,r=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,r,!1!==this._lastDefined&&!1!==e.defined,e):this.context.moveTo(i,r,e);break;case 1:this._point=2;default:this._t<=0?(this.context.lineTo(this._x,r,!1!==this._lastDefined&&!1!==e.defined,this.lastPoint),this.context.lineTo(i,r,!1!==this._lastDefined&&!1!==e.defined,e)):(t=this._x*(1-this._t)+i*this._t,this.context.lineTo(t,this._y,!1!==this._lastDefined&&!1!==e.defined,this.lastPoint),this.context.lineTo(t,r,!1!==this._lastDefined&&!1!==e.defined,e))}this._lastDefined=e.defined,this._x=i,this._y=r,this.lastPoint=e}tryUpdateLength(){return this.context.tryUpdateLength()}};function genStepSegments(e,t,i={}){var{direction:r,startPoint:o}=i;return e.length<2-Number(!!o)?null:(r=new SegContext(\\\"step\\\",null!=r?r:abs(e[e.length-1].x-e[0].x)>abs(e[e.length-1].y-e[0].y)?Direction.ROW:Direction.COLUMN),genStepTypeSegments(new Step(r,t,o),e),r)}function genStepTypeSegments(e,t){return genCurveSegments(e,t,1)}init_esbuild_inject();var LinearClosed=class extends Linear{lineEnd(){this.context.closePath()}};function genLinearClosedSegments(e,t={}){var{direction:i,startPoint:r}=t;return e.length<2-Number(!!r)?null:(i=genSegContext(\\\"linear\\\",i,e),genLinearClosedTypeSegments(new LinearClosed(i,r),e),i)}function genLinearClosedTypeSegments(e,t){return genCurveSegments(e,t,1)}function point3(e,t,i,r,o){let n=e._x1,a=e._y1,l=e._x2,s=e._y2;var h,d;epsilon<e._l01_a&&(h=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,d=3*e._l01_a*(e._l01_a+e._l12_a),n=(n*h-e._x0*e._l12_2a+e._x2*e._l01_2a)/d,a=(a*h-e._y0*e._l12_2a+e._y2*e._l01_2a)/d),epsilon<e._l23_a&&(h=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a),l=(l*h+e._x1*e._l23_2a-t*e._l12_2a)/d,s=(s*h+e._y1*e._l23_2a-i*e._l12_2a)/d),e.context.bezierCurveTo(n,a,l,s,e._x2,e._y2,r,e.lastPoint1)}init_esbuild_inject();var CatmullRom=class{constructor(e,t=.5,i){this.context=e,this.startPoint=i,this._alpha=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||0!==this._line&&1===this._point)&&this.context.closePath(),this._line=1-this._line}point(e){var t,i,{x:r,y:o}=e;switch(this._point&&(t=this._x2-r,i=this._y2-o,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+i*i,this._alpha))),this._point){case 0:this._point=1,this._line?this.context.lineTo(r,o,!1!==this._lastDefined1&&!1!==this._lastDefined2):this.context.moveTo(r,o);break;case 1:this._point=2;break;case 2:this._point=3;default:point3(this,r,o,!1!==this._lastDefined1&&!1!==this._lastDefined2,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=o,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}};function commonGenCatmullRomSegments(n,a){return function(e,t,i={}){var{direction:r,startPoint:o}=i;return e.length<2-Number(!!o)?null:e.length<3-Number(!!o)?genLinearSegments(e,i):(r=genSegContext(n,r,e),genCurveSegments(new a(r,t,o),e,2),r)}}var genCatmullRomSegments=commonGenCatmullRomSegments(\\\"catmullRom\\\",CatmullRom),CatmullRomClosed=(init_esbuild_inject(),class{constructor(e,t=.5,i){this.context=e,this.startPoint=i,this._alpha=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,!1!==this._lastDefined1&&!1!==this._lastDefined2,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(e){var t,i,{x:r,y:o}=e;switch(this._point&&(t=this._x2-r,i=this._y2-o,this._l23_a=Math.sqrt(this._l23_2a=Math.pow(t*t+i*i,this._alpha))),this._point){case 0:this._point=1,this._x3=r,this._y3=o;break;case 1:this._point=2,this.context.moveTo(this._x4=r,this._y4=o,e);break;case 2:this._point=3,this._x5=r,this._y5=o;break;default:point3(this,r,o,!1!==this._lastDefined1&&!1!==this._lastDefined2,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=r,this._y0=this._y1,this._y1=this._y2,this._y2=o,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}}),genCatmullRomClosedSegments=commonGenCatmullRomSegments(\\\"catmullRomClosed\\\",CatmullRomClosed);function calcLineCache(e,t,i){var r;switch(t){case\\\"linear\\\":default:return genLinearSegments(e,i);case\\\"basis\\\":return genBasisSegments(e,i);case\\\"monotoneX\\\":return genMonotoneXSegments(e,i);case\\\"monotoneY\\\":return genMonotoneYSegments(e,i);case\\\"step\\\":return genStepSegments(e,.5,i);case\\\"stepBefore\\\":return genStepSegments(e,0,i);case\\\"stepAfter\\\":return genStepSegments(e,1,i);case\\\"catmullRom\\\":return genCatmullRomSegments(e,null!=(r=null==i?void 0:i.curveTension)?r:.5,i);case\\\"catmullRomClosed\\\":return genCatmullRomClosedSegments(e,null!=(r=null==i?void 0:i.curveTension)?r:.5,i);case\\\"linearClosed\\\":return genLinearClosedSegments(e,i)}}var CustomPath2D=class extends CurvePath{constructor(e){super(),this.commandList=[],e&&(this._ctx=e),this._boundsContext=new BoundsContext(this.bounds)}setCtx(e){this._ctx=e}moveTo(e,t){return this.commandList.push([enumCommandMap.M,e,t]),this._ctx&&this._ctx.moveTo(e,t),this}lineTo(e,t){return this.commandList.push([enumCommandMap.L,e,t]),this._ctx&&this._ctx.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.commandList.push([enumCommandMap.Q,e,t,i,r]),this._ctx&&this._ctx.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,o,n){return this.commandList.push([enumCommandMap.C,e,t,i,r,o,n]),this._ctx&&this._ctx.bezierCurveTo(e,t,i,r,o,n),this}arcTo(e,t,i,r,o){return this.commandList.push([enumCommandMap.AT,e,t,i,r,o]),this._ctx&&this._ctx.arcTo(e,t,i,r,o),this}ellipse(e,t,i,r,o,n,a,l){return this.commandList.push([enumCommandMap.E,e,t,i,r,o,n,a,l]),this._ctx&&this._ctx.ellipse(e,t,i,r,o,n,a,l),this}rect(e,t,i,r){return this.commandList.push([enumCommandMap.R,e,t,i,r]),this._ctx&&this._ctx.rect(e,t,i,r),this}arc(e,t,i,r,o,n){return this.commandList.push([enumCommandMap.A,e,t,i,r,o,n]),this._ctx&&this._ctx.arc(e,t,i,r,o,n),this}closePath(){return this.commandList.push([enumCommandMap.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(e){this.curves.push(e)}clear(){this.transformCbList=null,this.commandList.length=0,this.curves.length=0}beginPath(){this.clear()}toString(){var e;this.toStringCbList||((e=[])[enumCommandMap.M]=e=>`M${e[1]} `+e[2],e[enumCommandMap.L]=e=>`L${e[1]} `+e[2],e[enumCommandMap.Q]=e=>`Q${e[1]} ${e[2]} ${e[3]} `+e[4],e[enumCommandMap.C]=e=>`C${e[1]} ${e[2]} ${e[3]} ${e[4]} ${e[5]} `+e[6],e[enumCommandMap.A]=e=>{var t=[];addArcToBezierPath(t,e[4],e[5],e[1],e[2],e[3],e[3]);let i=\\\"\\\";for(let r=0;r<t.length;r+=6)i+=`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} `+t[r+5];return i},e[enumCommandMap.R]=e=>`M${e[1]} ${e[2]} h${e[3]} v${e[4]} H${e[1]}Z`,e[enumCommandMap.Z]=e=>\\\"Z\\\",this.toStringCbList=e);const t=this.toStringCbList;let i=\\\"\\\";return this.commandList.forEach(e=>{i+=t[e[0]](e)}),i}fromString(e,t,i,r,o){this.clear();var n=parseSvgPath(e);return this._runCommandStrList(n,t,i,r,o),this._updateBounds(),this}fromLine(e){var{points:t,curveType:i,clipRangeByDimension:r}=e.attribute;t&&(t=calcLineCache(t,i),\\\"x\\\"===r?this.direction=Direction.ROW:\\\"y\\\"===r?this.direction=Direction.COLUMN:\\\"auto\\\"===r&&(this.direction=t.direction),this.curves=t.curves)}fromCustomPath2D(e,t,i,r,o){return this.clear(),this._runCommandList(e.commandList,t,i,r,o),this._updateBounds(),this}transform(t,i,r,o){var e,n=this.commandList;this.transformCbList||((e=[])[enumCommandMap.M]=this.moveToTransform,e[enumCommandMap.L]=this.lineToTransform,e[enumCommandMap.Q]=this.quadraticCurveToTransform,e[enumCommandMap.C]=this.bezierCurveToTransform,e[enumCommandMap.AT]=this.arcToTransform,e[enumCommandMap.E]=this.ellipseTransform,e[enumCommandMap.R]=this.rectTransform,e[enumCommandMap.A]=this.arcTransform,e[enumCommandMap.Z]=this.closePathTransform,this.transformCbList=e),n.forEach(e=>{this.transformCbList[e[0]](e,t,i,r,o)}),this._updateBounds()}moveToTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i}lineToTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i}quadraticCurveToTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*r+t,e[4]=e[4]*o+i}bezierCurveToTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*r+t,e[4]=e[4]*o+i,e[5]=e[5]*r+t,e[6]=e[6]*o+i}arcToTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*r+t,e[4]=e[4]*o+i,e[5]=e[5]*(r+o)/2}ellipseTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*r,e[4]=e[4]*o}rectTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*r,e[4]=e[4]*o}arcTransform(e,t,i,r,o){e[1]=e[1]*r+t,e[2]=e[2]*o+i,e[3]=e[3]*(r+o)/2}closePathTransform(){}_runCommandStrList(e,t=0,i=0,r=1,o=1){let n,a,l,s,h,d=null,u=0,c=0,g=0,p=0;for(let f=0,m=e.length;f<m;++f){switch(n=e[f],(n=1===r&&1===o?n:scale(n,r,o))[0]){case\\\"l\\\":u+=n[1],c+=n[2],this.lineTo(u+t,c+i);break;case\\\"L\\\":u=n[1],c=n[2],this.lineTo(u+t,c+i);break;case\\\"h\\\":u+=n[1],this.lineTo(u+t,c+i);break;case\\\"H\\\":u=n[1],this.lineTo(u+t,c+i);break;case\\\"v\\\":c+=n[1],this.lineTo(u+t,c+i);break;case\\\"V\\\":c=n[1],this.lineTo(u+t,c+i);break;case\\\"m\\\":u+=n[1],c+=n[2],this.moveTo(u+t,c+i);break;case\\\"M\\\":u=n[1],c=n[2],this.moveTo(u+t,c+i);break;case\\\"c\\\":a=u+n[5],l=c+n[6],g=u+n[3],p=c+n[4],this.bezierCurveTo(u+n[1]+t,c+n[2]+i,g+t,p+i,a+t,l+i),u=a,c=l;break;case\\\"C\\\":u=n[5],c=n[6],g=n[3],p=n[4],this.bezierCurveTo(n[1]+t,n[2]+i,g+t,p+i,u+t,c+i);break;case\\\"s\\\":a=u+n[3],l=c+n[4],g=2*u-g,p=2*c-p,this.bezierCurveTo(g+t,p+i,u+n[1]+t,c+n[2]+i,a+t,l+i),g=u+n[1],p=c+n[2],u=a,c=l;break;case\\\"S\\\":a=n[3],l=n[4],g=2*u-g,p=2*c-p,this.bezierCurveTo(g+t,p+i,n[1]+t,n[2]+i,a+t,l+i),u=a,c=l,g=n[1],p=n[2];break;case\\\"q\\\":a=u+n[3],l=c+n[4],g=u+n[1],p=c+n[2],this.quadraticCurveTo(g+t,p+i,a+t,l+i),u=a,c=l;break;case\\\"Q\\\":a=n[3],l=n[4],this.quadraticCurveTo(n[1]+t,n[2]+i,a+t,l+i),u=a,c=l,g=n[1],p=n[2];break;case\\\"t\\\":a=u+n[1],l=c+n[2],null===d[0].match(/[QqTt]/)?(g=u,p=c):\\\"t\\\"===d[0]?(g=2*u-s,p=2*c-h):\\\"q\\\"===d[0]&&(g=2*u-g,p=2*c-p),s=g,h=p,this.quadraticCurveTo(g+t,p+i,a+t,l+i),u=a,c=l,g=u+n[1],p=c+n[2];break;case\\\"T\\\":a=n[1],l=n[2],g=2*u-g,p=2*c-p,this.quadraticCurveTo(g+t,p+i,a+t,l+i),u=a,c=l;break;case\\\"a\\\":drawArc(this,u+t,c+i,[n[1],n[2],n[3],n[4],n[5],n[6]+u+t,n[7]+c+i]),u+=n[6],c+=n[7];break;case\\\"A\\\":drawArc(this,u+t,c+i,[n[1],n[2],n[3],n[4],n[5],n[6]+t,n[7]+i]),u=n[6],c=n[7];break;case\\\"z\\\":case\\\"Z\\\":this.closePath()}d=n}}_runCommandList(i,r=0,o=0,n=1,a=1){if(0!==r||0!==o||1!==n||1!==a)for(let e=0,t=i.length;e<t;++e){var l=i[e].slice();switch(l[0]){case enumCommandMap.L:this.lineToTransform(l,r,o,n,a);break;case enumCommandMap.M:this.moveToTransform(l,r,o,n,a);break;case enumCommandMap.C:this.bezierCurveToTransform(l,r,o,n,a);break;case enumCommandMap.Q:this.quadraticCurveToTransform(l,r,o,n,a);break;case enumCommandMap.A:this.arcToTransform(l,r,o,n,a);break;case enumCommandMap.E:this.ellipseTransform(l,r,o,n,a);break;case enumCommandMap.R:this.rectTransform(l,r,o,n,a);break;case enumCommandMap.AT:this.arcToTransform(l,r,o,n,a);break;case enumCommandMap.Z:this.closePath()}}else this.commandList=i.map(e=>e.slice())}_updateBounds(){this.bounds.clear(),renderCommandList(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){var e,t;return this.direction===Direction.COLUMN?this.curves.length?(e=this.curves[0],t=this.curves[this.curves.length-1],abs(e.p0.y-t.p1.y)):0:this.direction===Direction.ROW?this.curves.length?(e=this.curves[0],t=this.curves[this.curves.length-1],abs(e.p0.x-t.p1.x)):0:this.curves.reduce((e,t)=>e+t.getLength(),0)}getAttrAt(e){if(!this.curves)return{pos:{x:0,y:0},angle:0};let t,i=0;for(let n=0;n<this.curves.length;n++){var r=(t=this.curves[n]).getLength(this.direction);if(i+r>=e)break;i+=r}var o=(e-i)/t.getLength(this.direction);return{pos:t.getPointAt(o),angle:t.getAngleAt(o)}}},temp=[\\\"l\\\",0,0,0,0,0,0,0];function scale(i,r,o){var n=temp[0]=i[0];if(\\\"a\\\"===n||\\\"A\\\"===n)temp[1]=r*i[1],temp[2]=o*i[2],temp[3]=i[3],temp[4]=i[4],temp[5]=i[5],temp[6]=r*i[6],temp[7]=o*i[7];else if(\\\"h\\\"===n||\\\"H\\\"===n)temp[1]=r*i[1];else if(\\\"v\\\"===n||\\\"V\\\"===n)temp[1]=o*i[1];else for(let e=1,t=i.length;e<t;++e)temp[e]=(e%2==1?r:o)*i[e];return temp}var DefaultLayout={alignSelf:\\\"auto\\\"},DefaultTransform={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new Matrix},DefaultFillStyle={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:\\\"black\\\",shadowOffsetX:0,shadowOffsetY:0},commonStroke={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:\\\"butt\\\",lineJoin:\\\"miter\\\",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},DefaultStrokeStyle=Object.assign({outerBorder:Object.assign(Object.assign({},commonStroke),{distance:0}),innerBorder:Object.assign(Object.assign({},commonStroke),{distance:0})},commonStroke),DefaultTextStyle={text:\\\"\\\",maxLineWidth:1/0,maxWidth:1/0,textAlign:\\\"left\\\",textBaseline:\\\"alphabetic\\\",fontSize:16,fontFamily:\\\"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,\\\\n    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol\\\",fontWeight:\\\"\\\",ellipsis:\\\"…\\\",fontVariant:\\\"\\\",fontStyle:\\\"\\\",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:\\\"horizontal\\\",wordBreak:\\\"break-all\\\",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:\\\"no-wrap\\\",heightLimit:1/0,lineClamp:1/0,suffixPosition:\\\"end\\\",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:MeasureModeEnum.fontBounding,keepCenterInLine:!1},DefaultPickStyle={pickStrokeBuffer:0},DefaultStyle=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:\\\"black\\\",textureSize:10,texturePadding:2,backgroundMode:\\\"no-repeat\\\",backgroundFit:!0,blur:0,cursor:null,html:null,react:null},DefaultFillStyle),DefaultStrokeStyle),DefaultLayout),DefaultPickStyle),DefaultConnectAttribute={connectedType:\\\"none\\\",connectedStyle:{},connectedX:NaN,connectedY:NaN},DefaultDebugAttribute={_debug_bounds:!1},DefaultAttribute=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:\\\"default\\\",pickMode:\\\"accurate\\\",customPickShape:null,boundsMode:\\\"accurate\\\",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:\\\"\\\",overflow:\\\"hidden\\\",shadowPickMode:\\\"graphic\\\",keepStrokeScale:!1},DefaultDebugAttribute),DefaultStyle),DefaultTransform),DefaultArcAttribute=Object.assign(Object.assign({},DefaultAttribute),{startAngle:0,endAngle:pi2,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),DefaultAreaAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultConnectAttribute),{points:[],segments:[],curveType:\\\"linear\\\",clipRange:1,closePath:!1,curveTension:1}),DefaultCircleAttribute=Object.assign(Object.assign({},DefaultAttribute),{radius:1,startAngle:0,endAngle:pi2}),DefaultGroupAttribute=Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:\\\"relative\\\",flexDirection:\\\"row\\\",flexWrap:\\\"wrap\\\",justifyContent:\\\"flex-start\\\",alignItems:\\\"flex-start\\\",alignContent:\\\"flex-start\\\",baseOpacity:1}),DefaultGlyphAttribute=Object.assign(Object.assign({},DefaultAttribute),{path:\\\"\\\",width:0,height:0,cornerRadius:0,clip:!1}),DefaultLineAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultConnectAttribute),{points:[],segments:[],curveType:\\\"linear\\\",clipRange:1,clipRangeByDimension:\\\"default\\\",closePath:!1,curveTension:1}),DefaultPathAttribute=Object.assign(Object.assign({},DefaultAttribute),{path:new CustomPath2D,fillStrokeOrder:1,customPath:()=>{Logger.getInstance().warn(\\\"空函数\\\")}}),DefaultPolygonAttribute=Object.assign(Object.assign({},DefaultAttribute),{points:[],cornerRadius:0,closePath:!0}),DefaultRectAttribute=Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0}),DefaultRect3dAttribute=Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0}),DefaultSymbolAttribute=Object.assign(Object.assign({},DefaultAttribute),{symbolType:\\\"circle\\\",size:10,keepDirIn3d:!0}),DefaultTextAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultTextStyle),{strokeBoundsBuffer:0,keepDirIn3d:!0}),DefaultRichTextAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultTextStyle),{editable:!1,width:300,height:300,ellipsis:!0,wordBreak:\\\"break-word\\\",verticalDirection:\\\"top\\\",textAlign:\\\"left\\\",textBaseline:\\\"top\\\",layoutDirection:\\\"horizontal\\\",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),DefaultImageAttribute=Object.assign(Object.assign({repeatX:\\\"no-repeat\\\",repeatY:\\\"no-repeat\\\",image:\\\"\\\",width:0,height:0},DefaultAttribute),{fill:!0,cornerRadius:0}),DefaultRichTextIconAttribute=Object.assign(Object.assign({},DefaultImageAttribute),{backgroundShowMode:\\\"never\\\",backgroundWidth:0,backgroundHeight:0,textAlign:\\\"left\\\",textBaseline:\\\"middle\\\",direction:\\\"horizontal\\\",margin:0,id:\\\"\\\",width:20,height:20,backgroundFill:\\\"rgba(101, 117, 168, 0.1)\\\",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1}),Application=(init_esbuild_inject(),init_esbuild_inject(),class{}),application=new Application,parse=(init_esbuild_inject(),init_esbuild_inject(),function(){const o={linearGradient:/^(linear\\\\-gradient)/i,radialGradient:/^(radial\\\\-gradient)/i,conicGradient:/^(conic\\\\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\\\\-side|closest\\\\-corner|farthest\\\\-side|farthest\\\\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?)))px/,percentageValue:/^(-?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?)))\\\\%/,emValue:/^(-?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?)))em/,angleValue:/^(-?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?)))deg/,fromAngleValue:/^from\\\\s*(-?(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?)))deg/,startCall:/^\\\\(/,endCall:/^\\\\)/,comma:/^,/,hexColor:/(^\\\\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\\\\(\\\\d{1,3},\\\\s*\\\\d{1,3},\\\\s*\\\\d{1,3}\\\\))/i,rgbaColor:/^(rgba\\\\(\\\\d{1,3},\\\\s*\\\\d{1,3},\\\\s*\\\\d{1,3},\\\\s*((\\\\d\\\\.\\\\d+)|\\\\d{1,3})\\\\))/i,number:/^(([0-9]*\\\\.[0-9]+)|([0-9]+\\\\.?))/};let r=\\\"\\\";function n(e){var t=new Error(r+\\\": \\\"+e);throw t.source=r,t}function i(){return e(\\\"linear\\\",o.linearGradient,t)||e(\\\"radial\\\",o.radialGradient,l)||e(\\\"conic\\\",o.conicGradient,a)}function e(t,e,i){var r=b(e);if(r)return b(o.startCall)||n(\\\"Missing (\\\"),r=function(){const e=i();return e&&(b(o.comma)||n(\\\"Missing comma before color stops\\\")),{type:t,orientation:e,colorStops:c(g)}}(),b(o.endCall)||n(\\\"Missing )\\\"),r}function t(){return m(\\\"directional\\\",o.sideOrCorner,1)||m(\\\"angular\\\",o.angleValue,1)}function a(){return m(\\\"angular\\\",o.fromAngleValue,1)}function l(){let e,t,i=s();return i&&((e=[]).push(i),t=r,b(o.comma))&&((i=s())?e.push(i):r=t),e}function s(){(t=m(\\\"shape\\\",/^(circle)/i,0))&&(t.style=f()||h());let e=t||((t=m(\\\"shape\\\",/^(ellipse)/i,0))&&(t.style=p()||h()),t);var t;return e?e.at=d():(t=h())?(e=t,(t=d())&&(e.at=t)):(t=u())&&(e={type:\\\"default-radial\\\",at:t}),e}function h(){return m(\\\"extent-keyword\\\",o.extentKeywords,1)}function d(){var e;if(m(\\\"position\\\",/^at/,0))return(e=u())||n(\\\"Missing positioning value\\\"),e}function u(){var e={x:p(),y:p()};if(e.x||e.y)return{type:\\\"position\\\",value:e}}function c(e){let t=e();var i=[];if(t)for(i.push(t);b(o.comma);)(t=e())?i.push(t):n(\\\"One extra comma\\\");return i}function g(){var e=m(\\\"hex\\\",o.hexColor,1)||m(\\\"rgba\\\",o.rgbaColor,1)||m(\\\"rgb\\\",o.rgbColor,1)||m(\\\"literal\\\",o.literalColor,0);return e||n(\\\"Expected color definition\\\"),e.length=p(),e}function p(){return m(\\\"%\\\",o.percentageValue,1)||m(\\\"position-keyword\\\",o.positionKeywords,1)||f()}function f(){return m(\\\"px\\\",o.pixelValue,1)||m(\\\"em\\\",o.emValue,1)}function m(e,t,i){var r=b(t);if(r)return{type:e,value:r[i]}}function b(e){var t=/^[\\\\n\\\\r\\\\t\\\\s]+/.exec(r),t=(t&&C(t[0].length),e.exec(r));return t&&C(t[0].length),t}function C(e){r=r.substr(e)}return function(e){return r=e.toString(),t=c(i),0<r.length&&n(\\\"Invalid input not EOF\\\"),t;var t}}()),GradientParser=class vJ{static IsGradient(e){return!(\\\"string\\\"==typeof e&&!e.includes(\\\"gradient\\\"))}static IsGradientStr(e){return\\\"string\\\"==typeof e&&e.includes(\\\"gradient\\\")}static Parse(e){if(vJ.IsGradientStr(e))try{var t=parse(e)[0];if(t){if(\\\"linear\\\"===t.type)return vJ.ParseLinear(t);if(\\\"radial\\\"===t.type)return vJ.ParseRadial(t);if(\\\"conic\\\"===t.type)return vJ.ParseConic(t)}}catch(err){}return e}static ParseConic(e){var{orientation:t,colorStops:i=[]}=e,r=pi/2,t=parseFloat(t.value)/180*pi-r;return{gradient:\\\"conical\\\",x:.5,y:.5,startAngle:t,endAngle:t+pi2,stops:i.map(e=>({color:e.value,offset:parseFloat(e.length.value)/100}))}}static ParseRadial(e){var{colorStops:t=[]}=e;return{gradient:\\\"radial\\\",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:t.map(e=>({color:e.value,offset:parseFloat(e.length.value)/100}))}}static ParseLinear(e){var{orientation:t,colorStops:i=[]}=e,r=pi/2;let o=\\\"angular\\\"===t.type?parseFloat(t.value)/180*pi:0;for(;o<0;)o+=pi2;for(;o>=pi2;)o-=pi2;let n=0,a=0,l=0,s=0;return o<r?(n=0,a=1,l=Math.sin(o),s=a-Math.cos(o)):o<pi?(n=0,a=0,l=Math.cos(o-r),s=Math.sin(o-r)):o<pi+r?(n=1,a=0,l=n-Math.sin(o-pi),s=Math.cos(o-pi)):(n=1,l=n-Math.cos(o-r-pi),s-=Math.sin(o-r-pi)),{gradient:\\\"linear\\\",x0:n,y0:a,x1:l,y1:s,stops:i.map(e=>({color:e.value,offset:parseFloat(e.length.value)/100}))}}};function getScaledStroke(e,t,i){var r=t,{a:o,b:n,c:a,d:l}=e.currentMatrix,o=Math.sign(o)*Math.sqrt(o*o+n*n),n=Math.sign(l)*Math.sqrt(a*a+l*l);return o+n==0?0:r/Math.abs(o+n)*2*i}function createColor(o,t,n,a=0,l=0){if(!t||!0===t)return\\\"black\\\";let s,h;if(isArray_default(t))for(let e=0;e<t.length&&!(h=t[e]);e++);else h=t;if(\\\"string\\\"==typeof(h=GradientParser.Parse(h)))return h;if(n.AABBBounds&&(!n.attribute||0!==n.attribute.scaleX||0!==n.attribute.scaleY)){var d,u=n.AABBBounds;let e=u.x2-u.x1,t=u.y2-u.y1,i=u.x1-a,r=u.y1-l;n.attribute&&(({scaleX:u=1,scaleY:d=1}=n.attribute),e/=u,t/=d,i/=u,r/=d),\\\"linear\\\"===h.gradient?s=createLinearGradient(o,h,i,r,e,t):\\\"conical\\\"===h.gradient?s=createConicGradient(o,h,i,r,e,t):\\\"radial\\\"===h.gradient&&(s=createRadialGradient(o,h,i,r,e,t))}return s||\\\"orange\\\"}function createLinearGradient(e,t,i,r,o,n){var a;const l=e.createLinearGradient(i+(null!=(a=t.x0)?a:0)*o,r+(null!=(a=t.y0)?a:0)*n,i+(null!=(a=t.x1)?a:1)*o,r+(null!=(a=t.y1)?a:0)*n);return t.stops.forEach(e=>{l.addColorStop(e.offset,e.color)}),l}function createRadialGradient(e,t,i,r,o,n){var a;const l=e.createRadialGradient(i+(null!=(a=t.x0)?a:.5)*o,r+(null!=(a=t.y0)?a:.5)*n,Math.max(o,n)*(null!=(a=t.r0)?a:0),i+(null!=(a=t.x1)?a:.5)*o,r+(null!=(a=t.y1)?a:.5)*n,Math.max(o,n)*(null!=(a=t.r1)?a:.5));return t.stops.forEach(e=>{l.addColorStop(e.offset,e.color)}),l}function createConicGradient(e,t,i,r,o,n){var a;const l=e.createConicGradient(i+(null!=(a=t.x)?a:0)*o,r+(null!=(a=t.y)?a:0)*n,t.startAngle,t.endAngle);return t.stops.forEach(e=>{l.addColorStop(e.offset,e.color)}),l.GetPattern(o+i,n+r,void 0)}var DIRECTION_KEY={horizontal:{width:\\\"width\\\",height:\\\"height\\\",left:\\\"left\\\",top:\\\"top\\\",x:\\\"x\\\",y:\\\"y\\\",bottom:\\\"bottom\\\"},vertical:{width:\\\"height\\\",height:\\\"width\\\",left:\\\"top\\\",top:\\\"left\\\",x:\\\"y\\\",y:\\\"x\\\",bottom:\\\"right\\\"}},defaultFormatting={fontSize:16,fontFamily:DEFAULT_TEXT_FONT_FAMILY,fill:!0,stroke:!1,fontWeight:\\\"normal\\\",lineHeight:\\\"normal\\\",fontStyle:\\\"normal\\\",textDecoration:\\\"none\\\",textAlign:\\\"left\\\",script:\\\"normal\\\"},nbsp=String.fromCharCode(160),regLetter=/\\\\w|\\\\(|\\\\)|-/,regPunctuation=/[.?!,;:/，。？！、；：]/,regFirstSpace=/\\\\S/,setTextStyle=(e,t)=>{let i=t.fontSize||16;switch(t.script){case\\\"super\\\":case\\\"sub\\\":i*=.8}e.setTextStyle({textAlign:\\\"left\\\",textBaseline:t.textBaseline||\\\"alphabetic\\\",fontStyle:t.fontStyle||\\\"\\\",fontWeight:t.fontWeight||\\\"\\\",fontSize:i,fontFamily:t.fontFamily})};function applyFillStyle(e,t,i){var r,o,n=t&&t.fill||defaultFormatting.fill;n?(({fillOpacity:r=1,opacity:o=1}=t),e.globalAlpha=r*o,e.fillStyle=i?createColor(e,n,{AABBBounds:i}):n,setTextStyle(e,t)):e.globalAlpha=0}function applyStrokeStyle(e,t){var i,r,o=t&&t.stroke||defaultFormatting.stroke;o?(({strokeOpacity:i=1,opacity:r=1}=t),e.globalAlpha=i*r,e.lineWidth=t&&\\\"number\\\"==typeof t.lineWidth?t.lineWidth:1,e.strokeStyle=o,setTextStyle(e,t)):e.globalAlpha=0}function getStrByWithCanvas(e,t,i,r,o){if(!t||t<=0)return 0;var n=application.graphicUtil.textMeasure;let a=r,l=e.slice(0,a),s=Math.floor(n.measureText(l,i).width),h=e.slice(0,a+1),d=Math.floor(n.measureText(h,i).width);for(;s>t||d<=t;){if(s>t?a--:a++,a>e.length){a=e.length;break}if(a<0){a=0;break}l=e.slice(0,a),s=Math.floor(n.measureText(l,i).width),h=e.slice(0,a+1),d=Math.floor(n.measureText(h,i).width)}return a=o?testLetter(e,a):a}function testLetter(e,t,i=!1){let r=t;for(;regLetter.test(e[r-1])&&regLetter.test(e[r])||regPunctuation.test(e[r]);)if(--r<=0)return i?testLetter2(e,t):t;return r}function testLetter2(e,t){let i=t;for(;regLetter.test(e[i-1])&&regLetter.test(e[i])||regPunctuation.test(e[i]);)if(++i>=e.length)return i;return i}function measureTextCanvas(e,t){var i=application.graphicUtil.textMeasure.measureText(e,t),r={ascent:0,height:0,descent:0,width:0};return\\\"number\\\"!=typeof i.actualBoundingBoxAscent||\\\"number\\\"!=typeof i.actualBoundingBoxDescent?(r.width=Math.floor(i.width),r.height=t.fontSize||0,r.ascent=r.height,r.descent=0):(r.width=Math.floor(i.width),r.height=Math.floor(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent),r.ascent=Math.floor(i.actualBoundingBoxAscent),r.descent=r.height-r.ascent),r}var __decorate2=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},ATextMeasure=class{configure(e,t){this.canvas=e.canvas,this.context=e.context,e.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(e,t,i){this.context.setTextStyleWithoutAlignBaseline(t);var r=this.context.measureText(e);return i?this.compatibleMetrics(r,t):r}_measureTextWithAlignBaseline(e,t,i){this.context.setTextStyle(t);var r=this.context.measureText(e);return i?this.compatibleMetrics(r,t):r}compatibleMetrics(e,t){var i,r;return null!=e.actualBoundingBoxAscent&&null!=e.actualBoundingBoxDescent&&null!=e.fontBoundingBoxAscent&&null!=e.fontBoundingBoxDescent||(e={width:e.width},({ascent:i,descent:r}=this.measureTextBoundADscentEstimate(t)),e.actualBoundingBoxAscent=i,e.actualBoundingBoxDescent=r,e.fontBoundingBoxAscent=i,e.fontBoundingBoxDescent=r),null!=e.actualBoundingBoxLeft&&null!=e.actualBoundingBoxRight||(e={width:e.width,actualBoundingBoxAscent:e.actualBoundingBoxAscent,actualBoundingBoxDescent:e.actualBoundingBoxDescent,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent},({left:i,right:r}=this.measureTextBoundLeftRightEstimate(t)),e.actualBoundingBoxLeft=i,e.actualBoundingBoxRight=r),e}estimate(e,{fontSize:t=DefaultTextAttribute.fontSize}){let i=0,r=0;for(let o=0;o<e.length;o++)e.charCodeAt(o)<128?i++:r++;return{width:~~(.8*i*t+r*t),height:t}}measureTextWidth(e,t,i){return(this.context?i=null!=i?i:this._measureTextWithoutAlignBaseline(e,t):this.estimate(e,t)).width}measureTextBoundsWidth(e,t,i){return(this.context?i=null!=i?i:this._measureTextWithoutAlignBaseline(e,t):this.estimate(e,t)).width}measureTextBoundsLeftRight(e,t,i){return this.context?{left:(i=null!=i?i:this._measureTextWithAlignBaseline(e,t,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(t)}measureTextPixelHeight(e,t,i){var r;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(e,t,!0),Math.abs(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)):null!=(r=t.fontSize)?r:DefaultTextStyle.fontSize}measureTextPixelADscent(e,t,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(e,t,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundHieght(e,t,i){var r;return this.context?(i=null!=i?i:this._measureTextWithoutAlignBaseline(e,t,!0),Math.abs(i.fontBoundingBoxAscent-i.fontBoundingBoxDescent)):null!=(r=t.fontSize)?r:DefaultTextStyle.fontSize}measureTextBoundADscent(e,t,i){return this.context?{ascent:(i=null!=i?i:this._measureTextWithAlignBaseline(e,t,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundADscentEstimate(e){var t=null!=(t=e.fontSize)?t:DefaultTextStyle.fontSize;return{ascent:.79*t,descent:.21*t}}measureTextBoundLeftRightEstimate(e){var t=null!=(t=e.fontSize)?t:DefaultTextStyle.fontSize,i=e.textAlign;return\\\"center\\\"===i?{left:t/2,right:t/2}:\\\"right\\\"===i||\\\"end\\\"===i?{left:t,right:0}:{left:0,right:t}}measureTextPixelADscentAndWidth(e,t,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:this.estimate(e,t).width});var r,o=this._measureTextWithoutAlignBaseline(e,t,!0);if(i===MeasureModeEnum.actualBounding)return{ascent:o.actualBoundingBoxAscent,descent:o.actualBoundingBoxDescent,width:o.width};if(i===MeasureModeEnum.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:o.width});if(i!==MeasureModeEnum.fontBounding)return{ascent:o.actualBoundingBoxAscent,descent:o.actualBoundingBoxDescent,width:o.width};{let e=o.fontBoundingBoxAscent,t=o.fontBoundingBoxDescent;return o.actualBoundingBoxDescent&&t<o.actualBoundingBoxDescent?(r=o.actualBoundingBoxDescent-t,t+=r,e-=r):o.actualBoundingBoxAscent&&e<o.actualBoundingBoxAscent&&(r=o.actualBoundingBoxAscent-e,e+=r,t-=r),{ascent:e,descent:t,width:o.width}}}measureText(e,t){return this.context?(this.context.setTextStyleWithoutAlignBaseline(t),this.context.measureText(e)):this.estimate(e,t)}clipTextVertical(r,o,e,t){if(0===r.length)return{verticalList:r,width:0};let{fontSize:i=12}=o;r.forEach(e=>{e.width=0===e.direction?i:this.measureTextWidth(e.text,o)});var n=[];let a=0,l=0;for(;l<r.length&&a+r[l].width<e;l++)a+=r[l].width,n.push(r[l]);if(r[l]&&1<r[l].text.length){var s=this._clipText(r[l].text,o,e-a,0,r[l].text.length-1,\\\"end\\\",!1);if(t&&s.str!==r[l].text){let e=\\\"\\\",t=0;for(let i=0;i<l;i++){var h=r[i];e+=h.text,t+=h.text.length}e+=r[l].text;var d=t+s.str.length,d=testLetter(e,d);(d-=t)!=s.str.length-1&&(s.str=s.str.substring(0,d),s.width=this.measureTextWidth(s.str,o))}n.push(Object.assign(Object.assign({},r[l]),{text:s.str,width:s.width})),a+=s.width}return{verticalList:n,width:a}}clipText(t,i,e,r,o){if(0===t.length)return{str:\\\"\\\",width:0};var n=this.measureTextWidth(t,i);if(n<=e)return{str:t,width:n};if(e<this.measureTextWidth(t[0],i))return{str:\\\"\\\",width:0};n=this._clipText(t,i,e,0,t.length-1,\\\"end\\\",!1);if(r&&n.str!==t){let e=testLetter(t,n.str.length,o);e!==n.str.length&&(e>n.str.length&&(n.wordBreaked=e,e=n.str.length),n.str=t.substring(0,e),n.width=this.measureTextWidth(n.str,i))}return n}_clipText(e,t,i,r,o,n,a){let l;var s;return\\\"start\\\"===n?(l=this._clipTextStart(e,t,i,r,o),a&&(l.result=a+l.str)):\\\"middle\\\"===n?(s=this._clipTextMiddle(e,t,i,\\\"\\\",\\\"\\\",0,0,1),l={str:\\\"none\\\",width:s.width,result:s.left+a+s.right}):(l=this._clipTextEnd(e,t,i,r,o),a&&(l.result=l.str+a)),l}_clipTextEnd(e,t,i,r,o){if(r===o)return Logger.getInstance().warn(`【_clipTextEnd】不应该走到这里${e}, ${r}, `+o),{str:a=e.substring(0,o+1),width:this.measureTextWidth(a,t)};var n,a=Math.floor((r+o)/2),l=e.substring(0,a+1),s=this.measureTextWidth(l,t);let h;return i<s?l.length<=1?{str:\\\"\\\",width:0}:(n=e.substring(0,a),(h=this.measureTextWidth(n,t))<=i?{str:n,width:h}:this._clipTextEnd(e,t,i,r,a)):s<i?a>=e.length-1?{str:e,width:this.measureTextWidth(e,t)}:(n=e.substring(0,a+2),(h=this.measureTextWidth(n,t))>=i?{str:l,width:s}:this._clipTextEnd(e,t,i,a,o)):{str:l,width:s}}_clipTextStart(e,t,i,r,o){var n,a=Math.ceil((r+o)/2),l=e.substring(a-1,e.length),s=this.measureTextWidth(l,t);let h;return i<s?l.length<=1?{str:\\\"\\\",width:0}:(n=e.substring(a,e.length),(h=this.measureTextWidth(n,t))<=i?{str:n,width:h}:this._clipTextStart(e,t,i,a,e.length)):s<i?a<=0?{str:e,width:this.measureTextWidth(e,t)}:(n=e.substring(a-2,e.length),(h=this.measureTextWidth(n,t))>=i?{str:l,width:s}:this._clipTextStart(e,t,i,r,a)):{str:l,width:s}}_clipTextMiddle(e,t,i,r,o,n,a,l){var s,h,d=e.substring(0,l),u=this.measureTextWidth(d,t);return i<u+a?{left:r,right:o,width:n+a}:(s=e.substring(e.length-l,e.length),i<u+(h=this.measureTextWidth(s,t))?{left:d,right:o,width:u+a}:this._clipTextMiddle(e,t,i,d,s,u,h,l+1))}clipTextWithSuffixVertical(e,t,i,r,o,n){if(\\\"\\\"===r)return this.clipTextVertical(e,t,i,o);if(0===e.length)return{verticalList:e,width:0};var a=this.clipTextVertical(e,t,i,o);if(a.verticalList.length===e.length&&a.verticalList[a.verticalList.length-1].width===e[e.length-1].width)return a;var l=this.measureTextWidth(r,t);if(i<l)return a;let s;if(i-=l,\\\"start\\\"===n){a=this.revertVerticalList(e),a=(s=this.clipTextVertical(a,t,i,o),this.revertVerticalList(s.verticalList));a.unshift({text:r,direction:1,width:l}),s.verticalList=a}else if(\\\"middle\\\"===n){const h=this.clipTextVertical(e,t,i/2,o),d=this.revertVerticalList(e),u=this.clipTextVertical(d,t,i/2,o);h.verticalList.push({text:r,direction:1,width:l}),this.revertVerticalList(u.verticalList).forEach(e=>h.verticalList.push(e)),s={verticalList:h.verticalList,width:h.width+u.width}}else(s=this.clipTextVertical(e,t,i,o)).verticalList.push({text:r,direction:1,width:l});return s.width+=l,s}revertVerticalList(e){return e.reverse().map(e=>{var t=e.text.split(\\\"\\\").reverse().join(\\\"\\\");return Object.assign(Object.assign({},e),{text:t})})}clipTextWithSuffix(e,t,i,r,o,n,a=!1){var l,s,h;return\\\"\\\"===r?this.clipText(e,t,i,o):0===e.length?{str:\\\"\\\",width:0}:(s=this.measureTextWidth(e,t),!a&&s<=i?{str:e,width:s}:i<(l=this.measureTextWidth(r,t))?{str:\\\"\\\",width:0}:a&&s+l<=i?{str:e+r,width:s+l}:(s=this._clipText(e,t,i-=l,0,e.length-1,n,r),o&&s.str!==e?(h=testLetter(e,s.str.length))!==s.str.length&&(s.result=e.substring(0,h),s.width=this.measureTextWidth(s.str,t)):a&&s.str===e&&(s.result=e+r),s.str=s.result,s.width+=l,s))}},ATextMeasure=__decorate2([injectable()],ATextMeasure),__decorate3=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},TextMeasureContribution=Symbol[\\\"for\\\"](\\\"TextMeasureContribution\\\"),DefaultTextMeasureContribution=class extends ATextMeasure{},DefaultTextMeasureContribution=__decorate3([injectable()],DefaultTextMeasureContribution),container=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),new Container),CanvasFactory=(init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"CanvasFactory\\\")),Context2dFactory=Symbol[\\\"for\\\"](\\\"Context2dFactory\\\");function wrapCanvas(e){return container.getNamed(CanvasFactory,application.global.env)(e)}var TransformMode,THREE_SQRT=Math.sqrt(3),ONE_THIRD=1/3,DefaultCanvasAllocate=class{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(e){var t;return this.pools.length?((t=this.pools.pop()).resize(e.width,e.height),t.dpr=e.dpr):(t=wrapCanvas(Object.assign({nativeCanvas:application.global.createCanvas(e)},e)),this.allocatedCanvas.push(t)),t}allocateByObj(e){var t;return this.pools.length?((t=this.pools.pop()).width=e.width,t.height=e.height):(t={width:e.width/e.dpr,height:e.height/e.dpr,dpr:e.dpr},t=wrapCanvas(Object.assign({nativeCanvas:application.global.createCanvas(t)},t)),this.allocatedCanvas.push(t)),t}free(e){this.pools.push(e)}get length(){return this.pools.length}release(){this.pools=[]}},canvasAllocate=new DefaultCanvasAllocate,__decorate4=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata2=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},VWindow=Symbol[\\\"for\\\"](\\\"VWindow\\\"),WindowHandlerContribution=Symbol[\\\"for\\\"](\\\"WindowHandlerContribution\\\"),DefaultWindow=class{get width(){var e;return this._handler?(e=this._handler.getWH(),this._width=e.width):this._width}get height(){var e;return this._handler?(e=this._handler.getWH(),this._height=e.height):this._height}get dpr(){return this._handler.getDpr()}constructor(){this.hooks={onChange:new SyncHook([\\\"x\\\",\\\"y\\\",\\\"width\\\",\\\"height\\\"])},this.active=()=>{var e=this.global;e.env&&!this.actived&&(container.getNamed(WindowHandlerContribution,e.env).configure(this,e),this.actived=!0)},this._uid=Generator.GenAutoIncrementId(),this.global=application.global,this.postInit()}postInit(){this.global.hooks.onSetEnv.tap(\\\"window\\\",this.active),this.active()}get style(){var e;return null!=(e=this._handler.getStyle())?e:{}}set style(e){this._handler.setStyle(e)}create(e){this._handler.createWindow(e);var t=this._handler.getWH();this._width=t.width,this._height=t.height,e.viewBox?this.setViewBox(e.viewBox):!1!==e.canvasControled?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:null!=(t=e.width)?t:this._width,y2:null!=(t=e.height)?t:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(e){this._handler=e}setDpr(e){return this._handler.setDpr(e)}resize(e,t){return this._handler.resizeWindow(e,t)}configure(){throw new Error(\\\"暂不支持\\\")}release(){return this.global.hooks.onSetEnv.unTap(\\\"window\\\",this.active),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(e){return this._handler.getImageBuffer?this._handler.getImageBuffer(e):null}addEventListener(e,t,i){return this._handler.addEventListener(e,t,i)}removeEventListener(e,t,i){return this._handler.removeEventListener(e,t,i)}dispatchEvent(e){return this._handler.dispatchEvent(e)}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(e){this._handler.clearViewBox(e)}setViewBox(e){this._handler.setViewBox(e)}setViewBoxTransform(e,t,i,r,o,n){this._handler.setViewBoxTransform(e,t,i,r,o,n)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(e,t){var i=this._handler.getViewBox(),r={x:e,y:t};return this._handler.getViewBoxTransform().transformPoint({x:e,y:t},r),r.x-=i.x1,r.y-=i.y1,r}hasSubView(){var e=this._handler.getViewBox();return!(0===e.x1&&0===e.y1&&isNumberClose(this.width,e.width())&&isNumberClose(this.height,e.height()))}isVisible(e){return this._handler.isVisible(e)}onVisibleChange(e){return this._handler.onVisibleChange(e)}getTopLeft(e){return this._handler.getTopLeft(e)}},DefaultWindow=__decorate4([injectable(),__metadata2(\\\"design:paramtypes\\\",[])],DefaultWindow),__decorate5=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata3=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param2=function(i,r){return function(e,t){r(e,t,i)}},DefaultGraphicUtil=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(e){this.contributions=e,this.configured=!1,this.global=application.global,this.global.hooks.onSetEnv.tap(\\\"graphic-util\\\",(e,t,i)=>{this.configured=!1,this.configure(i,t)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(e,t){this.configured||(this.contributions.getContributions().forEach(e=>{e.configure(this,t)}),this.configured=!0)}tryInitCanvas(){var e;this._canvas||(e=canvasAllocate.shareCanvas(),this._canvas=e,this._context=e.getContext(\\\"2d\\\"))}bindTextMeasure(e){this._textMeasure=e}measureText(e,t,i=\\\"native\\\"){this.configure(this.global,this.global.env);var r=this.global.measureTextMethod,o=(this.global.measureTextMethod=i,{width:this._textMeasure.measureTextWidth(e,t),height:null!=(o=t.fontSize)?o:DefaultTextStyle.fontSize});return this.global.measureTextMethod=r,o}createTextMeasureInstance(e,t,i){return this.configure(this.global,this.global.env),new TextMeasure(Object.assign({defaultFontParams:{fontFamily:DefaultTextStyle.fontFamily,fontSize:DefaultTextStyle.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:`-/: .,@%'\\\"~`+TextMeasure.ALPHABET_CHAR_SET+TextMeasure.ALPHABET_CHAR_SET.toUpperCase()},null!=t?t:{}),e)}drawGraphicToCanvas(e,t,i){var r,o,n,a,l,s;return t.defaultLayer&&(r=container.get(VWindow),n=(o=e.AABBBounds).width(),a=o.height(),s=-o.x1,l=-o.y1,r.create({viewBox:{x1:s,y1:l,x2:o.x2,y2:o.y2},width:n,height:a,canvas:i,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:\\\"\\\"}),s=t.params.optimize.disableCheckGraphicWidthOutRange,t.params.optimize.disableCheckGraphicWidthOutRange=!0,t.defaultLayer.getNativeHandler().drawTo(r,[e],{transMatrix:r.getViewBoxTransform(),viewBox:r.getViewBox(),stage:t,layer:t.defaultLayer,renderService:t.renderService,background:\\\"transparent\\\",clear:!0,updateBounds:!1}),t.params.optimize.disableCheckGraphicWidthOutRange=s,r.getNativeHandler().nativeCanvas)||null}},DefaultGraphicUtil=__decorate5([injectable(),__param2(0,inject(ContributionProvider)),__param2(0,named(TextMeasureContribution)),__metadata3(\\\"design:paramtypes\\\",[Object])],DefaultGraphicUtil),_matrix=(!function(e){e[e.transform=0]=\\\"transform\\\",e[e.matrix=1]=\\\"matrix\\\"}(TransformMode=TransformMode||{}),new Matrix),DefaultTransformUtil=class{constructor(){this.matrix=new Matrix}init(e){return this.mode=TransformMode.transform,this.originTransform=e,this.matrix.reset(),this}fromMatrix(e,t){return this.mode=TransformMode.matrix,this.outSourceMatrix=e,this.outTargetMatrix=t,this}scaleMatrix(e,t,i){var r,o=this.outSourceMatrix;return _matrix.setValue(o.a,o.b,o.c,o.d,o.e,o.f),this.outTargetMatrix.reset(),i?(({x:o,y:r}=i),this.outTargetMatrix.translate(o,r),this.outTargetMatrix.scale(e,t),this.outTargetMatrix.translate(-o,-r)):this.outTargetMatrix.scale(e,t),this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}rotateMatrix(e,t){var i,r=this.outSourceMatrix;return _matrix.setValue(r.a,r.b,r.c,r.d,r.e,r.f),this.outTargetMatrix.reset(),t?(({x:r,y:i}=t),this.outTargetMatrix.translate(r,i),this.outTargetMatrix.rotate(e),this.outTargetMatrix.translate(-r,-i)):this.outTargetMatrix.rotate(e),this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}scale(e,t,i){return this.mode===TransformMode.matrix?this.scaleMatrix(e,t,i):this}rotate(e,t){return this.mode===TransformMode.matrix?this.rotateMatrix(e,t):this}translateMatrix(e,t){var i=this.outSourceMatrix;return _matrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(e,t),this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}translate(e,t){return this.mode===TransformMode.matrix?this.translateMatrix(e,t):this}simplify(e){return this.mode===TransformMode.matrix?this.simplifyMatrix(e):this}simplifyMatrix(e){return this}},DefaultTransformUtil=__decorate5([injectable(),__metadata3(\\\"design:paramtypes\\\",[])],DefaultTransformUtil),defaultThemeObj=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),{arc:DefaultArcAttribute,area:DefaultAreaAttribute,circle:DefaultCircleAttribute,line:DefaultLineAttribute,path:DefaultPathAttribute,symbol:DefaultSymbolAttribute,text:DefaultTextAttribute,rect:DefaultRectAttribute,polygon:DefaultPolygonAttribute,richtext:DefaultRichTextAttribute,richtextIcon:DefaultRichTextIconAttribute,image:DefaultImageAttribute,group:DefaultGroupAttribute,glyph:DefaultGlyphAttribute}),themeKeys=Object.keys(defaultThemeObj);function newThemeObj(){return{arc:Object.assign({},defaultThemeObj.arc),area:Object.assign({},defaultThemeObj.area),circle:Object.assign({},defaultThemeObj.circle),line:Object.assign({},defaultThemeObj.line),path:Object.assign({},defaultThemeObj.path),symbol:Object.assign({},defaultThemeObj.symbol),text:Object.assign({},defaultThemeObj.text),rect:Object.assign({},defaultThemeObj.rect),polygon:Object.assign({},defaultThemeObj.polygon),richtext:Object.assign({},defaultThemeObj.richtext),richtextIcon:Object.assign({},defaultThemeObj.richtextIcon),image:Object.assign({},defaultThemeObj.image),group:Object.assign({},defaultThemeObj.group),glyph:Object.assign({},defaultThemeObj.glyph)}}function combine(t,i){Object.keys(i).forEach(e=>{t[e]=i[e]})}var globalThemeObj=newThemeObj(),Theme=class{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},themeKeys.forEach(e=>{this._defaultTheme[e]=Object.create(globalThemeObj[e])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(t&&this.dirty){let e={};var i=this.getParentWithTheme(t);i&&(e=i.theme),this.applyTheme(t,e)}return this.combinedTheme}getParentWithTheme(e){for(;e.parent;)if((e=e.parent).theme)return e;return null}applyTheme(e,t,i=!1){var r,o;return this.dirty&&((r=this.getParentWithTheme(e))&&((o=r.theme).dirty||i)&&o.applyTheme(r,t,!0),this.userTheme?this.doCombine(r&&r.theme.combinedTheme):(r?this.combinedTheme=r.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Logger.getInstance().warn(\\\"未知错误，走到不应该走的区域里\\\")),this.dirty=!1)),this.combinedTheme}doCombine(i){const r=this.userTheme,o=this.combinedTheme;themeKeys.forEach(e=>{var t=Object.create(globalThemeObj[e]);i&&i[e]&&combine(t,i[e]),o[e]&&combine(t,o[e]),r[e]&&combine(t,r[e]),this.combinedTheme[e]=t}),r.common&&themeKeys.forEach(e=>{combine(this.combinedTheme[e],r.common)}),this.dirty=!1}setTheme(t,e){let i=this.userTheme;i?Object.keys(t).forEach(e=>{i[e]?Object.assign(i[e],t[e]):i[e]=Object.assign({},t[e])}):i=t,this.userTheme=i,this.dirty=!0,this.dirtyChildren(e)}resetTheme(e,t){this.userTheme=e,this.dirty=!0,this.dirtyChildren(t)}dirtyChildren(e){e.forEachChildren(e=>{e.isContainer&&(e.theme&&(e.theme.dirty=!0),this.dirtyChildren(e))})}},globalTheme=new Theme;function getTheme(e,t){return e.glyphHost?getTheme(e.glyphHost):t?(e.isContainer,t):getThemeFromGroup(e)||e.attachedThemeGraphic&&getTheme(e.attachedThemeGraphic)||globalTheme.getTheme()}function getThemeFromGroup(e){let t;if(t=e.isContainer?e:e.parent){for(;t&&!t.theme;)t=t.parent;return t?(t.theme||t.createTheme(),t.theme.getTheme(t)):globalTheme.getTheme()}return null}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __awaiter2=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},Node=class extends import_eventemitter3[\\\"default\\\"]{get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=Generator.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(i,e=!1){if(e){let e=this._lastChild,t=0;for(;e;){if(i(e,t++))return;e=e._prev}}else{let e=this._firstChild,t=0;for(;e;){if(i(e,t++))return;e=e._next}}}forEachChildrenAsync(r,e=!1){return __awaiter2(this,void 0,void 0,function*(){if(e){let t=this._lastChild,i=0;for(;t;){let e=r(t,i++);if(e=e.then?yield e:e)return;t=t._prev}}else{let t=this._firstChild,i=0;for(;t;){let e=r(t,i++);if(e=e.then?yield e:e)return;t=t._next}}})}forEach(e){return this.forEachChildren(e)}appendChild(e,t=!0){if(this._uid===e._uid)return null;if(!t&&e.isAncestorsOf(this))throw new Error(\\\"【Node::appendChild】不能将父辈元素append为子元素\\\");return e.parent&&e.parent.removeChild(e),(e.parent=this)._lastChild?((this._lastChild._next=e)._prev=this._lastChild,this._lastChild=e):(this._firstChild=this._lastChild=e)._prev=e._next=null,this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this.setCount(e.count),this._structEdit=!0,e}appendChildArrHighPerformance(e,t=0){return console.error(\\\"暂不支持该函数\\\"),e}insertBefore(e,t){if(!t)return this.appendChild(e);if(this===e||e===t)return null;if(e.isAncestorsOf(this))throw new Error(\\\"【Node::insertBefore】不能将父辈元素insert为子元素\\\");return t.parent!==this?null:(e.parent&&e.parent.removeChild(e),e.parent=this,e._prev=t._prev,t._prev?t._prev._next=e:this._firstChild=e,(t._prev=e)._next=t,this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this._structEdit=!0,this.setCount(e.count),e)}insertAfter(e,t){if(!t)return this.appendChild(e);if(this===e||e===t)return null;if(e.isAncestorsOf(this))throw new Error(\\\"【Node::insertAfter】不能将父辈元素insert为子元素\\\");return t.parent!==this?null:(e.parent&&e.parent.removeChild(e),e.parent=this,t._next?(t._next._prev=e)._next=t._next:this._lastChild=e,(t._next=e)._prev=t,this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this._structEdit=!0,this.setCount(e.count),e)}insertInto(i,r){if(!this._ignoreWarn&&this._nodeList&&Logger.getInstance().warn(\\\"insertIntoKeepIdx和insertInto混用可能会存在错误\\\"),r>=this.childrenCount)return this.appendChild(i);if(this===i)return null;if(i.isAncestorsOf(this))throw new Error(\\\"【Node::insertBefore】不能将父辈元素insert为子元素\\\");if(i.parent&&i.parent.removeChild(i),i.parent=this,0===r)i._next=this._firstChild,this._firstChild&&(this._firstChild._prev=i),i._prev=null,this._firstChild=i;else{let e=this._firstChild;for(let t=0;t<r;t++){if(!e)return null;0<t&&(e=e._next)}if(!e)return null;i._next=e._next,((i._prev=e)._next=i)._next&&(i._next._prev=i)}return this._idMap||(this._idMap=new Map),this._idMap.set(i._uid,i),this._structEdit=!0,this.setCount(i.count),i}insertIntoKeepIdx(e,t){if(this._nodeList||(this._nodeList=this.children),this._nodeList[t])return r=this._nodeList[t],this._nodeList.splice(t,0,e),this.insertBefore(e,r);let i;this._nodeList[t]=e;for(let o=t-1;0<=o&&!(i=this._nodeList[o]);o--);if(i)return i._next?this.insertBefore(e,i._next):this.appendChild(e);this._ignoreWarn=!0;var r=this.insertInto(e,0);return this._ignoreWarn=!1,r}removeChild(t){var e;return this._idMap&&this._idMap.has(t._uid)?(this._idMap[\\\"delete\\\"](t._uid),this._nodeList&&0<=(e=this._nodeList.findIndex(e=>e===t))&&this._nodeList.splice(e,1),t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,this._structEdit=!(t._next=null),this.setCount(-t.count),t):null}\\\"delete\\\"(){this.parent&&this.parent.removeChild(this)}removeAllChild(e){if(this._idMap){this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){var t=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=t}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}}replaceChild(e,t){throw new Error(\\\"暂不支持\\\")}find(i,e=!1){let r=null;return this.forEachChildren((e,t)=>!(e===this||!i(e,t)||(r=e,0))),e&&this.forEachChildren(e=>{if(e.isContainer){var t=e.find(i,!0);if(t)return r=t,!0}return!1}),r}findAll(i,e=!1){let r=[];return this.forEachChildren((e,t)=>{e!==this&&i(e,t)&&r.push(e)}),e&&this.forEachChildren(e=>{var t;e.isContainer&&(t=e.findAll(i,!0)).length&&(r=r.concat(t))}),r}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(e){return this.getElementById(e)}findChildByUid(e){return this._idMap&&this._idMap.get(e)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(e){return this.getElementsByName(e)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(e=>e.name===t,e)}getChildAt(e){let t=this._firstChild;if(!t)return null;for(let i=0;i<e;i++){if(!t._next)return null;t=t._next}return t}at(e){return this.getChildAt(e)}containNode(t){if(this._idMap){if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}}return!1}getRootNode(){let e=this.parent;for(;null!=e&&e.parent;)e=e.parent;return e||this}hasChildNodes(){return null!==this._firstChild}addChild(e){return this.appendChild(e)}add(e){return this.appendChild(e)}getChildren(){var e=[];let t=this._firstChild;for(;t;)e.push(t),t=t._next;return e}isChildOf(e){return!!this.parent&&this.parent._uid===e._uid}isParentOf(e){return e.isChildOf(this)}isDescendantsOf(e){let t=this.parent;if(t)do{if(t._uid===e._uid)return!0}while(null!==(t=t.parent));return!1}isAncestorsOf(e){return e.isDescendantsOf(this)}getAncestor(e){throw new Error(\\\"暂不支持\\\")}setAllDescendantsProps(e,t){let i=this._firstChild;for(;i;)i[e]=t,i.setAllDescendantsProps(e,t),i=i._next}setCount(e){this._count+=e;let t=this.parent;if(t)for(;t._count+=e,null!==(t=t.parent););}clone(){throw new Error(\\\"暂不支持\\\")}cloneTo(e){throw new Error(\\\"暂不支持\\\")}getParent(){return this.parent}del(e){return this.removeChild(e)}addEventListener(e,t,i){var r=isBoolean_default(i,!0)&&i||isObject_default(i)&&i.capture,o=isObject_default(i)&&i.once,n=isFunction_default(t)?void 0:t;return e=r?e+\\\"capture\\\":e,t=isFunction_default(t)?t:t.handleEvent,o?super.once(e,t,n):super.on(e,t,n),this}on(e,t,i){return this.addEventListener(e,t,i)}removeEventListener(e,t,i){var r=isBoolean_default(i,!0)&&i||isObject_default(i)&&i.capture,o=isFunction_default(t)?void 0:t,r=(e=r?e+\\\"capture\\\":e,t=isFunction_default(t)?t:t.handleEvent,isObject_default(i)&&i.once);return super.off(e,t,o,r),this}off(e,t,i){return this.removeEventListener(e,t,i)}once(e,t,i){return isObject_default(i)?(i.once=!0,this.addEventListener(e,t,i)):this.addEventListener(e,t,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(e,...t){return super.emit(e.type,e,...t),!e.defaultPrevented}emit(e,t){return this.dispatchEvent(e,t)}release(){this.removeAllListeners()}},FederatedEvent=(init_esbuild_inject(),class mU{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=mU.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(e){var t;e&&e.graphic&&(t=this.pickParams.graphic).stage&&(t=t.stage.eventSystem.manager.propagationPath(t),this.detailPath.push(t),this._composedDetailPath(e.params))}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch(err){this.nativeEvent.preventDefault&&isFunction_default(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch(err){this.nativeEvent.stopPropagation&&isFunction_default(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw new Error(\\\"Method not implemented.\\\")}}),FederatedMouseEvent=(init_esbuild_inject(),class extends FederatedEvent{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(e){return\\\"getModifierState\\\"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){throw new Error(\\\"Method not implemented.\\\")}}),FederatedPointerEvent=(init_esbuild_inject(),class HU extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return\\\"pointermove\\\"===this.type||\\\"mousemove\\\"===this.type||\\\"touchmove\\\"===this.type?[this]:[]}getPredictedEvents(){throw new Error(\\\"getPredictedEvents is not supported!\\\")}clone(){var e=new HU(this.manager),t=(e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.detailPath=[],e.target=null,e.nativeEvent=this.nativeEvent,e.originalEvent=this.originalEvent,null!=(t=this.manager)&&t.copyPointerData(this,e),null!=(t=this.manager)&&t.copyMouseData(this,e),null!=(t=this.manager)&&t.copyData(this,e),e.target=this.target,e.path=this.composedPath().slice(),this.composedDetailPath());return e.detailPath=t&&t.slice(),e.type=this.type,e}}),FederatedWheelEvent=(init_esbuild_inject(),class NU extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var e=new NU(this.manager),t=(e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.detailPath=[],e.target=null,e.nativeEvent=this.nativeEvent,e.originalEvent=this.originalEvent,null!=(t=this.manager)&&t.copyWheelData(this,e),null!=(t=this.manager)&&t.copyMouseData(this,e),null!=(t=this.manager)&&t.copyData(this,e),e.target=this.target,e.path=this.composedPath().slice(),this.composedDetailPath());return e.detailPath=t&&t.slice(),e.type=this.type,e}}),CustomEvent=(FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2,init_esbuild_inject(),class extends FederatedEvent{constructor(e,t){super(),this.type=e,this.detail=t}}),WILDCARD=(init_esbuild_inject(),init_esbuild_inject(),\\\"*\\\"),clock=(init_esbuild_inject(),\\\"object\\\"==typeof performance&&performance.now?performance:Date);function isMouseLike(e){return\\\"mouse\\\"===e||\\\"pen\\\"===e}var STATUS,Edge,EventManager=class{constructor(e,t){this.dispatch=new import_eventemitter3[\\\"default\\\"],this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(e,t)=>{var i,r;e instanceof FederatedPointerEvent?(i=this.createPointerEvent(e,e.type,t),this.dispatchEvent(i,\\\"pointerdown\\\"),\\\"touch\\\"===i.pointerType?this.dispatchEvent(i,\\\"touchstart\\\"):isMouseLike(i.pointerType)&&(r=2===i.button,this.dispatchEvent(i,r?\\\"rightdown\\\":\\\"mousedown\\\")),this.trackingData(e.pointerId).pressTargetsByButton[e.button]=i.composedPath(),this.freeEvent(i)):Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onPointerMove=(t,e)=>{if(t instanceof FederatedPointerEvent){var i=this.createPointerEvent(t,t.type,e),r=isMouseLike(i.pointerType),o=this.trackingData(t.pointerId),n=this.findMountedTarget(o.overTargets);if(o.overTargets&&n&&n!==this.rootTarget&&n!==i.target){var a=\\\"mousemove\\\"===t.type?\\\"mouseout\\\":\\\"pointerout\\\",a=this.createPointerEvent(t,a,n||void 0);if(this.dispatchEvent(a,\\\"pointerout\\\"),r&&this.dispatchEvent(a,\\\"mouseout\\\"),!i.composedPath().includes(n)){var l=this.createPointerEvent(t,\\\"pointerleave\\\",n||void 0);for(l.eventPhase=l.AT_TARGET;l.target&&!i.composedPath().includes(l.target);)l.currentTarget=l.target,this.notifyTarget(l),r&&this.notifyTarget(l,\\\"mouseleave\\\"),l.target=l.target.parent;this.freeEvent(l)}this.freeEvent(a)}if(n!==i.target){var a=\\\"mousemove\\\"===t.type?\\\"mouseover\\\":\\\"pointerover\\\",a=this.clonePointerEvent(i,a);this.dispatchEvent(a,\\\"pointerover\\\"),r&&this.dispatchEvent(a,\\\"mouseover\\\");let e=null==n?void 0:n.parent;for(;e&&e!==this.rootTarget.parent&&e!==i.target;)e=e.parent;if(!e||e===this.rootTarget.parent){var s=this.clonePointerEvent(i,\\\"pointerenter\\\");s.eventPhase=s.AT_TARGET;let e=s.target;var h=new Set;let t=n;for(;t&&t!==this.rootTarget;)h.add(t),t=t.parent;for(;e&&e!==n&&e!==this.rootTarget.parent;)h.has(e)||(s.currentTarget=e,this.notifyTarget(s),r&&this.notifyTarget(s,\\\"mouseenter\\\")),e=e.parent;this.freeEvent(s)}this.freeEvent(a)}this.dispatchEvent(i,\\\"pointermove\\\"),\\\"touch\\\"===i.pointerType&&this.dispatchEvent(i,\\\"touchmove\\\"),r&&(this.dispatchEvent(i,\\\"mousemove\\\"),this.cursorTarget=i.target,this.cursor=(null==(a=null==(a=i.target)?void 0:a.attribute)?void 0:a.cursor)||this.rootTarget.getCursor()),o.overTargets=i.composedPath(),this.freeEvent(i)}else Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onPointerOver=(e,t)=>{var i;if(e instanceof FederatedPointerEvent){var r=this.trackingData(e.pointerId),o=this.createPointerEvent(e,e.type,t),n=isMouseLike(o.pointerType),a=(this.dispatchEvent(o,\\\"pointerover\\\"),n&&this.dispatchEvent(o,\\\"mouseover\\\"),\\\"mouse\\\"===o.pointerType&&(this.cursorTarget=o.target,this.cursor=(null==(i=null==(i=o.target)?void 0:i.attribute)?void 0:i.cursor)||this.rootTarget.getCursor()),this.clonePointerEvent(o,\\\"pointerenter\\\"));for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),n&&this.notifyTarget(a,\\\"mouseenter\\\"),a.target=a.target.parent;r.overTargets=o.composedPath(),this.freeEvent(o),this.freeEvent(a)}else Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onPointerOut=(e,t)=>{if(e instanceof FederatedPointerEvent){var i=this.trackingData(e.pointerId);if(i.overTargets){var r=isMouseLike(e.pointerType),o=this.findMountedTarget(i.overTargets),n=this.createPointerEvent(e,\\\"pointerout\\\",o||void 0),a=(this.dispatchEvent(n),r&&this.dispatchEvent(n,\\\"mouseout\\\"),this.createPointerEvent(e,\\\"pointerleave\\\",o||void 0));for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),r&&this.notifyTarget(a,\\\"mouseleave\\\"),a.target=a.target.parent;i.overTargets=[],this.freeEvent(n),this.freeEvent(a)}this.cursorTarget=null,this.cursor=\\\"\\\"}else Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onPointerUp=(i,e)=>{var r;if(i instanceof FederatedPointerEvent){var o,n=clock.now(),a=this.createPointerEvent(i,i.type,e),l=(this.dispatchEvent(a,\\\"pointerup\\\"),\\\"touch\\\"===a.pointerType?this.dispatchEvent(a,\\\"touchend\\\"):isMouseLike(a.pointerType)&&(l=2===a.button,this.dispatchEvent(a,l?\\\"rightup\\\":\\\"mouseup\\\")),this.trackingData(i.pointerId)),s=this.findMountedTarget(l.pressTargetsByButton[i.button]);let t=s;if(s&&!a.composedPath().includes(s)){let e=s;for(;e&&!a.composedPath().includes(e);)a.currentTarget=e,this.notifyTarget(a,\\\"pointerupoutside\\\"),\\\"touch\\\"===a.pointerType?this.notifyTarget(a,\\\"touchendoutside\\\"):isMouseLike(a.pointerType)&&(o=2===a.button,this.notifyTarget(a,o?\\\"rightupoutside\\\":\\\"mouseupoutside\\\")),e=e.parent;delete l.pressTargetsByButton[i.button],t=e}t&&((s=this.clonePointerEvent(a,\\\"click\\\")).target=t,s.path=[],s.detailPath=[],l.clicksByButton[i.button]||(l.clicksByButton[i.button]={clickCount:0,target:s.target,timeStamp:n}),(l=l.clicksByButton[i.button]).target===s.target&&n-l.timeStamp<(null!=(r=this._config.clickInterval)?r:200)?++l.clickCount:l.clickCount=1,l.target=s.target,l.timeStamp=n,s.detail=l.clickCount,isMouseLike(s.pointerType)?(this.dispatchEvent(s,\\\"click\\\"),2===l.clickCount&&this.dispatchEvent(s,\\\"dblclick\\\")):\\\"touch\\\"===s.pointerType&&this._config.supportsTouchEvents&&(this.dispatchEvent(s,\\\"tap\\\"),2===l.clickCount)&&this.dispatchEvent(s,\\\"dbltap\\\"),this.dispatchEvent(s,\\\"pointertap\\\"),this.freeEvent(s)),this.freeEvent(a)}else Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onPointerUpOutside=(t,e)=>{if(t instanceof FederatedPointerEvent){var i=this.trackingData(t.pointerId),r=this.findMountedTarget(i.pressTargetsByButton[t.button]),o=this.createPointerEvent(t,t.type,e);if(r){let e=r;for(;e;)o.currentTarget=e,this.notifyTarget(o,\\\"pointerupoutside\\\"),\\\"touch\\\"===o.pointerType?this.notifyTarget(o,\\\"touchendoutside\\\"):isMouseLike(o.pointerType)&&this.notifyTarget(o,2===o.button?\\\"rightupoutside\\\":\\\"mouseupoutside\\\"),e=e.parent;delete i.pressTargetsByButton[t.button]}this.freeEvent(o)}else Logger.getInstance().warn(\\\"EventManager cannot map a non-pointer event as a pointer event\\\")},this.onWheel=(e,t)=>{var i;e instanceof FederatedWheelEvent?(i=this.createWheelEvent(e,t),this.dispatchEvent(i),this.freeEvent(i)):Logger.getInstance().warn(\\\"EventManager cannot map a non-wheel event as a wheel event\\\")},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},t),this.addEventMapping(\\\"pointerdown\\\",this.onPointerDown),this.addEventMapping(\\\"pointermove\\\",this.onPointerMove),this.addEventMapping(\\\"pointerout\\\",this.onPointerOut),this.addEventMapping(\\\"pointerleave\\\",this.onPointerOut),this.addEventMapping(\\\"pointerover\\\",this.onPointerOver),this.addEventMapping(\\\"pointerup\\\",this.onPointerUp),this.addEventMapping(\\\"pointerupoutside\\\",this.onPointerUpOutside),this.addEventMapping(\\\"wheel\\\",this.onWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((e,t)=>e.priority-t.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(r){var o;if(this.rootTarget){var n=this.mappingTable[r.type];let i;var a=r.canvasX+\\\"-\\\"+r.canvasY;if(null!=(o=this._prePointTargetCache)&&o[a]&&null!=(o=null==(o=this._prePointTargetCache)?void 0:o[a])&&o.stage&&(null==(o=null==(o=this._prePointTargetCache)?void 0:o[a])?void 0:o.stage.renderCount)===(null==(o=this._prePointTargetCache)?void 0:o.stageRenderCount)?i=this._prePointTargetCache[a]:(i=this.pickTarget(r.viewX,r.viewY,r),r.pickParams||(this._prePointTargetCache={[a]:i,stageRenderCount:null!=(o=null==i?void 0:i.stage.renderCount)?o:-1})),n)for(let e=0,t=n.length;e<t;e++)n[e].fn(r,i);else Logger.getInstance().warn(\\\"[EventManager]: Event mapping not defined for \\\"+r.type)}}propagate(i,r){if(i.target){var o=i.composedPath();i.eventPhase=i.CAPTURING_PHASE;for(let e=0,t=o.length-1;e<t;e++)if(i.currentTarget=o[e],this.notifyTarget(i,r),i.propagationStopped||i.propagationImmediatelyStopped)return;if(i.eventPhase=i.AT_TARGET,i.currentTarget=i.target,this.notifyTarget(i,r),!i.propagationStopped&&!i.propagationImmediatelyStopped){i.eventPhase=i.BUBBLING_PHASE;for(let e=o.length-2;0<=e;e--)if(i.currentTarget=o[e],this.notifyTarget(i,r),i.propagationStopped||i.propagationImmediatelyStopped)return}}}propagationPath(e){var t=[e];for(let i=0;i<2048&&e!==this.rootTarget&&e.parent;i++){if(!e.parent)throw new Error(\\\"Cannot find propagation path to disconnected target\\\");t.push(e.parent),e=e.parent}return t.reverse(),t}notifyTarget(e,t){var i;this.pauseNotify||(t=null!=t?t:e.type,i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?t+\\\"capture\\\":t,this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t))}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){var r,o=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(e,o),this.copyMouseData(e,o),this.copyData(e,o),o.nativeEvent=e.nativeEvent,o.originalEvent=e,o.target=i||this.pickTarget(null!=(r=o.viewX)?r:o.global.x,null!=(r=o.viewY)?r:o.global.y,o),\\\"string\\\"==typeof t&&(o.type=t),o}createWheelEvent(e,t){var i,r=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.nativeEvent=e.nativeEvent,r.originalEvent=e,r.target=t||this.pickTarget(null!=(i=r.viewX)?i:r.global.x,null!=(i=r.viewY)?i:r.global.y,r),r}clonePointerEvent(e,t){var i=this.allocateEvent(FederatedPointerEvent),r=(i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),e.composedDetailPath());return i.detailPath=r&&r.slice(),i.type=null!=t?t:i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof FederatedPointerEvent&&t instanceof FederatedPointerEvent&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(t,i){t instanceof FederatedMouseEvent&&i instanceof FederatedMouseEvent&&(i.altKey=t.altKey,i.button=t.button,i.buttons=t.buttons,i.ctrlKey=t.ctrlKey,i.shiftKey=t.shiftKey,i.metaKey=t.metaKey,[\\\"client\\\",\\\"movement\\\",\\\"canvas\\\",\\\"screen\\\",\\\"global\\\",\\\"offset\\\",\\\"viewport\\\"].forEach(e=>{i[e].x=t[e].x,i[e].y=t[e].y}))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=clock.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.x=e.layer.x,t.layer.y=e.layer.y,t.page.x=e.page.x,t.page.y=e.page.y,t.pickParams=e.pickParams}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=(null==(t=this.eventPool.get(e))?void 0:t.pop())||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.detailPath=[],t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error(\\\"It is illegal to free an event not managed by this EventManager!\\\");var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),null!=(t=this.eventPool.get(t))&&t.push(e)}notifyListeners(i,r){var o=i.currentTarget._events[r];if(o)if(\\\"fn\\\"in o)o.once&&i.currentTarget.removeEventListener(r,o.fn,{once:!0}),o.fn.call(o.context,i);else for(let e=0,t=o.length;e<t&&!i.propagationImmediatelyStopped;e++)o[e].once&&i.currentTarget.removeEventListener(r,o[e].fn,{once:!0}),o[e].fn.call(o[e].context,i);this.emitDelegation(i,r)}emitDelegation(i,r){var o=i.currentTarget._events[WILDCARD];if(o)if(\\\"fn\\\"in o)o.fn.call(o.context,i,r);else for(let e=0,t=o.length;e<t&&!i.propagationImmediatelyStopped;e++)o[e].fn.call(o[e].context,i,r)}pickTarget(e,t,i){var r=this.rootTarget.pick(e,t),o=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(e,t)?this.rootTarget:null;return i&&(i.pickParams=r.params),o}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}},EventTarget2=(init_esbuild_inject(),{dispatchEvent(e){var t;if(e instanceof FederatedEvent)return e.defaultPrevented=!1,e.path=[],e.detailPath&&(e.detailPath=[]),e.target=this,null!=(t=null==e?void 0:e.manager)&&t.dispatchEvent(e),!e.defaultPrevented;throw new Error(\\\"DisplayObject cannot propagate events outside of the Federated Events API\\\")},emit(e,t){return this.dispatchEvent(new CustomEvent(e,t))}}),TOUCH_TO_POINTER=(init_esbuild_inject(),{touchstart:\\\"pointerdown\\\",touchend:\\\"pointerup\\\",touchendoutside:\\\"pointerupoutside\\\",touchmove:\\\"pointermove\\\",touchcancel:\\\"pointercancel\\\"}),EventSystem=class{constructor(e){this.resolution=1,this.onPointerDown=i=>{if(!this.supportsTouchEvents||\\\"touch\\\"!==i.pointerType){var r=this.normalizeToPointerData(i);this.autoPreventDefault&&r[0].isNormalized&&(!i.cancelable&&\\\"cancelable\\\"in i||i.preventDefault());for(let e=0,t=r.length;e<t;e++){var o=r[e],o=this.bootstrapEvent(this.rootPointerEvent,o);this.manager.mapEvent(o)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null}},this.onPointerMove=i=>{if(!(this.supportsTouchEvents&&\\\"touch\\\"===i.pointerType||this.isEventOutsideOfTargetElement(i))){var r=this.normalizeToPointerData(i);for(let e=0,t=r.length;e<t;e++){var o=this.bootstrapEvent(this.rootPointerEvent,r[e]);this.manager.mapEvent(o)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null}},this.onPointerUp=i=>{if(!this.supportsTouchEvents||\\\"touch\\\"!==i.pointerType){var r=this.isEventOutsideOfTargetViewPort(i)?\\\"outside\\\":\\\"\\\",o=this.normalizeToPointerData(i);for(let e=0,t=o.length;e<t;e++){var n=this.bootstrapEvent(this.rootPointerEvent,o[e]);n.type+=r,this.manager.mapEvent(n)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null}},this.onPointerOverOut=i=>{if(!this.supportsTouchEvents||\\\"touch\\\"!==i.pointerType){var r=this.normalizeToPointerData(i);for(let e=0,t=r.length;e<t;e++){var o=this.bootstrapEvent(this.rootPointerEvent,r[e]);this.manager.mapEvent(o)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null}},this.onWheel=e=>{var t=this.normalizeWheelEvent(e);this.manager.mapEvent(t)};var{targetElement:t,resolution:i,rootNode:r,global:o,autoPreventDefault:n=!1,clickInterval:a,supportsTouchEvents:l=o.supportsTouchEvents,supportsPointerEvents:s=o.supportsPointerEvents}=e;this.manager=new EventManager(r,{clickInterval:a,supportsTouchEvents:l}),this.globalObj=o,this.supportsPointerEvents=s,this.supportsTouchEvents=l,this.supportsMouseEvents=o.supportsMouseEvents,this.applyStyles=o.applyStyles,this.autoPreventDefault=n,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent,this.rootWheelEvent=new FederatedWheelEvent,this.cursorStyles={\\\"default\\\":\\\"inherit\\\",pointer:\\\"pointer\\\"},this.resolution=i,this.setTargetElement(t)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(e,t){var i,r,o;(t||this.manager.rootTarget.window._handler.canvas.controled)&&(({applyStyles:i,domElement:r}=this),this.currentCursor!==(e=e||\\\"default\\\"))&&(this.currentCursor=e,(o=this.cursorStyles[e])?\\\"string\\\"==typeof o&&i?r.style.cursor=o:\\\"function\\\"==typeof o?o(e):\\\"object\\\"==typeof o&&i&&Object.assign(r.style,o):i&&isString_default(e)&&!has_default(this.cursorStyles,e)&&(r.style.cursor=e))}setTargetElement(e){this.removeEvents(),this.domElement=e,this.addEvents()}addEvents(){var e,t;!this.eventsAdded&&this.domElement&&(({globalObj:e,domElement:t}=this),this.supportsPointerEvents?((e.getDocument()?(e.getDocument().addEventListener(\\\"pointermove\\\",this.onPointerMove,!0),e.getDocument()):(t.addEventListener(\\\"pointermove\\\",this.onPointerMove,!0),t)).addEventListener(\\\"pointerup\\\",this.onPointerUp,!0),t.addEventListener(\\\"pointerdown\\\",this.onPointerDown,!0),t.addEventListener(\\\"pointerleave\\\",this.onPointerOverOut,!0),t.addEventListener(\\\"pointerover\\\",this.onPointerOverOut,!0)):((e.getDocument()?(e.getDocument().addEventListener(\\\"mousemove\\\",this.onPointerMove,!0),e.getDocument()):(t.addEventListener(\\\"mousemove\\\",this.onPointerMove,!0),t)).addEventListener(\\\"mouseup\\\",this.onPointerUp,!0),t.addEventListener(\\\"mousedown\\\",this.onPointerDown,!0),t.addEventListener(\\\"mouseout\\\",this.onPointerOverOut,!0),t.addEventListener(\\\"mouseover\\\",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(t.addEventListener(\\\"touchstart\\\",this.onPointerDown,!0),t.addEventListener(\\\"touchend\\\",this.onPointerUp,!0),t.addEventListener(\\\"touchmove\\\",this.onPointerMove,!0)),t.addEventListener(\\\"wheel\\\",this.onWheel,{capture:!0}),this.eventsAdded=!0)}removeEvents(){var e,t;this.eventsAdded&&this.domElement&&(({globalObj:e,domElement:t}=this),this.supportsPointerEvents?((e.getDocument()?(e.getDocument().removeEventListener(\\\"pointermove\\\",this.onPointerMove,!0),e.getDocument()):(t.removeEventListener(\\\"pointermove\\\",this.onPointerMove,!0),t)).removeEventListener(\\\"pointerup\\\",this.onPointerUp,!0),t.removeEventListener(\\\"pointerdown\\\",this.onPointerDown,!0),t.removeEventListener(\\\"pointerleave\\\",this.onPointerOverOut,!0),t.removeEventListener(\\\"pointerover\\\",this.onPointerOverOut,!0)):((e.getDocument()?(e.getDocument().removeEventListener(\\\"mousemove\\\",this.onPointerMove,!0),e.getDocument()):(t.removeEventListener(\\\"mousemove\\\",this.onPointerMove,!0),t)).removeEventListener(\\\"mouseup\\\",this.onPointerUp,!0),t.removeEventListener(\\\"mousedown\\\",this.onPointerDown,!0),t.removeEventListener(\\\"mouseout\\\",this.onPointerOverOut,!0),t.removeEventListener(\\\"mouseover\\\",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(t.removeEventListener(\\\"touchstart\\\",this.onPointerDown,!0),t.removeEventListener(\\\"touchend\\\",this.onPointerUp,!0),t.removeEventListener(\\\"touchmove\\\",this.onPointerMove,!0)),t.removeEventListener(\\\"wheel\\\",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1)}mapToViewportPoint(e){return this.domElement.pointTransform?this.domElement.pointTransform(e.x,e.y):e}mapToCanvasPoint(e){var t=null==(t=this.globalObj)?void 0:t.mapToCanvasPoint(e,this.domElement);if(t)return t;let i=0,r=0;r=e.changedTouches?(t=null!=(t=e.changedTouches[0])?t:{},i=t.clientX||0,t.clientY||0):(i=e.clientX||0,e.clientY||0);t=this.domElement.getBoundingClientRect();return{x:i-t.left,y:r-t.top}}normalizeToPointerData(i){var r,o=[];if(this.supportsTouchEvents&&i.changedTouches&&i.changedTouches.length)for(let e=0,t=i.changedTouches.length;e<t;e++){var n=i.changedTouches[e];isUndefined_default(n.button)&&(n.button=0),isUndefined_default(n.buttons)&&(n.buttons=1),isUndefined_default(n.isPrimary)&&(n.isPrimary=1===i.touches.length&&\\\"touchstart\\\"===i.type),isUndefined_default(n.width)&&(n.width=n.radiusX||1),isUndefined_default(n.height)&&(n.height=n.radiusY||1),isUndefined_default(n.tiltX)&&(n.tiltX=0),isUndefined_default(n.tiltY)&&(n.tiltY=0),isUndefined_default(n.pointerType)&&(n.pointerType=\\\"touch\\\"),isUndefined_default(n.pointerId)&&(n.pointerId=n.identifier||0),isUndefined_default(n.pressure)&&(n.pressure=n.force||.5),isUndefined_default(n.twist)&&(n.twist=0),isUndefined_default(n.tangentialPressure)&&(n.tangentialPressure=0),isUndefined_default(n.layerX)&&(n.layerX=n.offsetX=n.clientX),isUndefined_default(n.layerY)&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=i.type,o.push(n)}else!this.globalObj.supportsMouseEvents||i instanceof MouseEvent&&!(this.supportsPointerEvents&&i instanceof PointerEvent)?(isUndefined_default((r=i).isPrimary)&&(r.isPrimary=!0),isUndefined_default(r.width)&&(r.width=1),isUndefined_default(r.height)&&(r.height=1),isUndefined_default(r.tiltX)&&(r.tiltX=0),isUndefined_default(r.tiltY)&&(r.tiltY=0),isUndefined_default(r.pointerType)&&(r.pointerType=\\\"mouse\\\"),isUndefined_default(r.pointerId)&&(r.pointerId=1),isUndefined_default(r.pressure)&&(r.pressure=.5),isUndefined_default(r.twist)&&(r.twist=0),isUndefined_default(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,o.push(r)):o.push(i);return o}normalizeWheelEvent(e){var t=this.rootWheelEvent,{x:i,y:r}=(this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,this.mapToCanvasPoint(e)),{x:i,y:r}=(t.canvas.x=i,t.canvas.y=r,t.global.x=i,t.global.y=r,t.offset.x=i,t.offset.y=r,this.mapToViewportPoint(t));return t.viewport.x=i,t.viewport.y=r,t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var{x:i,y:r}=this.mapToCanvasPoint(t),{x:i,y:r}=(e.canvas.x=i,e.canvas.y=r,e.global.x=i,e.global.y=r,e.offset.x=i,e.offset.y=r,this.mapToViewportPoint(e));return e.viewport.x=i,e.viewport.y=r,e.isTrusted=t.isTrusted,\\\"pointerleave\\\"===e.type&&(e.type=\\\"pointerout\\\"),e.type.startsWith(\\\"mouse\\\")&&(e.type=e.type.replace(\\\"mouse\\\",\\\"pointer\\\")),e.type.startsWith(\\\"touch\\\")&&(e.type=TOUCH_TO_POINTER[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=clock.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null}isEventOutsideOfTargetViewPort(e){var t,i,r;return!!this.isEventOutsideOfTargetElement(e)||!(!this.domElement.getViewBox||(t=this.mapToViewportPoint(this.mapToCanvasPoint(e)),i=(r=this.domElement.getViewBox()).width(),r=r.height(),t.x<i&&t.y<r&&0<t.x&&0<t.y))}isEventOutsideOfTargetElement(e){let t=e.target;return(t=e.composedPath&&0<e.composedPath().length?e.composedPath()[0]:t)!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}},RAFTickHandler=(init_esbuild_inject(),init_esbuild_inject(),!function(e){e[e.INITIAL=0]=\\\"INITIAL\\\",e[e.RUNNING=1]=\\\"RUNNING\\\",e[e.PAUSE=2]=\\\"PAUSE\\\"}(STATUS=STATUS||{}),init_esbuild_inject(),class dZ{static Avaliable(){return!!application.global.getRequestAnimationFrame()}avaliable(){return dZ.Avaliable()}tick(e,t){application.global.getRequestAnimationFrame()(()=>{this.released||t(this)})}release(){this.released=!0}getTime(){return Date.now()}}),TimeOutTickHandler=(init_esbuild_inject(),class gZ{static Avaliable(){return!0}avaliable(){return gZ.Avaliable()}tick(e,t){this.timerId=setTimeout(()=>{t(this)},e)}release(){0<this.timerId&&(clearTimeout(this.timerId),this.timerId=-1)}getTime(){return Date.now()}}),DefaultTicker=class extends import_eventemitter3[\\\"default\\\"]{set mode(e){this._mode!==e&&(this._mode=e,this.setupTickHandler())}get mode(){return this._mode}constructor(e=[]){super(),this.handleTick=(e,t)=>{var{once:i=!1}=null!=t?t:{};this.ifCanStop()?this.stop():(this._handlerTick(),i||e.tick(this.interval,this.handleTick))},this._handlerTick=()=>{var e=this.tickerHandler.getTime();let t=0;0<=this.lastFrameTime&&(t=e-this.lastFrameTime),this.lastFrameTime=e,this.status===STATUS.RUNNING&&(this.tickCounts++,this.timelines.forEach(e=>{e.tick(t)}),this.emit(\\\"afterTick\\\"))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.timelines=e,this.autoStop=!0}init(){this.interval=NaN,this.status=STATUS.INITIAL,application.global.hooks.onSetEnv.tap(\\\"default-ticker\\\",()=>{this.initHandler()}),application.global.env&&this.initHandler()}addTimeline(e){this.timelines.push(e)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}initHandler(){if(!this._mode){var t=[{mode:\\\"raf\\\",cons:RAFTickHandler},{mode:\\\"timeout\\\",cons:TimeOutTickHandler}];for(let e=0;e<t.length;e++)if(t[e].cons.Avaliable()){this.mode=t[e].mode;break}}return null}setupTickHandler(){let e;switch(this._mode){case\\\"raf\\\":e=new RAFTickHandler;break;case\\\"timeout\\\":e=new TimeOutTickHandler;break;default:Logger.getInstance().warn(\\\"非法的计时器模式\\\"),e=new RAFTickHandler}return!!e.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0)}setInterval(e){this.interval=e}getInterval(){return this.interval}setFPS(e){this.setInterval(1e3/e)}getFPS(){return 1e3/this.interval}tick(e){this.tickerHandler.tick(e,e=>{this.handleTick(e,{once:!0})})}tickTo(e){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(e,e=>{this.handleTick(e,{once:!0})})}pause(){return this.status!==STATUS.INITIAL&&(this.status=STATUS.PAUSE,!0)}resume(){return this.status!==STATUS.INITIAL&&(this.status=STATUS.RUNNING,!0)}ifCanStop(){if(this.autoStop){if(!this.timelines.length)return!0;if(0===this.timelines.reduce((e,t)=>e+t.animateCount,0))return!0}return!1}start(e=!1){if(this.status===STATUS.RUNNING)return!1;if(!this.tickerHandler)return!1;if(!e){if(this.status===STATUS.PAUSE)return!1;if(!this.timelines.length)return!1;if(0===this.timelines.reduce((e,t)=>e+t.animateCount,0))return!1}return this.status=STATUS.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0}stop(){this.status=STATUS.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}trySyncTickStatus(){this.status===STATUS.RUNNING&&this._handlerTick()}},Easing=(init_esbuild_inject(),init_esbuild_inject(),class IZ{constructor(){}static linear(e){return e}static none(){return this.linear}static get(t){return t<-1?t=-1:1<t&&(t=1),function(e){return 0===t?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(e){return 1-Math.cos(e*Math.PI/2)}static sineOut(e){return Math.sin(e*Math.PI/2)}static sineInOut(e){return-(Math.cos(Math.PI*e)-1)/2}static expoIn(e){return 0===e?0:Math.pow(2,10*e-10)}static expoOut(e){return 1===e?1:1-Math.pow(2,-10*e)}static expoInOut(e){return 0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}static circIn(e){return-(Math.sqrt(1-e*e)-1)}static circOut(e){return Math.sqrt(1- --e*e)}static circInOut(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}static bounceOut(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}static bounceIn(e){return 1-IZ.bounceOut(1-e)}static bounceInOut(e){return e<.5?.5*IZ.bounceIn(2*e):.5*IZ.bounceOut(2*e-1)+.5}static getElasticIn(i,r){return function(e){var t;return 0===e||1===e?e:(t=r/pi2*Math.asin(1/i),-i*Math.pow(2,10*--e)*Math.sin((e-t)*pi2/r))}}static getElasticOut(i,r){return function(e){var t;return 0===e||1===e?e:(t=r/pi2*Math.asin(1/i),i*Math.pow(2,-10*e)*Math.sin((e-t)*pi2/r)+1)}}static getElasticInOut(i,r){return function(e){var t=r/pi2*Math.asin(1/i);return(e*=2)<1?i*Math.pow(2,10*--e)*Math.sin((e-t)*pi2/r)*-.5:i*Math.pow(2,-10*--e)*Math.sin((e-t)*pi2/r)*.5+1}}}),DefaultTimeline=(Easing.quadIn=Easing.getPowIn(2),Easing.quadOut=Easing.getPowOut(2),Easing.quadInOut=Easing.getPowInOut(2),Easing.cubicIn=Easing.getPowIn(3),Easing.cubicOut=Easing.getPowOut(3),Easing.cubicInOut=Easing.getPowInOut(3),Easing.quartIn=Easing.getPowIn(4),Easing.quartOut=Easing.getPowOut(4),Easing.quartInOut=Easing.getPowInOut(4),Easing.quintIn=Easing.getPowIn(5),Easing.quintOut=Easing.getPowOut(5),Easing.quintInOut=Easing.getPowInOut(5),Easing.backIn=Easing.getBackIn(1.7),Easing.backOut=Easing.getBackOut(1.7),Easing.backInOut=Easing.getBackInOut(1.7),Easing.elasticIn=Easing.getElasticIn(1,.3),Easing.elasticOut=Easing.getElasticOut(1,.3),Easing.elasticInOut=Easing.getElasticInOut(1,.3*1.5),init_esbuild_inject(),class{constructor(){this.id=Generator.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}addAnimate(e){this.animateTail?((this.animateTail.nextAnimate=e).prevAnimate=this.animateTail,(this.animateTail=e).nextAnimate=null):(this.animateHead=e,this.animateTail=e),this.animateCount++}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(!this.paused){let e=this.animateHead;for(this.animateCount=0;e;)e.status===AnimateStatus.END?this.removeAnimate(e):e.status===AnimateStatus.RUNNING||e.status===AnimateStatus.INITIAL?(this.animateCount++,e.advance(t)):e.status===AnimateStatus.PAUSED&&this.animateCount++,e=e.nextAnimate}}clear(){let e=this.animateHead;for(;e;)e.release(),e=e.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}removeAnimate(e,t=!0){e._onRemove&&e._onRemove.forEach(e=>e()),e===this.animateHead?(this.animateHead=e.nextAnimate,e===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):e===this.animateTail?(this.animateTail=e.prevAnimate,this.animateTail.nextAnimate=null):(e.prevAnimate.nextAnimate=e.nextAnimate,e.nextAnimate.prevAnimate=e.prevAnimate),t&&e.release()}}),defaultTimeline=new DefaultTimeline,ACustomAnimate=class{constructor(e,t,i,r,o){this.from=e,this.to=t,this.duration=i,this.easing=r,this.params=o,this.updateCount=0}bind(e,t){this.target=e,this.subAnimate=t,this.onBind()}onBind(){}onFirstRun(){}onStart(){}onEnd(){}getEndProps(){return this.to}getFromProps(){return this.from}getMergedEndProps(){var e,t=this.getEndProps();return t?this._endProps===t?this._mergedEndProps:(this._endProps=t,void(this._mergedEndProps=Object.assign({},null!=(e=this.step.prev.getLastProps())?e:{},t))):this.step.prev?this.step.prev.getLastProps():t}update(e,t,i){if(0===this.updateCount){this.onFirstRun();const r=this.step.getLastProps();Object.keys(r).forEach(e=>{this.subAnimate.animate.validAttr(e)&&(i[e]=r[e])})}this.updateCount+=1,this.onUpdate(e,t,i),e&&this.onEnd()}},CbAnimate=class extends ACustomAnimate{constructor(e){super(null,null,0,\\\"linear\\\"),this.cb=e}onUpdate(e,t,i){}onStart(){this.cb()}},Animate=class T${constructor(e=Generator.GenAutoIncrementId(),t=defaultTimeline,i){this.id=e,this.timeline=t,this.status=AnimateStatus.INITIAL,this.tailAnimate=new SubAnimate(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this),this.slience=i}setTimeline(e){e!==this.timeline&&(this.timeline.removeAnimate(this,!1),e.addAnimate(this))}getStartTime(){return this._startTime}getDuration(){return this.subAnimates.reduce((e,t)=>e+t.totalDuration,0)}after(e){var t=e.getDuration();return this._startTime=t,this}afterAll(e){let t=-1/0;return e.forEach(e=>{t=max(e.getDuration(),t)}),this._startTime=t,this}parallel(e){return this._startTime=e.getStartTime(),this}static AddInterpolate(e,t){T$.interpolateMap.set(e,t)}play(e){var t;return this.tailAnimate.play(e),this.target&&(t=this.target.stage)&&t.renderNextFrame(),1===this.subAnimates.length&&this.tailAnimate.totalDuration===e.duration&&this.trySetAttribute(e.getFromProps(),e.mode),this}trySetAttribute(e,t=T$.mode){e&&t&AnimateMode.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_PLAY})}runCb(e){const t=new CbAnimate(()=>{e(this,t.step.prev)});return this.tailAnimate.play(t),this}customInterpolate(e,t,i,r,o,n){var a=T$.interpolateMap.get(e)||T$.interpolateMap.get(\\\"\\\");return!!a&&a(e,t,i,r,o,n)}pause(){this.status===AnimateStatus.RUNNING&&(this.status=AnimateStatus.PAUSED)}resume(){this.status===AnimateStatus.PAUSED&&(this.status=AnimateStatus.RUNNING)}to(e,t,i,r){var o;return this.tailAnimate.to(e,t,i,r),this.target&&(o=this.target.stage)&&o.renderNextFrame(),this}from(e,t,i,r){var o;return this.tailAnimate.from(e,t,i,r),this.target&&(o=this.target.stage)&&o.renderNextFrame(),this}wait(e){var t;return this.tailAnimate.wait(e),this.target&&(t=this.target.stage)&&t.renderNextFrame(),this}startAt(e){var t;return this.tailAnimate.startAt(e),this.target&&(t=this.target.stage)&&t.renderNextFrame(),this}loop(e){var t;return this.tailAnimate.loop=e,this.target&&(t=this.target.stage)&&t.renderNextFrame(),this}reversed(e){var t;return this.tailAnimate.reversed=e,this.target&&(t=this.target.stage)&&t.renderNextFrame(),this}bounce(e){var t;return this.tailAnimate.bounce=e,this.target&&(t=this.target.stage)&&t.renderNextFrame(),this}subAnimate(){var e=new SubAnimate(this,this.tailAnimate);return this.tailAnimate=e,this.subAnimates.push(e),e.bind(this.target),this}getStartProps(){return this.subAnimates[0].getStartProps()}getEndProps(){return this.tailAnimate.getEndProps()}depreventAttr(e){this._preventAttrs&&this._preventAttrs[\\\"delete\\\"](e)}preventAttr(e){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(e)}preventAttrs(e){e.forEach(e=>this.preventAttr(e))}validAttr(e){return!this._preventAttrs||!this._preventAttrs.has(e)}bind(t){return this.target=t,this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.subAnimates.forEach(e=>{e.bind(t)}),this}advance(e){if(this._duringTime<this._startTime){if(this._duringTime+e*this.timeScale<this._startTime)return void(this._duringTime+=e*this.timeScale);e=this._duringTime+e*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===AnimateStatus.INITIAL&&(this.status=AnimateStatus.RUNNING,this._onStart)&&this._onStart.forEach(e=>e()),this.setPosition(Math.max(this.rawPosition,0)+e*this.timeScale)&&this.status===AnimateStatus.RUNNING&&(this.status=AnimateStatus.END,this._onEnd)&&this._onEnd.forEach(e=>e())}setPosition(t){let i,r=0;var e=this.rawPosition,o=this.subAnimates.reduce((e,t)=>e+t.totalDuration,0),n=o<=(t=t<0?0:t);if((t=n?o:t)!==e){for(let e=0;e<this.subAnimates.length&&(i=this.subAnimates[e],!(r+i.totalDuration>=t));e++)r+=i.totalDuration,i=void 0;this.rawPosition=t,i.setPosition(t-r)}return n}onStart(e){this._onStart||(this._onStart=[]),this._onStart.push(e)}onEnd(e){this._onEnd||(this._onEnd=[]),this._onEnd.push(e)}onRemove(e){this._onRemove||(this._onRemove=[]),this._onRemove.push(e)}onFrame(e){this._onFrame||(this._onFrame=[]),this._onFrame.push(e)}release(){this.status=AnimateStatus.END}stop(e){e||this.target.onStop(),\\\"start\\\"===e?this.target.onStop(this.getStartProps()):\\\"end\\\"===e?this.target.onStop(this.getEndProps()):this.target.onStop(e),this.release()}},SubAnimate=(Animate.mode=AnimateMode.NORMAL,Animate.interpolateMap=new Map,class{get totalDuration(){return this.calcAttr(),this._totalDuration+this._startAt}constructor(e,t){this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=e,this.stepHead=new Step2(0,0,t?Object.assign({},t.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}calcAttr(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}bind(e){return this.target=e,this}play(e){let t=e.duration;(null==t||t<0)&&(t=0);var i=e.easing,i=\\\"string\\\"==typeof i?Easing[i]:i,i=this._addStep(t,null,i);return i.type=AnimateStepType.customAnimate,this._appendProps(e.getEndProps(),i,!1),this._appendCustomAnimate(e,i),this}to(e,t,i,r){const o=\\\"string\\\"==typeof i?Easing[i]:i,n=this._addStep(t=null==t||t<0?0:t,null,o);return n.type=AnimateStepType.to,this._appendProps(e,n,!!r&&r.tempProps),n.propKeys||(n.propKeys=Object.keys(n.props)),r&&r.noPreventAttrs||this.target.animates.forEach(e=>{e.id!==this.animate.id&&e.preventAttrs(n.propKeys)}),this}from(e,t,i,r){this.to(e,0,i,r);const o={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach(e=>{o[e]=this.getLastPropByName(e,this.stepTail)}),this.to(o,t,i,r),this.stepTail.type=AnimateStepType.from}startAt(e){return this._startAt=e=e<0?0:e,this}getStartProps(){var e;return null==(e=this.stepHead)?void 0:e.props}getEndProps(){return this.stepTail.props}getLastStep(){return this._lastStep}wait(e){var t;return 0<e&&((t=this._addStep(+e,null)).type=AnimateStepType.wait,t.prev.customAnimate?t.props=t.prev.customAnimate.getEndProps():t.props=t.prev.props,this.target.onAddStep)&&this.target.onAddStep(t),this}_addStep(e,t,i){var r=new Step2(this.duration,e,t,i);return this.duration+=e,this.stepTail.append(r),this.stepTail=r}_appendProps(e,t,i){t.props=i?e:Object.assign({},e);let r=t.prev;const o=t.props;for(t.propKeys||(t.propKeys=Object.keys(t.props)),t.propKeys.forEach(e=>{void 0===t.props[e]&&(t.props[e]=this.target.getDefaultAttribute(e))});r.prev;)r.props&&(r.propKeys||(r.propKeys=Object.keys(r.props)),r.propKeys.forEach(e=>{void 0===o[e]&&(o[e]=r.props[e])})),t.propKeys=Object.keys(t.props),r=r.prev;const n=this.stepHead.props;t.propKeys||(t.propKeys=Object.keys(o)),t.propKeys.forEach(e=>{var t;void 0===n[e]&&(t=this.animate.getStartProps(),n[e]=t[e]=this.target.getComputedAttribute(e))}),this.target.onAddStep&&this.target.onAddStep(t)}_appendCustomAnimate(e,t){(t.customAnimate=e).step=t,e.bind(this.target,this)}setPosition(e){var t=this.duration,i=this.loop,r=this.rawPosition;let o,n,a=!1;var l=null!=(l=this._startAt)?l:0;return(e=e<0?0:e)<l?(this.rawPosition=e,!1):(e-=l,t<=0&&(a=!0,t<0)||(o=Math.floor(e/t),n=e-o*t,(a=i*t+t<=e)&&(n=t,o=i,e=n*o+t),e!==r&&((i=!this.reversed!=!(this.bounce&&o%2))&&(n=t-n),this._deltaPosition=n-this.position,this.position=n,this.rawPosition=e+l,this.updatePosition(a,i))),a)}updatePosition(r,o){if(this.stepHead){let i=this.stepHead.next;var n=this.position,a=this.duration;if(this.target&&i){let e=i.next;for(;e&&e.position<=n;)e=(i=e).next;let t=r?0===a?1:n/a:(n-i.position)/i.duration;i.easing&&(t=i.easing(t)),this.tryCallCustomAnimateLifeCycle(i,this._lastStep||(o?this.stepTail:this.stepHead),o),this.updateTarget(i,t,r),this._lastStep=i,this.animate._onFrame&&this.animate._onFrame.forEach(e=>e(i,t))}}}tryCallCustomAnimateLifeCycle(t,i,e){if(t!==i){if(e){let e=i.prev;for(;e&&e!==t;)e.customAnimate&&(e.customAnimate.onStart&&e.customAnimate.onStart(),e.customAnimate.onEnd)&&e.customAnimate.onEnd(),e=t.prev}else{let e=i.next;for(;e&&e!==t;)e.customAnimate&&(e.customAnimate.onStart&&e.customAnimate.onStart(),e.customAnimate.onEnd)&&e.customAnimate.onEnd(),e=e.next}i&&i.customAnimate&&i.customAnimate.onEnd&&i.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}}getLastPropByName(e,t){let i=t.prev;for(;i;){if(i.props&&void 0!==i.props[e])return i.props[e];if(i.customAnimate){var r=i.customAnimate.getEndProps()[e];if(void 0!==r)return r}i=i.prev}return Logger.getInstance().warn(\\\"未知错误，step中找不到属性\\\"),t.props[e]}updateTarget(e,t,i){null==e.props&&null==e.customAnimate||this.target.onStep(this,this.animate,e,t,i)}}),Step2=class{constructor(e,t,i,r){this.duration=t,this.position=e,this.props=i,this.easing=r}append(e){e.prev=this,e.next=this.next,this.next=e}getLastProps(){let e=this.prev;for(;e;){if(e.props)return e.props;if(e.customAnimate)return e.customAnimate.getMergedEndProps();e=e.prev}return null}},DefaultStateAnimateConfig=(init_esbuild_inject(),{duration:200,easing:\\\"cubicOut\\\"}),_strokeVec4=(init_esbuild_inject(),!function(e){e[e.Top=1]=\\\"Top\\\",e[e.Right=2]=\\\"Right\\\",e[e.Bottom=4]=\\\"Bottom\\\",e[e.Left=8]=\\\"Left\\\",e[e.ALL=15]=\\\"ALL\\\"}(Edge=Edge||{}),[!1,!1,!1,!1]),parseStroke=t=>{let i,r=!0;if(isBoolean_default(t,!0)){for(let e=0;e<4;e++)_strokeVec4[e]=t,r=r&&!(null!=(i=_strokeVec4[e])&&!i);r=t}else if(Array.isArray(t))for(let e=0;e<4;e++)_strokeVec4[e]=!!t[e],r=r&&!!_strokeVec4[e];else _strokeVec4[0]=!1,_strokeVec4[1]=!1,_strokeVec4[2]=!1,_strokeVec4[3]=!1;return{isFullStroke:r,stroke:_strokeVec4}},_paddingVec4=[0,0,0,0],parsePadding=e=>e?isArray_default(e)?0===e.length?0:1===e.length?e[0]:2===e.length?(_paddingVec4[0]=e[0],_paddingVec4[2]=e[0],_paddingVec4[1]=e[1],_paddingVec4[3]=e[1],_paddingVec4):e:e:0,_coords=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],indexList=[1,2,3,0,1,2,3,0];function circleBounds(e,t,i,r){for(;pi2<=e;)e-=pi2;for(;e<0;)e+=pi2;for(;t<e;)t+=pi2;_coords[0].x=i,_coords[1].y=i,_coords[2].x=-i,_coords[3].y=-i;var o=Math.ceil(e/halfPi)%4,n=Math.ceil(t/halfPi)%4;if(r.add(cos(e)*i,sin(e)*i),r.add(cos(t)*i,sin(t)*i),o!=n||pi<t-e){let e=!1;for(let t=0;t<indexList.length;t++)if(e||o!==indexList[t]){if(e&&n===indexList[t])break;e&&(a=_coords[indexList[t]],r.add(a.x,a.y))}else{e=!0;var a=_coords[o];r.add(a.x,a.y)}}}function pointInterpolation(e,t,i){var{x:r,y:o}=pointAt(e.x,e.y,t.x,t.y,i),{x:n,y:a}=pointAt(e.x1,e.y1,t.x1,t.y1,i),r=new Point(r,o,n,a);return r.defined=t.defined,r}function pointsInterpolation(t,i,r){if(!t||!i)return[];Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);let o=[];if(t.length>i.length){o=i.map(e=>{var t=new Point(e.x,e.y,e.x1,e.y1);return t.defined=e.defined,t});for(let e=0;e<i.length;e++)o[e]=pointInterpolation(t[e],i[e],r)}else{o=i.map(e=>{var t=new Point(e.x,e.y,e.x1,e.y1);return t.defined=e.defined,t});for(let e=0;e<t.length;e++)o[e]=pointInterpolation(t[e],i[e],r)}return o}function getAttributeFromDefaultAttrList(i,r){if(isArray_default(i)){let e;for(let t=0;t<i.length&&void 0===e;t++)e=i[t][r];return e}return i[r]}var ColorType,RafBasedSTO=class sba{constructor(e=sba.TimeOut){this.durations=[],this.timeout=e,this.lastDate=0,this.durationsListThreshold=30}call(e){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),e(0)},this.timeout,!0)}clear(e){clearTimeout(e)}appendDuration(e){this.durations.push(e),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((e,t)=>e+t,0)/this.durations.length,1e3/60),1e3/30)}},rafBasedSto=(RafBasedSTO.TimeOut=1e3/60,new RafBasedSTO),_calculateLineHeight=(e,t)=>isString_default(e)&&\\\"%\\\"===e[e.length-1]?t*(Number.parseFloat(e.substring(0,e.length-1))/100):e,calculateLineHeight=(e,t)=>{var i=_calculateLineHeight(e,t);return isNaN(i)?i:Math.max(t,i)},normalizeRectAttributes=(init_esbuild_inject(),e=>{if(!e)return{x:0,y:0,width:0,height:0};let t=isNil_default(e.width)?e.x1-e.x:e.width,i=isNil_default(e.height)?e.y1-e.y:e.height,r=0,o=0;return t<0?t=-(r=t):Number.isNaN(t)&&(t=0),i<0?i=-(o=i):Number.isNaN(i)&&(i=0),{x:r,y:o,width:t,height:i}}),ColorStore=(init_esbuild_inject(),init_esbuild_inject(),!function(e){e[e.Color255=0]=\\\"Color255\\\",e[e.Color1=1]=\\\"Color1\\\"}(ColorType=ColorType||{}),class Kba{static Get(e,t=ColorType.Color1,i=[0,0,0,1]){var r,o;return t===ColorType.Color1?(r=Kba.store1[e])?(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3]):(r=Color.parseColorString(e))&&(o=[r.r/255,r.g/255,r.b/255,r.opacity],Kba.store1[e]=o,Kba.store255[e]=[r.r,r.g,r.b,r.opacity],i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3]):(r=Kba.store255[e])?(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3]):(o=Color.parseColorString(e))&&(Kba.store1[e]=[o.r/255,o.g/255,o.b/255,o.opacity],Kba.store255[e]=[o.r,o.g,o.b,o.opacity],i[0]=o.r,i[1]=o.g,i[2]=o.b,i[3]=o.opacity),i}static Set(e,t,i){t===ColorType.Color1?Kba.store1[e]||(Kba.store1[e]=i,Kba.store255[e]=[Math.floor(255*i[0]),Math.floor(255*i[1]),Math.floor(255*i[2]),Math.floor(255*i[3])]):Kba.store255[e]||(Kba.store255[e]=i,Kba.store1[e]=[i[0]/255,i[1]/255,i[2]/255,i[3]])}});function colorArrayToString(e,t=!1){return Array.isArray(e)&&isNumber_default(e[0])?t?`rgb(${Math.round(e[0])},${Math.round(e[1])},${Math.round(e[2])},${e[3].toFixed(2)})`:`rgb(${Math.round(e[0])},${Math.round(e[1])},${Math.round(e[2])})`:e}function interpolateColor(i,r,o,n,e){return Array.isArray(i)&&!isNumber_default(i[0])||Array.isArray(r)&&!isNumber_default(r[0])?new Array(4).fill(0).map((e,t)=>_interpolateColor(isArray_default(i)?i[t]:i,isArray_default(r)?r[t]:r,o,n)):_interpolateColor(i,r,o,n,e)}function _interpolateColor(e,t,i,r,o){if(!e||!t)return e&&colorArrayToString(e)||t&&colorArrayToString(t)||!1;let n,a,l=!1,s=!1;if(Array.isArray(e)?n=e:\\\"string\\\"==typeof e?n=ColorStore.Get(e,ColorType.Color255):l=!0,Array.isArray(t)?a=t:\\\"string\\\"==typeof t?a=ColorStore.Get(t,ColorType.Color255):s=!0,l!==s){const g=l?e:t,p=l?t:e,f=Object.assign(Object.assign({},g),{stops:g.stops.map(e=>Object.assign(Object.assign({},e),{color:colorArrayToString(p)}))});return l?interpolateColor(g,f,i,r,o):interpolateColor(f,g,i,r,o)}if(l){if(e.gradient===t.gradient){var h=e,d=t,u=h.stops,c=d.stops;if(u.length!==c.length)return!1;if(\\\"linear\\\"===h.gradient)return interpolateGradientLinearColor(h,d,i);if(\\\"radial\\\"===h.gradient)return interpolateGradientRadialColor(h,d,i);if(\\\"conical\\\"===h.gradient)return interpolateGradientConicalColor(h,d,i)}return!1}return o&&o(n,a),colorArrayToString(interpolatePureColorArray(n,a,i),r)}function interpolateGradientLinearColor(e,t,i){const r=e.stops,o=t.stops;return{gradient:\\\"linear\\\",x0:e.x0+(t.x0-e.x0)*i,x1:e.x1+(t.x1-e.x1)*i,y0:e.y0+(t.y0-e.y0)*i,y1:e.y1+(t.y1-e.y1)*i,stops:new Array(r.length).fill(0).map((e,t)=>({color:colorStringInterpolationToStr(r[t].color,o[t].color,i),offset:r[t].offset+(o[t].offset-r[t].offset)*i}))}}function interpolateGradientRadialColor(e,t,i){const r=e.stops,o=t.stops;return{gradient:\\\"radial\\\",x0:e.x0+(t.x0-e.x0)*i,x1:e.x1+(t.x1-e.x1)*i,y0:e.y0+(t.y0-e.y0)*i,y1:e.y1+(t.y1-e.y1)*i,r0:e.r0+(t.r0-e.r0)*i,r1:e.r1+(t.r1-e.r1)*i,stops:new Array(r.length).fill(0).map((e,t)=>({color:colorStringInterpolationToStr(r[t].color,o[t].color,i),offset:r[t].offset+(o[t].offset-r[t].offset)*i}))}}function interpolateGradientConicalColor(e,t,i){const r=e.stops,o=t.stops;return{gradient:\\\"conical\\\",startAngle:e.startAngle+(t.startAngle-e.startAngle)*i,endAngle:e.endAngle+(t.endAngle-e.endAngle)*i,x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i,stops:new Array(r.length).fill(0).map((e,t)=>({color:colorStringInterpolationToStr(r[t].color,o[t].color,i),offset:r[t].offset+(o[t].offset-r[t].offset)*i}))}}function interpolatePureColorArray(e,t,i){return[e[0]+(t[0]-e[0])*i,e[1]+(t[1]-e[1])*i,e[2]+(t[2]-e[2])*i,e[3]+(t[3]-e[3])*i]}ColorStore.store255={},ColorStore.store1={};var _fromColorRGB=[0,0,0,0],_toColorRGB=[0,0,0,0];function colorStringInterpolationToStr(e,t,i){return ColorStore.Get(e,ColorType.Color255,_fromColorRGB),ColorStore.Get(t,ColorType.Color255,_toColorRGB),`rgba(${Math.round(_fromColorRGB[0]+(_toColorRGB[0]-_fromColorRGB[0])*i)},${Math.round(_fromColorRGB[1]+(_toColorRGB[1]-_fromColorRGB[1])*i)},${Math.round(_fromColorRGB[2]+(_toColorRGB[2]-_fromColorRGB[2])*i)},${_fromColorRGB[3]+(_toColorRGB[3]-_fromColorRGB[3])*i})`}init_esbuild_inject();var ResourceLoader=class V1a{static GetImage(e,t){var i,r=V1a.cache.get(e);r?\\\"fail\\\"===r.loadState?application.global.getRequestAnimationFrame()(()=>{t.imageLoadFail(e)}):\\\"init\\\"===r.loadState||\\\"loading\\\"===r.loadState?null!=(i=r.waitingMark)&&i.push(t):t&&t.imageLoadSuccess(e,r.data):V1a.loadImage(e,t)}static GetSvg(r,e){let t,o=V1a.cache.get(r);o?\\\"fail\\\"===o.loadState?application.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(r)}):\\\"init\\\"===o.loadState||\\\"loading\\\"===o.loadState?null!=(t=o.waitingMark)&&t.push(e):e&&e.imageLoadSuccess(r,o.data):(o={type:\\\"image\\\",loadState:\\\"init\\\"},V1a.cache.set(r,o),o.dataPromise=application.global.loadSvg(r),o.dataPromise?(o.waitingMark=[e],o.dataPromise.then(i=>{var e;o.loadState=null!=i&&i.data?\\\"success\\\":\\\"fail\\\",o.data=null==i?void 0:i.data,null!=(e=o.waitingMark)&&e.map((e,t)=>{null!=i&&i.data?(o.loadState=\\\"success\\\",o.data=i.data,e.imageLoadSuccess(r,i.data)):(o.loadState=\\\"fail\\\",e.imageLoadFail(r))}),o.waitingMark&&(o.waitingMark=[])})):(o.loadState=\\\"fail\\\",e.imageLoadFail(r)))}static GetFile(e,t){let i=V1a.cache.get(e);return i?\\\"fail\\\"===i.loadState?Promise.reject():\\\"init\\\"===i.loadState||\\\"loading\\\"===i.loadState?i.dataPromise.then(e=>e.data):Promise.resolve(i.data):(i={type:t,loadState:\\\"init\\\"},V1a.cache.set(e,i),\\\"arrayBuffer\\\"===t?i.dataPromise=application.global.loadArrayBuffer(e):\\\"blob\\\"===t?i.dataPromise=application.global.loadBlob(e):\\\"json\\\"===t&&(i.dataPromise=application.global.loadJson(e)),i.dataPromise.then(e=>e.data))}static loading(){setTimeout(()=>{if(!V1a.isLoading&&V1a.toLoadAueue.length){V1a.isLoading=!0;const e=V1a.toLoadAueue.splice(0,10),n=[];e.forEach(e=>{let{url:r,marks:t}=e,o={type:\\\"image\\\",loadState:\\\"init\\\"};var i;V1a.cache.set(r,o),o.dataPromise=application.global.loadImage(r),o.dataPromise?(o.waitingMark=t,i=o.dataPromise.then(i=>{var e;o.loadState=null!=i&&i.data?\\\"success\\\":\\\"fail\\\",o.data=null==i?void 0:i.data,null!=(e=o.waitingMark)&&e.map((e,t)=>{null!=i&&i.data?(o.loadState=\\\"success\\\",o.data=i.data,e.imageLoadSuccess(r,i.data)):(o.loadState=\\\"fail\\\",e.imageLoadFail(r))}),o.waitingMark&&(o.waitingMark=[])}),n.push(i)):(o.loadState=\\\"fail\\\",t.forEach(e=>e.imageLoadFail(r)))}),Promise.all(n).then(()=>{V1a.isLoading=!1,this.onLoadSuccessCb.forEach(e=>e()),V1a.loading()})[\\\"catch\\\"](e=>{console.error(e),V1a.isLoading=!1,this.onLoadSuccessCb.forEach(e=>e()),V1a.loading()})}},0)}static loadImage(e,t){var i=getIndex(e,V1a.toLoadAueue);-1!==i?V1a.toLoadAueue[i].marks.push(t):V1a.toLoadAueue.push({url:e,marks:[t]}),V1a.loading()}static improveImageLoading(e){var t=getIndex(e,V1a.toLoadAueue);-1!==t&&(t=V1a.toLoadAueue.splice(t,1),V1a.toLoadAueue.unshift(t[0]))}static onLoadSuccess(e){this.onLoadSuccessCb.push(e)}};function getIndex(e,t){for(let i=0;i<t.length;i++)if(t[i].url===e)return i;return-1}ResourceLoader.cache=new Map,ResourceLoader.isLoading=!1,ResourceLoader.toLoadAueue=[],ResourceLoader.onLoadSuccessCb=[];var tempMatrix=new Matrix,tempBounds=new AABBBounds,GRAPHIC_UPDATE_TAG_KEY=[\\\"lineWidth\\\",\\\"scaleX\\\",\\\"scaleY\\\",\\\"angle\\\",\\\"anchor\\\",\\\"visible\\\"],tempConstantXYKey=[\\\"x\\\",\\\"y\\\"],tempConstantScaleXYKey=[\\\"scaleX\\\",\\\"scaleY\\\"],tempConstantAngleKey=[\\\"angle\\\"],point4=new Point,NOWORK_ANIMATE_ATTR={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1},Graphic=class Kca extends Node{static mixin(e){var t=Object.keys(e);for(let r=0;r<t.length;++r){var i=t[r];Object.defineProperty(Kca.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get AABBBounds(){return this.tryUpdateAABBBounds(\\\"imprecise\\\"===this.attribute.boundsMode)}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(e={}){var t;super(),this._AABBBounds=new AABBBounds,this._updateTag=UpdateTag.INIT,this.attribute=e,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,e.background?this.loadImage(null!=(t=e.background.background)?t:e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic)}setMode(e){\\\"3d\\\"===e?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(e,t=!1){var i,r,{dx:o=e.dx,dy:n=e.dy}=this.attribute;return t&&this.parent?(r=this.parent.attribute,point4.x=o+(null!=(i=r.scrollX)?i:0),point4.y=n+(null!=(i=r.scrollY)?i:0)):(point4.x=o,point4.y=n),point4}onAnimateBind(e){this._emitCustomEvent(\\\"animate-bind\\\",e)}tryUpdateAABBBounds(e){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;application.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var t=this.doUpdateAABBBounds(e);return application.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),t}tryUpdateOBBBounds(){return this._OBBBounds||(this._OBBBounds=new OBBBounds),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}combindShadowAABBBounds(e){var t;this.shadowRoot&&(t=this.shadowRoot.AABBBounds.clone(),e.union(t))}doUpdateOBBBounds(){return this._OBBBounds}doUpdateAABBBounds(e){this.updateAABBBoundsStamp++;var t=this.getGraphicTheme(),i=(this._AABBBounds.clear(),this.attribute),r=this.updateAABBBounds(i,t,this._AABBBounds,e),{boundsPadding:i=t.boundsPadding}=i,t=parsePadding(i);return t&&r.expand(t),this.clearUpdateBoundTag(),r}updatePathProxyAABBBounds(e){var t,i=\\\"function\\\"==typeof this.pathProxy?this.pathProxy(this.attribute):this.pathProxy;return!!i&&(t=new BoundsContext(e),renderCommandList(i.commandList,t,0,0),!0)}tryUpdateGlobalAABBBounds(){var e=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(e.x1,e.y1,e.x2,e.y2):this._globalAABBBounds=e.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(e=0){var t;return this._globalTransMatrix?this.parent&&(t=this.parent.globalTransMatrix,this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)):this._globalTransMatrix=(this.parent?this.parent.globalTransMatrix:this.transMatrix).clone(),this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(e=!0){return this._transMatrix||(this._transMatrix=new Matrix),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),e)&&this.clearUpdateLocalPositionTag(),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&application.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)&&application.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&UpdateTag.UPDATE_LOCAL_MATRIX)}isValid(){var e,t=this.attribute;return Number.isFinite((null!=(e=t.x)?e:0)+(null!=(e=t.y)?e:0))}_validNumber(e){return null==e||Number.isFinite(e)}shouldUpdateShape(){return!!(this._updateTag&UpdateTag.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=UpdateTag.CLEAR_SHAPE}containsPoint(e,t,i,r){var o;return!!r&&(i===IContainPointMode.GLOBAL&&(o=new Point(e,t),this.parent&&this.parent.globalTransMatrix.transformPoint(o,o),e=o.x,t=o.y),r.containsPoint(this,{x:e,y:t}))}setAttributes(e,t=!1,i){(e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,i)||e).background?this.loadImage(e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic),this._setAttributes(e,t,i)}_setAttributes(e,t=!1,i){var r=Object.keys(e);for(let n=0;n<r.length;n++){var o=r[n];this.attribute[o]=e[o]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!t&&!this.needUpdateTags(r)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)}setAttribute(e,t,i,r){var o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[e]:t},this.attribute,e,r);o?this._setAttributes(o,i,r):isNil_default(null==(o=this.normalAttrs)?void 0:o[e])?(this.attribute[e]=t,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(e)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r)):this.normalAttrs[e]=t,\\\"background\\\"===e?this.loadImage(t,!0):\\\"shadowGraphic\\\"===e&&this.setShadowGraphic(t)}needUpdateTags(e,t=GRAPHIC_UPDATE_TAG_KEY){for(let r=0;r<t.length;r++){var i=t[r];if(-1!==e.indexOf(i))return!0}return!1}needUpdateTag(e,t=GRAPHIC_UPDATE_TAG_KEY){for(let i=0;i<t.length;i++)if(e===t[i])return!0;return!1}initAttributes(e){var t={type:AttributeUpdateType.INIT};e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,t)||e,(this.attribute=e).background?this.loadImage(e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic),this._updateTag=UpdateTag.INIT,this.valid=this.isValid(),this.onAttributeUpdate(t)}translate(e,t){var i,r,o;return 0===e&&0===t||(i={type:AttributeUpdateType.TRANSLATE},(r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:e,y:t},this.attribute,tempConstantXYKey,i))&&(e=r.x,t=r.y,delete r.x,delete r.y,this._setAttributes(r)),(o=(r=this.attribute).postMatrix)?application.transformUtil.fromMatrix(o,o).translate(e,t):(r.x=(null!=(o=r.x)?o:DefaultTransform.x)+e,r.y=(null!=(o=r.y)?o:DefaultTransform.y)+t),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i)),this}translateTo(e,t){var i,r,o=this.attribute;return o.x===e&&o.y===t||(i={type:AttributeUpdateType.TRANSLATE_TO},(r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:e,y:t},this.attribute,tempConstantXYKey,i))?this._setAttributes(r,!1,i):(o.x=e,o.y=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i))),this}scale(t,i,r){var e;if(1!==t||1!==i){var o={type:AttributeUpdateType.SCALE},n=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:i,scaleCenter:r},this.attribute,tempConstantScaleXYKey,o),n=(n&&(t=n.scaleX,i=n.scaleY,delete n.scaleX,delete n.scaleY,this._setAttributes(n)),this.attribute);if(r){let e=this.attribute.postMatrix;e||(e=new Matrix,n.postMatrix=e),application.transformUtil.fromMatrix(e,e).scale(t,i,r)}else n.scaleX=(null!=(e=n.scaleX)?e:DefaultTransform.scaleX)*t,n.scaleY=(null!=(e=n.scaleY)?e:DefaultTransform.scaleY)*i;this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o)}return this}scaleTo(e,t){var i,r,o=this.attribute;return o.scaleX===e&&o.scaleY===t||(i={type:AttributeUpdateType.SCALE_TO},(r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:e,scaleY:t},this.attribute,tempConstantScaleXYKey,i))?this._setAttributes(r,!1,i):(o.scaleX=e,o.scaleY=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(i))),this}rotate(t,i){if(0!==t){var e={type:AttributeUpdateType.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:i},this.attribute,tempConstantAngleKey,e),r=(r&&(delete r.angle,this._setAttributes(r,!1,e)),this.attribute);if(i){let e=this.attribute.postMatrix;e||(e=new Matrix,r.postMatrix=e),application.transformUtil.fromMatrix(e,e).rotate(t,i)}else r.angle=(null!=(r=r.angle)?r:DefaultTransform.angle)+t;this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(e)}return this}rotateTo(e){var t,i,r=this.attribute;return r.angle!==e&&(t={type:AttributeUpdateType.ROTATE_TO},(i=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,tempConstantAngleKey,t))?this._setAttributes(i,!1,t):(r.angle=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(t))),this}skewTo(e,t){return this}animate(e){this.animates||(this.animates=new Map);const t=new Animate(null==e?void 0:e.id,this.stage&&this.stage.getTimeline(),null==e?void 0:e.slience);var i,r,o,n;return t.bind(this),e&&(({onStart:i,onFrame:r,onEnd:o,onRemove:n}=e),null!=i&&t.onStart(i),null!=r&&t.onFrame(r),null!=o&&t.onEnd(o),null!=n&&t.onRemove(n),t.interpolateFunc=e.interpolate),this.animates.set(t.id,t),t.onRemove(()=>{this.animates[\\\"delete\\\"](t.id)}),t}onAttributeUpdate(e){e&&e.skipUpdateCallback||(application.graphicService.onAttributeUpdate(this),this._emitCustomEvent(\\\"afterAttributeUpdate\\\",e))}update(e){e?(e.bounds&&this.tryUpdateAABBBounds(\\\"imprecise\\\"===this.attribute.boundsMode),e.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(\\\"imprecise\\\"===this.attribute.boundsMode),this.tryUpdateLocalTransMatrix())}hasState(e){return!(!this.currentStates||!this.currentStates.length)&&(!!isNil_default(e)||this.currentStates.includes(e))}getState(e){var t;return null==(t=this.states)?void 0:t[e]}applyStateAttrs(i,e,t,r){var o;if(t){const a=Object.keys(i),l=this.getNoWorkAnimateAttr(),s={};let t;a.forEach(e=>{l[e]?(t=t||{})[e]=i[e]:s[e]=r&&void 0===i[e]?this.getDefaultAttribute(e):i[e]});var n=this.animate({slience:!0});n.stateNames=e,n.to(s,null!=(o=null==(o=this.stateAnimateConfig)?void 0:o.duration)?o:DefaultStateAnimateConfig.duration,null!=(o=null==(o=this.stateAnimateConfig)?void 0:o.easing)?o:DefaultStateAnimateConfig.easing),t&&this.setAttributes(t,!1,{type:AttributeUpdateType.STATE})}else this.stopStateAnimates(),this.setAttributes(i,!1,{type:AttributeUpdateType.STATE})}updateNormalAttrs(t){const i={};this.normalAttrs?(Object.keys(t).forEach(e=>{e in this.normalAttrs?(i[e]=this.normalAttrs[e],delete this.normalAttrs[e]):i[e]=this.getNormalAttribute(e)}),Object.keys(this.normalAttrs).forEach(e=>{t[e]=this.normalAttrs[e]})):Object.keys(t).forEach(e=>{i[e]=this.getNormalAttribute(e)}),this.normalAttrs=i}stopStateAnimates(t=\\\"end\\\"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates[\\\"delete\\\"](e.id))})}getNormalAttribute(i){let r=this.attribute[i];return this.animates&&this.animates.forEach(e=>{var t;e.stateNames&&(t=e.getEndProps(),has_default(t,i))&&(r=t[i])}),r}clearStates(e){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,e,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){var i;0<=(this.currentStates?this.currentStates.indexOf(t):-1)&&(i=this.currentStates.filter(e=>e!==t),this.useStates(i,e))}toggleState(e,t){var i;this.hasState(e)?this.removeState(e,t):(this.currentStates?this.currentStates.indexOf(e):-1)<0&&((i=this.currentStates?this.currentStates.slice():[]).push(e),this.useStates(i,t))}addState(e,t,i){var r;this.currentStates&&this.currentStates.includes(e)&&(t||1===this.currentStates.length)||(r=t&&null!=(r=this.currentStates)&&r.length?this.currentStates.concat([e]):[e],this.useStates(r,i))}useStates(i,e){var t;if(i.length){if((null==(t=this.currentStates)?void 0:t.length)!==i.length||i.some((e,t)=>this.currentStates[t]!==e)){const r={};i.forEach(e=>{var t=this.stateProxy?this.stateProxy(e,i):null==(t=this.states)?void 0:t[e];t&&Object.assign(r,t)}),this.updateNormalAttrs(r),this.currentStates=i,this.applyStateAttrs(r,i,e)}}else this.clearStates(e)}addUpdateBoundTag(){this._updateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=UpdateTag.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=UpdateTag.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&UpdateTag.UPDATE_SHAPE_AND_BOUNDS)===UpdateTag.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=UpdateTag.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=UpdateTag.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=UpdateTag.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=UpdateTag.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=UpdateTag.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=UpdateTag.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=UpdateTag.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&UpdateTag.UPDATE_LAYOUT)}getAnchor(e,r){var t,i,o=[0,0],n=()=>{var e,t,i;return r.b||(({scaleX:e,scaleY:t,angle:i}=this.attribute),tempBounds.copy(this._AABBBounds),this.setAttributes({scaleX:1,scaleY:1,angle:0}),r.b=this.AABBBounds.clone(),this._AABBBounds.copy(tempBounds),this.setAttributes({scaleX:e,scaleY:t,angle:i})),r.b};return\\\"string\\\"==typeof e[0]?(i=parseFloat(e[0])/100,t=n(),o[0]=t.x1+(t.x2-t.x1)*i):o[0]=e[0],\\\"string\\\"==typeof e[1]?(t=parseFloat(e[1])/100,i=n(),o[1]=i.y1+(i.y2-i.y1)*t):o[1]=e[1],o}doUpdateLocalMatrix(){var{x:e=DefaultTransform.x,y:t=DefaultTransform.y,scaleX:i=DefaultTransform.scaleX,scaleY:r=DefaultTransform.scaleY,angle:o=DefaultTransform.angle,scaleCenter:n,anchor:a,postMatrix:l}=this.attribute;let s=[0,0];var h={},o=(a&&(s=this.getAnchor(a,h)),!n||1===i&&1===r?normalTransform(this._transMatrix,this._transMatrix.reset(),e,t,i,r,o,a&&s):((a=this._transMatrix).reset(),a.translate(s[0],s[1]),a.rotate(o),a.translate(-s[0],-s[1]),a.translate(e,t),s=this.getAnchor(n,h),application.transformUtil.fromMatrix(a,a).scale(i,r,{x:s[0],y:s[1]})),this.getOffsetXY(DefaultTransform));this._transMatrix.e+=o.x,this._transMatrix.f+=o.y,l&&(e=tempMatrix.setValue(l.a,l.b,l.c,l.d,l.e,l.f),t=this._transMatrix,e.multiply(t.a,t.b,t.c,t.d,t.e,t.f),t.setValue(e.a,e.b,e.c,e.d,e.e,e.f))}doUpdateGlobalMatrix(){var e,t;this.parent&&(this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f),({scrollX:e=0,scrollY:t=0}=this.parent.attribute),this._globalTransMatrix.translate(e,t))}setStage(e,t){if(this.stage!==e){if(this.stage=e,this.layer=t,this.setStageToShadowRoot(e,t),this.animates&&this.animates.size){const i=e.getTimeline();this.animates.forEach(e=>{e.setTimeline(i)})}this._onSetStage&&this._onSetStage(this,e,t),application.graphicService.onSetStage(this,e)}}setStageToShadowRoot(e,t){this.shadowRoot&&this.shadowRoot.setStage(e,t)}onAddStep(e){}onStop(e){e&&this.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_END})}onStep(e,t,i,r,o){var n,a={};i.customAnimate?i.customAnimate.update(o,r,a):(n=i.props,this.stepInterpolate(e,t,a,i,r,o,n,void 0,i.parsedProps,i.propKeys)),this.setAttributes(a,!1,{type:AttributeUpdateType.ANIMATE_UPDATE,animationState:{ratio:r,end:o,step:i,isFirstFrameOfStep:e.getLastStep()!==i}}),this.stage&&this.stage.renderNextFrame()}stepInterpolate(r,o,n,a,l,e,s,h,d,t){t||(t=Object.keys(s),a.propKeys=t),e?a.propKeys.forEach(e=>{o.validAttr(e)&&(n[e]=s[e])}):t.forEach(e=>{var t,i;o.validAttr(e)&&(t=s[e],i=null!=(i=h&&h[e])?i:r.getLastPropByName(e,a),null==t||null==i||t===i?n[e]=t:o.interpolateFunc&&o.interpolateFunc(e,l,i,t,n)||o.customInterpolate(e,l,i,t,this,n)||this.defaultInterpolate(t,i,e,n,d,l)||this._interpolate(e,l,i,t,n))}),a.parsedProps=d}defaultInterpolate(e,t,i,r,o,n){var a;return Number.isFinite(e)?(r[i]=t+(e-t)*n,!0):\\\"fill\\\"===i?((a=interpolateColor(t,null!=(a=(o=o||{}).fillColorArray)?a:e,n,!1,(e,t)=>{o.fillColorArray=t}))&&(r[i]=a),!0):\\\"stroke\\\"===i?((a=interpolateColor(t,null!=(a=(o=o||{}).strokeColorArray)?a:e,n,!1,(e,t)=>{o.strokeColorArray=t}))&&(r[i]=a),!0):\\\"shadowColor\\\"===i&&((a=interpolateColor(t,null!=(a=(o=o||{}).shadowColorArray)?a:e,n,!0,(e,t)=>{o.shadowColorArray=t}))&&(r[i]=a),!0)}_interpolate(e,t,i,r,o){}getDefaultAttribute(e){return this.getGraphicTheme()[e]}getComputedAttribute(e){var t;return null!=(t=this.attribute[e])?t:this.getDefaultAttribute(e)}onSetStage(e,t=!1){this._onSetStage=e,t&&this.stage&&e(this,this.stage)}attachShadow(e){return e&&(e.shadowHost=this),this.shadowRoot=null!=e?e:application.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(e=>e.toJson())}}createPathProxy(e){return isString_default(e,!0)?this.pathProxy=(new CustomPath2D).fromString(e):this.pathProxy=new CustomPath2D,this.pathProxy}loadImage(e,t=!1){var i;!e||t&&backgroundNotImage(e)||(i=e,this.resources||(this.resources=new Map),this.resources.set(i,i={data:\\\"init\\\",state:null}),\\\"string\\\"==typeof e?(i.state=\\\"loading\\\",e.startsWith(\\\"<svg\\\")?(ResourceLoader.GetSvg(e,this),this.backgroundImg=this.backgroundImg||t):(isValidUrl_default(e)||e.includes(\\\"/\\\")||isBase64_default(e))&&(ResourceLoader.GetImage(e,this),this.backgroundImg=this.backgroundImg||t)):isObject_default(e)?(i.state=\\\"success\\\",i.data=e,this.backgroundImg=this.backgroundImg||t):i.state=\\\"fail\\\")}setShadowGraphic(e){e?this.attachShadow().add(e):this.detachShadow()}imageLoadSuccess(e,t,i){var r;this.resources&&(r=this.resources.get(e))&&(r.state=\\\"success\\\",r.data=t,i&&i(),this.addUpdateBoundTag(),this.stage)&&this.stage.renderNextFrame()}imageLoadFail(e,t){var i;this.resources&&(i=this.resources.get(e))&&(i.state=\\\"fail\\\",t)&&t()}_stopAnimates(e){e&&e.forEach(e=>{e.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus=\\\"released\\\",application.graphicService.onRelease(this)}_emitCustomEvent(e,t){var i,r;this._events&&e in this._events&&((r=new CustomEvent(e,t)).bubbles=!1,r.manager=null==(i=null==(i=this.stage)?void 0:i.eventSystem)?void 0:i.manager,this.dispatchEvent(r))}};function backgroundNotImage(e){return!(!e.fill&&!e.stroke)}Graphic.mixin(EventTarget2),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var nameStartChar=\\\":A-Za-z_\\\\\\\\u00C0-\\\\\\\\u00D6\\\\\\\\u00D8-\\\\\\\\u00F6\\\\\\\\u00F8-\\\\\\\\u02FF\\\\\\\\u0370-\\\\\\\\u037D\\\\\\\\u037F-\\\\\\\\u1FFF\\\\\\\\u200C-\\\\\\\\u200D\\\\\\\\u2070-\\\\\\\\u218F\\\\\\\\u2C00-\\\\\\\\u2FEF\\\\\\\\u3001-\\\\\\\\uD7FF\\\\\\\\uF900-\\\\\\\\uFDCF\\\\\\\\uFDF0-\\\\\\\\uFFFD\\\",nameChar=nameStartChar+\\\"\\\\\\\\-.\\\\\\\\d\\\\\\\\u00B7\\\\\\\\u0300-\\\\\\\\u036F\\\\\\\\u203F-\\\\\\\\u2040\\\";function getAllMatches(t,i){var r=[];let o=i.exec(t);for(;o;){var n=[],a=(n.startIndex=i.lastIndex-o[0].length,o.length);for(let e=0;e<a;e++)n.push(o[e]);r.push(n),o=i.exec(t)}return r}var XmlNode=class{constructor(e){this.tagname=e,this.child=[],this[\\\":@\\\"]={}}add(e,t){this.child.push({[e=\\\"__proto__\\\"===e?\\\"#__proto__\\\":e]:t})}addChild(e){\\\"__proto__\\\"===e.tagname&&(e.tagname=\\\"#__proto__\\\"),e[\\\":@\\\"]&&0<Object.keys(e[\\\":@\\\"]).length?this.child.push({[e.tagname]:e.child,\\\":@\\\":e[\\\":@\\\"]}):this.child.push({[e.tagname]:e.child})}};function findClosingIndex(e,t,i,r){var o=e.indexOf(t,i);if(-1===o)throw new Error(r);return o+t.length-1}function tagExpWithClosingIndex(t,e,i=\\\">\\\"){let r,o=\\\"\\\";for(let n=e;n<t.length;n++){let e=t[n];if(r)e===r&&(r=\\\"\\\");else if('\\\"'===e||\\\"'\\\"===e)r=e;else if(e===i[0]){if(!i[1])return{data:o,index:n};if(t[n+1]===i[1])return{data:o,index:n}}else\\\"\\\\t\\\"===e&&(e=\\\" \\\");o+=e}}function readTagExp(e,t,r,i=\\\">\\\"){var o=tagExpWithClosingIndex(e,t+1,i);if(o){let e=o.data;var n=o.index,a=e.search(/\\\\s/);let t=e,i=!0;-1!==a&&(t=e.substr(0,a).replace(/\\\\s\\\\s*$/,\\\"\\\"),e=e.substr(a+1));var l,a=t;return r&&-1!==(l=t.indexOf(\\\":\\\"))&&(t=t.substr(l+1),i=t!==o.data.substr(l+1)),{tagName:t,tagExp:e,closeIndex:n,attrExpPresent:i,rawTagName:a}}}var attrsRegx=new RegExp(`([^\\\\\\\\s=]+)\\\\\\\\s*(=\\\\\\\\s*(['\\\"])([\\\\\\\\s\\\\\\\\S]*?)\\\\\\\\3)?`,\\\"gm\\\"),OrderedObjParser=class{constructor(e){this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(e,t,i){var r=t.tagname;\\\"string\\\"==typeof r&&(t.tagname=r),e.addChild(t)}buildAttributesMap(t,e,i){var r={};if(t){var o=getAllMatches(t,attrsRegx),n=o.length;for(let e=0;e<n;e++){var a=o[e][1],l=o[e][4];a&&(r[a]=void 0===l||(isNaN(l)?l:Number(l)))}return r}}parseXml(i){i=i.replace(/\\\\r\\\\n?/g,\\\"\\\\n\\\");var r=new XmlNode(\\\"!xml\\\");let o=r,n=\\\"\\\",a=\\\"\\\";for(let u=0;u<i.length;u++)if(\\\"<\\\"===i[u])if(\\\"/\\\"===i[u+1]){var l=findClosingIndex(i,\\\">\\\",u,\\\"Closing Tag is not closed.\\\"),s=a.lastIndexOf(\\\".\\\");a=a.substring(0,s),(o=this.tagsNodeStack.pop())&&o.child&&n&&o.child[o.child.length-1][\\\":@\\\"]&&(o.child[o.child.length-1][\\\":@\\\"].text=n),n=\\\"\\\",u=l}else if(\\\"?\\\"===i[u+1])u=readTagExp(i,u,!1,\\\"?>\\\").closeIndex+1;else if(\\\"!--\\\"===i.substr(u+1,3))u=findClosingIndex(i,\\\"--\\\\x3e\\\",u+4,\\\"Comment is not closed.\\\");else{s=readTagExp(i,u,!1);let e=s.tagName,t=s.tagExp;var h,l=s.attrExpPresent,d=s.closeIndex;e!==r.tagname&&(a+=a?\\\".\\\"+e:e),0<t.length&&t.lastIndexOf(\\\"/\\\")===t.length-1?(t=\\\"/\\\"===e[e.length-1]?(e=e.substr(0,e.length-1),a=a.substr(0,a.length-1),e):t.substr(0,t.length-1),h=new XmlNode(e),e!==t&&l&&(h[\\\":@\\\"]=this.buildAttributesMap(t,a,e)),this.addChild(o,h,a),a=a.substr(0,a.lastIndexOf(\\\".\\\"))):(h=new XmlNode(e),this.tagsNodeStack.push(o),e!==t&&l&&(h[\\\":@\\\"]=this.buildAttributesMap(t,a,e)),this.addChild(o,h,a),o=h),n=\\\"\\\",u=d}else n+=i[u];return r.child}};function prettify(e,t){return compress(e)}function compress(e,t){var i={};for(let l=0;l<e.length;l++){var r,o=e[l],n=propName(o),a=void 0===t?n:t+\\\".\\\"+n;void 0!==n&&o[n]&&(isLeafTag(r=compress(o[n],a)),o[\\\":@\\\"]&&assignAttributes(r,o[\\\":@\\\"],a),void 0!==i[n]&&i.hasOwnProperty(n)?(Array.isArray(i[n])||(i[n]=[i[n]]),i[n].push(r)):i[n]=r)}return i}function propName(e){var t=Object.keys(e);for(let r=0;r<t.length;r++){var i=t[r];if(\\\":@\\\"!==i)return i}}function assignAttributes(t,i,e){if(i){var r=Object.keys(i),o=r.length;for(let e=0;e<o;e++){var n=r[e];t[n]=i[n]}}}function isLeafTag(e){return 0===Object.keys(e).length}init_esbuild_inject();var XMLParser=class w5a{constructor(e){this.options=Object.assign({},w5a.defaultOptions,e)}valid(e){return e.startsWith(\\\"<\\\")}parse(e){return!!this.valid&&prettify(new OrderedObjParser(this.options).parseXml(e),this.options)}};function isSvg(e){return e.startsWith(\\\"<svg\\\")||e.startsWith(\\\"<?xml\\\")}function boundStroke(e,t,i,r=0){return e.expand(t+(r/2+(i?miterAdjustment(i,t):0))),e}function miterAdjustment(e,t){return e?t:0}XMLParser.defaultOptions={};var TextDirection,NUMBER_TYPE=0;function genNumberType(){return NUMBER_TYPE++}function verticalLayout(e){var t=[];let i=0,r=\\\"\\\";for(let o=0;o<e.length;o++)rotateText(e[o])?i?r+=e[o]:(i=1,r=e[o]):(i&&(t.push({text:r,direction:TextDirection.VERTICAL}),r=\\\"\\\",i=0),t.push({text:e[o],direction:TextDirection.HORIZONTAL}));return r&&t.push({text:r,direction:TextDirection.VERTICAL}),t}!function(e){e[e.HORIZONTAL=0]=\\\"HORIZONTAL\\\",e[e.VERTICAL=1]=\\\"VERTICAL\\\"}(TextDirection=TextDirection||{});var rotateCharList=[\\\"…\\\",\\\"（\\\",\\\"）\\\",\\\"—\\\",\\\"【\\\",\\\"】\\\",\\\"「\\\",\\\"」\\\",\\\"《\\\",\\\"》\\\"],rotateCharMap=new Map,noRotateCharList=(rotateCharList.forEach(e=>rotateCharMap.set(e,!0)),[\\\"\\\"]),noRotateCharMap=new Map;function rotateText(e){if(rotateCharMap.has(e))return!0;if(noRotateCharMap.has(e))return!1;let t=!1;return t=e.codePointAt(0)<256?!0:t}noRotateCharList.forEach(e=>noRotateCharMap.set(e,!0));var GroupUpdateAABBBoundsMode,ARC_NUMBER_TYPE=genNumberType(),ARC3D_NUMBER_TYPE=genNumberType(),AREA_NUMBER_TYPE=genNumberType(),CIRCLE_NUMBER_TYPE=genNumberType(),GLYPH_NUMBER_TYPE=genNumberType(),GROUP_NUMBER_TYPE=genNumberType(),IMAGE_NUMBER_TYPE=genNumberType(),LINE_NUMBER_TYPE=genNumberType(),PATH_NUMBER_TYPE=genNumberType(),POLYGON_NUMBER_TYPE=genNumberType(),PYRAMID3D_NUMBER_TYPE=genNumberType(),RECT_NUMBER_TYPE=genNumberType(),RECT3D_NUMBER_TYPE=genNumberType(),RICHTEXT_NUMBER_TYPE=genNumberType(),SYMBOL_NUMBER_TYPE=genNumberType(),TEXT_NUMBER_TYPE=genNumberType(),GraphicService=Symbol[\\\"for\\\"](\\\"GraphicService\\\"),GraphicCreator=Symbol[\\\"for\\\"](\\\"GraphicCreator\\\"),SVG_ATTRIBUTE_MAP={\\\"stroke-linecap\\\":\\\"lineCap\\\",\\\"stroke-linejoin\\\":\\\"lineJoin\\\",\\\"stroke-dasharray\\\":\\\"lineDash\\\",\\\"stroke-dashoffset\\\":\\\"lineDashOffset\\\",\\\"stroke-width\\\":\\\"lineWidth\\\",\\\"fill-opacity\\\":\\\"fillOpacity\\\",\\\"stroke-opacity\\\":\\\"strokeOpacity\\\"},SVG_ATTRIBUTE_MAP_KEYS=Object.keys(SVG_ATTRIBUTE_MAP),SVG_PARSE_ATTRIBUTE_MAP={\\\"stroke-linecap\\\":\\\"lineCap\\\",\\\"stroke-linejoin\\\":\\\"lineJoin\\\",\\\"stroke-dasharray\\\":\\\"lineDash\\\",\\\"stroke-dashoffset\\\":\\\"lineDashOffset\\\",\\\"stroke-width\\\":\\\"lineWidth\\\",\\\"fill-opacity\\\":\\\"fillOpacity\\\",\\\"stroke-opacity\\\":\\\"strokeOpacity\\\",stroke:\\\"stroke\\\",fill:\\\"fill\\\"},SVG_PARSE_ATTRIBUTE_MAP_KEYS=Object.keys(SVG_PARSE_ATTRIBUTE_MAP),Group=(!function(e){e[e.LESS_GROUP=0]=\\\"LESS_GROUP\\\",e[e.MORE_GROUP=1]=\\\"MORE_GROUP\\\"}(GroupUpdateAABBBoundsMode=GroupUpdateAABBBoundsMode||{}),class T5a extends Graphic{constructor(e){super(e),this.type=\\\"group\\\",this.parent=null,this.isContainer=!0,this.numberType=GROUP_NUMBER_TYPE,this._childUpdateTag=UpdateTag.UPDATE_BOUNDS}setMode(e){\\\"3d\\\"===e?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(e){return this.theme||(this.theme=new Theme),this.theme.setTheme(e,this)}createTheme(){this.theme||(this.theme=new Theme)}visibleAll(t){this.setAttribute(\\\"visible\\\",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute(\\\"visible\\\",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(e,t,i){var r;return i===IContainPointMode.GLOBAL?(r=new Point(e,t),this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),this.AABBBounds.contains(r.x,r.y)):this.AABBBounds.contains(e,t)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&UpdateTag.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;application.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);var e=this.shouldSelfChangeUpdateAABBBounds(),t=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),application.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,e),t}doUpdateLocalMatrix(){var{x:e=DefaultTransform.x,y:t=DefaultTransform.y,dx:i=DefaultTransform.dx,dy:r=DefaultTransform.dy,scaleX:o=DefaultTransform.scaleX,scaleY:n=DefaultTransform.scaleY,angle:a=DefaultTransform.angle,postMatrix:l}=this.attribute;if(0!==e||0!==t||0!==i||0!==r||1!==o||1!==n||0!==a||l)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return getTheme(this).group}updateAABBBounds(e,t,i){var r=i,{width:o,height:n,path:a,clip:l=t.clip}=(i=i.clone(),e);return a&&a.length?a.forEach(e=>{i.union(e.AABBBounds)}):null!=o&&null!=n&&i.set(0,0,Math.max(0,o),Math.max(0,n)),l||(this.forEachChildren(e=>{i.union(e.AABBBounds)}),({scrollX:a=0,scrollY:o=0}=e),i.translate(a,o)),application.graphicService.updateTempAABBBounds(i),application.graphicService.transformAABBBounds(e,i,t,!1,this),r.copy(i),r}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;var e=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent(\\\"AAABBBoundsChange\\\"),e}clearUpdateBoundTag(){this._updateTag&=UpdateTag.CLEAR_BOUNDS,this._childUpdateTag&=UpdateTag.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&UpdateTag.UPDATE_BOUNDS||(this._childUpdateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(e){var t=super.appendChild(e);return this.stage&&t&&(t.stage=this.stage,t.layer=this.layer),this.addUpdateBoundTag(),application.graphicService.onAddIncremental(e,this,this.stage),t}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),application.graphicService.onClearIncremental(this,this.stage)}_updateChildToStage(e){return this.stage&&e&&e.setStage(this.stage,this.layer),this.addUpdateBoundTag(),e}appendChild(e,t=!0){var i=super.appendChild(e);return t&&this.stage&&i&&i.setStage(this.stage,this.layer),this.addUpdateBoundTag(),i}insertBefore(e,t){return this._updateChildToStage(super.insertBefore(e,t))}insertAfter(e,t){return this._updateChildToStage(super.insertAfter(e,t))}insertInto(e,t){return this._updateChildToStage(super.insertInto(e,t))}removeChild(e){var t=super.removeChild(e);return e.stage=null,application.graphicService.onRemove(e),this.addUpdateBoundTag(),t}removeAllChild(t=!1){this.forEachChildren(e=>{application.graphicService.onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),application.graphicService.onSetStage(this,t),this.forEachChildren(e=>{e.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(e=>{e.isContainer&&e.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(e=>{e.isContainer&&e.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(e=!0){var t;return this.shouldUpdateGlobalMatrix()&&(this._globalTransMatrix?this.parent&&(t=this.parent.globalTransMatrix,this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f)):this._globalTransMatrix=(this.parent?this.parent.globalTransMatrix:this.transMatrix).clone(),this.doUpdateGlobalMatrix(),e)&&this.clearUpdateGlobalPositionTag(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&UpdateTag.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(e=>e.name===t,e)}createOrUpdateChild(e,t,i){let r=this._getChildByName(e);return r?r.setAttributes(t):((r=application.graphicService.creator[i](t)).name=e,this.add(r)),r}clone(){return new T5a(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return T5a.NOWORK_ANIMATE_ATTR}});function createGroup(e){return new Group(e)}Group.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;var DefaultLayerService_1,Layer=class extends Group{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw new Error(\\\"暂不支持\\\")}get dpr(){return this._dpr}constructor(e,t,i,r){var o;super({}),this.stage=e,this.global=t,this.window=i,this.main=r.main,this.layerHandler=r.layerHandler,this.layerHandler.init(this,i,{main:r.main,canvasId:r.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:null!=(o=r.zIndex)?o:0}),(this.layer=this).subLayers=new Map,this.theme=new Theme,this.background=\\\"rgba(0, 0, 0, 0)\\\",this.afterDrawCbs=[]}combineSubLayer(t=!0){var e=Array.from(this.subLayers.values()).sort((e,t)=>e.zIndex-t.zIndex);this.layerHandler.merge(e.map(e=>(e.layer.subLayers.size&&e.layer.combineSubLayer(t),e.layer.getNativeHandler()))),t&&e.forEach(e=>{e.group&&(e.group.incremental=0)}),e.forEach(e=>{application.layerService.releaseLayer(this.stage,e.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(e,t){super.setStage(e,this)}pick(e,t){throw new Error(\\\"暂不支持\\\")}tryRenderSecondaryLayer(t,i){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(e=>{e.layer.renderCount=this.renderCount,e.layer.render(t,i)})}render(e,t){var i;this.layerHandler.render([this],{renderService:e.renderService,stage:this.stage,layer:this,viewBox:e.viewBox,transMatrix:e.transMatrix,background:null!=(i=e.background)?i:this.background,updateBounds:e.updateBounds},t),this.afterDrawCbs.forEach(e=>e(this)),this.tryRenderSecondaryLayer(e,t)}resize(e,t){this.layerHandler.resize(e,t)}resizeView(e,t){this.layerHandler.resizeView(e,t)}setDpr(e){this.layerHandler.setDpr(e)}afterDraw(e){this.afterDrawCbs.push(e)}startAnimate(e){throw new Error(\\\"暂不支持\\\")}setToFrame(e){throw new Error(\\\"暂不支持\\\")}prepare(e,t){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(e=>{application.layerService.releaseLayer(this.stage,e.layer)})}drawTo(e,t){var i;this.layerHandler.drawTo(e,[this],Object.assign({background:null!=(i=t.background)?i:this.background,renderService:t.renderService,viewBox:t.viewBox,transMatrix:t.transMatrix,stage:this.stage,layer:this},t)),this.afterDrawCbs.forEach(e=>e(this))}},TransformUtil=(init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"TransformUtil\\\")),GraphicUtil=Symbol[\\\"for\\\"](\\\"GraphicUtil\\\"),LayerService=Symbol[\\\"for\\\"](\\\"LayerService\\\"),StaticLayerHandlerContribution=Symbol[\\\"for\\\"](\\\"StaticLayerHandlerContribution\\\"),DynamicLayerHandlerContribution=Symbol[\\\"for\\\"](\\\"DynamicLayerHandlerContribution\\\"),VirtualLayerHandlerContribution=Symbol[\\\"for\\\"](\\\"VirtualLayerHandlerContribution\\\"),__decorate6=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata4=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DefaultLayerService=DefaultLayerService_1=class{static GenerateLayerId(){return DefaultLayerService_1.idprefix+\\\"_\\\"+DefaultLayerService_1.prefix_count++}constructor(){this.layerMap=new Map,this.global=application.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(e){return this.layerMap.get(e)}getRecommendedLayerType(e){return e||(0!==this.staticLayerCountInEnv?\\\"static\\\":0!==this.dynamicLayerCountInEnv?\\\"dynamic\\\":\\\"virtual\\\")}getLayerHandler(e){return\\\"static\\\"===e?container.get(StaticLayerHandlerContribution):\\\"dynamic\\\"===e?container.get(DynamicLayerHandlerContribution):container.get(VirtualLayerHandlerContribution)}createLayer(e,t={main:!1}){this.tryInit();var i=this.getRecommendedLayerType(t.layerMode),i=t.main||t.canvasId?\\\"static\\\":i,r=this.getLayerHandler(i),i=new Layer(e,this.global,e.window,Object.assign(Object.assign({main:!1},t),{layerMode:i,canvasId:null!=(i=t.canvasId)?i:DefaultLayerService_1.GenerateLayerId(),layerHandler:r})),r=this.layerMap.get(e)||[];return r.push(i),this.layerMap.set(e,r),this.staticLayerCountInEnv--,i}prepareStageLayer(e){let i;e.forEachChildren(e=>{var t=e.getNativeHandler();\\\"virtual\\\"===t.type?(t.mainHandler=i).secondaryHandlers.push(t):(i=t).secondaryHandlers=[]})}releaseLayer(e,t){t.release();var i=this.layerMap.get(e)||[];this.layerMap.set(e,i.filter(e=>e!==t))}layerCount(e){return(this.layerMap.get(e)||[]).length}restLayerCount(e){return\\\"browser\\\"===this.global.env?10:0}releaseStage(e){this.layerMap[\\\"delete\\\"](e)}},core_modules_default=(DefaultLayerService.idprefix=\\\"visactor_layer\\\",DefaultLayerService.prefix_count=0,DefaultLayerService=DefaultLayerService_1=__decorate6([injectable(),__metadata4(\\\"design:paramtypes\\\",[])],DefaultLayerService),new ContainerModule(e=>{e(VGlobal).to(DefaultGlobal).inSingletonScope(),e(VWindow).to(DefaultWindow),e(GraphicUtil).to(DefaultGraphicUtil).inSingletonScope(),e(TransformUtil).to(DefaultTransformUtil).inSingletonScope(),e(LayerService).to(DefaultLayerService).inSingletonScope()}));function runFill(e,t){return!(!e&&!t)}function runStroke(e,t){return(isArray_default(e)?e.some(e=>e||void 0===e):!!e)&&0<t}function fillVisible(e,t,i){return i&&0<e*t}function rectFillVisible(e,t,i,r,o){return o&&0<e*t&&0!==i&&0!==r}function strokeVisible(e,t){return 0<e*t}function rectStrokeVisible(e,t,i,r){return 0<e*t&&0!==i&&0!==r}function drawPathProxy(e,t,i,r,o,n,a,l){var s,h,d,u,c,g,p,f,m,b;return!!e.pathProxy&&(s=getTheme(e,null==n?void 0:n.theme)[e.type.replace(\\\"3d\\\",\\\"\\\")],({fill:b=s.fill,stroke:h=s.stroke,opacity:f=s.opacity,fillOpacity:p=s.fillOpacity,lineWidth:d=s.lineWidth,strokeOpacity:m=s.strokeOpacity,visible:u=s.visible,x:c=s.x,y:g=s.y}=e.attribute),p=fillVisible(f,p,b),f=strokeVisible(f,m),m=runFill(b),b=runStroke(h,d),u&&(m||b)&&(p||f||a||l)&&(t.beginPath(),renderCommandList((\\\"function\\\"==typeof e.pathProxy?e.pathProxy(e.attribute):e.pathProxy).commandList,t,i,r),t.setShadowBlendStyle&&t.setShadowBlendStyle(e,e.attribute,s),b&&(l?l(t,e.attribute,s):f&&(t.setStrokeStyle(e,e.attribute,i-c,r-g,s),t.stroke())),m)&&(a?a(t,e.attribute,s):p&&(t.setCommonStyle(e,e.attribute,i-c,r-g,s),t.fill())),!0)}function intersect(e,t,i,r,o,n,a,l){var s=i-e,h=r-t,d=a-o,u=l-n,c=u*s-d*h;return c*c<epsilon?[]:[e+(c=(d*(t-n)-u*(e-o))/c)*s,t+c*h]}function cornerTangents(e,t,i,r,o,n,a){var l=e-i,s=t-r,h=(a?n:-n)/Math.sqrt(l*l+s*s),s=h*s,h=-h*l,l=e+s,d=t+h,u=i+s,c=r+h,g=(l+u)/2,p=(d+c)/2,f=u-l,m=c-d,b=f*f+m*m,C=o-n,l=l*c-u*d,c=(m<0?-1:1)*Math.sqrt(Math.max(0,C*C*b-l*l));let v=(l*m-f*c)/b,y=(-l*f-m*c)/b;u=(l*m+f*c)/b,d=(-l*f+m*c)/b,l=v-g,f=y-p,m=u-g,c=d-p;return m*m+c*c<l*l+f*f&&(v=u,y=d),{cx:v,cy:y,x01:-s,y01:-h,x11:v*(o/C-1),y11:y*(o/C-1)}}function calculateArcCornerRadius(e,t,i,r,o){var n=abs(i-t),a=e.getParsedCornerRadius(),l=isArray_default(a),{outerDeltaAngle:s,innerDeltaAngle:h,outerStartAngle:d,outerEndAngle:u,innerEndAngle:c,innerStartAngle:g}=e.getParsePadAngle(t,i),p=l?a[0]:a,f=l?a[1]:a,m=l?a[2]:a,l=l?a[3]:a,a=Math.max(f,p),b=Math.max(m,l);let C=a,v=b;var y,w,_,S,x=o*cos(d),R=o*sin(d),T=r*cos(c),A=r*sin(c);let P,B,M,E;return(epsilon<b||epsilon<a)&&(P=o*cos(u),B=o*sin(u),M=r*cos(g),E=r*sin(g),n<pi)&&((n=intersect(x,R,M,E,P,B,T,A))&&(_=x-n[0],S=R-n[1],y=P-n[0],w=B-n[1],_=1/sin(acos((_*y+S*w)/(sqrt(_*_+S*S)*sqrt(y*y+w*w)))/2),S=sqrt(n[0]*n[0]+n[1]*n[1]),v=min(b,(r-S)/(_-1)),C=min(a,(o-S)/(1+_)))),{outerDeltaAngle:s,xors:x,yors:R,xirs:M,yirs:E,xore:P,yore:B,xire:T,yire:A,limitedOcr:C,limitedIcr:v,outerCornerRadiusStart:p,outerCornerRadiusEnd:f,maxOuterCornerRadius:a,maxInnerCornerRadius:b,outerStartAngle:d,outerEndAngle:u,innerDeltaAngle:h,innerEndAngle:c,innerStartAngle:g,innerCornerRadiusStart:l,innerCornerRadiusEnd:m}}function drawArcPath(e,t,i,r,o,n,a){var l,s,h,d,u,c,g,p,f,m,b,C,v,y,w,_,S,x,R,T,A,{startAngle:P,endAngle:B}=e.getParsedAngle(),M=abs(B-P),E=P<B;let H=!1;return o<n&&(R=o,o=n,n=R),o<=epsilon?t.moveTo(i,r):pi2-epsilon<=M?(t.moveTo(i+o*cos(P),r+o*sin(P)),t.arc(i,r,o,P,B,!E),epsilon<n&&(t.moveTo(i+n*cos(B),r+n*sin(B)),t.arc(i,r,n,B,P,E))):(({outerDeltaAngle:R,xors:M,yors:B,xirs:l,yirs:s,limitedOcr:x,outerCornerRadiusStart:A,outerCornerRadiusEnd:T,maxOuterCornerRadius:S,xore:h,yore:d,xire:u,yire:c,outerStartAngle:g,outerEndAngle:p,limitedIcr:f,innerDeltaAngle:m,innerEndAngle:b,innerStartAngle:C,innerCornerRadiusStart:v,innerCornerRadiusEnd:y,maxInnerCornerRadius:w}=calculateArcCornerRadius(e,P,B,n,o)),R<.001?(a&&(a[3]||a[1])&&t.moveTo(i+M,r+B),H=!0):epsilon<x?(R=min(A,x),A=min(T,x),T=cornerTangents(l,s,M,B,o,R,Number(E)),_=cornerTangents(h,d,u,c,o,A,Number(E)),x<S&&R===A?!a||a[0]?(t.moveTo(i+T.cx+T.x01,r+T.cy+T.y01),t.arc(i+T.cx,r+T.cy,x,atan2(T.y01,T.x01),atan2(_.y01,_.x01),!E)):t.moveTo(i+T.cx+x*cos(atan2(_.y01,_.x01)),r+T.cy+x*sin(atan2(_.y01,_.x01))):!a||a[0]?(t.moveTo(i+T.cx+T.x01,r+T.cy+T.y01),0<R&&t.arc(i+T.cx,r+T.cy,R,atan2(T.y01,T.x01),atan2(T.y11,T.x11),!E),t.arc(i,r,o,atan2(T.cy+T.y11,T.cx+T.x11),atan2(_.cy+_.y11,_.cx+_.x11),!E),0<A&&t.arc(i+_.cx,r+_.cy,A,atan2(_.y11,_.x11),atan2(_.y01,_.x01),!E)):0<A?t.moveTo(i+_.cx+A*cos(atan2(_.y01,_.x01)),r+_.cy+A*sin(atan2(_.y01,_.x01))):t.moveTo(i+h,r+o*sin(p))):!a||a[0]?(t.moveTo(i+M,r+B),t.arc(i,r,o,g,p,!E)):t.moveTo(i+o*cos(p),r+o*sin(p)),!(epsilon<n)||m<.001?(!a||a[1]?t.lineTo(i+u,r+c):t.moveTo(i+u,r+c),H=!0):epsilon<f?(S=min(v,f),R=cornerTangents(u,c,h,d,n,-(x=min(y,f)),Number(E)),T=cornerTangents(M,B,l,s,n,-S,Number(E)),!a||a[1]?t.lineTo(i+R.cx+R.x01,r+R.cy+R.y01):t.moveTo(i+R.cx+R.x01,r+R.cy+R.y01),f<w&&S===x?(A=atan2(T.y01,T.x01),!a||a[2]?t.arc(i+R.cx,r+R.cy,f,atan2(R.y01,R.x01),A,!E):t.moveTo(i+R.cx+cos(A),r+R.cy+sin(A))):!a||a[2]?(0<x&&t.arc(i+R.cx,r+R.cy,x,atan2(R.y01,R.x01),atan2(R.y11,R.x11),!E),t.arc(i,r,n,atan2(R.cy+R.y11,R.cx+R.x11),atan2(T.cy+T.y11,T.cx+T.x11),E),0<S&&t.arc(i+T.cx,r+T.cy,S,atan2(T.y11,T.x11),atan2(T.y01,T.x01),!E)):0<S?t.moveTo(i+T.cx+S*cos(atan2(T.y01,T.x01)),r+T.cy+S*sin(atan2(T.y01,T.x01))):t.moveTo(i+l,r+s)):(!a||a[1]?t.lineTo(i+u,r+c):t.moveTo(i+u,r+c),!a||a[2]?t.arc(i,r,n,b,C,E):t.moveTo(i+n*cos(C),r+n*sin(C)))),a?a[3]&&t.lineTo(i+o*cos(P),r+o*sin(P)):t.closePath(),H}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var ConicalCanvas=class z8a{static GetCanvas(){try{return z8a.canvas||(z8a.canvas=application.global.createCanvas({})),z8a.canvas}catch(err){return null}}static GetCtx(){var e;return z8a.ctx||(e=z8a.GetCanvas(),z8a.ctx=e.getContext(\\\"2d\\\")),z8a.ctx}},ColorInterpolate=class B8a extends LRU{static getInstance(){return B8a._instance||(B8a._instance=new B8a),B8a._instance}constructor(e=[],t=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;var i=ConicalCanvas.GetCanvas(),r=ConicalCanvas.GetCtx();if(i.width=t,i.height=1,r){if(r.translate(0,0),!r)throw new Error(\\\"获取ctx发生错误\\\");const o=r.createLinearGradient(0,0,t,0);e.forEach(e=>{o.addColorStop(e[0],e[1])}),r.fillStyle=o,r.fillRect(0,0,t,1),this.rgbaSet=r.getImageData(0,0,t,1).data}}getColor(e){var t=this.rgbaSet.slice(4*e,4*e+4);return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]/255})`}GetOrCreate(e,t,i,r,o=[],n=100){let a=\\\"\\\"+e+t+i+r,l=(o.forEach(e=>a+=e.join()),a+=n,this.dataMap.get(a));return l||(l={data:new B8a(o,n),timestamp:[]},this.addLimitedTimestamp(l,Date.now(),{}),this.dataMap.set(a,l)),this.clearCache(this.dataMap,this.cacheParams),l.data}},ConicalPatternStore=class T8a{static GetSize(e){for(let t=0;t<T8a.ImageSize.length;t++)if(T8a.ImageSize[t]>=e)return T8a.ImageSize[t];return e}static Get(e,t,i,r,o,n,a){var l=T8a.GenKey(e,t,i,r,o),s=T8a.cache[l];if(s&&0!==s.length)for(let e=0;e<s.length;e++)if(s[e].width>=n&&s[e].height>=a)return s[e].pattern;return null}static Set(e,t,i,r,o,n,a,l){var s=T8a.GenKey(e,t,i,r,o);T8a.cache[s]?T8a.cache[s].push({width:a,height:l,pattern:n}):T8a.cache[s]=[{width:a,height:l,pattern:n}]}static GenKey(e,t,i,r,o){return t+`,${i},${r},${o},`+e.join()}};function getConicGradientAt(e,t,i,r){for(var{stops:o,startAngle:n,endAngle:a}=r;i<0;)i+=pi2;for(;pi2<i;)i-=pi2;if(i<n)return o[0].color;if(a<i)return o[0].color;let l,s,h=(i-n)/(a-n);for(let d=0;d<o.length;d++)if(o[d].offset>=h){l=o[d-1],s=o[d];break}return h=(h-l.offset)/(s.offset-l.offset),interpolateColor(l.color,s.color,h,!1)}function createConicalGradient(i,r,o,n,a,l,s,e,t){var h=Math.floor(180*a/Math.PI),d=ConicalCanvas.GetCanvas(),u=ConicalCanvas.GetCtx();if(!u)return null;var c=ConicalPatternStore.GetSize(e),g=ConicalPatternStore.GetSize(t),p=ConicalPatternStore.Get(r,o,n,l,s,c,g);if(!p){var f=Math.sqrt(Math.max(Math.max(Math.pow(o,2)+Math.pow(n,2),Math.pow(c-o,2)+Math.pow(n,2)),Math.max(Math.pow(c-o,2)+Math.pow(g-n,2),Math.pow(o,2)+Math.pow(g-n,2)))),h=h+1,m=a/Math.max(1,h-1),b=ColorInterpolate.getInstance().GetOrCreate(o,n,c,g,r,h),C=2*Math.PI*f/360;d.width=c,d.height=g,u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,c,g),u.translate(o,n),u.rotate(l);for(let e=0,t=h-1;e<t&&!(l+e*m>s);e++){var v=b.getColor(e);u.beginPath(),u.rotate(m),u.moveTo(0,0),u.lineTo(f,-2*C),u.lineTo(f,0),u.fillStyle=v,u.closePath(),u.fill()}h=u.getImageData(0,0,c,g);d.width=h.width,d.height=h.height,u.putImageData(h,0,0),(p=i.createPattern(d,\\\"no-repeat\\\"))&&ConicalPatternStore.Set(r,o,n,l,s,p,c,g)}return p}ConicalPatternStore.cache={},ConicalPatternStore.ImageSize=[20,40,80,160,320,640,1280,2560],init_esbuild_inject();var ArcRenderContribution=Symbol[\\\"for\\\"](\\\"ArcRenderContribution\\\"),AreaRenderContribution=Symbol[\\\"for\\\"](\\\"AreaRenderContribution\\\"),CircleRenderContribution=Symbol[\\\"for\\\"](\\\"CircleRenderContribution\\\"),GroupRenderContribution=Symbol[\\\"for\\\"](\\\"GroupRenderContribution\\\"),ImageRenderContribution=Symbol[\\\"for\\\"](\\\"ImageRenderContribution\\\"),PathRenderContribution=Symbol[\\\"for\\\"](\\\"PathRenderContribution\\\"),PolygonRenderContribution=Symbol[\\\"for\\\"](\\\"PolygonRenderContribution\\\"),RectRenderContribution=Symbol[\\\"for\\\"](\\\"RectRenderContribution\\\"),SymbolRenderContribution=Symbol[\\\"for\\\"](\\\"SymbolRenderContribution\\\"),TextRenderContribution=Symbol[\\\"for\\\"](\\\"TextRenderContribution\\\"),CommonRenderContribution=Symbol[\\\"for\\\"](\\\"CommonRenderContribution\\\"),InteractiveSubRenderContribution=Symbol[\\\"for\\\"](\\\"InteractiveSubRenderContribution\\\");function textDrawOffsetX(e,t){return\\\"end\\\"===e||\\\"right\\\"===e?-t:\\\"center\\\"===e?-t/2:0}function textLayoutOffsetY(e,t,i,r=0){return\\\"middle\\\"===e?-t/2:\\\"top\\\"===e?0:\\\"bottom\\\"===e?r-t:e&&\\\"alphabetic\\\"!==e?0:-(t-(i=i||t))/2-.79*i}function identityMat4(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function rotateX(e,t,i){var r=Math.sin(i),o=Math.cos(i),n=t[4],a=t[5],l=t[6],s=t[7],h=t[8],d=t[9],u=t[10],c=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*o+h*r,e[5]=a*o+d*r,e[6]=l*o+u*r,e[7]=s*o+c*r,e[8]=h*o-n*r,e[9]=d*o-a*r,e[10]=u*o-l*r,e[11]=c*o-s*r,e}function rotateY(e,t,i){var r=Math.sin(i),o=Math.cos(i),n=t[0],a=t[1],l=t[2],s=t[3],h=t[8],d=t[9],u=t[10],c=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*o-h*r,e[1]=a*o-d*r,e[2]=l*o-u*r,e[3]=s*o-c*r,e[8]=n*r+h*o,e[9]=a*r+d*o,e[10]=l*r+u*o,e[11]=s*r+c*o,e}function rotateZ(e,t,i){var r=Math.sin(i),o=Math.cos(i),n=t[0],a=t[1],l=t[2],s=t[3],h=t[4],d=t[5],u=t[6],c=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*o+h*r,e[1]=a*o+d*r,e[2]=l*o+u*r,e[3]=s*o+c*r,e[4]=h*o-n*r,e[5]=d*o-a*r,e[6]=u*o-l*r,e[7]=c*o-s*r,e}function translate(e,t,i){var r,o,n,a,l,s,h,d,u,c,g,p,f=i[0],m=i[1],b=i[2];return t===e?(e[12]=t[0]*f+t[4]*m+t[8]*b+t[12],e[13]=t[1]*f+t[5]*m+t[9]*b+t[13],e[14]=t[2]*f+t[6]*m+t[10]*b+t[14],e[15]=t[3]*f+t[7]*m+t[11]*b+t[15]):(r=t[0],o=t[1],n=t[2],a=t[3],l=t[4],s=t[5],h=t[6],d=t[7],u=t[8],c=t[9],g=t[10],p=t[11],e[0]=r,e[1]=o,e[2]=n,e[3]=a,e[4]=l,e[5]=s,e[6]=h,e[7]=d,e[8]=u,e[9]=c,e[10]=g,e[11]=p,e[12]=r*f+l*m+u*b+t[12],e[13]=o*f+s*m+c*b+t[13],e[14]=n*f+h*m+g*b+t[14],e[15]=a*f+d*m+p*b+t[15]),e}function mat3Tomat4(e,t){e[0]=t.a,e[1]=t.b,e[2]=0,e[3]=0,e[4]=t.c,e[5]=t.d,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t.e,e[13]=t.f,e[14]=0,e[15]=1}function scaleMat4(e,t,i){var r=i[0],o=i[1],n=i[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function multiplyMat4Mat4(e,t,i){var r=t[0],o=t[1],n=t[2],a=t[3],l=t[4],s=t[5],h=t[6],d=t[7],u=t[8],c=t[9],g=t[10],p=t[11],f=t[12],m=t[13],b=t[14],C=t[15],v=i[0],y=i[1],w=i[2],_=i[3];return e[0]=v*r+y*l+w*u+_*f,e[1]=v*o+y*s+w*c+_*m,e[2]=v*n+y*h+w*g+_*b,e[3]=v*a+y*d+w*p+_*C,e[4]=(v=i[4])*r+(y=i[5])*l+(w=i[6])*u+(_=i[7])*f,e[5]=v*o+y*s+w*c+_*m,e[6]=v*n+y*h+w*g+_*b,e[7]=v*a+y*d+w*p+_*C,e[8]=(v=i[8])*r+(y=i[9])*l+(w=i[10])*u+(_=i[11])*f,e[9]=v*o+y*s+w*c+_*m,e[10]=v*n+y*h+w*g+_*b,e[11]=v*a+y*d+w*p+_*C,e[12]=(v=i[12])*r+(y=i[13])*l+(w=i[14])*u+(_=i[15])*f,e[13]=v*o+y*s+w*c+_*m,e[14]=v*n+y*h+w*g+_*b,e[15]=v*a+y*d+w*p+_*C,e}function transformMat4(e,t,i){var r=t[0],o=t[1],n=t[2],a=i[3]*r+i[7]*o+i[11]*n+i[15];return e[0]=(i[0]*r+i[4]*o+i[8]*n+i[12])/(a=a||1),e[1]=(i[1]*r+i[5]*o+i[9]*n+i[13])/a,e[2]=(i[2]*r+i[6]*o+i[10]*n+i[14])/a,e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var MatrixAllocate=Symbol[\\\"for\\\"](\\\"MatrixAllocate\\\"),Mat4Allocate=Symbol[\\\"for\\\"](\\\"Mat4Allocate\\\");function createMat4(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}var DefaultMatrixAllocate=class{constructor(){this.pools=[]}allocate(e,t,i,r,o,n){var a;return this.pools.length?((a=this.pools.pop()).a=e,a.b=t,a.c=i,a.d=r,a.e=o,a.f=n,a):new Matrix(e,t,i,r,o,n)}allocateByObj(e){var t;return this.pools.length?((t=this.pools.pop()).a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.e=e.e,t.f=e.f,t):new Matrix(e.a,e.b,e.c,e.d,e.e,e.f)}free(e){this.pools.push(e)}get length(){return this.pools.length}release(){this.pools=[]}},DefaultMat4Allocate=class ela{constructor(){this.pools=[]}static identity(e){return identityMat4(e)}allocate(){var e;return this.pools.length?(e=this.pools.pop(),ela.identity(e),e):createMat4()}allocateByObj(e){var t=this.pools.length?this.pools.pop():createMat4();for(let i=0;i<t.length;i++)t[i]=e[i];return t}free(e){e&&this.pools.push(e)}get length(){return this.pools.length}release(){this.pools=[]}},matrixAllocate=new DefaultMatrixAllocate,mat4Allocate=new DefaultMat4Allocate,__decorate7=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata5=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param3=function(i,r){return function(e,t){r(e,t,i)}};function getModelMatrix(e,t,i){var r,o,{x:n=i.x,y:a=i.y,z:l=i.z,dx:s=i.dx,dy:h=i.dy,dz:d=i.dz,scaleX:u=i.scaleX,scaleY:c=i.scaleY,scaleZ:g=i.scaleZ,alpha:p=i.alpha,beta:f=i.beta,angle:m=i.angle,anchor3d:b=t.attribute.anchor,anchor:C}=t.attribute,v=[0,0,0];b&&(\\\"string\\\"==typeof b[0]?(o=parseFloat(b[0])/100,r=t.AABBBounds,v[0]=r.x1+(r.x2-r.x1)*o):v[0]=b[0],\\\"string\\\"==typeof b[1]?(r=parseFloat(b[1])/100,o=t.AABBBounds,v[1]=o.x1+(o.x2-o.x1)*r):v[1]=b[1],v[2]=null!=(o=b[2])?o:0),identityMat4(e),translate(e,e,[n+s,a+h,l+d]),translate(e,e,[v[0],v[1],v[2]]),rotateX(e,e,f),rotateY(e,e,p),translate(e,e,[-v[0],-v[1],v[2]]),scaleMat4(e,e,[u,c,g]),m&&(r=mat4Allocate.allocate(),o=[0,0],C&&(\\\"string\\\"==typeof b[0]?(n=parseFloat(b[0])/100,s=t.AABBBounds,o[0]=s.x1+(s.x2-s.x1)*n):o[0]=b[0],\\\"string\\\"==typeof b[1]?(a=parseFloat(b[1])/100,h=t.AABBBounds,o[1]=h.x1+(h.x2-h.x1)*a):o[1]=b[1]),translate(r,r,[o[0],o[1],0]),rotateZ(r,r,m),translate(r,r,[-o[0],-o[1],0]),multiplyMat4Mat4(e,e,r))}function shouldUseMat4(e){var{alpha:t,beta:i}=e.attribute;return t||i}var DefaultGraphicService=class{constructor(e){this.creator=e,this.hooks={onAttributeUpdate:new SyncHook([\\\"graphic\\\"]),onSetStage:new SyncHook([\\\"graphic\\\",\\\"stage\\\"]),onRemove:new SyncHook([\\\"graphic\\\"]),onRelease:new SyncHook([\\\"graphic\\\"]),onAddIncremental:new SyncHook([\\\"graphic\\\",\\\"group\\\",\\\"stage\\\"]),onClearIncremental:new SyncHook([\\\"graphic\\\",\\\"group\\\",\\\"stage\\\"]),beforeUpdateAABBBounds:new SyncHook([\\\"graphic\\\",\\\"stage\\\",\\\"willUpdate\\\",\\\"aabbBounds\\\"]),afterUpdateAABBBounds:new SyncHook([\\\"graphic\\\",\\\"stage\\\",\\\"aabbBounds\\\",\\\"globalAABBBounds\\\",\\\"selfChange\\\"]),clearAABBBounds:new SyncHook([\\\"graphic\\\",\\\"stage\\\",\\\"aabbBounds\\\"])},this.tempAABBBounds1=new AABBBounds,this.tempAABBBounds2=new AABBBounds}onAttributeUpdate(e){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(e)}onSetStage(e,t){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(e,t)}onRemove(e){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(e)}onRelease(e){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(e)}onAddIncremental(e,t,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(e,t,i)}onClearIncremental(e,t){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(e,t)}beforeUpdateAABBBounds(e,t,i,r){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(e,t,i,r)}afterUpdateAABBBounds(e,t,i,r,o){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(e,t,i,r,o)}clearAABBBounds(e,t,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(e,t,i)}updatePathProxyAABBBounds(e,t){var i,r=\\\"function\\\"==typeof t.pathProxy?t.pathProxy(t.attribute):t.pathProxy;return!!r&&(i=new BoundsContext(e),renderCommandList(r.commandList,i,0,0),!0)}updateHTMLTextAABBBounds(e,t,i,r){var o,{textAlign:n,textBaseline:a}=e;null!=e.forceBoundsHeight&&(o=textLayoutOffsetY(a,a=isNumber_default(e.forceBoundsHeight)?e.forceBoundsHeight:e.forceBoundsHeight(),a),i.set(i.x1,o,i.x2,o+a)),null!=e.forceBoundsWidth&&(a=textDrawOffsetX(n,o=isNumber_default(e.forceBoundsWidth)?e.forceBoundsWidth:e.forceBoundsWidth()),i.set(a,i.y1,a+o,i.y2))}combindShadowAABBBounds(e,t){var i;t&&t.shadowRoot&&(i=t.shadowRoot.AABBBounds,e.union(i))}transformAABBBounds(e,t,i,r,o){var n,a,l,s,h,d,u,c;if(t.empty()||(({scaleX:n=i.scaleX,scaleY:a=i.scaleY,stroke:u=i.stroke,shadowBlur:l=i.shadowBlur,lineWidth:c=i.lineWidth,pickStrokeBuffer:g=i.pickStrokeBuffer,strokeBoundsBuffer:s=i.strokeBoundsBuffer}=e),h=this.tempAABBBounds1,d=this.tempAABBBounds2,u&&c&&(boundStroke(h,(c+g)/Math.abs(n+a),r,s),t.union(h),h.setValue(d.x1,d.y1,d.x2,d.y2)),l&&(({shadowOffsetX:u=i.shadowOffsetX,shadowOffsetY:c=i.shadowOffsetY}=e),boundStroke(h,l/Math.abs(n+a)*2,!1,s+1),h.translate(u,c),t.union(h))),this.combindShadowAABBBounds(t,o),!t.empty()){let e=!0;var g=o.transMatrix;(e=o&&o.isContainer?!(1===g.a&&0===g.b&&0===g.c&&1===g.d&&0===g.e&&0===g.f):e)&&transformBoundsWithMatrix(t,t,g)}}validCheck(e,t,i,r){var o;return!r||null!=e.forceBoundsHeight||null!=e.forceBoundsWidth||!(!r.shadowRoot&&!r.isContainer&&(({visible:o=t.visible}=e),!r.valid||!o)&&(i.empty()||(r.parent&&i.transformWithMatrix(r.parent.globalTransMatrix),application.graphicService.clearAABBBounds(r,r.stage,i),i.clear()),1))}updateTempAABBBounds(e){var t=this.tempAABBBounds1,i=this.tempAABBBounds2;return t.setValue(e.x1,e.y1,e.x2,e.y2),i.setValue(e.x1,e.y1,e.x2,e.y2),{tb1:t,tb2:i}}},DefaultGraphicService=__decorate7([injectable(),__param3(0,inject(GraphicCreator)),__metadata5(\\\"design:paramtypes\\\",[Object])],DefaultGraphicService),result={x:0,y:0,z:0,lastModelMatrix:null},BaseRender=class{init(e){e&&(this._renderContribitions=e.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions&&this.builtinContributions.forEach(e=>this._renderContribitions.push(e)),this._renderContribitions.length&&(this._renderContribitions.sort((e,t)=>t.order-e.order),this._beforeRenderContribitions=this._renderContribitions.filter(e=>e.time===BaseRenderContributionTime.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(e=>e.time===BaseRenderContributionTime.afterFillStroke))}beforeRenderStep(t,i,r,o,n,a,l,s,h,d,u,c,g){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(e=>{e.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(e.supportedAppName)?e.supportedAppName:[e.supportedAppName]).includes(t.stage.params.context.appName)||e.drawShape(t,i,r,o,n,a,l,s,h,d,u,c,g)})}afterRenderStep(t,i,r,o,n,a,l,s,h,d,u,c,g){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(e=>{e.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(e.supportedAppName)?e.supportedAppName:[e.supportedAppName]).includes(t.stage.params.context.appName)||e.drawShape(t,i,r,o,n,a,l,s,h,d,u,c,g)})}valid(e,t,i,r){var{fill:o=t.fill,background:n,stroke:a=t.stroke,opacity:l=t.opacity,fillOpacity:s=t.fillOpacity,lineWidth:h=t.lineWidth,strokeOpacity:d=t.strokeOpacity,visible:u=t.visible}=e.attribute,s=fillVisible(l,s,o),l=strokeVisible(l,d),d=runFill(o,n),o=runStroke(a,h);return!(!e.valid||!u)&&!(!d&&!o)&&!!(s||l||i||r||n)&&{fVisible:s,sVisible:l,doFill:d,doStroke:o}}transform(e,t,i,r=!1){var o,{x:n=t.x,y:a=t.y,z:l=t.z,scaleX:s=t.scaleX,scaleY:h=t.scaleY,angle:d=t.angle,postMatrix:u}=e.attribute,c=i.modelMatrix,g=i.camera,n=(result.x=n,result.y=a,result.z=l,result.lastModelMatrix=c,g&&(r||shouldUseMat4(e))),a=n?e.transMatrix.onlyTranslate()&&!u:1===s&&1===h&&0===d&&!u;return n&&(u=mat4Allocate.allocate(),getModelMatrix(o=mat4Allocate.allocate(),e,t),multiplyMat4Mat4(u,c||u,o),result.x=0,result.y=0,result.z=0,i.modelMatrix=u,i.setTransform(1,0,0,1,0,0,!0),mat4Allocate.free(o)),a&&!c?(u=e.getOffsetXY(t),result.x+=u.x,result.y+=u.y,result.z=l,i.setTransformForCurrent()):n?(result.x=0,result.y=0,result.z=0,i.setTransform(1,0,0,1,0,0,!0)):g&&i.project?(o=e.getOffsetXY(t),result.x+=o.x,result.y+=o.y,this.transformWithoutTranslate(i,result.x,result.y,result.z,s,h,d)):(i.transformFromMatrix(e.transMatrix,!0),result.x=0,result.y=0,result.z=0),result}transformUseContext2d(e,t,i,r){var o,n,a,l,s,h,d,u,c,g,p,f=r.camera;(this.camera=f)&&(s=(f=e.AABBBounds).x2-f.x1,f=f.y2-f.y1,o=r.project(0,0,i),n=r.project(s,0,i),a=r.project(s,f,i),p={x:0,y:0},l={x:s,y:0},s={x:s,y:f},r.camera=null,h=-(p.y*(a.x-n.x)-l.y*a.x+s.y*n.x+(l.y-s.y)*o.x)*(f=1/(p.x*(s.y-l.y)-l.x*s.y+s.x*l.y+(l.x-s.x)*p.y)),d=(l.y*a.y+p.y*(n.y-a.y)-s.y*n.y+(s.y-l.y)*o.y)*f,u=(p.x*(a.x-n.x)-l.x*a.x+s.x*n.x+(l.x-s.x)*o.x)*f,c=-(l.x*a.y+p.x*(n.y-a.y)-s.x*n.y+(s.x-l.x)*o.y)*f,g=(p.x*(s.y*n.x-l.y*a.x)+p.y*(l.x*a.x-s.x*n.x)+(s.x*l.y-l.x*s.y)*o.x)*f,p=(p.x*(s.y*n.y-l.y*a.y)+p.y*(l.x*a.y-s.x*n.y)+(s.x*l.y-l.x*s.y)*o.y)*f,r.setTransform(h,d,u,c,g,p,!0))}restoreTransformUseContext2d(e,t,i,r){this.camera&&(r.camera=this.camera)}transformWithoutTranslate(e,t,i,r,o,n,a){var l=e.project(t,i,r);e.translate(l.x,l.y,!1),e.scale(o,n,!1),e.rotate(a,!1),e.translate(-l.x,-l.y,!1),e.setTransformForCurrent()}_draw(e,t,i,r,o){var n,a,l,s,h=r.context;h&&(n=e.attribute.renderable,!1!==n)&&(h.highPerformanceSave(),({x:n,y:a,z:l,lastModelMatrix:s}=this.transform(e,t,h,i)),this.z=l,drawPathProxy(e,h,n,a,r,o)||(this.drawShape(e,h,n,a,r,o),this.z=0,h.modelMatrix!==s&&mat4Allocate.free(h.modelMatrix),h.modelMatrix=s),h.highPerformanceRestore())}},__decorate8=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata6=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param4=function(i,r){return function(e,t){r(e,t,i)}},DefaultBaseBackgroundRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g,p,f,{background:m,backgroundOpacity:b=null!=(b=e.attribute.fillOpacity)?b:s.backgroundOpacity,opacity:C=s.opacity,backgroundMode:v=s.backgroundMode,backgroundFit:y=s.backgroundFit}=e.attribute;m&&(e.backgroundImg&&e.resources?\\\"success\\\"===(g=e.resources.get(m)).state&&g.data&&(t.save(),e.parent&&!e.transMatrix.onlyTranslate()&&(p=getTheme(e.parent).group,({scrollX:f=p.scrollX,scrollY:p=p.scrollY}=e.parent.attribute),t.setTransformFromMatrix(e.parent.globalTransMatrix,!0),t.translate(f,p)),t.clip(),f=e.AABBBounds,t.setCommonStyle(e,e.attribute,i,r,s),t.globalAlpha=b*C,this.doDrawImage(t,g.data,f,v,y),t.restore(),e.transMatrix.onlyTranslate()||t.setTransformForCurrent()):(t.highPerformanceSave(),t.setCommonStyle(e,e.attribute,i,r,s),t.globalAlpha=b*C,t.fillStyle=m,t.fill(),t.highPerformanceRestore()))}doDrawImage(i,r,o,n,a){if(\\\"no-repeat\\\"===n)i.drawImage(r,o.x1,o.y1,o.width(),o.height());else{var l=o.width(),s=o.height();let e=l,t=s;a&&\\\"repeat\\\"!==n&&(r.width||r.height)&&(d=r.width,h=r.height,\\\"repeat-x\\\"===n?(e=d*(s/h),t=s):\\\"repeat-y\\\"===n&&(t=h*(l/d),e=l),h=i.dpr,(h=(d=canvasAllocate.allocate({width:e,height:t,dpr:h})).getContext(\\\"2d\\\"))&&(h.inuse=!0,h.clearMatrix(),h.setTransformForCurrent(!0),h.clearRect(0,0,e,t),h.drawImage(r,0,0,e,t),r=d.nativeCanvas),canvasAllocate.free(d));var h=i.dpr,d=i.createPattern(r,n);d.setTransform&&d.setTransform(new DOMMatrix([1/h,0,0,1/h,0,0])),i.fillStyle=d,i.translate(o.x1,o.y1),i.fillRect(0,0,l,s),i.translate(-o.x1,-o.y1)}}},defaultBaseBackgroundRenderContribution=new DefaultBaseBackgroundRenderContribution,DefaultBaseInteractiveRenderContribution=class{constructor(e){this.subRenderContribitions=e,this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,i,r,o,n,a,l,s,h,d,u,c,g){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(e=>{e.render(t,i,r,o,n,a,l,s,h,d,u,c,g)})}},DefaultBaseInteractiveRenderContribution=__decorate8([injectable(),__param4(0,inject(ContributionProvider)),__param4(0,named(InteractiveSubRenderContribution)),__metadata6(\\\"design:paramtypes\\\",[Object])],DefaultBaseInteractiveRenderContribution),DefaultBaseTextureRenderContribution=(init_esbuild_inject(),class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=10}createCommonPattern(e,t,i,r,o){var n=(e-2*t)/2,a=r.dpr,l=canvasAllocate.allocate({width:e,height:e,dpr:a}),s=l.getContext(\\\"2d\\\");if(!s)return null;s.inuse=!0,s.clearMatrix(),s.setTransformForCurrent(!0),s.clearRect(0,0,e,e),o(n,s);n=r.createPattern(l.nativeCanvas,\\\"repeat\\\");return n.setTransform&&n.setTransform(new DOMMatrix([1/a,0,0,1/a,0,0])),canvasAllocate.free(l),n}createCirclePattern(e,t,i,r){return this.createCommonPattern(e,t,i,r,(e,t)=>{t.fillStyle=i,t.arc(e,e,e,0,pi2),t.fill()})}createDiamondPattern(o,e,n,t){return this.createCommonPattern(o,e,n,t,(e,t)=>{var i=o/2,r=i;t.fillStyle=n,t.moveTo(i,r-e),t.lineTo(e+i,r),t.lineTo(i,r+e),t.lineTo(i-e,r),t.closePath(),t.fill()})}createRectPattern(e,o,n,t){return this.createCommonPattern(e,o,n,t,(e,t)=>{var i=o,r=i;t.fillStyle=n,t.fillRect(i,r,2*e,2*e)})}createVerticalLinePattern(r,o,n,e){return this.createCommonPattern(r,o,n,e,(e,t)=>{var i=o;t.fillStyle=n,t.fillRect(i,0,2*e,r)})}createHorizontalLinePattern(r,o,n,e){return this.createCommonPattern(r,o,n,e,(e,t)=>{var i=o;t.fillStyle=n,t.fillRect(0,i,r,2*e)})}createBiasLRLinePattern(o,e,n,t){return this.createCommonPattern(o,e,n,t,(e,t)=>{t.strokeStyle=n,t.lineWidth=e,t.moveTo(0,0),t.lineTo(o,o);var i=o/2,r=-i;t.moveTo(i,r),t.lineTo(i+o,r+o),t.moveTo(-i,-r),t.lineTo(-i+o,-r+o),t.stroke()})}createBiasRLLinePattern(o,e,n,t){return this.createCommonPattern(o,e,n,t,(e,t)=>{t.strokeStyle=n,t.lineWidth=e,t.moveTo(o,0),t.lineTo(0,o);var i=o/2,r=i;t.moveTo(o+i,r),t.lineTo(i,r+o),t.moveTo(o-i,-r),t.lineTo(-i,-r+o),t.stroke()})}createGridPattern(e,o,n,t){return this.createCommonPattern(e,o,n,t,(e,t)=>{var i=o,r=i;t.fillStyle=n,t.fillRect(i,r,e,e),t.fillRect(i+e,r+e,e,e)})}initTextureMap(e,t){this.textureMap=new Map}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){this.textureMap||this.initTextureMap(t,e.stage);var{texture:g=s.texture,textureColor:p=s.textureColor,textureSize:f=s.textureSize,texturePadding:m=s.texturePadding}=e.attribute;g&&this.drawTexture(g,e,t,i,r,s,p,f,m)}drawTexture(e,t,i,r,o,n,a,l,s){let h=this.textureMap.get(e);if(!h)switch(e){case\\\"circle\\\":h=this.createCirclePattern(l,s,a,i);break;case\\\"diamond\\\":h=this.createDiamondPattern(l,s,a,i);break;case\\\"rect\\\":h=this.createRectPattern(l,s,a,i);break;case\\\"vertical-line\\\":h=this.createVerticalLinePattern(l,s,a,i);break;case\\\"horizontal-line\\\":h=this.createHorizontalLinePattern(l,s,a,i);break;case\\\"bias-lr\\\":h=this.createBiasLRLinePattern(l,s,a,i);break;case\\\"bias-rl\\\":h=this.createBiasRLLinePattern(l,s,a,i);break;case\\\"grid\\\":h=this.createGridPattern(l,s,a,i)}h&&(i.highPerformanceSave(),i.setCommonStyle(t,t.attribute,r,o,n),i.fillStyle=h,i.fill(),i.highPerformanceRestore())}}),defaultBaseTextureRenderContribution=new DefaultBaseTextureRenderContribution,DefaultArcRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(a,l,s,h,e,t,i,r,d,o,n,u){var{outerBorder:c,innerBorder:g}=a.attribute,p=c&&!1!==c.visible,f=g&&!1!==g.visible;if(!p&&!f)return;let{innerPadding:m=d.innerPadding,outerPadding:b=d.outerPadding,startAngle:C=d.startAngle,endAngle:v=d.endAngle,opacity:y=d.opacity,x:w=d.x,y:_=d.y,scaleX:S=d.scaleX,scaleY:x=d.scaleY,keepStrokeScale:R=d.keepStrokeScale}=a.attribute,{innerRadius:T=d.innerRadius,outerRadius:A=d.outerRadius}=a.attribute;A+=b,T-=m;var P=(e,t)=>{var i=!(!e||!e.stroke),{distance:r=d[t].distance}=e,o=R?r:getScaledStroke(l,r,l.dpr),r=r/A,n=\\\"outerBorder\\\"===t?1:-1;a.setAttributes({outerRadius:A+n*o,innerRadius:T-n*o,startAngle:C-n*r,endAngle:v+n*r}),l.beginPath(),drawArcPath(a,l,s,h,A+n*o,T-n*o),l.setShadowBlendStyle&&l.setShadowBlendStyle(a,a.attribute,d),u?u(l,e,d[t]):i&&(r=d[t].opacity,d[t].opacity=y,l.setStrokeStyle(a,e,(w-s)/S,(_-h)/x,d[t]),d[t].opacity=r,l.stroke())};p&&P(c,\\\"outerBorder\\\"),f&&P(g,\\\"innerBorder\\\"),a.setAttributes({outerRadius:A,innerRadius:T,startAngle:C,endAngle:v})}},defaultArcRenderContribution=new DefaultArcRenderContribution,defaultArcTextureRenderContribution=defaultBaseTextureRenderContribution,defaultArcBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,DefaultCircleRenderContribution=(init_esbuild_inject(),class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,a,l,s,e,t,i,r,h,o,d,u){var{outerBorder:c,innerBorder:g}=n.attribute,p=c&&!1!==c.visible,f=g&&!1!==g.visible;if(!p&&!f)return;let{radius:m=h.radius,startAngle:b=h.startAngle,endAngle:C=h.endAngle,opacity:v=h.opacity,x:y=h.x,y:w=h.y,scaleX:_=h.scaleX,scaleY:S=h.scaleY,keepStrokeScale:x=h.keepStrokeScale}=n.attribute,R=(e,t)=>{var i=!(!e||!e.stroke),{distance:r=h[t].distance}=e,r=x?r:getScaledStroke(a,r,a.dpr),o=\\\"outerBorder\\\"===t?1:-1;a.beginPath(),a.arc(l,s,m+o*r,b,C),a.closePath(),a.setShadowBlendStyle&&a.setShadowBlendStyle(n,n.attribute,h),u?u(a,e,h[t]):i&&(o=h[t].opacity,h[t].opacity=v,a.setStrokeStyle(n,e,(y-l)/_,(w-s)/S,h[t]),h[t].opacity=o,a.stroke())};p&&R(c,\\\"outerBorder\\\"),f&&R(g,\\\"innerBorder\\\")}}),defaultCircleRenderContribution=new DefaultCircleRenderContribution,defaultCircleTextureRenderContribution=defaultBaseTextureRenderContribution,defaultCircleBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,DefaultGroupBackgroundRenderContribution=(init_esbuild_inject(),class extends DefaultBaseBackgroundRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.beforeFillStroke}drawShape(e,t,i,r,o,n,a,l,s,h,d,u){var c,g,{background:p,backgroundMode:f=s.backgroundMode,backgroundFit:m=s.backgroundFit}=e.attribute;p&&(e.backgroundImg&&e.resources?\\\"success\\\"===(c=e.resources.get(p)).state&&c.data&&(t.highPerformanceSave(),t.setTransformFromMatrix(e.parent.globalTransMatrix,!0),g=e.AABBBounds,this.doDrawImage(t,c.data,g,f,m),t.highPerformanceRestore(),t.setTransformForCurrent()):(t.highPerformanceSave(),t.fillStyle=p,t.fill(),t.highPerformanceRestore()))}}),defaultGroupBackgroundRenderContribution=new DefaultGroupBackgroundRenderContribution,halfPi2=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),pi/2);function createRectPath(e,t,i,r,o,n,a){let l;if(r<0&&(t+=r,r=-r),o<0&&(i+=o,o=-o),isNumber_default(n,!0))l=[n=abs(n),n,n,n];else if(Array.isArray(n)){var s=n;let e,t;switch(s.length){case 0:l=[0,0,0,0];break;case 1:e=abs(s[0]),l=[e,e,e,e];break;case 2:case 3:e=abs(s[0]),t=abs(s[1]),l=[e,t,e,t];break;default:(l=s)[0]=abs(l[0]),l[1]=abs(l[1]),l[2]=abs(l[2]),l[3]=abs(l[3])}}else l=[0,0,0,0];var h,d,u,c,g,p,f,m,b;return r<0||l[0]+l[1]+l[2]+l[3]<1e-12?e.rect(t,i,r,o):(([u,m,p,g]=[[t,i],[t+r,i],[t+r,i+o],[t,i+o]]),h=Math.min(r/2,o/2),h=[Math.min(h,l[0]),Math.min(h,l[1]),Math.min(h,l[2]),Math.min(h,l[3])],d=[u[0]+h[0],u[1]],u=[u[0],u[1]+h[0]],f=[m[0]-h[1],m[1]],m=[m[0],m[1]+h[1]],b=[p[0]-h[2],p[1]],p=[p[0],p[1]-h[2]],c=[g[0]+h[3],g[1]],g=[g[0],g[1]-h[3]],e.moveTo(d[0],d[1]),a&&a[0]?a[0](d[0],d[1],f[0],f[1]):e.lineTo(f[0],f[1]),arrayEqual(f,m)||(a&&a[0]&&e.moveTo(f[0],f[1]),e.arc(f[0],f[1]+h[1],h[1],-halfPi2,0,!1)),a&&a[1]?a[1](m[0],m[1],p[0],p[1]):e.lineTo(p[0],p[1]),arrayEqual(b,p)||(f=p[0]-h[2],m=p[1],a&&a[1]&&e.moveTo(p[0],p[1]),e.arc(f,m,h[2],0,halfPi2,!1)),a&&a[2]?a[2](b[0],b[1],c[0],c[1]):e.lineTo(c[0],c[1]),arrayEqual(c,g)||(p=c[0],f=c[1]-h[3],a&&a[2]&&e.moveTo(c[0],c[1]),e.arc(p,f,h[3],halfPi2,pi,!1)),a&&a[3]?a[3](g[0],g[1],u[0],u[1]):e.lineTo(u[0],u[1]),arrayEqual(d,u)||(m=d[0],b=d[1]+h[0],a&&a[3]&&e.moveTo(u[0],u[1]),e.arc(m,b,h[0],pi,pi+halfPi2,!1)),a||e.closePath(),e)}var __decorate9=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},DefaultRectRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(l,s,h,d,e,t,i,r,u,o,n,c){var{outerBorder:a,innerBorder:g}=l.attribute,p=a&&!1!==a.visible,f=g&&!1!==g.visible;if(!p&&!f)return;let{cornerRadius:m=u.cornerRadius,opacity:b=u.opacity,x:C=u.x,y:v=u.y,scaleX:y=u.scaleX,scaleY:w=u.scaleY,x1:_,y1:S,keepStrokeScale:x=u.keepStrokeScale}=l.attribute,{width:R,height:T}=l.attribute;R=(null!=R?R:_-h)||0,T=(null!=T?T:S-d)||0;var A=(e,t)=>{var i=!(!e||!e.stroke),r=\\\"outerBorder\\\"===t?-1:1,{distance:o=u[t].distance}=e,o=x?o:getScaledStroke(s,o,s.dpr),n=h+r*o,a=d+r*o,o=2*o;0===m||isArray_default(m)&&m.every(e=>0===e)?(s.beginPath(),s.rect(n,a,R-r*o,T-r*o)):(s.beginPath(),createRectPath(s,n,a,R-r*o,T-r*o,m)),s.setShadowBlendStyle&&s.setShadowBlendStyle(l,l.attribute,u),c?c(s,e,u[t]):i&&(n=u[t].opacity,u[t].opacity=b,s.setStrokeStyle(l,e,(C-h)/y,(v-d)/w,u[t]),u[t].opacity=n,s.stroke())};p&&A(a,\\\"outerBorder\\\"),f&&A(g,\\\"innerBorder\\\")}},SplitRectBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var{stroke:g=s.stroke}=e.attribute;Array.isArray(g)&&g.some(e=>!1===e)&&(c.doStroke=!1)}},SplitRectBeforeRenderContribution=__decorate9([injectable()],SplitRectBeforeRenderContribution),SplitRectAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(l,s,h,d,e,t,i,r,u,o,n,a){let{x1:c,y1:g,x:p=u.x,y:f=u.y,stroke:m=u.stroke,cornerRadius:b=u.cornerRadius}=l.attribute;var C,{width:v,height:y}=l.attribute,v=(null!=v?v:c-p)||0,y=(null!=y?y:g-f)||0;if(Array.isArray(m)&&m.some(e=>!1===e))if(s.setStrokeStyle(l,l.attribute,h,d,u),0===b||isArray_default(b)&&b.every(e=>0===e))s.beginPath(),s.moveTo(h,d),m[0]?s.lineTo(h+v,d):s.moveTo(h+v,d),m[1]?s.lineTo(h+v,d+y):s.moveTo(h+v,d+y),m[2]?s.lineTo(h,d+y):s.moveTo(h,d+y),m[3]?(C=m[0]?d-s.lineWidth/2:d,s.lineTo(h,C)):s.moveTo(h,d),s.stroke();else{let n,a=0;createRectPath(s,h,d,v,y,b,new Array(4).fill(0).map((e,o)=>(e,t,i,r)=>{m[o]&&(a===o-1&&m[o]===n||(s.setStrokeStyle(l,Object.assign(Object.assign({},l.attribute),{stroke:m[o]}),h,d,u),s.beginPath(),s.moveTo(e,t),n=m[o]),a=o,s.lineTo(i,r),s.stroke(),3===o)&&s.beginPath()})),void s.stroke()}}},SplitRectAfterRenderContribution=__decorate9([injectable()],SplitRectAfterRenderContribution),defaultRectRenderContribution=new DefaultRectRenderContribution,defaultRectTextureRenderContribution=defaultBaseTextureRenderContribution,defaultRectBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,DefaultImageRenderContribution=class extends DefaultRectRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u){return super.drawShape(e,t,i,r,o,n,a,l,s,h,d,u)}},defaultImageRenderContribution=new DefaultImageRenderContribution,defaultImageBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,DefaultSymbolRenderContribution=(init_esbuild_inject(),class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,a,l,s,e,t,i,r,h,o,d,u){const c=n.getParsedPath();if(!c)return;var{outerBorder:g,innerBorder:p}=n.attribute,f=g&&!1!==g.visible,m=p&&!1!==p.visible;if(!f&&!m)return;let{size:b=h.size,opacity:C=h.opacity,x:v=h.x,y=h.y,scaleX:w=h.scaleX,scaleY:_=h.scaleY,keepStrokeScale:S=h.keepStrokeScale}=n.attribute,x=(e,t)=>{var i=!(!e||!e.stroke),{distance:r=h[t].distance}=e,r=S?r:getScaledStroke(a,r,a.dpr),o=\\\"outerBorder\\\"===t?1:-1;a.beginPath(),!1===c.drawOffset(a,b,l,s,o*r)&&a.closePath(),a.setShadowBlendStyle&&a.setShadowBlendStyle(n,n.attribute,h),u?u(a,e,h[t]):i&&(o=h[t].opacity,h[t].opacity=C,a.setStrokeStyle(n,e,(v-l)/w,(y-s)/_,h[t]),h[t].opacity=o,a.stroke())};f&&x(g,\\\"outerBorder\\\"),m&&x(p,\\\"innerBorder\\\")}}),defaultSymbolRenderContribution=new DefaultSymbolRenderContribution,defaultSymbolTextureRenderContribution=defaultBaseTextureRenderContribution,defaultSymbolBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,DefaultAreaTextureRenderContribution=(init_esbuild_inject(),class extends DefaultBaseTextureRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.afterFillStroke}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){this.textureMap||this.initTextureMap(t,e.stage);var{attribute:g=e.attribute}=c||{},{texture:g=null!=(g=e.attribute.texture)?g:getAttributeFromDefaultAttrList(s,\\\"texture\\\"),textureColor:p=null!=(p=e.attribute.textureColor)?p:getAttributeFromDefaultAttrList(s,\\\"textureColor\\\"),textureSize:f=null!=(f=e.attribute.textureSize)?f:getAttributeFromDefaultAttrList(s,\\\"textureSize\\\"),texturePadding:m=null!=(m=e.attribute.texturePadding)?m:getAttributeFromDefaultAttrList(s,\\\"texturePadding\\\")}=g;g&&this.drawTexture(g,e,t,i,r,s,p,f,m)}}),__decorate10=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata7=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param5=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasArcRender=class extends BaseRender{constructor(e){super(),this.arcRenderContribitions=e,this.numberType=ARC_NUMBER_TYPE,this.builtinContributions=[defaultArcRenderContribution,defaultArcBackgroundRenderContribution,defaultArcTextureRenderContribution],this.init(e)}drawArcTailCapPath(e,t,i,r,o,n,a,l){var s,h=l-a,d=e.getParsedAngle(),d=d.startAngle,u=(abs((s=l)-d),d<s);let c=!1;o<n&&(f=o,o=n,n=f);var g,p,{xors:f,yors:d,xirs:m,yirs:b,limitedOcr:C,outerCornerRadiusStart:v,outerCornerRadiusEnd:y,maxOuterCornerRadius:w,xore:_,yore:S,xire:x,yire:R,limitedIcr:T,innerDeltaAngle:A,innerStartAngle:P,innerCornerRadiusStart:B,innerCornerRadiusEnd:M,maxInnerCornerRadius:E}=calculateArcCornerRadius(e,d,s,n,o);return epsilon<C?(v=min(v,C),y=min(y,C),g=cornerTangents(m,b,f,d,o,v,Number(u)),p=cornerTangents(_,S,x,R,o,y,Number(u)),C<w&&v===y?(t.moveTo(i+g.cx+g.x01,r+g.cy+g.y01),t.arc(i+g.cx,r+g.cy,C,atan2(g.y01,g.x01),atan2(p.y01,p.x01),!u)):(w=s-h-.03,v=atan2(p.y11,p.x11),t.arc(i,r,o,w,v,!u),0<y&&t.arc(i+p.cx,r+p.cy,y,atan2(p.y11,p.x11),atan2(p.y01,p.x01),!u))):t.moveTo(i+f,r+d),!(epsilon<n)||A<.001?(t.lineTo(i+x,r+R),c=!0):epsilon<T?(C=min(B,T),w=cornerTangents(x,R,_,S,n,-(g=min(M,T)),Number(u)),v=cornerTangents(f,d,m,b,n,-C,Number(u)),t.lineTo(i+w.cx+w.x01,r+w.cy+w.y01),T<E&&C===g?(y=atan2(v.y01,v.x01),t.arc(i+w.cx,r+w.cy,T,atan2(w.y01,w.x01),y,!u)):(0<g&&t.arc(i+w.cx,r+w.cy,g,atan2(w.y01,w.x01),atan2(w.y11,w.x11),!u),p=atan2(w.cy+w.y11,w.cx+w.x11),t.arc(i,r,n,p,s-h-.03,u))):t.lineTo(i+n*cos(P),r+n*sin(P)),c}drawShape(o,n,a,l,s,e,h,d){let u=getTheme(o,null==e?void 0:e.theme).arc,{fill:t=u.fill,stroke:i=u.stroke,x:r=u.x,y:c=u.y,fillStrokeOrder:g=u.fillStrokeOrder}=o.attribute,p=this.valid(o,u,h,d);if(!p)return;let{fVisible:f,sVisible:m,doFill:b,doStroke:C}=p,{outerPadding:v=u.outerPadding,innerPadding:y=u.innerPadding,cap:w=u.cap,forceShowCap:_=u.forceShowCap}=o.attribute;var{outerRadius:S=u.outerRadius,innerRadius:x=u.innerRadius}=o.attribute;S+=v,x-=y;let R=0;var T,A=(isBoolean_default(w)&&w||w[0])&&\\\"conical\\\"===t.gradient;A&&(({sc:E,startAngle:T,endAngle:H}=o.getParsedAngle()),abs(H-T)<pi2-epsilon)&&(R=E||0,t.startAngle-=R,t.endAngle-=R);let P=!1,{isFullStroke:B,stroke:M}=parseStroke(i);if((b||B)&&(n.beginPath(),drawArcPath(o,n,a,l,S,x),P=!0,n.setShadowBlendStyle&&n.setShadowBlendStyle(o,o.attribute,u),this.beforeRenderStep(o,n,a,l,b,C,f,m,u,s,h,d),H=()=>{b&&(h?h(n,o.attribute,u):f&&(n.setCommonStyle(o,o.attribute,r-a,c-l,u),n.fill()))},T=()=>{C&&B&&(d?d(n,o.attribute,u):m&&(n.setStrokeStyle(o,o.attribute,r-a,c-l,u),n.stroke()))},(g?(T(),H):(H(),T))()),!B&&C&&(n.beginPath(),drawArcPath(o,n,a,l,S,x,M),P||this.beforeRenderStep(o,n,a,l,b,C,f,m,u,s,h,d),d?d(n,o.attribute,u):m&&(n.setStrokeStyle(o,o.attribute,a,l,u),n.stroke())),(isBoolean_default(w)&&w||w[1])&&_){var{startAngle:E,endAngle:H}=o.getParsedAngle();if(abs(H-E)>=pi2-epsilon){n.beginPath();let e=Math.abs(S-x)/2/S,{endAngle:t=u.endAngle,fill:i=u.fill}=o.attribute,r=t;this.drawArcTailCapPath(o,n,a,l,S,x,r,r+e),P||this.beforeRenderStep(o,n,a,l,b,C,f,m,u,s,h,d);b&&\\\"conical\\\"===(T=i).gradient&&(T=getConicGradientAt(0,0,t,T),h||fillVisible&&(n.setCommonStyle(o,o.attribute,a,l,u),n.fillStyle=T,n.fill())),C&&!d&&m&&(n.setStrokeStyle(o,o.attribute,a,l,u),n.stroke())}}this.afterRenderStep(o,n,a,l,b,C,f,m,u,s,h,d),A&&(t.startAngle+=R,t.endAngle+=R)}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).arc;this._draw(e,o,!1,i,r)}},DefaultCanvasArcRender=__decorate10([injectable(),__param5(0,inject(ContributionProvider)),__param5(0,named(ArcRenderContribution)),__metadata7(\\\"design:paramtypes\\\",[Object])],DefaultCanvasArcRender),__decorate11=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata8=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param6=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasCircleRender=class extends BaseRender{constructor(e){super(),this.circleRenderContribitions=e,this.numberType=CIRCLE_NUMBER_TYPE,this.builtinContributions=[defaultCircleRenderContribution,defaultCircleBackgroundRenderContribution,defaultCircleTextureRenderContribution],this.init(e)}drawShape(o,n,a,l,s,e,h,d){let u=getTheme(o,null==e?void 0:e.theme).circle,{radius:c=u.radius,startAngle:g=u.startAngle,endAngle:p=u.endAngle,x:f=u.x,y:m=u.y,fillStrokeOrder:b=u.fillStrokeOrder}=o.attribute,C=this.valid(o,u,h,d);if(C){let{fVisible:e,sVisible:t,doFill:i,doStroke:r}=C;n.beginPath(),n.arc(a,l,c,g,p),n.closePath(),n.setShadowBlendStyle&&n.setShadowBlendStyle(o,o.attribute,u),this.beforeRenderStep(o,n,a,l,i,r,e,t,u,s,h,d);var v=()=>{i&&(h?h(n,o.attribute,u):e&&(n.setCommonStyle(o,o.attribute,f-a,m-l,u),n.fill()))},y=()=>{r&&(d?d(n,o.attribute,u):t&&(n.setStrokeStyle(o,o.attribute,f-a,m-l,u),n.stroke()))};(b?(y(),v):(v(),y))(),this.afterRenderStep(o,n,a,l,i,r,e,t,u,s,h,d)}}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).circle;this._draw(e,o,!1,i,r)}};function drawSegItem(e,t,i,r){var o,n,a,l;t.p1&&(({offsetX:o=0,offsetY:n=0,offsetZ:a=0}=r||{}),1===i?t.p2&&t.p3?e.bezierCurveTo(o+t.p1.x,n+t.p1.y,o+t.p2.x,n+t.p2.y,o+t.p3.x,n+t.p3.y,a):e.lineTo(o+t.p1.x,n+t.p1.y,a):t.p2&&t.p3?(([l]=divideCubic(t,i)),e.bezierCurveTo(o+l.p1.x,n+l.p1.y,o+l.p2.x,n+l.p2.y,o+l.p3.x,n+l.p3.y,a)):(l=t.getPointAt(i),e.lineTo(o+l.x,n+l.y,a)))}function drawEachCurve(t,i,r,o,n,a,l){let s,h=i.p0,d=o;if(r&&r.originP1===r.originP2&&(h=r.p0),i.defined)o||(t.lineTo(h.x+n,h.y+a,l),d=!o);else{var{originP1:u,originP2:c}=i;let e;u&&!1!==u.defined&&!r?e=h:u&&!1!==c.defined&&(e=null!=(s=i.p3)?s:i.p1),o?(d=!o,u=(e||i.p0).x,c=(e||i.p0).y,t.moveTo(u+n,c+a,l)):e&&(d=!o,t.lineTo(e.x+n,e.y+a,l))}return d}function drawSegments(l,s,h,d,u){let{offsetX:c=0,offsetY:g=0,offsetZ:p=0,mode:e=\\\"none\\\",drawConnect:f=!1}=u||{};if((!f||\\\"none\\\"!==e)&&s){let a=!0;var m=s.curves;if(1<=h)if(f){let i,r=!0;m.forEach((e,t)=>{i=(e.originP1!==e.originP2&&(r=drawEachCurve(l,e,i,r,c,g,p)),e)})}else m.forEach(e=>{a=!e.defined||(a&&l.moveTo(e.p0.x+c,e.p0.y+g,p),drawSegItem(l,e,1,u),!1)});else if(!(h<=0)){let e;\\\"x\\\"===d?e=Direction.ROW:\\\"y\\\"===d?e=Direction.COLUMN:\\\"auto\\\"===d&&(e=s.direction);var b=h*s.tryUpdateLength(e);let t=0,i=!0,r=null;for(let o=0,n=m.length;o<n;o++){var C=m[o],v=C.getLength(e),y=(b-t)/v;if(t+=v,y<0)break;f?r=(C.originP1===C.originP2||(i=drawEachCurve(l,C,r,i,c,g,p)),C):a=!C.defined||(a&&l.moveTo(C.p0.x+c,C.p0.y+g,p),drawSegItem(l,C,min(y,1),u),!1)}}}}function drawIncrementalSegments(t,e,i,r){let{offsetX:o=0,offsetY:n=0}=r||{},a=e?e.points[e.points.length-1]:i.points[0];t.moveTo(a.x+o,a.y+n),i.points.forEach(e=>{!1!==e.defined?t.lineTo(e.x+o,e.y+n):t.moveTo(e.x+o,e.y+n)})}function drawIncrementalAreaSegments(l,s,e,t){let{offsetX:h=0,offsetY:d=0}=t||{},i=e.points,r=[],o=0;for(let n=0;n<i.length;n++)!1===i[n].defined&&(o+1!==n&&r.slice(o,n),o=n);r.push(i),r.forEach((e,t)=>{var i,r,o=s&&0===t?s.points[s.points.length-1]:e[0];l.moveTo(o.x+h,o.y+d),e.forEach(e=>{!1!==e.defined?l.lineTo(e.x+h,e.y+d):l.moveTo(e.x+h,e.y+d)});for(let a=e.length-1;0<=a;a--){var n=e[a];l.lineTo(null!=(i=n.x1)?i:n.x,null!=(i=n.y1)?i:n.y)}l.lineTo(null!=(r=o.x1)?r:o.x,null!=(r=o.y1)?r:o.y),l.closePath()})}DefaultCanvasCircleRender=__decorate11([injectable(),__param6(0,inject(ContributionProvider)),__param6(0,named(CircleRenderContribution)),__metadata8(\\\"design:paramtypes\\\",[Object])],DefaultCanvasCircleRender),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __decorate12=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},DefaultCanvasLineRender=class extends BaseRender{constructor(){super(...arguments),this.numberType=LINE_NUMBER_TYPE}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).line;this._draw(e,o,!1,i,r)}drawSegmentItem(o,n,a,l,s,h,d,u,c,g,p,f,m,b,C){var v;if(n){o.beginPath();var y=null!=(y=this.z)?y:0,{x:w=0,x:_=0}=(drawSegments(o.camera?o:o.nativeContext,n,c,g,{offsetX:p,offsetY:f,offsetZ:y}),m.cache&&!isArray_default(m.cache)&&m.cache.curves.every(e=>e.defined)&&m.attribute.curveType&&m.attribute.curveType.includes(\\\"Closed\\\")&&o.closePath(),o.setShadowBlendStyle&&o.setShadowBlendStyle(m,d,u),d);!1!==a&&(b?b(o,d,u):s&&(o.setCommonStyle(m,d,w-p,_-f,u),o.fill())),!1!==l&&(C?C(o,d,u):h&&(o.setStrokeStyle(m,d,w-p,_-f,u),o.stroke()));let{connectedType:e,connectedX:t,connectedY:i,connectedStyle:r}=d;if(r=isArray_default(u)?(e=null!=(v=null!=e?e:u[0].connectedType)?v:u[1].connectedType,t=null!=(v=null!=t?t:u[0].connectedX)?v:u[1].connectedX,i=null!=(v=null!=i?i:u[0].connectedY)?v:u[1].connectedY,null!=(v=null!=r?r:u[0].connectedStyle)?v:u[1].connectedStyle):(e=null!=e?e:u.connectedType,t=null!=t?t:u.connectedX,i=null!=i?i:u.connectedY,null!=r?r:u.connectedStyle),\\\"none\\\"!==(e=\\\"connect\\\"!==e&&\\\"zero\\\"!==e?\\\"none\\\":e)){o.beginPath(),drawSegments(o.camera?o:o.nativeContext,n,c,g,{offsetX:p,offsetY:f,offsetZ:y,drawConnect:!0,mode:e,zeroX:t,zeroY:i});const S=[];isArray_default(u)?u.forEach(e=>S.push(e)):S.push(u),S.push(d),!1!==a&&(b?b(o,d,u):s&&(o.setCommonStyle(m,r,w-p,_-f,S),o.fill())),!1!==l&&(C?C(o,d,u):h&&(o.setStrokeStyle(m,r,w-p,_-f,S),o.stroke()))}return!1}}drawLinearLineHighPerformance(e,t,i,r,o,n,a,l,s,h,d,u,c){t.beginPath();var g=null!=(f=this.z)?f:0,p=e.attribute.points,f=p[0];t.moveTo(f.x+a,f.y+l,g);for(let C=1;C<p.length;C++){var m=p[C];t.lineTo(m.x+a,m.y+l,g)}t.setShadowBlendStyle&&t.setShadowBlendStyle(e,e.attribute,s);var{x:f=0,x:b=0}=e.attribute;!1!==i&&(u?u(t,e.attribute,s):o&&(t.setCommonStyle(e,e.attribute,f-a,b-l,s),t.fill())),!1!==r&&(c?c(t,e.attribute,s):n&&(t.setStrokeStyle(e,e.attribute,f-a,b-l,s),t.stroke()))}drawShape(a,l,s,h,e,t,d,u){let c=getTheme(a,null==t?void 0:t.theme).line,{fill:g=c.fill,stroke:p=c.stroke,fillOpacity:f=c.fillOpacity,strokeOpacity:m=c.strokeOpacity,segments:i,points:r,closePath:o,curveTension:n=c.curveTension}=a.attribute;if(!this.valid(a,c,d,u))return;let{curveType:b=c.curveType}=a.attribute,{clipRange:C=c.clipRange,clipRangeByDimension:v=c.clipRangeByDimension}=(o&&\\\"linear\\\"===b&&(b=\\\"linearClosed\\\"),a.attribute);if(1===C&&!i&&!r.some(e=>!1===e.defined)&&\\\"linear\\\"===b)return this.drawLinearLineHighPerformance(a,l,!!g,!!p,f,m,s,h,c,e,t,d,u);if(a.shouldUpdateShape()){var{points:y,segments:w}=a.attribute,_=y;if(w&&w.length){let r,o;if(a.cache=w.map((e,t)=>{if(e.points.length<=1&&0===t)return e.points[0]&&(o={endX:e.points[0].x,endY:e.points[0].y,curves:[{defined:!1!==e.points[0].defined}]}),null;1===t?r={x:o.endX,y:o.endY,defined:o.curves[o.curves.length-1].defined}:1<t&&(r.x=o.endX,r.y=o.endY,r.defined=o.curves[o.curves.length-1].defined);var i=calcLineCache(e.points,b,{startPoint:r,curveTension:n});return o=i}).filter(e=>!!e),\\\"linearClosed\\\"===b){let t;for(let i=0;i<a.cache.length;i++){var S=a.cache[i];for(let e=0;e<S.curves.length;e++)if(S.curves[e].defined){t=S.curves[e].p0;break}if(t)break}a.cache[a.cache.length-1]&&a.cache[a.cache.length-1].lineTo(t.x,t.y,!0)}}else{if(!y||!y.length)return a.cache=null,void a.clearUpdateShapeTag();a.cache=calcLineCache(_,b,{curveTension:n})}a.clearUpdateShapeTag()}if(Array.isArray(a.cache)){const x=a.attribute.segments.filter(e=>e.points.length);if(1===x[0].points.length&&x.shift(),1===C){let i=!1;a.cache.forEach((e,t)=>{i=i||this.drawSegmentItem(l,e,!!g,!!p,f,m,x[t],[c,a.attribute],C,v,s,h,a,d,u)})}else{const R=a.cache.reduce((e,t)=>e+t.getLength(),0),T=C*R;let o=0,n=!1;a.cache.forEach((e,t)=>{var i,r;n||(i=e.getLength(),r=(T-o)/i,o+=i,0<r&&(n=this.drawSegmentItem(l,e,!!g,!!p,f,m,x[t],[c,a.attribute],min(r,1),v,s,h,a,d,u)))})}}else this.drawSegmentItem(l,a.cache,!!g,!!p,f,m,a.attribute,c,C,v,s,h,a,d,u)}};function drawAreaSegments(u,e,h,c){var{drawConnect:g=!1,mode:p=\\\"none\\\"}=c||{};if(!g||\\\"none\\\"!==p){let{top:r,bottom:d}=e;if(r.curves.length===d.curves.length)if(1<=h){const R=[],T=[];let i=!0;if(g){let t,s,h=!0;const A=r.curves.length;r.curves.forEach((i,e)=>{var r=d.curves[A-e-1];let o=i,n=r;if(i.originP1===i.originP2)t=i,s=r;else{if(t&&t.originP1===t.originP2&&(o=t,n=s),i.defined)h||(R.push(o),T.push(n),drawAreaConnectBlock(u,R,T,c),R.length=0,T.length=0,h=!h);else{var{originP1:a,originP2:l}=i;let e,t;a&&!1!==a.defined?(e=o,t=n):a&&!1!==l.defined&&(e=i,t=r),h?(h=!h,R.push(e||i),T.push(t||r)):e&&(h=!h,R.push(e||i),T.push(t||r),drawAreaConnectBlock(u,R,T,c),R.length=0,T.length=0)}t=i}}),drawAreaConnectBlock(u,R,T,c)}else{for(let e=0,t=r.curves.length;e<t;e++){var o=r.curves[e];i!==o.defined?(i?(drawAreaBlock(u,R,T,c),R.length=0,T.length=0):(R.push(o),T.push(d.curves[t-e-1])),i=!i):i&&(R.push(o),T.push(d.curves[t-e-1]))}drawAreaBlock(u,R,T,c)}}else if(!(h<=0)){let e=(c||{}).direction;var p=r.curves,f=null!=(f=p[p.length-1].p3)?f:p[p.length-1].p1,m=abs(f.x-p[0].p0.x),f=abs(f.y-p[0].p0.y),b=(e=null!=e?e:f<m?Direction.ROW:Direction.COLUMN,Number.isFinite(m)||(e=Direction.COLUMN),h*((e=Number.isFinite(f)?e:Direction.ROW)===Direction.ROW?m:f));let t=0,i=!0;var C=[],v=[];let o,n,a=!0;for(let l=0,s=r.curves.length;l<s;l++){var y=r.curves[l],w=y.getLength(e),_=(b-t)/w;if(_<0)break;if(t+=w,g){w=d.curves[s-l-1];let i=y,r=w;if(y.originP1===y.originP2)o=y,n=w;else{if(o&&o.originP1===o.originP2&&(i=o,r=n),y.defined)a||(C.push(i),v.push(r),drawAreaConnectBlock(u,C,v,c),v.length=C.length=0,a=!a);else{var{originP1:S,originP2:x}=y;let e,t;S&&!1!==S.defined?(e=i,t=r):S&&!1!==x.defined&&(e=y,t=w),a?(a=!a,C.push(e||y),v.push(t||w)):e&&(a=!a,C.push(e||y),v.push(t||w),drawAreaConnectBlock(u,C,v,c),v.length=C.length=0)}o=y}}else{let e=null,t=null;i!==y.defined?(i?(drawAreaBlock(u,C,v,c),v.length=C.length=0):(e=y,t=d.curves[s-l-1]),i=!i):i&&(e=y,t=d.curves[s-l-1]),e&&t&&(_<1&&(e=(e.p2&&e.p3?divideCubic:divideLinear)(e,_)[0],t=(t.p2&&t.p3?divideCubic:divideLinear)(t,1-_)[1]),e.defined=i,t.defined=i,C.push(e),v.push(t)),e=null,t=null}}(g?drawAreaConnectBlock:drawAreaBlock)(u,C,v,c)}}}function drawAreaConnectBlock(e,t,i,r){var o,n,a,l,s,h;t.length<2||(({offsetX:o=0,offsetY:n=0,offsetZ:a=0,mode:l}=r||{}),e.moveTo((s=t[0]).p0.x+o,s.p0.y+n,a),h=(s=t[t.length-1]).p3||s.p1,e.lineTo(h.x+o,h.y+n,a),s=i[i.length-1],e.lineTo(s.p0.x+o,s.p0.y+n,a),h=(s=i[0]).p3||s.p1,e.lineTo(h.x+o,h.y+n,a),e.closePath())}function drawAreaBlock(t,e,i,r){let{offsetX:o=0,offsetY:n=0,offsetZ:a=0}=r||{},l=!0;e.forEach(e=>{l=!e.defined||(l&&t.moveTo(e.p0.x+o,e.p0.y+n,a),drawSegItem(t,e,1,r),!1)}),l=!0;for(let h=i.length-1;0<=h;h--){var s=i[h];l=!s.defined||(l&&t.lineTo(s.p0.x+o,s.p0.y+n,a),drawSegItem(t,s,1,r),!1)}t.closePath()}DefaultCanvasLineRender=__decorate12([injectable()],DefaultCanvasLineRender),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var text,defaultAreaTextureRenderContribution=new DefaultAreaTextureRenderContribution,defaultAreaBackgroundRenderContribution=defaultBaseBackgroundRenderContribution,__decorate13=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata9=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param7=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasAreaRender=class extends BaseRender{constructor(e){super(),this.areaRenderContribitions=e,this.numberType=AREA_NUMBER_TYPE,this.builtinContributions=[defaultAreaTextureRenderContribution,defaultAreaBackgroundRenderContribution],this.init(e)}drawLinearAreaHighPerformance(e,t,i,r,o,n,a,l,s,h,d,u,c){let g,p,f,m=e.attribute.points;if(m.length<2)return;t.beginPath();const b=null!=(g=this.z)?g:0,C=m[0];t.moveTo(C.x+a,C.y+l,b);for(let A=1;A<m.length;A++){var v=m[A];t.lineTo(v.x+a,v.y+l,b)}for(let P=m.length-1;0<=P;P--){var y=m[P];t.lineTo((null!=(p=y.x1)?p:y.x)+a,(null!=(f=y.y1)?f:y.y)+l,b)}t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(e,e.attribute,s),this.beforeRenderStep(e,t,a,l,!!o,!1,i,!1,s,h,u,null,{attribute:e.attribute});let{x:w=0,x:_=0}=e.attribute;var S;if(!1!==i&&(u?u(t,e.attribute,s):o&&(t.setCommonStyle(e,e.attribute,w-a,_-l,s),t.fill())),this.afterRenderStep(e,t,a,l,!!o,!1,i,!1,s,h,u,null,{attribute:e.attribute}),r){var{stroke:x=s&&s.stroke}=e.attribute;if(isArray_default(x)&&(x[0]||x[2])&&!1===x[1])if(t.beginPath(),x[0]){t.moveTo(C.x+a,C.y+l,b);for(let e=1;e<m.length;e++){var R=m[e];t.lineTo(R.x+a,R.y+l,b)}}else if(x[2]){x=m[m.length-1];t.moveTo(x.x+a,x.y+l,b);for(let e=m.length-2;0<=e;e--){var T=m[e];t.lineTo((null!=(S=T.x1)?S:T.x)+a,(null!=(S=T.y1)?S:T.y)+l,b)}}c?c(t,e.attribute,s):(t.setStrokeStyle(e,e.attribute,w-a,_-l,s),t.stroke())}}drawShape(a,l,s,h,d,e,u,c){let i,n,g,p,t,r,f=getTheme(a,null==e?void 0:e.theme).area,{fill:F=f.fill,stroke:D=f.stroke,fillOpacity:m=f.fillOpacity,z:b=f.z,strokeOpacity:C=f.strokeOpacity,curveTension:v=f.curveTension}=a.attribute,o=this.valid(a,f,u,c);if(!o)return;let y=o.doFill,w=o.doStroke&&o.sVisible,{clipRange:_=f.clipRange,closePath:z,points:S,segments:x}=a.attribute,{curveType:R=f.curveType}=a.attribute;if(z&&\\\"linear\\\"===R&&(R=\\\"linearClosed\\\"),1===_&&!x&&!S.some(e=>!1===e.defined)&&\\\"linear\\\"===R)return this.drawLinearAreaHighPerformance(a,l,!!F,w,m,C,s,h,f,d,e,u,c);if(a.shouldUpdateShape()){if(x&&x.length){let r,o;const H=x.map((e,t)=>{if(e.points.length<=1&&0===t)return e.points[0]&&(o={endX:e.points[0].x,endY:e.points[0].y}),null;1===t?r={x:o.endX,y:o.endY}:1<t&&(r.x=o.endX,r.y=o.endY);var i=calcLineCache(e.points,R,{startPoint:r,curveTension:v});return o=i}).filter(e=>!!e);var T=[];for(let t=x.length-1;0<=t;t--){var A,P=x[t].points,B=[];for(let e=P.length-1;0<=e;e--)B.push({x:null!=(i=P[e].x1)?i:P[e].x,y:null!=(n=P[e].y1)?n:P[e].y});0!==t&&(A=(A=x[t-1].points)[A.length-1])&&B.push({x:null!=(g=A.x1)?g:A.x,y:null!=(p=A.y1)?p:A.y}),1<B.length&&(A=calcLineCache(B,\\\"stepBefore\\\"===R?\\\"stepAfter\\\":\\\"stepAfter\\\"===R?\\\"stepBefore\\\":R,{curveTension:v}),T.unshift(A))}a.cacheArea=T.map((e,t)=>({top:H[t],bottom:e}))}else{if(!S||!S.length)return a.cacheArea=null,void a.clearUpdateShapeTag();var M=S,E=[];for(let e=S.length-1;0<=e;e--)E.push({x:null!=(t=S[e].x1)?t:S[e].x,y:null!=(r=S[e].y1)?r:S[e].y});var M=calcLineCache(M,R,{curveTension:v}),O=calcLineCache(E,\\\"stepBefore\\\"===R?\\\"stepAfter\\\":\\\"stepAfter\\\"===R?\\\"stepBefore\\\":R,{curveTension:v});a.cacheArea={top:M,bottom:O}}a.clearUpdateShapeTag()}if(Array.isArray(a.cacheArea)){const I=a.attribute.segments.filter(e=>e.points.length);if(1===I[0].points.length&&I.shift(),1===_){let i=!1;a.cacheArea.forEach((e,t)=>{i=i||this.drawSegmentItem(l,e,y,m,w,C,I[t],[f,a.attribute],_,s,h,b,a,d,u,c)})}else{const L=a.cacheArea.reduce((e,t)=>e+t.top.getLength(),0),k=_*L;let o=0,n=!1;a.cacheArea.forEach((e,t)=>{var i,r;n||(i=e.top.getLength(),r=(k-o)/i,o+=i,0<r&&(n=this.drawSegmentItem(l,e,y,m,w,C,I[t],[f,a.attribute],min(r,1),s,h,b,a,d,u,c)))})}}else this.drawSegmentItem(l,a.cacheArea,y,m,w,C,a.attribute,f,_,s,h,b,a,d,u,c)}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).area;this._draw(e,o,!1,i,r)}drawSegmentItem(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p,f){return this._drawSegmentItem(e,t,i,r,o,n,a,l,s,h,d,u,c,g,!1,p,f)||this._drawSegmentItem(e,t,i,r,o,n,a,l,s,h,d,u,c,g,!0,p,f)}_drawSegmentItem(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p,f,m){if(!(t&&t.top&&t.bottom&&t.top.curves&&t.top.curves.length&&t.bottom.curves&&t.bottom.curves.length))return;let{connectedType:b,connectedX:C,connectedY:v,connectedStyle:y}=a;const w=[];if(p&&(y=isArray_default(l)?(b=null!=(_=null!=b?b:l[0].connectedType)?_:l[1].connectedType,C=null!=(_=null!=C?C:l[0].connectedX)?_:l[1].connectedX,v=null!=(_=null!=v?v:l[0].connectedY)?_:l[1].connectedY,null!=(_=null!=y?y:l[0].connectedStyle)?_:l[1].connectedStyle):(b=null!=b?b:l.connectedType,C=null!=C?C:l.connectedX,v=null!=v?v:l.connectedY,null!=y?y:l.connectedStyle),\\\"connect\\\"!==b&&\\\"zero\\\"!==b&&(b=\\\"none\\\"),isArray_default(l)?l.forEach(e=>w.push(e)):w.push(l),w.push(a)),p&&\\\"none\\\"===b)return!1;e.beginPath();var{points:_,segments:S}=c.attribute;let x,R,T=void Direction.ROW;x=S?(A=S[S.length-1],R=S[0].points[0],A.points[A.points.length-1]):(R=_[0],_[_.length-1]);var S=abs(x.x-R.x),A=abs(x.y-R.y);T=null==x.x1||null!=x.y1&&(!Number.isFinite(S+A)||A<S)?Direction.ROW:Direction.COLUMN,drawAreaSegments(e.camera?e:e.nativeContext,t,s,{offsetX:h,offsetY:d,offsetZ:u,direction:T,drawConnect:p,mode:b,zeroX:C,zeroY:v}),this.beforeRenderStep(c,e,h,d,!!r,!1,i,!1,l,g,f,null,{attribute:a}),e.setShadowBlendStyle&&e.setShadowBlendStyle(c,a,l);let{x:P=0,x:B=0}=a;return!1!==i&&(f?f(e,a,l):r&&(e.setCommonStyle(c,p?y:a,P-h,B-d,p?w:l),e.fill())),this.afterRenderStep(c,e,h,d,!!r,!1,i,!1,l,g,f,null,{attribute:a}),!1!==o&&(m?m(e,a,l):(({stroke:_=l&&l[1]&&l[1].stroke}=a),isArray_default(_)&&(_[0]||_[2])&&!1===_[1]&&(e.beginPath(),drawSegments(e.camera?e:e.nativeContext,_[0]?t.top:t.bottom,s,T===Direction.ROW?\\\"x\\\":\\\"y\\\",{offsetX:h,offsetY:d,offsetZ:u,drawConnect:p,mode:b,zeroX:C,zeroY:v})),e.setStrokeStyle(c,p?y:a,P-h,B-d,p?w:l),e.stroke())),!1}},DefaultCanvasAreaRender=__decorate13([injectable(),__param7(0,inject(ContributionProvider)),__param7(0,named(AreaRenderContribution)),__metadata9(\\\"design:paramtypes\\\",[Object])],DefaultCanvasAreaRender),__decorate14=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata10=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param8=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasRectRender=class extends BaseRender{constructor(e){super(),this.rectRenderContribitions=e,this.type=\\\"rect\\\",this.numberType=RECT_NUMBER_TYPE,this.builtinContributions=[defaultRectRenderContribution,defaultRectBackgroundRenderContribution,defaultRectTextureRenderContribution],this.init(e)}drawShape(e,t,i,r,o,n,a,l){let s,h=null!=(s=this.tempTheme)?s:getTheme(e,null==n?void 0:n.theme).rect,{fill:d=h.fill,background:u,stroke:c=h.stroke,cornerRadius:g=h.cornerRadius,opacity:p=h.opacity,fillOpacity:f=h.fillOpacity,lineWidth:m=h.lineWidth,strokeOpacity:b=h.strokeOpacity,visible:C=h.visible,x1:v,y1:y,x:w=h.x,y:_=h.y,fillStrokeOrder:S=h.fillStrokeOrder}=e.attribute;var{width:x,height:R}=e.attribute;const T=rectFillVisible(p,f,x=(null!=x?x:v-w)||0,R=(null!=R?R:y-_)||0,d),A=rectStrokeVisible(p,b,x,R),P=runFill(d,u),B=runStroke(c,m);if(e.valid&&C&&(P||B)&&(T||A||a||l||u)){0===g||isArray_default(g)&&g.every(e=>0===e)?(t.beginPath(),t.rect(i,r,x,R)):(t.beginPath(),createRectPath(t,i,r,x,R,g));const M={doFill:P,doStroke:B};t.setShadowBlendStyle&&t.setShadowBlendStyle(e,e.attribute,h),this.beforeRenderStep(e,t,i,r,P,B,T,A,h,o,a,l,M);x=()=>{M.doFill&&(a?a(t,e.attribute,h):T&&(t.setCommonStyle(e,e.attribute,w-i,_-r,h),t.fill()))},R=()=>{M.doStroke&&(l?l(t,e.attribute,h):A&&(t.setStrokeStyle(e,e.attribute,w-i,_-r,h),t.stroke()))};(S?(R(),x):(x(),R))(),this.afterRenderStep(e,t,i,r,P,B,T,A,h,o,a,l)}}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).rect;this.tempTheme=o,this._draw(e,o,!1,i,r),this.tempTheme=null}},DefaultCanvasRectRender=__decorate14([injectable(),__param8(0,inject(ContributionProvider)),__param8(0,named(RectRenderContribution)),__metadata10(\\\"design:paramtypes\\\",[Object])],DefaultCanvasRectRender),__decorate15=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata11=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param9=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasSymbolRender=class extends BaseRender{constructor(e){super(),this.symbolRenderContribitions=e,this.numberType=SYMBOL_NUMBER_TYPE,this.builtinContributions=[defaultSymbolRenderContribution,defaultSymbolBackgroundRenderContribution,defaultSymbolTextureRenderContribution],this.init(e)}drawShape(n,a,l,s,h,e,d,u){let c,g=getTheme(n,null==e?void 0:e.theme).symbol,{size:p=g.size,x:f=g.x,y:m=g.y,scaleX:b=g.scaleX,scaleY:C=g.scaleY,fillStrokeOrder:v=g.fillStrokeOrder}=n.attribute,y=this.valid(n,g,d,u);if(y){let{fVisible:e,sVisible:t,doFill:i,doStroke:r}=y,o=n.getParsedPath();var w,_,S,x;o&&(({keepDirIn3d:S=g.keepDirIn3d}=n.attribute),w=null!=(c=this.z)?c:0,a.beginPath(),_=(e,t)=>{n._parsedPath.svgCache&&((r=Object.assign({},t)).fill=null!=(i=t.fill)?i:n.attribute.fill,r.opacity=null!=(i=t.opacity)?i:n.attribute.opacity,r.fillOpacity=n.attribute.fillOpacity,r.stroke=null!=(i=t.stroke)?i:n.attribute.stroke,t=r);var i=()=>{t.fill&&(d?d(a,n.attribute,g):(a.setCommonStyle(n,t,f-l,m-s,g),a.fill()))},r=()=>{t.stroke&&(u?u(a,n.attribute,g):(a.setStrokeStyle(n,t,(f-l)/b,(m-s)/C,g),a.stroke()))};(v?(r(),i):(i(),r))()},S&&a.camera&&a.project?(S=a.project(l,s,w),x=a.camera,a.camera=null,!1===o.draw(a,isArray_default(p)?[p[0]*b,p[1]*C]:p*b,S.x,S.y,void 0,_)&&a.closePath(),a.camera=x):!1===o.draw(a,p,l,s,w,_)&&a.closePath(),a.setShadowBlendStyle&&a.setShadowBlendStyle(n,n.attribute,g),this.beforeRenderStep(n,a,l,s,i,r,e,t,g,h,d,u),S=()=>{i&&!o.isSvg&&(d?d(a,n.attribute,g):e&&(a.setCommonStyle(n,n.attribute,f-l,m-s,g),a.fill()))},x=()=>{r&&!o.isSvg&&(u?u(a,n.attribute,g):t&&(a.setStrokeStyle(n,n.attribute,(f-l)/b,(m-s)/C,g),a.stroke()))},(v?(x(),S):(S(),x))(),this.afterRenderStep(n,a,l,s,i,r,e,t,g,h,d,u))}}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).symbol;this._draw(e,o,!1,i,r)}},DefaultCanvasSymbolRender=__decorate15([injectable(),__param9(0,inject(ContributionProvider)),__param9(0,named(SymbolRenderContribution)),__metadata11(\\\"design:paramtypes\\\",[Object])],DefaultCanvasSymbolRender),BoundsAllocate=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"BoundsAllocate\\\")),DefaultBoundsAllocate=class{constructor(){this.pools=[];for(let e=0;e<10;e++)this.pools.push(new AABBBounds)}allocate(e,t,i,r){var o;return this.pools.length?((o=this.pools.pop()).x1=e,o.y1=t,o.x2=i,o.y2=r,o):(new AABBBounds).setValue(e,t,i,r)}allocateByObj(e){var t;return this.pools.length?((t=this.pools.pop()).x1=e.x1,t.y1=e.y1,t.x2=e.x2,t.y2=e.y2,t):new AABBBounds(e)}free(e){this.pools.push(e)}get length(){return this.pools.length}release(){this.pools=[]}},boundsAllocate=new DefaultBoundsAllocate,GraphicCreator2=(init_esbuild_inject(),init_esbuild_inject(),class{constructor(){this.store=new Map}RegisterGraphicCreator(e,t){this.store.set(e,t),this[e]=t}CreateGraphic(e,t){var i=this.store.get(e);return i?i(t):null}}),graphicCreator=new GraphicCreator2;function getTextBounds(e){return(text=text||graphicCreator.CreateGraphic(\\\"text\\\",{})).initAttributes(e),text.AABBBounds}var DefaultTextBackgroundRenderContribution=class extends DefaultBaseBackgroundRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.beforeFillStroke}drawShape(t,i,r,o,e,n,a,l,s,h,d,u){var{backgroundMode:c=s.backgroundMode,backgroundFit:g=s.backgroundFit}=t.attribute;let p,f=t.attribute.background;if(f){var m=()=>{\\\"richtext\\\"===t.type&&(i.restore(),i.save(),p)&&i.setTransformFromMatrix(p,!0,1)};let e;\\\"richtext\\\"===t.type&&(p=i.currentMatrix.clone(),i.restore(),i.save(),i.setTransformForCurrent());var b,C,v,y=isObject_default(f)&&f.background,w=t.transMatrix.onlyTranslate();if(y?(C=t.AABBBounds,v=(null!=(v=f.x)?v:C.x1)+(null!=(v=f.dx)?v:0),_=(null!=(_=f.y)?_:C.y1)+(null!=(_=f.dy)?_:0),b=null!=(b=f.width)?b:C.width(),S=null!=(S=f.height)?S:C.height(),e=boundsAllocate.allocate(v,_,v+b,_+S),f=f.background,w||(C=e.width(),v=e.height(),e.set((null!=(b=f.x)?b:0)+(null!=(_=f.dx)?_:0),(null!=(S=f.y)?S:0)+(null!=(b=f.dy)?b:0),C,v))):(e=t.AABBBounds,w||(e=getTextBounds(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone())),t.backgroundImg&&t.resources){var _=t.resources.get(f);if(\\\"success\\\"!==_.state||!_.data)return void m();i.highPerformanceSave(),w&&i.setTransformFromMatrix(t.parent.globalTransMatrix,!0),i.setCommonStyle(t,t.attribute,r,o,s),this.doDrawImage(i,_.data,e,c,g),i.highPerformanceRestore(),i.setTransformForCurrent()}else{var S=t.attribute.backgroundCornerRadius;i.highPerformanceSave(),i.setCommonStyle(t,t.attribute,r,o,s),i.fillStyle=f,S?(createRectPath(i,e.x1,e.y1,e.width(),e.height(),S),i.fill()):i.fillRect(e.x1,e.y1,e.width(),e.height()),i.highPerformanceRestore()}y&&boundsAllocate.free(e),m()}}},defaultTextBackgroundRenderContribution=new DefaultTextBackgroundRenderContribution,__decorate16=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata12=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param10=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasTextRender=class extends BaseRender{constructor(e){super(),this.textRenderContribitions=e,this.numberType=TEXT_NUMBER_TYPE,this.builtinContributions=[defaultTextBackgroundRenderContribution],this.init(e)}drawShape(g,p,f,m,t,e,b,C){let i,o,n,v=getTheme(g,null==e?void 0:e.theme).text,{underline:r=v.underline,lineThrough:a=v.lineThrough,keepDirIn3d:l=v.keepDirIn3d,direction:y=v.direction,fontSize:w=v.fontSize,verticalMode:_=v.verticalMode,x:S=v.x,y:x=v.y}=g.attribute,R=null!=(i=calculateLineHeight(g.attribute.lineHeight,w))?i:w,T=this.valid(g,v,b,C);if(T){let{fVisible:s,sVisible:h,doFill:d,doStroke:u}=T,e=!l,c=this.z||0;p.beginPath(),p.setShadowBlendStyle&&p.setShadowBlendStyle(g,g.attribute,v),this.beforeRenderStep(g,p,f,m,d,u,s,h,v,t,b,C),e&&this.transformUseContext2d(g,v,c,p);if(p.setTextStyleWithoutAlignBaseline(g.attribute,v,c),\\\"horizontal\\\"===y){var A=g.multilineLayout;if(!A)return void p.highPerformanceRestore();let{xOffset:t,yOffset:i}=A.bbox;u&&(C?C(p,g.attribute,v):h&&(p.setStrokeStyle(g,g.attribute,S-f,x-m,v),A.lines.forEach(e=>{p.strokeText(e.str,(e.leftOffset||0)+t+f,(e.topOffset||0)+i+m,c)}))),d&&(b?b(p,g.attribute,v):s&&(p.setCommonStyle(g,g.attribute,S-f,x-m,v),A.lines.forEach(e=>{p.fillText(e.str,(e.leftOffset||0)+t+f,(e.topOffset||0)+i+m,c),this.drawUnderLine(r,a,g,(e.leftOffset||0)+t+f,(e.topOffset||0)+i+m,e.descent,(e.descent-e.ascent)/2,c,v,p,{width:e.width})})))}else{let{textAlign:i=v.textAlign,textBaseline:e=v.textBaseline}=g.attribute;_||(A=i,i=null!=(o=g.getBaselineMapAlign()[e])?o:\\\"left\\\",e=null!=(n=g.getAlignMapBaseline()[A])?n:\\\"top\\\"),g.tryUpdateAABBBounds();A=g.cache,A=A.verticalList;p.textAlign=\\\"left\\\",p.textBaseline=\\\"top\\\";const P=R*A.length;let r=0,a=(A.forEach(e=>{var t=e.reduce((e,t)=>e+(t.width||0),0);r=max(t,r)}),0),l=0;\\\"bottom\\\"===e?l=-P:\\\"middle\\\"===e&&(l=-P/2),\\\"center\\\"===i?a-=r/2:\\\"right\\\"===i&&(a-=r),A.forEach((e,o)=>{var t=e.reduce((e,t)=>e+(t.width||0),0),t=r-t;let n=a;\\\"center\\\"===i?n+=t/2:\\\"right\\\"===i&&(n+=t),e.forEach(e=>{var{text:t,width:i,direction:r}=e;((e,t,i,r)=>{let o=f+t;var n,a=m+i;r&&(p.highPerformanceSave(),o+=w,(n=matrixAllocate.allocate(1,0,0,1,0,0)).rotateByCenter(Math.PI/2,o,a),p.transformFromMatrix(n,!0),matrixAllocate.free(n)),u&&(C?C(p,g.attribute,v):h&&(p.setStrokeStyle(g,g.attribute,S-f,x-m,v),p.strokeText(e,o,a,c))),d&&(b?b(p,g.attribute,v):s&&(p.setCommonStyle(g,g.attribute,S-f,x-m,v),p.fillText(e,o,a,c))),r&&(p.highPerformanceRestore(),p.setTransformForCurrent())})(t,P-(o+1)*R+l,n,r),n+=i})})}e&&this.restoreTransformUseContext2d(g,v,c,p),this.afterRenderStep(g,p,f,m,d,u,s,h,v,t,b,C)}}draw(e,t,i,r){var o=getTheme(e,null==r?void 0:r.theme).text,{keepDirIn3d:n=o.keepDirIn3d}=e.attribute;this._draw(e,o,!n,i,r)}drawUnderLine(e,t,i,r,o,n,a,l,s,h,d){var u,c,g,p,f,m,b,C;t+e<=0||(({textAlign:m=s.textAlign,fill:b=s.fill,opacity:C=s.opacity,underlineOffset:u=s.underlineOffset,underlineDash:c=s.underlineDash,fillOpacity:g=s.fillOpacity}=i.attribute),p=(f=!isNil_default(d))?d.width:i.clipedWidth,f=f?0:textDrawOffsetX(m,p),m={lineWidth:0,stroke:b,opacity:C,strokeOpacity:g},e&&(m.lineWidth=e,h.setStrokeStyle(i,m,r,o,s),c&&h.setLineDash(c),h.beginPath(),h.moveTo(r+f,b=o+n+u,l),h.lineTo(r+f+p,b,l),h.stroke()),t&&(m.lineWidth=t,h.setStrokeStyle(i,m,r,o,s),h.beginPath(),h.moveTo(r+f,C=o+a,l),h.lineTo(r+f+p,C,l),h.stroke()))}},DefaultCanvasTextRender=__decorate16([injectable(),__param10(0,inject(ContributionProvider)),__param10(0,named(TextRenderContribution)),__metadata12(\\\"design:paramtypes\\\",[Object])],DefaultCanvasTextRender),__decorate17=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata13=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param11=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasGroupRender=class{constructor(e){this.groupRenderContribitions=e,this.numberType=GROUP_NUMBER_TYPE}drawShape(t,i,r,o,n,a,l,s){let h=getTheme(t,null==a?void 0:a.theme).group,{fill:e=h.fill,background:d,stroke:u=h.stroke,opacity:c=h.opacity,width:g=h.width,height:p=h.height,clip:f=h.clip,fillOpacity:m=h.fillOpacity,strokeOpacity:b=h.strokeOpacity,cornerRadius:C=h.cornerRadius,path:v=h.path,lineWidth:y=h.lineWidth,visible:w=h.visible,fillStrokeOrder:_=h.fillStrokeOrder,x:S=h.x,y:x=h.y}=t.attribute,R=rectFillVisible(c,m,g,p,e),T=rectStrokeVisible(c,b,g,p),A=runFill(e,d),P=runStroke(u,y);if(t.valid&&w){if(!f){if(!A&&!P)return;if(!(R||T||l||s||d))return}var B;v&&v.length&&n.drawContribution?(M=i.disableFill,E=i.disableStroke,B=i.disableBeginPath,i.disableFill=!0,i.disableStroke=!0,i.disableBeginPath=!0,v.forEach(e=>{n.drawContribution.getRenderContribution(e).draw(e,n.renderService,n,a)}),i.disableFill=M,i.disableStroke=E,i.disableBeginPath=B):0===C||isArray_default(C)&&C.every(e=>0===e)?(i.beginPath(),i.rect(r,o,g,p)):(i.beginPath(),createRectPath(i,r,o,g,p,C)),this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(defaultGroupBackgroundRenderContribution));const H={doFill:A,doStroke:P};this._groupRenderContribitions.forEach(e=>{e.time===BaseRenderContributionTime.beforeFillStroke&&e.drawShape(t,i,r,o,A,P,R,T,h,n,l,s,H)}),f&&i.clip(),i.setShadowBlendStyle&&i.setShadowBlendStyle(t,t.attribute,h);var M=()=>{H.doFill&&(l?l(i,t.attribute,h):R&&(i.setCommonStyle(t,t.attribute,S-r,x-o,h),i.fill()))},E=()=>{H.doStroke&&(s?s(i,t.attribute,h):T&&(i.setStrokeStyle(t,t.attribute,S-r,x-o,h),i.stroke()))};(_?(E(),M):(M(),E))(),this._groupRenderContribitions.forEach(e=>{e.time===BaseRenderContributionTime.afterFillStroke&&e.drawShape(t,i,r,o,A,P,R,T,h,n,l,s)})}}draw(e,t,i,r){let o=i.context;if(!o)return;let{clip:n,baseOpacity:a=1}=e.attribute;n?o.save():o.highPerformanceSave();var l=o.baseGlobalAlpha,s=(o.baseGlobalAlpha*=a,getTheme(e,null==r?void 0:r.theme).group),h=o.modelMatrix,{scrollX:d=s.scrollX,scrollY:u=s.scrollY}=(o.camera?(d=mat4Allocate.allocate(),getModelMatrix(u=mat4Allocate.allocate(),e,s),multiplyMat4Mat4(d,h||d,u),o.modelMatrix=d,mat4Allocate.free(u),o.setTransform(1,0,0,1,0,0,!0)):o.transformFromMatrix(e.transMatrix,!0),o.beginPath(),r.skipDraw?this.drawShape(e,o,0,0,i,r,()=>!1,()=>!1):this.drawShape(e,o,0,0,i),e.attribute);let c;(d||u)&&o.translate(d,u),r&&r.drawingCb&&(c=r.drawingCb()),o.modelMatrix!==h&&mat4Allocate.free(o.modelMatrix),o.modelMatrix=h,o.baseGlobalAlpha=l,c&&c.then?c.then(()=>{n?o.restore():o.highPerformanceRestore()}):n?o.restore():o.highPerformanceRestore()}},DefaultCanvasGroupRender=__decorate17([injectable(),__param11(0,inject(ContributionProvider)),__param11(0,named(GroupRenderContribution)),__metadata13(\\\"design:paramtypes\\\",[Object])],DefaultCanvasGroupRender),__decorate18=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata14=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param12=function(i,r){return function(e,t){r(e,t,i)}},repeatStr=[\\\"\\\",\\\"repeat-x\\\",\\\"repeat-y\\\",\\\"repeat\\\"],DefaultCanvasImageRender=class extends BaseRender{constructor(e){super(),this.imageRenderContribitions=e,this.numberType=IMAGE_NUMBER_TYPE,this.builtinContributions=[defaultImageRenderContribution,defaultImageBackgroundRenderContribution],this.init(e)}drawShape(n,a,l,s,h,e,d,u){let c=getTheme(n).image,{width:g=c.width,height:p=c.height,repeatX:f=c.repeatX,repeatY:m=c.repeatY,x:b=c.x,y:C=c.y,cornerRadius:v=c.cornerRadius,fillStrokeOrder:y=c.fillStrokeOrder,image:w}=n.attribute,_=this.valid(n,c,d);if(_){let{fVisible:i,sVisible:t,doFill:r,doStroke:o}=_;if(w&&n.resources){const R=n.resources.get(w);if(\\\"success\\\"===R.state){let e=!1;0===v||isArray_default(v)&&v.every(e=>0===e)||(a.beginPath(),createRectPath(a,l,s,g,p,v),e=!0),a.setShadowBlendStyle&&a.setShadowBlendStyle(n,n.attribute,c);var S=()=>{if(r)if(d)d(a,n.attribute,c);else if(i){a.setCommonStyle(n,n.attribute,l,s,c);let e=0;var t;\\\"repeat\\\"===f&&(e|=1),\\\"repeat\\\"===m&&(e|=2),e?(t=a.createPattern(R.data,repeatStr[e]),a.fillStyle=t,a.translate(l,s,!0),a.fillRect(0,0,g,p),a.translate(-l,-s,!0)):a.drawImage(R.data,l,s,g,p)}},x=()=>{o&&(u?u(a,n.attribute,c):t&&(a.setStrokeStyle(n,n.attribute,b-l,C-s,c),a.stroke()))};y?(x(),e&&(a.save(),a.clip()),this.beforeRenderStep(n,a,l,s,r,!1,i,!1,c,h,d),S(),e&&a.restore()):(e&&(a.save(),a.clip()),this.beforeRenderStep(n,a,l,s,r,!1,i,!1,c,h,d),S(),e&&a.restore(),x()),this.afterRenderStep(n,a,l,s,r,!1,i,!1,c,h,d)}}}}draw(e,t,i){var r,o=e.attribute.image;o&&e.resources&&(\\\"loading\\\"===(r=e.resources.get(o)).state&&isString_default(o)?ResourceLoader.improveImageLoading(o):\\\"success\\\"===r.state&&(o=t.drawParams.context,o)&&(r=getTheme(e).image,this._draw(e,r,!1,i)))}},DefaultCanvasImageRender=__decorate18([injectable(),__param12(0,inject(ContributionProvider)),__param12(0,named(ImageRenderContribution)),__metadata14(\\\"design:paramtypes\\\",[Object])],DefaultCanvasImageRender),IncrementalDrawContribution=(init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"IncrementalDrawContribution\\\")),ArcRender=Symbol[\\\"for\\\"](\\\"ArcRender\\\"),Arc3dRender=Symbol[\\\"for\\\"](\\\"Arc3dRender\\\"),AreaRender=Symbol[\\\"for\\\"](\\\"AreaRender\\\"),CircleRender=Symbol[\\\"for\\\"](\\\"CircleRender\\\"),GraphicRender=Symbol[\\\"for\\\"](\\\"GraphicRender\\\"),GroupRender=Symbol[\\\"for\\\"](\\\"GroupRender\\\"),LineRender=Symbol[\\\"for\\\"](\\\"LineRender\\\"),PathRender=Symbol[\\\"for\\\"](\\\"PathRender\\\"),PolygonRender=Symbol[\\\"for\\\"](\\\"PolygonRender\\\"),RectRender=Symbol[\\\"for\\\"](\\\"RectRender\\\"),Rect3DRender=Symbol[\\\"for\\\"](\\\"Rect3DRender\\\"),SymbolRender=Symbol[\\\"for\\\"](\\\"SymbolRender\\\"),TextRender=Symbol[\\\"for\\\"](\\\"TextRender\\\"),RichTextRender=Symbol[\\\"for\\\"](\\\"RichTextRender\\\"),Pyramid3dRender=Symbol[\\\"for\\\"](\\\"Pyramid3dRender\\\"),GlyphRender=Symbol[\\\"for\\\"](\\\"GlyphRender\\\"),ImageRender=Symbol[\\\"for\\\"](\\\"ImageRender\\\"),RenderSelector=Symbol[\\\"for\\\"](\\\"RenderSelector\\\"),DrawContribution=Symbol[\\\"for\\\"](\\\"DrawContribution\\\"),draw3dItem=(init_esbuild_inject(),init_esbuild_inject(),(r,t,e,i)=>{let o,n=!1,a=!1;var l,s;return t.forEachChildren(e=>!(n=e.numberType===ARC3D_NUMBER_TYPE)),t.forEachChildren(e=>!(a=!!e.findFace)),n?((l=[...s=t.getChildren()]).sort((e,t)=>{let i,r,o,n,a=(null!=(r=null!=(i=e.attribute.startAngle)?i:0+e.attribute.endAngle)?r:0)/2,l=(null!=(n=null!=(o=t.attribute.startAngle)?o:0+t.attribute.endAngle)?n:0)/2;for(;a<0;)a+=pi2;for(;l<0;)l+=pi2;return l-a}),l.forEach(e=>{e._next=null,e._prev=null}),t.removeAllChild(),t.update(),l.forEach(e=>{t.appendChild(e)}),i.hack_pieFace=\\\"outside\\\",(o=e(n,a))&&o.graphic||(i.hack_pieFace=\\\"inside\\\",o=e(n,a)),o&&o.graphic||(i.hack_pieFace=\\\"top\\\",o=e(n,a)),t.removeAllChild(),s.forEach(e=>{e._next=null,e._prev=null}),s.forEach(e=>{t.appendChild(e)})):a?((s=(l=t.getChildren()).map(i=>({ave_z:i.findFace().vertices.map(e=>{var t;return r.view(e[0],e[1],null!==(t=e[2]+i.attribute.z)?t:0)[2]}).reduce((e,t)=>e+t,0),g:i}))).sort((e,t)=>t.ave_z-e.ave_z),t.removeAllChild(),s.forEach(e=>{e.g._next=null,e.g._prev=null}),t.update(),s.forEach(e=>{t.add(e.g)}),o=e(n,a),t.removeAllChild(),l.forEach(e=>{e._next=null,e._prev=null}),t.update(),l.forEach(e=>{t.add(e)})):o=e(n,a),o}),__decorate19=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata15=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DrawItemInterceptor=Symbol[\\\"for\\\"](\\\"DrawItemInterceptor\\\"),tempDirtyBounds=new AABBBounds,tempBackupDirtyBounds=new AABBBounds,ShadowRootDrawItemInterceptorContribution=class{constructor(){this.order=1}afterDrawItem(e,t,i,r,o){return null==e.attribute.shadowRootIdx&&e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx<0||(0<e.attribute.shadowRootIdx||!e.attribute.shadowRootIdx||e.shadowRoot&&0<e.shadowRoot.attribute.shadowRootIdx)&&this.drawItem(e,t,i,r,o),!1}beforeDrawItem(e,t,i,r,o){return null==e.attribute.shadowRootIdx&&e.shadowRoot&&0<e.shadowRoot.attribute.shadowRootIdx||(e.attribute.shadowRootIdx<0||e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(e,t,i,r,o),!1}drawItem(e,t,i,r,o){var n,a;return!!e.shadowRoot&&(n=i.context,n.highPerformanceSave(),n.transformFromMatrix(e.transMatrix,!0),r.dirtyBounds&&r.backupDirtyBounds&&(tempDirtyBounds.copy(r.dirtyBounds),tempBackupDirtyBounds.copy(r.backupDirtyBounds),a=e.globalTransMatrix.getInverse(),r.dirtyBounds.copy(r.backupDirtyBounds).transformWithMatrix(a),r.backupDirtyBounds.copy(r.dirtyBounds)),r.renderGroup(e.shadowRoot,i,matrixAllocate.allocate(1,0,0,1,0,0)),n.highPerformanceRestore(),r.dirtyBounds&&r.backupDirtyBounds&&(r.dirtyBounds.copy(tempDirtyBounds),r.backupDirtyBounds.copy(tempBackupDirtyBounds)),!0)}},DebugDrawItemInterceptorContribution=class{constructor(){this.order=1}afterDrawItem(e,t,i,r,o){return e.attribute._debug_bounds&&this.drawItem(e,t,i,r,o),!1}drawItem(e,t,i,r,o){var n,a;return!!e.attribute._debug_bounds&&(n=i.context,n.highPerformanceSave(),e.parent&&n.setTransformFromMatrix(e.parent.globalTransMatrix,!0),e.glyphHost&&e.glyphHost.parent&&n.setTransformFromMatrix(e.glyphHost.parent.globalTransMatrix,!0),a=e.AABBBounds,!0!==e.attribute._debug_bounds&&e.attribute._debug_bounds(n,e),n.strokeRect(a.x1,a.y1,a.width(),a.height()),n.highPerformanceRestore(),!0)}},CommonDrawItemInterceptorContribution=class{constructor(){this.order=1,this.interceptors=[new ShadowRootDrawItemInterceptorContribution,new Canvas3DDrawItemInterceptor,new InteractiveDrawItemInterceptorContribution,new DebugDrawItemInterceptorContribution]}afterDrawItem(e,t,i,r,o){for(let n=0;n<this.interceptors.length;n++)if(this.interceptors[n].afterDrawItem&&this.interceptors[n].afterDrawItem(e,t,i,r,o))return!0;return!1}beforeDrawItem(t,i,r,o,n){if(t.in3dMode&&!r.in3dInterceptor||t.shadowRoot||(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))for(let e=0;e<this.interceptors.length;e++)if(this.interceptors[e].beforeDrawItem&&this.interceptors[e].beforeDrawItem(t,i,r,o,n))return!0;return!1}},CommonDrawItemInterceptorContribution=__decorate19([injectable(),__metadata15(\\\"design:paramtypes\\\",[])],CommonDrawItemInterceptorContribution),InteractiveDrawItemInterceptorContribution=class{constructor(){this.order=1}beforeDrawItem(e,t,i,r,o){return!this.processing&&(e.baseGraphic?this.beforeDrawInteractive(e,t,i,r,o):this.beforeSetInteractive(e,t,i,r,o))}beforeSetInteractive(e,t,i,r,o){let n=e.interactiveGraphic;var a;return e.attribute.globalZIndex?(n||(n=e.clone(),(e.interactiveGraphic=n).baseGraphic=e),n.setAttributes({globalZIndex:0,zIndex:e.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),i.stage.tryInitInteractiveLayer(),(a=i.stage.getLayer(\\\"_builtin_interactive\\\"))&&this.getShadowRoot(a).add(n),!0):(n&&(i.stage.tryInitInteractiveLayer(),(a=i.stage.getLayer(\\\"_builtin_interactive\\\"))&&this.getShadowRoot(a).removeChild(n),e.interactiveGraphic=null,n.baseGraphic=null),!1)}beforeDrawInteractive(e,t,i,r,o){var n,a=e.baseGraphic;let l=!!a.stage,s=a.parent;for(;l&&s&&s.stage!==s;)l=!!s.stage,s=s.parent;return l?!(!a||(this.processing=!0,n=i.context,n.highPerformanceSave(),n.setTransformFromMatrix(a.parent.globalTransMatrix,!0),a.isContainer?r.renderGroup(a,i,a.parent.globalTransMatrix):r.renderItem(a,i),n.highPerformanceRestore(),this.processing=!1)):((a=i.stage.getLayer(\\\"_builtin_interactive\\\"))&&this.getShadowRoot(a).removeChild(e),!0)}getShadowRoot(e){let t,i=e.getElementById(\\\"_interactive_group\\\");return i||((i=graphicCreator.CreateGraphic(\\\"group\\\",{})).id=\\\"_interactive_group\\\",e.add(i)),null!=(t=i.shadowRoot)?t:i.attachShadow()}},Canvas3DDrawItemInterceptor=class{constructor(){this.order=1}beforeDrawItem(i,e,r,o,t){if(!i.in3dMode||r.in3dInterceptor)return!1;r.in3dInterceptor=!0;var n,{context:a,stage:l}=e.drawParams,l=(a.canvas,a.save(),this.initCanvasCtx(a),a.camera=l.camera,a.currentMatrix),s=(l.a/=a.dpr,l.b/=a.dpr,l.c/=a.dpr,l.d/=a.dpr,l.e/=a.dpr,l.f/=a.dpr,mat4Allocate.allocate()),l=(mat3Tomat4(s,l),a.modelMatrix);return l?s&&(n=mat4Allocate.allocate(),a.modelMatrix=multiplyMat4Mat4(n,l,s)):a.modelMatrix=s,a.setTransform(1,0,0,1,0,0,!0),i.isContainer?draw3dItem(a,i,(e,t)=>o.renderGroup(i,r,i.parent.globalTransMatrix,!e&&t),r):o.renderItem(i,r),a.camera=null,a.restore(),a.modelMatrix!==l&&mat4Allocate.free(a.modelMatrix),a.modelMatrix=l,!(r.in3dInterceptor=!1)}initCanvasCtx(e){e.setTransformForCurrent()}},__decorate20=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata16=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param13=function(i,r){return function(e,t){r(e,t,i)}},RenderService=Symbol[\\\"for\\\"](\\\"RenderService\\\"),BeforeRenderConstribution=Symbol[\\\"for\\\"](\\\"BeforeRenderConstribution\\\"),DefaultRenderService=class{constructor(e){this.drawContribution=e}prepare(t){t&&this.renderTreeRoots.forEach(e=>{this._prepare(e,t)})}_prepare(e,t){e.forEachChildren(e=>{this._prepare(e,t)}),e.update({bounds:t,trans:!0})}prepareRenderList(){}beforeDraw(e){}draw(e){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(e){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}render(e,t){this.renderTreeRoots=e;var i=(this.drawParams=t).updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(t),this.draw(t),this.afterDraw(t),this.drawParams=null}},DefaultRenderService=__decorate20([injectable(),__param13(0,inject(DrawContribution)),__metadata16(\\\"design:paramtypes\\\",[Object])],DefaultRenderService),render_modules_default=new ContainerModule(e=>{e(RenderService).to(DefaultRenderService)}),GraphicPicker=(init_esbuild_inject(),init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"GraphicPicker\\\")),PickerService=Symbol[\\\"for\\\"](\\\"PickerService\\\"),BoundsPicker=Symbol[\\\"for\\\"](\\\"BoundsPicker\\\"),GlobalPickerService=Symbol[\\\"for\\\"](\\\"GlobalPickerService\\\"),updateBoundsOfCommonOuterBorder=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),(e,t,i)=>{var r,{outerBorder:o,shadowBlur:n=t.shadowBlur}=e;return o&&(r=t.outerBorder,({distance:o=r.distance,lineWidth:r=r.lineWidth}=o),i.expand(o+(n+r)/2)),i}),CIRCLE_UPDATE_TAG_KEY=[\\\"radius\\\",\\\"startAngle\\\",\\\"endAngle\\\",...GRAPHIC_UPDATE_TAG_KEY],Circle=class iTa extends Graphic{constructor(e={radius:1}){super(e),this.type=\\\"circle\\\",this.numberType=CIRCLE_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){var{startAngle:e,endAngle:t,radius:i}=this.attribute;return this._validNumber(e)&&this._validNumber(t)&&this._validNumber(i)}getGraphicTheme(){return getTheme(this).circle}updateAABBBounds(e,t,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateCircleAABBBoundsImprecise(e,t,i):this.updateCircleAABBBoundsAccurate(e,t,i));var{tb1:o,tb2:n}=application.graphicService.updateTempAABBBounds(i);return updateBoundsOfCommonOuterBorder(e,t,o),i.union(o),o.setValue(n.x1,n.y1,n.x2,n.y2),application.graphicService.transformAABBBounds(e,i,t,!1,this),i}updateCircleAABBBoundsImprecise(e,t,i){var{radius:r=t.radius}=e;return i.set(-r,-r,r,r),i}updateCircleAABBBoundsAccurate(e,t,i){var{startAngle:r=t.startAngle,endAngle:o=t.endAngle,radius:n=t.radius}=e;return pi2-epsilon<o-r?i.set(-n,-n,n,n):circleBounds(r,o,n,i),i}needUpdateTags(e){return super.needUpdateTags(e,CIRCLE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,CIRCLE_UPDATE_TAG_KEY)}toCustomPath(){var e=this.attribute,t=null!=(t=e.radius)?t:this.getDefaultAttribute(\\\"radius\\\"),i=null!=(i=e.startAngle)?i:this.getDefaultAttribute(\\\"startAngle\\\"),e=null!=(e=e.endAngle)?e:this.getDefaultAttribute(\\\"endAngle\\\"),r=new CustomPath2D;return r.arc(0,0,t,i,e),r}clone(){return new iTa(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return iTa.NOWORK_ANIMATE_ATTR}};function createCircle(e){return new Circle(e)}Circle.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR,init_esbuild_inject(),init_esbuild_inject();var CanvasTextLayout=class{constructor(e,t,i){this.fontFamily=e,this.textOptions=t,this.textMeasure=i}LayoutBBox(t,e,i,r){if(t.xOffset=\\\"left\\\"===e||\\\"start\\\"===e?0:\\\"center\\\"===e?t.width/-2:\\\"right\\\"===e||\\\"end\\\"===e?-t.width:0,\\\"top\\\"===i)t.yOffset=0;else if(\\\"middle\\\"===i)t.yOffset=t.height/-2;else if(\\\"alphabetic\\\"===i){let e=.79;var o;1===r.length&&(o=r[0],e=o.ascent/(o.ascent+o.descent)),t.yOffset=t.height*-e}else t.yOffset=-t.height;return t}GetLayoutByLines(n,e,t,i,r=\\\"\\\",o,a){var{lineWidth:l,suffixPosition:s=\\\"end\\\",measureMode:h=MeasureModeEnum.actualBounding,keepCenterInLine:d=!1}=null!=a?a:{},u=(n=n.map(e=>e.toString()),[]),c=[0,0];if(\\\"number\\\"==typeof l&&l!==1/0){let t;for(let i=0,e=n.length;i<e;i++){var g,p=this.textMeasure.measureTextPixelADscentAndWidth(n[i],this.textOptions,h);let e=n[i].toString();t=(p.width>l?(g=this.textMeasure.clipTextWithSuffix(n[i],this.textOptions,l,r,o,s),e=g.str,g):p).width,u.push({str:e,width:t,ascent:p.ascent,descent:p.descent,keepCenterInLine:d})}c[0]=l}else{let e,t,i=0;for(let r=0,o=n.length;r<o;r++){t=n[r];var f=this.textMeasure.measureTextPixelADscentAndWidth(n[r],this.textOptions,h);e=f.width,i=Math.max(i,e),u.push({str:t,width:e,ascent:f.ascent,descent:f.descent,keepCenterInLine:d})}c[0]=i}c[1]=u.length*i,c[0]=u.reduce((e,t)=>Math.max(e,t.width),0);c={xOffset:0,yOffset:0,width:c[0],height:c[1]};return this.LayoutBBox(c,e,t,u),this.layoutWithBBox(c,u,e,t,i)}layoutWithBBox(e,t,i,r,o){var n=[0,0],a=t.length*o;\\\"top\\\"!==r&&(\\\"middle\\\"===r?n[1]=(e.height-a)/2:\\\"bottom\\\"===r&&(n[1]=e.height-a));for(let l=0;l<t.length;l++)this.lineOffset(e,t[l],i,r,o,n);return{bbox:e,lines:t,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:o,textAlign:i,textBaseline:r}}lineOffset(e,t,i,r,o,n){var a;return\\\"left\\\"===i||\\\"start\\\"===i?t.leftOffset=0:\\\"center\\\"===i?t.leftOffset=(e.width-t.width)/2:\\\"right\\\"!==i&&\\\"end\\\"!==i||(t.leftOffset=e.width-t.width),t.topOffset=o/2+(t.ascent-t.descent)/2+n[1],t.keepCenterInLine||((a=t.ascent+t.descent+0)<+o&&(\\\"bottom\\\"===r?t.topOffset+=(o-a)/2:\\\"top\\\"===r&&(t.topOffset-=(o-a)/2)),\\\"alphabetic\\\"===r&&(a=o/(t.ascent+t.descent),t.topOffset=o/2+(t.ascent-t.descent)/2*a+n[1])),n[1]+=o,t}},TEXT_UPDATE_TAG_KEY=[\\\"text\\\",\\\"maxLineWidth\\\",\\\"maxWidth\\\",\\\"textAlign\\\",\\\"textBaseline\\\",\\\"heightLimit\\\",\\\"lineClamp\\\",\\\"fontSize\\\",\\\"fontFamily\\\",\\\"fontWeight\\\",\\\"ellipsis\\\",\\\"lineHeight\\\",\\\"direction\\\",\\\"wordBreak\\\",\\\"heightLimit\\\",\\\"lineClamp\\\",...GRAPHIC_UPDATE_TAG_KEY],Text=class PUa extends Graphic{get font(){var e=this.getGraphicTheme();return this._font||(this._font=getContextFont(this.attribute,e)),this._font}get clipedText(){var e=this.attribute,t=this.getGraphicTheme(),i=this.getMaxWidth(t);return Number.isFinite(i)?(this.tryUpdateAABBBounds(),this.cache.clipedText):(null!=(i=e.text)?i:t.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var e,i=this.getGraphicTheme(),t=this.attribute,i=this.getMaxWidth(i);if(!Number.isFinite(i))return!1;i=this.attribute.text;if(this.tryUpdateAABBBounds(),null!=(e=null==(e=this.cache)?void 0:e.layoutData)&&e.lines){let t=\\\"\\\";return this.cache.layoutData.lines.forEach(e=>{t+=e.str}),(Array.isArray(i)?i.join(\\\"\\\"):i)!==t}return\\\"vertical\\\"===t.direction&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(e=>e.text).join(\\\"\\\")!==t.text.toString():null!=this.clipedText&&this.clipedText!==t.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||\\\"normal\\\"===this.attribute.whiteSpace}constructor(e={text:\\\"\\\",fontSize:16}){super(e),this.type=\\\"text\\\",this.numberType=TEXT_NUMBER_TYPE,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){var e=this.attribute.text;return isArray_default(e)?!e.every(e=>null==e||\\\"\\\"===e):null!=e&&\\\"\\\"!==e}getGraphicTheme(){return getTheme(this).text}doUpdateOBBBounds(){var e,t,i,r=this.getGraphicTheme(),o=(this._OBBBounds.clear(),this.attribute),{angle:r=r.angle}=o;return r?(this.obbText||(this.obbText=new PUa({})),this.obbText.setAttributes(Object.assign(Object.assign({},o),{angle:0})),({x:o,y:t}=o),o=rotatePoint(i={x:((e=this.obbText.AABBBounds).x1+e.x2)/2,y:(e.y1+e.y2)/2},r,{x:o,y:t}),this._OBBBounds.copy(e),this._OBBBounds.translate(o.x-i.x,o.y-i.y),this._OBBBounds.angle=r):(t=this.AABBBounds,this._OBBBounds.setValue(t.x1,t.y1,t.x2,t.y2)),this._OBBBounds}updateAABBBounds(e,t,i){var{text:r=t.text}=this.attribute,r=(Array.isArray(r)?this.updateMultilineAABBBounds(r):this.updateSingallineAABBBounds(r),application.graphicService.updateTempAABBBounds(i)).tb1,{scaleX:o=t.scaleX,scaleY:n=t.scaleY,shadowBlur:a=t.shadowBlur,strokeBoundsBuffer:l=t.strokeBoundsBuffer}=e;return a&&(boundStroke(r,a/Math.abs(o+n),!0,l),i.union(r)),application.graphicService.combindShadowAABBBounds(i,this),null==e.forceBoundsHeight&&null==e.forceBoundsWidth||application.graphicService.updateHTMLTextAABBBounds(e,t,i),transformBoundsWithMatrix(i,i,this.transMatrix),i}updateSingallineAABBBounds(e){this.updateMultilineAABBBounds([e]);var t=this.cache.layoutData;return t&&t.lines&&t.lines.length&&(t=t.lines[0],this.cache.clipedText=t.str,this.cache.clipedWidth=t.width),this._AABBBounds}updateMultilineAABBBounds(e){var t=this.getGraphicTheme(),{direction:i=t.direction,underlineOffset:t=t.underlineOffset}=this.attribute,r=\\\"horizontal\\\"===i?this.updateHorizontalMultilineAABBBounds(e):this.updateVerticalMultilineAABBBounds(e);return\\\"horizontal\\\"===i&&t&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+t),r}guessLineHeightBuf(e){return e?.1*e:0}updateHorizontalMultilineAABBBounds(e){var t=this.getGraphicTheme(),i=this.attribute,{fontFamily:r=t.fontFamily,textAlign:o=t.textAlign,textBaseline:n=t.textBaseline,fontSize:a=t.fontSize,fontWeight:l=t.fontWeight,ellipsis:s=t.ellipsis,maxLineWidth:h,stroke:d=t.stroke,wrap:u=t.wrap,measureMode:c=t.measureMode,lineWidth:g=t.lineWidth,whiteSpace:p=t.whiteSpace,suffixPosition:f=t.suffixPosition,ignoreBuf:m=t.ignoreBuf,keepCenterInLine:b=t.keepCenterInLine}=i,m=m?0:this.guessLineHeightBuf(a),i=this.getLineHeight(i,t,m);return\\\"normal\\\"===p||u?this.updateWrapAABBBounds(e):(!this.shouldUpdateShape()&&null!=(m=this.cache)&&m.layoutData?p=this.cache.layoutData.bbox:(u=application.graphicUtil.textMeasure,p=(m=new CanvasTextLayout(r,{fontSize:a,fontWeight:l,fontFamily:r,lineHeight:i},u).GetLayoutByLines(e,o,n,i,!0===s?t.ellipsis:s||void 0,!1,{lineWidth:h,suffixPosition:f,measureMode:c,keepCenterInLine:b})).bbox,this.cache.layoutData=m,this.clearUpdateShapeTag()),this._AABBBounds.set(p.xOffset,p.yOffset,p.xOffset+p.width,p.yOffset+p.height),d&&this._AABBBounds.expand(g/2),this._AABBBounds)}updateWrapAABBBounds(e){var t=this.getGraphicTheme(),{fontFamily:i=t.fontFamily,textAlign:r=t.textAlign,textBaseline:o=t.textBaseline,fontSize:a=t.fontSize,ellipsis:l=t.ellipsis,maxLineWidth:s,stroke:n=t.stroke,lineWidth:h=t.lineWidth,wordBreak:d=t.wordBreak,fontWeight:u=t.fontWeight,ignoreBuf:c=t.ignoreBuf,measureMode:g=t.measureMode,suffixPosition:p=t.suffixPosition,heightLimit:f=0,lineClamp:m,keepCenterInLine:b=t.keepCenterInLine}=this.attribute,c=c?0:this.guessLineHeightBuf(a),t=this.getLineHeight(this.attribute,t,c);if(!this.shouldUpdateShape()&&null!=(c=this.cache)&&c.layoutData)c=this.cache.layoutData.bbox,this._AABBBounds.set(c.xOffset,c.yOffset,c.xOffset+c.width,c.yOffset+c.height);else{var C=application.graphicUtil.textMeasure,v={fontSize:a,fontWeight:u,fontFamily:i,lineHeight:t},c=new CanvasTextLayout(i,v,C),y=isArray_default(e)?e.map(e=>e.toString()):[e.toString()],w=[],a=[0,0];let n=1/0;if(0<f&&(n=Math.max(Math.floor(f/t),1)),m&&(n=Math.min(n,m)),\\\"number\\\"==typeof s&&s!==1/0){if(0<s)for(let i=0;i<y.length;i++){var _=y[i];let e=!0;if(i===n-1){var S=C.clipTextWithSuffix(_,v,s,l,!1,p,i!==y.length-1),x=C.measureTextPixelADscentAndWidth(S.str,v,g);w.push({str:S.str,width:S.width,ascent:x.ascent,descent:x.descent,keepCenterInLine:b});break}var S=C.clipText(_,v,s,\\\"break-all\\\"!==d,\\\"keep-all\\\"===d),R=((\\\"\\\"!==_&&\\\"\\\"===S.str||S.wordBreaked)&&(l?(x=C.clipTextWithSuffix(_,v,s,l,!1,p),S.str=null!=(R=x.str)?R:\\\"\\\",S.width=null!=(R=x.width)?R:0):(S.str=\\\"\\\",S.width=0),e=!1),C.measureTextPixelADscentAndWidth(S.str,v,g));w.push({str:S.str,width:S.width,ascent:R.ascent,descent:R.descent,keepCenterInLine:b});let t=S.str.length;if(!S.wordBreaked||\\\"\\\"!==_&&\\\"\\\"===S.str||(e=!0,t=S.wordBreaked),S.str.length!==_.length&&e){let e=_.substring(t);\\\"keep-all\\\"===d&&(e=e.replace(/^\\\\s+/g,\\\"\\\")),y.splice(i+1,0,e)}}let t=0;w.forEach(e=>{t=Math.max(t,e.width)}),a[0]=t}else{let e,t,i=0;for(let r=0,o=y.length;r<o;r++){if(r===n-1){var T=C.clipTextWithSuffix(y[r],v,s,l,!1,p),A=C.measureTextPixelADscentAndWidth(T.str,v,g);w.push({str:T.str,width:T.width,ascent:A.ascent,descent:A.descent,keepCenterInLine:b}),i=Math.max(i,T.width);break}t=y[r],e=C.measureTextWidth(t,v),i=Math.max(i,e);A=C.measureTextPixelADscentAndWidth(t,v,g);w.push({str:t,width:e,ascent:A.ascent,descent:A.descent,keepCenterInLine:b})}a[0]=i}a[1]=w.length*t,c.LayoutBBox(u={xOffset:0,yOffset:0,width:a[0],height:a[1]},r,o,w),i=c.layoutWithBBox(u,w,r,o,t),this.cache.layoutData=i,this.clearUpdateShapeTag(),this._AABBBounds.set(u.xOffset,u.yOffset,u.xOffset+u.width,u.yOffset+u.height)}return n&&this._AABBBounds.expand(h/2),this._AABBBounds}updateVerticalMultilineAABBBounds(e){const r=this.getGraphicTheme(),o=application.graphicUtil.textMeasure;let n,t=this.attribute,{maxLineWidth:a=r.maxLineWidth,ellipsis:l=r.ellipsis,fontFamily:s=r.fontFamily,fontSize:h=r.fontSize,fontWeight:d=r.fontWeight,stroke:i=r.stroke,lineWidth:u=r.lineWidth,verticalMode:c=r.verticalMode,suffixPosition:g=r.suffixPosition}=t,p=this.getLineHeight(t,r,0),{textAlign:f=r.textAlign,textBaseline:m=r.textBaseline}=t;if(c||(v=f,f=null!=(C=PUa.baselineMapAlign[m])?C:\\\"left\\\",m=null!=(C=PUa.alignMapBaseline[v])?C:\\\"top\\\"),n=0,!this.shouldUpdateShape()&&this.cache)this.cache.verticalList.forEach(e=>{var t=e.reduce((e,t)=>e+t.width,0);n=max(t,n)}),v=textDrawOffsetX(f,n),C=this.cache.verticalList.length*p,b=textLayoutOffsetY(m,C,h),this._AABBBounds.set(b,v,b+C,v+n);else{const y=e.map(e=>verticalLayout(e.toString()));y.forEach((e,t)=>{var i;Number.isFinite(a)?n=(l?(i=!0===l?r.ellipsis:l,i=o.clipTextWithSuffixVertical(e,{fontSize:h,fontWeight:d,fontFamily:s},a,i,!1,g),y[t]=i.verticalList,i):(i=o.clipTextVertical(e,{fontSize:h,fontWeight:d,fontFamily:s},a,!1),y[t]=i.verticalList,i)).width:(n=0,e.forEach(e=>{var t=e.direction===TextDirection.HORIZONTAL?h:o.measureTextWidth(e.text,{fontSize:h,fontWeight:d,fontFamily:s});n+=t,e.width=t}))}),this.cache.verticalList=y,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(e=>{var t=e.reduce((e,t)=>e+t.width,0);n=max(t,n)});var b=textDrawOffsetX(f,n),C=this.cache.verticalList.length*p,v=textLayoutOffsetY(m,C,h);this._AABBBounds.set(v,b,v+C,b+n)}return i&&this._AABBBounds.expand(u/2),this._AABBBounds}getMaxWidth(e){var t,i=this.attribute;return null!=(t=null!=(t=i.maxLineWidth)?t:i.maxWidth)?t:e.maxWidth}getLineHeight(e,t,i){var r;return null!=(r=calculateLineHeight(e.lineHeight,e.fontSize||t.fontSize))?r:(e.fontSize||t.fontSize)+i}needUpdateTags(e,t=TEXT_UPDATE_TAG_KEY){return super.needUpdateTags(e,t)}needUpdateTag(e,t=TEXT_UPDATE_TAG_KEY){return super.needUpdateTag(e,t)}clone(){return new PUa(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return PUa.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return PUa.baselineMapAlign}getAlignMapBaseline(){return PUa.alignMapBaseline}};function createText(e){return new Text(e)}Text.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},NOWORK_ANIMATE_ATTR),Text.baselineMapAlign={top:\\\"left\\\",bottom:\\\"right\\\",middle:\\\"center\\\"},Text.alignMapBaseline={left:\\\"top\\\",right:\\\"bottom\\\",center:\\\"middle\\\"},init_esbuild_inject();var WRAP_TEXT_UPDATE_TAG_KEY=[\\\"heightLimit\\\",\\\"lineClamp\\\"],WrapText=class gYa extends Text{constructor(e){super(Object.assign(Object.assign({},e),{wrap:!0}))}_isValid(){var e=this.attribute.text;return isArray_default(e)?!e.every(e=>null==e||\\\"\\\"===e):null!=e&&\\\"\\\"!==e}updateMultilineAABBBounds(e){var i,t=this.getGraphicTheme(),{fontFamily:r=t.fontFamily,textAlign:o=t.textAlign,textBaseline:a=t.textBaseline,fontSize:l=t.fontSize,ellipsis:s=t.ellipsis,maxLineWidth:h,stroke:n=t.stroke,lineWidth:d=t.lineWidth,wordBreak:u=t.wordBreak,fontWeight:c=t.fontWeight,ignoreBuf:g=t.ignoreBuf,heightLimit:p=0,suffixPosition:f=t.suffixPosition,lineClamp:m}=this.attribute,b=null!=(b=calculateLineHeight(this.attribute.lineHeight,this.attribute.fontSize||t.fontSize))?b:this.attribute.fontSize||t.fontSize,t=g?0:2;if(!this.shouldUpdateShape()&&null!=(g=this.cache)&&g.layoutData)g=this.cache.layoutData.bbox,this._AABBBounds.set(g.xOffset,g.yOffset,g.xOffset+g.width,g.yOffset+g.height);else{var g=application.graphicUtil.textMeasure,C=new CanvasTextLayout(r,{fontSize:l,fontWeight:c,fontFamily:r},g),v=e.map(e=>e.toString()),y=[],l=[0,0];let n=1/0;if(0<p&&(n=Math.max(Math.floor(p/b),1)),m&&(n=Math.min(n,m)),\\\"number\\\"==typeof h&&h!==1/0){if(0<h)for(let t=0;t<v.length;t++){var w=v[t];let e=!0;if(t===n-1){var _=C.textMeasure.clipTextWithSuffix(w,C.textOptions,h,s,!1,f);y.push({str:_.str,width:_.width,ascent:0,descent:0,keepCenterInLine:!1});break}var S,_=C.textMeasure.clipText(w,C.textOptions,h,\\\"break-word\\\"===u);\\\"\\\"!==w&&\\\"\\\"===_.str&&(s?(S=C.textMeasure.clipTextWithSuffix(w,C.textOptions,h,s,!1,f),_.str=null!=(i=S.str)?i:\\\"\\\",_.width=null!=(i=S.width)?i:0):(_.str=\\\"\\\",_.width=0),e=!1),y.push({str:_.str,width:_.width,ascent:0,descent:0,keepCenterInLine:!1}),_.str.length!==w.length&&e&&(S=w.substring(_.str.length),v.splice(t+1,0,S))}let t=0;y.forEach(e=>{t=Math.max(t,e.width)}),l[0]=t}else{let e,t,i=0;for(let r=0,o=v.length;r<o;r++){if(r===n-1){var x=C.textMeasure.clipTextWithSuffix(v[r],C.textOptions,h,s,!1,f);y.push({str:x.str,width:x.width,ascent:0,descent:0,keepCenterInLine:!1}),i=Math.max(i,x.width);break}t=v[r],e=C.textMeasure.measureTextWidth(t,C.textOptions,\\\"break-word\\\"===u),i=Math.max(i,e),y.push({str:t,width:e,ascent:0,descent:0,keepCenterInLine:!1})}l[0]=i}l[1]=y.length*(b+t),C.LayoutBBox(c={xOffset:0,yOffset:0,width:l[0],height:l[1]},o,a),r=C.layoutWithBBox(c,y,o,a,b),this.cache.layoutData=r,this.clearUpdateShapeTag(),this._AABBBounds.set(c.xOffset,c.yOffset,c.xOffset+c.width,c.yOffset+c.height)}return n&&this._AABBBounds.expand(d/2),this._AABBBounds}needUpdateTags(e){for(let i=0;i<WRAP_TEXT_UPDATE_TAG_KEY.length;i++){var t=WRAP_TEXT_UPDATE_TAG_KEY[i];if(-1!==e.indexOf(t))return!0}return super.needUpdateTags(e)}needUpdateTag(e){for(let t=0;t<WRAP_TEXT_UPDATE_TAG_KEY.length;t++)if(e===WRAP_TEXT_UPDATE_TAG_KEY[t])return!0;return super.needUpdateTag(e)}getNoWorkAnimateAttr(){return gYa.NOWORK_ANIMATE_ATTR}};function createWrapText(e){return new WrapText(e)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var BaseSymbol=class{bounds(e,t){var i;isNumber_default(e)?(t.x1=-(i=e/2),t.x2=i,t.y1=-i,t.y2=i):(t.x1=-e[0]/2,t.x2=e[0]/2,t.y1=-e[1]/2,t.y2=e[1]/2)}parseSize(e){return isNumber_default(e)?e:Math.min(e[0],e[1])}};function circle(e,t,i,r,o){return o?e.arc(i,r,t,0,tau,!1,o):e.arc(i,r,t,0,tau),!1}var CircleSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"circle\\\",this.pathStr=\\\"M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0\\\"}draw(e,t,i,r,o){return circle(e,this.parseSize(t)/2,i,r,o)}drawOffset(e,t,i,r,o,n){return circle(e,this.parseSize(t)/2+o,i,r,n)}drawToSvgPath(e,t,i,r){var o=this.parseSize(e)/2;return`M ${t-o}, ${i} a ${o},${o} 0 1,0 ${2*o},0 a ${o},${o} 0 1,0 -${2*o},0`}},circle_default=new CircleSymbol;function cross(e,t,i,r,o){return e.moveTo(-3*t+i,-t+r,o),e.lineTo(-t+i,-t+r,o),e.lineTo(-t+i,-3*t+r,o),e.lineTo(t+i,-3*t+r,o),e.lineTo(t+i,-t+r,o),e.lineTo(3*t+i,-t+r,o),e.lineTo(3*t+i,t+r,o),e.lineTo(t+i,t+r,o),e.lineTo(t+i,3*t+r,o),e.lineTo(-t+i,3*t+r,o),e.lineTo(-t+i,t+r,o),e.lineTo(-3*t+i,t+r,o),e.closePath(),!0}function crossOffset(e,t,i,r,o,n){return e.moveTo(-3*t+i-o,-t+r-o,n),e.lineTo(-t+i-o,-t+r-o,n),e.lineTo(-t+i-o,-3*t+r-o,n),e.lineTo(t+i+o,-3*t+r-o,n),e.lineTo(t+i+o,-t+r-o,n),e.lineTo(3*t+i+o,-t+r-o,n),e.lineTo(3*t+i+o,t+r+o,n),e.lineTo(t+i+o,t+r+o,n),e.lineTo(t+i+o,3*t+r+o,n),e.lineTo(-t+i-o,3*t+r+o,n),e.lineTo(-t+i-o,t+r+o,n),e.lineTo(-3*t+i-o,t+r+o,n),e.closePath(),!0}init_esbuild_inject();var CrossSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"cross\\\",this.pathStr=\\\"M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z\\\"}draw(e,t,i,r,o){return cross(e,this.parseSize(t)/6,i,r,o)}drawOffset(e,t,i,r,o,n){return crossOffset(e,this.parseSize(t)/6,i,r,o,n)}},cross_default=new CrossSymbol;function diamond(e,t,i,r,o){return e.moveTo(i,r-t,o),e.lineTo(t+i,r,o),e.lineTo(i,r+t,o),e.lineTo(i-t,r,o),e.closePath(),!0}init_esbuild_inject();var DiamondSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"diamond\\\",this.pathStr=\\\"M-0.5,0L0,-0.5L0.5,0L0,0.5Z\\\"}draw(e,t,i,r,o){return diamond(e,this.parseSize(t)/2,i,r,o)}drawFitDir(e,t,i,r,o){return diamond(e,this.parseSize(t)/2,i,r,o)}drawOffset(e,t,i,r,o,n){return diamond(e,this.parseSize(t)/2+o,i,r,n)}},diamond_default=new DiamondSymbol;function square(e,t,i,r){var o=2*t;return e.rect(i-t,r-t,o,o),!1}init_esbuild_inject();var SquareSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"square\\\",this.pathStr=\\\"M-0.5,-0.5h1v1h-1Z\\\"}draw(e,t,i,r){return square(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return square(e,this.parseSize(t)/2+o,i,r)}},square_default=new SquareSymbol;function trianglUpOffset(e,t,i,r,o=0){return e.moveTo(i+t+2*o,t+r+o),e.lineTo(i-t-2*o,t+r+o),e.lineTo(i,r-t-2*o),e.closePath(),!0}init_esbuild_inject(),init_esbuild_inject();var TriangleUpSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"triangleUp\\\",this.pathStr=\\\"M0.5,0.5 L-0.5,0.5 L0,-0.5 Z\\\"}draw(e,t,i,r){return trianglUpOffset(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return trianglUpOffset(e,this.parseSize(t)/2,i,r,o)}},triangle_up_default=new TriangleUpSymbol,TriangleSymbol=class extends TriangleUpSymbol{constructor(){super(...arguments),this.type=\\\"triangle\\\"}},triangle_default=new TriangleSymbol,kr=(init_esbuild_inject(),Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10)),kx=Math.sin(tau/10)*kr,ky=-Math.cos(tau/10)*kr;function star(e,t,i,r){var o=kx*t,n=ky*t;e.moveTo(i,-t+r),e.lineTo(o+i,n+r);for(let s=1;s<5;++s){var a=tau*s/5,l=Math.cos(a),a=Math.sin(a);e.lineTo(a*t+i,-l*t+r),e.lineTo(l*o-a*n+i,a*o+l*n+r)}return e.closePath(),!0}var StarSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"star\\\",this.pathStr=\\\"M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z\\\"}draw(e,t,i,r){return star(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return star(e,this.parseSize(t)/2+o,i,r)}},star_default=new StarSymbol,sqrt3=(init_esbuild_inject(),sqrt(3));function arrow(e,t,i,r){var o=t/sqrt3,n=o/5,a=t;return e.moveTo(0+i,-t+r),e.lineTo(o/2+i,r),e.lineTo(n/2+i,r),e.lineTo(n/2+i,a+r),e.lineTo(-n/2+i,a+r),e.lineTo(-n/2+i,r),e.lineTo(-o/2+i,r),e.closePath(),!0}var ArrowSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"arrow\\\",this.pathStr=\\\"M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z\\\"}draw(e,t,i,r){return arrow(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return arrow(e,this.parseSize(t)/2+o,i,r)}},arrow_default=new ArrowSymbol;function wedge(e,t,i,r){var o=2*t;return e.moveTo(i,-t+r),e.lineTo(o/3/2+i,t+r),e.lineTo(-o/3/2+i,t+r),e.closePath(),!0}init_esbuild_inject();var WedgeSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"wedge\\\",this.pathStr=\\\"M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z\\\"}draw(e,t,i,r){return wedge(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return wedge(e,this.parseSize(t)/2+o,i,r)}},wedge_default=new WedgeSymbol;function stroke(e,t,i,r){return e.moveTo(-t+i,r),e.lineTo(i,t+r),!1}init_esbuild_inject();var StrokeSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"stroke\\\",this.pathStr=\\\"\\\"}draw(e,t,i,r){return stroke(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return stroke(e,this.parseSize(t)/2+o,i,r)}},stroke_default=new StrokeSymbol,c=(init_esbuild_inject(),-.5),s=sqrt(3)/2,k=1/sqrt(12),a=3*(k/2+1);function wye(e,t,i,r){var o=t/2,n=t*k,a=o,l=t*k+t,h=-a,d=l;return e.moveTo(o+i,n+r),e.lineTo(a+i,l+r),e.lineTo(h+i,d+r),e.lineTo(c*o-s*n+i,s*o+c*n+r),e.lineTo(c*a-s*l+i,s*a+c*l+r),e.lineTo(c*h-s*d+i,s*h+c*d+r),e.lineTo(c*o+s*n+i,c*n-s*o+r),e.lineTo(c*a+s*l+i,c*l-s*a+r),e.lineTo(c*h+s*d+i,c*d-s*h+r),e.closePath(),!1}var WyeSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"wye\\\",this.pathStr=\\\"M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z\\\"}draw(e,t,i,r){return wye(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return wye(e,this.parseSize(t)/2+o,i,r)}},wye_default=new WyeSymbol;function trianglLeftOffset(e,t,i,r,o){return e.moveTo(-t+i-2*o,r),e.lineTo(t+i+o,t+r+2*o),e.lineTo(t+i+o,r-t-2*o),e.closePath(),!0}init_esbuild_inject();var TriangleLeftSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"triangleLeft\\\",this.pathStr=\\\"M-0.5,0 L0.5,0.5 L0.5,-0.5 Z\\\"}draw(e,t,i,r){return trianglLeftOffset(e,this.parseSize(t)/2,i,r,0)}drawOffset(e,t,i,r,o){return trianglLeftOffset(e,this.parseSize(t)/2,i,r,o)}},triangle_left_default=new TriangleLeftSymbol;function trianglRightOffset(e,t,i,r,o=0){return e.moveTo(i-t-o,t+r+2*o),e.lineTo(t+i+2*o,r),e.lineTo(i-t-o,r-t-2*o),e.closePath(),!0}init_esbuild_inject();var TriangleRightSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"triangleRight\\\",this.pathStr=\\\"M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z\\\"}draw(e,t,i,r){return trianglRightOffset(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return trianglRightOffset(e,this.parseSize(t)/2,i,r,o)}},triangle_right_default=new TriangleRightSymbol;function trianglDownOffset(e,t,i,r,o=0){return e.moveTo(i-t-2*o,r-t-o),e.lineTo(i+t+2*o,r-t-o),e.lineTo(i,r+t+2*o),e.closePath(),!0}init_esbuild_inject();var TriangleDownSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"triangleDown\\\",this.pathStr=\\\"M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z\\\"}draw(e,t,i,r){return trianglDownOffset(e,this.parseSize(t)/2,i,r)}drawOffset(e,t,i,r,o){return trianglDownOffset(e,this.parseSize(t)/2,i,r,o)}},triangle_down_default=new TriangleDownSymbol,sqrt32=(init_esbuild_inject(),sqrt(3));function thinTriangle(e,t,i,r){var o=t*sqrt32;return e.moveTo(i,r+-o/3*2),e.lineTo(t+i,r+o),e.lineTo(i-t,r+o),e.closePath(),!0}var ThinTriangleSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"thinTriangle\\\",this.pathStr=\\\"M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z\\\"}draw(e,t,i,r){return thinTriangle(e,this.parseSize(t)/2/sqrt32,i,r)}drawOffset(e,t,i,r,o){return thinTriangle(e,this.parseSize(t)/2/sqrt32+o,i,r)}},thin_triangle_default=new ThinTriangleSymbol;function arrow2Left(e,t,i,r){var o=2*t;return e.moveTo(t+i,r-o),e.lineTo(i-t,r),e.lineTo(t+i,o+r),!0}init_esbuild_inject();var Arrow2LeftSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"arrow2Left\\\",this.pathStr=\\\"M 0.25 -0.5 L -0.25 0 l 0.25 0.5\\\"}draw(e,t,i,r){return arrow2Left(e,this.parseSize(t)/4,i,r)}drawOffset(e,t,i,r,o){return arrow2Left(e,this.parseSize(t)/4+o,i,r)}},arrow2_left_default=new Arrow2LeftSymbol;function arrow2Right(e,t,i,r){var o=2*t;return e.moveTo(i-t,r-o),e.lineTo(i+t,r),e.lineTo(i-t,o+r),!0}init_esbuild_inject();var Arrow2RightSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"arrow2Right\\\",this.pathStr=\\\"M -0.25 -0.5 l 0.25 0 l -0.25 0.5\\\"}draw(e,t,i,r){return arrow2Right(e,this.parseSize(t)/4,i,r)}drawOffset(e,t,i,r,o){return arrow2Right(e,this.parseSize(t)/4+o,i,r)}},arrow2_right_default=new Arrow2RightSymbol;function arrow2Up(e,t,i,r){var o=2*t;return e.moveTo(i-o,r+t),e.lineTo(i,r-t),e.lineTo(i+o,r+t),!0}init_esbuild_inject();var Arrow2UpSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"arrow2Up\\\",this.pathStr=\\\"M -0.5 0.25 L 0 -0.25 l 0.5 0.25\\\"}draw(e,t,i,r){return arrow2Up(e,this.parseSize(t)/4,i,r)}drawOffset(e,t,i,r,o){return arrow2Up(e,this.parseSize(t)/4+o,i,r)}},arrow2_up_default=new Arrow2UpSymbol;function arrow2Down(e,t,i,r){var o=2*t;return e.moveTo(i-o,r-t),e.lineTo(i,r+t),e.lineTo(i+o,r-t),!0}init_esbuild_inject();var Arrow2DownSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"arrow2Down\\\",this.pathStr=\\\"M -0.5 -0.25 L 0 0.25 l 0.5 -0.25\\\"}draw(e,t,i,r){return arrow2Down(e,this.parseSize(t)/4,i,r)}drawOffset(e,t,i,r,o){return arrow2Down(e,this.parseSize(t)/4+o,i,r)}},arrow2_down_default=new Arrow2DownSymbol;function lineV(e,t,i,r,o){return e.moveTo(i,r-t),e.lineTo(i,r+t),!0}init_esbuild_inject();var LineVSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"lineV\\\",this.pathStr=\\\"M0,-0.5L0,0.5\\\"}draw(e,t,i,r,o){return lineV(e,this.parseSize(t)/2,i,r,o)}drawOffset(e,t,i,r,o,n){return lineV(e,this.parseSize(t)/2+o,i,r,n)}drawToSvgPath(e,t,i,r){var o=this.parseSize(e)/2;return`M ${t}, ${i-o} L ${t},`+(i+o)}},line_v_default=new LineVSymbol;function lineH(e,t,i,r,o){return e.moveTo(i-t,r),e.lineTo(i+t,r),!0}init_esbuild_inject();var LineHSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"lineH\\\",this.pathStr=\\\"M-0.5,0L0.5,0\\\"}draw(e,t,i,r,o){return lineH(e,this.parseSize(t)/2,i,r,o)}drawOffset(e,t,i,r,o,n){return lineH(e,this.parseSize(t)/2+o,i,r,n)}drawToSvgPath(e,t,i,r){var o=this.parseSize(e)/2;return`M ${t-o}, ${i} L ${t+o},`+i}},line_h_default=new LineHSymbol;function close(e,t,i,r,o){return e.moveTo(i-t,r-t),e.lineTo(i+t,r+t),e.moveTo(i+t,r-t),e.lineTo(i-t,r+t),!0}init_esbuild_inject();var CloseSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"close\\\",this.pathStr=\\\"M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5\\\"}draw(e,t,i,r,o){return close(e,this.parseSize(t)/2,i,r,o)}drawOffset(e,t,i,r,o,n){return close(e,this.parseSize(t)/2+o,i,r,n)}drawToSvgPath(e,t,i,r){var o=this.parseSize(e)/2;return`M ${t-o}, ${i-o} L ${t+o},${i+o} M ${t+o}, ${i-o} L ${t-o},`+(i+o)}},close_default=new CloseSymbol;function rectSizeArray(e,t,i,r){return e.rect(i-t[0]/2,r-t[1]/2,t[0],t[1]),!1}function rectSize(e,t,i,r){var o=t/2;return e.rect(i-t/2,r-o/2,t,o),!1}init_esbuild_inject();var RectSymbol=class extends BaseSymbol{constructor(){super(...arguments),this.type=\\\"rect\\\",this.pathStr=\\\"M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z\\\"}draw(e,t,i,r){return(isNumber_default(t)?rectSize:rectSizeArray)(e,t,i,r)}drawOffset(e,t,i,r,o){return isNumber_default(t)?rectSize(e,t+2*o,i,r):rectSizeArray(e,[t[0]+2*o,t[1]+2*o],i,r)}},rect_default=new RectSymbol,tempBounds2=(init_esbuild_inject(),new AABBBounds),CustomSymbolClass=class{constructor(e,t,i=!1){this.pathStr=\\\"\\\",this.type=e,isArray_default(t)?this.svgCache=t:this.path=t,this.isSvg=i}drawOffset(t,i,r,o,e,n,a){return i=this.parseSize(i),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(e=>{t.beginPath(),renderCommandList(e.path.commandList,t,r,o,i,i),a&&a(e.path,e.attribute)}),!1):(renderCommandList(this.path.commandList,t,r,o,i+e,i+e),!1)}draw(e,t,i,r,o,n){return t=this.parseSize(t),this.drawOffset(e,t,i,r,0,o,n)}parseSize(e){return isNumber_default(e)?e:Math.min(e[0],e[1])}bounds(t,i){if(t=this.parseSize(t),this.isSvg)return this.svgCache?(i.clear(),void this.svgCache.forEach(({path:e})=>{tempBounds2.x1=e.bounds.x1*t,tempBounds2.y1=e.bounds.y1*t,tempBounds2.x2=e.bounds.x2*t,tempBounds2.y2=e.bounds.y2*t,i.union(tempBounds2)})):void 0;this.path.bounds&&(i.x1=this.path.bounds.x1*t,i.y1=this.path.bounds.y1*t,i.x2=this.path.bounds.x2*t,i.y2=this.path.bounds.y2*t)}},builtinSymbols=[circle_default,cross_default,diamond_default,square_default,thin_triangle_default,triangle_default,star_default,arrow_default,wedge_default,stroke_default,wye_default,triangle_left_default,triangle_right_default,triangle_up_default,triangle_down_default,arrow2_left_default,arrow2_right_default,arrow2_up_default,arrow2_down_default,rect_default,line_v_default,line_h_default,close_default],builtinSymbolsMap={},builtInSymbolStrMap=(builtinSymbols.forEach(e=>{builtinSymbolsMap[e.type]=e}),{arrowLeft:\\\"M 0.25 -0.5 L -0.25 0 l 0.5 0.5\\\",arrowRight:\\\"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5\\\",rectRound:\\\"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z\\\",roundLine:\\\"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z\\\"}),updateBoundsOfSymbolOuterBorder=(init_esbuild_inject(),(e,t,i)=>{var r,{outerBorder:o,shadowBlur:n=t.shadowBlur,strokeBoundsBuffer:a=t.strokeBoundsBuffer}=e;return o&&(r=t.outerBorder,({distance:o=r.distance,lineWidth:r=r.lineWidth}=o),boundStroke(i,o+(n+r)/2,!0,a)),i}),_tempBounds=new AABBBounds,SYMBOL_UPDATE_TAG_KEY=[\\\"symbolType\\\",\\\"size\\\",...GRAPHIC_UPDATE_TAG_KEY],Symbol2=class Ic0 extends Graphic{constructor(e={symbolType:\\\"circle\\\"}){super(e),this.type=\\\"symbol\\\",this.numberType=SYMBOL_NUMBER_TYPE}getParsedPath(){return this.shouldUpdateShape()&&(this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}isValid(){return super.isValid()&&this._isValid()}_isValid(){var e=this.attribute.size;return isArray_default(e)?2===e.length&&e.every(this._validNumber):this._validNumber(e)}doUpdateParsedPath(){var e=this.getGraphicTheme(),{symbolType:e=e.symbolType}=this.attribute,t=builtinSymbolsMap[e];if(t)return this._parsedPath=t;if(t=Ic0.userSymbolMap[e])return this._parsedPath=t;if(!0===isSvg(e=builtInSymbolStrMap[e]||e)){if(!(t=(new XMLParser).parse(e).svg))return null;t=isArray_default(t.path)?t.path:[t.path],_tempBounds.clear();const o=[],n=(t.forEach(t=>{const e=(new CustomPath2D).fromString(t.d),i={};SVG_PARSE_ATTRIBUTE_MAP_KEYS.forEach(e=>{t[e]&&(i[SVG_PARSE_ATTRIBUTE_MAP[e]]=t[e])}),o.push({path:e,attribute:i}),_tempBounds.union(e.bounds)}),_tempBounds.width()),a=_tempBounds.height(),l=1/max(n,a);o.forEach(e=>e.path.transform(0,0,l,l)),this._parsedPath=new CustomSymbolClass(e,o,!0)}else{var t,i=(t=(new CustomPath2D).fromString(e)).bounds.width(),r=t.bounds.height(),i=1/max(i,r);t.transform(0,0,i,i),this._parsedPath=new CustomSymbolClass(e,t)}return Ic0.userSymbolMap[e]=this._parsedPath,this._parsedPath}getGraphicTheme(){return getTheme(this).symbol}updateAABBBounds(e,t,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateSymbolAABBBoundsImprecise(e,t,i):this.updateSymbolAABBBoundsAccurate(e,t,i));var{tb1:o,tb2:n}=application.graphicService.updateTempAABBBounds(i),{lineJoin:n=t.lineJoin}=(updateBoundsOfSymbolOuterBorder(e,t,o),i.union(o),o.setValue(n.x1,n.y1,n.x2,n.y2),e);return application.graphicService.transformAABBBounds(e,i,t,\\\"miter\\\"===n,this),i}updateSymbolAABBBoundsImprecise(e,t,i){var{size:r=t.size}=e;return isArray_default(r)?i.set(-r[0]/2,-r[1]/2,r[0]/2,r[1]/2):i.set(-(r=r/2),-r,r,r),i}updateSymbolAABBBoundsAccurate(e,t,i){var{size:r=t.size}=e;return this.getParsedPath().bounds(r,i),i}needUpdateTags(e){return super.needUpdateTags(e,SYMBOL_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,SYMBOL_UPDATE_TAG_KEY)}toCustomPath(){var e=this.getParsedPath(),t=this.attribute.size,t=isArray_default(t)?t:[t,t];return e.path?(new CustomPath2D).fromCustomPath2D(e.path,0,0,t[0],t[1]):(new CustomPath2D).fromString(e.pathStr,0,0,t[0],t[1])}clone(){return new Ic0(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Ic0.NOWORK_ANIMATE_ATTR}};function createSymbol(e){return new Symbol2(e)}Symbol2.userSymbolMap={},Symbol2.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},NOWORK_ANIMATE_ATTR),init_esbuild_inject();var LINE_UPDATE_TAG_KEY=[\\\"segments\\\",\\\"points\\\",\\\"curveType\\\",\\\"curveTension\\\",...GRAPHIC_UPDATE_TAG_KEY],Line=class y20 extends Graphic{constructor(e={}){super(e),this.type=\\\"line\\\",this.numberType=LINE_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){var e,t;return!(!this.pathProxy&&(({points:e,segments:t}=this.attribute),t?0===t.length:!e||e.length<=1))}_interpolate(e,t,i,r,o){\\\"points\\\"===e&&(o.points=pointsInterpolation(i,r,t))}getGraphicTheme(){return getTheme(this).line}updateAABBBounds(e,t,i){this.updatePathProxyAABBBounds(i)||(e.segments?this.updateLineAABBBoundsBySegments(e,t,i):this.updateLineAABBBoundsByPoints(e,t,i)),application.graphicService.updateTempAABBBounds(i);var{lineJoin:r=t.lineJoin}=e;return application.graphicService.transformAABBBounds(e,i,t,\\\"miter\\\"===r,this),i}updateLineAABBBoundsByPoints(e,t,i,r){let{points:o=t.points,connectedType:n}=e,a=i;return o.forEach(e=>{!1===e.defined&&\\\"zero\\\"!==n&&\\\"connect\\\"!==n||a.add(e.x,e.y)}),a}updateLineAABBBoundsBySegments(e,t,i,r){let{segments:o=t.segments,connectedType:n}=e,a=i;return o.forEach(e=>{e.points.forEach(e=>{!1===e.defined&&\\\"zero\\\"!==n&&\\\"connect\\\"!==n||a.add(e.x,e.y)})}),a}needUpdateTags(e){return super.needUpdateTags(e,LINE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,LINE_UPDATE_TAG_KEY)}toCustomPath(){const e=this.attribute,i=new CustomPath2D,t=e.segments,r=e=>{if(e&&e.length){let t=!0;e.forEach(e=>{!1!==e.defined&&(t?i.moveTo(e.x,e.y):i.lineTo(e.x,e.y),t=!1)})}};return t&&t.length?t.forEach(e=>{r(e.points)}):e.points&&r(e.points),i}clone(){return new y20(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return y20.NOWORK_ANIMATE_ATTR}};function createLine(e){return new Line(e)}Line.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},NOWORK_ANIMATE_ATTR),init_esbuild_inject();var RECT_UPDATE_TAG_KEY=[\\\"width\\\",\\\"x1\\\",\\\"y1\\\",\\\"height\\\",\\\"cornerRadius\\\",...GRAPHIC_UPDATE_TAG_KEY],Rect=class ld0 extends Graphic{constructor(e){super(e),this.type=\\\"rect\\\",this.numberType=RECT_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return getTheme(this).rect}updateAABBBounds(e,t,i){!this.updatePathProxyAABBBounds(i)&&(({width:n,height:a}=e),({x1:l,y1:s,x:r,y:o}=e),n=null!=n?n:l-r,a=null!=a?a:s-o,isFinite(n)||isFinite(a)||isFinite(r)||isFinite(o))&&i.set(0,0,n||0,a||0);var r,o,n,a,{tb1:l,tb2:s}=application.graphicService.updateTempAABBBounds(i);return updateBoundsOfCommonOuterBorder(e,t,l),i.union(l),l.setValue(s.x1,s.y1,s.x2,s.y2),application.graphicService.transformAABBBounds(e,i,t,!1,this),i}needUpdateTags(e){return super.needUpdateTags(e,RECT_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,RECT_UPDATE_TAG_KEY)}toCustomPath(){var e=this.attribute,{x:e,y:t,width:i,height:r}=normalizeRectAttributes(e),o=new CustomPath2D;return o.moveTo(e,t),o.rect(e,t,i,r),o}clone(){return new ld0(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return ld0.NOWORK_ANIMATE_ATTR}};function createRect(e){return new Rect(e)}Rect.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR,init_esbuild_inject(),init_esbuild_inject();var Frame=class{constructor(e,t,i,r,o,n,a,l,s,h,d,u,c,g){this.left=e,this.top=t,this.width=i,this.height=r,this.actualHeight=0,this.bottom=t+r,this.right=e+i,this.ellipsis=o,this.wordBreak=n,this.verticalDirection=a,this.lines=[],this.globalAlign=l,this.globalBaseline=s,this.layoutDirection=h,this.directionKey=DIRECTION_KEY[this.layoutDirection],this.isWidthMax=d,this.isHeightMax=u,this.singleLine=c,g?(g.clear(),this.icons=g):this.icons=new Map}draw(i,r){var{width:e,height:o}=this.getActualSize(),e=this.isWidthMax?Math.min(this.width,e):this.width||e||0,t=this.isHeightMax?Math.min(this.height,o):this.height||o||0,t=Math.min(t,o);let n=0;switch(this.globalBaseline){case\\\"top\\\":n=0;break;case\\\"middle\\\":n=-t/2;break;case\\\"bottom\\\":n=-t}let a=0,l=(\\\"right\\\"===this.globalAlign||\\\"end\\\"===this.globalAlign?a=-e:\\\"center\\\"===this.globalAlign&&(a=-e/2),this[this.directionKey.height]),s=(this.singleLine&&(l=this.lines[0].height+1),!1);if(\\\"middle\\\"===this.verticalDirection)if(this.actualHeight>=l&&0!==l)for(let t=0;t<this.lines.length;t++){var{top:h,height:d}=this.lines[t];if(h+d<this[this.directionKey.top]||h+d>this[this.directionKey.top]+l)return s;let e=!1;this.ellipsis&&this.lines[t+1]&&this.lines[t+1].top+this.lines[t+1].height>this[this.directionKey.top]+l&&(e=!0,s=!0),this.lines[t].draw(i,e,this.lines[t][this.directionKey.left]+a,this.lines[t][this.directionKey.top]+n,this.ellipsis,r)}else{o=Math.floor((l-this.actualHeight)/2);\\\"vertical\\\"===this.layoutDirection?a+=o:n+=o;for(let e=0;e<this.lines.length;e++)this.lines[e].draw(i,!1,this.lines[e][this.directionKey.left]+a,this.lines[e][this.directionKey.top]+n,this.ellipsis,r)}else if(\\\"bottom\\\"===this.verticalDirection&&\\\"vertical\\\"!==this.layoutDirection)for(let t=0;t<this.lines.length;t++){var u=this.lines[t].height,c=l-this.lines[t].top-this.lines[t].height;if(0===l)this.lines[t].draw(i,!1,a,c+n,this.ellipsis,r);else{if(c+u>this[this.directionKey.top]+l||c<this[this.directionKey.top])return s;{let e=!1;this.ellipsis&&this.lines[t+1]&&c-this.lines[t+1].height<this[this.directionKey.top]&&(e=!0,s=!0),this.lines[t].draw(i,e,a,c+n,this.ellipsis,r)}}}else{\\\"bottom\\\"===this.verticalDirection&&\\\"vertical\\\"===this.layoutDirection&&this.singleLine&&this.isWidthMax&&(a+=this.lines[0].height+1);for(let t=0;t<this.lines.length;t++){\\\"bottom\\\"===this.verticalDirection&&\\\"vertical\\\"===this.layoutDirection&&(a-=this.lines[t].height+this.lines[t].top);var{top:g,height:p}=this.lines[t];if(0===l)this.lines[t].draw(i,!1,this.lines[t][this.directionKey.left]+a,this.lines[t][this.directionKey.top]+n,this.ellipsis,r);else{if(g+p<this[this.directionKey.top]||g+p>this[this.directionKey.top]+l)return s;{let e=!1;this.ellipsis&&this.lines[t+1]&&this.lines[t+1].top+this.lines[t+1].height>this[this.directionKey.top]+l&&(e=!0,s=!0),this.lines[t].draw(i,e,this.lines[t][this.directionKey.left]+a,this.lines[t][this.directionKey.top]+n,this.ellipsis,r)}}}}return s}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let e=0,t=0;for(let r=0;r<this.lines.length;r++){var i=this.lines[r];i.actualWidth>e&&(e=i.actualWidth),t+=i.height}return{width:\\\"vertical\\\"===this.layoutDirection?t:e,height:\\\"vertical\\\"===this.layoutDirection?e:t}}getActualSizeWidthEllipsis(){let i=0,r=0;var e=this.getRawActualSize().height,t=(this.width,this.height||e||0),t=Math.min(t,e);let o=this[this.directionKey.height];if(this.singleLine&&(o=this.lines[0].height+1),\\\"middle\\\"===this.verticalDirection)if(this.actualHeight>=o&&0!==o)for(let e=0;e<this.lines.length;e++){var{top:n,height:a}=this.lines[e];n+a<this[this.directionKey.top]||n+a>this[this.directionKey.top]+o||(this.ellipsis&&this.lines[e+1]&&this.lines[e+1].top+this.lines[e+1].height>this[this.directionKey.top]+o?(n=!0===this.ellipsis?\\\"...\\\":this.ellipsis||\\\"\\\",(a=this.lines[e].getWidthWithEllips(n))>i&&(i=a)):this.lines[e].actualWidth>i&&(i=this.lines[e].actualWidth),r+=this.lines[e].height)}else{Math.floor((o-this.actualHeight)/2);for(let e=0;e<this.lines.length;e++)this.lines[e].actualWidth>i&&(i=this.lines[e].actualWidth),r+=this.lines[e].height}else if(\\\"bottom\\\"===this.verticalDirection)for(let e=0;e<this.lines.length;e++){var l=this.lines[e].height,s=o-this.lines[e].top-this.lines[e].height;0===o?(this.lines[e].actualWidth>i&&(i=this.lines[e].actualWidth),r+=this.lines[e].height):s+l>this[this.directionKey.top]+o||s<this[this.directionKey.top]||(this.ellipsis&&this.lines[e+1]&&s-this.lines[e+1].height<this[this.directionKey.top]?(l=!0===this.ellipsis?\\\"...\\\":this.ellipsis||\\\"\\\",(s=this.lines[e].getWidthWithEllips(l))>i&&(i=s)):this.lines[e].actualWidth>i&&(i=this.lines[e].actualWidth),r+=this.lines[e].height)}else for(let t=0;t<this.lines.length;t++){var{top:h,height:d}=this.lines[t];0===o?(this.lines[t].actualWidth>i&&(i=this.lines[t].actualWidth),r+=this.lines[t].height):h+d<this[this.directionKey.top]||h+d>this[this.directionKey.top]+o||(this.ellipsis&&this.lines[t+1]&&this.lines[t+1].top+this.lines[t+1].height>this[this.directionKey.top]+o?(h=!0===this.ellipsis?\\\"...\\\":this.ellipsis||\\\"\\\",(d=this.lines[t].getWidthWithEllips(h))>i&&(i=d)):this.lines[t].actualWidth>i&&(i=this.lines[t].actualWidth),r+=this.lines[t].height)}return{width:\\\"vertical\\\"===this.layoutDirection?r:i,height:\\\"vertical\\\"===this.layoutDirection?i:r}}},Paragraph=(init_esbuild_inject(),class{constructor(e,t,i){this.fontSize=i.fontSize||16,this.textBaseline=i.textBaseline||\\\"alphabetic\\\";var r=calculateLineHeight(i.lineHeight,this.fontSize),{ascent:r,height:o,descent:n,width:a}=(this.lineHeight=\\\"number\\\"==typeof r?r>this.fontSize?r:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight,measureTextCanvas(e,i));let l=0,s=0,h=0;this.height>o&&(l=(this.height-o)/2,s=Math.ceil(l),h=Math.floor(l)),\\\"top\\\"===this.textBaseline?(this.ascent=l,this.descent=o-l):\\\"bottom\\\"===this.textBaseline?(this.ascent=o-l,this.descent=l):\\\"middle\\\"===this.textBaseline?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=r+s,this.descent=n+h),this.length=e.length,this.width=a||0,this.text=e||\\\"\\\",this.newLine=t||!1,this.character=i,this.left=0,this.top=0,this.ellipsis=\\\"normal\\\",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,\\\"vertical\\\"===i.direction&&(this.direction=i.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr=\\\"...\\\"}updateWidth(){var e=measureTextCanvas(this.text,this.character).width;this.width=e,\\\"vertical\\\"===this.direction&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}draw(e,t,i,r,o){let n=this.text,a=this.left+i,l=(t+=this.top,this.direction);if(this.verticalEllipsis)n=this.ellipsisStr,l=\\\"vertical\\\",t-=this.ellipsisWidth/2;else{if(\\\"hide\\\"===this.ellipsis)return;\\\"add\\\"===this.ellipsis?(n+=this.ellipsisStr,\\\"right\\\"!==o&&\\\"end\\\"!==o||(a-=this.ellipsisWidth)):\\\"replace\\\"===this.ellipsis&&(s=getStrByWithCanvas(n,(\\\"vertical\\\"===l?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,n.length-1),n=n.slice(0,s),n+=this.ellipsisStr,\\\"right\\\"!==o&&\\\"end\\\"!==o||(s=measureTextCanvas(this.text.slice(s),this.character).width,\\\"vertical\\\"!==l&&(a-=this.ellipsisWidth-s)))}switch(this.character.script){case\\\"super\\\":t-=this.ascent*(1/3);break;case\\\"sub\\\":t+=this.descent/2}\\\"vertical\\\"===l&&(e.save(),e.rotateAbout(Math.PI/2,a,t),e.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),e.translate(a,t),t=a=0);var{lineWidth:s=1}=this.character;this.character.stroke&&s&&e.strokeText(n,a,t),this.character.fill&&e.fillText(n,a,t),this.character.fill&&(\\\"boolean\\\"==typeof this.character.lineThrough||\\\"boolean\\\"==typeof this.character.underline?(this.character.underline&&e.fillRect(a,1+t,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1),this.character.lineThrough&&e.fillRect(a,1+t-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)):\\\"underline\\\"===this.character.textDecoration?e.fillRect(a,1+t,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1):\\\"line-through\\\"===this.character.textDecoration&&e.fillRect(a,1+t-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)),\\\"vertical\\\"===l&&e.restore()}getWidthWithEllips(e){let t=this.text;var i,r=\\\"vertical\\\"===e?this.height:this.width;return\\\"hide\\\"===this.ellipsis?r:\\\"add\\\"===this.ellipsis?r+this.ellipsisWidth:\\\"replace\\\"===this.ellipsis?(i=getStrByWithCanvas(t,r-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,t.length-1),i=(t=t.slice(0,i),t+=this.ellipsisStr,measureTextCanvas(this.text.slice(i),this.character)).width,r+this.ellipsisWidth-i):r}});function seperateParagraph(e,t){var i=e.text.slice(0,t),r=e.text.slice(t);return[new Paragraph(i,e.newLine,e.character),new Paragraph(r,!0,e.character)]}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var IMAGE_UPDATE_TAG_KEY=[\\\"width\\\",\\\"height\\\",\\\"image\\\",...GRAPHIC_UPDATE_TAG_KEY],Image2=class xe0 extends Graphic{constructor(e){super(e),this.type=\\\"image\\\",this.numberType=IMAGE_NUMBER_TYPE,this.loadImage(this.attribute.image)}get width(){var e;return null!=(e=this.attribute.width)?e:0}set width(e){this.attribute.width===e&&(this.attribute.width=e,this.addUpdateShapeAndBoundsTag())}get height(){var e;return null!=(e=this.attribute.height)?e:0}set height(e){this.attribute.height===e&&(this.attribute.height=e,this.addUpdateShapeAndBoundsTag())}get repeatX(){var e;return null!=(e=this.attribute.repeatX)?e:\\\"no-repeat\\\"}set repeatX(e){this.attribute.repeatX===e&&(this.attribute.repeatX=e)}get repeatY(){var e;return null!=(e=this.attribute.repeatY)?e:\\\"no-repeat\\\"}set repeatY(e){this.attribute.repeatY===e&&(this.attribute.repeatY=e)}get image(){return this.attribute.image}set image(e){e!==this.attribute.image&&(this.attribute.image=e,this.loadImage(this.attribute.image))}imageLoadSuccess(e,t,i){super.imageLoadSuccess(e,t,()=>{this.successCallback&&this.successCallback()})}imageLoadFail(e,t){super.imageLoadFail(e,()=>{this.failCallback&&this.failCallback()})}setAttributes(e,t,i){return e.image&&this.loadImage(e.image),super.setAttributes(e,t,i)}setAttribute(e,t,i,r){return\\\"image\\\"===e&&this.loadImage(t),super.setAttribute(e,t,i,r)}getGraphicTheme(){return getTheme(this).image}updateAABBBounds(e,t,i){this.updatePathProxyAABBBounds(i)||(({width:r=t.width,height:o=t.height}=e),i.set(0,0,r,o));var{tb1:r,tb2:o}=application.graphicService.updateTempAABBBounds(i);return updateBoundsOfCommonOuterBorder(e,t,r),i.union(r),r.setValue(o.x1,o.y1,o.x2,o.y2),application.graphicService.transformAABBBounds(e,i,t,!1,this),i}getDefaultAttribute(e){return DefaultImageAttribute[e]}needUpdateTags(e){return super.needUpdateTags(e,IMAGE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,IMAGE_UPDATE_TAG_KEY)}clone(){return new xe0(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return xe0.NOWORK_ANIMATE_ATTR}};function createImage(e){return new Image2(e)}Image2.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},NOWORK_ANIMATE_ATTR);var RichTextIcon=class extends Image2{constructor(e){var t;super(e),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],\\\"always\\\"===e.backgroundShowMode&&(this._hovered=!0),e.margin&&(t=parsePadding(e.margin),this._marginArray=\\\"number\\\"==typeof t?[t,t,t,t]:t),this.onBeforeAttributeUpdate=(e,t,i)=>{var r;(isArray_default(i)&&-1!==i.indexOf(\\\"margin\\\")||\\\"margin\\\"===i)&&(t.margin?(r=parsePadding(t.margin),this._marginArray=\\\"number\\\"==typeof r?[r,r,r,r]:r):this._marginArray=[0,0,0,0])}}get width(){var e;return(null!=(e=this.attribute.width)?e:0)+this._marginArray[1]+this._marginArray[3]}get height(){var e;return(null!=(e=this.attribute.height)?e:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){var e,t,i,r;return this.shouldUpdateAABBBounds()&&(this.doUpdateAABBBounds(),({width:e=DefaultImageAttribute.width,height:t=DefaultImageAttribute.height}=this.attribute),({backgroundWidth:i=e,backgroundHeight:r=t}=this.attribute),this._AABBBounds.expand([0,2*((i-e)/2),2*((r-t)/2),0])),this._AABBBounds}setHoverState(e){\\\"hover\\\"===this.attribute.backgroundShowMode&&this._hovered!==e&&(this._hovered=e)}},Line2=class{constructor(e,t,i,r,o,n,a,l){this.left=e,this.width=t,this.baseline=i,this.ascent=r,this.descent=o,this.top=i-r,this.paragraphs=n.map(e=>e),this.textAlign=(this.paragraphs[0]instanceof RichTextIcon?this.paragraphs[0].attribute:this.paragraphs[0].character).textAlign||\\\"left\\\",this.direction=a,this.directionKey=DIRECTION_KEY[this.direction];let s=this.actualWidth=0;this.paragraphs.forEach((e,t)=>{var i;0===t&&e instanceof Paragraph&&0!==(null==(i=regFirstSpace.exec(e.text))?void 0:i.index)&&(e.text=e.text.slice(null==i?void 0:i.index),e.updateWidth()),this.actualWidth+=e[this.directionKey.width],s=Math.max(e[this.directionKey.height],s)}),this.height=s,this.blankWidth=l?0:this.width-this.actualWidth,this.calcOffset(t,l)}calcOffset(e,t){const i=this.directionKey,r=this.height;let o=this.left,n=0;this.actualWidth<e&&!t&&(\\\"right\\\"===this.textAlign||\\\"end\\\"===this.textAlign?o=e-this.actualWidth:\\\"center\\\"===this.textAlign?o=(e-this.actualWidth)/2:\\\"justify\\\"===this.textAlign&&(this.paragraphs.length<2?o=(e-this.actualWidth)/2:n=(e-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(e){e instanceof RichTextIcon?(e[\\\"_\\\"+i.x]=o,o+=e[i.width]+n,e[\\\"_\\\"+i.y]=\\\"top\\\"===e.attribute.textBaseline?0:\\\"bottom\\\"===e.attribute.textBaseline?r-e.height:(r-e.height)/2):(e[i.left]=o,o+=e[i.width]+n)})}draw(r,o,n,a,l,s){if(l&&(o||this.paragraphs.some(e=>e.overflow))){let e=!0,t=!1;for(let r=this.paragraphs.length-1;0<=r;r--){var h=this.paragraphs[r];if(h.overflow)e=e&&\\\"\\\"===h.text;else if(e){t=!0;break}}let i=0;if(!t)for(let e=this.paragraphs.length-1;0<=e;e--){var d=this.paragraphs[e];if(d.overflow){if(\\\"\\\"===d.text)break}else{if(d instanceof RichTextIcon)break;if(\\\"vertical\\\"===this.direction&&\\\"vertical\\\"!==d.direction){d.verticalEllipsis=!0;break}var u=!0===l?\\\"...\\\":l||\\\"\\\",u=measureTextCanvas(d.ellipsisStr=u,d.character).width,u=u||0;if(u<=this.blankWidth+i){o&&(d.ellipsis=\\\"add\\\");break}if(u<=this.blankWidth+i+d.width){d.ellipsis=\\\"replace\\\",d.ellipsisWidth=u,d.ellipsisOtherParagraphWidth=this.blankWidth+i;break}d.ellipsis=\\\"hide\\\",i+=d.width}}}this.paragraphs.forEach((e,t)=>{var i;e instanceof RichTextIcon?(e.setAttributes({x:n+e._x,y:a+e._y}),s(e,r,n+e._x,a+e._y,this.ascent)):(i={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height},applyStrokeStyle(r,e.character),applyFillStyle(r,e.character,i),e.draw(r,a+this.ascent,n,0===t,this.textAlign))})}getWidthWithEllips(e){let t=0;for(let n=this.paragraphs.length-1;0<=n;n--){var i=this.paragraphs[n];if(i instanceof RichTextIcon)break;var r=measureTextCanvas(e,i.character).width,r=r||0;if(r<=this.blankWidth+t){i.ellipsis=\\\"add\\\",i.ellipsisWidth=r;break}if(r<=this.blankWidth+t+i.width){i.ellipsis=\\\"replace\\\",i.ellipsisWidth=r,i.ellipsisOtherParagraphWidth=this.blankWidth+t;break}i.ellipsis=\\\"hide\\\",t+=i.width}let o=0;return this.paragraphs.forEach((e,t)=>{o+=e instanceof RichTextIcon?e.width:e.getWidthWithEllips(this.direction)}),o}},Wrapper=class{constructor(e){this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=DIRECTION_KEY[this.direction]}store(i){if(i instanceof RichTextIcon){this.frame.icons.set(i.richtextId,i),this.lineBuffer.push(i),this.lineWidth+=i[this.directionKey.width];let e=0,t=0;t=\\\"top\\\"===i.attribute.textBaseline?(e=0,i.height):\\\"bottom\\\"===i.attribute.textBaseline?(e=i.height,0):(e=i.height/2,i.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,t)}else this.lineBuffer.push(i),0!==i.text.length?(this.lineWidth+=i[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,i.ascent),this.maxDescent=Math.max(this.maxDescent,i.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,i.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,i.descent))}send(){var e,t;0!==this.lineBuffer.length&&(t=0===this.maxAscent?this.maxAscentForBlank:this.maxAscent,e=0===this.maxDescent?this.maxDescentForBlank:this.maxDescent,t=new Line2(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,\\\"horizontal\\\"===this.direction?this.frame.isWidthMax:this.frame.isHeightMax),this.frame.lines.push(t),this.frame.actualHeight+=t.height,this.y+=t.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0)}deal(e,t=!1){e instanceof RichTextIcon?\\\"horizontal\\\"===this.direction&&0===this.width||\\\"vertical\\\"===this.direction&&0===this.height||this.lineWidth+e[this.directionKey.width]<=this[this.directionKey.width]?this.store(e):0===this.lineBuffer.length?(this.store(e),this.send()):(this.send(),this.deal(e)):\\\"number\\\"!=typeof this.width||this.width<0||(e.newLine&&this.send(),0!==e.text.length&&(\\\"horizontal\\\"===this.direction&&0===this.width||\\\"vertical\\\"===this.direction&&0===this.height||this.lineWidth+e[this.directionKey.width]<=this[this.directionKey.width]?this.store(e):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(e)):this.cut(e,t)))}cut(e,t){var i=this[this.directionKey.width]-this.lineWidth||0,r=Math.ceil(i/e[this.directionKey.width]*e.length)||0,i=getStrByWithCanvas(e.text,i,e.character,r,\\\"break-word\\\"===this.frame.wordBreak);0!==i?(([r,i]=seperateParagraph(e,i)),this.store(r),t?this.send():this.deal(i)):0!==this.lineBuffer.length&&(this.send(),this.deal(e))}},RICHTEXT_UPDATE_TAG_KEY=[\\\"width\\\",\\\"height\\\",\\\"ellipsis\\\",\\\"wordBreak\\\",\\\"verticalDirection\\\",\\\"maxHeight\\\",\\\"maxWidth\\\",\\\"textAlign\\\",\\\"textBaseline\\\",\\\"textConfig\\\",\\\"layoutDirection\\\",\\\"fill\\\",\\\"stroke\\\",\\\"fontSize\\\",\\\"fontFamily\\\",\\\"fontStyle\\\",\\\"fontWeight\\\",\\\"lineWidth\\\",\\\"opacity\\\",\\\"fillOpacity\\\",\\\"strokeOpacity\\\",...GRAPHIC_UPDATE_TAG_KEY],RichText=class Df0 extends Graphic{constructor(e){super(e),this.type=\\\"richtext\\\",this._currentHoverIcon=null,this.numberType=RICHTEXT_NUMBER_TYPE,this.onBeforeAttributeUpdate=(e,t,i)=>{for(const o in e)if(\\\"hoverIconId\\\"===o){if(e[o]===t[o])continue;var r=this._frameCache.icons.get(e[o]);this.updateHoverIconState(r)}}}get width(){var e;return null!=(e=this.attribute.width)?e:DefaultRichTextAttribute.width}set width(e){this.attribute.width!==e&&(this.attribute.width=e,this.addUpdateShapeAndBoundsTag())}get height(){var e;return null!=(e=this.attribute.height)?e:DefaultRichTextAttribute.height}set height(e){this.attribute.height!==e&&(this.attribute.height=e,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(e){this.attribute.maxWidth!==e&&(this.attribute.maxWidth=e,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(e){this.attribute.maxHeight!==e&&(this.attribute.maxHeight=e,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var e;return null!=(e=this.attribute.ellipsis)?e:DefaultRichTextAttribute.ellipsis}set ellipsis(e){this.attribute.ellipsis!==e&&(this.attribute.ellipsis=e,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var e;return null!=(e=this.attribute.wordBreak)?e:DefaultRichTextAttribute.wordBreak}set wordBreak(e){this.attribute.wordBreak!==e&&(this.attribute.wordBreak=e,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var e;return null!=(e=this.attribute.verticalDirection)?e:DefaultRichTextAttribute.verticalDirection}set verticalDirection(e){this.attribute.verticalDirection!==e&&(this.attribute.verticalDirection=e,this.addUpdateShapeAndBoundsTag())}get textAlign(){var e;return null!=(e=this.attribute.textAlign)?e:DefaultRichTextAttribute.textAlign}set textAlign(e){this.attribute.textAlign!==e&&(this.attribute.textAlign=e,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var e;return null!=(e=this.attribute.textBaseline)?e:DefaultRichTextAttribute.textBaseline}set textBaseline(e){this.attribute.textBaseline!==e&&(this.attribute.textBaseline=e,this.addUpdateShapeAndBoundsTag())}get textConfig(){var e;return null!=(e=this.attribute.textConfig)?e:DefaultRichTextAttribute.textConfig}set textConfig(e){this.attribute.textConfig=e,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return getTheme(this).richtext}updateAABBBounds(e,t,i){var r,o,{width:n=t.width,height:a=t.height,maxWidth:l=t.maxWidth,maxHeight:s=t.maxHeight,textAlign:h=t.textAlign,textBaseline:d=t.textBaseline}=e;0<n&&0<a?i.set(0,0,n,a):(({width:o,height:r}=this.getFrameCache().getActualSize()),n=n||o||0,o=a||r||0,i.set(0,0,n=\\\"number\\\"==typeof l&&l<n?l:n||0,o=\\\"number\\\"==typeof s&&s<o?s:o||0));let u=0;switch(d){case\\\"top\\\":u=0;break;case\\\"middle\\\":u=-i.height()/2;break;case\\\"bottom\\\":u=-i.height()}let c=0;switch(h){case\\\"left\\\":c=0;break;case\\\"center\\\":c=-i.width()/2;break;case\\\"right\\\":c=-i.width()}return i.translate(c,u),application.graphicService.updateTempAABBBounds(i),null==e.forceBoundsHeight&&null==e.forceBoundsWidth||application.graphicService.updateHTMLTextAABBBounds(e,t,i),application.graphicService.transformAABBBounds(e,i,t,!1,this),i}needUpdateTags(e){return super.needUpdateTags(e,RICHTEXT_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,RICHTEXT_UPDATE_TAG_KEY)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){var i=this.getFrameCache();if(i.actualHeight>i.height)return!0;var e=this.attribute.disableAutoWrapLine;if(e)for(let t=0;t<i.lines.length;t++){var r=i.lines[t];for(let e=0;e<r.paragraphs.length;e++){var o=r.paragraphs[e];if(o.overflow&&\\\"\\\"!==o.text)return!0}}return!1}combinedStyleToCharacter(e){var{fill:t,stroke:i,fontSize:r,fontFamily:o,fontStyle:n,fontWeight:a,lineWidth:l,opacity:s,fillOpacity:h,strokeOpacity:d}=this.attribute;return Object.assign({fill:t,stroke:i,fontSize:r,fontFamily:o,fontStyle:n,fontWeight:a,lineWidth:l,opacity:s,fillOpacity:h,strokeOpacity:d},e)}doUpdateFrameCache(e){var{textConfig:i=[],maxWidth:r,maxHeight:o,width:t,height:n,ellipsis:a,wordBreak:l,verticalDirection:s,textAlign:h,textBaseline:d,layoutDirection:u,singleLine:c,disableAutoWrapLine:g}=this.attribute,p=[],f=null!=e?e:i;for(let T=0;T<f.length;T++)if(\\\"image\\\"in f[T]){var m=this.combinedStyleToCharacter(f[T]),b=(m.lineWidth=void 0,m.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(m.id));b?p.push(b):((b=new RichTextIcon(m)).successCallback=()=>{var e;this.addUpdateBoundTag(),null!=(e=this.stage)&&e.renderNextFrame()},b.richtextId=m.id,p.push(b))}else{var C=this.combinedStyleToCharacter(f[T]);if(isNumber_default(C.text)&&(C.text=\\\"\\\"+C.text),C.text&&C.text.includes(\\\"\\\\n\\\")){var v=C.text.split(\\\"\\\\n\\\");for(let e=0;e<v.length;e++)p.push(new Paragraph(v[e],0!==e,C))}else C.text&&p.push(new Paragraph(C.text,!1,C))}var i=\\\"number\\\"==typeof r&&Number.isFinite(r)&&0<r,y=\\\"number\\\"==typeof o&&Number.isFinite(o)&&0<o,w=\\\"number\\\"==typeof t&&Number.isFinite(t)&&0<t&&(!i||t<=r),_=\\\"number\\\"==typeof n&&Number.isFinite(n)&&0<n&&(!y||n<=o),S=new Frame(0,0,(w?t:i?r:0)||0,(_?n:y?o:0)||0,a,l,s,h,d,u||\\\"horizontal\\\",!w&&i,!_&&y,c||!1,null==(t=this._frameCache)?void 0:t.icons),x=new Wrapper(S);if(g){let e=0,t=!1;for(let i=0;i<p.length;i++){var R=p[i];t?(R.overflow=!0,R.left=1/0,R.top=1/0,R.newLine||S.lines[S.lines.length-1].paragraphs.push(R)):x.deal(R,!0),S.lines.length!==e&&(e=S.lines.length,x.lineBuffer.length=0,R.overflow=!0,R.left=1e3,R.top=1e3,S.lines[S.lines.length-1].paragraphs.push(R),t=!0),R.newLine&&(t=!1,x.lineWidth=0),x.send()}}else for(let e=0;e<p.length;e++)x.deal(p[e]);if(x.send(),!(\\\"horizontal\\\"===S.layoutDirection?w:_)){n=S.getActualSizeWidthEllipsis();let t=\\\"horizontal\\\"===S.layoutDirection?n.width:n.height;(\\\"horizontal\\\"===S.layoutDirection?i:y)&&(t=Math.min(t,\\\"horizontal\\\"===S.layoutDirection?r:o)),S.lines.forEach(function(e){e.calcOffset(t,!1)})}this._frameCache=S}clone(){return new Df0(Object.assign({},this.attribute))}setStage(t,i){super.setStage(t,i),this.getFrameCache().icons.forEach(e=>{e.setStage(t,i)})}bindIconEvent(){this.addEventListener(\\\"pointermove\\\",e=>{var t=this.pickIcon(e.global);t&&t===this._currentHoverIcon||(t?this.setAttribute(\\\"hoverIconId\\\",t.richtextId):!t&&this._currentHoverIcon&&this.setAttribute(\\\"hoverIconId\\\",void 0))}),this.addEventListener(\\\"pointerleave\\\",e=>{this._currentHoverIcon&&this.setAttribute(\\\"hoverIconId\\\",void 0)})}updateHoverIconState(e){var t;e?(null!=(t=this._currentHoverIcon)&&t.setHoverState(!1),this._currentHoverIcon=e,this._currentHoverIcon.setHoverState(!0),null!=(t=this.stage)&&t.setCursor(e.attribute.cursor),null!=(t=this.stage)&&t.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),(this._currentHoverIcon=null)!=(t=this.stage)&&t.setCursor(),null!=(t=this.stage)&&t.renderNextFrame())}pickIcon(r){let e=this.getFrameCache(),{e:o,f:n}=this.globalTransMatrix,a;return e.icons.forEach((e,t)=>{var i=e.AABBBounds.clone();i.translate(e._marginArray[3],e._marginArray[0]),i.containsPoint({x:r.x-o,y:r.y-n})&&((a=e).globalX=(null!=(i=a.attribute.x)?i:0)+o+e._marginArray[3],a.globalY=(null!=(i=a.attribute.y)?i:0)+n+e._marginArray[0])}),a}getNoWorkAnimateAttr(){return Df0.NOWORK_ANIMATE_ATTR}};function createRichText(e){return new RichText(e)}RichText.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},NOWORK_ANIMATE_ATTR),init_esbuild_inject();var ARC_UPDATE_TAG_KEY=[\\\"innerRadius\\\",\\\"outerRadius\\\",\\\"startAngle\\\",\\\"endAngle\\\",\\\"cornerRadius\\\",\\\"padAngle\\\",\\\"padRadius\\\",\\\"cap\\\",...GRAPHIC_UPDATE_TAG_KEY],Arc=class Rg0 extends Graphic{constructor(e){super(e),this.type=\\\"arc\\\",this.numberType=ARC_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){var{startAngle:e,endAngle:t,outerRadius:i,innerRadius:r}=this.attribute;return this._validNumber(e)&&this._validNumber(t)&&this._validNumber(i)&&this._validNumber(r)}getParsedCornerRadius(){var e=this.getGraphicTheme(),{cornerRadius:t=e.cornerRadius,innerPadding:i=e.innerPadding,outerPadding:r=e.outerPadding}=this.attribute,{outerRadius:o=e.outerRadius,innerRadius:e=e.innerRadius}=this.attribute;if(o+=r,e-=i,0===t||\\\"0%\\\"===t)return 0;const n=Math.abs(o-e),a=e=>Math.min(isNumber_default(e,!0)?e:n*parseFloat(e)/100,n/2);return isArray_default(t)?0===(r=t.map(e=>a(e)||0)).length?[r[0],r[0],r[0],r[0]]:2===r.length?[r[0],r[1],r[0],r[1]]:(3===r.length&&r.push(0),r):a(t)}getParsedAngle(){var i=this.getGraphicTheme(),{startAngle:r=i.startAngle,endAngle:o=i.endAngle}=this.attribute,{cap:n=i.cap}=this.attribute,a=0<=o-r?1:-1,l=o-r,o=(r=clampAngleByRadian(r))+l;if(n&&abs(l)<pi2-epsilon){let e=1,t=1;n.length&&(e=Number(n[0]),t=Number(n[1]));var{outerRadius:l=i.outerRadius,innerRadius:n=i.innerRadius}=this.attribute,{outerPadding:s=i.outerPadding,innerPadding:i=i.innerPadding}=this.attribute,s=(l+=s,n-=i,Math.abs(l-n)/2),i=s/l;if(epsilon<s&&epsilon<l)return{startAngle:r-a*i*e,endAngle:o+a*i*t,sc:a*i*e,ec:a*i*t}}return{startAngle:r,endAngle:o}}getParsePadAngle(e,t){var i=this.getGraphicTheme(),{innerPadding:r=i.innerPadding,outerPadding:o=i.outerPadding,padAngle:n=i.padAngle}=this.attribute,{outerRadius:a=i.outerRadius,innerRadius:i=i.innerRadius}=this.attribute,{padRadius:o=sqrt(a*a+i*i)}=(a+=o,i-=r,this.attribute),r=abs(t-e);let l=e,s=t,h=e,d=t;n/=2;let u=r,c=r;return epsilon<n&&epsilon<o&&(r=e<t?1:-1,i=asin(Number(o)/i*sin(n)),o=asin(Number(o)/a*sin(n)),(u-=2*i)>epsilon?(i*=r,h+=i,d-=i):(u=0,h=d=(e+t)/2),(c-=2*o)>epsilon?(o*=r,l+=o,s-=o):(c=0,l=s=(e+t)/2)),{outerStartAngle:l,outerEndAngle:s,innerStartAngle:h,innerEndAngle:d,innerDeltaAngle:u,outerDeltaAngle:c}}getGraphicTheme(){return getTheme(this).arc}updateAABBBounds(e,t,i,r){this.updatePathProxyAABBBounds(i)||(r?this.updateArcAABBBoundsImprecise(e,t,i):this.updateArcAABBBoundsAccurate(e,t,i));var{tb1:o,tb2:n}=application.graphicService.updateTempAABBBounds(i),{lineJoin:n=t.lineJoin}=(updateBoundsOfCommonOuterBorder(e,t,o),i.union(o),o.setValue(n.x1,n.y1,n.x2,n.y2),e);return application.graphicService.transformAABBBounds(e,i,t,\\\"miter\\\"===n,this),i}updateArcAABBBoundsImprecise(e,t,i){let{outerRadius:r=t.outerRadius,innerRadius:o=t.innerRadius}=e;var{outerPadding:n=t.outerPadding,innerPadding:a=t.innerPadding}=e;return o-=a,(r+=n)<o&&(r=o),i.set(-r,-r,r,r),i}updateArcAABBBoundsAccurate(e,t,i){let{outerRadius:r=t.outerRadius,innerRadius:o=t.innerRadius}=e;var{outerPadding:n=t.outerPadding,innerPadding:a=t.innerPadding}=e;r+=n,o-=a,r<o&&(n=r,r=o,o=n);let{endAngle:l=t.endAngle,startAngle:s=t.startAngle}=e;return s>l&&(a=s,s=l,l=a),r<=epsilon?i.set(0,0,0,0):Math.abs(l-s)>pi2-epsilon?i.set(-r,-r,r,r):(circleBounds(s,l,r,i),circleBounds(s,l,o,i)),i}needUpdateTags(e){return super.needUpdateTags(e,ARC_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,ARC_UPDATE_TAG_KEY)}toCustomPath(){var e=this.attribute,{startAngle:t,endAngle:i}=this.getParsedAngle();let r=(null!=(s=e.innerRadius)?s:0)-(null!=(s=e.innerPadding)?s:0),o=(null!=(s=e.outerRadius)?s:0)-(null!=(s=e.outerPadding)?s:0);var n,a,l,e=abs(i-t),s=t<i,h=(o<r&&(h=o,o=r,r=h),new CustomPath2D);return o<=epsilon?h.moveTo(0,0):pi2-epsilon<=e?(h.moveTo(0+o*cos(t),0+o*sin(t)),h.arc(0,0,o,t,i,!s),r>epsilon&&(h.moveTo(0+r*cos(i),0+r*sin(i)),h.arc(0,0,r,i,t,s))):(e=o*cos(t),n=o*sin(t),a=r*cos(i),l=r*sin(i),h.moveTo(0+e,0+n),h.arc(0,0,o,t,i,!s),h.lineTo(0+a,0+l),h.arc(0,0,r,i,t,s),h.closePath()),h}clone(){return new Rg0(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Rg0.NOWORK_ANIMATE_ATTR}};function createArc(e){return new Arc(e)}Arc.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},NOWORK_ANIMATE_ATTR),init_esbuild_inject();var ShadowRoot=class extends Group{constructor(e){super({x:0,y:0}),this.type=\\\"shadowroot\\\",this.shadowHost=e}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(e=!0){var t;return this.shouldUpdateGlobalMatrix()&&(t=this.transMatrix,this._globalTransMatrix?this._globalTransMatrix.setValue(t.a,t.b,t.c,t.d,t.e,t.f):this._globalTransMatrix=t.clone(),this.doUpdateGlobalMatrix(),e)&&this.clearUpdateGlobalPositionTag(),this._globalTransMatrix}doUpdateGlobalMatrix(){var e;this.shadowHost&&(e=this.shadowHost.globalTransMatrix,this._globalTransMatrix.multiply(e.a,e.b,e.c,e.d,e.e,e.f))}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}};function createShadowRoot(e){return new ShadowRoot(e)}var __decorate21=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},PickItemInterceptor=Symbol[\\\"for\\\"](\\\"PickItemInterceptor\\\"),ShadowRootPickItemInterceptorContribution=class{constructor(){this.order=1}afterPickItem(e,t,i,r,o){return 0<e.attribute.shadowRootIdx||!e.attribute.shadowRootIdx?this._pickItem(e,t,i,r,o):null}beforePickItem(e,t,i,r,o){return e.attribute.shadowRootIdx<0?this._pickItem(e,t,i,r,o):null}_pickItem(e,t,i,r,o){var n,a,l,s,h;return e.shadowRoot&&(l=(o||{}).parentMatrix,l)?((n=t.pickContext).highPerformanceSave(),a=null==(a=getTheme(e))?void 0:a[e.type],({shadowPickMode:a=null==a?void 0:a.shadowPickMode}=e.attribute),h=e.shadowRoot,l=matrixAllocate.allocateByObj(l),s=new Point(l.a*i.x+l.c*i.y+l.e,l.b*i.x+l.d*i.y+l.f),h=t.pickGroup(h,s,l,r),n.highPerformanceRestore(),!h.graphic&&h.group&&\\\"full\\\"===a&&(h.graphic=h.group),h):null}},ShadowRootPickItemInterceptorContribution=__decorate21([injectable()],ShadowRootPickItemInterceptorContribution),InteractivePickItemInterceptorContribution=class{constructor(){this.order=1}beforePickItem(e,t,i,r,o){var n,a,l,s=e.baseGraphic;return s&&s.parent?(n=new Point(i.x,i.y),(a=t.pickContext).highPerformanceSave(),(l=s.parent.globalTransMatrix).transformPoint(n,n),s=s.isContainer?t.pickGroup(s,n.clone(),l,r):t.pickItem(s,n.clone(),l,r),a.highPerformanceRestore(),s):null}},InteractivePickItemInterceptorContribution=__decorate21([injectable()],InteractivePickItemInterceptorContribution),Canvas3DPickItemInterceptor=class{constructor(){this.order=1}beforePickItem(e,t,i,r,o){var n,a;return e.in3dMode&&!r.in3dInterceptor&&(n=t.pickContext,a=e.stage,n)&&a?(r.in3dInterceptor=!0,n.save(),this.initCanvasCtx(n),n.camera=a.camera,e.isContainer?(a=draw3dItem(n,e,()=>t.pickGroup(e,i,o.parentMatrix,r),r),n.camera=null,r.in3dInterceptor=!1,n.restore(),a):(n.restore(),null)):null}initCanvasCtx(e){e.setTransformForCurrent()}},Canvas3DPickItemInterceptor=__decorate21([injectable()],Canvas3DPickItemInterceptor),pick_modules_default=new ContainerModule((e,t,i)=>{i(PickerService)||(e(GlobalPickerService).toSelf(),e(PickerService).toService(GlobalPickerService)),e(Canvas3DPickItemInterceptor).toSelf().inSingletonScope(),e(PickItemInterceptor).toService(Canvas3DPickItemInterceptor),e(ShadowRootPickItemInterceptorContribution).toSelf().inSingletonScope(),e(PickItemInterceptor).toService(ShadowRootPickItemInterceptorContribution),e(InteractivePickItemInterceptorContribution).toSelf().inSingletonScope(),e(PickItemInterceptor).toService(InteractivePickItemInterceptorContribution),bindContributionProvider(e,PickItemInterceptor)}),graphic_module_default=(init_esbuild_inject(),new ContainerModule(e=>{e(GraphicService).to(DefaultGraphicService).inSingletonScope(),e(GraphicCreator).toConstantValue(graphicCreator)})),AutoEnablePlugins=(init_esbuild_inject(),init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"AutoEnablePlugins\\\")),PluginService=Symbol[\\\"for\\\"](\\\"PluginService\\\"),__decorate22=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata17=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param14=function(i,r){return function(e,t){r(e,t,i)}},DefaultPluginService=class{constructor(e){this.autoEnablePlugins=e,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(e,t){this.stage=e,this.actived=!0;let i=t.pluginList;i&&container.isBound(AutoEnablePlugins)&&this.autoEnablePlugins.getContributions().forEach(e=>{i.includes(e.name)&&this.register(e)})}findPluginsByName(t){const i=[];return this.onStartupFinishedPlugin.forEach(e=>{e.name===t&&i.push(e)}),this.onRegisterPlugin.forEach(e=>{e.name===t&&i.push(e)}),i}register(e){\\\"onStartupFinished\\\"===e.activeEvent?this.onStartupFinishedPlugin.push(e):\\\"onRegister\\\"===e.activeEvent&&(this.onRegisterPlugin.push(e),e.activate(this))}unRegister(e){\\\"onStartupFinished\\\"===e.activeEvent?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(e),1):\\\"onRegister\\\"===e.activeEvent&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(e),1),e.deactivate(this)}release(){this.onStartupFinishedPlugin.forEach(e=>{e.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(e=>{e.deactivate(this)}),this.onRegisterPlugin=[]}},DefaultPluginService=__decorate22([injectable(),__param14(0,inject(ContributionProvider)),__param14(0,named(AutoEnablePlugins)),__metadata17(\\\"design:paramtypes\\\",[Object])],DefaultPluginService),plugin_modules_default=new ContainerModule(e=>{e(PluginService).to(DefaultPluginService),bindContributionProviderNoSingletonScope(e,AutoEnablePlugins)}),modules_default=(init_esbuild_inject(),init_esbuild_inject(),new ContainerModule(e=>{bindContributionProvider(e,EnvContribution)})),modules_default2=(init_esbuild_inject(),new ContainerModule(e=>{e(TextMeasureContribution).to(DefaultTextMeasureContribution).inSingletonScope(),bindContributionProvider(e,TextMeasureContribution)})),__decorate23=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata18=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},CanvasLayerHandlerContribution=class{constructor(){this.type=\\\"static\\\",this.offscreen=!1,this.global=application.global}setDpr(e){this.canvas.dpr=e}init(e,t,i){if(this.layer=e,this.window=t,i.main)this.main=!0,this.context=t.getContext(),this.canvas=this.context.getCanvas();else{let e;this.main=!1,(e=(e=i.canvasId?this.global.getElementById(i.canvasId):e)||this.global.createCanvas({width:t.width,height:t.height})).style&&(e.style[\\\"pointer-events\\\"]=\\\"none\\\");var r=t.getContext().getCanvas().nativeCanvas,r=wrapCanvas({nativeCanvas:e,width:t.width,height:t.height,dpr:t.dpr,id:i.canvasId,canvasControled:!0,container:t.getContainer(),x:r.offsetLeft,y:r.offsetTop});r.applyPosition(),this.canvas=r,this.context=r.getContext()}}resize(e,t){this.canvas.resize(e,t)}resizeView(e,t){}render(e,t,i){var r;this.main||!(r=this.window.getContext().getCanvas().nativeCanvas)||this.canvas.x===r.offsetLeft&&this.canvas.y===r.offsetTop||(this.canvas.x=r.offsetLeft,this.canvas.y=r.offsetTop,this.canvas.applyPosition()),t.renderService.render(e,Object.assign(Object.assign({context:this.context,clear:null!=(r=t.background)?r:\\\"#ffffff\\\"},t),i))}merge(e){e.forEach(e=>{var t=e.getContext().canvas.nativeCanvas;this.context.drawImage(t,0,0)})}prepare(e,t){}drawTo(e,t,i){var r=e.getContext();i.renderService.render(t,Object.assign(Object.assign({context:r},i),{clear:i.clear?null!=(r=i.background)?r:\\\"#fff\\\":void 0}))}getContext(){return this.context}release(){this.canvas.release()}},CanvasLayerHandlerContribution=__decorate23([injectable(),__metadata18(\\\"design:paramtypes\\\",[])],CanvasLayerHandlerContribution),modules_default3=new ContainerModule(e=>{e(CanvasLayerHandlerContribution).toSelf(),e(StaticLayerHandlerContribution).toService(CanvasLayerHandlerContribution)});function load(e){e.load(modules_default),e.load(modules_default2),e.load(modules_default3)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __awaiter3=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function parseChildMap(e,i,r){const o={},n=[];return e.forEachChildren(e=>{var{zIndex:t=i}=e.attribute;o[t]?o[t].push(e):(o[t]=[e],n.push(t))},r),n.sort((e,t)=>r?t-e:e-t),{childMap:o,zIdxArray:n}}function foreach(e,o,r,n=!1,a=!1){let l=!1;if(a)l=!0;else{let r;e.forEachChildren((e,t)=>{var{zIndex:i=o}=e.attribute;if(0===t)r=i;else if(r!==i)return l=!0;return!1},n)}if(l){var{childMap:s,zIdxArray:h}=parseChildMap(e,o,n);let t=!1;for(let i=0;i<h.length&&!t;i++){var d=s[h[i]];a&&d.sort((e,t)=>{var i;return(n?-1:1)*((null!=(i=t.attribute.z)?i:0)-(null!=(i=e.attribute.z)?i:0))});for(let e=0;e<d.length;e++)if(r(d[e],e)){t=!0;break}}}else e.forEachChildren(r,n)}function foreachAsync(e,t,i,r=!1){return __awaiter3(this,void 0,void 0,function*(){yield e.forEachChildrenAsync(i,r)})}function findNextGraphic(e,r,o,n=!1){let a=!1,l=(e.forEachChildren((e,t)=>{var{zIndex:i=o}=e.attribute;return 0!==t&&void 0!==i&&(a=!0)},n),null),s=!1;if(a){var{childMap:h,zIdxArray:d}=parseChildMap(e,o,n);let t=!1;for(let i=0;i<d.length&&!t;i++){var u=h[d[i]];for(let e=0;e<u.length;e++){if(s){t=!0,l=u[e];break}u[e]._uid===r&&(s=!0)}}}else e.forEachChildren(e=>s?(l=e,!0):(e._uid===r&&(s=!0),!1),n);return l}var STATUS2,__decorate24=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata19=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param15=function(i,r){return function(e,t){r(e,t,i)}},DefaultDrawContribution=class{constructor(e,t){this.contributions=e,this.drawItemInterceptorContributions=t,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new Bounds,this.backupDirtyBounds=new Bounds,this.global=application.global,this.layerService=application.layerService,this.init()}init(){this.contributions.forEach(e=>{var t;e.style?((t=this.styleRenderMap.get(e.style)||new Map).set(e.numberType,e),this.styleRenderMap.set(e.style,t)):this.defaultRenderMap.set(e.numberType,e)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((e,t)=>e.order-t.order)}prepareForDraw(e,t){t.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!t.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(e,t){this.prepareForDraw(e,t),(t.drawContribution=this).currentRenderMap=this.styleRenderMap.get(t.renderStyle)||this.defaultRenderMap,this.currentRenderService=e;var i,r,{context:o,stage:n,viewBox:a,transMatrix:l}=t;o&&(i=this.dirtyBounds.setValue(0,0,a.width(),a.height()),n.dirtyBounds&&!n.dirtyBounds.empty()&&(r=getRectIntersect(i,n.dirtyBounds,!1),i.x1=Math.floor(r.x1),i.y1=Math.floor(r.y1),i.x2=Math.ceil(r.x2),i.y2=Math.ceil(r.y2)),!(r=o.dpr%1)&&.5==r||(i.x1=Math.floor(i.x1*o.dpr)/o.dpr,i.y1=Math.floor(i.y1*o.dpr)/o.dpr,i.x2=Math.ceil(i.x2*o.dpr)/o.dpr,i.y2=Math.ceil(i.y2*o.dpr)/o.dpr),this.backupDirtyBounds.copy(i),o.inuse=!0,o.setClearMatrix(l.a,l.b,l.c,l.d,l.e,l.f),o.clearMatrix(),o.setTransformForCurrent(!0),o.translate(a.x1,a.y1,!0),o.beginPath(),o.rect(i.x1,i.y1,i.width(),i.height()),o.clip(),n.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(e,o,t),o.save(),e.renderTreeRoots.sort((e,t)=>{var i;return(null!=(i=e.attribute.zIndex)?i:DefaultAttribute.zIndex)-(null!=(i=t.attribute.zIndex)?i:DefaultAttribute.zIndex)}).forEach(e=>{e.isContainer?this.renderGroup(e,t,matrixAllocate.allocate(1,0,0,1,0,0)):this.renderItem(e,t)}),o.restore(),o.setClearMatrix(1,0,0,1,0,0),o.inuse=!1,o.draw())}doRegister(){throw new Error(\\\"暂不支持\\\")}_findNextGraphic(e){let t=e.parent,i=e._uid;for(;t;){var r=findNextGraphic(t,i,DefaultAttribute.zIndex);if(r)return r;i=t._uid,t=t.parent}return null}renderGroup(i,r,o,n){if(!r[\\\"break\\\"]&&!1!==i.attribute.visibleAll)if(!i.incremental||null!=r.startAtId&&r.startAtId!==i._uid){if(!this.useDirtyBounds||isRectIntersect(i.AABBBounds,this.dirtyBounds,!1)){let e,t=o;var a;this.useDirtyBounds&&(e=boundsAllocate.allocateByObj(this.dirtyBounds),a=i.transMatrix,t=matrixAllocate.allocateByObj(o).multiply(a.a,a.b,a.c,a.d,a.e,a.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(t.getInverse())),this.renderItem(i,r,{drawingCb:()=>{var e;n?i.forEachChildren(e=>{r[\\\"break\\\"]||(e.isContainer?this.renderGroup(e,r,t):this.renderItem(e,r))}):foreach(i,DefaultAttribute.zIndex,e=>{r[\\\"break\\\"]||(e.isContainer?this.renderGroup(e,r,t):this.renderItem(e,r))},!1,!(null==(e=r.context)||!e.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(e),boundsAllocate.free(e),matrixAllocate.free(t))}}else r[\\\"break\\\"]=!0,this._increaseRender(i,r)}_increaseRender(e,t){var{layer:i,stage:r}=t,i=i.subLayers;let o=i.get(e._uid);o||(o={layer:this.layerService.createLayer(r),zIndex:i.size,group:e},i.set(e._uid,o));var n=o.layer.getNativeHandler().getContext(),a=o.drawContribution||container.get(IncrementalDrawContribution),n=(a.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),a.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:\\\"transparent\\\",layer:o.layer,context:n,startAtId:e._uid,\\\"break\\\":!1})),o.drawContribution=a,this._findNextGraphic(e));if(n)if(n.isContainer&&n.incremental)this._increaseRender(n,t);else{let e=i.get(n._uid);e||(e={layer:this.layerService.createLayer(r),zIndex:i.size},i.set(n._uid,e));r=e.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:a,clear:\\\"transparent\\\",layer:e.layer,context:r,startAtId:n._uid,\\\"break\\\":!1}))}}getRenderContribution(e){let t;return t=(t=t||this.selectRenderByNumberType(e.numberType,e))||this.selectRenderByType(e.type)}renderItem(i,r,o){if(this.InterceptorContributions.length)for(let e=0;e<this.InterceptorContributions.length;e++){var t=this.InterceptorContributions[e];if(t.beforeDrawItem&&t.beforeDrawItem(i,this.currentRenderService,r,this,o))return}var n=this.getRenderContribution(i);if(n){let e,t=this.scrollMatrix&&(0!==this.scrollMatrix.e||0!==this.scrollMatrix.f);if(i.parent&&(({scrollX:l=0,scrollY:a=0}=i.parent.attribute),l||a)&&(t=!0,this.scrollMatrix||(this.scrollMatrix=matrixAllocate.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-l,-a)),t&&(e=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),!this.useDirtyBounds||i.isContainer||isRectIntersect(i.AABBBounds,null!=e?e:this.dirtyBounds,!1)){var a,l=null!=r.startAtId&&i._uid!==r.startAtId;if(i._uid===r.startAtId&&(r.startAtId=null),o&&(o.skipDraw=l),l&&!i.isContainer||n.draw(i,this.currentRenderService,r,o),t&&i.parent&&(({scrollX:a=0,scrollY:l=0}=i.parent.attribute),this.scrollMatrix)&&this.scrollMatrix.translate(a,l),this.InterceptorContributions.length)for(let e=0;e<this.InterceptorContributions.length;e++){var s=this.InterceptorContributions[e];if(s.afterDrawItem&&s.afterDrawItem(i,this.currentRenderService,r,this))return}}else t&&i.parent&&(({scrollX:n=0,scrollY:a=0}=i.parent.attribute),this.scrollMatrix)&&this.scrollMatrix.translate(n,a)}}selectRenderByType(e){return Logger.getInstance().warn(\\\"未知错误，不应该走到这里\\\"),null}selectRenderByNumberType(e,t){let i;var r;return t.attribute.renderStyle&&(r=this.styleRenderMap.get(t.attribute.renderStyle),i=r&&r.get(e)),i||this.currentRenderMap.get(e)||this.defaultRenderMap.get(e)}clearScreen(e,t,i){var r,o,{clear:n,viewBox:a}=i,l=a.width(),a=a.height();n&&(t.clearRect(0,0,l,a),(r=null==(r=e.drawParams)?void 0:r.stage)&&(t.globalAlpha=null!=(o=r.attribute.opacity)?o:1),r&&r.backgroundImg&&r.resources?(o=r.resources.get(n))&&\\\"success\\\"===o.state&&o.data&&t.drawImage(o.data,0,0,l,a):(t.fillStyle=createColor(t,n,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+a}},0,0),t.fillRect(0,0,l,a)))}afterDraw(e,t){}},DefaultDrawContribution=__decorate24([injectable(),__param15(0,multiInject(GraphicRender)),__param15(1,inject(ContributionProvider)),__param15(1,named(DrawItemInterceptor)),__metadata19(\\\"design:paramtypes\\\",[Array,Object])],DefaultDrawContribution),__decorate25=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultIncrementalCanvasLineRender=class extends DefaultCanvasLineRender{constructor(){super(...arguments),this.numberType=LINE_NUMBER_TYPE}drawShape(t,e,i,r,o,n,a,l){if(t.incremental&&o.multiGraphicOptions){var{startAtIdx:s,length:h}=o.multiGraphicOptions,{segments:d=[]}=t.attribute;if(!(s>d.length)){var u=getTheme(t).line,{fill:c=u.fill,stroke:g=u.stroke,opacity:p=u.opacity,fillOpacity:f=u.fillOpacity,strokeOpacity:m=u.strokeOpacity,lineWidth:b=u.lineWidth,visible:C=u.visible}=t.attribute,f=fillVisible(p,f,c),p=strokeVisible(p,m),m=runFill(c),c=runStroke(g,b);if(t.valid&&C&&(m||c)&&(f||p||a||l)){var v=o.context;for(let e=s;e<s+h;e++)this.drawIncreaseSegment(t,v,d[e-1],d[e],t.attribute.segments[e],[u,t.attribute],i,r)}}}else super.drawShape(t,e,i,r,o,n,a,l)}drawIncreaseSegment(e,t,i,r,o,n,a,l){r&&(t.beginPath(),drawIncrementalSegments(t.nativeContext,i,r,{offsetX:a,offsetY:l}),t.setShadowBlendStyle&&t.setShadowBlendStyle(e,o,n),t.setStrokeStyle(e,o,a,l,n),t.stroke())}},DefaultIncrementalCanvasLineRender=__decorate25([injectable()],DefaultIncrementalCanvasLineRender),__decorate26=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultIncrementalCanvasAreaRender=class extends DefaultCanvasAreaRender{constructor(){super(...arguments),this.numberType=AREA_NUMBER_TYPE}drawShape(t,i,r,o,e,n,a){if(t.incremental&&e.multiGraphicOptions){var{startAtIdx:l,length:s}=e.multiGraphicOptions,{segments:h=[]}=t.attribute;if(!(l>h.length)){var d=getTheme(t).area,{fill:u=d.fill,fillOpacity:c=d.fillOpacity,opacity:g=d.opacity,visible:p=d.visible}=t.attribute,g=fillVisible(g,c,u),c=runFill(u);if(t.valid&&p&&c&&(g||a))for(let e=l;e<l+s;e++)this.drawIncreaseSegment(t,i,h[e-1],h[e],t.attribute.segments[e],[d,t.attribute],r,o)}}else super.drawShape(t,i,r,o,e,n,a)}drawIncreaseSegment(e,t,i,r,o,n,a,l){r&&(t.beginPath(),drawIncrementalAreaSegments(t.camera?t:t.nativeContext,i,r,{offsetX:a,offsetY:l}),t.setShadowBlendStyle&&t.setShadowBlendStyle(e,o,n),t.setCommonStyle(e,o,a,l,n),t.fill())}},DefaultIncrementalCanvasAreaRender=__decorate26([injectable()],DefaultIncrementalCanvasAreaRender),__decorate27=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata20=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param16=function(i,r){return function(e,t){r(e,t,i)}},__awaiter4=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},DefaultIncrementalDrawContribution=(!function(e){e[e.NORMAL=0]=\\\"NORMAL\\\",e[e.STOP=1]=\\\"STOP\\\"}(STATUS2=STATUS2||{}),class extends DefaultDrawContribution{constructor(e,t,i,r){super(e,r),this.contributions=e,this.lineRender=t,this.areaRender=i,this.drawItemInterceptorContributions=r,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=STATUS2.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new SyncHook([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(i,r){return __awaiter4(this,void 0,void 0,function*(){if(!this.checkingForDrawPromise){this.lastRenderService=i,this.lastDrawContext=r,this.checkingForDrawPromise=this.checkForDraw(r);var e=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,!e){this.currentRenderService=i;let{context:e,viewBox:t}=r;e&&(e.inuse=!0,e.clearMatrix(),e.setTransformForCurrent(!0),e.save(),r.restartIncremental&&this.clearScreen(this.currentRenderService,e,r),e.translate(t.x1,t.y1,!0),e.save(),i.renderTreeRoots.sort((e,t)=>{var i;return(null!=(i=e.attribute.zIndex)?i:DefaultAttribute.zIndex)-(null!=(i=t.attribute.zIndex)?i:DefaultAttribute.zIndex)}).forEach(e=>{this.renderGroup(e,r)}),this.hooks.completeDraw.tap(\\\"top-draw\\\",()=>{e.restore(),e.restore(),e.draw(),e.inuse=!1,this.rendering=!1}))}}})}_increaseRender(e,t){return __awaiter4(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(e,t)})}_renderIncrementalGroup(r,o){return __awaiter4(this,void 0,void 0,function*(){this.count=r.count,yield new Promise(t=>{this.renderItem(r,o,{drawingCb:()=>__awaiter4(this,void 0,void 0,function*(){if(2!==r.count)yield foreachAsync(r,DefaultAttribute.zIndex,(e,t)=>{var i;return this.status===STATUS2.STOP||!(e.isContainer||t<this.currentIdx||(t<(i=this.currFrameStartAt+r.incremental)&&(this.currentIdx=t+1,this.renderItem(e,o)),t!==i-1))&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())});else{var e=r.getChildAt(0);if(e.incremental&&e.attribute.segments)for(e.incrementalAt||(e.incrementalAt=0);e.incrementalAt<e.attribute.segments.length;)o.multiGraphicOptions={startAtIdx:e.incrementalAt,length:e.incremental},this.renderItem(e,o),e.incrementalAt+=e.incremental,yield this.waitToNextFrame();else this.renderItem(e,o)}t(!1)})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return __awaiter4(this,void 0,void 0,function*(){return new Promise(e=>{this.global.getRequestAnimationFrame()(()=>{e(!1)})})})}checkForDraw(t){return __awaiter4(this,void 0,void 0,function*(){let e=this.rendering;return t.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return __awaiter4(this,void 0,void 0,function*(){this.rendering&&(this.status=STATUS2.STOP,yield new Promise(e=>{this.hooks.completeDraw.tap(\\\"stopCb\\\",()=>{this.status=STATUS2.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(e=>\\\"stopCb\\\"!==e.name),e(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(t,i){return __awaiter4(this,void 0,void 0,function*(){if(!i[\\\"break\\\"]&&!1!==t.attribute.visibleAll)return t.incremental&&i.startAtId===t._uid?(yield this._increaseRender(t,i),void(i[\\\"break\\\"]=!0)):void(yield new Promise(e=>{this.renderItem(t,i,{drawingCb:()=>__awaiter4(this,void 0,void 0,function*(){yield foreachAsync(t,DefaultAttribute.zIndex,e=>__awaiter4(this,void 0,void 0,function*(){i[\\\"break\\\"]||e.isContainer&&(yield this.renderGroup(e,i))})),e(!1)})})}))})}}),DefaultIncrementalDrawContribution=__decorate27([injectable(),__param16(0,multiInject(GraphicRender)),__param16(1,inject(DefaultIncrementalCanvasLineRender)),__param16(2,inject(DefaultIncrementalCanvasAreaRender)),__param16(3,inject(ContributionProvider)),__param16(3,named(DrawItemInterceptor)),__metadata20(\\\"design:paramtypes\\\",[Array,Object,Object,Object])],DefaultIncrementalDrawContribution),module_default=new ContainerModule(e=>{e(DefaultBaseBackgroundRenderContribution).toSelf().inSingletonScope(),e(DefaultBaseTextureRenderContribution).toSelf().inSingletonScope(),e(DrawContribution).to(DefaultDrawContribution),e(IncrementalDrawContribution).to(DefaultIncrementalDrawContribution),e(GroupRender).to(DefaultCanvasGroupRender).inSingletonScope(),e(GraphicRender).toService(GroupRender),bindContributionProvider(e,GroupRenderContribution),e(DefaultBaseInteractiveRenderContribution).toSelf().inSingletonScope(),bindContributionProvider(e,InteractiveSubRenderContribution),bindContributionProvider(e,GraphicRender),e(CommonDrawItemInterceptorContribution).toSelf().inSingletonScope(),e(DrawItemInterceptor).toService(CommonDrawItemInterceptorContribution),bindContributionProvider(e,DrawItemInterceptor)});function load2(e){e.load(module_default)}function preLoadAllModule(){preLoadAllModule.__loaded||(preLoadAllModule.__loaded=!0,container.load(core_modules_default),container.load(graphic_module_default),container.load(render_modules_default),container.load(pick_modules_default),container.load(plugin_modules_default),load(container),load2(container))}preLoadAllModule.__loaded=!1,preLoadAllModule();var _isBrowserEnv,vglobal=container.get(VGlobal),graphicUtil=(application.global=vglobal,container.get(GraphicUtil)),transformUtil=(application.graphicUtil=graphicUtil,container.get(TransformUtil)),graphicService=(application.transformUtil=transformUtil,container.get(GraphicService)),layerService=(application.graphicService=graphicService,container.get(LayerService)),AutoRenderPlugin=(application.layerService=layerService,init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class{constructor(){this.name=\\\"AutoRenderPlugin\\\",this.activeEvent=\\\"onRegister\\\",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=e=>{(e=e.glyphHost?e.glyphHost:e).stage===this.pluginService.stage&&null!=e.stage&&e.stage.renderNextFrame()}}activate(e){this.pluginService=e,application.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),application.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),application.graphicService.hooks.onRemove.tap(this.key,this.handleChange)}deactivate(e){var t=e=>e.filter(e=>e.name!==this.key);application.graphicService.hooks.onAttributeUpdate.taps=t(application.graphicService.hooks.onAttributeUpdate.taps),application.graphicService.hooks.onSetStage.taps=t(application.graphicService.hooks.onSetStage.taps),application.graphicService.hooks.onRemove.taps=t(application.graphicService.hooks.onRemove.taps)}}),AutoRefreshPlugin=(init_esbuild_inject(),class{constructor(){this.name=\\\"AutoRefreshPlugin\\\",this.activeEvent=\\\"onRegister\\\",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=e=>{(e=e.glyphHost?e.glyphHost:e).stage===this.pluginService.stage&&null!=e.stage&&e.stage.renderNextFrame()}}activate(e){this.pluginService=e,this.dpr=application.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){var e=application.global.getRequestAnimationFrame();this.rafId=e(()=>{application.global.devicePixelRatio!==this.dpr&&(this.dpr=application.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{var e=`(resolution: ${window.devicePixelRatio}dppx)`;matchMedia(e).addEventListener(\\\"change\\\",()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))})}catch(err){return!1}return!0}deactivate(e){var t=application.global.getCancelAnimationFrame();t&&this.rafId&&t(this.rafId)}}),IncrementalAutoRenderPlugin=(init_esbuild_inject(),class{constructor(){this.name=\\\"IncrementalAutoRenderPlugin\\\",this.activeEvent=\\\"onRegister\\\",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid}activate(r){this.pluginService=r,application.graphicService.hooks.onAddIncremental.tap(this.key,(e,t,i)=>{(e=e.glyphHost?e.glyphHost:e).stage===r.stage&&null!=e.stage&&(this.nextUserParams.startAtId=t._uid,this.renderNextFrame(t))}),application.graphicService.hooks.onClearIncremental.tap(this.key,(e,t)=>{e.stage===r.stage&&null!=e.stage&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))})}deactivate(e){application.graphicService.hooks.onAddIncremental.taps=application.graphicService.hooks.onAddIncremental.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.onClearIncremental.taps=application.graphicService.hooks.onClearIncremental.taps.filter(e=>e.name!==this.key)}renderNextFrame(e){this.nextFrameRenderGroupSet.add(e),this.willNextFrameRender||(this.willNextFrameRender=!0,application.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){const r=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{var t,i=e.layer;i&&e.layer.subLayers&&(t=e.layer.subLayers.get(e._uid))&&t.drawContribution&&t.drawContribution.draw(r.renderService,Object.assign({stage:r,layer:i,viewBox:r.window.getViewBox(),transMatrix:r.window.getViewBoxTransform(),clear:\\\"transparent\\\",renderService:r.renderService,updateBounds:!1,startAtId:e._uid,context:t.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}),globalBounds=(init_esbuild_inject(),new AABBBounds),DirtyBoundsPlugin=class{constructor(){this.name=\\\"DirtyBoundsPlugin\\\",this.activeEvent=\\\"onRegister\\\",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid}activate(e){(this.pluginService=e).stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&e.dirtyBounds.clear()}),application.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(e,t,i,r)=>{e.glyphHost&&(e=e.glyphHost),t&&t===this.pluginService.stage&&t.renderCount&&(e.isContainer&&!e.shouldSelfChangeUpdateAABBBounds()||i&&(globalBounds.setValue(r.x1,r.y1,r.x2,r.y2),t.dirty(globalBounds,e.parent&&e.parent.globalTransMatrix)))}),application.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(e,t,i,r,o)=>{t&&t===this.pluginService.stage&&t.renderCount&&(e.isContainer&&!o||t.dirty(r.globalAABBBounds))}),application.graphicService.hooks.clearAABBBounds.tap(this.key,(e,t,i)=>{t&&t===this.pluginService.stage&&t.renderCount&&t&&t.dirty(i)}),application.graphicService.hooks.onRemove.tap(this.key,e=>{var t=e.stage;t&&t===this.pluginService.stage&&t.renderCount&&t&&t.dirty(e.globalAABBBounds)})}deactivate(e){application.graphicService.hooks.beforeUpdateAABBBounds.taps=application.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.afterUpdateAABBBounds.taps=application.graphicService.hooks.afterUpdateAABBBounds.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.clearAABBBounds.taps=application.graphicService.hooks.clearAABBBounds.taps.filter(e=>e.name!==this.key),e.stage.hooks.afterRender.taps=e.stage.hooks.afterRender.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.onRemove.taps=application.graphicService.hooks.onRemove.taps.filter(e=>e.name!==this.key)}},defaultTicker=(init_esbuild_inject(),new DefaultTicker);function initIsBrowserEnv(){if(null==_isBrowserEnv)try{var e=document.createElement(\\\"canvas\\\"),t=e.getContext(\\\"2d\\\");_isBrowserEnv=(_isBrowserEnv=!!(window&&e.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&t&&t.isPointInPath&&t.isPointInStroke))&&!!document.createElement}catch(err){_isBrowserEnv=!1}}function isBrowserEnv(){initIsBrowserEnv();var e=application.global&&application.global.env;return e?\\\"browser\\\"===e:_isBrowserEnv}function isNodeEnv(){initIsBrowserEnv();var e=application.global&&application.global.env;return e?\\\"node\\\"===e:!_isBrowserEnv}defaultTicker.addTimeline(defaultTimeline),defaultTicker.setFPS(60),init_esbuild_inject(),init_esbuild_inject();var Factory=class Fn0{static registerPlugin(e,t){Fn0._pluginClasses[e]=t}static getPlugin(e){return Fn0._pluginClasses[e]}},DefaultConfig=(Factory._pluginClasses={},{WIDTH:500,HEIGHT:500,X:0,Y:0,BACKGROUND:\\\"white\\\"}),Stage=class extends Group{set viewBox(e){this.window.setViewBox(e)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(e){var t=this.window.getViewBox();t.translate(e-t.x1,0),this.window.setViewBox(t)}get y(){return this.window.getViewBox().y1}set y(e){var t=this.window.getViewBox();t.translate(0,e-t.y1),this.window.setViewBox(t)}get width(){return this.window.width}set width(e){this.resize(e,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(e){this.resizeView(e,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(e){this.resizeView(this.viewWidth,e)}get height(){return this.window.height}set height(e){this.resize(this.width,e)}get dpr(){return this.window.dpr}set dpr(e){this.setDpr(e)}get background(){var e;return null!=(e=this._background)?e:DefaultConfig.BACKGROUND}set background(e){this._background=e}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}constructor(e={}){var t;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=e=>{var t;this._skipRender<0||(e?(this.dirtyBounds&&(t=this.window.getViewBox(),this.dirtyBounds.setValue(t.x1,t.y1,t.width(),t.height())),1<this._skipRender&&this.renderNextFrame(),this._skipRender=0):this._skipRender=1)},this.beforeRender=e=>{this._beforeRender&&this._beforeRender(e)},this.afterRender=t=>{this.renderCount++,this._afterRender&&this._afterRender(t),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(e=>e(t)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{var e;this.tickedBeforeRender=!0,\\\"performance\\\"!==(null==(e=this.params.optimize)?void 0:e.tickRenderMode)&&\\\"rendering\\\"!==this.state&&this.render()},this.params=e,this.theme=new Theme,this.hooks={beforeRender:new SyncHook([\\\"stage\\\"]),afterRender:new SyncHook([\\\"stage\\\"])},this.global=application.global,!this.global.env&&isBrowserEnv()&&this.global.setEnv(\\\"browser\\\"),this.window=container.get(VWindow),this.renderService=container.get(RenderService),this.pluginService=container.get(PluginService),this.layerService=container.get(LayerService),this.pluginService.active(this,e),this.window.create({width:e.width,height:e.height,viewBox:e.viewBox,container:e.container,dpr:e.dpr||this.global.devicePixelRatio,canvasControled:!1!==e.canvasControled,title:e.title||\\\"\\\",canvas:e.canvas}),this.state=\\\"normal\\\",this.renderCount=0,this.tryInitEventSystem(),this._background=null!=(t=e.background)?t:DefaultConfig.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,(this.stage=this).renderStyle=e.renderStyle,e.autoRender&&this.enableAutoRender(),e.autoRefresh&&this.enableAutoRefresh(),!1===e.disableDirtyBounds&&this.enableDirtyBounds(),e.enableHtmlAttribute&&this.enableHtmlAttribute(e.enableHtmlAttribute),e.ReactDOM&&this.enableReactAttribute(e.ReactDOM),e.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap(\\\"constructor\\\",this.beforeRender),this.hooks.afterRender.tap(\\\"constructor\\\",this.afterRender),this._beforeRender=e.beforeRender,this._afterRender=e.afterRender,this.ticker=e.ticker||defaultTicker,this.supportInteractiveLayer=!1!==e.interactiveLayer,this.timeline=new DefaultTimeline,this.ticker.addTimeline(this.timeline),this.timeline.pause(),e.optimize||(e.optimize={}),this.optmize(e.optimize),e.background&&isString_default(this._background)&&this._background.includes(\\\"/\\\")&&this.setAttributes({background:this._background}),this.ticker.on(\\\"afterTick\\\",this.afterTickCb)}pauseRender(e=-1){this._skipRender=e}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new EventSystem(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(e){e?this._skipRender=-1/0:!1!==this.params.optimize.skipRenderWithOutRange?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(e){this.optmizeRender(e.skipRenderWithOutRange),this.params.optimize=e}optmizeRender(e=!1){e&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(e){var{center:t={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:i={},alpha:r=0,beta:o=0,camera:n,fieldRatio:a=1,fieldDepth:l}=e;return Object.assign(Object.assign({},e),{center:t,light:i,alpha:r,beta:o,camera:n,fieldRatio:a,fieldDepth:l})}set3dOptions(e){this.option3d=e;var t=this.get3dOptions(e),{light:t,center:i,camera:r,alpha:o,beta:n,fieldRatio:a,fieldDepth:l}=t,{dir:t=[1,1,-1],color:s=\\\"white\\\",ambient:h}=t,d=(null!=(d=i.x)?d:this.width/2)+(null!=(d=i.dx)?d:0),u=(null!=(u=i.y)?u:this.height/2)+(null!=(u=i.dy)?u:0),i=[d,u,(null!=(f=i.z)?f:0)+(null!=(f=i.dz)?f:0)];let c=0,g=0,p=0;r||(c=Math.sin(o)+d,g=Math.sin(n)+u,p=Math.cos(o)*Math.cos(n)*1);var f=Factory.getPlugin(\\\"DirectionalLight\\\"),r=(f&&(this.light=new f(t,s,h)),{left:0,right:this.width,top:0,bottom:this.height,fieldRatio:a,fieldDepth:l,viewParams:{pos:[c,g,p],center:i,up:[0,1,0]}});this.camera?this.camera.params=r:(d=Factory.getPlugin(\\\"OrthoCamera\\\"))&&(this.camera=new d(r)),e.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(e){this._beforeRender=e}setAfterRender(e){this._afterRender=e}afterNextRender(e){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(e)}enableView3dTransform(){var e;!this.view3dTranform&&(this.view3dTranform=!0,e=Factory.getPlugin(\\\"ViewTransform3dPlugin\\\"))&&this.pluginService.register(new e)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName(\\\"ViewTransform3dPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new AutoRenderPlugin))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName(\\\"AutoRenderPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new AutoRefreshPlugin))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName(\\\"AutoRefreshPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new IncrementalAutoRenderPlugin))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName(\\\"IncrementalAutoRenderPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableDirtyBounds(){if(!this.dirtyBounds){this.dirtyBounds=new Bounds;let e=this.pluginService.findPluginsByName(\\\"DirtyBoundsPlugin\\\")[0];e?e.activate(this.pluginService):(e=new DirtyBoundsPlugin,this.pluginService.register(e))}}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName(\\\"DirtyBoundsPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableLayout(){var e;!this._enableLayout&&(this._enableLayout=!0,e=Factory.getPlugin(\\\"FlexLayoutPlugin\\\"))&&this.pluginService.register(new e)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName(\\\"FlexLayoutPlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableHtmlAttribute(e){var t;this.htmlAttribute||(t=Factory.getPlugin(\\\"HtmlAttributePlugin\\\"))&&(this.htmlAttribute=e,this.pluginService.register(new t))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName(\\\"HtmlAttributePlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}enableReactAttribute(e){var t;this.reactAttribute||(t=Factory.getPlugin(\\\"ReactAttributePlugin\\\"))&&(this.reactAttribute=e,this.pluginService.register(new t))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName(\\\"ReactAttributePlugin\\\").forEach(e=>{this.pluginService.unRegister(e)}))}getPluginsByName(e){return this.pluginService.findPluginsByName(e)}tryUpdateAABBBounds(){var e=this.window.getViewBox();return this._AABBBounds.setValue(e.x1,e.y1,e.x2,e.y2),this._AABBBounds}combineLayer(e,t){throw new Error(\\\"暂不支持\\\")}createLayer(e,t){var i;if(\\\"released\\\"!==this.releaseStatus)return i=this.layerService.createLayer(this,{main:!1,layerMode:t,canvasId:e}),this.appendChild(i),i}sortLayer(e){var t=this.children;t.sort(e),this.removeAllChild(),t.forEach(e=>{this.appendChild(e)})}removeLayer(e){return this.removeChild(this.findChildByUid(e))}tryInitInteractiveLayer(){\\\"released\\\"!==this.releaseStatus&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name=\\\"_builtin_interactive\\\",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(e){this.window.clearViewBox(e)}render(e,t){var i;\\\"released\\\"!==this.releaseStatus&&(this.ticker.start(),this.timeline.resume(),i=this.state,this.state=\\\"rendering\\\",this.tickedBeforeRender||this.ticker.trySyncTickStatus(),this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=t,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=i,this._skipRender)&&this._skipRender++}combineLayersToWindow(){if(\\\"harmony\\\"===this.global.env){const r=this.window.getContext().nativeContext;this.forEachChildren((e,t)=>{var i;0<t&&(i=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap(),r.transferFromImageBitmap(i))})}}renderNextFrame(e,t){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(e||this).forEach(e=>{this.nextFrameRenderLayerSet.add(e)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){var e;\\\"released\\\"!==this.releaseStatus&&(this.timeline.resume(),this.ticker.start(),e=this.state,this.state=\\\"rendering\\\",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=e,this._skipRender)&&this._skipRender++}renderLayerList(t,i){var r=[];for(let o=0;o<t.length;o++){let e=t[o];\\\"virtual\\\"===e.layerMode&&(e=e.getNativeHandler().mainHandler.layer),r.includes(e)||r.push(e)}r.forEach(e=>{e.renderCount>this.renderCount||(e.renderCount=this.renderCount+1,e===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),e.render({renderService:this.renderService,background:e===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},i)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},i)))}resizeWindow(e,t,i=!0){this.window.resize(e,t),i&&this.render()}resize(t,i,e=!0){\\\"released\\\"!==this.releaseStatus&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+i),this.window.resize(t,i),this.forEachChildren(e=>{e.resize(t,i)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),e)&&this.render()}resizeView(t,i,e=!0){\\\"released\\\"!==this.releaseStatus&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+i),this.forEachChildren(e=>{e.resizeView(t,i)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),e)&&this.render()}setViewBox(e,t,i,r,o){let n=!0;\\\"object\\\"==typeof e?(this.viewBox.setValue(e.x1,e.y1,e.x2,e.y2),!1===t&&(n=!1)):(this.viewBox.setValue(e,t,e+i,t+r),!1===o&&(n=!1)),this.forEachChildren(e=>{e.resizeView(this.viewBox.width(),this.viewBox.height())}),n&&this.render()}setDpr(t,e=!0){this.forEachChildren(e=>{e.setDpr(t)}),e&&this.render()}setOrigin(e,t){throw new Error(\\\"暂不支持\\\")}\\\"export\\\"(e){throw new Error(\\\"暂不支持\\\")}pick(e,t){var i;if(\\\"released\\\"!==this.releaseStatus)return!!(null!=(i=this.getPickerService().pick(this.children,new Point(e,t),{bounds:this.AABBBounds}))&&i.graphic||null!=i&&i.group)&&i}startAnimate(e){throw new Error(\\\"暂不支持\\\")}setToFrame(e){throw new Error(\\\"暂不支持\\\")}release(){super.release(),this.hooks.beforeRender.unTap(\\\"constructor\\\",this.beforeRender),this.hooks.afterRender.unTap(\\\"constructor\\\",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(e=>{e.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(e=>{e.setStage&&e.setStage(null,null),this.interactiveLayer.removeChild(e)}),this.interactiveLayer.release()),this.window.release(),this.ticker.remTimeline(this.timeline),this.ticker.removeListener(\\\"afterTick\\\",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(e){}dirty(e,t){\\\"released\\\"!==this.releaseStatus&&(t&&e.transformWithMatrix(t),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(e.x1,e.y1,e.x2,e.y2),this.dirtyBounds.union(e))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(i){\\\"released\\\"!==this.releaseStatus&&this.forEachChildren((e,t)=>{e.drawTo(i,{renderService:this.renderService,viewBox:i.getViewBox(),transMatrix:i.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:0===t,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(e=0,t){var i,r,o,n,a,l,s;if(\\\"released\\\"!==this.releaseStatus)return i=container.get(VWindow),r=t?-t.x1:0,o=t?-t.y1:0,n=t?t.x2:this.viewWidth,a=t?t.y2:this.viewHeight,l=t?t.width():this.viewWidth,s=t?t.height():this.viewHeight,i.create({viewBox:{x1:r,y1:o,x2:n,y2:a},width:l,height:s,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:\\\"\\\"}),this.renderTo(i),i}toCanvas(e=!0,t){if(\\\"released\\\"!==this.releaseStatus)return this.renderToNewWindow(e,t).getNativeHandler().nativeCanvas||null}setCursor(e){this._cursor=e,this.eventSystem.setCursor(e,\\\"ignore\\\")}getCursor(){return this._cursor}eventPointTransform(e){var t=this.global.mapToCanvasPoint(e,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(t.x,t.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=container.get(PickerService)),this.pickerService}};function createStage(e){return new Stage(e)}init_esbuild_inject();var DefaultConfig2={WIDTH:500,HEIGHT:500,DPR:1},BaseCanvas=class{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get nativeCanvas(){return this._nativeCanvas}get width(){return this._pixelWidth}set width(e){this._pixelWidth=e,this._displayWidth=e/(this._dpr||1)}get height(){return this._pixelHeight}set height(e){this._pixelHeight=e,this._displayHeight=e/(this._dpr||1)}getContext(e){return this._context}get visiable(){return this._visiable}set visiable(e){(this._visiable=e)?this.show():this.hide()}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this.resize(this._displayWidth,this._displayHeight)}constructor(e){var{nativeCanvas:t,width:i=DefaultConfig2.WIDTH,height:r=DefaultConfig2.HEIGHT,dpr:o=DefaultConfig2.DPR,x:n,y:a,id:l,canvasControled:s=!0}=e;this._x=null!=n?n:0,this._y=null!=a?a:0,this._pixelWidth=i*o,this._pixelHeight=r*o,this._visiable=!1!==e.visiable,this.controled=s,this._displayWidth=i,this._displayHeight=r,this._dpr=o,this._nativeCanvas=t,this._id=null!=(n=t.id)?n:l,l&&(t.id=l),this.init(e)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(e){}resize(e,t){}toDataURL(e,t){return\\\"\\\"}readPixels(e,t,i,r){return this._context.getImageData(e,t,i,r)}convertToBlob(e){throw new Error(\\\"暂未实现\\\")}transferToImageBitmap(){throw new Error(\\\"暂未实现\\\")}release(){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}},__decorate28=(BaseCanvas.env=\\\"browser\\\",init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__awaiter5=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},BaseEnvContribution=class{configure(e){e.env===this.type&&e.setActiveEnvContribution(this)}getNativeAABBBounds(e){return new AABBBounds}removeDom(e){return!1}createDom(e){return null}updateDom(e,t){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(e){return document.getElementById(e)}getRootElement(){return document.body}loadJson(e){var t=fetch(e).then(e=>e.json());return t.then(e=>({data:e,state:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,state:\\\"fail\\\"})),t}loadArrayBuffer(e){return fetch(e).then(e=>e.arrayBuffer()).then(e=>({data:e,loadState:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,loadState:\\\"fail\\\"}))}loadBlob(e){return fetch(e).then(e=>e.blob()).then(e=>({data:e,loadState:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,loadState:\\\"fail\\\"}))}getElementTop(e,t){return 0}getElementLeft(e,t){return 0}getElementTopLeft(e,t){return{top:0,left:0}}loadFont(e,t,i){return __awaiter5(this,void 0,void 0,function*(){return{loadState:\\\"fail\\\"}})}},BaseEnvContribution=__decorate28([injectable()],BaseEnvContribution),__decorate29=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata21=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BaseWindowHandlerContribution=class{constructor(){this._uid=Generator.GenAutoIncrementId(),this.viewBox=new AABBBounds,this.modelMatrix=new Matrix(1,0,0,1,0,0)}onChange(e){this._onChangeCb=e}configure(e,t){t.env===this.type&&e.setWindowHandler(this)}release(){this.releaseWindow()}isVisible(e){return!0}onVisibleChange(e){}getTopLeft(e){return{top:0,left:0}}setViewBox(e){this.viewBox.setValue(e.x1,e.y1,e.x2,e.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(e,t,i,r,o,n){this.modelMatrix.setValue(e,t,i,r,o,n)}getViewBoxTransform(){return this.modelMatrix}},BaseWindowHandlerContribution=__decorate29([injectable(),__metadata21(\\\"design:paramtypes\\\",[])],BaseWindowHandlerContribution),__decorate30=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata22=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param17=function(i,r){return function(e,t){r(e,t,i)}},DefaultPickService=class{constructor(e){this.pickItemInterceptorContributions=e,this.type=\\\"default\\\",this.global=application.global}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((e,t)=>e.order-t.order)}pick(i,r,o){let n={graphic:null,group:null};o.pickerService=this;var e=o.bounds.width(),t=o.bounds.height();if((new AABBBounds).setValue(0,0,e,t).containsPoint(r)){this.pickContext&&(this.pickContext.inuse=!0),o.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);var a=new Matrix(1,0,0,1,0,0);let e;for(let t=i.length-1;0<=t&&!(n=i[t].isContainer?this.pickGroup(i[t],r,a,o):this.pickItem(i[t],r,a,o)).graphic;t--)e=e||n.group;if(n.graphic||(n.group=e),this.pickContext&&(this.pickContext.inuse=!1),n.graphic){let e=n.graphic;for(;e.parent;)e=e.parent;e.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=e.shadowHost)}}return n}containsPoint(e,t,i){var r;return!(null==(r=this.pickItem(e,t,null,null!=i?i:{pickContext:this.pickContext,pickerService:this}))||!r.graphic)}pickGroup(o,n,a,l){let s={group:null,graphic:null};if(!1!==o.attribute.visibleAll){var t=l.pickContext,i=t.modelMatrix;if(t.camera&&(d=o.transMatrix,mat3Tomat4(h=mat4Allocate.allocate(),d),i?h&&(d=mat4Allocate.allocate(),t.modelMatrix=multiplyMat4Mat4(d,i,h),mat4Allocate.free(h)):(mat3Tomat4(h,o.globalTransMatrix),t.modelMatrix=h)),this.InterceptorContributions.length)for(let e=0;e<this.InterceptorContributions.length;e++){var r=this.InterceptorContributions[e];if(r.beforePickItem){r=r.beforePickItem(o,this,n,l,{parentMatrix:a});if(r)return t.modelMatrix!==i&&mat4Allocate.free(t.modelMatrix),t.modelMatrix=i,r}}const e=o.transMatrix,u=matrixAllocate.allocateByObj(a),c=new Point(n.x,n.y);u.transformPoint(c,c);var h,d=o.AABBBounds.containsPoint(c);(d||o.stage.camera)&&((h=this.pickItem(o,c.clone(),a,l))&&h.graphic&&(s.graphic=h.graphic,s.params=h.params),d=!1!==o.attribute.pickable&&d,u.multiply(e.a,e.b,e.c,e.d,e.e,e.f),!1===o.attribute.childrenPickable||h&&h.graphic||foreach(o,DefaultAttribute.zIndex,e=>{var t,i,r;return e.isContainer?(r=new Point(n.x,n.y),i=getTheme(o).group,({scrollX:t=i.scrollX,scrollY:i=i.scrollY}=o.attribute),r.x-=t,r.y-=i,s=this.pickGroup(e,r,u,l)):(t=new Point(n.x,n.y),u.transformPoint(t,t),i=getTheme(o).group,({scrollX:r=i.scrollX,scrollY:i=i.scrollY}=o.attribute),t.x-=r,t.y-=i,(r=this.pickItem(e,t,a,l))&&r.graphic&&(s.graphic=r.graphic,s.params=r.params)),!!s.graphic||!!s.group},!0,!!t.camera),t.modelMatrix!==i&&mat4Allocate.free(t.modelMatrix),t.modelMatrix=i,s.graphic||s.group||!d||o.stage.camera||(s.group=o),matrixAllocate.free(u))}return s}selectPicker(e){return this.pickerMap.get(e.numberType)||null}},DefaultPickService=__decorate30([injectable(),__param17(0,inject(ContributionProvider)),__param17(0,named(PickItemInterceptor)),__metadata22(\\\"design:paramtypes\\\",[Object])],DefaultPickService),loadArcModule=(init_esbuild_inject(),!1),arcModule=new ContainerModule(e=>{loadArcModule||(loadArcModule=!0,e(DefaultCanvasArcRender).toSelf().inSingletonScope(),e(ArcRender).to(DefaultCanvasArcRender).inSingletonScope(),e(GraphicRender).toService(ArcRender),e(ArcRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,ArcRenderContribution))}),loadRectModule=(init_esbuild_inject(),!1),rectModule=new ContainerModule(e=>{loadRectModule||(loadRectModule=!0,e(DefaultCanvasRectRender).toSelf().inSingletonScope(),e(RectRender).to(DefaultCanvasRectRender).inSingletonScope(),e(GraphicRender).toService(RectRender),e(SplitRectAfterRenderContribution).toSelf(),e(SplitRectBeforeRenderContribution).toSelf(),e(RectRenderContribution).toService(SplitRectAfterRenderContribution),e(RectRenderContribution).toService(SplitRectBeforeRenderContribution),e(RectRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,RectRenderContribution))}),loadLineModule=(init_esbuild_inject(),!1),lineModule=new ContainerModule(e=>{loadLineModule||(loadLineModule=!0,e(DefaultCanvasLineRender).toSelf().inSingletonScope(),e(DefaultIncrementalCanvasLineRender).toSelf().inSingletonScope(),e(LineRender).to(DefaultCanvasLineRender).inSingletonScope(),e(GraphicRender).toService(LineRender))}),loadSymbolModule=(init_esbuild_inject(),!1),symbolModule=new ContainerModule(e=>{loadSymbolModule||(loadSymbolModule=!0,e(DefaultCanvasSymbolRender).toSelf().inSingletonScope(),e(SymbolRender).to(DefaultCanvasSymbolRender).inSingletonScope(),e(GraphicRender).toService(SymbolRender),e(SymbolRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,SymbolRenderContribution))}),loadCircleModule=(init_esbuild_inject(),!1),circleModule=new ContainerModule(e=>{loadCircleModule||(loadCircleModule=!0,e(DefaultCanvasCircleRender).toSelf().inSingletonScope(),e(CircleRender).to(DefaultCanvasCircleRender).inSingletonScope(),e(GraphicRender).toService(CircleRender),e(CircleRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,CircleRenderContribution))}),loadTextModule=(init_esbuild_inject(),!1),textModule=new ContainerModule(e=>{loadTextModule||(loadTextModule=!0,e(TextRender).to(DefaultCanvasTextRender).inSingletonScope(),e(GraphicRender).toService(TextRender),e(TextRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,TextRenderContribution))}),__decorate31=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata23=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},DefaultCanvasRichTextRender=class extends BaseRender{constructor(){super(),this.numberType=RICHTEXT_NUMBER_TYPE,this.builtinContributions=[defaultTextBackgroundRenderContribution],this.init()}drawShape(e,t,i,r,o){var n=getTheme(e).richtext,{strokeOpacity:a=n.strokeOpacity,opacity:l=n.opacity,fillOpacity:s=n.fillOpacity,visible:h=n.visible}=e.attribute;e.valid&&h&&(h=fillVisible(l,s,!0),s=fillVisible(l,a,!0),h)&&(t.setShadowBlendStyle&&t.setShadowBlendStyle(e,e.attribute,n),t.translate(i,r),this.beforeRenderStep(e,t,i,r,h,s,h,s,n,o),e.getFrameCache().draw(t,this.drawIcon),this.afterRenderStep(e,t,i,r,h,s,h,s,n,o))}drawIcon(e,t,i,r,o){var n=getTheme(e).richtextIcon,{width:a=n.width,height:l=n.height,opacity:s=n.opacity,image:h,backgroundFill:d=n.backgroundFill,backgroundFillOpacity:u=n.backgroundFillOpacity,backgroundStroke:c=n.backgroundStroke,backgroundStrokeOpacity:g=n.backgroundStrokeOpacity,backgroundRadius:n=n.backgroundRadius,margin:p}=e.attribute,{backgroundWidth:f=a,backgroundHeight:m=l}=e.attribute,b=(p&&(i+=e._marginArray[3],r+=e._marginArray[0]),e._hovered&&(p=(f-a)/2,b=(m-l)/2,0===n?(t.beginPath(),t.rect(i-p,r-b,f,m)):(t.beginPath(),createRectPath(t,i-p,r-b,f,m,n)),d&&(t.globalAlpha=u,t.fillStyle=d,t.fill()),c)&&(t.globalAlpha=g,t.strokeStyle=c,t.stroke()),h&&(null==(p=null==e?void 0:e.resources)?void 0:p.get(h)));b&&\\\"success\\\"===b.state&&(t.globalAlpha=s,t.drawImage(b.data,i,r,a,l))}draw(e,t,i){var r=getTheme(e).richtext;this._draw(e,r,!1,i)}},DefaultCanvasRichTextRender=__decorate31([injectable(),__metadata23(\\\"design:paramtypes\\\",[])],DefaultCanvasRichTextRender),loadRichtextModule=!1,richtextModule=new ContainerModule(e=>{loadRichtextModule||(loadRichtextModule=!0,e(RichTextRender).to(DefaultCanvasRichTextRender).inSingletonScope(),e(GraphicRender).toService(RichTextRender))}),loadImageModule=(init_esbuild_inject(),!1),imageModule=new ContainerModule(e=>{loadImageModule||(loadImageModule=!0,e(ImageRender).to(DefaultCanvasImageRender).inSingletonScope(),e(GraphicRender).toService(ImageRender),e(ImageRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(e,ImageRenderContribution))});function registerArcGraphic(){graphicCreator.RegisterGraphicCreator(\\\"arc\\\",createArc)}function registerCircleGraphic(){graphicCreator.RegisterGraphicCreator(\\\"circle\\\",createCircle)}function registerGroupGraphic(){graphicCreator.RegisterGraphicCreator(\\\"group\\\",createGroup)}function registerImageGraphic(){graphicCreator.RegisterGraphicCreator(\\\"image\\\",createImage)}function registerLineGraphic(){graphicCreator.RegisterGraphicCreator(\\\"line\\\",createLine)}function registerRectGraphic(){graphicCreator.RegisterGraphicCreator(\\\"rect\\\",createRect)}function registerRichtextGraphic(){graphicCreator.RegisterGraphicCreator(\\\"richtext\\\",createRichText)}function registerSymbolGraphic(){graphicCreator.RegisterGraphicCreator(\\\"symbol\\\",createSymbol)}function registerTextGraphic(){graphicCreator.RegisterGraphicCreator(\\\"text\\\",createText)}function registerShadowRootGraphic(){graphicCreator.RegisterGraphicCreator(\\\"shadowRoot\\\",createShadowRoot)}function registerWrapTextGraphic(){graphicCreator.RegisterGraphicCreator(\\\"wrapText\\\",createWrapText)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var _tempBounds2=new AABBBounds,FlexLayoutPlugin=class{constructor(){this.name=\\\"FlexLayoutPlugin\\\",this.activeEvent=\\\"onRegister\\\",this.id=Generator.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new AABBBounds}pauseLayout(e){this.pause=e}tryLayoutChildren(e){e.firstChild&&this.tryLayout(e.firstChild)}tryLayout(e,t=!0){if(this.pause)return;const i=e.parent;if(!(t||i&&e.needUpdateLayout()))return;var r=getTheme(i).group,{display:o=r.display}=i.attribute;if(\\\"flex\\\"!==o)return;let{flexDirection:n=r.flexDirection,flexWrap:a=r.flexWrap,alignItems:l=r.alignItems,clip:s=r.clip}=i.attribute,{alignContent:h=null!=l?l:r.alignContent}=i.attribute,{width:d,height:u,justifyContent:c=r.justifyContent}=i.attribute;const g=i.getChildren();if(null==d||null==u){let i=0,r=0,o=0;if(g.forEach(e=>{var t=this.getAABBBounds(e);t.empty()||(\\\"column\\\"===n||\\\"column-reverse\\\"===n?(r+=t.height(),i=Math.max(i,t.width())):(i+=t.width(),r=Math.max(r,t.height())),o=(o=(o=(o+=t.x1)+t.y1)+t.x2)+t.y2)}),!isFinite(o))return;d=i,u=r}null==i.attribute.width?i.attribute.width=d:d=i.attribute.width,null==i.attribute.height?i.attribute.height=u:u=i.attribute.height,this.tempBounds.copy(i._AABBBounds);const p={main:{len:d,field:\\\"x\\\"},cross:{len:u,field:\\\"y\\\"}},f=p.main,m=p.cross;\\\"column\\\"!==n&&\\\"column-reverse\\\"!==n||(f.len=u,m.len=d,f.field=\\\"y\\\",m.field=\\\"x\\\"),\\\"row-reverse\\\"!==n&&\\\"column-reverse\\\"!==n||(\\\"flex-start\\\"===c?c=\\\"flex-end\\\":\\\"flex-end\\\"===c?c=\\\"flex-start\\\":g.reverse());let b=0,C=0;const v=[],y=(g.forEach(e=>{var t,i=this.getAABBBounds(e);i.empty()||(t=\\\"x\\\"===f.field?i.width():i.height(),i=\\\"x\\\"===m.field?i.width():i.height(),v.push({mainLen:t,crossLen:i}),b+=t,C=Math.max(C,i))}),[]);if(b>f.len&&\\\"wrap\\\"===a){let r=0,o=0;v.forEach(({mainLen:e,crossLen:t},i)=>{o=r+e>f.len?0===r?(y.push({idx:i,mainLen:r+e,crossLen:t}),r=0):(y.push({idx:i-1,mainLen:r,crossLen:o}),r=e,t):(r+=e,Math.max(o,t))}),y.push({idx:v.length-1,mainLen:r,crossLen:o})}else y.push({idx:v.length-1,mainLen:b,crossLen:C});let w=0;if(y.forEach(e=>{this.layoutMain(i,g,c,f,v,w,e),w=e.idx+1}),C=y.reduce((e,t)=>e+t.crossLen,0),1===y.length){o={\\\"flex-start\\\":0,\\\"flex-end\\\":m.len,center:m.len/2};this.layoutCross(g,l,m,o,v,y[0],0)}else if(\\\"flex-start\\\"===h){let r=w=0;y.forEach((e,t)=>{var i={\\\"flex-start\\\":r,\\\"flex-end\\\":r+e.crossLen,center:r+e.crossLen/2};this.layoutCross(g,\\\"flex-start\\\",m,i,v,y[t],w),w=e.idx+1,r+=e.crossLen})}else if(\\\"center\\\"===h){w=0;let r=Math.max(0,(m.len-C)/2);y.forEach((e,t)=>{var i={\\\"flex-start\\\":r,\\\"flex-end\\\":r+e.crossLen,center:r+e.crossLen/2};this.layoutCross(g,\\\"center\\\",m,i,v,y[t],w),w=e.idx+1,r+=e.crossLen})}else if(\\\"space-around\\\"===h){w=0;const _=Math.max(0,(m.len-C)/y.length/2);let r=_;y.forEach((e,t)=>{var i={\\\"flex-start\\\":r,\\\"flex-end\\\":r+e.crossLen,center:r+e.crossLen/2};this.layoutCross(g,\\\"flex-start\\\",m,i,v,y[t],w),w=e.idx+1,r+=e.crossLen+2*_})}else if(\\\"space-between\\\"===h){w=0;const S=Math.max(0,(m.len-C)/(2*y.length-2));let r=0;y.forEach((e,t)=>{var i={\\\"flex-start\\\":r,\\\"flex-end\\\":r+e.crossLen,center:r+e.crossLen/2};this.layoutCross(g,\\\"flex-start\\\",m,i,v,y[t],w),w=e.idx+1,r+=e.crossLen+2*S})}g.forEach((e,t)=>{e.addUpdateBoundTag(),e.addUpdatePositionTag(),e.clearUpdateLayoutTag()}),i.addUpdateLayoutTag();r=this.getAABBBounds(i);s||this.tempBounds.equals(r)||this.tryLayout(i,!1)}getAABBBounds(e){this.skipBoundsTrigger=!0;var t=e.AABBBounds;return this.skipBoundsTrigger=!1,t}updateChildPos(e,t,i){return e+(null!=t?t:0)-i}layoutMain(e,i,t,r,o,n,a){if(\\\"flex-start\\\"===t){let e=0;for(let t=n;t<=a.idx;t++){var l=e+getPadding(i[t],r.field),s=this.getAABBBounds(i[t]);s.empty()||(i[t].attribute[r.field]=this.updateChildPos(l,i[t].attribute[r.field],s[r.field+\\\"1\\\"])),e+=o[t].mainLen}}else if(\\\"flex-end\\\"===t){let e=r.len;for(let t=a.idx;t>=n;t--){var h=(e-=o[t].mainLen)+getPadding(i[t],r.field),d=this.getAABBBounds(i[t]);d.empty()||(i[t].attribute[r.field]=this.updateChildPos(h,i[t].attribute[r.field],d[r.field+\\\"1\\\"]))}}else if(\\\"space-around\\\"===t)if(a.mainLen>=r.len){let e=0;for(let t=n;t<=a.idx;t++){var u=e+getPadding(i[t],r.field),c=this.getAABBBounds(i[t]);c.empty()||(i[t].attribute[r.field]=this.updateChildPos(u,i[t].attribute[r.field],c[r.field+\\\"1\\\"])),e+=o[t].mainLen}}else{var g=a.idx-n+1,p=(r.len-a.mainLen)/g/2;let e=p;for(let t=n;t<=a.idx;t++){var f=e+getPadding(i[t],r.field),m=this.getAABBBounds(i[t]);m.empty()||(i[t].attribute[r.field]=this.updateChildPos(f,i[t].attribute[r.field],m[r.field+\\\"1\\\"])),e+=o[t].mainLen+2*p}}else if(\\\"space-between\\\"===t)if(a.mainLen>=r.len){let e=0;for(let t=n;t<=a.idx;t++){var b=e+getPadding(i[t],r.field),C=this.getAABBBounds(i[t]);C.empty()||(i[t].attribute[r.field]=this.updateChildPos(b,i[t].attribute[r.field],C[r.field+\\\"1\\\"])),e+=o[t].mainLen}}else{var g=a.idx-n+1,v=(r.len-a.mainLen)/(2*g-2);let e=0;for(let t=n;t<=a.idx;t++){var y=e+getPadding(i[t],r.field),w=this.getAABBBounds(i[t]);w.empty()||(i[t].attribute[r.field]=this.updateChildPos(y,i[t].attribute[r.field],w[r.field+\\\"1\\\"])),e+=o[t].mainLen+2*v}}else if(\\\"center\\\"===t){let e=(r.len-a.mainLen)/2;for(let t=n;t<=a.idx;t++){var _=e+getPadding(i[t],r.field),S=this.getAABBBounds(i[t]);S.empty()||(i[t].attribute[r.field]=this.updateChildPos(_,i[t].attribute[r.field],S[r.field+\\\"1\\\"])),e+=o[t].mainLen}}}layoutCross(t,i,r,o,n,e,a){for(let d=a;d<=e.idx;d++){var l=t[d];let e=l.attribute.alignSelf;e&&\\\"auto\\\"!==e||(e=i);var s=this.getAABBBounds(l),h=null!=(h=o[e])?h:o[\\\"flex-start\\\"];\\\"flex-end\\\"===e?s.empty()||(l.attribute[r.field]=this.updateChildPos(h-n[d].crossLen+getPadding(l,r.field),l.attribute[r.field],s[r.field+\\\"1\\\"])):\\\"center\\\"===e?s.empty()||(l.attribute[r.field]=this.updateChildPos(h-n[d].crossLen/2+getPadding(l,r.field),l.attribute[r.field],s[r.field+\\\"1\\\"])):s.empty()||(l.attribute[r.field]=this.updateChildPos(h+getPadding(l,r.field),l.attribute[r.field],s[r.field+\\\"1\\\"]))}}activate(e){this.pluginService=e,application.graphicService.hooks.onAttributeUpdate.tap(this.key,e=>{(e=e.glyphHost?e.glyphHost:e).stage&&e.stage===this.pluginService.stage&&this.tryLayout(e,!1)}),application.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(e,t,i,r)=>{e.glyphHost&&(e=e.glyphHost),t&&t===this.pluginService.stage&&e.isContainer&&!this.skipBoundsTrigger&&_tempBounds2.copy(r)}),application.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(e,t,i,r,o)=>{!t||t!==this.pluginService.stage||!e.isContainer||this.skipBoundsTrigger||_tempBounds2.equals(i)||this.tryLayout(e,!1)}),application.graphicService.hooks.onSetStage.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),this.tryLayout(e,!1)})}deactivate(e){application.graphicService.hooks.onAttributeUpdate.taps=application.graphicService.hooks.onAttributeUpdate.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.beforeUpdateAABBBounds.taps=application.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.afterUpdateAABBBounds.taps=application.graphicService.hooks.afterUpdateAABBBounds.taps.filter(e=>e.name!==this.key),application.graphicService.hooks.onSetStage.taps=application.graphicService.hooks.onSetStage.taps.filter(e=>e.name!==this.key)}};function getPadding(e,t){return 0}var registerFlexLayoutPlugin=()=>{Factory.registerPlugin(\\\"FlexLayoutPlugin\\\",FlexLayoutPlugin)},GROUP_ATTRIBUTES=[\\\"x\\\",\\\"y\\\",\\\"dx\\\",\\\"dy\\\",\\\"scaleX\\\",\\\"scaleY\\\",\\\"angle\\\",\\\"anchor\\\",\\\"postMatrix\\\",\\\"visible\\\",\\\"clip\\\",\\\"pickable\\\",\\\"childrenPickable\\\",\\\"zIndex\\\",\\\"cursor\\\"],AbstractComponent=class extends Group{constructor(e,t){super(e),null!=t&&t.mode&&(this.mode=t.mode,this.setMode(t.mode)),null!=t&&t.skipDefault&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=e,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(e,t,i,r){var o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[e]:t},this.attribute,e,r);if(o)return this._setAttributes(o,i);isPlainObject_default(this.attribute[e])&&isPlainObject_default(t)&&!isFunction_default(this.attribute[e])&&!isFunction_default(t)?merge(this.attribute[e],t):this.attribute[e]=t,GROUP_ATTRIBUTES.includes(e)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTag(e)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(e,t,i){return e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,i)||e,this._setAttributes(e,t)}_setAttributes(e,t){var i=Object.keys(e);this._mergeAttributes(e,i),i.every(e=>GROUP_ATTRIBUTES.includes(e))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!t&&!this.needUpdateTags(i)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(e,t){isNil_default(t)&&(t=Object.keys(e));for(let r=0;r<t.length;r++){var i=t[r];!isPlainObject_default(this.attribute[i])||isFunction_default(this.attribute[i])||isFunction_default(e[i])?this.attribute[i]=e[i]:merge(this.attribute[i],e[i])}}bindEvents(){}_getNodeId(e){var t;return`${null!=(t=this.id)?t:this._uid}-${this.name}-`+e}_dispatchEvent(e,t){var i,r=new CustomEvent(e,t);r.manager=null==(i=this.stage)?void 0:i.eventSystem.manager,this.dispatchEvent(r)}},MathPickerContribution=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),Symbol[\\\"for\\\"](\\\"MathPickerContribution\\\")),MathArcPicker=Symbol[\\\"for\\\"](\\\"MathArcPicker\\\"),MathAreaPicker=Symbol[\\\"for\\\"](\\\"MathAreaPicker\\\"),MathCirclePicker=Symbol[\\\"for\\\"](\\\"MathCirclePicker\\\"),MathImagePicker=Symbol[\\\"for\\\"](\\\"MathImagePicker\\\"),MathLinePicker=Symbol[\\\"for\\\"](\\\"MathLinePicker\\\"),MathPathPicker=Symbol[\\\"for\\\"](\\\"MathPathPicker\\\"),MathRectPicker=Symbol[\\\"for\\\"](\\\"MathRectPicker\\\"),MathSymbolPicker=Symbol[\\\"for\\\"](\\\"MathSymbolPicker\\\"),MathTextPicker=Symbol[\\\"for\\\"](\\\"MathTextPicker\\\"),MathPolygonPicker=Symbol[\\\"for\\\"](\\\"MathPolygonPicker\\\"),MathGlyphPicker=Symbol[\\\"for\\\"](\\\"MathGlyphPicker\\\"),CanvasArcPicker=Symbol[\\\"for\\\"](\\\"CanvasArcPicker\\\"),CanvasArc3dPicker=Symbol[\\\"for\\\"](\\\"CanvasArc3dPicker\\\"),CanvasAreaPicker=Symbol[\\\"for\\\"](\\\"CanvasAreaPicker\\\"),CanvasCirclePicker=Symbol[\\\"for\\\"](\\\"CanvasCirclePicker\\\"),CanvasImagePicker=Symbol[\\\"for\\\"](\\\"CanvasImagePicker\\\"),CanvasGifImagePicker=Symbol[\\\"for\\\"](\\\"CanvasGifImagePicker\\\"),CanvasLinePicker=Symbol[\\\"for\\\"](\\\"CanvasLinePicker\\\"),CanvasPathPicker=Symbol[\\\"for\\\"](\\\"CanvasPathPicker\\\"),CanvasRectPicker=Symbol[\\\"for\\\"](\\\"CanvasRectPicker\\\"),CanvasRect3dPicker=Symbol[\\\"for\\\"](\\\"CanvasRect3dPicker\\\"),CanvasSymbolPicker=Symbol[\\\"for\\\"](\\\"CanvasSymbolPicker\\\"),CanvasTextPicker=Symbol[\\\"for\\\"](\\\"CanvasTextPicker\\\"),CanvasPolygonPicker=Symbol[\\\"for\\\"](\\\"CanvasPolygonPicker\\\"),CanvasPyramid3dPicker=Symbol[\\\"for\\\"](\\\"CanvasPyramid3dPicker\\\"),CanvasRichTextPicker=Symbol[\\\"for\\\"](\\\"CanvasRichTextPicker\\\"),CanvasGlyphPicker=Symbol[\\\"for\\\"](\\\"CanvasGlyphPicker\\\"),CanvasGroupPicker=Symbol[\\\"for\\\"](\\\"CanvasGroupPicker\\\"),CanvasPickerContribution=Symbol[\\\"for\\\"](\\\"CanvasPickerContribution\\\"),REACT_TO_CANOPUS_EVENTS=(init_esbuild_inject(),{onPointerDown:\\\"pointerdown\\\",onPointerUp:\\\"pointerup\\\",onPointerUpOutside:\\\"pointerupoutside\\\",onPointerTap:\\\"pointertap\\\",onPointerOver:\\\"pointerover\\\",onPointerMove:\\\"pointermove\\\",onPointerEnter:\\\"pointerenter\\\",onPointerLeave:\\\"pointerleave\\\",onPointerOut:\\\"pointerout\\\",onMouseDown:\\\"mousedown\\\",onMouseUp:\\\"mouseup\\\",onMouseUpOutside:\\\"mouseupoutside\\\",onMouseMove:\\\"mousemove\\\",onMouseOver:\\\"mouseover\\\",onMouseOut:\\\"mouseout\\\",onMouseEnter:\\\"mouseenter\\\",onMouseLeave:\\\"mouseleave\\\",onPinch:\\\"pinch\\\",onPinchStart:\\\"pinchstart\\\",onPinchEnd:\\\"pinchend\\\",onPan:\\\"pan\\\",onPanStart:\\\"panstart\\\",onPanEnd:\\\"panend\\\",onDrag:\\\"drag\\\",onDragStart:\\\"dragstart\\\",onDragEnter:\\\"dragenter\\\",onDragLeave:\\\"dragleave\\\",onDragOver:\\\"dragover\\\",onDragEnd:\\\"dragend\\\",onRightDown:\\\"rightdown\\\",onRightUp:\\\"rightup\\\",onRightUpOutside:\\\"rightupoutside\\\",onTouchStart:\\\"touchstart\\\",onTouchEnd:\\\"touchend\\\",onTouchEndOutside:\\\"touchendoutside\\\",onTouchMove:\\\"touchmove\\\",onTouchCancel:\\\"touchcancel\\\",onPress:\\\"press\\\",onPressUp:\\\"pressup\\\",onPressEnd:\\\"pressend\\\",onSwipe:\\\"swipe\\\",onDrop:\\\"drop\\\",onWeel:\\\"wheel\\\",onClick:\\\"click\\\",onDblClick:\\\"dblclick\\\"}),REACT_TO_CANOPUS_EVENTS_LIST=Object.keys(REACT_TO_CANOPUS_EVENTS);function VRichText(e){return graphicCreator.richtext(e?e.attribute:{})}VRichText.Text=function(e){return Object.assign({type:\\\"rich/text\\\"},e)},VRichText.Image=function(e){return Object.assign({type:\\\"rich/image\\\"},e)},init_esbuild_inject(),init_esbuild_inject();var calcDirection=(e,t)=>{var i=t.x-e.x,r=t.y-e.y;return Math.abs(i)>Math.abs(r)?0<i?\\\"right\\\":\\\"left\\\":0<r?\\\"down\\\":\\\"up\\\"},calcDistance=(e,t)=>{var i=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return Math.sqrt(i*i+r*r)},getCenter=e=>{var t=e.length;if(1===t)return{x:Math.round(e[0].x),y:Math.round(e[0].y)};let i=0,r=0,o=0;for(;o<t;)i+=e[o].x,r+=e[o].y,o++;return{x:Math.round(i/t),y:Math.round(r/t)}},Gesture=class extends import_eventemitter3[\\\"default\\\"]{constructor(e,t={}){var i;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=e=>{this.cachedEvents=[],this.startPoints=[],this.reset(),this.startTime=clock.now();let{cachedEvents:t,startPoints:i}=this;e&&t.push(e.clone()),i.length=t.length;for(let n=0;n<t.length;n++){var{x:r,y:o}=t[n];i[n]={x:r,y:o}}if(1!==i.length)this.startDistance=calcDistance(i[0],i[1]),this.center=getCenter([i[0],i[1]]);else{const a=t[0];this.pressTimeout=setTimeout(()=>{a.direction=\\\"none\\\",a.deltaX=0,a.deltaY=0,a.points=i,this.triggerStartEvent(\\\"press\\\",a),this.triggerEvent(\\\"press\\\",a),this.eventType=\\\"press\\\",this.direction=\\\"none\\\",this.pressTimeout=null},this.config.press.time)}},this.onMove=i=>{this.clearPressTimeout();var{startPoints:r,cachedEvents:o}=this;if(r.length){var n=i.clone(),{x:a,y:l,pointerId:s}=n;for(let e=0,t=o.length;e<t;e++)if(s===o[e].pointerId){o[e]=n;break}var h={x:a,y:l},d=o.map(e=>({x:e.x,y:e.y})),u=clock.now();this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=u,this.lastMovePoint=h,1===r.length?(a=a-(u=r[0]).x,r=l-u.y,l=this.direction||calcDirection(u,h),this.direction=l,u=this.getEventType(h),n.direction=l,n.deltaX=a,n.deltaY=r,n.points=d,this.triggerStartEvent(u,n),this.triggerEvent(u,n)):(h=this.startDistance,l=calcDistance(d[0],d[1]),n.scale=l/h,n.center=this.center,n.points=d,this.triggerStartEvent(\\\"pinch\\\",n),this.triggerEvent(\\\"pinch\\\",n))}},this.onEnd=e=>{var t=e.clone(),{cachedEvents:i,startPoints:r}=this,o=i.map(e=>({x:e.x,y:e.y}));if(t.points=o,this.triggerEndEvent(t),1===i.length){var o=clock.now(),n=this.lastMoveTime;if(o-n<100){n=n-(this.prevMoveTime||this.startTime);if(0<n){var a=this.prevMovePoint||r[0],l=this.lastMovePoint||r[0],s=calcDistance(a,l),n=s/n;if(n>this.config.swipe.velocity&&s>this.config.swipe.threshold)return t.velocity=n,t.direction=calcDirection(a,l),this.triggerEvent(\\\"swipe\\\",t),this.cachedEvents=[],this.startPoints=[],void this.reset()}}o-this.startTime<this.config.press.time&&(o-this.lastTapTime<this.config.tap.interval&&e.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=o,this.lastTapTarget=e.target,1===this.tapCount?this.triggerEvent(\\\"tap\\\",t):2===this.tapCount&&(this.triggerEvent(\\\"doubletap\\\",t),this.tapCount=0))}for(let h=0,d=i.length;h<d;h++)if(i[h].pointerId===t.pointerId){i.splice(h,1),r.splice(h,1);break}this.reset(),0<i.length&&this.onStart()},this.element=e,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:null!=(i=null==(i=null==t?void 0:t.press)?void 0:i.time)?i:251,threshold:null!=(i=null==(i=null==t?void 0:t.press)?void 0:i.threshold)?i:9},swipe:{threshold:null!=(i=null==(i=null==t?void 0:t.swipe)?void 0:i.threshold)?i:10,velocity:null!=(i=null==(i=null==t?void 0:t.swipe)?void 0:i.velocity)?i:.3},tap:{interval:null!=(i=null==(i=null==t?void 0:t.tap)?void 0:i.interval)?i:300}},this.initEvents()}initEvents(){var e=this.element;e&&(e.addEventListener(\\\"pointerdown\\\",this.onStart),e.addEventListener(\\\"pointermove\\\",this.onMove),e.addEventListener(\\\"pointerup\\\",this.onEnd),e.addEventListener(\\\"pointerupoutside\\\",this.onEnd))}removeEvents(){var e=this.element;e&&(e.removeEventListener(\\\"pointerdown\\\",this.onStart),e.removeEventListener(\\\"pointermove\\\",this.onMove),e.removeEventListener(\\\"pointerup\\\",this.onEnd),e.removeEventListener(\\\"pointerupoutside\\\",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(e){var{eventType:t,startTime:i,startPoints:r}=this;return\\\"press\\\"===t?t:(t=clock.now()-i>this.config.press.time&&calcDistance(r[0],e)<this.config.press.threshold?\\\"press\\\":\\\"pan\\\",this.eventType=t)}enable(e){this.processEvent[e]=!0}isProcess(e){return this.processEvent[e]}pushEvent(e,t){var i=this.emitThrottles,r={type:e,ev:t};for(let o=0,n=i.length;o<n;o++)if(i[o].type===e)return void i.splice(o,1,r);i.push(r)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(e,t){this.pushEvent(e,t);let{throttleTimer:i,emitThrottles:o}=this;i||(this.throttleTimer=application.global.getRequestAnimationFrame()(()=>{application.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let i=0,r=o.length;i<r;i++){var{type:e,ev:t}=o[i];this.emitEvent(e,t)}this.emitThrottles.length=0}))}triggerStartEvent(e,t){this.isProcess(e)||(this.enable(e),this.triggerEvent(e+\\\"start\\\",t))}triggerEndEvent(t){const i=this.processEvent;Object.keys(i).forEach(e=>{this.triggerEvent(e+\\\"end\\\",t),\\\"press\\\"===e&&this.triggerEvent(e+\\\"up\\\",t),delete i[e]})}emitEvent(i,r){if(this.element){var o=this.element._events[WILDCARD];if(o)if(\\\"fn\\\"in o)o.fn.call(o.context,r,i);else for(let e=0,t=o.length;e<t&&!r.propagationImmediatelyStopped;e++)o[e].fn.call(o[e].context,r,i);this.emit(i,r)}}},__decorate32=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata24=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},outP=[0,0,0],addArcToBezierPath2=(e,t,i,r,o,n,a,l)=>{if(l)for(;t<i;)i-=pi2;else for(;i<t;)i+=pi2;var s=pi/3*(t<i?1:-1);let h=t,d=h;for(;d!==i;){d=0<s?Math.min(d+s,i):Math.max(d+s,i);var u=Math.abs(d-h),u=4*Math.tan(u/4)/3,c=d<h?-1:1,g=Math.cos(h),p=Math.sin(h),f=Math.cos(d),m=Math.sin(d),b=f*n+r,C=m*a+o,v=n*u*c,u=a*u*c;e.push([g*n+r-v*p,p*a+o+u*g,b+v*m,C-u*f,b,C]),h=d}},BrowserContext2d=class{set fillStyle(e){this.nativeContext.fillStyle=e}get fillStyle(){return this.nativeContext.fillStyle}set font(e){this.nativeContext.font=e}get font(){return this.nativeContext.font}set globalAlpha(e){this.nativeContext.globalAlpha=e*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(e){this.nativeContext.lineCap=e}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(e){this.nativeContext.lineDashOffset=e}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(e){this.nativeContext.lineJoin=e}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(e){this.nativeContext.lineWidth=e}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(e){this.nativeContext.miterLimit=e}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(e){this.nativeContext.shadowBlur=e}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(e){this.nativeContext.shadowColor=e}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(e){this.nativeContext.shadowOffsetX=e}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(e){this.nativeContext.shadowOffsetY=e}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(e){this.nativeContext.strokeStyle=e}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(e){this.nativeContext.textAlign=e}get textAlign(){return this.nativeContext.textAlign}set textBaseline(e){this.nativeContext.textBaseline=e}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(e){e!==!!this._inuse&&((this._inuse=e)?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(e,t){this.fillAttributes=Object.assign(Object.assign({},DefaultFillStyle),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},DefaultStrokeStyle),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},DefaultTextStyle),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;var i=e.nativeCanvas.getContext(\\\"2d\\\");if(!i)throw new Error(\\\"发生错误，获取2d上下文失败\\\");this.nativeContext=i,this.canvas=e,this.matrix=new Matrix(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new Matrix(1,0,0,1,0,0),this._clearMatrix=new Matrix(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(){this.stack.length&&Logger.getInstance().warn(\\\"可能存在bug，matrix没有清空\\\"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Matrix(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(e=!1){!e&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(e){return matrixAllocate.allocateByObj(e)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),0<this.stack.length&&(matrixAllocate.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}highPerformanceRestore(){0<this.stack.length&&(matrixAllocate.free(this.matrix),this.matrix=this.stack.pop())}rotate(e,t=!0){this.matrix.rotate(e),t&&this.setTransformForCurrent()}save(){var e=this.cloneMatrix(this.matrix);this.stack.push(e),this.nativeContext.save()}highPerformanceSave(){var e=this.cloneMatrix(this.matrix);this.stack.push(e)}scale(e,t,i=!0){this.matrix.scale(e,t),i&&this.setTransformForCurrent()}setScale(e,t,i=!0){this.matrix.setScale(e,t),i&&this.setTransformForCurrent()}scalePoint(e,t,i,r,o=!0){this.translate(i,r,!1),this.scale(e,t,!1),this.translate(-i,-r,!1),o&&this.setTransformForCurrent()}setTransform(e,t,i,r,o,n,a=!0,l=this.dpr){this.matrix.setValue(l*e,l*t,l*i,l*r,l*o,l*n),a&&this.setTransformForCurrent()}setTransformFromMatrix(e,t=!0,i=this.dpr){this.matrix.setValue(e.a*i,e.b*i,e.c*i,e.d*i,e.e*i,e.f*i),t&&this.setTransformForCurrent()}resetTransform(e=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),e&&this.setTransformForCurrent()}transform(e,t,i,r,o,n,a=!0){this.matrix.multiply(e,t,i,r,o,n),a&&this.setTransformForCurrent()}transformFromMatrix(e,t){this.matrix.multiply(e.a,e.b,e.c,e.d,e.e,e.f),t&&this.setTransformForCurrent()}translate(e,t,i=!0){this.matrix.translate(e,t),i&&this.setTransformForCurrent()}rotateDegrees(e,t=!0){var i=e*Math.PI/180;this.rotate(i,t)}rotateAbout(e,t,i,r=!0){this.translate(t,i,!1),this.rotate(e,!1),this.translate(-t,-i,!1),r&&this.setTransformForCurrent()}rotateDegreesAbout(e,t,i,r=!0){this.translate(t,i,!1),this.rotateDegrees(e,!1),this.translate(-t,-i,!1),r&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(e,t){e?\\\"string\\\"==typeof e?this.nativeContext.clip(e):this.nativeContext.clip(e,t):this.nativeContext.clip()}arc(t,i,r,o,n,a,l){if(l=l||0,this.camera){var s=[];addArcToBezierPath2(s,o,n,t,i,r,r,a);for(let e=0;e<s.length;++e){var h=s[e];this.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5],l)}}else this.nativeContext.arc(t,i,Math.max(0,r),o,n,a)}arcTo(e,t,i,r,o){this.nativeContext.arcTo(e,t,i,r,o)}bezierCurveTo(i,r,o,n,a,l,s){if(s=s||0,this.camera){let e=s,t=s;this.modelMatrix&&(transformMat4(outP,[i,r,s],this.modelMatrix),i=outP[0],r=outP[1],e=outP[2],transformMat4(outP,[o,n,s],this.modelMatrix),o=outP[0],n=outP[1],t=outP[2],transformMat4(outP,[a,l,s],this.modelMatrix),a=outP[0],l=outP[1],s=outP[2]);var h=this.camera.vp(a,l,s);a=h.x,l=h.y,i=(h=this.camera.vp(i,r,e)).x,r=h.y,o=(h=this.camera.vp(o,n,t)).x,n=h.y}this.nativeContext.bezierCurveTo(i,r,o,n,a,l)}closePath(){this.nativeContext.closePath()}ellipse(e,t,i,r,o,n,a,l){null==l?this.nativeContext.ellipse(e,t,i,r,o,n,a):this.nativeContext.ellipse(e,t,i,r,o,n,a,l)}lineTo(e,t,i){var r;i=i||0,this.camera&&(this.modelMatrix&&(transformMat4(outP,[e,t,i],this.modelMatrix),e=outP[0],t=outP[1],i=outP[2]),e=(r=this.camera.vp(e,t,i)).x,t=r.y),this.nativeContext.lineTo(e,t)}moveTo(e,t,i){var r;i=i||0,this.camera&&(this.modelMatrix&&(transformMat4(outP,[e,t,i],this.modelMatrix),e=outP[0],t=outP[1],i=outP[2]),e=(r=this.camera.vp(e,t,i)).x,t=r.y),this.nativeContext.moveTo(e,t)}quadraticCurveTo(t,i,r,o,n){if(n=n||0,this.camera){let e=n;this.modelMatrix&&(transformMat4(outP,[t,i,n],this.modelMatrix),t=outP[0],i=outP[1],e=outP[2],transformMat4(outP,[r,o,n],this.modelMatrix),r=outP[0],o=outP[1],n=outP[2]);var a=this.camera.vp(r,o,n);r=a.x,o=a.y,t=(a=this.camera.vp(t,i,e)).x,i=a.y}this.nativeContext.quadraticCurveTo(t,i,r,o)}rect(e,t,i,r,o){o=o||0,this.camera?(this.moveTo(e,t,o),this.lineTo(e+i,t,o),this.lineTo(e+i,t+r,o),this.lineTo(e,t+r,o),this.closePath()):this.nativeContext.rect(e,t,i,r)}createImageData(){var e=arguments;return 2===e.length?this.nativeContext.createImageData(e[0],e[1]):1===e.length?this.nativeContext.createImageData(e[0]):null}createLinearGradient(e,t,i,r){return isFinite(e+t+i+r)||(r=i=t=e=0),this.nativeContext.createLinearGradient(e,t,i,r)}createPattern(e,t){return 0===e.width||0===e.height?null:this.nativeContext.createPattern(e,t)}createRadialGradient(e,t,i,r,o,n){return this.nativeContext.createRadialGradient(e,t,i,r,o,n)}createConicGradient(r,o,n,a){let l,s=!1;const h=this;return{stops:[],addColorStop(e,t){this.stops.push([e,t]),s=!0},GetPattern(e,t,i){return s&&(i=i||a-n,l=createConicalGradient(h,this.stops,r,o,i,n,a,e,t),s=!1),l}}}fill(e,t){this.disableFill||(e?this.nativeContext.fill(e):this.nativeContext.fill())}fillRect(e,t,i,r){this.nativeContext.fillRect(e,t,i,r)}clearRect(e,t,i,r){this.nativeContext.clearRect(e,t,i,r)}project(e,t,i){var r;return i=i||0,this.camera&&(this.modelMatrix&&(transformMat4(outP,[e,t,i],this.modelMatrix),e=outP[0],t=outP[1],i=outP[2]),e=(r=this.camera.vp(e,t,i)).x,t=r.y),{x:e,y:t}}view(e,t,i){return i=i||0,this.camera?(this.modelMatrix&&(transformMat4(outP,[e,t,i],this.modelMatrix),e=outP[0],t=outP[1],i=outP[2]),this.camera.view(e,t,i)):[e,t,i]}fillText(e,t,i,r){var o;r=r||0,this.camera&&(this.modelMatrix&&(transformMat4(outP,[t,i,r],this.modelMatrix),t=outP[0],i=outP[1],r=outP[2]),t=(o=this.camera.vp(t,i,r)).x,i=o.y),this.nativeContext.fillText(e,t,i)}getImageData(e,t,i,r){return this.nativeContext.getImageData(e,t,i,r)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(e,t){return this.nativeContext.isPointInPath(e,t)}isPointInStroke(e,t){return this.nativeContext.isPointInStroke(e,t)}measureText(e,t=application.global.measureTextMethod){if(!t||\\\"native\\\"===t)return this.nativeContext.measureText(e);this.mathTextMeasure||(this.mathTextMeasure=application.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));var i=null!=(i=this.fontFamily)?i:DefaultTextStyle.fontFamily,r=null!=(r=this.fontSize)?r:DefaultTextStyle.fontSize;return this.mathTextMeasure.textSpec.fontFamily===i&&this.mathTextMeasure.textSpec.fontSize===r||(this.mathTextMeasure.textSpec.fontFamily=i,this.mathTextMeasure.textSpec.fontSize=r,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(e,t)}putImageData(e,t,i){this.nativeContext.putImageData(e,t,i)}setLineDash(e){var t=arguments,i=this.nativeContext;this.nativeContext.setLineDash?t[0]&&i.setLineDash(t[0]):\\\"mozDash\\\"in i?i.mozDash=t[0]:\\\"webkitLineDash\\\"in i&&(i.webkitLineDash=t[0])}stroke(e){this.disableStroke||(e?this.nativeContext.stroke(e):this.nativeContext.stroke())}strokeRect(e,t,i,r){this.nativeContext.strokeRect(e,t,i,r)}strokeText(e,t,i,r){var o;r=r||0,this.camera&&(this.modelMatrix&&(transformMat4(outP,[t,i,r],this.modelMatrix),t=outP[0],i=outP[1],r=outP[2]),t=(o=this.camera.vp(t,i,r)).x,i=o.y),this.nativeContext.strokeText(e,t,i)}drawImage(){var e=this.nativeContext,t=arguments;3===t.length?e.drawImage(t[0],t[1],t[2]):5===t.length?e.drawImage(t[0],t[1],t[2],t[3],t[4]):9===t.length&&e.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setCommonStyle(e,t,i,r,o){if(Array.isArray(o)){if(o.length<=1)return this._setCommonStyle(e,t,i,r,o[0]);const n=Object.create(o[0]);return o.forEach((e,t)=>{0!==t&&Object.assign(n,e)}),this._setCommonStyle(e,t,i,r,n)}return this._setCommonStyle(e,t,i,r,o)}_setCommonStyle(e,t,i,r,o){var n=this.nativeContext,{fillOpacity:a=o.fillOpacity,opacity:l=o.opacity,fill:s=o.fill}=(o=o||this.fillAttributes,t);n.globalAlpha=a*l*this.baseGlobalAlpha,1e-12<a&&1e-12<l&&(n.fillStyle=createColor(this,s,e,i,r))}setShadowBlendStyle(e,t,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(e,i[0]);const r=Object.create(i[0]);return i.forEach((e,t)=>{0!==t&&Object.assign(r,e)}),this._setShadowBlendStyle(e,t,r)}return this._setShadowBlendStyle(e,t,i)}_setShadowBlendStyle(e,t,i){var r=this.nativeContext,{opacity:o=i.opacity,shadowBlur:n=i.shadowBlur,shadowColor:a=i.shadowColor,shadowOffsetX:l=i.shadowOffsetX,shadowOffsetY:s=i.shadowOffsetY,blur:h=i.blur,globalCompositeOperation:d=i.globalCompositeOperation}=(i=i||this.fillAttributes,t);o<=1e-12||(n||l||s?(r.shadowBlur=n*this.dpr,r.shadowColor=a,r.shadowOffsetX=l*this.dpr,r.shadowOffsetY=s*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(r.shadowBlur=0,r.shadowOffsetX=0,r.shadowOffsetY=0),h?(r.filter=`blur(${h}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(r.filter=\\\"blur(0px)\\\",this._clearFilterStyle=!1),d?(r.globalCompositeOperation=d,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(r.globalCompositeOperation=\\\"source-over\\\",this._clearGlobalCompositeOperationStyle=!1))}setStrokeStyle(e,t,i,r,o){if(Array.isArray(o)){if(o.length<=1)return this._setStrokeStyle(e,t,i,r,o[0]);const n=Object.create(o[0]);return o.forEach((e,t)=>{0!==t&&Object.assign(n,e)}),this._setStrokeStyle(e,t,i,r,n)}return this._setStrokeStyle(e,t,i,r,o)}_setStrokeStyle(e,t,i,r,o){var n,a,l,s,h,d=this.nativeContext,{strokeOpacity:u=o.strokeOpacity,opacity:c=o.opacity}=(o=o||this.strokeAttributes,t);d.globalAlpha=u*c*this.baseGlobalAlpha,1e-12<u&&1e-12<c&&(({lineWidth:u=o.lineWidth,stroke:c=o.stroke,lineJoin:n=o.lineJoin,lineDash:a=o.lineDash,lineCap:l=o.lineCap,miterLimit:s=o.miterLimit,keepStrokeScale:h=o.keepStrokeScale}=t),d.lineWidth=h?u:getScaledStroke(this,u,this.dpr),d.strokeStyle=createColor(this,c,e,i,r),d.lineJoin=n,a&&d.setLineDash(a),d.lineCap=l,d.miterLimit=s)}setTextStyleWithoutAlignBaseline(e,t,i){var r=this.nativeContext,{scaleIn3d:o=t.scaleIn3d}=(t=t||this.textAttributes,e),{fontFamily:o=t.fontFamily,fontSize:n=t.fontSize}=(e.font?r.font=e.font:r.font=getContextFont(e,t,o&&this.camera&&this.camera.getProjectionScale(i)),e);this.fontFamily=o,this.fontSize=n,r.textAlign=\\\"left\\\",r.textBaseline=\\\"alphabetic\\\"}setTextStyle(e,t,i){var r=this.nativeContext,{fontFamily:o=t.fontFamily,fontSize:n=t.fontSize}=(t=t||this.textAttributes,e.font?r.font=e.font:r.font=getContextFont(e,t,this.camera&&this.camera.getProjectionScale(i)),e);this.fontFamily=o,this.fontSize=n,r.textAlign=null!=(o=e.textAlign)?o:t.textAlign,r.textBaseline=null!=(n=e.textBaseline)?n:t.textBaseline}draw(){}clearMatrix(e=!0,t=this.dpr){this.setTransformFromMatrix(this._clearMatrix,e,t)}setClearMatrix(e,t,i,r,o,n){this._clearMatrix.setValue(e,t,i,r,o,n)}onlyTranslate(e=this.dpr){return this.matrix.a===e&&0===this.matrix.b&&0===this.matrix.c&&this.matrix.d===e}release(){this.stack.forEach(e=>matrixAllocate.free(e)),this.stack.length=0}},__decorate33=(BrowserContext2d.env=\\\"browser\\\",BrowserContext2d=__decorate32([injectable(),__metadata24(\\\"design:paramtypes\\\",[Object,Number])],BrowserContext2d),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata25=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BrowserCanvas=class extends BaseCanvas{constructor(e){super(e)}init(e){var t,i=e.container;\\\"string\\\"==typeof i?(t=application.global.getElementById(i))&&(this._container=t):this._container=i,this._context=new BrowserContext2d(this,this._dpr),this.initStyle()}initStyle(){var e;this.controled&&(e=this.nativeCanvas,e.width=this._pixelWidth,e.height=this._pixelHeight,e.style&&this.setCanvasStyle(e,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(e),this.visiable||this.hide())}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display=\\\"none\\\")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display=\\\"block\\\")}applyPosition(){var e=this._nativeCanvas;e.style.position=\\\"absolute\\\",e.style.top=this._y+\\\"px\\\",e.style.left=this._x+\\\"px\\\"}resetStyle(e){var t,i,r,o,n,a;this.controled&&(({width:t=this._displayWidth,height:i=this._displayHeight,dpr:r=this._dpr,x:o=this._x,y:n=this._y}=e),a=this.nativeCanvas,a.width=t*r,a.height=i*r,a.style&&this.setCanvasStyle(a,o,n,t,i),e.id&&(a.id=e.id),this.visiable||this.hide())}setCanvasStyle(e,t,i,r,o){this.controled&&(e.style.width=r+\\\"px\\\",e.style.height=o+\\\"px\\\")}toDataURL(e,t){return\\\"image/jpeg\\\"!==e&&\\\"image/png\\\"===e?this._nativeCanvas.toDataURL(e):this._nativeCanvas.toDataURL(e,t)}resize(e,t){this.controled&&(this._pixelWidth=e*this._dpr,this._pixelHeight=t*this._dpr,this._displayWidth=e,this._displayHeight=t,this._nativeCanvas.style&&(this._nativeCanvas.style.width=e+\\\"px\\\",this._nativeCanvas.style.height=t+\\\"px\\\"),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};function createModule(t,i){return new ContainerModule(e=>{e(CanvasFactory).toDynamicValue(()=>e=>new t(e)).whenTargetNamed(t.env),e(Context2dFactory).toDynamicValue(()=>(e,t)=>new i(e,t)).whenTargetNamed(i.env)})}BrowserCanvas.env=\\\"browser\\\",BrowserCanvas=__decorate33([injectable(),__metadata25(\\\"design:paramtypes\\\",[Object])],BrowserCanvas),init_esbuild_inject();var BrowserWindowHandlerContribution_1,browserCanvasModule=createModule(BrowserCanvas,BrowserContext2d),__decorate34=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata26=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param18=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasPickerService=class extends DefaultPickService{constructor(e,t,i){super(i),this.contributions=e,this.drawContribution=t,this.pickItemInterceptorContributions=i,this.global.hooks.onSetEnv.tap(\\\"canvas-picker-service\\\",(e,t,i)=>{this.configure(i,t)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(e=>{this.pickerMap.set(e.numberType,e)}),super._init()}configure(e,t){this.pickCanvas=canvasAllocate.shareCanvas(),this.pickContext=this.pickCanvas.getContext(\\\"2d\\\")}pickItem(t,i,r,o){if(!1===t.attribute.pickable)return null;if(this.InterceptorContributions.length)for(let e=0;e<this.InterceptorContributions.length;e++){var n=this.InterceptorContributions[e];if(n.beforePickItem){n=n.beforePickItem(t,this,i,o,{parentMatrix:r});if(n)return n}}var e=this.pickerMap.get(t.numberType);if(!e)return null;var e=e.contains(t,i,o),a=e?t:null,e={graphic:a,params:e};if(!a&&this.InterceptorContributions.length)for(let e=0;e<this.InterceptorContributions.length;e++){var l=this.InterceptorContributions[e];if(l.afterPickItem){l=l.afterPickItem(t,this,i,o,{parentMatrix:r});if(l)return l}}return e}},DefaultCanvasPickerService=__decorate34([injectable(),__param18(0,inject(ContributionProvider)),__param18(0,named(CanvasPickerContribution)),__param18(1,inject(DrawContribution)),__param18(2,inject(ContributionProvider)),__param18(2,named(PickItemInterceptor)),__metadata26(\\\"design:paramtypes\\\",[Object,Object,Object])],DefaultCanvasPickerService),__decorate35=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultCanvasGroupPicker=class{constructor(){this.type=\\\"group\\\",this.numberType=GROUP_NUMBER_TYPE}contains(e,t,i){return!1}},DefaultCanvasGroupPicker=__decorate35([injectable()],DefaultCanvasGroupPicker),m=new ContainerModule((e,t,i,r)=>{m.__vloaded||(m.__vloaded=!0,e(CanvasGroupPicker).to(DefaultCanvasGroupPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasGroupPicker),bindContributionProvider(e,CanvasPickerContribution))}),module_default2=(m.__vloaded=!1,m),canvasPickerModule=new ContainerModule((e,t,i,r)=>{i(DefaultCanvasPickerService)||e(DefaultCanvasPickerService).toSelf().inSingletonScope(),(i(PickerService)?r:e)(PickerService).toService(DefaultCanvasPickerService)});function loadCanvasPicker(e){e.load(module_default2),e.load(canvasPickerModule)}init_esbuild_inject();var __decorate36=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata27=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},BrowserWindowHandlerContribution=BrowserWindowHandlerContribution_1=class extends BaseWindowHandlerContribution{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return BrowserWindowHandlerContribution_1.idprefix+\\\"_\\\"+BrowserWindowHandlerContribution_1.prefix_count++}constructor(){super(),this.type=\\\"browser\\\",this._canvasIsIntersecting=!0,this.global=application.global,this.viewBox=new AABBBounds,this.modelMatrix=new Matrix(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(e){e.canvas?this.createWindowByCanvas(e):this.createWindowByConfig(e),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch(err){console.error(\\\"发生错误，该环境不存在IntersectionObserver\\\")}}isElementVisible(e){var t=e.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight;return!(t.right<0||t.bottom<0||t.left>i||t.top>r)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);var e=new IntersectionObserver((e,t)=>{e.forEach(e=>{this._canvasIsIntersecting!==e.isIntersecting?(this._canvasIsIntersecting=e.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(e.isIntersecting)):this._canvasIsIntersecting=e.isIntersecting})});e&&e.observe(this.canvas.nativeCanvas)}createWindowByConfig(e){var t=this.global.createCanvas({width:e.width,height:e.height});let i;if(!(i=\\\"string\\\"==typeof e.container?this.global.getElementById(e.container):e.container||this.global.getRootElement()))throw new Error(\\\"发生错误，containerId可能传入有误\\\");e.offscreen?i=null:i.appendChild(t);t={width:e.width,height:e.height,dpr:e.dpr,nativeCanvas:t,container:i,id:BrowserWindowHandlerContribution_1.GenerateCanvasId(),canvasControled:!0};this.canvas=new BrowserCanvas(t)}createWindowByCanvas(e){let t,i;if(\\\"string\\\"==typeof e.canvas){if(!(i=this.global.getElementById(e.canvas)))throw new Error(\\\"canvasId 参数不正确，请确认canvas存在并插入dom\\\")}else i=e.canvas;if(!i)throw new Error(\\\"发生错误，传入的canvas不正确\\\");let r=e.width,o=e.height;var n;null!=r&&null!=o&&e.canvasControled||(n=i.getBoundingClientRect(),r=n.width,o=n.height);let a=e.dpr;null==a&&(a=null!=(t=i.getContext(\\\"2d\\\").pixelRatio)?t:i.width/r),this.canvas=new BrowserCanvas({width:r,height:o,dpr:a,nativeCanvas:i,canvasControled:e.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(e,t){this.canvas.resize(e,t)}setDpr(e){this.canvas.dpr=e}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(e,t,i){return this.canvas.nativeCanvas.addEventListener(e,t,i)}removeEventListener(e,t,i){return this.canvas.nativeCanvas.removeEventListener(e,t,i)}dispatchEvent(e){return this.canvas.nativeCanvas.dispatchEvent(e)}getStyle(){var e;return null!=(e=this.canvas.nativeCanvas.style)?e:{}}setStyle(e){this.canvas.nativeCanvas.style=e}getBoundingClientRect(){var e=this.canvas.nativeCanvas,t=this.getWH();return e.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(e){var t=this.viewBox,i=this.getContext(),r=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(r,0,0,r,0,0),i.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),e&&(i.fillStyle=e,i.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),i.nativeContext.restore()}isVisible(e){return this._canvasIsIntersecting}onVisibleChange(e){this._onVisibleChangeCb=e}getTopLeft(e){return this.global.getElementTopLeft(this.canvas.nativeCanvas,e)}},browserWindowModule=(BrowserWindowHandlerContribution.env=\\\"browser\\\",BrowserWindowHandlerContribution.idprefix=\\\"visactor_window\\\",BrowserWindowHandlerContribution.prefix_count=0,BrowserWindowHandlerContribution=BrowserWindowHandlerContribution_1=__decorate36([injectable(),__metadata27(\\\"design:paramtypes\\\",[])],BrowserWindowHandlerContribution),new ContainerModule(e=>{e(BrowserWindowHandlerContribution).toSelf(),e(WindowHandlerContribution).toDynamicValue(e=>e.container.get(BrowserWindowHandlerContribution)).whenTargetNamed(BrowserWindowHandlerContribution.env)})),__decorate37=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata28=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter6=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},DynamicB=class{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(e){this.dom=e}};function createImageElement(e,t=!1){const i=document.createElement(\\\"img\\\");var r;return application.global.isImageAnonymous&&(i.crossOrigin=\\\"anonymous\\\"),t&&(r=new Blob([e],{type:\\\"image/svg+xml\\\"}),e=window.URL.createObjectURL(r)),i.src=e,i.complete?Promise.resolve(i):new Promise((e,t)=>{i.onload=()=>{e(i)},i.onerror=()=>{t(new Error(\\\"加载失败\\\"))}})}var BrowserEnvContribution=class extends BaseEnvContribution{constructor(){super(),this.type=\\\"browser\\\",this.supportEvent=!0;try{this.supportsTouchEvents=\\\"ontouchstart\\\"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch(err){this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(e,i){let t,r,o=0,n=0,a=0,l=0;if(l=e.changedTouches?(s=null!=(t=e.changedTouches[0])?t:{},o=s.clientX||0,n=s.clientY||0,a=o,n):(o=e.clientX||0,n=e.clientY||0,a=e.offsetX||0,e.offsetY||0),i){var s=o,h=n,d=i.getBoundingClientRect(),u=null==(r=i.getNativeHandler)?void 0:r.call(i).nativeCanvas;let e,t;return u&&(e=d.width/u.offsetWidth,t=d.height/u.offsetHeight),{x:(s-d.left)/(isValidNumber_default(e)?e:1),y:(h-d.top)/(isValidNumber_default(t)?t:1)}}return{x:a,y:l}}getNativeAABBBounds(e){let t=e;var i;return(t=\\\"string\\\"==typeof e&&(t=(new DOMParser).parseFromString(e,\\\"text/html\\\").firstChild).lastChild?t.lastChild.firstChild:t).getBoundingClientRect?(i=t.getBoundingClientRect(),new DynamicB(i)):new AABBBounds}removeDom(e){return e.parentElement.removeChild(e),!0}updateDom(t,e){let{width:i,height:r,style:o}=e;return o&&(isString_default(o)?t.setAttribute(\\\"style\\\",o):Object.keys(o).forEach(e=>{t.style[e]=o[e]})),null!=i&&(t.style.width=i+\\\"px\\\"),null!=r&&(t.style.height=r+\\\"px\\\"),!0}createDom(e){var{tagName:t=\\\"div\\\",parent:i}=e,t=document.createElement(t);return this.updateDom(t,e),i&&(i=isString_default(i)?this.getElementById(i):i)&&i.appendChild&&i.appendChild(t),t}loadImage(e){return createImageElement(e,!1).then(e=>({data:e,loadState:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,loadState:\\\"fail\\\"}))}loadSvg(e){return createImageElement(e,!0).then(e=>({data:e,loadState:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,loadState:\\\"fail\\\"}))}createCanvas(e){var t=document.createElement(\\\"canvas\\\"),i=(e.id&&(t.id=null!=(i=e.id)?i:Generator.GenAutoIncrementId().toString()),null!=(i=e.dpr)?i:window.devicePixelRatio);return e.width&&e.height&&(t.style.width=e.width+\\\"px\\\",t.style.height=e.height+\\\"px\\\",t.width=e.width*i,t.height=e.height*i),t}createOffscreenCanvas(e){var t=null!=(t=e.dpr)?t:window.devicePixelRatio;return new OffscreenCanvas(e.width*t,e.height*t)}releaseCanvas(e){var t=\\\"string\\\"==typeof e?document.getElementById(e):e;t&&t.parentElement&&t.parentElement.removeChild(t)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(e,t,i){return document.addEventListener(e,t,i)}removeEventListener(e,t,i){return document.removeEventListener(e,t,i)}dispatchEvent(e){return document.dispatchEvent(e)}getElementById(e){return document.getElementById(e)}getRootElement(){return document.body}getDocument(){return document}release(){}getElementTop(e,t){let i=e.offsetTop,r=e.offsetParent;for(;null!==r;)i+=r.offsetTop,r=r.offsetParent;return i}getElementLeft(e,t){let i=e.offsetLeft,r=e.offsetParent;for(;null!==r;)i+=r.offsetLeft,r=r.offsetParent;return i}getElementTopLeft(e,t){let i=e.offsetTop,r=e.offsetLeft,o=e.offsetParent;for(;null!==o;)i+=o.offsetTop,r+=o.offsetLeft,o=o.offsetParent;return{top:i,left:r}}loadFont(e,t,i){return __awaiter6(this,void 0,void 0,function*(){return new FontFace(e,isString_default(t)?`url(${t})`:t,i).load().then(function(e){return document.fonts.add(e),{loadState:\\\"success\\\"}})[\\\"catch\\\"](function(e){return console.error(\\\"Failed to load font:\\\",e),{loadState:\\\"fail\\\"}})})}},BrowserEnvContribution=__decorate37([injectable(),__metadata28(\\\"design:paramtypes\\\",[])],BrowserEnvContribution),browserEnvModule=new ContainerModule(e=>{browserEnvModule.isBrowserBound||(browserEnvModule.isBrowserBound=!0,e(BrowserEnvContribution).toSelf().inSingletonScope(),e(EnvContribution).toService(BrowserEnvContribution))});function loadBrowserEnv(e,t=!0){loadBrowserEnv.__loaded||(loadBrowserEnv.__loaded=!0,e.load(browserEnvModule),e.load(browserCanvasModule),e.load(browserWindowModule),t&&loadCanvasPicker(e))}browserEnvModule.isBrowserBound=!1,loadBrowserEnv.__loaded=!1,init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var PickerBase=class{contains(e,a,t){if(!e.AABBBounds.containsPoint(a))return!1;if(\\\"imprecise\\\"===e.attribute.pickMode)return!0;let l=(null!=t?t:{}).pickContext;if(!l)return!1;var i=e.getGraphicTheme();l.highPerformanceSave();let{x:r=i.x,y:o=i.y}=e.attribute,s=(e.transMatrix.onlyTranslate()?(i=e.getOffsetXY(i),r+=i.x,o+=i.y,l.setTransformForCurrent()):(r=0,o=0,l.transformFromMatrix(e.transMatrix,!0)),!1);return this.canvasRenderer.drawShape(e,l,r,o,{},null,(e,t,i)=>!!s||(s=e.isPointInPath(a.x,a.y)),(e,t,i)=>{var r,o,n;return!!s||(r=t.lineWidth||i.lineWidth,o=t.pickStrokeBuffer||i.pickStrokeBuffer,n=t.keepStrokeScale||i.keepStrokeScale,l.lineWidth=n?r+o:getScaledStroke(l,r+o,l.dpr),s=e.isPointInStroke(a.x,a.y))}),l.highPerformanceRestore(),s}},__decorate38=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata29=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param19=function(i,r){return function(e,t){r(e,t,i)}},DefaultMathArcPicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"arc\\\",this.numberType=ARC_NUMBER_TYPE}},DefaultMathArcPicker=__decorate38([injectable(),__param19(0,inject(ArcRender)),__metadata29(\\\"design:paramtypes\\\",[Object])],DefaultMathArcPicker),loadArcPick=!1,arcMathPickModule=new ContainerModule((e,t,i,r)=>{loadArcPick||(loadArcPick=!0,e(MathArcPicker).to(DefaultMathArcPicker).inSingletonScope(),e(MathPickerContribution).toService(MathArcPicker))}),__decorate39=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata30=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param20=function(i,r){return function(e,t){r(e,t,i)}},DefaultMathCirclePicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"circle\\\",this.numberType=CIRCLE_NUMBER_TYPE}},DefaultMathCirclePicker=__decorate39([injectable(),__param20(0,inject(CircleRender)),__metadata30(\\\"design:paramtypes\\\",[Object])],DefaultMathCirclePicker),loadCirclePick=!1,circleMathPickModule=new ContainerModule((e,t,i,r)=>{loadCirclePick||(loadCirclePick=!0,e(MathCirclePicker).to(DefaultMathCirclePicker).inSingletonScope(),e(MathPickerContribution).toService(MathCirclePicker))}),__decorate40=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultMathImagePicker=class{constructor(){this.type=\\\"image\\\",this.numberType=IMAGE_NUMBER_TYPE}contains(e,t,i){var r=(null!=i?i:{}).pickContext;return!!r&&!!e.AABBBounds.containsPoint(t)}},DefaultMathImagePicker=__decorate40([injectable()],DefaultMathImagePicker),loadImagePick=!1,imageMathPickModule=new ContainerModule((e,t,i,r)=>{loadImagePick||(loadImagePick=!0,e(MathImagePicker).to(DefaultMathImagePicker).inSingletonScope(),e(DefaultMathImagePicker).toService(MathImagePicker))}),__decorate41=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata31=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param21=function(i,r){return function(e,t){r(e,t,i)}},DefaultMathLinePicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"line\\\",this.numberType=LINE_NUMBER_TYPE}},DefaultMathLinePicker=__decorate41([injectable(),__param21(0,inject(LineRender)),__metadata31(\\\"design:paramtypes\\\",[Object])],DefaultMathLinePicker),loadLinePick=!1,lineMathPickModule=new ContainerModule((e,t,i,r)=>{loadLinePick||(loadLinePick=!0,e(MathLinePicker).to(DefaultMathLinePicker).inSingletonScope(),e(MathPickerContribution).toService(MathLinePicker))}),_bounds=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),new AABBBounds),RectPickerBase=class{constructor(){this.type=\\\"rect\\\",this.numberType=RECT_NUMBER_TYPE}contains(e,a,t){if(!e.AABBBounds.containsPoint(a))return!1;if(\\\"imprecise\\\"===e.attribute.pickMode)return!0;let l=(null!=t?t:{}).pickContext;if(!l)return!1;var i,r=e.getGraphicTheme(),{cornerRadius:o=r.cornerRadius}=e.attribute;let{x:n=r.x,y:s=r.y}=e.attribute,h=(l.highPerformanceSave(),!0),d=(e.transMatrix.onlyTranslate()?(i=e.getOffsetXY(r),n+=i.x,s+=i.y,l.setTransformForCurrent()):(n=0,s=0,h=!1,l.transformFromMatrix(e.transMatrix,!0)),!0);return!h||e.shadowRoot||isNumber_default(o,!0)&&0!==o||isArray_default(o)&&o.some(e=>0!==e)?(d=!1,this.canvasRenderer.drawShape(e,l,n,s,{},null,(e,t,i)=>!!d||(d=e.isPointInPath(a.x,a.y)),(e,t,i)=>{var r,o,n;return!!d||(r=t.lineWidth||i.lineWidth,o=t.pickStrokeBuffer||i.pickStrokeBuffer,n=t.keepStrokeScale||i.keepStrokeScale,l.lineWidth=n?r+o:getScaledStroke(l,r+o,l.dpr),d=e.isPointInStroke(a.x,a.y))})):(({fill:i=r.fill,stroke:o=r.stroke,lineWidth:r=r.lineWidth}=e.attribute),i?d=!0:o&&(i=e.AABBBounds,_bounds.setValue(i.x1,i.y1,i.x2,i.y2),_bounds.expand(-r/2),d=!_bounds.containsPoint(a))),l.highPerformanceRestore(),d}},__decorate42=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata32=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param22=function(i,r){return function(e,t){r(e,t,i)}},DefaultMathRectPicker=class extends RectPickerBase{constructor(e){super(),this.canvasRenderer=e}},DefaultMathRectPicker=__decorate42([injectable(),__param22(0,inject(RectRender)),__metadata32(\\\"design:paramtypes\\\",[Object])],DefaultMathRectPicker),loadRectPick=!1,rectMathPickModule=new ContainerModule((e,t,i,r)=>{loadRectPick||(loadRectPick=!0,e(MathRectPicker).to(DefaultMathRectPicker).inSingletonScope(),e(MathPickerContribution).toService(MathRectPicker))}),loadRichTextPick=(init_esbuild_inject(),!1),richTextMathPickModule=new ContainerModule((e,t,i,r)=>{loadRichTextPick||(loadRichTextPick=!0,e(MathImagePicker).to(DefaultMathImagePicker).inSingletonScope(),e(DefaultMathImagePicker).toService(MathImagePicker))}),__decorate43=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata33=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param23=function(i,r){return function(e,t){r(e,t,i)}},DefaultMathSymbolPicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"symbol\\\",this.numberType=SYMBOL_NUMBER_TYPE}},DefaultMathSymbolPicker=__decorate43([injectable(),__param23(0,inject(SymbolRender)),__metadata33(\\\"design:paramtypes\\\",[Object])],DefaultMathSymbolPicker),loadSymbolPick=!1,symbolMathPickModule=new ContainerModule((e,t,i,r)=>{loadSymbolPick||(loadSymbolPick=!0,e(MathSymbolPicker).to(DefaultMathSymbolPicker).inSingletonScope(),e(MathPickerContribution).toService(MathSymbolPicker))}),__decorate44=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultMathTextPicker=class{constructor(){this.type=\\\"text\\\",this.numberType=TEXT_NUMBER_TYPE}contains(e,t,i){return!!e.AABBBounds.containsPoint(t)}},DefaultMathTextPicker=__decorate44([injectable()],DefaultMathTextPicker),loadTextPick=!1,textMathPickModule=new ContainerModule((e,t,i,r)=>{loadTextPick||(loadTextPick=!0,e(MathTextPicker).to(DefaultMathTextPicker).inSingletonScope(),e(MathPickerContribution).toService(MathTextPicker))}),__decorate45=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata34=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},NodeContext2d=class extends BrowserContext2d{constructor(e,t){super(e,t);var i=e.nativeCanvas.getContext(\\\"2d\\\");if(!i)throw new Error(\\\"发生错误，获取2d上下文失败\\\");this.nativeContext=i,this.canvas=e,this.matrix=new Matrix(1,0,0,1,0,0),this.stack=[],this.dpr=null!=t?t:1}release(){}},__decorate46=(NodeContext2d.env=\\\"node\\\",NodeContext2d=__decorate45([injectable(),__metadata34(\\\"design:paramtypes\\\",[Object,Number])],NodeContext2d),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata35=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},NodeCanvas=class extends BaseCanvas{constructor(e){super(e)}init(){this._context=new NodeContext2d(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(){this._nativeCanvas.release&&isFunction_default(this._nativeCanvas.release)&&this._nativeCanvas.release()}},nodeCanvasModule=(NodeCanvas.env=\\\"node\\\",createModule(NodeCanvas=__decorate46([injectable(),__metadata35(\\\"design:paramtypes\\\",[Object])],NodeCanvas),NodeContext2d)),__decorate47=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata36=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param24=function(i,r){return function(e,t){r(e,t,i)}},NodeWindowHandlerContribution=class extends BaseWindowHandlerContribution{get container(){return null}constructor(e){super(),this.global=e,this.type=\\\"node\\\"}getTitle(){return\\\"\\\"}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(e){e.canvas?this.createWindowByCanvas(e):this.createWindowByConfig(e)}createWindowByConfig(e){var t=this.global.createCanvas({width:e.width,height:e.height}),t={width:e.width,height:e.height,dpr:e.dpr,nativeCanvas:t,id:Generator.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new NodeCanvas(t)}createWindowByCanvas(e){var t=e.canvas;let i=e.width,r=e.height;null!=i&&null!=r&&e.canvasControled||(i=t.width,r=t.height),this.canvas=new NodeCanvas({width:i,height:r,dpr:1,nativeCanvas:t,canvasControled:e.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(e,t){this.canvas.resize(e,t)}setDpr(e){this.canvas.dpr=e}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(e=\\\"image/png\\\"){return this.canvas.nativeCanvas.toBuffer(e)}addEventListener(e,t,i){}dispatchEvent(e){return!0}removeEventListener(e,t,i){}getStyle(){}setStyle(e){}getBoundingClientRect(){return null}clearViewBox(e){}},nodeWindowModule=(NodeWindowHandlerContribution.env=\\\"node\\\",NodeWindowHandlerContribution=__decorate47([injectable(),__param24(0,inject(VGlobal)),__metadata36(\\\"design:paramtypes\\\",[Object])],NodeWindowHandlerContribution),new ContainerModule(e=>{e(NodeWindowHandlerContribution).toSelf(),e(WindowHandlerContribution).toDynamicValue(e=>e.container.get(NodeWindowHandlerContribution)).whenTargetNamed(NodeWindowHandlerContribution.env)})),__decorate48=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),NodeEnvContribution=class extends BaseEnvContribution{constructor(){super(...arguments),this.type=\\\"node\\\",this._lastTime=0,this.supportEvent=!1}configure(e,t){e.env===this.type&&(e.setActiveEnvContribution(this),this.pkg=t)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(e){var t=fetch(e).then(e=>e.json());return t.then(e=>({data:e,state:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,state:\\\"fail\\\"})),t}loadArrayBuffer(e){return fetch(e).then(e=>e.arrayBuffer()).then(e=>({data:e,loadState:\\\"success\\\"}))[\\\"catch\\\"](()=>({data:null,loadState:\\\"fail\\\"}))}loadImage(e){var t=this.pkg.loadImage;return t?t(e).then(e=>({loadState:e?\\\"success\\\":\\\"fail\\\",data:e}))[\\\"catch\\\"](()=>({loadState:\\\"fail\\\",data:null})):Promise.reject(new Error(\\\"node-canvas loadImage could not be found!\\\"))}loadSvg(e){var t=this.pkg.Resvg;return t?(t=new t(e).render().asPng(),this.loadImage(t)):Promise.reject(new Error(\\\"@resvg/resvg-js svgParser could not be found!\\\"))}createCanvas(e){return this.pkg.createCanvas(e.width,e.height)}releaseCanvas(e){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(e){return rafBasedSto.call(e)}}getCancelAnimationFrame(){return e=>{rafBasedSto.clear(e)}}addEventListener(e,t,i){}removeEventListener(e,t,i){}getElementById(e){return null}getRootElement(){return null}dispatchEvent(e){}release(){}createOffscreenCanvas(e){}},NodeEnvContribution=__decorate48([injectable()],NodeEnvContribution),nodeEnvModule=new ContainerModule(e=>{nodeEnvModule.isNodeBound||(nodeEnvModule.isNodeBound=!0,e(NodeEnvContribution).toSelf().inSingletonScope(),e(EnvContribution).toService(NodeEnvContribution))});function loadNodeEnv(e,t=0){loadNodeEnv.__loaded||(loadNodeEnv.__loaded=!0,e.load(nodeEnvModule),e.load(nodeCanvasModule),e.load(nodeWindowModule))}nodeEnvModule.isNodeBound=!1,loadNodeEnv.__loaded=!1,init_esbuild_inject(),init_esbuild_inject();var __decorate49=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata37=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param25=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasArcPicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"arc\\\",this.numberType=ARC_NUMBER_TYPE}},DefaultCanvasArcPicker=__decorate49([injectable(),__param25(0,inject(ArcRender)),__metadata37(\\\"design:paramtypes\\\",[Object])],DefaultCanvasArcPicker),loadArcPick2=!1,arcCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadArcPick2||(loadArcPick2=!0,e(CanvasArcPicker).to(DefaultCanvasArcPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasArcPicker))}),__decorate50=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata38=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param26=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasRectPicker=class extends RectPickerBase{constructor(e){super(),this.canvasRenderer=e}},DefaultCanvasRectPicker=__decorate50([injectable(),__param26(0,inject(RectRender)),__metadata38(\\\"design:paramtypes\\\",[Object])],DefaultCanvasRectPicker),loadRectPick2=!1,rectCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadRectPick2||(loadRectPick2=!0,e(CanvasRectPicker).to(DefaultCanvasRectPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasRectPicker))}),BaseLinePicker=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class extends BaseRender{contains(e,t,i){if(!e.AABBBounds.containsPoint(t))return!1;if(\\\"imprecise\\\"===e.attribute.pickMode)return!0;let a=(null!=i?i:{}).pickContext;if(!a)return!1;a.highPerformanceSave();var r,o=e.getGraphicTheme(),{x:o,y:n,z:l,lastModelMatrix:s}=this.transform(e,o,a);let h=t,d=(a.camera&&(h=t.clone(),r=e.parent.globalTransMatrix,h.x=r.a*t.x+r.c*t.y+r.e,h.y=r.b*t.x+r.d*t.y+r.f),this.canvasRenderer.z=l,!1);return this.canvasRenderer.drawShape(e,a,o,n,{},null,e=>!!d||(d=e.isPointInPath(h.x,h.y)),(e,t,i)=>{var r,o,n;return!!d||(r=t.lineWidth||i.lineWidth,o=t.pickStrokeBuffer||i.pickStrokeBuffer,n=t.keepStrokeScale||i.keepStrokeScale,a.lineWidth=n?r+o:getScaledStroke(a,r+o,a.dpr),d=e.isPointInStroke(h.x,h.y))}),this.canvasRenderer.z=0,a.modelMatrix!==s&&mat4Allocate.free(a.modelMatrix),a.modelMatrix=s,a.highPerformanceRestore(),d}}),__decorate51=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata39=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param27=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasLinePicker=class extends BaseLinePicker{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"line\\\",this.numberType=LINE_NUMBER_TYPE}},DefaultCanvasLinePicker=__decorate51([injectable(),__param27(0,inject(LineRender)),__metadata39(\\\"design:paramtypes\\\",[Object])],DefaultCanvasLinePicker),loadLinePick2=!1,lineCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadLinePick2||(loadLinePick2=!0,e(CanvasLinePicker).to(DefaultCanvasLinePicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasLinePicker))}),Base3dPicker=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class extends BaseRender{contains(e,t,i){var r=(null!=i?i:{}).pickContext;if(!r)return!1;var o,n=e.getGraphicTheme(),n=(r.highPerformanceSave(),this.transform(e,n,r)),{x:n,y:a,z:l,lastModelMatrix:s}=n;let h=t,d=(r.camera&&(h=t.clone(),o=e.parent.globalTransMatrix,h.x=o.a*t.x+o.c*t.y+o.e,h.y=o.b*t.x+o.d*t.y+o.f),this.canvasRenderer.z=l,!1);return this.canvasRenderer.drawShape(e,r,n,a,i,null,(e,t,i)=>!!d||(d=e.isPointInPath(h.x,h.y))),this.canvasRenderer.z=0,r.modelMatrix!==s&&mat4Allocate.free(r.modelMatrix),r.modelMatrix=s,r.highPerformanceRestore(),d}}),__decorate52=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},__metadata40=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param28=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasSymbolPicker=class extends Base3dPicker{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"symbol\\\",this.numberType=SYMBOL_NUMBER_TYPE}contains(e,t,i){let a=(null!=i?i:{}).pickContext;if(!a)return!1;var r=e.getParsedPath();if(!a.camera){if(!e.AABBBounds.containsPoint(t))return!1;if(r.isSvg||\\\"imprecise\\\"===e.attribute.pickMode)return!0}a.highPerformanceSave();var o,r=e.getGraphicTheme(),{x:r,y:n,z:l,lastModelMatrix:s}=this.transform(e,r,a);let h=t,d=(a.camera&&(h=t.clone(),o=e.parent.globalTransMatrix,h.x=o.a*t.x+o.c*t.y+o.e,h.y=o.b*t.x+o.d*t.y+o.f),this.canvasRenderer.z=l,!1);return this.canvasRenderer.drawShape(e,a,r,n,{},null,(e,t,i)=>!!d||(d=e.isPointInPath(h.x,h.y)),(e,t,i)=>{var r,o,n;return!!d||(r=t.lineWidth||i.lineWidth,o=t.pickStrokeBuffer||i.pickStrokeBuffer,n=t.keepStrokeScale||i.keepStrokeScale,a.lineWidth=n?r+o:getScaledStroke(a,r+o,a.dpr),d=e.isPointInStroke(h.x,h.y))}),this.canvasRenderer.z=0,a.modelMatrix!==s&&mat4Allocate.free(a.modelMatrix),a.modelMatrix=s,a.highPerformanceRestore(),d}},DefaultCanvasSymbolPicker=__decorate52([injectable(),__param28(0,inject(SymbolRender)),__metadata40(\\\"design:paramtypes\\\",[Object])],DefaultCanvasSymbolPicker),loadSymbolPick2=!1,symbolCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadSymbolPick2||(loadSymbolPick2=!0,e(CanvasSymbolPicker).to(DefaultCanvasSymbolPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasSymbolPicker))}),__decorate53=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata41=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param29=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasCirclePicker=class extends PickerBase{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"circle\\\",this.numberType=CIRCLE_NUMBER_TYPE}},DefaultCanvasCirclePicker=__decorate53([injectable(),__param29(0,inject(CircleRender)),__metadata41(\\\"design:paramtypes\\\",[Object])],DefaultCanvasCirclePicker),loadCirclePick2=!1,circleCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadCirclePick2||(loadCirclePick2=!0,e(CanvasCirclePicker).to(DefaultCanvasCirclePicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasCirclePicker))}),__decorate54=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata42=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param30=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasTextPicker=class extends Base3dPicker{constructor(e){super(),this.canvasRenderer=e,this.type=\\\"text\\\",this.numberType=TEXT_NUMBER_TYPE}contains(s,e,t){var i=(null!=t?t:{}).pickContext;if(!i)return!1;var r=s.AABBBounds;if(!i.camera)return!!r.containsPoint(e);i.highPerformanceSave();let h=s.getGraphicTheme(),{keepDirIn3d:o=h.keepDirIn3d}=s.attribute,n=!o,a=this.transform(s,h,i,n),{x:d,y:u,z:c,lastModelMatrix:l}=a,g=(this.canvasRenderer.z=c,e),p=(i.camera&&(g=e.clone(),r=s.parent.globalTransMatrix,g.x=r.a*e.x+r.c*e.y+r.e,g.y=r.b*e.x+r.d*e.y+r.f),!1);return this.canvasRenderer.drawShape(s,i,d,u,{},null,(e,t,i)=>{var r,o,n,a,l;return!!p||(({fontSize:l=h.fontSize,textBaseline:a=h.textBaseline,textAlign:r=h.textAlign}=s.attribute),o=(n=s.AABBBounds).height(),n=n.width(),a=textLayoutOffsetY(a,o,l),l=textDrawOffsetX(r,n),e.rect(l+d,a+u,n,o,c),p=e.isPointInPath(g.x,g.y))},(e,t,i)=>p),this.canvasRenderer.z=0,i.modelMatrix!==l&&mat4Allocate.free(i.modelMatrix),i.modelMatrix=l,i.highPerformanceRestore(),p}},DefaultCanvasTextPicker=__decorate54([injectable(),__param30(0,inject(TextRender)),__metadata42(\\\"design:paramtypes\\\",[Object])],DefaultCanvasTextPicker),loadTextPick2=!1,textCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadTextPick2||(loadTextPick2=!0,e(CanvasTextPicker).to(DefaultCanvasTextPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasTextPicker))}),__decorate55=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),__metadata43=function(e,t){if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__param31=function(i,r){return function(e,t){r(e,t,i)}},DefaultCanvasRichTextPicker=class{constructor(e){this.canvasRenderer=e,this.type=\\\"richtext\\\",this.numberType=RICHTEXT_NUMBER_TYPE}contains(e,t,i){return!!e.AABBBounds.containsPoint(t)}},DefaultCanvasRichTextPicker=__decorate55([injectable(),__param31(0,inject(RichTextRender)),__metadata43(\\\"design:paramtypes\\\",[Object])],DefaultCanvasRichTextPicker),loadRichtextPick=!1,richtextCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadRichtextPick||(loadRichtextPick=!0,e(CanvasRichTextPicker).to(DefaultCanvasRichTextPicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasRichTextPicker))}),__decorate56=(init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),DefaultCanvasImagePicker=class{constructor(){this.type=\\\"image\\\",this.numberType=IMAGE_NUMBER_TYPE}contains(e,t,i){var r=(null!=i?i:{}).pickContext;return!!r&&!!e.AABBBounds.containsPoint(t)}},DefaultCanvasImagePicker=__decorate56([injectable()],DefaultCanvasImagePicker),loadImagePick2=!1,imageCanvasPickModule=new ContainerModule((e,t,i,r)=>{loadImagePick2||(loadImagePick2=!0,e(CanvasImagePicker).to(DefaultCanvasImagePicker).inSingletonScope(),e(CanvasPickerContribution).toService(CanvasImagePicker))}),browser=(init_esbuild_inject(),init_esbuild_inject(),isBrowserEnv());function _registerArc(){_registerArc.__loaded||(_registerArc.__loaded=!0,registerArcGraphic(),container.load(arcModule),container.load(browser?arcCanvasPickModule:arcMathPickModule))}_registerArc.__loaded=!1;var registerArc=_registerArc;function _registerCircle(){_registerCircle.__loaded||(_registerCircle.__loaded=!0,registerCircleGraphic(),container.load(circleModule),container.load(browser?circleCanvasPickModule:circleMathPickModule))}init_esbuild_inject(),_registerCircle.__loaded=!1;var registerCircle=_registerCircle;function _registerGroup(){_registerGroup.__loaded||(_registerGroup.__loaded=!0,registerGroupGraphic())}init_esbuild_inject(),_registerGroup.__loaded=!1;var registerGroup=_registerGroup;function _registerImage(){_registerImage.__loaded||(_registerImage.__loaded=!0,registerImageGraphic(),container.load(imageModule),container.load(browser?imageCanvasPickModule:imageMathPickModule))}init_esbuild_inject(),_registerImage.__loaded=!1;var registerImage=_registerImage;function _registerLine(){_registerLine.__loaded||(_registerLine.__loaded=!0,registerLineGraphic(),container.load(lineModule),container.load(browser?lineCanvasPickModule:lineMathPickModule))}init_esbuild_inject(),_registerLine.__loaded=!1;var registerLine=_registerLine;function _registerRect(){_registerRect.__loaded||(_registerRect.__loaded=!0,registerRectGraphic(),container.load(rectModule),container.load(browser?rectCanvasPickModule:rectMathPickModule))}init_esbuild_inject(),_registerRect.__loaded=!1;var registerRect=_registerRect;function _registerRichtext(){_registerRichtext.__loaded||(_registerRichtext.__loaded=!0,registerRichtextGraphic(),container.load(richtextModule),container.load(browser?richtextCanvasPickModule:richTextMathPickModule))}init_esbuild_inject(),_registerRichtext.__loaded=!1;var registerRichtext=_registerRichtext;function _registerShadowRoot(){_registerShadowRoot.__loaded||(_registerShadowRoot.__loaded=!0,registerShadowRootGraphic())}init_esbuild_inject(),_registerShadowRoot.__loaded=!1;var registerShadowRoot=_registerShadowRoot;function _registerSymbol(){_registerSymbol.__loaded||(_registerSymbol.__loaded=!0,registerSymbolGraphic(),container.load(symbolModule),container.load(browser?symbolCanvasPickModule:symbolMathPickModule))}init_esbuild_inject(),_registerSymbol.__loaded=!1;var registerSymbol=_registerSymbol;function _registerText(){_registerText.__loaded||(_registerText.__loaded=!0,registerTextGraphic(),container.load(textModule),container.load(browser?textCanvasPickModule:textMathPickModule))}init_esbuild_inject(),_registerText.__loaded=!1;var registerText=_registerText;function _registerWrapText(){_registerWrapText.__loaded||(_registerWrapText.__loaded=!0,registerWrapTextGraphic())}init_esbuild_inject(),_registerWrapText.__loaded=!1;var registerWrapText=_registerWrapText;function loadScrollbarComponent(){registerGroup(),registerRect()}init_esbuild_inject();var StateValue,POLAR_START_ANGLE=-.5*Math.PI,POLAR_END_ANGLE=1.5*Math.PI,DEFAULT_TEXT_FONT_FAMILY2=\\\"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol\\\",DEFAULT_STATES=(!function(e){e.selected=\\\"selected\\\",e.selectedReverse=\\\"selected_reverse\\\",e.hover=\\\"hover\\\",e.hoverReverse=\\\"hover_reverse\\\"}(StateValue=StateValue||{}),{[StateValue.selectedReverse]:{},[StateValue.selected]:{},[StateValue.hover]:{},[StateValue.hoverReverse]:{}}),SCROLLBAR_EVENT=\\\"scrollDrag\\\",delayMap={debounce:debounce_default,throttle:throttle_default},ScrollBar=(loadScrollbarComponent(),class _T0 extends AbstractComponent{constructor(e,t){super(null!=t&&t.skipDefault?e:merge({},_T0.defaultAttributes,e)),this.name=\\\"scrollbar\\\",this._onRailPointerDown=e=>{var{viewX:t,viewY:i}=e,{direction:r,width:o,height:n,range:a}=this.attribute,l=this._sliderSize,[s,h]=this._getScrollRange();let d;\\\"vertical\\\"===r?(r=i-this._viewPosition.y,i=clamp_default(r-l/2,s,h),d=r/n,this._slider.setAttribute(\\\"y\\\",i,!0)):(r=t-this._viewPosition.x,n=clamp_default(r-l/2,s,h),d=r/o,this._slider.setAttribute(\\\"x\\\",n,!0)),this.setScrollRange([d-(a[1]-a[0])/2,d+(a[1]-a[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=e=>{var{stopSliderDownPropagation:t=!0}=this.attribute,t=(t&&e.stopPropagation(),this.attribute).direction,{x:i,y:r}=this.stage.eventPointTransform(e);this._prePos=\\\"horizontal\\\"===t?i:r,this._dispatchEvent(\\\"scrollDown\\\",{pos:this._prePos,event:e}),\\\"browser\\\"===vglobal.env?(vglobal.addEventListener(\\\"pointermove\\\",this._onSliderPointerMoveWithDelay,{capture:!0}),vglobal.addEventListener(\\\"pointerup\\\",this._onSliderPointerUp)):(this.stage.addEventListener(\\\"pointermove\\\",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.addEventListener(\\\"pointerup\\\",this._onSliderPointerUp),this.stage.addEventListener(\\\"pointerupoutside\\\",this._onSliderPointerUp))},this._computeScrollValue=e=>{var t=this.attribute.direction,{x:i,y:r}=this.stage.eventPointTransform(e);let o,n,a=0;var{width:l,height:s}=this.getSliderRenderBounds();return o=\\\"vertical\\\"===t?(n=r,(a=n-this._prePos)/s):(n=i,(a=n-this._prePos)/l),[n,o]},this._onSliderPointerMove=e=>{var{stopSliderMovePropagation:t=!0}=this.attribute,t=(t&&e.stopPropagation(),this.getScrollRange()),[i,r]=this._computeScrollValue(e);this.setScrollRange([t[0]+r,t[1]+r],!0),this._prePos=i},this._onSliderPointerMoveWithDelay=0===this.attribute.delayTime?this._onSliderPointerMove:delayMap[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=e=>{e.preventDefault();var{range:t,limitRange:i=[0,1]}=this.attribute,r=this.getScrollRange(),[,o]=this._computeScrollValue(e),r=[r[0]+o,r[1]+o];this._dispatchEvent(\\\"scrollUp\\\",{pre:t,value:clampRange_default(r,i[0],i[1])}),\\\"browser\\\"===vglobal.env?(vglobal.removeEventListener(\\\"pointermove\\\",this._onSliderPointerMoveWithDelay,{capture:!0}),vglobal.removeEventListener(\\\"pointerup\\\",this._onSliderPointerUp)):(this.stage.removeEventListener(\\\"pointermove\\\",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.removeEventListener(\\\"pointerup\\\",this._onSliderPointerUp),this.stage.removeEventListener(\\\"pointerupoutside\\\",this._onSliderPointerUp))}}setScrollRange(e,t=!0){var i,r,{direction:o=\\\"horizontal\\\",limitRange:n=[0,1],range:a,realTime:l=!0}=this.attribute,n=clampRange_default(e,n[0],n[1]);t&&(i=this._getSliderPos(n),this._slider)&&(r=i[1]-i[0],this._sliderSize=r,\\\"horizontal\\\"===o?this._slider.setAttributes({x:i[0],width:r},!0):this._slider.setAttributes({y:i[0],height:r},!0),this.stage)&&!this.stage.autoRender&&this.stage.renderNextFrame(),this.attribute.range=n,l&&this._dispatchEvent(SCROLLBAR_EVENT,{pre:a,value:n})}getScrollRange(){return this.attribute.range}bindEvents(){var e,t;this.attribute.disableTriggerEvent||(({delayType:e=\\\"throttle\\\",delayTime:t=0}=this.attribute),this._rail&&this._rail.addEventListener(\\\"pointerdown\\\",delayMap[e](this._onRailPointerDown,t)),this._slider&&this._slider.addEventListener(\\\"pointerdown\\\",this._onSliderPointerDown))}render(){this._reset();var{direction:e=\\\"horizontal\\\",width:t,height:i,range:r,limitRange:o=[0,1],railStyle:n,sliderStyle:a,padding:l=2}=this.attribute,s=this.createOrUpdateChild(\\\"scrollbar-container\\\",{},\\\"group\\\"),t=s.createOrUpdateChild(\\\"scrollbar-rail\\\",Object.assign({x:0,y:0,width:t,height:i},n),\\\"rect\\\"),i=(this._rail=t,this.getSliderRenderBounds()),n=this._getSliderPos(clampRange_default(r,o[0],o[1])),t=n[1]-n[0],o=(this._sliderSize=t,r=\\\"horizontal\\\"===e?{x:n[0],y:i.y1,width:t,height:i.height}:{x:i.x1,y:n[0],width:i.width,height:t},s.createOrUpdateChild(\\\"slider\\\",Object.assign(Object.assign(Object.assign(Object.assign({},r),{cornerRadius:this._getDefaultSliderCornerRadius()}),a),{boundsPadding:normalizePadding(l),pickMode:\\\"imprecise\\\"}),\\\"rect\\\")),e=(this._slider=o,this._container=s,this._container.AABBBounds);this._viewPosition={x:e.x1,y:e.y1}}getSliderRenderBounds(){var e,t,i,r,o,n;return this._sliderRenderBounds||(({width:n,height:e,padding:t=2}=this.attribute),([t,i,r,o]=normalizePadding(t)),n={x1:o,y1:t,x2:n-i,y2:e-r,width:Math.max(0,n-(o+i)),height:Math.max(0,e-(t+r))},this._sliderRenderBounds=n)}_getDefaultSliderCornerRadius(){var e,{direction:t,round:i}=this.attribute;return i?(({width:i,height:e}=this.getSliderRenderBounds()),\\\"horizontal\\\"===t?e:i):0}_getSliderPos(e){var t=this.attribute.direction,{width:i,height:r,x1:o,y1:n}=this.getSliderRenderBounds();return\\\"horizontal\\\"===t?[i*e[0]+o,i*e[1]+o]:[r*e[0]+n,r*e[1]+n]}_getScrollRange(){var e,t,i,r,o,n,a,l;return this._sliderLimitRange||(({limitRange:t=[0,1],direction:e}=this.attribute),([t,i]=clampRange_default(t,0,1)),({width:r,height:o,x1:n,y1:a}=this.getSliderRenderBounds()),l=this._sliderSize,\\\"horizontal\\\"===e?clampRange_default([n+t*r,n+i*r],n,r-l):clampRange_default([a+t*o,a+i*o],a,o-l))}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}});function measureTextSize(e,t,i={}){var r;return e?{width:(r=getTextBounds({text:e,fontFamily:t.fontFamily||i.fontFamily||DEFAULT_TEXT_FONT_FAMILY2,fontSize:t.fontSize||i.fontSize||12,fontWeight:t.fontWeight||i.fontWeight,textAlign:t.textAlign||\\\"center\\\",textBaseline:t.textBaseline,ellipsis:!!t.ellipsis,maxLineWidth:t.maxLineWidth||1/0,lineHeight:t.fontSize||i.fontSize||12})).width(),height:r.height()}:{width:0,height:0}}function isRichText(e,t=\\\"type\\\"){return\\\"rich\\\"===getTextType(e,t)}function getTextType(e,t=\\\"type\\\"){var i;return isObject_default(e.text)&&\\\"type\\\"in e.text?null!=(i=e.text.type)?i:\\\"text\\\":t in e&&null!=(i=e[t])?i:\\\"text\\\"}function richTextAttributeTransform(e){var t;return isValid_default(e.maxLineWidth)&&(e.maxWidth=e.maxLineWidth,delete e.maxLineWidth),e.width=null!=(t=e.width)?t:0,e.height=null!=(t=e.height)?t:0,e.textConfig=e.text.text||e.text,e}function loadTagComponent(){registerGroup(),registerRect(),registerSymbol(),registerRichtext(),registerText()}ScrollBar.defaultAttributes={direction:\\\"horizontal\\\",round:!0,sliderSize:20,sliderStyle:{fill:\\\"rgba(0, 0, 0, .5)\\\"},railStyle:{fill:\\\"rgba(0, 0, 0, .0)\\\"},padding:2,scrollRange:[0,1],delayType:\\\"throttle\\\",delayTime:0,realTime:!0},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __rest=function(e,t){var i={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&\\\"function\\\"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]]);return i},Tag=(loadTagComponent(),class iW0 extends AbstractComponent{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(e,t){super(null!=t&&t.skipDefault?e:merge({},iW0.defaultAttributes,e)),this.name=\\\"tag\\\",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){this.cacheStates();var{text:t=\\\"\\\",textStyle:i={},shape:r={},panel:e={},space:o=4,minWidth:n,maxWidth:a,padding:l=4,visible:s,state:h,type:d,textAlwaysCenter:u,containerTextAlign:c}=this.attribute,l=normalizePadding(l),g=this.createOrUpdateChild(\\\"tag-content\\\",{x:0,y:0,zIndex:1},\\\"group\\\");let p,f=-l[3],m=-l[0],b=l[1]+l[3],C=l[0]+l[2],v=0,y=0;var w=r.visible,_=__rest(r,[\\\"visible\\\"]);isBoolean_default(w)&&(x=(null==_?void 0:_.size)||10,R=isNumber_default(x)?x:Math.max(x[0],x[1]),p=g.createOrUpdateChild(\\\"tag-shape\\\",Object.assign(Object.assign({symbolType:\\\"circle\\\",size:x,strokeBoundsBuffer:0},_),{visible:w,x:R/2,y:R/2}),\\\"symbol\\\"),isEmpty_default(null==h?void 0:h.shape)||(p.states=h.shape),w)&&(y=R+o);let S;if(b+=y,v+=y,isRichText({text:t})||\\\"rich\\\"===d){var x=Object.assign(Object.assign(Object.assign({},richTextAttributeTransform(Object.assign({type:d,text:t},i))),i),{visible:isValid_default(t)&&!1!==s,x:v,y:0});S=g.createOrUpdateChild(\\\"tag-text\\\",x,\\\"richtext\\\"),b+=S.AABBBounds.width(),C+=S.AABBBounds.height(),f+=S.AABBBounds.x1,m+=S.AABBBounds.y1}else{var _=Object.assign(Object.assign({text:isObject_default(t)&&\\\"type\\\"in t&&\\\"text\\\"===t.type?t.text:t,visible:isValid_default(t)&&!1!==s,lineHeight:null==i?void 0:i.fontSize},i),{x:v,y:0}),o=(isNil_default(_.lineHeight)&&(_.lineHeight=i.fontSize),S=g.createOrUpdateChild(\\\"tag-text\\\",_,\\\"text\\\"),isEmpty_default(null==h?void 0:h.text)||(S.states=h.text),measureTextSize(_.text,i,null==(R=null==(w=this.stage)?void 0:w.getTheme())?void 0:R.text)),d=o.width,x=o.height,w=(b+=d,null!=(_=r.size)?_:10),R=isNumber_default(w)?w:Math.max(w[0],w[1]),{textAlign:o,textBaseline:_}=(C+=Math.max(x,r.visible?R:0),i);(isValid_default(n)||isValid_default(a))&&(isValid_default(n)&&b<n&&(b=n),isValid_default(a))&&b>a&&(b=a,S.setAttribute(\\\"maxLineWidth\\\",a-l[1]-l[2])),f=0;let e=m=0;\\\"left\\\"===o||\\\"start\\\"===o?e=1:\\\"right\\\"===o||\\\"end\\\"===o?e=-1:\\\"center\\\"===o&&(e=0),e?e<0?(f-=b,p&&p.setAttribute(\\\"x\\\",(p.attribute.x||0)-d),g.setAttribute(\\\"x\\\",-l[1]-y)):0<e&&g.setAttribute(\\\"x\\\",l[3]):(f-=b/2,p&&p.setAttribute(\\\"x\\\",(p.attribute.x||0)-d/2),g.setAttribute(\\\"x\\\",-y/2));w=\\\"right\\\"===c||\\\"end\\\"===c,r=\\\"left\\\"===c||\\\"start\\\"===c;(c?\\\"center\\\"===c:u)&&e&&(i=b-l[1]-l[3],n=d+y,a=1===e?(i-n)/2+y+d/2:l[0]+y-(b/2+n/2-y)+d/2,S.setAttributes({x:a,textAlign:\\\"center\\\"}),p)&&(o=a-d/2-y+R/2,p.setAttributes({x:o})),r&&1!==e&&(c=b-l[1]-l[3],i=(u=0===e?-c/2+y/2:-b+l[3]+l[1]+y)+y,S.setAttributes({x:i,textAlign:\\\"left\\\"}),p)&&p.setAttributes({x:u+R/2}),w&&-1!==e&&(n=b-l[1]-l[3],a=0===e?n/2+y/2:n,S.setAttributes({x:a,textAlign:\\\"right\\\"}),p)&&(o=a-d-y+R/2,p.setAttributes({x:o})),\\\"middle\\\"===_?(m-=C/2,p&&p.setAttribute(\\\"y\\\",0)):\\\"bottom\\\"===_?(m-=C,p&&p.setAttribute(\\\"y\\\",-x/2),g.setAttribute(\\\"y\\\",-l[2])):\\\"top\\\"===_&&(g.setAttribute(\\\"y\\\",l[0]),p)&&p.setAttribute(\\\"y\\\",x/2)}r=e.visible,c=__rest(e,[\\\"visible\\\"]);if(s&&isBoolean_default(r)){i=this.createOrUpdateChild(\\\"tag-panel\\\",Object.assign(Object.assign({},c),{visible:r&&!!t,width:b,height:C,x:f,y:m}),\\\"rect\\\");if(isEmpty_default(null==h?void 0:h.panel)||(i.states=h.panel),c.customShape){const T=c.customShape;i.pathProxy=e=>T(this,e,new CustomPath2D)}this._bgRect=i}this._textShape=S,this._symbol=p,this.resetStates()}initAttributes(e,t){e=null!=t&&t.skipDefault?e:merge({},iW0.defaultAttributes,e),super.initAttributes(e),this.render()}addState(e,t,i){super.addState(e,t,i),this._textShape&&this._textShape.addState(e,t,i),this._bgRect&&this._bgRect.addState(e,t,i),this._symbol&&this._symbol.addState(e,t,i)}removeState(e,t){super.removeState(e,t),this._textShape&&this._textShape.removeState(e,t),this._bgRect&&this._bgRect.removeState(e,t),this._symbol&&this._symbol.removeState(e,t)}cacheStates(){var e;this._tagStates=null!=(e=null==(e=this.currentStates)?void 0:e.slice())?e:[],this._rectStates=null!=(e=null==(e=null==(e=this._bgRect)?void 0:e.currentStates)?void 0:e.slice())?e:[],this._symbolStates=null!=(e=null==(e=null==(e=this._symbol)?void 0:e.currentStates)?void 0:e.slice())?e:[],this._textStates=null!=(e=null==(e=null==(e=this._textShape)?void 0:e.currentStates)?void 0:e.slice())?e:[],this.clearStates(),null!=(e=this._bgRect)&&e.clearStates(),null!=(e=this._symbol)&&e.clearStates(),null!=(e=this._textShape)&&e.clearStates()}resetStates(){var e;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&null!=(e=this._bgRect)&&e.useStates(this._rectStates),this._symbolStates.length&&null!=(e=this._symbol)&&e.useStates(this._symbolStates),this._textStates.length&&null!=(e=this._textShape)&&e.useStates(this._textStates)}}),DEFAULT_THEME=(Tag.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:\\\"#000\\\",textAlign:\\\"left\\\",textBaseline:\\\"top\\\"},space:4,padding:4,shape:{fill:\\\"#000\\\"}},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),{visible:!0,position:\\\"auto\\\",titleStyle:{fontSize:16,fill:\\\"#08979c\\\"},contentStyle:{fontSize:12,fill:\\\"green\\\"},panel:{visible:!0,fill:\\\"#e6fffb\\\",size:12,space:0,stroke:\\\"#87e8de\\\",lineWidth:1,cornerRadius:4}}),theme={poptip:merge({},DEFAULT_THEME)};function loadPoptipComponent(){registerGroup(),registerText(),registerSymbol(),registerRect()}function setPoptipTheme(e){merge(theme.poptip,DEFAULT_THEME,e)}var __rest2=function(e,t){var i={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&\\\"function\\\"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]]);return i},_tBounds=new AABBBounds,PopTip=(loadPoptipComponent(),class TX0 extends AbstractComponent{constructor(e,t){super(null!=t&&t.skipDefault?e:merge({},TX0.defaultAttributes,e)),this.name=\\\"poptip\\\",this.positionList=[\\\"top\\\",\\\"tl\\\",\\\"tr\\\",\\\"bottom\\\",\\\"bl\\\",\\\"br\\\",\\\"left\\\",\\\"lt\\\",\\\"lb\\\",\\\"right\\\",\\\"rt\\\",\\\"rb\\\"]}render(){var{titleStyle:e={},position:t,contentStyle:i={},panel:r={},space:o=4,minWidth:n=0,maxWidth:a=1/0,padding:l=4,maxWidthPercent:s,visible:h,state:d,dx:u=0,dy:c=0}=this.attribute,{title:g=\\\"\\\",content:p=\\\"\\\"}=this.attribute,g=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(g):g,p=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(p):p,l=normalizePadding(l),f=this.createOrUpdateChild(\\\"poptip-content\\\",{x:0,y:0,zIndex:1},\\\"group\\\"),m=a-l[1]-l[3],b=isValid_default(g)&&!1!==h,g=Object.assign(Object.assign({text:isArray_default(g)?g:[g],visible:b,wrap:!0},e),{x:l[3],y:l[0],maxLineWidth:m,textAlign:\\\"left\\\",textBaseline:\\\"top\\\"}),e=f.createOrUpdateChild(\\\"poptip-title\\\",g,\\\"text\\\"),g=(isEmpty_default(null==d?void 0:d.title)||(e.states=d.title),e.AABBBounds),C=g.height(),g=g.width();let v=C+o;b||(v=0);var y=isValid_default(p)&&!1!==h,C=Object.assign(Object.assign({text:isArray_default(p)?p:[p],visible:y,wrap:!0},i),{x:l[3],y:l[0]+v,maxLineWidth:m,textAlign:\\\"left\\\",textBaseline:\\\"top\\\"}),h=f.createOrUpdateChild(\\\"poptip-content\\\",C,\\\"text\\\"),p=(isEmpty_default(null==d?void 0:d.content)||(h.states=d.content),h.AABBBounds),i=p.height(),m=p.width();y&&(v+=i);let w=max(g+l[1]+l[3],m+l[1]+l[3]),_=(w>a?w=a:w<n&&(w=n),l[0]+l[2]+v);var S=r.visible,x=__rest2(r,[\\\"visible\\\"]),R=null!=(C=x.size)?C:12,T=isArray_default(R)?[R[0]+(null!=(p=x.space)?p:0),R[1]+(null!=(i=x.space)?i:0)]:R+(null!=(g=x.space)?g:0),A=null!=(m=x.lineWidth)?m:1,P=this.stage?[null!=(a=this.stage.viewWidth)?a:this.stage.width,null!=(n=this.stage.viewHeight)?n:this.stage.height]:void 0,B=(P&&(r=this.AABBBounds,p=null!=(C=this.attribute.x)?C:r.x1,i=P[0]-r.x1,g=Math.max(p,i),m=(isArray_default(R)?R[0]:12)+3,(g=Math.min(g-m,g*s))<w)&&(w=g,a=l[1]+l[3],e.setAttribute(\\\"maxLineWidth\\\",g-a),h.setAttribute(\\\"maxLineWidth\\\",g-a),_=l[0]+l[2],b&&(_+=e.AABBBounds.height()+o),_+=h.AABBBounds.height()),\\\"auto\\\"===t);let M,E=-1/0;for(let k=0;k<this.positionList.length+1;k++){var H=B?this.positionList[k===this.positionList.length?M:k]:t,{angle:H,offset:I}=this.getAngleAndOffset(H,w,_,isArray_default(T)?T:[T,T-A]);if(isBoolean_default(S)&&(L=(isArray_default(R)?R[0]:R)/4,L=f.createOrUpdateChild(\\\"poptip-symbol-panel\\\",Object.assign(Object.assign({},x),{visible:S&&(y||b),x:L,y:0,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:\\\"arrow2Left\\\",angle:H,dx:I[0],dy:I[1],size:R,zIndex:-9}),\\\"symbol\\\"),isEmpty_default(null==d?void 0:d.panel)||(L.states=d.panel),H=f.createOrUpdateChild(\\\"poptip-rect-panel\\\",Object.assign(Object.assign({},x),{visible:S&&(y||b),x:0,y:0,width:w,height:_,zIndex:-8}),\\\"rect\\\"),isEmpty_default(null==d?void 0:d.panel)||(H.states=d.panel)),f.setAttributes({x:-I[0]+u,y:-I[1]+c}),!B||!P)break;_tBounds.setValue(0,0,w,_).transformWithMatrix(f.globalTransMatrix);var L=_tBounds,H=(new Bounds).setValue(0,0,P[0],P[1]);if(rectInsideAnotherRect(L,H,!1))break;I=getRectIntersect(L,H,!1),H=(I.x2-I.x1)*(I.y2-I.y1);H>E&&(E=H,M=k)}}getAngleAndOffset(e,t,i,r){var o=r[1]/2;switch(e){case\\\"tl\\\":return{angle:pi/2*3,offset:[t/4,i+o],rectOffset:[-t/4,-i-r[1]]};case\\\"top\\\":return{angle:pi/2*3,offset:[t/2,i+o],rectOffset:[0,-i-r[1]]};case\\\"tr\\\":return{angle:pi/2*3,offset:[t/4*3,i+o],rectOffset:[t/4*3,-i-r[1]]};case\\\"rt\\\":return{angle:0,offset:[-o,i/5],rectOffset:[t/4*3,-i-r[1]]};case\\\"right\\\":return{angle:0,offset:[-o,i/2],rectOffset:[t/4*3,-i-r[1]]};case\\\"rb\\\":return{angle:0,offset:[-o,i/5*4],rectOffset:[t/4*3,-i-r[1]]};case\\\"bl\\\":return{angle:pi/2,offset:[t/4,-o],rectOffset:[-t/4,-i-r[1]]};case\\\"bottom\\\":return{angle:pi/2,offset:[t/2,-o],rectOffset:[0,-i-r[1]]};case\\\"br\\\":return{angle:pi/2,offset:[t/4*3,-o],rectOffset:[t/4*3,-i-r[1]]};case\\\"lt\\\":return{angle:pi,offset:[t+o,i/5],rectOffset:[-t/4,-i-r[1]]};case\\\"left\\\":return{angle:pi,offset:[t+o,i/2],rectOffset:[0,-i-r[1]]};case\\\"lb\\\":return{angle:pi,offset:[t+o,i/5*4],rectOffset:[t/4*3,-i-r[1]]}}}}),__decorate57=(PopTip.defaultAttributes={position:\\\"rt\\\",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:\\\"#000\\\",textAlign:\\\"left\\\",textBaseline:\\\"top\\\"},contentStyle:{fontSize:12,fill:\\\"#000\\\",textAlign:\\\"left\\\",textBaseline:\\\"top\\\"},maxWidthPercent:.8,space:8,padding:10},init_esbuild_inject(),init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a});function wrapPoptip(e,t){return merge(e,theme.poptip,t),e}var PopTipRenderContribution=class{render(t,e,i,r,o,n,a,l,s,h,d,u,c){if(1===t._showPoptip){var{visible:g,visibleCb:p}=t.attribute.poptip||{};if(!(!1===g||p&&!1===p(t))){var g={};merge(g,PopTip.defaultAttributes,t.attribute.poptip||{}),this.poptipComponent?this.poptipComponent.initAttributes(g):this.poptipComponent=new PopTip(g);let e=t.attribute.poptip||{};\\\"text\\\"===t.type&&null==e.title&&null==e.content&&(wrapPoptip(p={},e),(e=p).content=null!=(g=e.content)?g:t.attribute.text);var p=t.globalTransMatrix,g=(this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1},e),{x:p.e,y:p.f})),h.stage.tryInitInteractiveLayer(),h.stage.getLayer(\\\"_builtin_interactive\\\"));g&&g.add(this.poptipComponent)}}else 2===t._showPoptip&&(t._showPoptip=0,this.poptipComponent)&&(this.poptipComponent.setAttributes({visibleAll:!1}),null!=(p=this.poptipComponent.parent)&&p.removeChild(this.poptipComponent),this.poptipComponent=null)}},PopTipRenderContribution=__decorate57([injectable()],PopTipRenderContribution),__decorate58=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),PopTipPluginBase=class{constructor(){this.activeEvent=\\\"onRegister\\\",this._uid=Generator.GenAutoIncrementId(),this.poptip=e=>{var t=e.target;this.needHide(t)?this.unpoptip(e):t!==this.activeGraphic&&(this.needShow(t)&&(t.setAttributes({}),t._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(t,!0))},this.unpoptip=e=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(e){this.pluginService=e;var t=this.pluginService.stage;t.addEventListener(\\\"pointerover\\\",this.poptip)}needHide(e){return e.isContainer||!e.attribute}needShow(e){return!!e.attribute.poptip}setActiveGraphic(e,t){this.activeGraphic=e,this.pluginService.stage.renderNextFrame()}deactivate(e){var t=this.pluginService.stage;t.removeEventListener(\\\"pointerover\\\",this.poptip)}},PopTipPlugin=class extends PopTipPluginBase{constructor(){super(...arguments),this.name=\\\"poptip\\\",this.key=this.name+this._uid}},PopTipPlugin=__decorate58([injectable()],PopTipPlugin),PopTipForClipedTextPlugin=class extends PopTipPluginBase{constructor(){super(...arguments),this.name=\\\"poptipForText\\\",this.key=this.name+this._uid,this.pointerlave=e=>{var t=this.pluginService.stage;e.target===t&&this.unpoptip(e)}}activate(e){super.activate(e);var t=this.pluginService.stage;t.addEventListener(\\\"pointerleave\\\",this.pointerlave)}needHide(e){return\\\"text\\\"!==e.type||!e.cliped||e.isContainer||!e.attribute||e.attribute.disableAutoClipedPoptip}needShow(e){return!0}deactivate(e){var t=this.pluginService.stage;super.deactivate(e),t.removeEventListener(\\\"pointerleave\\\",this.pointerlave)}},PopTipForClipedTextPlugin=__decorate58([injectable()],PopTipForClipedTextPlugin),popTipModule=new ContainerModule((e,t,i,r)=>{i(PopTipRenderContribution)||(e(PopTipRenderContribution).toSelf().inSingletonScope(),e(InteractiveSubRenderContribution).toService(PopTipRenderContribution)),i(PopTipPlugin)||(e(PopTipPlugin).toSelf(),e(AutoEnablePlugins).toService(PopTipPlugin)),i(PopTipForClipedTextPlugin)||(e(PopTipForClipedTextPlugin).toSelf(),e(AutoEnablePlugins).toService(PopTipForClipedTextPlugin))});function loadPoptip(){container.load(popTipModule)}function loadCheckBoxComponent(){registerGroup(),registerRect(),registerText(),registerImage()}init_esbuild_inject(),init_esbuild_inject();var checkSvg='<svg width=\\\"200\\\" height=\\\"200\\\" viewBox=\\\"0 0 1024 1024\\\" fill=\\\"#fff\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z\\\"></path></svg>',indeterminateSvg='<svg width=\\\"200\\\" height=\\\"200\\\" viewBox=\\\"0 0 24 24\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" fill=\\\"none\\\"><path stroke=\\\"#fff\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"5\\\" d=\\\"M5 12h14\\\"/></svg>',CheckBox=(loadCheckBoxComponent(),class w$0 extends AbstractComponent{constructor(e,t){super(null!=t&&t.skipDefault?e:merge({},w$0.defaultAttributes,e)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute(\\\"checked\\\",!1):this.setAttribute(\\\"checked\\\",!0),this.setAttribute(\\\"indeterminate\\\",!1),this._dispatchEvent(\\\"checkbox_state_change\\\",{eventType:\\\"checkbox_state_change\\\",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(e,t,i)=>{\\\"interactive\\\"in e&&this.setAttribute(\\\"pickable\\\",e.interactive),\\\"disabled\\\"in e&&this.setAttribute(\\\"cursor\\\",e.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener(\\\"pointerup\\\",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new Rect(merge({},this.attribute.box));var e=this.attribute.checked||this.attribute.indeterminate;e&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):e?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new Image2(merge({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new Image2(merge({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute(\\\"visible\\\",!0),this._indeterminateIcon.setAttribute(\\\"visible\\\",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute(\\\"visible\\\",!1),this._indeterminateIcon.setAttribute(\\\"visible\\\",!0)):(this._checkIcon.setAttribute(\\\"visible\\\",!1),this._indeterminateIcon.setAttribute(\\\"visible\\\",!1))}renderText(){this._text=new Text(merge({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute(\\\"fill\\\",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute(\\\"pickable\\\",!1),this.attribute.disabled&&this.setAttribute(\\\"cursor\\\",this.attribute.disableCursor)}layout(){var e=this.attribute.box.height,t=this.attribute.icon.height,i=this._text.AABBBounds.height(),r=Math.max(e,t,i),e=r/2-e/2,t=r/2-t/2,r=r/2-i/2,i=this.attribute.box.width,o=this.attribute.icon.width,n=Math.max(i,o),o=n/2-o/2,a=n+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:n/2-i/2,y:e}),this._checkIcon.setAttributes({x:o,y:t}),this._indeterminateIcon.setAttributes({x:o,y:t}),this._text.setAttributes({x:a,y:r})}initAttributes(e,t){e=null!=t&&t.skipDefault?e:merge({},w$0.defaultAttributes,e),super.initAttributes(e),this.renderGroup(),this.render()}});function loadRadioComponent(){registerGroup(),registerRect(),registerWrapText(),registerImage()}CheckBox.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:\\\"pointer\\\",disableCursor:\\\"not-allowed\\\",spaceBetweenTextAndIcon:8,text:{text:\\\"text\\\",fontSize:14,fill:\\\"#000\\\",disableFill:\\\"rgb(201,205,212)\\\",textBaseline:\\\"top\\\",pickable:!1},icon:{checkIconImage:checkSvg,indeterminateIconImage:indeterminateSvg,width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:\\\"#fff\\\",stroke:\\\"rgb(229,230,235)\\\",disableFill:\\\"rgb(242,243,245)\\\",checkedFill:\\\"rgb(22, 93, 255)\\\",checkedStroke:\\\"rgb(22, 93, 255)\\\",disableCheckedFill:\\\"rgb(148, 191, 255)\\\",disableCheckedStroke:\\\"rgb(148, 191, 255)\\\",pickable:!1}},init_esbuild_inject(),init_esbuild_inject(),loadRadioComponent();var InteractionState,HighlightScope,AggregationType,SortType,Placement,HierarchyState,IconPosition,IconFuncTypeEnum,InternalIconName,Radio=class S$0 extends AbstractComponent{constructor(e,t){super(null!=t&&t.skipDefault?e:merge({},S$0.defaultAttributes,e)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute(\\\"checked\\\",!0),this._dispatchEvent(\\\"radio_checked\\\",{eventType:\\\"radio_checked\\\",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(e,t,i)=>{\\\"interactive\\\"in e&&this.setAttribute(\\\"pickable\\\",e.interactive),\\\"disabled\\\"in e&&this.setAttribute(\\\"cursor\\\",e.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener(\\\"pointerup\\\",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new Arc(merge({},this.attribute.circle));var e=this.attribute.checked;e&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):e?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new Text(merge({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute(\\\"fill\\\",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute(\\\"pickable\\\",!1),this.attribute.disabled&&this.setAttribute(\\\"cursor\\\",this.attribute.disableCursor)}layout(){var e=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),t=this._text.AABBBounds.height(),i=Math.max(e,t),e=i/2-e/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,i=i/2-t/2,t=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),r=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,t=t+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:r,y:e}),this._text.setAttributes({x:t,y:i})}initAttributes(e,t){e=null!=t&&t.skipDefault?e:merge({},S$0.defaultAttributes,e),super.initAttributes(e),this.renderGroup(),this.render()}},registed=!(Radio.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:\\\"pointer\\\",disableCursor:\\\"not-allowed\\\",spaceBetweenTextAndIcon:8,text:{text:\\\"text\\\",fontSize:14,fill:\\\"#000\\\",disableFill:\\\"rgb(201,205,212)\\\",textBaseline:\\\"top\\\",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:\\\"#fff\\\",stroke:\\\"rgb(229,230,235)\\\",disableFill:\\\"rgb(242,243,245)\\\",checkedFill:\\\"rgb(22, 93, 255)\\\",checkedStroke:\\\"rgb(22, 93, 255)\\\",disableCheckedFill:\\\"rgb(148, 191, 255)\\\",disableCheckedStroke:\\\"rgb(148, 191, 255)\\\",pickable:!1}});function registerForVrender(){registed||(registed=!0,preLoadAllModule(),isBrowserEnv()?loadBrowserEnv(container):isNodeEnv()&&loadNodeEnv(container),registerArc(),registerCircle(),registerGroup(),registerImage(),registerLine(),registerRect(),registerRichtext(),registerShadowRoot(),registerSymbol(),registerText(),registerFlexLayoutPlugin(),loadPoptip(),registerFlexLayoutPlugin())}init_esbuild_inject(),function(e){e[\\\"default\\\"]=\\\"default\\\",e.grabing=\\\"grabing\\\",e.scrolling=\\\"scrolling\\\"}(InteractionState=InteractionState||{}),function(e){e.single=\\\"single\\\",e.column=\\\"column\\\",e.row=\\\"row\\\",e.cross=\\\"cross\\\",e.none=\\\"none\\\"}(HighlightScope=HighlightScope||{}),init_esbuild_inject(),function(e){e.RECORD=\\\"RECORD\\\",e.NONE=\\\"NONE\\\",e.SUM=\\\"SUM\\\",e.MIN=\\\"MIN\\\",e.MAX=\\\"MAX\\\",e.AVG=\\\"AVG\\\",e.COUNT=\\\"COUNT\\\",e.CUSTOM=\\\"CUSTOM\\\",e.RECALCULATE=\\\"RECALCULATE\\\"}(AggregationType=AggregationType||{}),function(e){e.ASC=\\\"ASC\\\",e.DESC=\\\"DESC\\\",e.NORMAL=\\\"NORMAL\\\",e.desc=\\\"desc\\\",e.asc=\\\"asc\\\",e.normal=\\\"normal\\\"}(SortType=SortType||{}),init_esbuild_inject(),function(e){e.top=\\\"top\\\",e.bottom=\\\"bottom\\\",e.left=\\\"left\\\",e.right=\\\"right\\\"}(Placement=Placement||{}),function(e){e.expand=\\\"expand\\\",e.collapse=\\\"collapse\\\",e.none=\\\"none\\\",e.loading=\\\"loading\\\"}(HierarchyState=HierarchyState||{}),init_esbuild_inject(),function(e){e.inlineFront=\\\"inlineFront\\\",e.inlineEnd=\\\"inlineEnd\\\",e.left=\\\"left\\\",e.right=\\\"right\\\",e.absoluteRight=\\\"absoluteRight\\\",e.contentLeft=\\\"contentLeft\\\",e.contentRight=\\\"contentRight\\\",e.absolute=\\\"absolute\\\"}(IconPosition=IconPosition||{}),function(e){e.frozen=\\\"frozen\\\",e.sort=\\\"sort\\\",e.dropDown=\\\"dropDown\\\",e.dropDownState=\\\"dropDownState\\\",e.play=\\\"play\\\",e.damagePic=\\\"damagePic\\\",e.expand=\\\"expand\\\",e.collapse=\\\"collapse\\\",e.drillDown=\\\"drillDown\\\",e.drillUp=\\\"drillUp\\\",e.dragReorder=\\\"dragReorder\\\"}(IconFuncTypeEnum=IconFuncTypeEnum||{}),function(e){e.upwardIconName=\\\"sort_upward\\\",e.downwardIconName=\\\"sort_downward\\\",e.normalIconName=\\\"sort_normal\\\",e.freezeIconName=\\\"freeze\\\",e.frozenIconName=\\\"frozen\\\",e.frozenCurrentIconName=\\\"frozenCurrent\\\",e.dropdownIconName=\\\"dropdownIcon\\\",e.expandIconName=\\\"expand\\\",e.collapseIconName=\\\"collapse\\\",e.dragReorderIconName=\\\"dragReorder\\\",e.loadingIconName=\\\"loading\\\"}(InternalIconName=InternalIconName||{}),init_esbuild_inject();var registeredAggregators={},Aggregator=class{constructor(e){var t;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.key=e.key,this.field=e.field,this.formatFun=e.formatFun,this.isRecord=null!=(t=e.isRecord)?t:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(e,t,i){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),e,t,i):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.clearCacheValue()}},RecordAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.RECORD,this.isRecord=!0}push(e){e&&this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),this.clearCacheValue()}deleteRecord(t){t&&this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.clearCacheValue())}value(){return this.records}reset(){this.records=[]}recalculate(){}},NoneAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.NONE,this.isRecord=!0}push(e){e&&(this.isRecord&&(this.records=[e]),this.field)&&(this.fieldValue=e[this.field]),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.field)&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){return this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){}},CustomAggregator=class extends Aggregator{constructor(e){super(e),this.type=AggregationType.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=e.aggregationFun}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),this.field)&&this.values.push(e[this.field]),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.field)&&this.records.length&&(this.values=this.records.map(e=>e[this.field])),this.clearCacheValue()}value(){var e;return this.fieldValue||(this.fieldValue=null==(e=this.aggregationFun)?void 0:e.call(this,this.values,this.records,this.field)),this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}},RecalculateAggregator=class extends Aggregator{constructor(e){super(e),this.type=AggregationType.RECALCULATE,this.isRecord=!0,this.calculateFun=e.calculateFun,this.dependAggregators=e.dependAggregators,this.dependIndicatorKeys=e.dependIndicatorKeys}push(e){e&&this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),this.clearCacheValue()}deleteRecord(t){t&&this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.clearCacheValue())}value(){var e,t;return this.fieldValue||(t=_getDependAggregatorValues(this.dependAggregators,this.dependIndicatorKeys),this.fieldValue=null==(e=this.calculateFun)?void 0:e.call(this,t,this.records,this.field)),this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){}},SumAggregator=class extends Aggregator{constructor(e){var t;super(e),this.type=AggregationType.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=null!=(t=e.needSplitPositiveAndNegative)&&t}push(e){var t;e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?(t=e.value(),this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(0<t?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))):this.field&&!isNaN(parseFloat(e[this.field]))&&(t=parseFloat(e[this.field]),this.sum+=t,this.needSplitPositiveAndNegativeForSum)&&(0<t?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))),this.clearCacheValue()}deleteRecord(t){var e;t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?(e=t.value(),this.sum-=null!=e?e:0,this.needSplitPositiveAndNegativeForSum&&(0<e?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))):this.field&&!isNaN(parseFloat(t[this.field]))&&(e=parseFloat(t[this.field]),this.sum-=e,this.needSplitPositiveAndNegativeForSum)&&(0<e?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))),this.clearCacheValue()}updateRecord(t,i){var e,r;t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),t.isAggregator?(e=t.value(),r=i.value(),this.sum+=r-e,this.needSplitPositiveAndNegativeForSum&&(0<e?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e),0<r?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r))):this.field&&!isNaN(parseFloat(t[this.field]))&&(e=parseFloat(t[this.field]),r=parseFloat(i[this.field]),this.sum+=r-e,this.needSplitPositiveAndNegativeForSum)&&(0<e?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e),0<r?this.positiveSum+=r:r<0&&(this.nagetiveSum+=r)),this.clearCacheValue())}value(){var e;return 1<=(null==(e=this.records)?void 0:e.length)?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.records)for(let e=0;e<this.records.length;e++){var t,i=this.records[e];i.isAggregator?(t=i.value(),this.sum+=null!=t?t:0,this.needSplitPositiveAndNegativeForSum&&(0<t?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))):this.field&&!isNaN(parseFloat(i[this.field]))&&(t=parseFloat(i[this.field]),this.sum+=t,this.needSplitPositiveAndNegativeForSum)&&(0<t?this.positiveSum+=t:t<0&&(this.nagetiveSum+=t))}}},CountAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.COUNT,this.count=0}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?this.count+=e.value():this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?this.count-=t.value():this.count--),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),t.isAggregator)&&(this.count+=i.value()-t.value())}value(){return this.count}reset(){this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.records)for(let e=0;e<this.records.length;e++){var t=this.records[e];t.isAggregator?this.count+=t.value():this.count++}}},AvgAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.AVG,this.sum=0,this.count=0}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator&&e.type===AggregationType.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===AggregationType.AVG?(this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),t.isAggregator&&t.type===AggregationType.AVG?(this.sum+=i.sum-t.sum,this.count+=i.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(i[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var e;return 1<=(null==(e=this.records)?void 0:e.length)?this.sum/this.count:void 0}reset(){this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.records)for(let e=0;e<this.records.length;e++){var t=this.records[e];t.isAggregator&&t.type===AggregationType.AVG?(this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)}}},MaxAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.MAX,this.max=Number.MIN_SAFE_INTEGER}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?this.max=(e.max>this.max?e:this).max:\\\"number\\\"==typeof e?this.max=e>this.max?e:this.max:this.field&&\\\"number\\\"==typeof e[this.field]?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.recalculate())}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.recalculate())}value(){var e;return 1<=(null==(e=this.records)?void 0:e.length)?this.max:void 0}reset(){this.records=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.records)for(let e=0;e<this.records.length;e++){var t=this.records[e];t.isAggregator?this.max=(t.max>this.max?t:this).max:\\\"number\\\"==typeof t?this.max=t>this.max?t:this.max:this.field&&\\\"number\\\"==typeof t[this.field]?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)}}},MinAggregator=class extends Aggregator{constructor(){super(...arguments),this.type=AggregationType.MIN,this.min=Number.MAX_SAFE_INTEGER}push(e){e&&(this.isRecord&&this.records&&(e.isAggregator?this.records.push(...e.records):this.records.push(e)),e.isAggregator?this.min=(e.min<this.min?e:this).min:\\\"number\\\"==typeof e?this.min=e<this.min?e:this.min:this.field&&\\\"number\\\"==typeof e[this.field]?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.recalculate())}updateRecord(t,i){t&&i&&(this.isRecord&&this.records&&(this.records=this.records.map(e=>e===t?i:e)),this.recalculate())}value(){var e;return 1<=(null==(e=this.records)?void 0:e.length)?this.min:void 0}reset(){this.records=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.records)for(let e=0;e<this.records.length;e++){var t=this.records[e];t.isAggregator?this.min=(t.min<this.min?t:this).min:\\\"number\\\"==typeof t?this.min=t<this.min?t:this.min:this.field&&\\\"number\\\"==typeof t[this.field]?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)}}};function typeSort(e,t,i){var r;return i===SortType.NORMAL||i===SortType.normal?0:(r=i===SortType.DESC||i===SortType.desc?-1:1,e&&t?e.toString().localeCompare(t.toString(),\\\"zh\\\")*r:e?r:-1*r)}function naturalSort(e,t,i){if(i===SortType.NORMAL||i===SortType.normal)return 0;var r=/(\\\\d+)|(\\\\D+)/g,o=/\\\\d/,n=/^0/;let a,l,s,h,d,u;var c=i===SortType.DESC||i===SortType.desc?-1:1;if(null!==t&&null===e)return-1*c;if(null!==e&&null===t)return c;if(\\\"number\\\"==typeof e&&isNaN(e))return-1*c;if(\\\"number\\\"==typeof t&&isNaN(t))return c;if((d=+e)<(u=+t))return-1*c;if(u<d)return c;if(\\\"number\\\"==typeof e&&\\\"number\\\"!=typeof t)return-1*c;if(\\\"number\\\"==typeof t&&\\\"number\\\"!=typeof e)return c;if(\\\"number\\\"==typeof e&&\\\"number\\\"==typeof t)return 0;if(isNaN(u)&&!isNaN(d))return-1*c;if(isNaN(d)&&!isNaN(u))return c;if(a=String(e),s=String(t),a===s)return 0;if(!o.test(a)||!o.test(s))return(a>s?1:-1)*c;for(a=a.match(r),s=s.match(r);a.length&&s.length;)if(l=a.shift(),h=s.shift(),l!==h)return o.test(l)&&o.test(h)?(l.replace(n,\\\".0\\\")-h.replace(n,\\\".0\\\"))*c:(h<l?1:-1)*c;return(a.length-s.length)*c}function sortBy(e){var t;const n={},a={};for(let i=0;i<e.length;i++)t=e[i],n[t]=i,\\\"string\\\"==typeof t&&(a[t.toLowerCase()]=i);return function(e,t,i){if(i===SortType.NORMAL||i===SortType.normal)return 0;var r=i===SortType.DESC||i===SortType.desc?-1:1;let o;return null!=n[e]&&null!=n[t]?o=n[e]-n[t]:null!=n[e]?o=-1:null!=n[t]?o=1:null!==a[e]&&void 0!==n[e]&&null!==a[t]&&void 0!==n[t]?o=a[e]-a[t]:null===a[e]||void 0===n[e]||null===a[t]||void 0===n[t]?o=0:null!==a[e]&&void 0!==n[e]?o=-1:null!==a[t]&&void 0!==n[t]&&(o=1),isValid_default(o)?o*r:naturalSort(e,t,i)}}function _getDependAggregatorValues(e,t){var i={};for(let o=0;o<(null==t?void 0:t.length);o++){var r=e.find(e=>(null==e?void 0:e.key)===t[o]);r&&(i[r.key]=null==r?void 0:r.value())}return i}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var defaultStyle,defaultStyle2,defaultStyle3,defaultStyle4,defaultStyle5,defaultStyle6,defaultStyle7,idCount=1,EventTarget3=class{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,i){const r=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]),o=(r.push(i),idCount++);return this.listenersData.listenerData[o]={type:t,listener:i,remove:()=>{delete this.listenersData.listenerData[o];var e=r.indexOf(i);r.splice(e,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},o}off(e,t){var i;t?this.removeEventListener(e,t):this.listenersData&&null!=(i=this.listenersData.listenerData[e])&&i.remove()}addEventListener(e,t,i){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(const r in this.listenersData.listenerData){var i=this.listenersData.listenerData[r];i.type===e&&i.listener===t&&this.off(r)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){var i;return this.listenersData&&(i=this.listenersData.listeners[e])?i.map(e=>e.call(this,t)).filter(e=>isValid_default(e)):[]}release(){delete this.listenersData}},STYLE_EVENT_TYPE={CHANGE_STYLE:\\\"change_style\\\"},Style=class cbb extends EventTarget3{static get EVENT_TYPE(){return STYLE_EVENT_TYPE}static get DEFAULT(){return defaultStyle=defaultStyle||new cbb}constructor(e={},t={}){var i;super(),this._defaultPadding=[10,16,10,16],this._textAlign=null!=(i=null==e?void 0:e.textAlign)?i:null==t?void 0:t.textAlign,this._textBaseline=null!=(i=null==e?void 0:e.textBaseline)?i:null==t?void 0:t.textBaseline,this._color=null!=(i=null==e?void 0:e.color)?i:null==t?void 0:t.color,this._strokeColor=null!=(i=null==e?void 0:e.strokeColor)?i:null==t?void 0:t.strokeColor,this._fontSize=null!=(i=e.fontSize)?i:null==t?void 0:t.fontSize,this._fontFamily=null!=(i=e.fontFamily)?i:null==t?void 0:t.fontFamily,this._fontWeight=null!=(i=e.fontWeight)?i:null==t?void 0:t.fontWeight,this._fontVariant=null!=(i=e.fontVariant)?i:null==t?void 0:t.fontVariant,this._fontStyle=null!=(i=e.fontStyle)?i:null==t?void 0:t.fontStyle,this._padding=null!=(i=null!=(i=null==e?void 0:e.padding)?i:null==t?void 0:t.padding)?i:this._defaultPadding,this._borderColor=null!=(i=null==e?void 0:e.borderColor)?i:null==t?void 0:t.borderColor,this._textOverflow=null!=(i=null==e?void 0:e.textOverflow)?i:null==t?void 0:t.textOverflow,this._textStick=null!=(i=null!=(i=e.textStick)?i:null==t?void 0:t.textStick)&&i,this._textStickBaseOnAlign=null!=(i=null!=(i=e.textStickBaseOnAlign)?i:null==t?void 0:t.textStickBaseOnAlign)&&i,this._bgColor=null!=(i=null==e?void 0:e.bgColor)?i:null==t?void 0:t.bgColor,this._lineHeight=null!=(i=null==e?void 0:e.lineHeight)?i:null==t?void 0:t.lineHeight,this._underline=null!=(i=null==e?void 0:e.underline)?i:null==t?void 0:t.underline,this._underlineColor=null!=(i=null==e?void 0:e.underlineColor)?i:null==t?void 0:t.underlineColor,this._underlineDash=null!=(i=null==e?void 0:e.underlineDash)?i:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(i=null==e?void 0:e.underlineOffset)?i:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(i=null==e?void 0:e.lineThrough)?i:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(i=null==e?void 0:e.lineThroughColor)?i:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(i=null==e?void 0:e.lineThroughDash)?i:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(i=null==e?void 0:e.linkColor)?i:null==t?void 0:t.linkColor,this._cursor=null!=(i=e.cursor)?i:null==t?void 0:t.cursor,this._borderLineWidth=null!=(i=e.borderLineWidth)?i:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(i=e.borderLineDash)?i:null==t?void 0:t.borderLineDash,this._marked=null!=(i=e.marked)?i:null==t?void 0:t.marked}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get padding(){return this._padding}set padding(e){this._padding=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}get marked(){return this._marked}set marked(e){this._marked=e}clone(){return new cbb(this,null)}},ImageStyle=class k1b extends Style{static get DEFAULT(){return defaultStyle2=defaultStyle2||new k1b}constructor(e={},t={}){super(e,t)}clone(){return new k1b(this,null)}},TextStyle=(init_esbuild_inject(),class n1b extends Style{static get DEFAULT(){return defaultStyle3=defaultStyle3||new n1b}constructor(e={},t={}){var i;super(e,t),this._autoWrapText=null!=(i=null==e?void 0:e.autoWrapText)?i:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(i=null==e?void 0:e.lineClamp)?i:null==t?void 0:t.lineClamp}clone(){return new n1b(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}),CheckboxStyle=(init_esbuild_inject(),class u1b extends Style{static get DEFAULT(){return defaultStyle4=defaultStyle4||new u1b}constructor(e={},t={},i={}){var r;super(e,t),this._size=(null!=(r=null!=(r=null==e?void 0:e.size)?r:null==t?void 0:t.size)?r:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.defaultFill)?r:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.defaultStroke)?r:null==i?void 0:i.defaultStroke,this._disableFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableFill)?r:null==i?void 0:i.disableFill,this._checkedFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkedFill)?r:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkedStroke)?r:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableCheckedFill)?r:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableCheckedStroke)?r:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkIconImage)?r:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.indeterminateIconImage)?r:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new u1b(e,this)}clone(){return new u1b(this)}}),RadioStyle=(init_esbuild_inject(),class ecb extends Style{static get DEFAULT(){return defaultStyle5=defaultStyle5||new ecb}constructor(e={},t={},i={}){var r;super(e,t),this._size=(null!=(r=null!=(r=null==e?void 0:e.size)?r:null==t?void 0:t.size)?r:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=(null!=(r=null!=(r=null==e?void 0:e.spaceBetweenRadio)?r:null==t?void 0:t.spaceBetweenRadio)?r:null==i?void 0:i.spaceBetweenRadio)||2,this._innerRadius=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.innerRadius)?r:null==i?void 0:i.innerRadius,this._outerRadius=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.outerRadius)?r:null==i?void 0:i.outerRadius,this._defaultFill=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.defaultFill)?r:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.defaultStroke)?r:null==i?void 0:i.defaultStroke,this._disableFill=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.disableFill)?r:null==i?void 0:i.disableFill,this._checkedFill=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.checkedFill)?r:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.checkedStroke)?r:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.disableCheckedFill)?r:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(r=null==(r=null==e?void 0:e.radioStyle)?void 0:r.disableCheckedStroke)?r:null==i?void 0:i.disableCheckedStroke}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(e){this._spaceBetweenRadio=e}get innerRadius(){return this._innerRadius}set innerRadius(e){this._innerRadius=e}get outerRadius(){return this._outerRadius}set outerRadius(e){this._outerRadius=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}getStyle(e){return new ecb(e,this)}clone(){return new ecb(this)}}),SwitchStyle=(init_esbuild_inject(),class Tcb extends Style{static get DEFAULT(){return defaultStyle6=defaultStyle6||new Tcb}constructor(e={},t={},i={}){var r;super(e,t),this._spaceBetweenTextAndCircle=(null!=(r=null!=(r=null==e?void 0:e.spaceBetweenTextAndCircle)?r:null==t?void 0:t.spaceBetweenTextAndCircle)?r:null==i?void 0:i.spaceBetweenTextAndCircle)||6,this._circleRadius=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.circleRadius)?r:null==i?void 0:i.circleRadius)||8,this._boxWidth=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.boxWidth)?r:null==i?void 0:i.boxWidth)||40,this._boxHeight=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.boxHeight)?r:null==i?void 0:i.boxHeight)||24,this._checkedFill=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.checkedFill)?r:null==i?void 0:i.checkedFill)||\\\"#165DFF\\\",this._uncheckedFill=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.uncheckedFill)?r:null==i?void 0:i.uncheckedFill)||\\\"#c9cdd4\\\",this._disableCheckedFill=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.disableCheckedFill)?r:null==i?void 0:i.disableCheckedFill)||\\\"#94bfff\\\",this._disableUncheckedFill=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.disableUncheckedFill)?r:null==i?void 0:i.disableUncheckedFill)||\\\"#f2f3f5\\\",this._circleFill=(null!=(r=null==(r=null==e?void 0:e.switchStyle)?void 0:r.circleFill)?r:null==i?void 0:i.circleFill)||\\\"#FFF\\\"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(e){this._spaceBetweenTextAndCircle=e}get circleRadius(){return this._circleRadius}set circleRadius(e){this._circleRadius=e}get boxWidth(){return this._boxWidth}set boxWidth(e){this._boxWidth=e}get boxHeight(){return this._boxHeight}set boxHeight(e){this._boxHeight=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(e){this._uncheckedFill=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(e){this._disableUncheckedFill=e}get circleFill(){return this._circleFill}set circleFill(e){this._circleFill=e}getStyle(e){return new Tcb(e,this)}clone(){return new Tcb(this)}}),ButtonStyle=(init_esbuild_inject(),class x2b extends Style{static get DEFAULT(){return defaultStyle7=defaultStyle7||new x2b}constructor(e={},t={},i={}){var r;super(e,t),this._buttonColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonColor)?r:null==i?void 0:i.buttonColor)||\\\"#165DFF\\\",this._buttonBorderColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonBorderColor)?r:null==i?void 0:i.buttonBorderColor)||\\\"#165DFF\\\",this._buttonLineWidth=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonLineWidth)?r:null==i?void 0:i.buttonLineWidth)||1,this._buttonBorderRadius=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonBorderRadius)?r:null==i?void 0:i.buttonBorderRadius)||2,this._buttonHoverColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonHoverColor)?r:null==i?void 0:i.buttonHoverColor)||\\\"#4080FF\\\",this._buttonHoverBorderColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonHoverBorderColor)?r:null==i?void 0:i.buttonHoverBorderColor)||\\\"#4080FF\\\",this._buttonTextHoverColor=null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonTextHoverColor)?r:null==i?void 0:i.buttonTextHoverColor,this._buttonDisableColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonDisableColor)?r:null==i?void 0:i.buttonDisableColor)||\\\"#94bfff\\\",this._buttonDisableBorderColor=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonDisableBorderColor)?r:null==i?void 0:i.buttonDisableBorderColor)||\\\"#94bfff\\\",this._buttonTextDisableColor=null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonTextDisableColor)?r:null==i?void 0:i.buttonTextDisableColor,this._buttonPadding=(null!=(r=null==(r=null==e?void 0:e.buttonStyle)?void 0:r.buttonPadding)?r:null==i?void 0:i.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(e){this._buttonColor=e}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(e){this._buttonBorderColor=e}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(e){this._buttonLineWidth=e}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(e){this._buttonBorderRadius=e}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(e){this._buttonHoverColor=e}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(e){this._buttonHoverBorderColor=e}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(e){this._buttonTextHoverColor=e}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(e){this._buttonDisableColor=e}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(e){this._buttonDisableBorderColor=e}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(e){this._buttonTextDisableColor=e}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(e){this._buttonTextHoverBorderColor=e}get buttonPadding(){return this._buttonPadding}set buttonPadding(e){this._buttonPadding=e}getStyle(e){return new x2b(e,this)}clone(){return new x2b(this)}}),EVENT_TYPE=Style.EVENT_TYPE;function of(e,t,i,r=Style,o,n){var a;return e||t?e instanceof Style?e:\\\"function\\\"==typeof e?of(e(i),t,i,r,o,n):(e=e||{},o&&!isValid_default(e.autoWrapText)&&(e.autoWrapText=!0),r===CheckboxStyle?new CheckboxStyle(null!=e?e:{},null!=t?t:{},null!=(a=n.checkboxStyle)?a:{}):r===RadioStyle?new RadioStyle(null!=e?e:{},null!=t?t:{},null!=(a=n.radioStyle)?a:{}):r===SwitchStyle?new SwitchStyle(null!=e?e:{},null!=t?t:{},null!=(a=n.switchStyle)?a:{}):r===ButtonStyle?new ButtonStyle(null!=e?e:{},null!=t?t:{},null!=(a=n.buttonStyle)?a:{}):new r(null!=e?e:{},null!=t?t:{})):r.DEFAULT}init_esbuild_inject(),init_esbuild_inject();var Env=class sdb{static get mode(){return sdb._mode||(sdb._mode=defaultMode()),sdb._mode}static set mode(e){sdb._mode=e}static RegisterCreateCanvas(e){sdb.CreateCanvas=e}static RegisterLoadImage(e){sdb.LoadImage=e}static GetCreateCanvasFunc(){return sdb.CreateCanvas||(\\\"worker\\\"===sdb.mode?(e=200,t=200)=>new OffscreenCanvas(e,t):void 0)}static RegisterRequestAnimationFrame(e){sdb.RequestAnimationFrame=e()}static GetRequestAnimationFrame(){if(sdb.RequestAnimationFrame)return sdb.RequestAnimationFrame}static RegisterCancelAnimationFrame(e){sdb.CancelAnimationFrame=e()}static GetCancelAnimationFrame(){if(sdb.CancelAnimationFrame)return sdb.CancelAnimationFrame}};function defaultMode(){let e=\\\"browser\\\";try{\\\"node\\\"===window.type?e=\\\"node\\\":\\\"undefined\\\"==typeof window||window.performance?\\\"undefined\\\"==typeof window&&(e=\\\"node\\\"):e=\\\"miniApp\\\"}catch(err){e=\\\"node\\\"}return e}function importStyle(){var e;\\\"node\\\"!==Env.mode&&((e=document.createElement(\\\"style\\\")).id=\\\"vtable-style-styleSheet\\\",e.textContent=\\\"\\\\n.vtable .input-container {\\\\n\\\\tposition: absolute;\\\\n\\\\ttop:0px;\\\\n}\\\\n.vtable .table-scrollable {\\\\n\\\\tposition: absolute;\\\\n\\\\toverflow: scroll;\\\\n}\\\\n.vtable .table-scrollable::-webkit-scrollbar-button{\\\\n\\\\tbackground-color: transparent;\\\\n}\\\\n.vtable .table-scrollable::-webkit-scrollbar-track-piece{\\\\n\\\\tbackground-color: transparent;\\\\n}\\\\n.vtable .table-scrollable::-webkit-scrollbar-corner {\\\\n\\\\tbackground-color: transparent;\\\\n}\\\\n.vtable .table-scrollable::-webkit-scrollbar-thumb {\\\\n\\\\tborder-radius      : 4px;\\\\n\\\\tbackground-color   : rgba(100, 100, 100, .5);\\\\n}\\\\n\\\\n.vtable .table-scroll-end-point {\\\\n\\\\topacity: 0;\\\\n\\\\tposition: relative;\\\\n}\\\\n.vtable {\\\\n\\\\t/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\\\\n\\\\t/* overflow: auto; */\\\\n\\\\tposition: relative;\\\\n\\\\twidth: 100%;\\\\n\\\\theight: 100%;\\\\n\\\\ttext-align: left;\\\\n  -webkit-font-smoothing:auto;\\\\n\\\\n  overflow: hidden; // for react-vtable dom custom element\\\\n}\\\\n\\\\n.vtable-gantt {\\\\n\\\\t/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */\\\\n\\\\t/* overflow: auto; */\\\\n\\\\tposition: absolute;\\\\n\\\\twidth: 100%;\\\\n\\\\theight: 100%;\\\\n\\\\ttext-align: left;\\\\n  -webkit-font-smoothing:auto;\\\\n\\\\n  overflow: hidden; // for react-vtable dom custom element\\\\n}\\\\n.vtable .table-component-container {\\\\n  pointer-events: none;\\\\n  overflow: hidden;\\\\n  position: absolute;\\\\n  top: 0px;\\\\n  left: 0px;\\\\n}\\\\n.vtable > canvas {\\\\n\\\\tposition: absolute;\\\\n\\\\twidth: 0;\\\\n\\\\theight: 0;\\\\n}\\\\n.vtable .table-focus-control {\\\\n\\\\tposition: relative !important;\\\\n\\\\twidth: 1px;\\\\n\\\\theight: 1px;\\\\n\\\\topacity: 0;\\\\n\\\\tpadding: 0;\\\\n\\\\tmargin: 0;\\\\n\\\\tbox-sizing: border-box;\\\\n\\\\tpointer-events: none;\\\\n\\\\tmax-width: 500px;\\\\n\\\\tmax-height: 500px;\\\\n\\\\tfloat: none !important;\\\\n}\\\\n.vtable input.table-focus-control::-ms-clear {\\\\n\\\\tvisibility: hidden;\\\\n}\\\\n.vtable input.table-focus-control.composition {\\\\n\\\\topacity: 1;\\\\n\\\\tmax-width: none;\\\\n\\\\tmax-height: none;\\\\n}\\\\n\\\",document.head.appendChild(e))}function getHorizontalScrollBarSize(e){var t;return null!=e&&e.hoverOn||null!=e&&e.horizontalVisible&&\\\"none\\\"===(null==e?void 0:e.horizontalVisible)||(null==e||!e.horizontalVisible)&&\\\"none\\\"===(null==e?void 0:e.visible)?0:null!=(t=null==e?void 0:e.width)?t:7}function getVerticalScrollBarSize(e){var t;return null!=e&&e.hoverOn||null!=e&&e.verticalVisible&&\\\"none\\\"===(null==e?void 0:e.verticalVisible)||(null==e||!e.verticalVisible)&&\\\"none\\\"===(null==e?void 0:e.visible)?0:null!=(t=null==e?void 0:e.width)?t:7}function isValidStyle(e){return!!isValid_default(e)&&(!isArray_default(e)||e.some(e=>isValid_default(e)))}function isZeroStyle(e){return 0===e||isArray_default(e)&&e.every(e=>0===e)}Env.dpr=0,init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var judgeType=e=>{switch(Object.prototype.toString.call(e)){case\\\"[object Object]\\\":return\\\"object\\\";case\\\"[object Function]\\\":return\\\"function\\\";case\\\"[object Array]\\\":return\\\"array\\\";case\\\"[object String]\\\":return\\\"string\\\";case\\\"[object Number]\\\":return\\\"number\\\";case\\\"[object RegExp]\\\":return\\\"regExp\\\";case\\\"[object Boolean]\\\":return\\\"boolean\\\";case\\\"[object Symbol]\\\":return\\\"symbol\\\";case\\\"[object Date]\\\":return\\\"date\\\";case\\\"[object Undefined]\\\":return\\\"undefined\\\";case\\\"[object Null]\\\":return\\\"null\\\";case\\\"[object Error]\\\":return\\\"error\\\";case\\\"[object HTMLDocument]\\\":return\\\"document\\\";case\\\"[object global]\\\":return\\\"global\\\";default:return null}},isIt=(e,t)=>judgeType(e)===t,isObject2=e=>isIt(e,\\\"object\\\"),isString2=e=>isIt(e,\\\"string\\\"),isNumber2=e=>isIt(e,\\\"number\\\"),isBoolean2=e=>isIt(e,\\\"boolean\\\");function ingoreNoneValueMerge(e,...t){if(!t.length)return e||{};var i=t.shift();if(isObject2(e)&&isObject2(i))for(const r in i)isObject2(i[r])?(e[r]||Object.assign(e,{[r]:{}}),isObject2(e[r])||Object.assign(e,{[r]:i[r]}),ingoreNoneValueMerge(e[r],i[r])):null!=i[r]&&Object.assign(e,{[r]:i[r]});return ingoreNoneValueMerge(e,...t)}function convertInternal(e){return\\\"function\\\"==typeof e&&(e=e()),isValid_default(e)?\\\"\\\"+e:\\\"\\\"}function transpose(t){if((null==t?void 0:t.length)<=0)return t;var i=t.length,r=t[0].length,o=new Array(r);for(let n=0;n<i;n++)for(let e=0;e<r;e++)o[e]||(o[e]=new Array(i)),o[e][n]=t[n][e];return o}function throttle2(t,i){let r=null;return function(...e){r||(t.apply(this,e),r=setTimeout(()=>{r=null},i))}}function throttle22(t,i){let r=null;return function(...e){r=r||setTimeout(()=>{t.apply(this,e),r=null},i)}}function pad(e,t){for(e=\\\"\\\"+e;e.length<t;)e=\\\"0\\\"+e;return e}function changeColor(e,t,i){e=(e=e.replace(/^\\\\s*|\\\\s*$/,\\\"\\\")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,\\\"#$1$1$2$2$3$3\\\");var r=Math.round(256*t)*(i?-1:1),o=e.match(new RegExp(\\\"^rgba?\\\\\\\\(\\\\\\\\s*(\\\\\\\\d|[1-9]\\\\\\\\d|1\\\\\\\\d{2}|2[0-4][0-9]|25[0-5])\\\\\\\\s*,\\\\\\\\s*(\\\\\\\\d|[1-9]\\\\\\\\d|1\\\\\\\\d{2}|2[0-4][0-9]|25[0-5])\\\\\\\\s*,\\\\\\\\s*(\\\\\\\\d|[1-9]\\\\\\\\d|1\\\\\\\\d{2}|2[0-4][0-9]|25[0-5])(?:\\\\\\\\s*,\\\\\\\\s*(0|1|0?\\\\\\\\.\\\\\\\\d+))?\\\\\\\\s*\\\\\\\\)$\\\",\\\"i\\\")),n=o&&isValid_default(o[4])?o[4]:null,a=o?[o[1],o[2],o[3]]:e.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},`+parseInt(arguments[3],16)}).split(/,/);return o?`rgb${null!==n?\\\"a\\\":\\\"\\\"}(${Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[0],10)+r,i?0:255)}, ${Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[1],10)+r,i?0:255)}, ${Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[2],10)+r,i?0:255)}${null!==n?\\\", \\\"+n:\\\"\\\"})`:[\\\"#\\\",pad(Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[0],10)+r,i?0:255).toString(16),2),pad(Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[1],10)+r,i?0:255).toString(16),2),pad(Math[i?\\\"max\\\":\\\"min\\\"](parseInt(a[2],10)+r,i?0:255).toString(16),2)].join(\\\"\\\")}function validToString(e){return isString2(e)||isNumber2(e)||isBoolean2(e)?e.toString():\\\"\\\"}function defaultOrderFn(e,t,i){return\\\"desc\\\"!==i?e===t?0:t<e?1:-1:e===t?0:e<t?1:-1}function getValueByPath(e,t){let i,r=e;for(;(i=t.shift())&&(r=r[i]););return r}function isAllDigits(e){return/^-?\\\\d+(\\\\.\\\\d+)?$/.test(e)}function deduplication(e){var t=[];for(let i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function traverseObject(e,t,i){i(e),null!=e&&e[t]&&Array.isArray(null==e?void 0:e[t])&&e[t].forEach(e=>traverseObject(e,t,i))}var arrayFind,arrayFindIndex,isNode=\\\"undefined\\\"==typeof window||void 0===window.window,array={get find(){return arrayFind||(arrayFind=Array.prototype.find?(e,t)=>Array.prototype.find.call(e,t):(e,t)=>{var i=array.findIndex(e,t);return 0<=i?e[i]:void 0})},get findIndex(){return arrayFindIndex||(arrayFindIndex=Array.prototype.findIndex?(e,t)=>Array.prototype.findIndex.call(e,t):(e,t)=>{var i=e.length;for(let r=0;r<i;r++)if(t(e[r],r,e))return r;return-1})}};function analyzeUserAgent(){var e;return isNode?{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1}:(e=window.navigator.userAgent.toLowerCase(),{IE:!!/(msie|trident)/.exec(e),Edge:-1<e.indexOf(\\\"edge\\\"),Chrome:-1<e.indexOf(\\\"chrome\\\")&&-1===e.indexOf(\\\"edge\\\"),Firefox:-1<e.indexOf(\\\"firefox\\\"),Safari:-1<e.indexOf(\\\"safari\\\")&&-1===e.indexOf(\\\"edge\\\")})}var{IE,Chrome,Firefox,Edge:Edge2,Safari}=analyzeUserAgent();function isObject3(e){return e===Object(e)}function extend(...e){const r={};return e.forEach(t=>{for(const i in t)Object.defineProperty(r,i,{get:()=>t[i],set(e){t[i]=e},configurable:!0,enumerable:!0})}),r}function applyChainSafe(e,t,...i){let r=e;for(let o=0;o<i.length&&null!=r;o++)r=t(r,i[o]);return r}function getChainSafe(e,...t){return applyChainSafe(e,(e,t)=>e[t],...t)}function getOrApply(e,...t){return\\\"function\\\"==typeof e?e(...t):e}function isPromise(e){return Boolean(e&&\\\"function\\\"==typeof e.then)}function getPromiseValue(e,t){isPromise(e)?e.then(e=>{t(e)})[\\\"catch\\\"](e=>{}):t(e)}function isTouchEvent(e){return!!e.changedTouches}function getIgnoreCase(e,t){if(e[t])return e[t];var i=t.toLowerCase();if(e[i])return e[i];var r=t.toLowerCase();if(e[r])return e[r];for(const o in e)if(o.toLowerCase()===i)return e[o]}function toBoxArray(e){return Array.isArray(e)?3===e.length?[e[0],e[1],e[2],e[1]]:2===e.length?[e[0],e[1],e[0],e[1]]:1===e.length?[e[0],e[0],e[0],e[0]]:[e[0],e[1],e[2],e[3]]:[e,e,e,e]}function cellInRange(e,t,i){return e.start.col<=t&&t<=e.end.col&&e.start.row<=i&&i<=e.end.row||e.end.col<=t&&t<=e.start.col&&e.end.row<=i&&i<=e.start.row||e.end.col<=t&&t<=e.start.col&&e.start.row<=i&&i<=e.end.row||e.start.col<=t&&t<=e.end.col&&e.end.row<=i&&i<=e.start.row}function cellInRanges(e,t,i){for(let l=0;l<e.length;l++){var r=e[l],o=Math.min(r.start.col,r.end.col),n=Math.max(r.start.col,r.end.col),a=Math.min(r.start.row,r.end.row),r=Math.max(r.start.row,r.end.row);if(o<=t&&t<=n&&a<=i&&i<=r||n<=t&&t<=o&&r<=i&&i<=a)return!0}return!1}function adjust(e){return{start:{col:Math.min(e.start.col,e.end.col),row:Math.min(e.start.row,e.end.row)},end:{col:Math.max(e.start.col,e.end.col),row:Math.max(e.start.row,e.end.row)}}}function rangeIntersected(e,t){var i=adjust(e),r=adjust(t);return Math.max(i.start.col,r.start.col)<=Math.min(i.end.col,r.end.col)&&Math.max(i.start.row,r.start.row)<=Math.min(i.end.row,r.end.row)}var browser2={IE:IE,Edge:Edge2,Chrome:Chrome,Firefox:Firefox,Safari:Safari,heightLimit:Chrome?33554431:Firefox?17895588:10737433},obj={isObject:isObject3},event={isTouchEvent:isTouchEvent},style={toBoxArray:toBoxArray},emptyFn=Function.prototype,TABLE_EVENT_TYPE=(init_esbuild_inject(),{CLICK_CELL:\\\"click_cell\\\",DBLCLICK_CELL:\\\"dblclick_cell\\\",MOUSEDOWN_CELL:\\\"mousedown_cell\\\",MOUSEUP_CELL:\\\"mouseup_cell\\\",SELECTED_CELL:\\\"selected_cell\\\",SELECTED_CLEAR:\\\"selected_clear\\\",KEYDOWN:\\\"keydown\\\",MOUSEENTER_TABLE:\\\"mouseenter_table\\\",MOUSELEAVE_TABLE:\\\"mouseleave_table\\\",MOUSEDOWN_TABLE:\\\"mousedown_table\\\",MOUSEMOVE_TABLE:\\\"mousemove_table\\\",MOUSEMOVE_CELL:\\\"mousemove_cell\\\",MOUSEENTER_CELL:\\\"mouseenter_cell\\\",MOUSELEAVE_CELL:\\\"mouseleave_cell\\\",CONTEXTMENU_CELL:\\\"contextmenu_cell\\\",RESIZE_COLUMN:\\\"resize_column\\\",RESIZE_COLUMN_END:\\\"resize_column_end\\\",RESIZE_ROW:\\\"resize_row\\\",RESIZE_ROW_END:\\\"resize_row_end\\\",CHANGE_HEADER_POSITION_START:\\\"change_header_position_start\\\",CHANGE_HEADER_POSITION:\\\"change_header_position\\\",CHANGING_HEADER_POSITION:\\\"changing_header_position\\\",CHANGE_HEADER_POSITION_FAIL:\\\"change_header_position_fail\\\",SORT_CLICK:\\\"sort_click\\\",AFTER_SORT:\\\"after_sort\\\",FREEZE_CLICK:\\\"freeze_click\\\",SCROLL:\\\"scroll\\\",CAN_SCROLL:\\\"can_scroll\\\",SCROLL_HORIZONTAL_END:\\\"scroll_horizontal_end\\\",SCROLL_VERTICAL_END:\\\"scroll_vertical_end\\\",DROPDOWN_MENU_CLICK:\\\"dropdown_menu_click\\\",MOUSEOVER_CHART_SYMBOL:\\\"mouseover_chart_symbol\\\",DRAG_SELECT_END:\\\"drag_select_end\\\",COPY_DATA:\\\"copy_data\\\",DROPDOWN_ICON_CLICK:\\\"dropdown_icon_click\\\",DROPDOWN_MENU_CLEAR:\\\"dropdown_menu_clear\\\",TREE_HIERARCHY_STATE_CHANGE:\\\"tree_hierarchy_state_change\\\",SHOW_MENU:\\\"show_menu\\\",HIDE_MENU:\\\"hide_menu\\\",ICON_CLICK:\\\"icon_click\\\",LEGEND_ITEM_CLICK:\\\"legend_item_click\\\",LEGEND_ITEM_HOVER:\\\"legend_item_hover\\\",LEGEND_ITEM_UNHOVER:\\\"legend_item_unHover\\\",LEGEND_CHANGE:\\\"legend_change\\\",MOUSEENTER_AXIS:\\\"mouseenter_axis\\\",MOUSELEAVE_AXIS:\\\"mouseleave_axis\\\",CHECKBOX_STATE_CHANGE:\\\"checkbox_state_change\\\",RADIO_STATE_CHANGE:\\\"radio_state_change\\\",SWITCH_STATE_CHANGE:\\\"switch_state_change\\\",AFTER_RENDER:\\\"after_render\\\",INITIALIZED:\\\"initialized\\\",CHANGE_CELL_VALUE:\\\"change_cell_value\\\",DRAG_FILL_HANDLE_END:\\\"drag_fill_handle_end\\\",MOUSEDOWN_FILL_HANDLE:\\\"mousedown_fill_handle\\\",DBLCLICK_FILL_HANDLE:\\\"dblclick_fill_handle\\\",EMPTY_TIP_CLICK:\\\"empty_tip_click\\\",EMPTY_TIP_DBLCLICK:\\\"empty_tip_dblclick\\\",BUTTON_CLICK:\\\"button_click\\\"}),judgeType2=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),e=>{switch(Object.prototype.toString.call(e)){case\\\"[object Object]\\\":return\\\"object\\\";case\\\"[object Function]\\\":return\\\"function\\\";case\\\"[object Array]\\\":return\\\"array\\\";case\\\"[object String]\\\":return\\\"string\\\";case\\\"[object Number]\\\":return\\\"number\\\";case\\\"[object RegExp]\\\":return\\\"regExp\\\";case\\\"[object Boolean]\\\":return\\\"boolean\\\";case\\\"[object Symbol]\\\":return\\\"symbol\\\";case\\\"[object Date]\\\":return\\\"date\\\";case\\\"[object Undefined]\\\":return\\\"undefined\\\";case\\\"[object Null]\\\":return\\\"null\\\";case\\\"[object Error]\\\":return\\\"error\\\";case\\\"[object HTMLDocument]\\\":return\\\"document\\\";case\\\"[object global]\\\":return\\\"global\\\";default:return null}}),isIt2=(e,t)=>judgeType2(e)===t,isObject4=e=>isIt2(e,\\\"object\\\");function debounce2(r,o,e){let n,a,l,s,h,d,u=0,c=!1,g=!1,p=!0;const i=!o&&0!==o&&\\\"function\\\"==typeof requestAnimationFrame;if(\\\"function\\\"!=typeof r)throw new TypeError(\\\"Expected a function\\\");function f(e){var t=n,i=a;return a=void 0,n=void 0,u=e,s=r.apply(i,t)}function m(e,t){return i?requestAnimationFrame(e):setTimeout(e,t)}function b(e){var t=e-d;return void 0===d||o<=t||t<0||c&&e-u>=l}function C(){var e,t,i=Date.now();if(b(i))return e=i,h=void 0,p&&n?f(e):(a=void 0,n=void 0,s);h=m(C,(i=(e=i)-u,t=o&&-(e-d),c?Math.min(t,l-i):t))}return o=+o||0,isObject4(e)&&(g=!!e.leading,(c=\\\"maxWait\\\"in e)&&(l=Math.max(+e.maxWait||0,o)),p=\\\"trailing\\\"in e?!!e.trailing:p),function(...e){var t=Date.now(),i=b(t);if(n=e,a=this,d=t,i){if(void 0===h)return e=d,u=e,h=m(C,o),g?f(e):s;if(c)return h=m(C,o),f(d)}return void 0===h&&(h=m(C,o)),s}}var idCount2=1,ResizeObserver=class{constructor(e,t,i){var r;this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{var e=this.getSize();let t=!1;e.width===this.lastSize.width&&e.height===this.lastSize.height&&(t=!0),this.lastSize=e,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:t}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=debounce2(this.callBack,this.resizeTime),null!=window&&window.addEventListener(\\\"resize\\\",this.onResize),\\\"ResizeObserver\\\"in window?(r=window.ResizeObserver,this.observer=new r(this.mutationResize),null!=(r=this.observer)&&r.observe(this.element)):\\\"MutationObserver\\\"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:[\\\"style\\\"]}))}disConnect(){window.removeEventListener(\\\"resize\\\",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){var e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}},EventHandler=class{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,i,...r){var o,n;return\\\"node\\\"===Env.mode?-1:(o=idCount2++,null!=e&&e.addEventListener&&(\\\"resize\\\"!==t||e===window?null!=e&&e.addEventListener(t,i,...r):(n=new ResizeObserver(e,i,this.resizeTime),this.reseizeListeners[o]=n)),this.listeners[o]={target:e,type:t,listener:i,options:r},o)}once(e,t,i,...r){if(\\\"node\\\"===Env.mode)return-1;const o=this.on(e,t,(...e)=>{this.off(o),i(...e)},...r);return o}off(e){var t;\\\"node\\\"!==Env.mode&&null!==e&&(t=null==(t=this.listeners)?void 0:t[e])&&(delete this.listeners[e],t.target.removeEventListener)&&t.target.removeEventListener(t.type,t.listener,...t.options)}fire(e,t,...i){if(\\\"node\\\"!==Env.mode)for(const o in this.listeners){var r=this.listeners[o];r.target===e&&r.type===t&&r.listener.call(r.target,...i)}}hasListener(e,t){if(\\\"node\\\"===Env.mode)return!1;let i=!1;for(const o in this.listeners){var r=this.listeners[o];r.target===e&&r.type===t&&(i=!0)}return i}clear(){if(\\\"node\\\"!==Env.mode){for(const i in this.listeners){var e=this.listeners[i];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(const r in this.reseizeListeners){var t=this.reseizeListeners[r];null!=t&&t.disConnect()}this.listeners={}}}release(){\\\"node\\\"!==Env.mode&&(this.clear(),this.listeners={})}},indexFirst=(init_esbuild_inject(),(e,t)=>{let i=0,r=e.length-1;for(;i<=r;){var o=Math.floor((i+r)/2);if(e[o]===t)return o;t<e[o]?r=o-1:i=o+1}return r<0?0:r}),NumberMap=class{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(i,r,o){var n=this._keys;if(this._sorted||(n.sort((e,t)=>e<t?-1:t<e?1:0),this._sorted=!0),r<i){var a=[];for(let e=indexFirst(n,i+o-1);0<=e;e--){var l=n[e];if(i<=l)a.push(this.get(l));else if(r<=l&&l<i)this.put(l+o,this.get(l));else if(l<r)break}for(let t=0;t<o;t++)this.put(r+t,a[o-1-t])}var s=n.length;if(i<r){var h=[];for(let e=indexFirst(n,i);e<s;e++){var d=n[e];if(i<=d&&d<i+o)h.push(this.get(d));else if(i+o<=d&&d<=r)this.put(d-o,this.get(d));else if(r<d)break}for(let t=0;t<o;t++)this.put(r+t,h[t])}}exchangeOrder(r,o,n,a,l){var s=this._keys;if(this._sorted||(s.sort((e,t)=>e<t?-1:t<e?1:0),this._sorted=!0),n<r){var h=[],d=[];for(let e=indexFirst(s,n);e<indexFirst(s,r)+o;e++){var u=s[e];(r<=u&&u<r+o?d:h).push(this.get(u))}for(let t=0;t<o;t++)this.put(l+t,d[t]);for(let i=0;i<h.length;i++)this.put(l+o+i,h[i])}else{var c=[],g=[];for(let e=indexFirst(s,r);e<indexFirst(s,n)+a;e++){var p=s[e];(r<=p&&p<r+o?g:c).push(this.get(p))}for(let t=0;t<o;t++)this.put(l+t,g[t]);for(let i=0;i<c.length;i++)this.put(r+i,c[i])}}del(e){delete this._vals[e];var t=this._keys.indexOf(e);-1!==t&&this._keys.splice(t,1)}put(e,t){e in this._vals||(this._keys.push(e),this._sorted=!1),this._vals[e]=t}get(e){return this._vals[e]}has(e){return isValid_default(this._vals[e])}contain(e){return 0<=Object.values(this._vals).indexOf(e)}each(e,t,i){var r=this._keys,o=r.length;this._sorted||(r.sort((e,t)=>e<t?-1:t<e?1:0),this._sorted=!0);for(let a=indexFirst(r,e);a<o;a++){var n=r[a];if(e<=n&&n<=t){if(!1===i(this.get(n),n))break}else if(t<n)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){var e=this.getLastIndex();this.del(e)}delAndReorder(e){var t;this.has(e)&&(t=this.getLastIndex(),this.adjustOrder(e+1,e,t-e),this.delLast())}addAndReorder(e,t){var i;isValid_default(t)&&(i=this.getLastIndex(),this.adjustOrder(e,e+1,i-e),this.put(e,t))}},Rect2=(init_esbuild_inject(),class o5b{constructor(e,t,i,r){this.bounds=new Bounds,this.bounds.set(e,t,e+i,t+r)}static bounds(e,t,i,r){return new o5b(e,t,Math.round(i-e),Math.round(r-t))}get left(){return this.bounds.x1}set left(e){this.bounds.x1=e}get top(){return this.bounds.y1}set top(e){this.bounds.y1=e}get right(){return this.bounds.x2}set right(e){this.bounds.x2=e}get bottom(){return this.bounds.y2}set bottom(e){this.bounds.y2=e}get width(){return this.bounds.width()}set width(e){this.bounds.x2=this.bounds.x1+e}get height(){return this.bounds.height()}set height(e){this.bounds.y2=this.bounds.y1+e}offsetLeft(e){this.bounds.translate(e,0)}offsetTop(e){this.bounds.translate(0,e)}copy(){return new o5b(this.left,this.top,this.width,this.height)}contains(e){return this.bounds.encloses(e.bounds)}inPoint(e,t){return this.bounds.contains(e,t)}}),themes_exports={};function getBackgroundColor(e){var{row:t,table:i}=e;return 1&t-i.frozenRowCount?\\\"#282a2e\\\":\\\"#2d3137\\\"}__export(themes_exports,{ARCO:()=>ARCO,BRIGHT:()=>BRIGHT,DARK:()=>DARK,DEFAULT:()=>DEFAULT,SIMPLIFY:()=>SIMPLIFY,TableTheme:()=>TableTheme,\\\"default\\\":()=>themes_default,get:()=>get,of:()=>of2,theme:()=>theme2}),init_esbuild_inject(),init_esbuild_inject();var DARK_default={name:\\\"DARK\\\",underlayBackgroundColor:\\\"transparent\\\",defaultStyle:{color:\\\"#D3D5DA\\\",bgColor:\\\"#373b45\\\",fontSize:12,fontFamily:\\\"PingFang SC\\\",fontWeight:500,lineHeight:12,borderColor:\\\"#444A54\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#2F4774\\\"}},headerStyle:{color:\\\"#D3D5DA\\\",bgColor:\\\"#373b45\\\",fontSize:12,fontFamily:\\\"PingFang SC\\\",fontWeight:500,lineHeight:12,borderColor:\\\"#444A54\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#2F4774\\\"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:\\\"#e5e7ea\\\",bgColor:getBackgroundColor,fontSize:12,fontFamily:\\\"PingFang SC\\\",fontWeight:500,lineHeight:12,borderColor:\\\"#444A54\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#29364D\\\"}},frameStyle:{borderColor:\\\"#d1d5da\\\",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:\\\"rgba(00, 24, 47, 0.06)\\\"},columnResize:{lineWidth:1,lineColor:\\\"#416EFF\\\",bgColor:\\\"#D9E2FF\\\",width:3},frozenColumnLine:{shadow:{width:4,startColor:\\\"rgba(00, 24, 47, 0.05)\\\",endColor:\\\"rgba(00, 24, 47, 0)\\\"}},selectionStyle:{cellBgColor:\\\"rgba(255, 255, 255, 0.1)\\\",cellBorderColor:\\\"#4284FF\\\",cellBorderLineWidth:2},tooltipStyle:{bgColor:\\\"#FFF\\\",color:\\\"#000\\\",fontSize:12,fontFamily:\\\"Arial,sans-serif\\\"},functionalIconsStyle:{sort_color:\\\"#FFFFFF\\\",sort_color_opacity:\\\"0.75\\\",sort_color_2:\\\"#416EFF\\\",sort_color_opacity_2:\\\"1\\\",frozen_color:\\\"#FFFFFF\\\",frozen_color_opacity:\\\"0.75\\\",collapse_color:\\\"#FFF\\\",collapse_color_opacity:\\\"0.75\\\",expand_color:\\\"#FFF\\\",expand_color_opacity:\\\"0.75\\\",dragReorder_color:\\\"#FFF\\\",dragReorder_color_opacity:\\\"0.75\\\"}};function getBackgroundColor2(e){var{row:t,table:i}=e;return 1&t-i.frozenRowCount?\\\"#FFF\\\":\\\"#F4F8FF\\\"}init_esbuild_inject();var BRIGHT_default={name:\\\"BRIGHT\\\",underlayBackgroundColor:\\\"#FFF\\\",defaultStyle:{color:\\\"#FFF\\\",bgColor:\\\"#5389FF\\\",borderColor:\\\"#5286FA\\\",hover:{cellBgColor:\\\"#2E67E3\\\"}},headerStyle:{color:\\\"#FFF\\\",bgColor:\\\"#5389FF\\\",borderColor:\\\"#A1C1FF\\\",hover:{cellBgColor:\\\"#2E67E3\\\"}},bodyStyle:{color:\\\"#000\\\",bgColor:getBackgroundColor2,borderColor:\\\"#E0EAFE\\\",hover:{cellBgColor:\\\"#E9EFFD\\\"}},frameStyle:{borderColor:\\\"#E1E4E8\\\",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:\\\"black\\\"},columnResize:{lineWidth:1,lineColor:\\\"#416EFF\\\",bgColor:\\\"#D9E2FF\\\",width:3},frozenColumnLine:{shadow:{width:3,startColor:\\\"#CBDCFE\\\",endColor:\\\"#CBDCFE\\\"}},selectionStyle:{cellBgColor:\\\"rgba(0, 0, 255,0.1)\\\"},tooltipStyle:{bgColor:\\\"#FFF\\\",color:\\\"#000\\\",fontSize:12,fontFamily:\\\"Arial,sans-serif\\\"}};function getBackgroundColor3(e){var{row:t,table:i}=e;return 1&t-i.frozenRowCount?\\\"#fbfbfc\\\":\\\"#FFF\\\"}init_esbuild_inject();var ARCO_default={name:\\\"ARCO\\\",underlayBackgroundColor:\\\"#FFF\\\",defaultStyle:{color:\\\"#1B1F23\\\",bgColor:\\\"#EEF1F5\\\",fontSize:14,fontFamily:\\\"Arial,sans-serif\\\",fontWeight:600,lineHeight:14,borderColor:\\\"#e1e4e8\\\",padding:[8,12,8,12]},headerStyle:{color:\\\"#1B1F23\\\",bgColor:\\\"#EEF1F5\\\",fontSize:14,fontFamily:\\\"Arial,sans-serif\\\",fontWeight:600,lineHeight:14,borderColor:\\\"#e1e4e8\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#c8daf6\\\"}},rowHeaderStyle:{color:\\\"#1B1F23\\\",bgColor:\\\"#EEF1F5\\\",fontSize:12,fontFamily:\\\"PingFang SC\\\",fontWeight:500,lineHeight:12,borderColor:\\\"#e1e4e8\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#c8daf6\\\"}},cornerHeaderStyle:{color:\\\"#1B1F23\\\",bgColor:\\\"#EEF1F5\\\",fontSize:12,fontFamily:\\\"PingFang SC\\\",fontWeight:500,lineHeight:12,borderColor:\\\"#e1e4e8\\\",padding:[8,12,8,12],hover:{cellBgColor:\\\"#c8daf6\\\"}},bodyStyle:{padding:[8,12,8,12],color:\\\"#141414\\\",fontSize:14,fontFamily:\\\"Arial,sans-serif\\\",fontWeight:400,textAlign:\\\"left\\\",bgColor:getBackgroundColor3,borderColor:\\\"#e1e4e8\\\",lineHeight:14,hover:{cellBgColor:\\\"#F7F8FA\\\",inlineRowBgColor:\\\"#F3F8FF\\\",inlineColumnBgColor:\\\"#F3F8FF\\\"}},frameStyle:{borderColor:\\\"#d1d5da\\\",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:\\\"rgba(00, 24, 47, 0.06)\\\"},columnResize:{lineWidth:1,lineColor:\\\"#416EFF\\\",bgColor:\\\"#D9E2FF\\\",width:3},frozenColumnLine:{shadow:{width:4,startColor:\\\"rgba(00, 24, 47, 0.05)\\\",endColor:\\\"rgba(00, 24, 47, 0)\\\"}},selectionStyle:{cellBgColor:\\\"rgba(0, 0, 255,0.1)\\\",cellBorderLineWidth:2,cellBorderColor:\\\"#3073f2\\\"},tooltipStyle:{bgColor:\\\"#FFF\\\",color:\\\"#000\\\",fontSize:12,fontFamily:\\\"Arial,sans-serif\\\"}};function getBackgroundColor4(e){var{row:t,table:i}=e;return 1&t-i.frozenRowCount?\\\"#FDFDFD\\\":\\\"#FAF9FB\\\"}init_esbuild_inject();var DEFAULT_default={name:\\\"DEFAULT\\\",underlayBackgroundColor:\\\"#FFF\\\",defaultStyle:{borderColor:\\\"#E1E4E8\\\",color:\\\"#000\\\",bgColor:\\\"#ECF1F5\\\"},headerStyle:{fontSize:16,fontWeight:\\\"bold\\\",bgColor:\\\"#ECF1F5\\\",hover:{cellBgColor:\\\"#CCE0FF\\\",inlineRowBgColor:\\\"#F3F8FF\\\",inlineColumnBgColor:\\\"#F3F8FF\\\"}},rowHeaderStyle:{fontSize:16,fontWeight:\\\"bold\\\",bgColor:\\\"#ECF1F5\\\",hover:{cellBgColor:\\\"#CCE0FF\\\",inlineRowBgColor:\\\"#F3F8FF\\\",inlineColumnBgColor:\\\"#F3F8FF\\\"}},cornerHeaderStyle:{fontSize:16,fontWeight:\\\"bold\\\"},bodyStyle:{fontSize:14,bgColor:getBackgroundColor4,hover:{cellBgColor:\\\"#CCE0FF\\\",inlineRowBgColor:\\\"#F3F8FF\\\",inlineColumnBgColor:\\\"#F3F8FF\\\"}},frameStyle:{borderColor:\\\"#E1E4E8\\\",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:\\\"black\\\"},columnResize:{lineWidth:1,lineColor:\\\"#416EFF\\\",bgColor:\\\"#D9E2FF\\\",width:3},frozenColumnLine:{shadow:{width:3,startColor:\\\"rgba(225, 228, 232, 0.6)\\\",endColor:\\\"rgba(225, 228, 232, 0.6)\\\"}},selectionStyle:{cellBgColor:\\\"rgba(0, 0, 255,0.1)\\\",cellBorderLineWidth:2,cellBorderColor:\\\"#0000ff\\\"},tooltipStyle:{bgColor:\\\"#FFF\\\",color:\\\"#000\\\",fontSize:12,fontFamily:\\\"Arial,sans-serif\\\"}};function getFrozenRowsBorderColor(e){var{row:t,table:{frozenRowCount:i}}=e;return i-1===t?[\\\"#f2f2f2\\\",\\\"#f2f2f2\\\",\\\"#ccc7c7\\\",\\\"#f2f2f2\\\"]:[\\\"#f2f2f2\\\"]}function getBorderColor(e){var{col:t,table:i}=e,{colCount:i,frozenColCount:r}=i;return r-1===t||i-1===t?[\\\"#ccc7c7\\\",\\\"#f2f2f2\\\",\\\"#ccc7c7\\\",null]:[\\\"#ccc7c7\\\",null,\\\"#ccc7c7\\\",null]}init_esbuild_inject();var SIMPLIFY_default={name:\\\"SIMPLIFY\\\",underlayBackgroundColor:\\\"#FFF\\\",defaultStyle:{borderColor:getBorderColor,hover:{cellBorderColor:\\\"#0000FF\\\",cellBgColor:\\\"#D0E0E3\\\"},bgColor:\\\"#FFF\\\"},headerStyle:{color:\\\"rgba(0, 0, 0, 0.87)\\\",borderColor:getFrozenRowsBorderColor},bodyStyle:{color:\\\"rgba(0, 0, 0, 0.87)\\\"},frameStyle:{borderColor:\\\"#f2f2f2\\\",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:\\\"#416EFF\\\",bgColor:\\\"#D9E2FF\\\"},selectionStyle:{cellBorderColor:\\\"#FD5\\\",cellBgColor:\\\"rgba(111, 168, 220, 0.1)\\\"},tooltipStyle:{bgColor:\\\"#FFF\\\",color:\\\"#000\\\",fontSize:12,fontFamily:\\\"Arial,sans-serif\\\"}},themes=(init_esbuild_inject(),{}),DEFAULTFONTSIZE=(init_esbuild_inject(),init_esbuild_inject(),16),DEFAULTFONTFAMILY=\\\"Arial,sans-serif\\\",DEFAULTBGCOLOR=\\\"#FFF\\\",DEFAULTBORDERCOLOR=\\\"#000\\\",DEFAULTBORDERLINEWIDTH=1,DEFAULTBORDERLINEDASH=[],DEFAULTFONTCOLOR=\\\"#000\\\",regUrl=/^(https?|ftp|file):\\\\/\\\\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,IndicatorDimensionKeyPlaceholder=\\\"$$indicator$$\\\",DrillDown='<svg class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\"><rect x=\\\"0\\\" y=\\\"0\\\" width=\\\"1024\\\" height=\\\"1024\\\" rx=\\\"20%\\\" ry=\\\"20%\\\" fill=\\\"#ffffff\\\" /><path  d=\\\"M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z\\\"></path></svg>',DrillUp='<svg class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\"><rect x=\\\"0\\\" y=\\\"0\\\" width=\\\"1024\\\" height=\\\"1024\\\" rx=\\\"20%\\\" ry=\\\"20%\\\" fill=\\\"#ffffff\\\" /><path d=\\\"M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z\\\"></path></svg>',DefaultSparklineSpec={type:\\\"line\\\"};function getAxisStyle(e){return{defaultAxisStyle:getSingleAxisStyle(e.defaultAxisStyle),leftAxisStyle:getSingleAxisStyle(e.leftAxisStyle),rightAxisStyle:getSingleAxisStyle(e.rightAxisStyle),topAxisStyle:getSingleAxisStyle(e.topAxisStyle),bottomAxisStyle:getSingleAxisStyle(e.bottomAxisStyle)}}function getSingleAxisStyle(e){return e||{}}init_esbuild_inject();var defalutPoptipStyle={visible:!0,position:\\\"auto\\\",padding:8,titleStyle:{fontSize:12,fontWeight:\\\"bold\\\",fill:\\\"#4E5969\\\"},contentStyle:{fontSize:12,fill:\\\"#4E5969\\\"},panel:{visible:!0,fill:\\\"#fff\\\",stroke:\\\"#ffffff\\\",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:\\\"rgba(0, 0, 0, 0.1)\\\",size:0,space:12}};function getProp(e,t,i,r){var o;return null!=(o=null!=(o=null!=(o=getChainSafe(e,...i))?o:getChainSafe(t,...i))?o:r&&getChainSafe(e,...r))?o:r&&getChainSafe(t,...r)}var TableTheme=class kgb{constructor(e,t){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name=\\\"\\\",this.internalTheme={obj:e,superTheme:t},this.name=getProp(e,t,[\\\"name\\\"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){var{obj:e,superTheme:t}=this.internalTheme;return getProp(e,t,[\\\"font\\\"],[\\\"bodyStyle\\\",\\\"font\\\"])}get underlayBackgroundColor(){var{obj:e,superTheme:t}=this.internalTheme;return getProp(e,t,[\\\"underlayBackgroundColor\\\"])}get cellInnerBorder(){var{obj:e,superTheme:t}=this.internalTheme;return null==(e=getProp(e,t,[\\\"cellInnerBorder\\\"]))||e}get cellBorderClipDirection(){var{obj:e,superTheme:t}=this.internalTheme;return null!=(e=getProp(e,t,[\\\"cellBorderClipDirection\\\"]))?e:\\\"top-left\\\"}get _contentOffset(){var{obj:e,superTheme:t}=this.internalTheme;return null!=(e=getProp(e,t,[\\\"_contentOffset\\\"]))?e:0}get defaultStyle(){const r=this;if(!this._defaultStyle){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.defaultStyle,e.defaultStyle);this._defaultStyle={get fontSize(){var e;return null!=(e=i.fontSize)?e:DEFAULTFONTSIZE},get fontFamily(){var e;return null!=(e=i.fontFamily)?e:DEFAULTFONTFAMILY},get fontWeight(){return i.fontWeight},get fontVariant(){return i.fontVariant},get fontStyle(){return i.fontStyle},get bgColor(){var e;return null!=(e=i.bgColor)?e:DEFAULTBGCOLOR},get color(){var e;return null!=(e=i.color)?e:DEFAULTFONTCOLOR},get borderColor(){var e;return null!=(e=i.borderColor)?e:DEFAULTBORDERCOLOR},get borderLineWidth(){var e;return null!=(e=i.borderLineWidth)?e:DEFAULTBORDERLINEWIDTH},get borderLineDash(){var e;return null!=(e=i.borderLineDash)?e:DEFAULTBORDERLINEDASH},get hover(){if(i.hover)return{get cellBgColor(){var e;return null!=(e=null==(e=i.hover)?void 0:e.cellBgColor)?e:void 0},get inlineColumnBgColor(){var e;return null!=(e=null!=(e=null==(e=i.hover)?void 0:e.inlineColumnBgColor)?e:null!=(e=i.hover)&&e.cellBgColor&&\\\"string\\\"==typeof(null==(e=i.hover)?void 0:e.cellBgColor)?changeColor(null==(e=i.hover)?void 0:e.cellBgColor,.1,!1):void 0)?e:void 0},get inlineRowBgColor(){var e;return null!=(e=null!=(e=null==(e=i.hover)?void 0:e.inlineRowBgColor)?e:null!=(e=i.hover)&&e.cellBgColor&&\\\"string\\\"==typeof(null==(e=i.hover)?void 0:e.cellBgColor)?changeColor(null==(e=i.hover)?void 0:e.cellBgColor,.1,!1):void 0)?e:void 0}}},get select(){if(i.select)return{get inlineColumnBgColor(){var e;return null!=(e=null!=(e=null!=(e=null==(e=i.select)?void 0:e.inlineColumnBgColor)?e:null==(e=r.selectionStyle)?void 0:e.inlineColumnBgColor)?e:null!=(e=r.selectionStyle)&&e.cellBgColor&&\\\"string\\\"==typeof r.selectionStyle.cellBgColor?changeColor(r.selectionStyle.cellBgColor,.1,!1):void 0)?e:void 0},get inlineRowBgColor(){var e;return null!=(e=null!=(e=null!=(e=null==(e=i.select)?void 0:e.inlineRowBgColor)?e:r.selectionStyle.inlineRowBgColor)?e:null!=(e=r.selectionStyle)&&e.cellBgColor&&\\\"string\\\"==typeof r.selectionStyle.cellBgColor?changeColor(r.selectionStyle.cellBgColor,.1,!1):void 0)?e:void 0}}},get padding(){var e;return null!=(e=i.padding)?e:[10,16,10,16]},get textAlign(){var e;return null!=(e=i.textAlign)?e:\\\"left\\\"},get textBaseline(){var e;return null!=(e=i.textBaseline)?e:\\\"middle\\\"},get textOverflow(){var e;return null!=(e=i.textOverflow)?e:\\\"ellipsis\\\"},get lineHeight(){return i.lineHeight},get autoWrapText(){var e;return null!=(e=i.autoWrapText)&&e},get lineClamp(){var e;return null!=(e=i.lineClamp)?e:\\\"auto\\\"},get linkColor(){var e;return null!=(e=i.linkColor)?e:\\\"#3772ff\\\"},get cursor(){var e;return null!=(e=i.cursor)?e:\\\"auto\\\"},get marked(){var e;return null!=(e=i.marked)&&e},get underline(){var e;return null!=(e=i.underline)&&e},get underlineColor(){return i.underlineColor},get underlineDash(){return i.underlineDash},get underlineOffset(){return i.underlineOffset},get lineThrough(){var e;return null!=(e=i.lineThrough)&&e},get lineThroughColor(){return i.lineThroughColor},get lineThroughDash(){return i.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){var e,t;return this._cornerHeader||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},this.defaultStyle,t.cornerHeaderStyle,e.cornerHeaderStyle),this._cornerHeader=this.getStyle(t)),this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){var{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerRightTopCellStyle&&!e.cornerRightTopCellStyle)return this._cornerRightTopCell;t=ingoreNoneValueMerge({},this.defaultStyle,t.cornerRightTopCellStyle,e.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(t)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){var{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerLeftBottomCellStyle&&!e.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;t=ingoreNoneValueMerge({},this.defaultStyle,t.cornerLeftBottomCellStyle,e.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(t)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){var{obj:e,superTheme:t}=this.internalTheme;if(!t.cornerRightBottomCellStyle&&!e.cornerRightBottomCellStyle)return this._cornerRightBottomCell;t=ingoreNoneValueMerge({},this.defaultStyle,t.cornerRightBottomCellStyle,e.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(t)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){var{obj:e,superTheme:t}=this.internalTheme;if(!t.rightFrozenStyle&&!e.rightFrozenStyle)return this._rightFrozen;t=ingoreNoneValueMerge({},this.defaultStyle,this.rowHeaderStyle,t.rightFrozenStyle,e.rightFrozenStyle);this._rightFrozen=this.getStyle(t)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){var{obj:e,superTheme:t}=this.internalTheme;if(!t.bottomFrozenStyle&&!e.bottomFrozenStyle)return this._bottomFrozen;t=ingoreNoneValueMerge({},this.defaultStyle,this.headerStyle,t.bottomFrozenStyle,e.bottomFrozenStyle);this._bottomFrozen=this.getStyle(t)}return this._bottomFrozen}get rowHeaderStyle(){var e,t;return this._rowHeader||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},this.defaultStyle,t.rowHeaderStyle,null!=(t=e.rowHeaderStyle)?t:this.isPivot?null:e.headerStyle),this._rowHeader=this.getStyle(t)),this._rowHeader}get headerStyle(){var e,t;return this._header||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},this.defaultStyle,t.headerStyle,e.headerStyle),this._header=this.getStyle(t)),this._header}get bodyStyle(){var e,t;return this._body||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},this.defaultStyle,t.bodyStyle,e.bodyStyle),this._body=this.getStyle(t)),this._body}get groupTitleStyle(){if(!this._groupTitle){var{obj:e,superTheme:t}=this.internalTheme;if(!t.groupTitleStyle&&!e.groupTitleStyle)return this._groupTitle;t=ingoreNoneValueMerge({},this.defaultStyle,t.groupTitleStyle,e.groupTitleStyle);this._groupTitle=this.getStyle(t)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.frameStyle,e.frameStyle);this._frameStyle={get borderColor(){return i.borderColor},get borderLineWidth(){return i.borderLineWidth},get borderLineDash(){return i.borderLineDash},get innerBorder(){return i.innerBorder},get shadowBlur(){return i.shadowBlur},get shadowColor(){return i.shadowColor},get shadowOffsetX(){return i.shadowOffsetX},get shadowOffsetY(){return i.shadowOffsetY},get cornerRadius(){return i.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.scrollStyle,e.scrollStyle);this._scroll={get scrollSliderColor(){var e;return null!=(e=i.scrollSliderColor)?e:\\\"#C0C0C0\\\"},get scrollSliderCornerRadius(){return i.scrollSliderCornerRadius},get scrollRailColor(){return i.scrollRailColor},get visible(){var e;return null!=(e=i.visible)?e:\\\"scrolling\\\"},get verticalVisible(){return i.verticalVisible},get horizontalVisible(){return i.horizontalVisible},get width(){var e;return null!=(e=i.width)?e:7},get hoverOn(){var e;return null==(e=i.hoverOn)||e},get barToSide(){var e;return null!=(e=i.barToSide)&&e},get horizontalPadding(){var e;return null!=(e=i.horizontalPadding)?e:0},get verticalPadding(){var e;return null!=(e=i.verticalPadding)?e:0}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.tooltipStyle,e.tooltipStyle);this._tooltip={get fontFamily(){var e;return null!=(e=i.fontFamily)?e:DEFAULTFONTFAMILY},get fontSize(){var e;return null!=(e=i.fontSize)?e:DEFAULTFONTSIZE},get bgColor(){var e;return null!=(e=i.bgColor)?e:\\\"#000\\\"},get padding(){var e;return null!=(e=i.padding)?e:[6,8]},get color(){var e;return null!=(e=i.color)?e:\\\"#FFF\\\"},get maxWidth(){return i.maxWidth},get maxHeight(){return i.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.columnResize,e.columnResize);this._columnResize={get lineColor(){var e;return null!=(e=i.lineColor)?e:\\\"#416EFF\\\"},get bgColor(){var e;return null!=(e=i.bgColor)?e:\\\"#D9E2FF\\\"},get lineWidth(){var e;return null!=(e=i.lineWidth)?e:1},get width(){var e;return null!=(e=i.width)?e:i.lineWidth+2},get resizeHotSpotSize(){var e;return null!=(e=i.resizeHotSpotSize)?e:16},get labelColor(){var e;return null!=(e=i.labelColor)?e:\\\"#FFF\\\"},get labelFontSize(){var e;return null!=(e=i.labelFontSize)?e:10},get labelFontFamily(){var e;return null!=(e=i.labelFontFamily)?e:\\\"sans-serif\\\"},get labelBackgroundFill(){var e;return null!=(e=i.labelBackgroundFill)?e:\\\"#3073F2\\\"},get labelBackgroundCornerRadius(){var e;return null!=(e=i.labelBackgroundCornerRadius)?e:5},get labelVisible(){var e;return null==(e=i.labelVisible)||e},get visibleOnHover(){var e;return null!=(e=i.visibleOnHover)&&e}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.dragHeaderSplitLine,e.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var e;return null!=(e=i.lineColor)?e:\\\"blue\\\"},get lineWidth(){var e;return null!=(e=i.lineWidth)?e:2},get shadowBlockColor(){var e;return null!=(e=i.shadowBlockColor)?e:\\\"rgba(204,204,204,0.3)\\\"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.frozenColumnLine,e.frozenColumnLine);this._frozenColumnLine={get shadow(){if(i.shadow)return{get width(){var e;return null!=(e=null==(e=i.shadow)?void 0:e.width)?e:24},get startColor(){var e;return null!=(e=null==(e=i.shadow)?void 0:e.startColor)?e:\\\"rgba(00, 24, 47, 0.06)\\\"},get endColor(){var e;return null!=(e=null==(e=i.shadow)?void 0:e.endColor)?e:\\\"rgba(00, 24, 47, 0)\\\"}}},get border(){if(i.border)return{get lineColor(){var e;return null!=(e=null==(e=i.border)?void 0:e.lineColor)?e:\\\"rgba(00, 24, 47, 0.06)\\\"},get bgColor(){var e;return null!=(e=null!=(e=null==(e=i.border)?void 0:e.bgColor)?e:null==(e=i.border)?void 0:e.lineColor)?e:\\\"rgba(00, 24, 47, 0.06)\\\"},get lineWidth(){var e;return null!=(e=null==(e=i.border)?void 0:e.lineWidth)?e:4},get width(){var e;return null!=(e=null!=(e=null==(e=i.border)?void 0:e.width)?e:null==(e=i.border)?void 0:e.lineWidth)?e:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){let{obj:e,superTheme:t}=this.internalTheme,i=ingoreNoneValueMerge({},t.selectionStyle,e.selectionStyle);this._selectionStyle={get cellBgColor(){var e;return null!=(e=null==i?void 0:i.cellBgColor)?e:\\\"rgba(0, 0, 255,0.1)\\\"},get cellBorderColor(){var e;return null!=(e=null==i?void 0:i.cellBorderColor)?e:\\\"#3073f2\\\"},get cellBorderLineWidth(){var e;return null!=(e=null==i?void 0:i.cellBorderLineWidth)?e:2},get inlineColumnBgColor(){return null==i?void 0:i.inlineColumnBgColor},get inlineRowBgColor(){return null==i?void 0:i.inlineRowBgColor},get selectionFillMode(){var e;return null!=(e=null==i?void 0:i.selectionFillMode)?e:\\\"overlay\\\"}}}return this._selectionStyle}get axisStyle(){var e,t;return this._axisStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.axisStyle,e.axisStyle),this._axisStyle=getAxisStyle(t)),this._axisStyle}get checkboxStyle(){var e,t;return this._checkboxStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.checkboxStyle,e.checkboxStyle),this._checkboxStyle=t),this._checkboxStyle}get radioStyle(){var e,t;return this._radioStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.radioStyle,e.radioStyle),this._radioStyle=t),this._radioStyle}get switchStyle(){var e,t;return this._switchStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.switchStyle,e.switchStyle),this._switchStyle=t),this._switchStyle}get buttonStyle(){var e,t;return this._buttonStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.buttonStyle,e.buttonStyle),this._buttonStyle=t),this._buttonStyle}get textPopTipStyle(){var e,t;return this._textPopTipStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},defalutPoptipStyle,t.textPopTipStyle,e.textPopTipStyle),this._textPopTipStyle=t),this._textPopTipStyle}get functionalIconsStyle(){var e,t;return this._internalIconsStyle||(({obj:e,superTheme:t}=this.internalTheme),t=ingoreNoneValueMerge({},t.functionalIconsStyle,e.functionalIconsStyle),this._internalIconsStyle=t),this._internalIconsStyle}hasProperty(e){var{obj:t,superTheme:i}=this.internalTheme;return hasThemeProperty(t,e)||hasThemeProperty(i,e)}\\\"extends\\\"(e){return new kgb(ingoreNoneValueMerge({},e),ingoreNoneValueMerge(this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){const i=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var e;return null!=(e=null==(e=t.hover)?void 0:e.cellBgColor)?e:void 0},get inlineColumnBgColor(){var e;return null!=(e=null!=(e=null==(e=t.hover)?void 0:e.inlineColumnBgColor)?e:null!=(e=t.hover)&&e.cellBgColor&&\\\"string\\\"==typeof(null==(e=t.hover)?void 0:e.cellBgColor)?changeColor(null==(e=t.hover)?void 0:e.cellBgColor,.1,!1):void 0)?e:void 0},get inlineRowBgColor(){var e;return null!=(e=null!=(e=null==(e=t.hover)?void 0:e.inlineRowBgColor)?e:null!=(e=t.hover)&&e.cellBgColor&&\\\"string\\\"==typeof(null==(e=t.hover)?void 0:e.cellBgColor)?changeColor(null==(e=t.hover)?void 0:e.cellBgColor,.1,!1):void 0)?e:void 0}}},get select(){return{get inlineColumnBgColor(){var e;return null!=(e=null!=(e=null!=(e=null==(e=t.select)?void 0:e.inlineColumnBgColor)?e:null==(e=i.selectionStyle)?void 0:e.inlineColumnBgColor)?e:null!=(e=i.selectionStyle)&&e.cellBgColor&&\\\"string\\\"==typeof i.selectionStyle.cellBgColor?changeColor(i.selectionStyle.cellBgColor,.1,!1):void 0)?e:void 0},get inlineRowBgColor(){var e;return null!=(e=null!=(e=null!=(e=null==(e=t.select)?void 0:e.inlineRowBgColor)?e:i.selectionStyle.inlineRowBgColor)?e:null!=(e=i.selectionStyle)&&e.cellBgColor&&\\\"string\\\"==typeof i.selectionStyle.cellBgColor?changeColor(i.selectionStyle.cellBgColor,.1,!1):void 0)?e:void 0},get cellBgColor(){var e;return\\\"replace\\\"===i.selectionStyle.selectionFillMode&&null!=(e=null!=(e=null==(e=t.select)?void 0:e.cellBgColor)?e:i.selectionStyle.cellBgColor)?e:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var e;return null!=(e=null==(e=t.frameStyle)?void 0:e.borderColor)?e:void 0},get borderLineWidth(){var e;return null!=(e=null==(e=t.frameStyle)?void 0:e.borderLineWidth)?e:void 0},get borderLineDash(){var e;return null!=(e=null==(e=t.frameStyle)?void 0:e.borderLineDash)?e:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get marked(){return t.marked},get underline(){var e;return null!=(e=t.underline)&&e},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var e;return null!=(e=t.lineThrough)&&e},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}};function hasThemeProperty(e,t){if(e instanceof TableTheme)return e.hasProperty(t);let i=e;if(!i)return!1;for(let r=0;r<t.length;r++)if(!(i=i[t[r]]))return!1;return!!i}var DARK=new TableTheme(DARK_default,DARK_default),BRIGHT=new TableTheme(BRIGHT_default,BRIGHT_default),ARCO=new TableTheme(ARCO_default,ARCO_default),DEFAULT=new TableTheme(DEFAULT_default,DEFAULT_default),SIMPLIFY=new TableTheme(SIMPLIFY_default,SIMPLIFY_default),builtin={DEFAULT:DEFAULT,SIMPLIFY:SIMPLIFY,ARCO:ARCO,DARK:DARK,BRIGHT:BRIGHT},theme2={TableTheme:TableTheme};function of2(e){var t;return e?\\\"string\\\"==typeof e?(t=getIgnoreCase(get(),e))?t instanceof TableTheme?t:new TableTheme(t,t):null:e instanceof TableTheme?e:new TableTheme(e,e):null}function get(){return extend(builtin,themes)}var themes_default={DARK:DARK,BRIGHT:BRIGHT,ARCO:ARCO,DEFAULT:DEFAULT,SIMPLIFY:SIMPLIFY,theme:theme2,of:of2,get:get};function getCellMergeInfo(e,t,i){if(e.internalProps.customMergeCell){var r=e.getCustomMerge(t,i);if(r)return r.range}return!(!(e.internalProps.enableTreeNodeMerge||e.isHeader(t,i)||null!=(r=e.getBodyColumnDefine(t,i))&&r.mergeCell)||(r=e.getCellRange(t,i)).start.col===r.end.col&&r.start.row===r.end.row)&&r}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var Factory2=class Iib{static registerComponent(e,t){Iib._components[e]=t}static getComponent(e){return Iib._components[e]}static registerFunction(e,t){Iib._functions[e]=t}static getFunction(e){return Iib._functions[e]}static registerCellType(e,t){Iib._cellTypes[e]=t}static getCellType(e){return Iib._cellTypes[e]}};function createArray(e,t){var i=new Array(t);for(let r=0;r<t;r++)i[r]=e(r);return i}function sort(e,t,i,r,o,n){var a=createArray(e,i);a.sort((e,t)=>r(n(e),n(t),o));for(let l=0;l<i;l++)t(l,a[l])}function isFieldAssessor(e){if(obj.isObject(e)){var t=e;if(isValid_default(t.get)&&isValid_default(t.set))return!0}return!1}Factory2._components={},Factory2._functions={},Factory2._cellTypes={},init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var EVENT_TYPE2={SOURCE_LENGTH_UPDATE:\\\"source_length_update\\\",CHANGE_ORDER:\\\"change_order\\\"};function getValue(e,t){var i,r=getOrApply(e);return isPromise(r)?(i=r.then(e=>(t(e),e)),t(i),i):r}function getField(e,t,i,r,o,n){var a,l;if(null!=e)return isPromise(e)?e.then(e=>getField(e,t,i,r,o,n)):(a=isFieldAssessor(t)?t.get:t,isObject_default(e)&&a in e?getValue(e[a],n):\\\"function\\\"==typeof a?getValue(a(e,i,r,o),n):Array.isArray(a)?getValue(getValueByPath(e,[...a]),n):(l=(\\\"\\\"+a).split(\\\".\\\")).length<=1?getValue(e[a],n):getValue(applyChainSafe(e,(e,t)=>getField(e,t,i,r,o,emptyFn),...l),n))}function _getIndex(e,t){var i;return e&&(i=e[t],isValid_default(i))?i:t}var DataSource=class extends EventTarget3{static get EVENT_TYPE(){return EVENT_TYPE2}constructor(e,t,i,r,o,n){var a;super(),this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType=\\\"grid\\\",this.fieldAggregators=[],this.registerAggregators(),this.dataSourceObj=e,this.dataConfig=t,this._get=null==e?void 0:e.get,this.columns=r,this._source=null!=e&&e.records?this.processRecords(null==e?void 0:e.records):e,this._sourceLength=(null==(a=this._source)?void 0:a.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=i,this.pagination=i||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},1<=n&&(this.hierarchyExpandLevel=n),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),\\\"tree\\\"===o&&this.initTreeHierarchyState(),this.rowHierarchyType=o,this.updatePagerData()}initTreeHierarchyState(){this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let e=this._sourceLength;for(let o=0;o<e;o++){var t=this.currentIndexedData[o],i=this.getOriginalRecord(t),r=null!=(r=i.filteredChildren)?r:i.children;0<(null==r?void 0:r.length)?(1<this.hierarchyExpandLevel?i.hierarchyState||(i.hierarchyState=HierarchyState.expand):i.hierarchyState||(i.hierarchyState=HierarchyState.collapse),this.hasHierarchyStateExpand=!0,i.hierarchyState!==HierarchyState.collapse&&(r=this.initChildrenNodeHierarchy(t,this.hierarchyExpandLevel,2,i),o+=r,e+=r)):!0!==i.children||i.hierarchyState||(i.hierarchyState=HierarchyState.collapse)}}supplementConfig(e,t,i,r){var o;this.columns=t,this._sourceLength=(null==(o=this._source)?void 0:o.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=e,this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},1<=r&&(this.hierarchyExpandLevel=r),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),\\\"tree\\\"===i&&this.initTreeHierarchyState(),this.rowHierarchyType=i,this.updatePagerData()}registerAggregator(e,t){this.registedAggregators[e]=t}registerAggregators(){this.registerAggregator(AggregationType.RECORD,RecordAggregator),this.registerAggregator(AggregationType.SUM,SumAggregator),this.registerAggregator(AggregationType.COUNT,CountAggregator),this.registerAggregator(AggregationType.MAX,MaxAggregator),this.registerAggregator(AggregationType.MIN,MinAggregator),this.registerAggregator(AggregationType.AVG,AvgAggregator),this.registerAggregator(AggregationType.NONE,NoneAggregator),this.registerAggregator(AggregationType.CUSTOM,CustomAggregator)}updateColumns(e){this.columns=e}_generateFieldAggragations(){var e=this.columns;this.fieldAggregators=[];const i=e=>{delete e.vtable_aggregator;var t=e.field,i=e.aggregation;if(i)if(Array.isArray(i))for(const o of i){var r=new this.registedAggregators[o.aggregationType]({field:t,formatFun:o.formatFun,isRecord:!0,aggregationFun:o.aggregationFun});this.fieldAggregators.push(r),e.vtable_aggregator||(e.vtable_aggregator=[]),e.vtable_aggregator.push(r)}else{i=new this.registedAggregators[i.aggregationType]({field:t,formatFun:i.formatFun,isRecord:!0,aggregationFun:i.aggregationFun});this.fieldAggregators.push(i),e.vtable_aggregator=i}},r=e=>{if(e&&0!==e.length)for(const t of e)i(t),t.columns&&r(t.columns)};r(e)}processRecords(i){this._generateFieldAggragations();var r,o,n=[],a=1<=this.fieldAggregators.length;if(1<=(null==(o=null==(o=this.dataConfig)?void 0:o.filterRules)?void 0:o.length)||1<=(null==(o=this.lastFilterRules)?void 0:o.length)||a){for(let e=0,t=i.length;e<t;e++){var l=i[e];1<=(null==(r=null==(r=this.dataConfig)?void 0:r.filterRules)?void 0:r.length)?this.filterRecord(l)&&(n.push(l),\\\"tree\\\"===this.rowHierarchyType&&l.children&&(l.filteredChildren=this.filteredChildren(l.children)),a)&&this.processRecord(l):(1<=(null==(r=this.lastFilterRules)?void 0:r.length)&&this.clearFilteredChildren(l),a&&this.processRecord(l))}if(1<=(null==(o=null==(o=this.dataConfig)?void 0:o.filterRules)?void 0:o.length))return n}return i}filteredChildren(e){var t=[];for(let r=0,o=e.length;r<o;r++){var i=e[r];this.filterRecord(i)&&(t.push(i),i.children)&&(i.filteredChildren=this.filteredChildren(i.children))}return t}processRecord(e){for(let t=0;t<this.fieldAggregators.length;t++)this.fieldAggregators[t].push(e)}initChildrenNodeHierarchy(e,t,i,r){let o,n,a,l=0;var s=r.filteredChildren?r.filteredChildren.length:null!=(n=null==(o=r.children)?void 0:o.length)?n:0;for(let u=0;u<s;u++){(i<=t||r.hierarchyState===HierarchyState.expand)&&(l+=1);var h=(r.filteredChildren||r.children)[u],d=Array.isArray(e)?e.concat(u):[e,u];(i<=t||r.hierarchyState===HierarchyState.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+l,0,d),(h.filteredChildren?0<h.filteredChildren.length:0<(null==(a=h.children)?void 0:a.length))&&(i<t||h.hierarchyState===HierarchyState.expand?(h.hierarchyState||(h.hierarchyState=HierarchyState.expand),this.hasHierarchyStateExpand=!0):h.hierarchyState||(h.hierarchyState=HierarchyState.collapse)),h.hierarchyState===HierarchyState.expand&&(l+=this.initChildrenNodeHierarchy(d,t,i+1,h)),!0!==h.children||h.hierarchyState||(h.hierarchyState=HierarchyState.collapse)}return l}updatePagination(e){this.pagination=e||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){var i=this.currentIndexedData,{perPageCount:e,currentPage:t}=this.pagination,r=e*(t||0),o=r+e;if(this._currentPagerIndexedData.length=0,i&&0<i.length){let e=-1;for(let t=0;t<i.length;t++)if((Array.isArray(i[t])&&1===i[t].length||!Array.isArray(i[t]))&&e++,e>=r&&e<o)this._currentPagerIndexedData.push(i[t]);else if(e>=o)break}else if(0<this._sourceLength)throw new Error(\\\"currentIndexedData should has values!\\\")}getRecordIndexPaths(e){return this._currentPagerIndexedData[e]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(e){return this.getOriginalRecord(_getIndex(this.currentPagerIndexedData,e))}getRaw(e){return this.getRawRecord(_getIndex(this.currentPagerIndexedData,e))}getIndexKey(e){return _getIndex(this.currentPagerIndexedData,e)}getTableIndex(t){return Array.isArray(t)?\\\"tree\\\"===this.rowHierarchyType?this.currentPagerIndexedData.findIndex(e=>arrayEqual(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(e,t,i,r,o){return this.getOriginalField(_getIndex(this.currentPagerIndexedData,e),t,i,r,o)}getRawField(e,t,i,r,o){return this.getRawFieldData(_getIndex(this.currentPagerIndexedData,e),t,i,r,o)}hasField(e,t){return this.hasOriginalField(_getIndex(this.currentPagerIndexedData,e),t)}getHierarchyState(e){var t,i=this.getOriginalRecord(this.currentPagerIndexedData[e]);if(null!=i&&i.hierarchyState){var r=i.hierarchyState;if(0<(null==(t=i.children)?void 0:t.length)||!0===i.children)return r}return null}toggleHierarchyState(t,e,i){var r=this.currentIndexedData.slice(0),o=this.getIndexKey(t),a=this.getHierarchyState(t),l=this.getOriginalRecord(o);if(this.clearSortedIndexMap(),a===HierarchyState.collapse)l.hierarchyState=HierarchyState.expand,this.pushChildrenNode(o,HierarchyState.expand,l),this.hasHierarchyStateExpand=!0;else if(a===HierarchyState.expand){let n=0;const u=(t,e,i)=>{if(e&&e!==HierarchyState.collapse&&e!==HierarchyState.none){var r=i.filteredChildren||i.children;if(r)for(let e=0;e<r.length;e++){n+=1;var o=Array.isArray(t)?t.concat([e]):[t,e];u(o,r[e].hierarchyState,r[e])}}};u(o,a,l),this.currentIndexedData.splice(this.currentIndexedData.indexOf(o)+1,n),l.hierarchyState=HierarchyState.collapse}this.updatePagerData();var n=[],s=[];if(a===HierarchyState.collapse){var h=this.currentIndexedData.length-r.length;for(let e=0;e<h;e++)n.push(t+e+1)}else if(a===HierarchyState.expand){var d=r.length-this.currentIndexedData.length;for(let e=0;e<d;e++)s.push(t+e+1)}return{add:n,remove:s}}pushChildrenNode(i,e,t){var r,o;if(!e||e===HierarchyState.collapse||e===HierarchyState.none)return 0;let n=0;const a=t.filteredChildren||t.children;if(a){const h=Array.from({length:a.length},(e,t)=>t);null!=(r=this.lastSortStates)&&r.forEach(t=>{\\\"normal\\\"!==t.order&&sort(e=>isValid_default(h[e])?h[e]:h[e]=e,(e,t)=>{h[e]=t},a.length,t.orderFn,t.order,e=>this.getOriginalField(Array.isArray(i)?i.concat([e]):[i,e],t.field))});for(let e=0;e<h.length;e++){n+=1;var l=Array.isArray(i)?i.concat([h[e]]):[i,h[e]],s=(this.currentIndexedData.splice(this.currentIndexedData.indexOf(i)+n,0,l),this.getOriginalRecord(l));!s.hierarchyState&&(null!=(o=s.filteredChildren)?o:s.children)&&(s.hierarchyState=HierarchyState.collapse),n+=this.pushChildrenNode(l,s.hierarchyState,a[h[e]])}}return n}changeFieldValue(e,t,i,r,o,n){if(null!==i&&0<=t){var a=this.getIndexKey(t);if(this.cacheBeforeChangedRecord(a,n),\\\"string\\\"==typeof i||\\\"number\\\"==typeof i){var l=null==(l=this.beforeChangedRecordsMap.get(a.toString()))?void 0:l[i],s=this.getOriginalRecord(a);let t=e;\\\"number\\\"==typeof l&&isAllDigits(e)&&(t=parseFloat(e)),isPromise(s)?s.then(e=>{e[i]=t})[\\\"catch\\\"](e=>{}):s?s[i]=t:(this.records[a]={},this.records[a][i]=t)}}}cacheBeforeChangedRecord(e,t){var i;this.beforeChangedRecordsMap.has(e.toString())||(i=this.getOriginalRecord(e),this.beforeChangedRecordsMap.set(e.toString(),null!=(i=cloneDeep(i,void 0,[\\\"vtable_gantt_linkedFrom\\\",\\\"vtable_gantt_linkedTo\\\"]))?i:{}))}setRecord(e,t){let i,r,o=!0;var n;1<=(null==(r=null==(i=this.dataConfig)?void 0:i.filterRules)?void 0:r.length)&&(this.filterRecord(e)?\\\"tree\\\"===this.rowHierarchyType&&e.children&&(e.filteredChildren=this.filteredChildren(e.children)):o=!1),o&&Array.isArray(this.records)&&(n=this.getIndexKey(t),Array.isArray(n)||this.records.splice(n,1,e))}addRecord(t,i){var r,o;if(Array.isArray(this.records)){this.records.splice(i,0,t),this.adjustBeforeChangedRecordsMap(i,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t);\\\"tree\\\"===this.rowHierarchyType&&this.initTreeHierarchyState(),this.userPagination?(this.pagination.totalCount=this._sourceLength,({perPageCount:r,currentPage:o}=this.pagination),i<r*(o||0)+r&&this.updatePagerData()):(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData()),null!=(o=this.dataSourceObj)&&o.added&&this.dataSourceObj.added(i,1)}}addRecords(i,r){var e,t;if(Array.isArray(this.records)){if(Array.isArray(i)){this.records.splice(r,0,...i),this.adjustBeforeChangedRecordsMap(r,i.length);for(let e=0;e<i.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=i.length;for(let t=0;t<this.fieldAggregators.length;t++)for(let e=0;e<i.length;e++)this.fieldAggregators[t].push(i[e])}this.userPagination?(this.pagination.totalCount=this._sourceLength,({perPageCount:e,currentPage:t}=this.pagination),r<e*(t||0)+e&&this.updatePagerData()):(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData()),null!=(t=this.dataSourceObj)&&t.added&&this.dataSourceObj.added(r,i.length)}}addRecordForSorted(e){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(e),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(e,t,i=\\\"add\\\"){for(let o=this.beforeChangedRecordsMap.size-1;o>=e;o--){var r=this.beforeChangedRecordsMap.get(o.toString());this.beforeChangedRecordsMap[\\\"delete\\\"](o.toString()),this.beforeChangedRecordsMap.set((o+(\\\"add\\\"===i?t:-t)).toString(),r)}}deleteRecords(t){var i;if(Array.isArray(this.records)){var r=[],o=t.sort((e,t)=>t-e);for(let e=0;e<o.length;e++){var n=o[e];if(!(n>=this._sourceLength||n<0)){this.adjustBeforeChangedRecordsMap(n,1,\\\"delete\\\"),r.push(n);var a=this.records[n];for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].deleteRecord(a);this.records.splice(n,1),this.currentIndexedData.pop(),--this._sourceLength}}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),null!=(i=this.dataSourceObj)&&i.deleted&&this.dataSourceObj.deleted(r),r}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){var i=t.sort((e,t)=>t-e);for(let e=0;e<i.length;e++){var r=i[e];r>=this._sourceLength||r<0||(r=this.currentIndexedData[r],this.records.splice(r,1),--this._sourceLength)}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){var i=[];for(let o=0;o<e.length;o++){var r=e[o];if(Array.isArray(r))this.beforeChangedRecordsMap[\\\"delete\\\"](r.toString()),i.push(r),r.slice(0,-1).reduce((e,t)=>(void 0===e[t]&&(e[t]={}),e[t].children),this.records)[r[r.length-1]]=t[o];else if(!(r>=this._sourceLength||r<0)){this.beforeChangedRecordsMap[\\\"delete\\\"](r.toString()),i.push(r);for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].updateRecord(this.records[r],t[o]);this.records[r]=t[o]}}return this.userPagination&&this.updatePagerData(),i}updateRecordsForSorted(e,t){var i=[];for(let n=0;n<t.length;n++){var r=t[n];if(!(r>=this._sourceLength||r<0)){var o=this.currentIndexedData[r];if(\\\"number\\\"!=typeof o)return;this.beforeChangedRecordsMap[\\\"delete\\\"](o.toString()),i.push(r),this.records[o]=e[n]}}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(t=>{var e=this.columns.find(e=>e.field===t.field);return!1!==(null==e?void 0:e.sort)&&\\\"normal\\\"!==t.order});let o=(this.lastSortStates=t).map(e=>this.sortedIndexMap.get(null==e?void 0:e.field)||{asc:[],desc:[],normal:[]}),e=null;if(0<o.length&&(e=t.reduce((e,t,i)=>{var r=null==(r=o[i])?void 0:r[t.order];return r&&0<r.length?r:e},null))&&0<e.length)this.currentIndexedData=e;else{const r=Array.from({length:this._sourceLength},(e,t)=>t);if(r.sort((i,r)=>t.reduce((e,t)=>0!==e?e:(t.orderFn||(\\\"desc\\\"!==t.order?(e,t)=>e===t?0:t<e?1:-1:(e,t)=>e===t?0:e<t?1:-1))(this.getOriginalField(i,t.field),this.getOriginalField(r,t.field),t.order),0)),this.currentIndexedData=r,this.hierarchyExpandLevel){let e=r.length;for(let t=0;t<e;t++){var i=this.getOriginalRecord(r[t]),i=this.pushChildrenNode(r[t],i.hierarchyState,this.getOriginalRecord(r[t]));e+=i,t+=i}}if(!o.length){o=t.map(()=>({asc:[],desc:[],normal:[]}));for(let e=0;e<t.length;e++)this.sortedIndexMap.set(t[e].field,o[e])}t.forEach((e,t)=>{o[t][e.order]=r.slice()})}this.updatePagerData(),this.fireListeners(EVENT_TYPE2.CHANGE_ORDER,null)}setSortedIndexMap(e,t){this.sortedIndexMap.set(e,t)}clearFilteredChildren(e){var t;e.filteredChildren=void 0;for(let i=0;i<(null!=(t=null==(t=e.children)?void 0:t.length)?t:0);i++)this.clearFilteredChildren(e.children[i])}filterRecord(e){let t,i,r,o=!0;for(let l=0;l<(null==(t=this.dataConfig.filterRules)?void 0:t.length);l++){var n=null==(i=this.dataConfig)?void 0:i.filterRules[l];if(n.filterKey){var a=e[n.filterKey];if(-1===n.filteredValues.indexOf(a)){o=!1;break}}else if(null==(r=n.filterFunc)||!r.call(n,e)){o=!1;break}}return o}updateFilterRulesForSorted(e){var t;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(t=null==(t=this.dataSourceObj)?void 0:t.records)?t:this.dataSourceObj),this._sourceLength=(null==(t=this._source)?void 0:t.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(e){var t;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=e,this._source=this.processRecords(null!=(t=null==(t=this.dataSourceObj)?void 0:t.records)?t:this.dataSourceObj),this._sourceLength=(null==(t=this._source)?void 0:t.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,\\\"tree\\\"===this.rowHierarchyType&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&0<this.lastSortStates.length&&this.sortedIndexMap.forEach((t,i)=>{this.lastSortStates.some(e=>e.field===i)?this.lastSortStates.forEach(e=>{\\\"asc\\\"===e.order?(t.desc=[],t.normal=[]):\\\"desc\\\"===e.order?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap[\\\"delete\\\"](i)})}get sourceLength(){return this._sourceLength}set sourceLength(e){this._sourceLength!==e&&(this._sourceLength=e,this.fireListeners(EVENT_TYPE2.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return 0<this._currentPagerIndexedData.length?this._currentPagerIndexedData:[]}release(){var e;null!=(e=super.release)&&e.call(this),this.lastFilterRules=null}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(e=>{e.asc&&(e.asc.length=0),e.desc&&(e.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){return getValue(this.dataSourceObj.records?Array.isArray(t)?getValueFromDeepArray(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getRawRecord(t){var e;return null!=(e=this.beforeChangedRecordsMap)&&e.has(t.toString())?null==(e=this.beforeChangedRecordsMap)?void 0:e.get(t.toString()):getValue(this.dataSourceObj.records?Array.isArray(t)?getValueFromDeepArray(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getOriginalField(t,i,e,r,o){if(null!==i)return getField(this.getOriginalRecord(t),i,e,r,o,e=>{this.fieldPromiseCallBack(t,i,e)})}getRawFieldData(t,i,e,r,o){if(null!==i)return getField(this.getRawRecord(t),i,e,r,o,e=>{this.fieldPromiseCallBack(t,i,e)})}hasOriginalField(e,t){var i;return null!==t&&(\\\"function\\\"==typeof t||(i=this.getOriginalRecord(e),Boolean(i&&t in i)))}fieldPromiseCallBack(e,t,i){}recordPromiseCallBack(e,t){}canChangeOrder(t,i){if(null!=(r=this.dataSourceObj)&&r.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,i);if(this.hasHierarchyStateExpand){var r,o=this.currentPagerIndexedData[t],n=this.currentPagerIndexedData[i],o=Array.isArray(o)?[...o]:[o],n=Array.isArray(n)?[...n]:[n];if(t<i&&n.length>o.length&&(r=this.currentPagerIndexedData[i+1],(r=Array.isArray(r)?[...r]:[r]).length<n.length)&&n.splice(n.length-1,1),o.length!==n.length)return!1;for(let e=0;e<=o.length-2;e++)if(o[e]!==n[e])return!1}return!0}changeOrder(o,n){var a,l;if(null!=(l=this.dataSourceObj)&&l.changeOrder)this.dataSourceObj.changeOrder(o,n);else if((null==(l=this.lastSortStates)||!l.some(e=>\\\"asc\\\"===e.order||\\\"desc\\\"===e.order))&&this.canChangeOrder(o,n))if(this.hasHierarchyStateExpand){let e,t,i=this.currentPagerIndexedData[o],r=this.currentPagerIndexedData[n];i=Array.isArray(i)?[...i]:[i],r=Array.isArray(r)?[...r]:[r],1<i.length||1<r.length?(o<n&&r.length>i.length&&(l=this.currentPagerIndexedData[n+1],(l=Array.isArray(l)?[...l]:[l]).length<r.length)&&r.splice(r.length-1,1),e=i.splice(i.length-1,1)[0],t=r.splice(r.length-1,1)[0],1<=i.length?((s=((l=this.getOriginalRecord(i)).filteredChildren||l.children).splice(e,1)).unshift(t,0),Array.prototype.splice.apply(null!=(a=l.filteredChildren)?a:l.children,s)):((a=this.records.splice(e,1)).unshift(t,0),Array.prototype.splice.apply(this.records,a))):(e=this.currentPagerIndexedData[o],t=this.currentPagerIndexedData[n],(l=this.records.splice(e,1)).unshift(t,0),Array.prototype.splice.apply(this.records,l)),this.restoreTreeHierarchyState(),this.updatePagerData()}else{var s=this.records.splice(o,1);s.unshift(n,0),Array.prototype.splice.apply(this.records,s)}}restoreTreeHierarchyState(){var r;if(this.hierarchyExpandLevel){for(let t=0;t<this._sourceLength;t++){var o=this.getOriginalRecord(t);(null!=(r=o.filteredChildren)?r:o.children)&&!o.hierarchyState&&(o.hierarchyState=HierarchyState.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(e,t)=>t);let e=this._sourceLength;for(let i=0;i<e;i++){var n=this.currentIndexedData[i],a=this.getOriginalRecord(n),l=null!=(l=a.filteredChildren)?l:a.children;0<(null==l?void 0:l.length)&&a.hierarchyState===HierarchyState.expand?(this.hasHierarchyStateExpand=!0,l=this.restoreChildrenNodeHierarchy(n,a),i+=l,e+=l):!0!==a.children||a.hierarchyState||(a.hierarchyState=HierarchyState.collapse)}}}restoreChildrenNodeHierarchy(e,t){let i,r,o=0;var n=null!=(i=t.filteredChildren)?i:t.children,a=null!=(r=null==n?void 0:n.length)?r:0;for(let h=0;h<a;h++){t.hierarchyState===HierarchyState.expand&&(o+=1);var l=n[h],s=Array.isArray(e)?e.concat(h):[e,h];t.hierarchyState===HierarchyState.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(e)+o,0,s),o+=this.restoreChildrenNodeHierarchy(s,l)}return o}};function getValueFromDeepArray(e,t){let i,r=e;for(let n=0;n<t.length;n++){var o=t[n];if(!r[o])return;o=null!=(i=(r=r[o]).filteredChildren)?i:null==r?void 0:r.children;o&&n+1<t.length&&(r=o)}return r}function sortRecordIndexs(e,a){return e.sort((e,t)=>{isNumber_default(e)&&(e=[e]),isNumber_default(t)&&(t=[t]);var i=Math.max(e.length,t.length);for(let n=0;n<i;n++){var r=null!=(r=e[n])?r:-1,o=null!=(o=t[n])?o:-1;if(r!==o)return 1===a?r-o:o-r}return 0})}DataSource.EMPTY=new DataSource({get(){},length:0}),init_esbuild_inject();var import_get=__toESM(require_get());function _setFieldCache(e,t,i,r){(e[t]||(e[t]=new Map)).set(i,r)}var CachedDataSource=class xob extends DataSource{static get EVENT_TYPE(){return DataSource.EVENT_TYPE}static ofArray(t,e,i,r,o,n){return new xob({get:e=>t[e],length:t.length,records:t},e,i,r,o,n)}constructor(e,t,i,r,o,n){let a;isArray_default(null==t?void 0:t.groupByRules)&&(o=\\\"tree\\\",a=!0),super(e,t,i,r,o,n),this._isGrouped=a,this._recordCache=[],this._fieldCache={}}getOriginalRecord(e){return isNumber_default(e)&&this._recordCache&&this._recordCache[e]?this._recordCache[e]:super.getOriginalRecord(e)}getRawRecord(t){var e,i;if(this._isGrouped){if(i=this.getOriginRecordIndexForGroup(t),isValid_default(i)&&null!=(e=this.beforeChangedRecordsMap)&&e.has(i.toString()))return null==(e=this.beforeChangedRecordsMap)?void 0:e.get(i.toString())}else if(null!=(i=this.beforeChangedRecordsMap)&&i.has(t.toString()))return null==(e=this.beforeChangedRecordsMap)?void 0:e.get(t.toString());return isNumber_default(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:getValue(this.dataSourceObj.records?Array.isArray(t)?getValueFromDeepArray(this.records,t):this.records[t]:this._get(t),e=>{this.recordPromiseCallBack(t,e)})}getOriginalField(e,t,i,r,o){var n=this._fieldCache&&this._fieldCache[e];if(n){n=n.get(t);if(n)return n}return super.getOriginalField(e,t,i,r,o)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(e,t,i){_setFieldCache(this._fieldCache,e,t,i)}recordPromiseCallBack(e,t){this._recordCache&&(this._recordCache[e]=t)}get records(){return Array.isArray(this._recordCache)&&0<this._recordCache.length?this._recordCache:super.records}release(){var e;null!=(e=super.release)&&e.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var e;if(super._generateFieldAggragations(),isArray_default(null==(e=this.dataConfig)?void 0:e.groupByRules)){const a=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[AggregationType.CUSTOM]({field:\\\"\\\",aggregationFun:(e,t,i)=>{var r=new Map,o=[];for(let n=0;n<t.length;n++)dealWithGroup(t[n],o,r,a,0);return o}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(e){var t,i=super.processRecords(e);return(null==(t=this.groupAggregator)?void 0:t.value())||i}getGroupLength(){var e;return null!=(e=null==(e=null==(e=this.dataConfig)?void 0:e.groupByRules)?void 0:e.length)?e:0}updateGroup(){this.clearCache();var e,t=this.source;this._source=this.processRecords(null!=(e=null==(e=this.dataSourceObj)?void 0:e.records)?e:this.dataSourceObj),t&&syncGroupCollapseState(t,this.source),this.sourceLength=(null==(e=this.source)?void 0:e.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(e,t)=>t),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(e){var t=this.getOriginalRecord(e);if(isValid_default(t)&&!(t.children&&0<t.children.length))for(let e=0;e<this.dataSourceObj.records.length;e++)if(this.dataSourceObj.records[e]===t)return e}addRecordsForGroup(t,i){if(isArray_default(t)&&0!==t.length){let e=this.getOriginRecordIndexForGroup(i);(void 0===e||e>this.dataSourceObj.records)&&(e=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length),this.updateGroup()}}deleteRecordsForGroup(t){if(isArray_default(t)&&0!==t.length){var i=sortRecordIndexs(t,-1);for(let e=0;e<i.length;e++){var r=i[e];isNumber_default(r)&&(r>=this.sourceLength||r<0)||(r=this.getOriginRecordIndexForGroup(r),this.beforeChangedRecordsMap[\\\"delete\\\"](r.toString()),this.dataSourceObj.records.splice(r,1),--this.sourceLength,this.adjustBeforeChangedRecordsMap(r,1,\\\"delete\\\"))}this.updateGroup()}}updateRecordsForGroup(e,t){for(let r=0;r<t.length;r++){var i=t[r];isNumber_default(i)&&(i>=this.sourceLength||i<0)||(i=this.getOriginRecordIndexForGroup(i),this.beforeChangedRecordsMap[\\\"delete\\\"](i.toString()),this.dataSourceObj.records[i]=e[r])}this.updateGroup()}addRecordsForTree(e,t){var i,r;isArray_default(e)&&0!==e.length&&(this.adjustBeforeChangedRecordsMap(t,e.length),isNumber_default(t)?this.dataSourceObj.records.splice(t,0,...e):(i=t.pop(),(r=this.getOriginalRecord(t)).children?r.children.splice(i,0,...e):r.children=e),this.initTreeHierarchyState(),this.updatePagerData())}deleteRecordsForTree(t){if(isArray_default(t)&&0!==t.length){var i=sortRecordIndexs(t,-1);for(let e=0;e<i.length;e++){var r,o=i[e];isNumber_default(o)&&(o>=this.sourceLength||o<0)||(this.beforeChangedRecordsMap[\\\"delete\\\"](o.toString()),isNumber_default(o)?this.dataSourceObj.records.splice(o,1):(r=o.pop(),this.getOriginalRecord(o).children.splice(r,1)),this.adjustBeforeChangedRecordsMap(o,1,\\\"delete\\\"))}this.initTreeHierarchyState(),this.updatePagerData()}}updateRecordsForTree(e,t){for(let n=0;n<t.length;n++){var i,r=t[n],o=e[n];isNumber_default(r)&&(r>=this.sourceLength||r<0)||(this.beforeChangedRecordsMap[\\\"delete\\\"](r.toString()),isNumber_default(r)?this.dataSourceObj.records.splice(r,1,o):(i=r.pop(),this.getOriginalRecord(r).children.splice(i,1,o)))}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(e,s,h=\\\"add\\\"){if(\\\"tree\\\"===this.rowHierarchyType){let l;l=isNumber_default(e)?[e]:e;const d=[];this.beforeChangedRecordsMap.forEach((e,t)=>{var i=t.split(\\\",\\\"),r=Math.max(i.length,l.length);for(let a=0;a<r;a++){var o=null!=(o=l[a])?o:-1,n=null!=(n=Number(i[a]))?n:-1;if(o<n||o===n&&a===i.length-1&&a===l.length-1)return i[a]=(n+(\\\"add\\\"===h?s:-s)).toString(),void d.push({originKey:t,targetKey:i.toString(),value:e})}}),d.forEach(({originKey:e,targetKey:t,value:i})=>{this.beforeChangedRecordsMap[\\\"delete\\\"](e),this.beforeChangedRecordsMap.set(t,i)})}else super.adjustBeforeChangedRecordsMap(e,s,h)}cacheBeforeChangedRecord(e,t){var i=this.getOriginalRecord(e);t.options.groupBy&&(e=this.getOriginRecordIndexForGroup(e)),this.beforeChangedRecordsMap.has(e.toString())||this.beforeChangedRecordsMap.set(e.toString(),null!=(i=cloneDeep(i,void 0,[\\\"vtable_gantt_linkedFrom\\\",\\\"vtable_gantt_linkedTo\\\"]))?i:{})}getGroupSeriesNumber(e){var t=this.dataSource.currentIndexedData[e],i=t.length-1;let r=t.length,o=1;for(;r>i;o++){var n=this.dataSource.currentIndexedData[e-o];r=isNumber_default(n)?1:n.length}return o-1}};function dealWithGroup(e,t,i,r,o){var n,a=r[o];if(isValid_default(a))return void 0!==(a=(0,import_get[\\\"default\\\"])(e,a))?i.has(a)?dealWithGroup(e,t[n=i.get(a)].children,t[n].map,r,o+1):(i.set(a,t.length),t.push({vtableMerge:!0,vtableMergeName:a,children:[],map:new Map}),dealWithGroup(e,t[t.length-1].children,t[t.length-1].map,r,o+1)):void 0;t.push(e)}function syncGroupCollapseState(t,i,r,o){if(!r){r=new Map;for(let e=0;e<t.length;e++){var n=t[e];n.vtableMerge&&r.set(n.vtableMergeName,e)}}if(!o){o=new Map;for(let e=0;e<i.length;e++){var a=i[e];a.vtableMerge&&o.set(a.vtableMergeName,e)}}for(let s=0;s<t.length;s++){var e=t[s],l=i[o.get(e.vtableMergeName)];isValid_default(l)&&(l.hierarchyState=t[s].hierarchyState),isArray_default(e.children)&&isArray_default(l.children)&&0!==e.map.size&&0!==l.map.size&&syncGroupCollapseState(e.children,l.children,e.map,l.map)}}init_esbuild_inject();var import_cssfontparser=__toESM(require_cssfontparser());function parseFont(e){return(0,import_cssfontparser[\\\"default\\\"])(e)}function getQuadProps(t){var e;if(isNumber_default(t)||isString_default(t)||isArray_default(t)){let e=parsePadding(t);return\\\"number\\\"==typeof e||\\\"string\\\"==typeof e?e=[e,e,e,e]:Array.isArray(e)&&(e=e.slice(0)),e}return t&&(isFinite(t.bottom)||isFinite(t.left)||isFinite(t.right)||isFinite(t.top))?[null!=(e=t.top)?e:0,null!=(e=t.right)?e:0,null!=(e=t.bottom)?e:0,null!=(e=t.left)?e:0]:[0,0,0,0]}init_esbuild_inject(),init_esbuild_inject();var TYPE_PAREN=0,TYPE_UNIT=1,TYPE_OPERATOR=2,TYPE_NUMBER=3,NODE_TYPE_UNIT=10,NODE_TYPE_BINARY_EXPRESSION=11,NODE_TYPE_NUMBER=12,TABULATION=9,CARRIAGE_RETURN=13,LINE_FEED=10,FORM_FEED=12,SPACE=32,PERCENT=37,FULL_STOP=46,DIGIT_0=48,DIGIT_9=57,LATIN_CAPITAL_A=65,LATIN_CAPITAL_Z=90,LATIN_SMALL_A=97,LATIN_SMALL_Z=122;function isUpperLetter(e){return LATIN_CAPITAL_A<=e&&e<=LATIN_CAPITAL_Z}function isLowerLetter(e){return LATIN_SMALL_A<=e&&e<=LATIN_SMALL_Z}function isLetter(e){return isLowerLetter(e)||isUpperLetter(e)}function isWhitespace(e){return e===TABULATION||e===LINE_FEED||e===FORM_FEED||e===CARRIAGE_RETURN||e===SPACE}function isDigit(e){return DIGIT_0<=e&&e<=DIGIT_9}function isDot(e){return e===FULL_STOP}function isUnit(e){return isLetter(e)||e===PERCENT}function createError(e){return new Error(\\\"calc parse error: \\\"+e)}function tokenize(h){const d=h.replace(/calc\\\\(/g,\\\"(\\\").trim(),u=[],c=d.length;for(let i=0;i<c;i++){var e=d[i],t=e.charCodeAt(0);if(\\\"(\\\"===e||\\\")\\\"===e)u.push({value:e,type:TYPE_PAREN});else if(\\\"*\\\"===e||\\\"/\\\"===e)u.push({value:e,type:TYPE_OPERATOR});else if(\\\"+\\\"===e||\\\"-\\\"===e)i=function(e,t){if(t<c){var i=d[t],r=i.charCodeAt(0);if(isDigit(r)||isDot(r))return o(e+i,t+1)}return u.push({value:e,type:TYPE_OPERATOR}),t}(e,i+1)-1;else if(isDigit(t)||isDot(t))i=o(e,i+1)-1;else if(!isWhitespace(t))throw createError(h)}function o(t,e){let i=e;for(;i<c;i++){var r=d[i],o=r.charCodeAt(0);if(!isDigit(o)){if(\\\".\\\"!==r){if(isUnit(o)){var n=t;var a=r;var l=i+1;let e=l;for(;e<c;e++){var s=d[e];if(!isUnit(s.charCodeAt(0)))break;a+=s}return u.push({value:parseFloat(n),unit:a,type:TYPE_UNIT}),e;return}break}if(0<=t.indexOf(\\\".\\\"))throw createError(h)}t+=r}if(\\\".\\\"===t)throw createError(h);return u.push({value:parseFloat(t),type:TYPE_NUMBER}),i}return u}var PRECEDENCE={\\\"*\\\":3,\\\"/\\\":3,\\\"+\\\":2,\\\"-\\\":2};function lex(e,o){function t(e){var t=e.pop(),i=e.pop(),r=e.pop();if(r&&r.nodeType&&i&&i.type===TYPE_OPERATOR&&t&&t.nodeType)return{nodeType:NODE_TYPE_BINARY_EXPRESSION,left:r,op:i,right:t};throw createError(o)}for(var i=[];e.length;){var r,n,a=e.shift();if(a.type===TYPE_PAREN&&\\\"(\\\"===a.value){let t=0;var l=array.findIndex(e,e=>{if(e.type===TYPE_PAREN&&\\\"(\\\"===e.value)t++;else if(e.type===TYPE_PAREN&&\\\")\\\"===e.value){if(!t)return!0;t--}return!1});if(-1===l)throw createError(o);i.push(lex(e.splice(0,l),o)),e.shift()}else a.type===TYPE_OPERATOR?(3<=i.length&&(l=i[i.length-2].value,PRECEDENCE[a.value]<=PRECEDENCE[l])&&i.push(t(i)),i.push(a)):a.type===TYPE_UNIT?(({value:r,unit:n}=a),i.push({nodeType:NODE_TYPE_UNIT,value:r,unit:n})):a.type===TYPE_NUMBER&&i.push({nodeType:NODE_TYPE_NUMBER,value:a.value})}for(;1<i.length;)i.push(t(i));return i[0]}function parse3(e){return lex(tokenize(e),e)}function calcNode(e,t){if(e.nodeType===NODE_TYPE_BINARY_EXPRESSION){var i=calcNode(e.left,t),r=calcNode(e.right,t);switch(e.op.value){case\\\"+\\\":return i+r;case\\\"-\\\":return i-r;case\\\"*\\\":return i*r;case\\\"/\\\":return i/r;default:throw new Error(\\\"calc error. unknown operator: \\\"+e.op.value)}}else if(e.nodeType===NODE_TYPE_UNIT)switch(e.unit){case\\\"%\\\":return e.value*t.full/100;case\\\"px\\\":return e.value;default:throw new Error(\\\"calc error. unknown unit: \\\"+e.unit)}else if(e.nodeType===NODE_TYPE_NUMBER)return e.value;throw new Error(\\\"calc error.\\\")}function toPxInternal(e,t){return calcNode(parse3(e),t)}function toPx(e,t){return\\\"string\\\"==typeof e?toPxInternal(e.trim(),t):+e}function createRootElement(e,t=\\\"vtable\\\"){var i=document.createElement(\\\"div\\\"),r=(i.setAttribute(\\\"tabindex\\\",\\\"0\\\"),i.classList.add(t),i.style.outline=\\\"none\\\",i.style.margin=e.top+`px ${e.right}px ${e.bottom}px ${e.left}px`,(i.offsetWidth||(null==(r=i.parentElement)?void 0:r.offsetWidth)||1)-1),o=(i.offsetHeight||(null==(o=i.parentElement)?void 0:o.offsetHeight)||1)-1;return i.style.width=r&&r-e.left-e.right+\\\"px\\\"||\\\"0px\\\",i.style.height=o&&o-e.top-e.bottom+\\\"px\\\"||\\\"0px\\\",i}function updateRootElementPadding(e,t){e.style.margin=t.top+`px ${t.right}px ${t.bottom}px ${t.left}px`;var i=(e.offsetWidth||(null==(i=e.parentElement)?void 0:i.offsetWidth)||1)-1,r=(e.offsetHeight||(null==(r=e.parentElement)?void 0:r.offsetHeight)||1)-1;e.style.width=i&&i-t.left-t.right+\\\"px\\\"||\\\"0px\\\",e.style.height=r&&r-t.top-t.bottom+\\\"px\\\"||\\\"0px\\\"}function _dealWithUpdateDataSource(t,e){var i=t.internalProps.dataSourceEventIds;i&&i.forEach(e=>t.internalProps.handler.off(e)),e(t),t.internalProps.dataSourceEventIds=[t.internalProps.handler.on(t.internalProps.dataSource,DataSource.EVENT_TYPE.CHANGE_ORDER,()=>{t.dataSource.hierarchyExpandLevel&&t.refreshRowColCount(),t.render()})]}function _setRecords(t,i=[]){_dealWithUpdateDataSource(t,()=>{t.internalProps.records=i;var e=t.internalProps.dataSource=CachedDataSource.ofArray(i,t.internalProps.dataConfig,t.pagination,t.internalProps.columns,t.internalProps.layoutMap.rowHierarchyType,getHierarchyExpandLevel(t));t.addReleaseObj(e)})}function getHierarchyExpandLevel(e){var t;return e.options.hierarchyExpandLevel||(e.options.groupBy?1/0:null!=(t=e._hasHierarchyTreeHeader)&&t.call(e)?1:void 0)}function _setDataSource(i,r){_dealWithUpdateDataSource(i,()=>{var e,t;i.internalProps.dataSource&&null!=(t=(e=i.internalProps.dataSource).release)&&t.call(e),r?r instanceof DataSource?(i.internalProps.dataSource=r,i.internalProps.dataSource.supplementConfig(i.pagination,i.options.columns,i.internalProps.layoutMap.rowHierarchyType,getHierarchyExpandLevel(i))):i.internalProps.dataSource=new CachedDataSource(r):i.internalProps.dataSource=DataSource.EMPTY,i.addReleaseObj(i.internalProps.dataSource),i.internalProps.records=null})}function _getTargetFrozenRowAt(i,r){if(i.internalProps.frozenRowCount){let e=i.scrollTop;var o=i.internalProps.frozenRowCount;for(let t=0;t<o;t++){var n=i.getRowHeight(t),a=e+n;if(r<a)return{top:e,row:t,bottom:a,height:n};e=a}}return null}function _getTargetFrozenColAt(i,r){if(i.internalProps.frozenColCount){let e=i.scrollLeft;var o=i.internalProps.frozenColCount;for(let t=0;t<o;t++){var n=i.getColWidth(t),a=e+n;if(r<a)return{left:e,col:t,right:a,width:n};e=a}}return null}function _toPxWidth(e,t){return Math.round(toPx(t,e.internalProps.calcWidthContext))}function _applyColWidthLimits(e,t){return e?e.min&&e.min>t?e.min:e.max&&e.max<t?e.max:t:t}function _getScrollableVisibleRect(e){let t=0,i=0,r=(0<e.frozenColCount&&(t=e.getFrozenColsWidth()),0<e.rightFrozenColCount&&(i=e.getRightFrozenColsWidth()),0),o=0;return 0<e.frozenRowCount&&(r=e.getFrozenRowsHeight()),0<e.bottomFrozenRowCount&&(o=e.getBottomFrozenRowsHeight()),new Rect2(e.scrollLeft+t,e.scrollTop+r,e.tableNoFrameWidth-t-i,e.tableNoFrameHeight-r-o)}function getStyleTheme(e,t,i,r,o,n=!0){var a=getQuadProps(o(\\\"padding\\\",e,i,r,t)),l=o(\\\"bgColor\\\",e,i,r,t),s=o(\\\"font\\\",e,i,r,t);let h,d,u,c,g;s?(({family:p,size:f,weight:m,style:b,variant:C}=parseFont(s)),h=p.join(\\\" \\\"),d=f,u=m,c=b,c=C):(h=o(\\\"fontFamily\\\",e,i,r,t),d=o(\\\"fontSize\\\",e,i,r,t),u=o(\\\"fontWeight\\\",e,i,r,t),c=o(\\\"fontStyle\\\",e,i,r,t),g=o(\\\"fontVariant\\\",e,i,r,t));var p=o(\\\"textAlign\\\",e,i,r,t),f=o(\\\"textBaseline\\\",e,i,r,t),m=o(\\\"color\\\",e,i,r,t),b=o(\\\"strokeColor\\\",e,i,r,t),C=o(\\\"lineHeight\\\",e,i,r,t),v=o(\\\"underline\\\",e,i,r,t),y=o(\\\"underlineDash\\\",e,i,r,t),w=o(\\\"underlineOffset\\\",e,i,r,t),_=o(\\\"lineThrough\\\",e,i,r,t),S=Math.max(1,Math.floor(d/10)),x=o(\\\"textOverflow\\\",e,i,r,t),R=o(\\\"borderColor\\\",e,i,r,t),T=o(\\\"borderLineWidth\\\",e,i,r,t),A=o(\\\"borderLineDash\\\",e,i,r,t),P=o(\\\"marked\\\",e,i,r,t),B=o(\\\"cursor\\\",e,i,r,t),s=!(a&&l&&s&&p&&f&&m&&x&&R&&T&&A&&\\\"boolean\\\"==typeof v&&\\\"boolean\\\"==typeof _&&\\\"boolean\\\"==typeof P);return n?(m={text:{fontFamily:h,fontSize:d,fontWeight:u,fontStyle:c,fontVariant:g,fill:m,stroke:null!=b&&b,textAlign:p,textBaseline:f,lineHeight:null!=C?C:d,underline:v?S:void 0,underlineDash:y,underlineOffset:w,lineThrough:_?S:void 0,ellipsis:\\\"clip\\\"===x?\\\"\\\":\\\"ellipsis\\\"===x?\\\"...\\\":isValid_default(x)?x:void 0},group:{fill:l,lineDash:A,lineWidth:T,stroke:R,cursor:\\\"auto\\\"===B||\\\"default\\\"===B?void 0:B},_vtable:{padding:a,marked:P}},Array.isArray(T)&&(m.group.strokeArrayWidth=getQuadProps(T)),Array.isArray(R)&&(b=getQuadProps(R),m.group.stroke=!b.every(e=>!e)&&b,m.group.strokeArrayColor=getQuadProps(R)),{theme:m,hasFunctionPros:s}):{hasFunctionPros:s}}function getCellCornerRadius(e,t,i){var r=i.theme.frameStyle.cornerRadius;if(i.theme.cellInnerBorder)if(Array.isArray(r)){if(0===e&&0===t)return[r[0],0,0,0];if(e===i.colCount-1&&0===t)return[0,r[1],0,0];if(0===e&&t===i.rowCount-1)return[0,0,0,r[3]];if(e===i.colCount-1&&t===i.rowCount-1)return[0,0,r[2],0]}else if(r){if(0===e&&0===t)return[r,0,0,0];if(e===i.colCount-1&&0===t)return[0,r,0,0];if(0===e&&t===i.rowCount-1)return[0,0,0,r];if(e===i.colCount-1&&t===i.rowCount-1)return[0,0,r,0]}return 0}function generateAggregationForColumn(e){for(let r=0;r<e.internalProps.columns.length;r++){var t=e.internalProps.columns[r];if(!t.aggregation&&e.options.aggregation){var i=\\\"function\\\"==typeof e.options.aggregation?e.options.aggregation({col:r,field:t.field}):e.options.aggregation;if(i)if(Array.isArray(i)){const o=[];i.forEach(e=>{o.push(Object.assign({showOnTop:!1},e))}),t.aggregation=o}else t.aggregation=Object.assign({showOnTop:!1},i)}}}function checkHasAggregationOnColumnDefine(e){for(let t=0;t<e.length;t++)if(e[t].aggregation)return!0;return!1}function checkHasColumnAutoWidth(e){if(\\\"autoWidth\\\"===e.options.widthMode)return!0;if(\\\"auto\\\"===e.options.defaultHeaderColWidth||Array.isArray(e.options.defaultHeaderColWidth)&&e.options.defaultHeaderColWidth.includes(\\\"auto\\\"))return!0;var t=e.internalProps.layoutMap.columnObjects;for(let i=0;i<t.length;i++)if(\\\"auto\\\"===t[i].width)return!0;return!1}init_esbuild_inject(),init_esbuild_inject();var import_gifuct_js=__toESM(require_lib2()),Icon=class extends Image2{constructor(e){super(e),\\\"mouseenter_cell\\\"!==this.attribute.visibleTime&&\\\"click_cell\\\"!==this.attribute.visibleTime||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,ResourceLoader.GetFile(this.attribute.gif+(\\\"?role=gif&radom=\\\"+Math.random()),\\\"arrayBuffer\\\").then(e=>{var t=(0,import_gifuct_js.parseGIF)(e),t=(0,import_gifuct_js.decompressFrames)(t,!0);this.renderGIF(t),this.resources.set(this.attribute.image,{state:\\\"success\\\",data:this.gifCanvas})})[\\\"catch\\\"](e=>{})}get backgroundWidth(){var e;return null!=(e=null!=(e=this.attribute.backgroundWidth)?e:this.attribute.width)?e:0}get backgroundHeight(){var e;return null!=(e=null!=(e=this.attribute.backgroundHeight)?e:this.attribute.height)?e:0}renderGIF(e){this.loadedFrames=e,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement(\\\"canvas\\\"),this.tempCtx=this.tempCanvas.getContext(\\\"2d\\\")),this.gifCanvas||(this.gifCanvas=document.createElement(\\\"canvas\\\"),this.gifCtx=this.gifCanvas.getContext(\\\"2d\\\")),this.gifCanvas.width=e[0].dims.width,this.gifCanvas.height=e[0].dims.height,this.playing=!0,this.lastTime=(new Date).getTime(),this.animate().to({},1e3,\\\"linear\\\").loop(1/0)}renderFrame(e,t,i){var r=this.loadedFrames[this.frameIndex||0],o=(2===r.disposalType&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(r),this.manipulate(e,t,i),(new Date).getTime()-this.lastTime);r.delay<o&&(this.frameIndex++,this.lastTime=(new Date).getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(e){var t=e.dims;this.frameImageData&&t.width===this.frameImageData.width&&t.height===this.frameImageData.height||(this.tempCanvas.width=t.width,this.tempCanvas.height=t.height,this.frameImageData=this.tempCtx.createImageData(t.width,t.height)),this.frameImageData.data.set(e.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,t.left,t.top)}manipulate(e,t,i){e.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,t,i,this.attribute.width,this.attribute.height)}setAttribute(e,t,i,r){super.setAttribute(e,t,i,r),\\\"gif\\\"===e&&this.loadGif()}setAttributes(e,t,i){super.setAttributes(e,t,i),e.gif&&this.loadGif()}},TextIcon=class extends Text{constructor(e){var t;e.fill=null!=(t=e.fill)?t:\\\"#00F\\\",e.fontSize=null!=(t=e.fontSize)?t:12,e.underline=null!=(t=e.underline)?t:1,e.textBaseline=null!=(t=e.textBaseline)?t:\\\"top\\\",e.cursor=null!=(t=e.cursor)?t:\\\"pointer\\\",super(e)}};function emptyCustomLayout(e){return{rootContainer:new Group({}),renderDefault:!0}}init_esbuild_inject();var ReactCustomLayout=class{constructor(e){this.table=e,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(e,t){return(t?this.headerCustomLayoutFuncCache:this.customLayoutFuncCache).has(e)}setReactCreateGraphic(e,t,i){(i?this.headerCustomLayoutFuncCache:this.customLayoutFuncCache).set(e,t)}setReactRemoveGraphic(e,t,i){(i?this.headerReactRemoveGraphicCache:this.reactRemoveGraphicCache).set(e,t)}setReactRemoveAllGraphic(e,t,i){(i?this.headerReactRemoveAllGraphicCache:this.reactRemoveAllGraphicCache).set(e,t)}updateCustomCell(i,r){var o=this.table;if(\\\"autoWidth\\\"===o.widthMode&&o.scenegraph.recalculateColWidths(),(o.isAutoRowHeight()||\\\"auto\\\"===o.internalProps.defaultRowHeight&&!r||\\\"auto\\\"===o.internalProps.defaultHeaderRowHeight&&r)&&o.scenegraph.recalculateRowHeights(),o.isPivotTable()){var n=getUpdateCustomCellRangeInPivotTable(i,o,r);for(let e=0;e<n.length;e++){var a=n[e];for(let t=a.start.col;t<=a.end.col;t++)for(let e=a.start.row;e<=a.end.row;e++)o.scenegraph.updateCellContent(t,e)}}else{var l=getUpdateCustomCellRangeInListTable(i,o,r);for(let t=l.start.col;t<=l.end.col;t++)for(let e=l.start.row;e<=l.end.row;e++)o.scenegraph.updateCellContent(t,e)}o.scenegraph.renderSceneGraph()}getCustomLayoutFunc(e,t){var i;return this.table.isHeader(e,t)?(i=this.table.getHeaderDefine(e,t).componentId,null!=(i=this.headerCustomLayoutFuncCache.get(i))?i:emptyCustomLayout):(i=this.table.getBodyColumnDefine(e,t).componentId,this.customLayoutFuncCache.get(i)||emptyCustomLayout)}removeCustomCell(e,t){let i;var r;(i=this.table.isHeader(e,t)?(r=this.table.getHeaderDefine(e,t).componentId,this.headerReactRemoveGraphicCache.get(r)):(r=this.table.getBodyColumnDefine(e,t).componentId,this.reactRemoveGraphicCache.get(r)))&&i(e,t)}clearCache(){this.reactRemoveAllGraphicCache.forEach(e=>{e()}),this.headerReactRemoveAllGraphicCache.forEach(e=>{e()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t)}),this.headerCustomLayoutFuncCache.forEach((e,t)=>{this.updateCustomCell(t,!0)})}};function getUpdateCustomCellRangeInListTable(i,r,e){var t=r.internalProps.rowSeriesNumber?1:0;if(e){var o=r.internalProps.layoutMap,n=r.internalProps.layoutMap.headerObjects;let e;for(let t=0;t<n.length;t++){var a=n[t];if(a.define.componentId===i){e=a.id;break}}var l=o.getHeaderCellAdressById(e);return o.getCellRange(l.col,l.row)}var s=r.internalProps.layoutMap.columnObjects;for(let h=0;h<s.length;h++)if(s[h].define.componentId===i)return{start:{col:t+h,row:r.columnHeaderLevelCount},end:{col:t+h,row:r.rowCount-1}};return{start:{col:0,row:0},end:{col:r.colCount-1,row:r.rowCount-1}}}function getUpdateCustomCellRangeInPivotTable(r,e,t){var o=e.internalProps.rowSeriesNumber?1:0,n=[],a=e.internalProps.layoutMap;if(t){var i=a.headerObjects,l=[];for(let e=0;e<i.length;e++){var s=i[e];s&&s.define.componentId===r&&l.push(s.id)}for(let t=0;t<l.length;t++){var h=l[t],h=a.getHeaderCellAdressById(h),h=a.getCellRange(h.col,h.row);n.push(h)}}else{let i;var{columnObjects:d,indicatorsAsCol:u}=a;for(let e=0;e<d.length;e++)if(d[e].define.componentId===r){i=e;break}if(u)for(let e=a.rowHeaderLevelCount+i;e<a.colCount;e+=d.length){var c={start:{col:e+o,row:a.columnHeaderLevelCount},end:{col:e+o,row:a.rowCount-1}};n.push(c)}else for(let t=a.columnHeaderLevelCount+i;t<a.rowCount;t+=d.length){var g={start:{col:a.rowHeaderLevelCount+o,row:t},end:{col:a.colCount-1,row:t}};n.push(g)}}return n}function getCellEventArgsSet(e){var t={abstractPos:{x:e.viewport.x,y:e.viewport.y}},i=getTargetCell(e.target);return i&&(t.eventArgs={col:i.col,row:i.row,event:e,targetCell:i,mergeInfo:getMergeCellInfo(i),target:e.target}),t}function getTargetCell(e){for(;e&&e.parent;){if(\\\"cell\\\"===e.role)return e;e=e.parent}return null}function getMergeCellInfo(e){if(isValid_default(e.mergeStartCol)&&isValid_default(e.mergeStartRow)&&isValid_default(e.mergeEndCol)&&isValid_default(e.mergeEndRow))return{colStart:e.mergeStartCol,colEnd:e.mergeEndCol,rowStart:e.mergeStartRow,rowEnd:e.mergeEndRow}}init_esbuild_inject();var regIndexReg=/radio-\\\\d+-\\\\d+-(\\\\d+)/,CUSTOM_MERGE_PRE_NAME=\\\"_custom_\\\",CUSTOM_CONTAINER_NAME=\\\"custom-container\\\",CUSTOM_MERGE_CONTAINER_NAME=CUSTOM_MERGE_PRE_NAME+\\\"_0\\\";function dealWithCustom(e,t,i,r,o,n,a,l,s,h,d){let u,c,g,p,f,m,b,C=!0,v=!1;if(\\\"function\\\"==typeof(e=\\\"react-custom-layout\\\"===e?(null==(u=d.reactCustomLayout)?void 0:u.getCustomLayoutFunc(i,r))||emptyCustomLayout:e)){var y=e({col:null!=(c=null==h?void 0:h.start.col)?c:i,row:null!=(g=null==h?void 0:h.start.row)?g:r,dataValue:d.getCellOriginValue(i,r),value:d.getCellValue(i,r)||\\\"\\\",rect:{left:0,top:0,right:o,bottom:n,width:o,height:n},table:d,originCol:i,originRow:r});if(!y)return{renderDefault:!0};y.rootContainer&&(y.rootContainer=decodeReactDom(y.rootContainer,d.animationManager.timeline)),y.rootContainer instanceof Group&&((b=y.rootContainer).name=CUSTOM_CONTAINER_NAME,b.col=i,b.row=r),C=y.renderDefault,v=y.enableCellPadding}else\\\"function\\\"==typeof t?(y=t({col:i,row:r,dataValue:d.getCellOriginValue(i,r),value:d.getCellValue(i,r)||\\\"\\\",rect:{left:0,top:0,right:o,bottom:n,width:o,height:n},table:d}))&&(m=y.elements,C=y.renderDefault,p=y.expectedWidth,f=y.expectedHeight):t&&(p=t.expectedWidth,f=t.expectedHeight,m=t.elements,C=t.renderDefault);return m&&(b=adjustElementToGroup(m,a?p:o,l?f:n,d.getCellValue(i,r))),v&&b.setAttributes({x:s[3],y:s[0],width:o-s[1]-s[3],height:n-s[0]-s[2]}),dealPercentCalc(b,o,n),!h||h.start.col===h.end.col&&h.start.row===h.end.row||bindAttributeUpdate(b,i,r,0),{elementsGroup:b,renderDefault:C}}function adjustElementToGroup(e,t,i,r){const o=new Group({x:0,y:0,width:t,height:i,fill:!1,stroke:!1,pickable:!1});return o.name=CUSTOM_CONTAINER_NAME,adjustElementsPos(e,t,i,r).forEach(e=>{switch(e.clickable&&(e.pickable=e.clickable),e.type){case\\\"arc\\\":var t=createArc({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(t=e.dy)?t:0,fill:e.fill,stroke:e.stroke,outerRadius:e.radius,startAngle:e.startAngle,endAngle:e.endAngle,pickable:!!e.pickable,cursor:e.cursor});t.name=e.name,o.appendChild(t);break;case\\\"text\\\":e.background&&(t=null!=(t=null==(t=e.background)?void 0:t.expandX)?t:0,r=null!=(r=null==(r=e.background)?void 0:r.expandY)?r:0,t=createRect({x:e.x-t,y:e.y-r,dx:null!=(i=e.dx)?i:0,dy:null!=(i=e.dy)?i:0,width:e.width+2*t,height:e.height+2*r,cornerRadius:null!=(t=null==(i=e.background)?void 0:i.cornerRadius)?t:0,fill:null!=(i=null==(r=e.background)?void 0:r.fill)?i:\\\"#888\\\"}),o.appendChild(t));var i=new Text(Object.assign({pickable:!!e.pickable,fill:null!=(r=e.color)?r:e.fill},e));i.name=e.name,o.appendChild(i);break;case\\\"rect\\\":var i=createRect({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(r=e.dy)?r:0,width:e.width,height:e.height,cornerRadius:e.radius,fill:e.fill,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});i.name=e.name,o.appendChild(i);break;case\\\"circle\\\":var i=createCircle({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(r=e.dy)?r:0,radius:e.radius,fill:e.fill,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});i.name=e.name,o.appendChild(i);break;case\\\"icon\\\":i=new Icon({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(r=e.dy)?r:0,width:e.width,height:e.height,image:e.svg,backgroundWidth:e.hover?null!=(i=e.hover.width)?i:e.width:void 0,backgroundHeight:e.hover?null!=(t=e.hover.width)?t:e.width:void 0,backgroundColor:e.hover?null!=(r=e.hover.bgColor)?r:\\\"rgba(22,44,66,0.2)\\\":void 0,pickable:!!e.pickable,cursor:e.cursor});i.name=e.name,i.role=\\\"icon-custom\\\",o.appendChild(i);break;case\\\"image\\\":i=new Icon({x:e.x,y:e.y,dx:null!=(t=e.dx)?t:0,dy:null!=(r=e.dy)?r:0,width:e.width,height:e.height,image:e.src,backgroundWidth:e.hover?null!=(i=e.hover.width)?i:e.width:void 0,backgroundHeight:e.hover?null!=(t=e.hover.width)?t:e.width:void 0,backgroundColor:e.hover?null!=(r=e.hover.bgColor)?r:\\\"rgba(22,44,66,0.2)\\\":void 0,pickable:!!e.pickable,cursor:e.cursor,shape:e.shape});i.name=e.name,i.role=\\\"image-custom\\\",o.appendChild(i);break;case\\\"line\\\":var r=createLine({points:e.points,lineWidth:null!=(t=e.lineWidth)?t:1,stroke:e.stroke,pickable:!!e.pickable,cursor:e.cursor});r.name=e.name,o.appendChild(r)}}),o}function adjustElementsPos(e,t,i,r){var o=[],n=[0,0,0,0];for(let s=0;s<e.length;s++){var a=e[s],l=Object.assign({},a);for(const h in l)l.hasOwnProperty(h)&&isFunction_default(l[h])&&(l[h]=l[h](r));a=l;isValid_default(a.x)&&(a.x=isString_default(a.x)?transformString(a.x,t-n[1]):Number(a.x)),isValid_default(a.y)&&(a.y=isString_default(a.y)?transformString(a.y,i-n[2]):Number(a.y)),\\\"width\\\"in l&&(l.width=isString_default(l.width)?transformString(l.width,t-n[1]):Number(l.width)),\\\"height\\\"in l&&(l.height=isString_default(l.height)?transformString(l.height,i-n[2]):Number(l.height)),\\\"radius\\\"in l&&(l.radius=isString_default(l.radius)?transformString(l.radius,Math.min(t-n[1],i-n[2])):Number(l.radius)),\\\"hover\\\"in l&&(l.hover.x=isString_default(l.hover.x)?transformString(l.hover.x,t-n[1]):Number(l.hover.x),l.hover.y=isString_default(l.hover.y)?transformString(l.hover.y,i-n[2]):Number(l.hover.y),l.hover.width=isString_default(l.hover.width)?transformString(l.hover.width,t-n[1]):Number(l.hover.width),l.hover.height=isString_default(l.hover.height)?transformString(l.hover.height,i-n[2]):Number(l.hover.height),l.hover.x+=0,l.hover.y+=0),a.x=a.x+0,a.y=a.y+0,o.push(l)}return o}function transformString(e,t){return!e.endsWith(\\\"px\\\")&&e.endsWith(\\\"%\\\")&&t?parseInt(e,10)/100*t:parseInt(e,10)}function dealPercentCalc(e,i,r){e&&e.forEachChildren(e=>{var t;e&&(isObject_default(e.attribute.width)&&e.attribute.width.percent&&e.setAttribute(\\\"width\\\",Math.max(0,e.attribute.width.percent/100*i+(null!=(t=e.attribute.width.delta)?t:0))),e.attribute.width<0&&e.setAttribute(\\\"width\\\",0),isObject_default(e.attribute.height)&&e.attribute.height.percent&&e.setAttribute(\\\"height\\\",Math.max(0,e.attribute.height.percent/100*r+(null!=(t=e.attribute.height.delta)?t:0))),e.attribute.height<0&&e.setAttribute(\\\"height\\\",0),\\\"group\\\"===e.type)&&dealPercentCalc(e,e.attribute.width,e.attribute.height)})}function decodeReactDom(e,i){if(!e||!isValid_default(e.$$typeof)&&!isValid_default(e.vtype))return e;let t=e.type,{attribute:r,children:o,stateProxy:n,animation:a}=e.props,l=t({attribute:r});if(parseToGraphic(l,e.props),n&&(l.stateProxy=n),l.id=r.id,l.name=r.name,isArray_default(o)?o.forEach(e=>{var t=decodeReactDom(e,i);t&&t.type&&l.add(t)}):o&&l.add(decodeReactDom(o,i)),isArray_default(a)&&i){const s=l.animate();s.setTimeline(i),a.forEach(e=>{s[e[0]](...e.slice(1))})}return l}function parseToGraphic(i,r){let e=!1;switch(i.type){case\\\"richtext\\\":case\\\"rich/image\\\":break;default:e=!0}e&&Object.keys(r).forEach(e=>{var t=REACT_TO_CANOPUS_EVENTS[e];t&&i.on(t,r[e])})}function bindAttributeUpdate(e,i,r,o,n){e&&(e.name=`${CUSTOM_MERGE_PRE_NAME}${null!=n?n:\\\"\\\"}_`+o,e.onBeforeAttributeUpdate=onBeforeAttributeUpdate,\\\"group\\\"===e.type)&&e.childrenCount&&e.forEachChildren((e,t)=>{bindAttributeUpdate(e,i,r,t,(null!=n?n:\\\"\\\")+\\\"_\\\"+o)})}function onBeforeAttributeUpdate(i,e){if(!this.skipMergeUpdate){var r=getTargetCell(this);if(r&&r.stage){var o=r.stage.table,{mergeStartCol:n,mergeEndCol:a,mergeStartRow:l,mergeEndRow:s}=(this.skipAttributeUpdate=!0,r);if(isValid_default(n)&&isValid_default(a)&&isValid_default(l)&&isValid_default(s)&&(n!==a||l!==s)){for(let t=n;t<=a;t++)for(let e=l;e<=s;e++)if(t!==r.col||e!==r.row){var h=o.scenegraph.highPerformanceGetCell(t,e);if(\\\"cell\\\"===h.role){var d=h.getChildByName(this.name,!0);if(d&&!d.skipAttributeUpdate)for(const u in i)i[u]!==d.attribute[u]&&\\\"dx\\\"!==u&&\\\"dy\\\"!==u&&d.setAttribute(u,i[u])}}this.skipAttributeUpdate=void 0}}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var sort_color,sort_color_opacity,sort_color_2,sort_color_opacity_2,sort_size,sort_size_2,frozen_color,frozen_color_opacity,freeze_color_opacity,frozen_color_2,frozen_color_opacity_2,frozen_size,frozen_size_2,collapse_color,collapse_color_opacity,collapse_size,collapse_size_2,expand_color,expand_color_opacity,expand_size,expand_size_2,dragReorder_color,dragReorder_color_opacity,dragReorder_size,icons={},IconCache=class{static setIcon(e,t){this.cache.set(e,t)}static getIcon(e){return this.cache.has(e)?this.cache.get(e):null}static hasIcon(e){return this.cache.has(e)}static clear(e){return this.cache[\\\"delete\\\"](e)}static clearAll(){this.cache=new Map}};function setIconColor(e){var t;sort_color=null!=(t=null==e?void 0:e.sort_color)?t:\\\"#282F38\\\",sort_color_opacity=null!=(t=null==e?void 0:e.sort_color_opacity)?t:\\\"0.35\\\",sort_color_2=null!=(t=null==e?void 0:e.sort_color_2)?t:\\\"#416EFF\\\",sort_color_opacity_2=null!=(t=null==e?void 0:e.sort_color_opacity_2)?t:\\\"1\\\",sort_size=null!=(t=null==e?void 0:e.sort_size)?t:16,sort_size_2=null!=(t=null==e?void 0:e.sort_size_2)?t:22,frozen_color=null!=(t=null==e?void 0:e.frozen_color)?t:\\\"#282F38\\\",frozen_color_opacity=null!=(t=null==e?void 0:e.frozen_color_opacity)?t:\\\"0.35\\\",freeze_color_opacity=null!=(t=null==e?void 0:e.frozen_color_opacity)?t:\\\"0.2\\\",frozen_color_2=null!=(t=null==e?void 0:e.frozen_color_2)?t:\\\"#416EFF\\\",frozen_color_opacity_2=null!=(t=null==e?void 0:e.frozen_color_opacity_2)?t:\\\"1\\\",frozen_size=null!=(t=null==e?void 0:e.frozen_size)?t:22,frozen_size_2=null!=(t=null==e?void 0:e.frozen_size_2)?t:22,collapse_color=null!=(t=null==e?void 0:e.collapse_color)?t:\\\"#141414\\\",collapse_color_opacity=null!=(t=null==e?void 0:e.collapse_color_opacity)?t:\\\"0.65\\\",collapse_size=null!=(t=null==e?void 0:e.collapse_size)?t:16,collapse_size_2=null!=(t=null==e?void 0:e.frozen_size_2)?t:22,expand_color=null!=(t=null==e?void 0:e.expand_color)?t:\\\"#141414\\\",expand_color_opacity=null!=(t=null==e?void 0:e.expand_color_opacity)?t:\\\"0.65\\\",expand_size=null!=(t=null==e?void 0:e.expand_size)?t:16,expand_size_2=null!=(t=null==e?void 0:e.expand_size_2)?t:22,dragReorder_color=null!=(t=null==e?void 0:e.dragReorder_color)?t:\\\"#666666\\\",dragReorder_color_opacity=null!=(t=null==e?void 0:e.dragReorder_color_opacity)?t:\\\"1\\\",dragReorder_size=null!=(t=null==e?void 0:e.dragReorder_size)?t:20}IconCache.cache=new Map;var builtins={get sort_downward(){return{type:\\\"svg\\\",svg:`<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"> <path d=\\\"M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z\\\" fill=\\\"${sort_color_2}\\\"  fill-opacity=\\\"${sort_color_opacity_2}\\\"/><path d=\\\"M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z\\\" fill=\\\"${sort_color}\\\" fill-opacity=\\\"${sort_color_opacity}\\\"/></svg> `,width:sort_size,height:sort_size,funcType:IconFuncTypeEnum.sort,name:\\\"sort_downward\\\",positionType:IconPosition.contentRight,marginLeft:3,hover:{width:sort_size_2,height:sort_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get sort_upward(){return{type:\\\"svg\\\",svg:`<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z\\\" fill=\\\"${sort_color}\\\"  fill-opacity=\\\"${sort_color_opacity}\\\"/><path d=\\\"M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z\\\" fill=\\\"${sort_color_2}\\\"  fill-opacity=\\\"${sort_color_opacity_2}\\\"/> </svg>`,width:sort_size,height:sort_size,funcType:IconFuncTypeEnum.sort,positionType:IconPosition.contentRight,name:\\\"sort_upward\\\",marginLeft:3,hover:{width:sort_size_2,height:sort_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get sort_normal(){return{type:\\\"svg\\\",svg:`<svg width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z\\\" fill=\\\"${sort_color}\\\" fill-opacity=\\\"${sort_color_opacity}\\\"/><path d=\\\"M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z\\\" fill=\\\"${sort_color}\\\" fill-opacity=\\\"${sort_color_opacity}\\\"/></svg> `,width:sort_size,height:sort_size,funcType:IconFuncTypeEnum.sort,positionType:IconPosition.contentRight,name:\\\"sort_normal\\\",marginLeft:3,hover:{width:sort_size_2,height:sort_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get freeze(){return{type:\\\"svg\\\",svg:`<svg width=\\\"22\\\" height=\\\"22\\\" viewBox=\\\"0 0 22 22\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><g clip-path=\\\"url(#clip0)\\\"><path d=\\\"M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z\\\" fill=\\\"${frozen_color}\\\" fill-opacity=\\\"${freeze_color_opacity}\\\"/></g><defs><clipPath id=\\\"clip0\\\"><rect width=\\\"22\\\" height=\\\"22\\\" fill=\\\"white\\\"/></clipPath></defs></svg>`,width:frozen_size,height:frozen_size,name:\\\"freeze\\\",funcType:IconFuncTypeEnum.frozen,positionType:IconPosition.right,marginRight:0,hover:{width:frozen_size_2,height:frozen_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get frozen(){return{type:\\\"svg\\\",svg:`<svg width=\\\"22\\\" height=\\\"22\\\" viewBox=\\\"0 0 22 22\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z\\\" fill=\\\"${frozen_color}\\\" fill-opacity=\\\"${frozen_color_opacity}\\\"/></svg>`,width:frozen_size,height:frozen_size,name:\\\"frozen\\\",funcType:IconFuncTypeEnum.frozen,positionType:IconPosition.right,marginRight:0,hover:{width:frozen_size_2,height:frozen_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get frozenCurrent(){return{type:\\\"svg\\\",svg:`<svg width=\\\"22\\\" height=\\\"22\\\" viewBox=\\\"0 0 22 22\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z\\\"  fill=\\\"${frozen_color_2}\\\" fill-opacity=\\\"${frozen_color_opacity_2}\\\"/></svg>`,width:frozen_size,height:frozen_size,funcType:IconFuncTypeEnum.frozen,positionType:IconPosition.right,name:\\\"frozenCurrent\\\",marginRight:0,hover:{width:frozen_size_2,height:frozen_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get dropdownIcon(){return{type:\\\"svg\\\",svg:'<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><g><rect x=\\\"2\\\" y=\\\"1\\\" width=\\\"20\\\" height=\\\"20\\\" rx=\\\"10\\\" fill=\\\"white\\\"/><rect x=\\\"2.5\\\" y=\\\"1.5\\\" width=\\\"19\\\" height=\\\"19\\\" rx=\\\"9.5\\\" stroke=\\\"#959DA5\\\"/></g><path d=\\\"M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z\\\" fill=\\\"#4F5965\\\"/></svg>',width:24,height:24,funcType:IconFuncTypeEnum.dropDown,positionType:IconPosition.absoluteRight,name:\\\"dropdownIcon\\\",marginRight:0,hover:{width:24,height:24,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\",image:'<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><g><rect x=\\\"2\\\" y=\\\"1\\\" width=\\\"20\\\" height=\\\"20\\\" rx=\\\"10\\\" fill=\\\"#1E54C9\\\"/><rect x=\\\"2.5\\\" y=\\\"1.5\\\" width=\\\"19\\\" height=\\\"19\\\" rx=\\\"9.5\\\" stroke=\\\"#141414\\\" stroke-opacity=\\\"0.2\\\"/></g><path d=\\\"M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z\\\" fill=\\\"white\\\"/></svg>'},cursor:\\\"pointer\\\",visibleTime:\\\"mouseenter_cell\\\"}},get play(){return{type:\\\"svg\\\",svg:'<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 48 48\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><rect width=\\\"48\\\" height=\\\"48\\\" fill=\\\"white\\\" fill-opacity=\\\"0.01\\\" /><path d=\\\"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z\\\" fill=\\\"none\\\" stroke=\\\"#686a6e\\\" stroke-width=\\\"4\\\" stroke-linejoin=\\\"round\\\" stroke-opacity=\\\"0.7\\\" /><path d=\\\"M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z\\\" fill=\\\"none\\\" stroke=\\\"#686a6e\\\" stroke-width=\\\"4\\\" stroke-linejoin=\\\"round\\\" stroke-opacity=\\\"0.7\\\" /></svg>',width:24,height:24,funcType:IconFuncTypeEnum.play,positionType:IconPosition.right,name:\\\"play\\\",marginRight:0,hover:{width:24,height:24,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get damage_pic(){return{type:\\\"svg\\\",svg:'<svg width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 48 48\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><path d=\\\"M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z\\\" fill=\\\"none\\\" stroke=\\\"#333\\\" stroke-width=\\\"4\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/><path d=\\\"M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z\\\" fill=\\\"none\\\" stroke=\\\"#333\\\" stroke-width=\\\"4\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z\\\" fill=\\\"none\\\" stroke=\\\"#333\\\" stroke-width=\\\"4\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/></svg>',width:24,height:24,funcType:IconFuncTypeEnum.damagePic,positionType:IconPosition.left,name:\\\"damage_pic\\\",marginRight:0,hover:{width:24,height:24,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get loading_pic(){return{type:\\\"svg\\\",svg:'<svg viewBox=\\\"0 0 400 300\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><mask id=\\\"a\\\" style=\\\"mask-type:alpha\\\" maskUnits=\\\"userSpaceOnUse\\\" x=\\\"50\\\" y=\\\"65\\\" width=\\\"301\\\" height=\\\"170\\\"><path d=\\\"M350.3 65H50v169.8h300.3V65Z\\\" fill=\\\"#fff\\\"/></mask><g mask=\\\"url(#a)\\\"><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M58.3 233.2h32.8v-36.8H58.3v36.8Z\\\" fill=\\\"#C7DEFF\\\"/><path d=\\\"M91.1 224.5v8.8H58.3M82.4 196.2H58.3\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z\\\" fill=\\\"#00E4E5\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z\\\" fill=\\\"#00E4E5\\\"/><path d=\\\"M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z\\\" fill=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z\\\" fill=\\\"#C7DEFF\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z\\\" fill=\\\"#fff\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z\\\" fill=\\\"#fff\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z\\\" fill=\\\"#C7DEFF\\\"/><path d=\\\"m337 74.2-30.6 129.2h-5.9\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z\\\" fill=\\\"#C7DEFF\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z\\\" fill=\\\"#006EFF\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z\\\" fill=\\\"#006EFF\\\"/><path d=\\\"M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M148.3 138.1h97V119h-97v19.1Z\\\" fill=\\\"#00E4E5\\\"/><path d=\\\"M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z\\\" fill=\\\"#C7DEFF\\\"/><path d=\\\"M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3\\\" stroke=\\\"#071F4D\\\"/><path d=\\\"M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5\\\" stroke=\\\"#071F4D\\\"/><path d=\\\"M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1\\\" stroke=\\\"#C7DEFF\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z\\\" fill=\\\"#C7DEFF\\\"/><path d=\\\"M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6\\\" stroke=\\\"#071F4D\\\"/><path d=\\\"M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1\\\" stroke=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z\\\" fill=\\\"#071F4D\\\"/><path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z\\\" fill=\\\"#fff\\\"/><path d=\\\"M273.2 195.9h16.9M261.2 195.9h5\\\" stroke=\\\"#fff\\\"/><path d=\\\"M62.4 201.9v2.9M62.4 224.5v2.9\\\" stroke=\\\"#071F4D\\\"/><path d=\\\"m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1\\\" stroke=\\\"#fff\\\"/><path d=\\\"M148.3 138.1h121.6V119H148.3v19.1Z\\\" stroke=\\\"#071F4D\\\"/></g></svg>',width:400,height:300,name:\\\"loading_pic\\\",positionType:IconPosition.left}},get expand(){return{type:\\\"svg\\\",svg:`<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\">\\n      <path d=\\\"M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z\\\" fill=\\\"${expand_color}\\\" fill-opacity=\\\"${expand_color_opacity}\\\"/>\\n      </svg>`,width:expand_size,height:expand_size,funcType:IconFuncTypeEnum.expand,name:\\\"expand\\\",positionType:IconPosition.contentLeft,marginLeft:0,marginRight:4,hover:{width:expand_size_2,height:expand_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get collapse(){return{type:\\\"svg\\\",svg:`<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 16 16\\\" fill=\\\"none\\\">\\n      <path d=\\\"M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z\\\"  fill=\\\"${collapse_color}\\\" fill-opacity=\\\"${collapse_color_opacity}\\\"/>\\n      </svg>`,width:collapse_size,height:collapse_size,funcType:IconFuncTypeEnum.collapse,name:\\\"collapse\\\",positionType:IconPosition.contentLeft,marginLeft:0,marginRight:4,hover:{width:collapse_size_2,height:collapse_size_2,bgColor:\\\"rgba(101, 117, 168, 0.1)\\\"},cursor:\\\"pointer\\\"}},get drillDown(){return{name:\\\"drillDown\\\",type:\\\"svg\\\",positionType:IconPosition.absolute,funcType:IconFuncTypeEnum.drillDown,svg:DrillDown,width:13,height:13,cursor:\\\"pointer\\\"}},get drillUp(){return{name:\\\"drillUp\\\",type:\\\"svg\\\",positionType:IconPosition.absolute,funcType:IconFuncTypeEnum.drillUp,svg:DrillUp,width:13,height:13,cursor:\\\"pointer\\\"}},get dragReorder(){return{type:\\\"svg\\\",svg:`<svg t=\\\"1710129136961\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"5166\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5167\\\"></path><path d=\\\"M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5168\\\"></path><path d=\\\"M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5169\\\"></path><path d=\\\"M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5170\\\"></path><path d=\\\"M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5171\\\"></path><path d=\\\"M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z\\\" fill=\\\"${dragReorder_color}\\\"  fill-opacity=\\\"${dragReorder_color_opacity}\\\" p-id=\\\"5172\\\"></path></svg>`,width:dragReorder_size,height:dragReorder_size,funcType:IconFuncTypeEnum.dragReorder,positionType:IconPosition.left,name:\\\"dragReorder\\\",marginLeft:-10,marginRight:10,cursor:\\\"grab\\\"}}};function get3(){return extend(builtins,icons)}init_esbuild_inject();var Group2=class extends Group{clear(){this.removeAllChild()}getChildByName(i,e){let r=null;return this.forEachChildren(e=>e.name===i&&(r=e,!0)),e&&this.forEachChildren(e=>{if(e.getChildByName){var t=e.getChildByName(i,!0);if(t)return r=t,!0}return!1}),r}get width(){let e,t=this.AABBBounds.width();return t!==1/0&&t!==-1/0||(t=0),Math.max(t,null!=(e=this.attribute.width)?e:0)}get height(){let e,t=this.AABBBounds.height();return t!==1/0&&t!==-1/0||(t=0),Math.max(t,null!=(e=this.attribute.height)?e:0)}setDeltaWidth(e){var t;0!==e&&(this.setAttribute(\\\"width\\\",(null!=(t=this.attribute.width)?t:0)+e),this.border)&&(this.border.setAttribute(\\\"width\\\",this.border.attribute.width+e),\\\"group\\\"===this.border.type)&&this.border.firstChild.setAttribute(\\\"width\\\",this.border.firstChild.attribute.width+e)}setDeltaHeight(e){var t;0!==e&&(this.setAttribute(\\\"height\\\",(null!=(t=this.attribute.height)?t:0)+e),this.border)&&(this.border.setAttribute(\\\"height\\\",this.border.attribute.height+e),\\\"group\\\"===this.border.type)&&this.border.firstChild.setAttribute(\\\"width\\\",this.border.firstChild.attribute.height+e)}setDeltaX(e){0!==e&&this.setAttribute(\\\"x\\\",this.attribute.x+e)}setDeltaY(e){0!==e&&this.setAttribute(\\\"y\\\",this.attribute.y+e)}forEachChildrenSkipChild(i,r=\\\"border-rect\\\",e=!1){if(e){let e=this._lastChild,t=0;for(;e;){if(e.name!==r&&i(e,t++))return;e=e._prev}}else{let e=this._firstChild,t=0;for(;e;){if(e.name!==r&&i(e,t++))return;e=e._next}}}getColGroup(t){let i=this._firstChild;if(i)for(let e=0;e<this.childrenCount;e++){if(i.col===t)return i;i=i._next}return null}getRowGroup(t){let i=this._firstChild;if(i)for(let e=0;e<this.childrenCount;e++){if(i.row===t)return i;i=i._next}return null}addCellGroup(i){if(0!==this.childrenCount&&this.lastChild.row!==i.row-1){let e=this._firstChild;for(let t=0;t<this.childrenCount;t++){if(e.row===i.row-1)return void this.insertAfter(i,e);e=e._next}}this.addChild(i)}getChildAt(e){var t=super.getChildAt(e);return t&&\\\"border-rect\\\"===t.name?t._next:t}tryUpdateAABBBounds(){var e,t;return\\\"cell\\\"===this.role?this.shouldUpdateAABBBounds()?(e=this.shouldSelfChangeUpdateAABBBounds(),t=this.doUpdateAABBBounds(),this.addUpdateLayoutTag(),after(this,e),t):this._AABBBounds:super.tryUpdateAABBBounds()}doUpdateAABBBounds(){var e,t,i,r;return\\\"cell\\\"===this.role?(({x:e,y:t,width:i,height:r}=this.attribute),this._AABBBounds.setValue(e,t,e+i,t+r),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):\\\"body\\\"===this.role||\\\"row-header\\\"===this.role||\\\"col-header\\\"===this.role||\\\"right-frozen\\\"===this.role||\\\"bottom-frozen\\\"===this.role||\\\"corner-header\\\"===this.role||\\\"corner-right-top-header\\\"===this.role||\\\"corner-right-bottom-header\\\"===this.role||\\\"corner-left-bottom-header\\\"===this.role?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(e){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,e):this.rowNumber=e}updateColumnHeight(e){this.colHeight?this.colHeight+=e:this.colHeight=e}};function after(e,t){e.stage&&e.stage.dirtyBounds&&e.stage.renderCount&&(e.isContainer&&!t||e.stage.dirty(e.globalAABBBounds))}function calcKeepAspectRatioSize(e,t,i,r){var o=e/t;let n,a,l,s;return i/r<o?(n=i,a=n/o,l=0,s=(r-a)/2):(a=r,n=a*o,s=0,l=(i-n)/2),{width:n,height:a}}function calcStartPosition(e,t,i,r,o,n,a=\\\"left\\\",l=\\\"middle\\\",s=[0,0,0,0],h=0,d=0,u=0,c=0){let g=e+s[3]+h,p=(\\\"right\\\"===a||\\\"end\\\"===a?g=e+i-o-s[1]-d:\\\"center\\\"===a&&(g=e+(i-o+h-d)/2),t+s[0]+u);return\\\"bottom\\\"===l||\\\"alphabetic\\\"===l||\\\"ideographic\\\"===l?p=t+r-n-s[2]-c:\\\"middle\\\"===l&&(p=t+(r-n+u-c)/2),{x:g,y:p}}function getProp2(e,t,i,r,o){var n=t&&isValid_default(t[e])?t[e]:void 0;return\\\"function\\\"==typeof n?n({col:i,row:r,table:o,value:o.getCellValue(i,r),dataValue:o.getCellOriginValue(i,r),cellHeaderPaths:o.getCellHeaderPaths(i,r)}):n}function getFunctionalProp(e,t,i,r,o){var n=t&&isValid_default(t[e])?t[e]:void 0;if(\\\"function\\\"==typeof n)return n({col:i,row:r,table:o,value:o.getCellValue(i,r),dataValue:o.getCellOriginValue(i,r),cellHeaderPaths:o.getCellHeaderPaths(i,r)})}function getCellBorderStrokeWidth(e,t,i,r){let o,n,a,l,s,h,d,u,c,g,p,f,m,b,C,v,y,w,_=null!=(n=null==(o=null==i?void 0:i.group)?void 0:o.strokeArrayWidth)?n:void 0;return r.theme.cellInnerBorder||!isValidStyle(r.theme.frameStyle.borderLineWidth)||isZeroStyle(r.theme.frameStyle.borderLineWidth)||(0===e&&((_=null!=_?_:[null==(a=null==i?void 0:i.group)?void 0:a.lineWidth,null==(l=null==i?void 0:i.group)?void 0:l.lineWidth,null==(s=null==i?void 0:i.group)?void 0:s.lineWidth,null==(h=null==i?void 0:i.group)?void 0:h.lineWidth])[3]=0),e===r.colCount-1&&((_=null!=_?_:[null==(d=null==i?void 0:i.group)?void 0:d.lineWidth,null==(u=null==i?void 0:i.group)?void 0:u.lineWidth,null==(c=null==i?void 0:i.group)?void 0:c.lineWidth,null==(g=null==i?void 0:i.group)?void 0:g.lineWidth])[1]=0),0===t&&((_=null!=_?_:[null==(p=null==i?void 0:i.group)?void 0:p.lineWidth,null==(f=null==i?void 0:i.group)?void 0:f.lineWidth,null==(m=null==i?void 0:i.group)?void 0:m.lineWidth,null==(b=null==i?void 0:i.group)?void 0:b.lineWidth])[0]=0),t===r.rowCount-1&&((_=null!=_?_:[null==(C=null==i?void 0:i.group)?void 0:C.lineWidth,null==(v=null==i?void 0:i.group)?void 0:v.lineWidth,null==(y=null==i?void 0:i.group)?void 0:y.lineWidth,null==(w=null==i?void 0:i.group)?void 0:w.lineWidth])[2]=0)),_}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var CellContent=class extends Group2{constructor(e){super(e),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new Group2({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role=\\\"content-left\\\",this._rightGroup=new Group2({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role=\\\"content-right\\\",this._centerGroup=new Group2({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role=\\\"content-center\\\",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(e){this._autoWidth=e.autoWidth,this._autoHeight=e.autoHeight,this._cellWidth=e.cellWidth,this._originCellWidth=e.cellWidth,this._cellHeight=e.cellHeight,this._align=e.align,this._baseline=e.baseline}addLeftOccupyingIcon(e){var t;e.setAttribute(\\\"x\\\",this._leftGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._leftGroup.appendChild(e),this._leftGroup.setDeltaWidth((null!=(t=e.attribute.marginLeft)?t:0)+(null!=(t=e.attribute.marginRight)?t:0)+e.attribute.width)}addRightOccupyingIcon(e){var t;e.setAttribute(\\\"x\\\",this._rightGroup.width+(null!=(t=e.attribute.marginLeft)?t:0)),this._rightGroup.appendChild(e),this._rightGroup.setDeltaWidth((null!=(t=e.attribute.marginLeft)?t:0)+(null!=(t=e.attribute.marginRight)?t:0)+e.attribute.width)}addContent(e){var t=this._centerGroup.lastChild;t&&e.setAttributes({x:t.attribute.x+t.AABBBounds.width()}),this._centerGroup.appendChild(e),e instanceof Text&&(this._centerGroup.setAttribute(\\\"pickable\\\",!1),e.setAttribute(\\\"textAlign\\\",\\\"left\\\"))}layout(){let e=this._leftGroup.width,t=(e===1/0&&(e=0),this._rightGroup.width);t===-1/0&&(t=0),this._autoWidth?(i=this._centerGroup.width,this._cellWidth=e+t+i):(i=this._cellWidth-e-t,this.updateCenterLayout(i),i=this._centerGroup.width,this._cellWidth=e+t+i),this.setAttribute(\\\"width\\\",this._cellWidth),this.updateHorizontalPos();var i=this._leftGroup.height,r=this._rightGroup.height,o=this._centerGroup.height;this._cellHeight=Math.max(i,r,o),this.setAttribute(\\\"height\\\",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(e){let t=e;this._centerGroup.forEachChildren(e=>{(e instanceof Icon||e instanceof TextIcon)&&(t-=e.AABBBounds.width())});var i=this._centerGroup.getChildByName(\\\"text\\\");i instanceof RichText?i.setAttribute(\\\"width\\\",t):i instanceof Text&&i.setAttribute(\\\"maxLineWidth\\\",t);let r=0;this._centerGroup.forEachChildren(e=>{e.setAttribute(\\\"x\\\",r),r+=e.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute(\\\"x\\\",0),this._rightGroup.setAttribute(\\\"x\\\",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute(\\\"x\\\",this._leftGroup.width),\\\"left\\\"===this._align||\\\"start\\\"===this._align?this.setAttribute(\\\"dx\\\",0):\\\"center\\\"===this._align?this.setAttribute(\\\"dx\\\",-this.attribute.width/2):\\\"right\\\"!==this._align&&\\\"end\\\"!==this._align||this.setAttribute(\\\"dx\\\",-this.attribute.width)}updateVerticalPos(){\\\"top\\\"===this._baseline?(this._leftGroup.setAttribute(\\\"y\\\",0),this._rightGroup.setAttribute(\\\"y\\\",0),this._centerGroup.setAttribute(\\\"y\\\",0)):\\\"middle\\\"===this._baseline?(this._leftGroup.forEachChildren(e=>{e.setAttribute(\\\"y\\\",(this._leftGroup.height-e.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(e=>{e.setAttribute(\\\"y\\\",(this._rightGroup.height-e.AABBBounds.height())/2)}),this._leftGroup.setAttribute(\\\"y\\\",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute(\\\"y\\\",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute(\\\"y\\\",this._cellHeight/2-this._centerGroup.height/2)):\\\"bottom\\\"===this._baseline&&(this._leftGroup.forEachChildren(e=>{e.setAttribute(\\\"y\\\",this._leftGroup.height-e.AABBBounds.height())}),this._rightGroup.forEachChildren(e=>{e.setAttribute(\\\"y\\\",this._rightGroup.height-e.AABBBounds.height())}),this._leftGroup.setAttribute(\\\"y\\\",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute(\\\"y\\\",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute(\\\"y\\\",this._cellHeight-this._centerGroup.height))}updateWidth(e){this._cellWidth=e,this._originCellWidth=e,this.layout()}updateHeight(e){this._cellHeight=e,this._cellWidth=this._originCellWidth;var t=this.getChildByName(\\\"text\\\",!0);t&&t.setAttribute(\\\"heightLimit\\\",e),this.layout()}};function getHierarchyOffset(t,i,r){let o=0;var n=r.internalProps.layoutMap;if(n.isHeader(t,i)){var a=n.getHeader(t,i);isValid_default(null==a?void 0:a.hierarchyLevel)&&(o=(null!=(a=a.hierarchyLevel)?a:0)*(\\\"tree\\\"===n.rowHierarchyType&&null!=(a=n.rowHierarchyIndent)?a:0),n.rowHierarchyTextStartAlignment)&&!r.internalProps.headerHelper.getHierarchyIcon(t,i)&&(o+=r.internalProps.headerHelper.getHierarchyIconWidth())}else if(r.options.groupBy||null!=(a=r.getBodyColumnDefine(t,i))&&a.tree){var a=r.dataSource.getIndexKey(r.getRecordShowIndexByCell(t,i)),l=null!=(l=r.dataSource.getGroupLength())?l:0;let e=isArray_default(a)?a.length-1:0;0<l&&e===l&&(e=0),o=Array.isArray(a)&&r.getHierarchyState(t,i)!==HierarchyState.none?e*(null!=(l=n.hierarchyIndent)?l:0):0,n.hierarchyTextStartAlignment&&!r.internalProps.bodyHelper.getHierarchyIcon(t,i)&&(o+=r.internalProps.bodyHelper.getHierarchyIconWidth())}return o}function breakString(e,t){let i,r,o,n=!1;for(isString_default(e)&&e.length>(t.options.maxCharactersNumber||200)&&(e=e.slice(0,t.options.maxCharactersNumber||200),e+=\\\"…\\\",n=!0),o=t.internalProps.enableLineBreak||null!=(i=t.options.customConfig)&&i.multilinesForXTable?convertInternal(e).replace(/\\\\r?\\\\n/g,\\\"\\\\n\\\").replace(/\\\\r/g,\\\"\\\\n\\\").split(\\\"\\\\n\\\")||[]:[convertInternal(e)];o.length&&1<o.length&&!o[o.length-1];)o.pop();if(null!=(r=t.options.customConfig)&&r.multilinesForXTable&&!t.internalProps.autoWrapText)for(;o.length&&1<o.length&&!o[0];)o.shift();return{text:o,moreThanMaxCharacters:n}}function createCellContent(i,e,r,o,n,a,l,s,h,d,u,c,g,p,f){let t,m,b,C,v,y,w,F,D,_,S,x=0,R=0,z=0;if(Array.isArray(e)&&0!==e.length){var{inlineFrontIcons:T,inlineEndIcons:A,contentLeftIcons:P,contentRightIcons:O,leftIconWidth:B,rightIconWidth:M,absoluteRightIconWidth:E}=dealWithIconLayout(e,i,f,g);let t;if(x=B,R=M,z=E,0===T.length&&0===A.length){let e=0;isNumber_default(g.theme._contentOffset)&&(\\\"left\\\"===u?e=g.theme._contentOffset:\\\"right\\\"===u&&(e=-g.theme._contentOffset));var B=f?getHierarchyOffset(f.start.col,f.start.row,g):getHierarchyOffset(i.col,i.row,g),{text:M,moreThanMaxCharacters:E}=breakString(r,g),E={text:1===M.length?M[0]:M,moreThanMaxCharacters:E,maxLineWidth:n?1/0:h-(o[1]+o[3])-x-R-B,textBaseline:\\\"top\\\",heightLimit:!1===(null==(C=g.options.customConfig)?void 0:C.limitContentHeight)||a&&(null==(v=g.options.customConfig)||!v.multilinesForXTable)?-1:d-Math.floor(o[0]+o[2]),pickable:!1,autoWrapText:l,lineClamp:s,wordBreak:\\\"break-word\\\",whiteSpace:!1===(null==(y=g.options.customConfig)?void 0:y.limitContentHeight)||1!==M.length||l?\\\"normal\\\":\\\"no-wrap\\\",dx:(\\\"left\\\"!==u||P.length?0:B)+e,keepCenterInLine:!0},M=new Text(p.text?Object.assign({},p.text,E):E);M.name=\\\"text\\\",t=M}else{B=Object.assign({text:null==r?void 0:r.toString()},(null==(D=null==(F=null==(w=i.parent)?void 0:w.theme)?void 0:F.userTheme)?void 0:D.text)||{}),E=(p.text&&Object.assign(B,p.text),B.textBaseline=\\\"middle\\\",[...T.map(e=>dealWithRichTextIcon(e)),B,...A.map(e=>dealWithRichTextIcon(e))]),M=(E[0].textAlign=u,new RichText({width:n?0:h-(o[1]+o[3])-x-R,height:a&&l?0:Math.ceil(d-(o[0]+o[2])),textConfig:E,verticalDirection:a&&l?\\\"top\\\":c,ellipsis:B.ellipsis}));M.name=\\\"text\\\",(t=M).bindIconEvent(),!f||f.start.col===f.end.col&&f.start.row===f.end.row||(M.onBeforeAttributeUpdate=onBeforeAttributeUpdate2)}if(0!==P.length||0!==O.length){const L=new CellContent({x:0,y:0,fill:!1,stroke:!1,pickable:!1}),k=(L.name=\\\"content\\\",L.setCellContentOption({autoWidth:n,autoHeight:a,cellWidth:h-(o[1]+o[3])-x-R,cellHeight:d-(o[0]+o[2]),align:u,baseline:c}),{addedHierarchyOffset:0});P.forEach(e=>{var t=dealWithIcon(e,void 0,i.col,i.row,f,g,k);t.role=\\\"icon-content-left\\\",t.name=e.name,L.addLeftOccupyingIcon(t)}),O.forEach(e=>{var t=dealWithIcon(e,void 0,i.col,i.row,f,g,k);t.role=\\\"icon-content-right\\\",t.name=e.name,L.addRightOccupyingIcon(t)}),L.addContent(t),i.appendChild(L),L.layout(),_=L.AABBBounds.width(),S=L.AABBBounds.height()}else i.firstChild?i.insertBefore(t,i.firstChild):i.appendChild(t),_=t.AABBBounds.width(),S=t.AABBBounds.height()}else if(isValid_default(r)){var{text:T,moreThanMaxCharacters:A}=breakString(r,g),E=f?getHierarchyOffset(f.start.col,f.start.row,g):getHierarchyOffset(i.col,i.row,g);let e=0;isNumber_default(g.theme._contentOffset)&&(\\\"left\\\"===u?e=g.theme._contentOffset:\\\"right\\\"===u&&(e=-g.theme._contentOffset));B={text:1===T.length?T[0]:T,moreThanMaxCharacters:A,maxLineWidth:n?1/0:h-(o[1]+o[3]+E),textBaseline:\\\"top\\\",autoWrapText:l,lineClamp:s,wordBreak:\\\"break-word\\\",heightLimit:!1===(null==(t=g.options.customConfig)?void 0:t.limitContentHeight)||a&&(null==(m=g.options.customConfig)||!m.multilinesForXTable)?-1:d-Math.floor(o[0]+o[2]),pickable:!1,dx:(\\\"left\\\"===u?E:0)+e,whiteSpace:!1===(null==(b=g.options.customConfig)?void 0:b.limitContentHeight)||1!==T.length||l?\\\"normal\\\":\\\"no-wrap\\\",keepCenterInLine:!0},M=new Text(p.text?Object.assign({},p.text,B):B);M.name=\\\"text\\\",M.textBaseline=c,i.appendChild(M),_=M.AABBBounds.width(),S=M.AABBBounds.height()}const H=n?x+_+R:h-(o[1]+o[3]),I=d-(o[0]+o[2]);i.forEachChildren(e=>{\\\"icon-left\\\"===e.role?e.setAttribute(\\\"x\\\",e.attribute.x+o[3]):\\\"icon-right\\\"===e.role?e.setAttribute(\\\"x\\\",e.attribute.x+H-R+o[3]):\\\"icon-absolute-right\\\"===e.role?e.setAttribute(\\\"x\\\",e.attribute.x+H-z+o[3]+o[1]):\\\"content\\\"!==e.name&&\\\"text\\\"!==e.name||(\\\"center\\\"===u&&\\\"richtext\\\"!==e.type?e.setAttribute(\\\"x\\\",o[3]+x+(H-x-R)/2):\\\"right\\\"===u&&\\\"richtext\\\"!==e.type?e.setAttribute(\\\"x\\\",o[3]+H-R):e.setAttribute(\\\"x\\\",o[3]+x))}),i.forEachChildren(e=>{e.name!==CUSTOM_CONTAINER_NAME&&(\\\"middle\\\"===c?e.setAttribute(\\\"y\\\",o[0]+(I-e.AABBBounds.height())/2):\\\"bottom\\\"===c?e.setAttribute(\\\"y\\\",o[0]+I-e.AABBBounds.height()):e.setAttribute(\\\"y\\\",o[0]))}),i.setAttributes({width:H+o[1]+o[3],height:I+o[0]+o[2]})}function dealWithIcon(e,t,i,r,o,n,a){var l,s={};\\\"image\\\"===e.type?(e.isGif&&(s.gif=e.src),s.image=e.src):(\\\"svg\\\"===e.type||\\\"svg\\\"in e)&&(s.image=e.svg),s.width=e.width,s.height=e.height,s.visibleTime=null!=(l=e.visibleTime)?l:\\\"always\\\",s.funcType=e.funcType,s.interactive=e.interactive,s.isGif=e.isGif;let h,d=0;return a&&0!==(null==a?void 0:a.addedHierarchyOffset)||!isNumber_default(i)||!isNumber_default(r)||!n||e.funcType!==IconFuncTypeEnum.collapse&&e.funcType!==IconFuncTypeEnum.expand&&e.positionType!==IconPosition.contentLeft&&e.positionType!==IconPosition.contentRight||(d=o?getHierarchyOffset(o.start.col,o.start.row,n):getHierarchyOffset(i,r,n),a&&(a.addedHierarchyOffset=1)),s.marginLeft=(null!=(l=e.marginLeft)?l:0)+d,s.marginRight=null!=(l=e.marginRight)?l:0,!1===e.interactive&&(s.pickable=!1),e.hover&&(s.backgroundWidth=null!=(l=e.hover.width)?l:e.width,s.backgroundHeight=null!=(l=e.hover.width)?l:e.width,s.backgroundColor=null!=(l=e.hover.bgColor)?l:\\\"rgba(22,44,66,0.2)\\\",s.hoverImage=e.hover.image),e.cursor&&(s.cursor=e.cursor),\\\"shape\\\"in e&&\\\"circle\\\"===e.shape&&(s.shape=e.shape),t?(t.setAttributes(s),t.loadImage(s.image),t.tooltip=e.tooltip,t.name=e.name,t):((h=new(\\\"text\\\"===e.type?(s.text=e.content,merge(s,e.style),TextIcon):Icon)(s)).tooltip=e.tooltip,h.name=e.name,h)}function dealWithRichTextIcon(e){var t,i={};return\\\"image\\\"===e.type?i.image=e.src:(\\\"svg\\\"===e.type||\\\"svg\\\"in e)&&(i.image=e.svg),i.visibleTime=null!=(t=e.visibleTime)?t:\\\"always\\\",i.funcType=e.funcType,i.id=e.name,i.width=e.width,i.height=e.height,(e.marginRight||e.marginLeft)&&(i.margin=[0,null!=(t=e.marginRight)?t:0,0,null!=(t=e.marginLeft)?t:0]),e.hover&&(i.backgroundWidth=null!=(t=e.hover.width)?t:e.width,i.backgroundHeight=null!=(t=e.hover.height)?t:e.height,i.backgroundShowMode=\\\"hover\\\",i.hoverImage=e.hover.image,i.backgroundStroke=!1,i.backgroundFill=null!=(t=e.hover.bgColor)?t:\\\"rgba(22,44,66,0.2)\\\"),e.cursor&&(i.cursor=e.cursor),i.tooltip=e.tooltip,i}function updateCellContentWidth(i,r,o,n,e,a,l,s,h){isValidNumber_default(i.contentWidth)&&(n=r-(null!=(p=i.contentWidth)?p:i.attribute.width));let t,d=0,u=0,c=0,g=0;i.forEachChildren(e=>{var t;\\\"icon-left\\\"===e.role?(d+=e.AABBBounds.width()+(null!=(t=e.attribute.marginLeft)?t:0)+(null!=(t=e.attribute.marginRight)?t:0),u=Math.max(u,e.AABBBounds.height())):\\\"icon-right\\\"===e.role&&(c+=e.AABBBounds.width()+(null!=(t=e.attribute.marginLeft)?t:0)+(null!=(t=e.attribute.marginRight)?t:0),g=Math.max(g,e.AABBBounds.height()))});var p=i.getChildByName(\\\"text\\\"),f=i.getChildByName(\\\"content\\\");let m;p instanceof Text?(t=p.AABBBounds.height(),p.setAttribute(\\\"maxLineWidth\\\",r-d-c-(a[1]+a[3])-(null!=(b=p.attribute.dx)?b:0)-(null!=(b=h.table.theme._contentOffset)?b:0)),m=p.AABBBounds.height()):p instanceof RichText?(t=p.AABBBounds.height(),p.setAttribute(\\\"width\\\",r-d-c-(a[1]+a[3])),m=p.AABBBounds.height()):f&&(t=f.AABBBounds.height(),f.updateWidth(r-d-c-(a[1]+a[3])),m=f.AABBBounds.height());var b=Math.round(Math.max(u,g,t)+a[0]+a[2]);if(i.forEachChildren(e=>{var t;\\\"icon-left\\\"!==e.role&&(\\\"icon-right\\\"===e.role||\\\"icon-absolute-right\\\"===e.role?e.setAttribute(\\\"x\\\",e.attribute.x+n):\\\"content\\\"===e.name||\\\"text\\\"===e.name&&\\\"richtext\\\"!==e.type?\\\"center\\\"===(t=null!=(t=e.attribute.textAlign)?t:l)?e.setAttribute(\\\"x\\\",a[3]+d+(r-(a[1]+a[3])-d-c)/2):\\\"right\\\"===t&&e.setAttribute(\\\"x\\\",a[3]+r-(a[1]+a[3])-c):\\\"mark\\\"===e.name&&e.setAttribute(\\\"x\\\",i.attribute.width))}),e){let t=Math.max(u,m,g);if(isCellHeightUpdate(h,i,Math.round(t+a[0]+a[2]),b))return!0;t=(null!=(p=i.contentHeight)?p:o)-(a[0]+a[2]),i.forEachChildren(e=>{\\\"rect\\\"!==e.type&&\\\"chart\\\"!==e.type&&e.name!==CUSTOM_CONTAINER_NAME&&(\\\"mark\\\"===e.name?e.setAttribute(\\\"y\\\",0):\\\"middle\\\"===s?e.setAttribute(\\\"y\\\",a[0]+(t-e.AABBBounds.height())/2):\\\"bottom\\\"===s?e.setAttribute(\\\"y\\\",a[0]+t-e.AABBBounds.height()):e.setAttribute(\\\"y\\\",a[0]))})}else\\\"middle\\\"!==s&&\\\"bottom\\\"!==s||i.forEachChildren(e=>{\\\"rect\\\"!==e.type&&\\\"chart\\\"!==e.type&&e.name!==CUSTOM_CONTAINER_NAME&&(\\\"mark\\\"===e.name?e.setAttribute(\\\"y\\\",0):\\\"middle\\\"===s?e.setAttribute(\\\"y\\\",(o-a[2]+a[0]-e.AABBBounds.height())/2):\\\"bottom\\\"===s?e.setAttribute(\\\"y\\\",o-e.AABBBounds.height()-a[2]):e.setAttribute(\\\"y\\\",a[0]))});return!1}function updateCellContentHeight(e,t,i,r,o,n,a,l){var s;const h=t-Math.floor(o[0]+o[2]),d=e.getChildByName(\\\"text\\\");d instanceof Text&&!r?d.setAttributes({heightLimit:!1===(null==(s=l.options.customConfig)?void 0:s.limitContentHeight)?-1:h}):d instanceof RichText&&!r?d.setAttributes({height:h}):e.getChildByName(\\\"content\\\")&&e.getChildByName(\\\"content\\\").updateHeight(h),e.forEachChildren(e=>{e.setAttribute(\\\"dy\\\",0),\\\"rect\\\"!==e.type&&\\\"chart\\\"!==e.type&&e.name!==CUSTOM_CONTAINER_NAME&&(\\\"mark\\\"===e.name?e.setAttribute(\\\"y\\\",0):\\\"middle\\\"===a?e.setAttribute(\\\"y\\\",o[0]+(h-e.AABBBounds.height())/2):\\\"bottom\\\"===a?e.setAttribute(\\\"y\\\",o[0]+h-e.AABBBounds.height()):e.setAttribute(\\\"y\\\",o[0]))})}function isCellHeightUpdate(e,t,i,r){var o=e.table,n=getCellMergeInfo(o,t.col,t.row);if(n&&n.end.row-n.start.row){r/=n.end.row-n.start.row+1,i/=n.end.row-n.start.row+1;for(let e=n.start.row;e<=n.end.row;e++){var a=o.getRowHeight(e);if(a===r&&i!==a)return!0;if(a<i)return!0}}else{var l=o.getRowHeight(t.row);if(l===r&&i!==l)return!0;if(l<i)return!0}return!1}function dealWithIconLayout(e,r,o,n){const t=[],i=[],a=[],l=[],s=[],h=[],d=[],u=[];let c=0,g=0,p=0,f=0,m=0,b=0;return e.forEach(e=>{switch(e.positionType){case IconPosition.left:t.push(e);break;case IconPosition.right:i.push(e);break;case IconPosition.contentLeft:a.push(e);break;case IconPosition.contentRight:l.push(e);break;case IconPosition.absoluteRight:u.push(e);break;case IconPosition.inlineFront:s.push(e);break;case IconPosition.inlineEnd:h.push(e)}}),t.forEach(e=>{var t,i=dealWithIcon(e,void 0,r.col,r.row,o,n);i.role=\\\"icon-left\\\",i.name=e.name,i.setAttribute(\\\"x\\\",c+(null!=(t=i.attribute.marginLeft)?t:0)),c+=i.AABBBounds.width()+(null!=(t=i.attribute.marginLeft)?t:0)+(null!=(t=i.attribute.marginRight)?t:0),g=Math.max(g,i.AABBBounds.height()),r.appendChild(i)}),i.forEach(e=>{var t,i=dealWithIcon(e,void 0,r.col,r.row,o,n);i.role=\\\"icon-right\\\",i.name=e.name,i.setAttribute(\\\"x\\\",p+(null!=(t=i.attribute.marginLeft)?t:0)),p+=i.AABBBounds.width()+(null!=(t=i.attribute.marginLeft)?t:0)+(null!=(t=i.attribute.marginRight)?t:0),f=Math.max(f,i.AABBBounds.height()),r.appendChild(i)}),d.forEach(e=>{var t,i=dealWithIcon(e,void 0,r.col,r.row,o,n);i.role=\\\"icon-absolute-left\\\",i.name=e.name,i.setAttribute(\\\"x\\\",m+(null!=(t=i.attribute.marginLeft)?t:0)),m+=i.AABBBounds.width()+(null!=(t=i.attribute.marginLeft)?t:0)+(null!=(t=i.attribute.marginRight)?t:0),r.appendChild(i)}),u.forEach(e=>{var t,i=dealWithIcon(e,void 0,r.col,r.row,o,n);i.role=\\\"icon-absolute-right\\\",i.name=e.name,i.setAttribute(\\\"x\\\",b+(null!=(t=i.attribute.marginLeft)?t:0)),b+=i.AABBBounds.width()+(null!=(t=i.attribute.marginLeft)?t:0)+(null!=(t=i.attribute.marginRight)?t:0),r.appendChild(i)}),{leftIcons:t,rightIcons:i,contentLeftIcons:a,contentRightIcons:l,inlineFrontIcons:s,inlineEndIcons:h,absoluteLeftIcons:d,absoluteRightIcons:u,leftIconWidth:c,leftIconHeight:g,rightIconWidth:p,rightIconHeight:f,absoluteLeftIconWidth:m,absoluteRightIconWidth:b}}function onBeforeAttributeUpdate2(i,e){if(i.hasOwnProperty(\\\"hoverIconId\\\"))if(!this.skipMergeUpdate){var r=getTargetCell(this);if(r&&r.stage){var o,n,a=r.stage.table,{mergeStartCol:l,mergeEndCol:s,mergeStartRow:h,mergeEndRow:d}=(this.skipAttributeUpdate=!0,r);if(isValid_default(l)&&isValid_default(s)&&isValid_default(h)&&isValid_default(d)&&(l!==s||h!==d)){for(let t=l;t<=s;t++)for(let e=h;e<=d;e++)t===r.col&&e===r.row?i.hoverIconId!==this.attribute.hoverIconId&&(o=this._frameCache.icons.get(i.hoverIconId),this.updateHoverIconState(o)):\\\"cell\\\"===(o=a.scenegraph.highPerformanceGetCell(t,e)).role&&(n=o.getChildByName(this.name,!0))&&!n.skipAttributeUpdate&&i.hoverIconId!==n.attribute.hoverIconId&&(n.setAttribute(\\\"hoverIconId\\\",i.hoverIconId),o.addUpdateBoundTag());this.skipAttributeUpdate=void 0}}}}function updateImageCellContentWhileResize(u,t,c,g,e,p){var f=u.getChildByName(\\\"image\\\");if(f){var m=\\\"string\\\"!=typeof f.attribute.image&&f.attribute.image||(null==(m=f.resources)?void 0:m.get(f.attribute.image).data);if(m){const T=p._getCellStyle(t,c),A=null!=(_=getProp2(\\\"textAlign\\\",T,t,c,p))?_:\\\"left\\\",P=null!=(_=getProp2(\\\"textBaseline\\\",T,t,c,p))?_:\\\"middle\\\";let i,{width:r,height:o,isMerge:e}=(i=null!=(_=p.options.customConfig)&&_.imageMargin?getQuadProps(null==(_=p.options.customConfig)?void 0:_.imageMargin):null!=(_=getQuadProps(getProp2(\\\"padding\\\",T,t,c,p)))?_:[0,0,0,0],getCellRange(u,p)),n=null!=(_=u.mergeStartCol)?_:u.col,a=null!=(_=u.mergeStartRow)?_:u.row,l=null!=(_=u.mergeEndCol)?_:u.col,s=null!=(_=u.mergeEndCol)?_:u.row,h=null!=(_=u._cellLeftIconWidth)?_:0,d=null!=(_=u._cellRightIconWidth)?_:0;if(f.keepAspectRatio){var{width:b,height:C}=calcKeepAspectRatioSize(m.width||m.videoWidth,m.height||m.videoHeight,r-(i[1]+i[3]),o-(i[0]+i[2])),v=calcStartPosition(0,0,r,o,b,C,A,P,i);for(let t=n;t<=l;t++)for(let e=a;e<=s;e++){var y=p.scenegraph.getCell(t,e).getChildByName(\\\"image\\\");null!=y&&y.setAttributes({x:v.x,y:v.y,width:b,height:C})}}else for(let t=n;t<=l;t++)for(let e=a;e<=s;e++){var w=p.scenegraph.getCell(t,e).getChildByName(\\\"image\\\");null!=w&&w.setAttributes({x:h+i[3],y:i[0],width:r-i[1]-i[3]-d-h,height:o-i[0]-i[2]})}if(u.getChildByName(\\\"play-icon\\\")){var{width:_,height:m}=getCellRange(u,p),S=Math.floor(Math.min(_-i[1]-i[3],m-i[2]-i[0])/2),x=0+(_>f.attribute.width?+f.attribute.x+f.attribute.width/2:_/2),R=0+(m>f.attribute.height?+f.attribute.y+f.attribute.height/2:m/2);for(let t=n;t<=l;t++)for(let e=a;e<=s;e++)p.scenegraph.getCell(t,e).getChildByName(\\\"play-icon\\\").setAttributes({x:x-S/2,y:R-S/2,width:S,height:S})}u.forEachChildren(e=>{\\\"icon-left\\\"!==e.role&&(\\\"icon-right\\\"!==e.role&&\\\"icon-absolute-right\\\"!==e.role||e.setAttribute(\\\"x\\\",e.attribute.x+g))}),u.forEachChildren(e=>{(\\\"rect\\\"===e.type||e.role&&e.role.startsWith(\\\"icon\\\"))&&(\\\"middle\\\"===P?e.setAttribute(\\\"y\\\",i[0]+(o-i[0]-i[2]-e.AABBBounds.height())/2):\\\"bottom\\\"===P?e.setAttribute(\\\"y\\\",i[0]+o-i[0]-i[2]-e.AABBBounds.height()):e.setAttribute(\\\"y\\\",i[0]))}),e&&updateImageDxDy(u.mergeStartCol,u.mergeEndCol,u.mergeStartRow,u.mergeEndRow,p)}}}function getCellRange(e,t){return\\\"cell\\\"===e.role&&isValid_default(e.mergeStartCol)&&isValid_default(e.mergeEndCol)&&isValid_default(e.mergeStartRow)&&isValid_default(e.mergeEndRow)?{width:t.getColsWidth(e.mergeStartCol,e.mergeEndCol),height:t.getRowsHeight(e.mergeStartRow,e.mergeEndRow),isMerge:!0}:{width:e.attribute.width,height:e.attribute.height,isMerge:!1}}function updateImageDxDy(t,i,r,o,n){for(let s=t;s<=i;s++)for(let e=r;e<=o;e++){var a,l=n.scenegraph.getCell(s,e);l&&((a=l.getChildByName(\\\"image\\\"))&&a.setAttributes({dx:-n.getColsWidth(l.mergeStartCol,s-1),dy:-n.getRowsHeight(l.mergeStartRow,e-1)}),a=l.getChildByName(\\\"play-icon\\\"))&&a.setAttributes({dx:-n.getColsWidth(l.mergeStartCol,s-1),dy:-n.getRowsHeight(l.mergeStartRow,e-1)})}}function dealPromiseData(e,t,i){e.then(()=>{i(),t.scenegraph.updateNextFrame()})[\\\"catch\\\"](e=>{})}function onBeforeAttributeUpdateForInvertHighlight(e,t){var i,r;this.shadowRoot&&this.shadowRoot.childrenCount&&(isValid_default(e.width)||isValid_default(e.height))&&(r=this.shadowRoot.findChildrenByName(\\\"shadow-rect\\\")[0])&&r.setAttributes({width:null!=(i=e.width)?i:r.attribute.width,height:null!=(i=e.height)?i:r.attribute.height})}function createCell(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p,f,m,b){let C,v,y,w=!1;if(isPromise(t)){if(\\\"cell\\\"!==r.scenegraph.highPerformanceGetCell(o,n).role)return y;t=r.getCellValue(o,n),w=!0}var _,S,x,R;return\\\"text\\\"===e||\\\"link\\\"===e||b?(({customElementsGroup:_,renderDefault:S}=(\\\"link\\\"===e&&(S=t,_=r.getCellOriginValue(o,n),R=r._getCellStyle(o,n),\\\"link\\\"!==e||!(\\\"templateLink\\\"in i&&i.templateLink)&&\\\"linkDetect\\\"in i&&getOrApply(i.linkDetect,{col:o,row:n,table:r,value:S,dataValue:_,cellHeaderPaths:void 0})&&!regUrl.test(S)||(f?(f.text.fill=getProp2(\\\"linkColor\\\",R,o,n,r),f.group.cursor=\\\"pointer\\\"):f={text:{fill:getProp2(\\\"linkColor\\\",R,o,n,r)},group:{cursor:\\\"pointer\\\"}})),_generateCustomElementsGroup(r,i,o,n,l,s,u,m,b))),y=Factory2.getFunction(\\\"createTextCellGroup\\\")(r,t,h,0,d,o,n,a,l,s,u,c,g,p,_,S,f,m,w),(R=r.internalProps.layoutMap.getAxisConfigInPivotChart(o,n))?(_=new(Factory2.getComponent(\\\"axis\\\"))(R,y.attribute.width,y.attribute.height,null!=(C=R.__vtablePadding)?C:u,r),y.clear(),y.appendChild(_.component),_.overlap()):r.internalProps.layoutMap.isEmpty(o,n)?(y.setAttributes({fill:!1,stroke:!1}),y.clear()):r.internalProps.layoutMap.isAxisCell(o,n)&&y.clear()):\\\"image\\\"===e?y=Factory2.getFunction(\\\"createImageCellGroup\\\")(h,0,d,o,n,l,s,i.keepAspectRatio,i.imageAutoSizing,u,c,g,p,r,f,m,w):\\\"video\\\"===e?y=Factory2.getFunction(\\\"createVideoCellGroup\\\")(h,0,d,o,n,l,s,i.keepAspectRatio,i.imageAutoSizing,u,c,g,p,r,f,m,w):\\\"chart\\\"===e?(S=r.internalProps.layoutMap.getChartInstance(o,n),y=Factory2.getFunction(\\\"createChartCellGroup\\\")(null,h,0,d,o,n,l,s,u,t,i.chartModule,r.internalProps.layoutMap.getChartSpec(o,n),S,null!=(v=r.internalProps.layoutMap.getChartDataId(o,n))?v:\\\"data\\\",r,f,r.internalProps.layoutMap.isShareChartSpec(o,n),w,r.internalProps.layoutMap.isNoChartDataRenderNothing(o,n))):\\\"progressbar\\\"===e?(({customElementsGroup:R,renderDefault:_}=_generateCustomElementsGroup(r,i,o,n,l,s,u,m,b)),S=r._getCellStyle(o,n),x=r.getCellOriginValue(o,n),y=Factory2.getFunction(\\\"createTextCellGroup\\\")(r,t,h,0,d,o,n,a,l,s,u,c,g,!1,R,_,f,m,w),R=Factory2.getFunction(\\\"createProgressBarCell\\\")(i,S,a,t,x,o,n,u,r,m),y.firstChild?y.insertBefore(R,y.firstChild):y.appendChild(R)):\\\"sparkline\\\"===e?y=Factory2.getFunction(\\\"createSparkLineCellGroup\\\")(null,h,0,d,o,n,l,s,u,r,f,w):\\\"checkbox\\\"===e?y=Factory2.getFunction(\\\"createCheckboxCellGroup\\\")(null,h,0,d,o,n,a,l,s,u,c,g,p,r,f,i,m,w):\\\"radio\\\"===e?y=Factory2.getFunction(\\\"createRadioCellGroup\\\")(null,h,0,d,o,n,a,l,s,u,c,g,r,f,i,m):\\\"switch\\\"===e?y=Factory2.getFunction(\\\"createSwitchCellGroup\\\")(null,h,0,d,o,n,a,l,s,u,c,g,p,r,f,i,m,w):\\\"button\\\"===e&&(y=Factory2.getFunction(\\\"createButtonCellGroup\\\")(null,h,0,d,o,n,a,l,s,u,c,g,p,r,f,i,m,w)),y.onBeforeAttributeUpdate=onBeforeAttributeUpdateForInvertHighlight,y}function _generateCustomElementsGroup(i,r,o,n,a,l,s,h,e){let d,u=!0;if(e)d=e.elementsGroup,u=e.renderDefault;else{let e,t;var c;((t=\\\"body\\\"!==i.getCellLocation(o,n)?(e=null==r?void 0:r.headerCustomRender,null==r?void 0:r.headerCustomLayout):(e=(null==r?void 0:r.customRender)||i.customRender,null==r?void 0:r.customLayout))||e)&&(c=dealWithCustom(t,e,o,n,a,l,!1,i.isAutoRowHeight(n),s,h,i),d=c.elementsGroup,u=c.renderDefault)}return{customElementsGroup:d,renderDefault:u}}function updateCell(u,c,g,p,f,i){var m=g.scenegraph.highPerformanceGetCell(u,c,!0);if(\\\"cell\\\"===m.role||p){var b=g.getCellLocation(u,c);let r,o,n,a,l=g.getCellValue(u,c),s=!1,e=(g.internalProps.customMergeCell&&(_=g.getCustomMerge(u,c))&&(({range:_,text:C,style:x,customLayout:T,customRender:S}=_),o=_,r=o.start.col!==o.end.col||o.start.row!==o.end.row,l=C,n=x,(T||S)&&(a=dealWithCustom(T,S,_.start.col,_.start.row,g.getColsWidth(_.start.col,_.end.col),g.getRowsHeight(_.start.row,_.end.row),!1,g.isAutoRowHeight(c),[0,0,0,0],o,g)),s=!0),u),t=c;o&&(e=o.start.col,t=o.start.row);var C=\\\"body\\\"!==b?g.getHeaderDefine(e,t):g.getBodyColumnDefine(e,t);let h=\\\"body\\\"!==b||(null==C?void 0:C.dragOrder)||!(null==C||!C.icon)||!(null==C||!C.tree),d=(!o&&(g.internalProps.enableTreeNodeMerge||\\\"body\\\"!==b||null!=C&&C.mergeCell)&&(o=g.getCellRange(u,c),r=o.start.col!==o.end.col||o.start.row!==o.end.row),!1);g.internalProps.enableTreeNodeMerge&&r&&(({vtableMergeName:T,vtableMerge:S}=null!=(x=g.getCellRawRecord(o.start.col,o.start.row))?x:{}),d=S)&&(h=!0,g.options.groupTitleCustomLayout&&(a=dealWithCustom(g.options.groupTitleCustomLayout,void 0,o.start.col,o.start.row,g.getColsWidth(o.start.col,o.end.col),g.getRowsHeight(o.start.row,o.end.row),!1,g.isAutoRowHeight(c),[0,0,0,0],o,g)),g.options.groupTitleFieldFormat?l=g.options.groupTitleFieldFormat(x,u,c,g):T&&(l=T));var v,y,w,_=n||g._getCellStyle(o?o.start.col:u,o?o.start.row:c),S=null!=(b=_.autoWrapText)?b:g.internalProps.autoWrapText,x=getStyleTheme(_,g,r?o.start.col:u,r?o.start.row:c,getProp2).theme;if(x.group.cornerRadius=getCellCornerRadius(u,c,g),!p&&!r&&!(null!=C&&C.customLayout||null!=C&&C.customRender||null!=C&&C.headerCustomLayout||null!=C&&C.headerCustomRender)&&(i||canUseFastUpdate(u,c,m,S,h,g)))return T=g.getColWidth(u),b=g.getRowHeight(c),B=getCellBorderStrokeWidth(u,c,x,g),m.setAttributes({width:T,height:b,lineWidth:null!=(v=null==(v=null==x?void 0:x.group)?void 0:v.lineWidth)?v:void 0,fill:null!=(v=null==(v=null==x?void 0:x.group)?void 0:v.fill)?v:void 0,stroke:null!=(v=null==(v=null==x?void 0:x.group)?void 0:v.stroke)?v:void 0,strokeArrayWidth:null!=B?B:void 0,strokeArrayColor:null!=(B=null==(v=null==x?void 0:x.group)?void 0:v.strokeArrayColor)?B:void 0,cursor:null!=(B=null==(v=null==x?void 0:x.group)?void 0:v.cursor)?B:void 0,cornerRadius:null!=(B=null==(v=null==x?void 0:x.group)?void 0:v.cornerRadius)?B:0,lineDash:null!=(B=null==(v=null==x?void 0:x.group)?void 0:v.lineDash)?B:void 0,y:g.scenegraph.getCellGroupY(c)}),m.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})}),v=m.getChildByName(\\\"text\\\"),i&&v?(B={textBaseline:\\\"top\\\"},v.setAttributes(x.text?Object.assign({},x.text,B):B)):v&&(({text:B,moreThanMaxCharacters:R}=breakString(g.getCellValue(u,c),g)),A=getHierarchyOffset(u,c,g),y=_.lineClamp,_=null!=(_=getQuadProps(getProp2(\\\"padding\\\",_,u,c,g)))?_:[0,0,0,0],P=0,P=\\\"center\\\"===(w=x.text.textAlign)?_[3]+(T-(_[1]+_[3]))/2:\\\"right\\\"===w?_[3]+T-(_[1]+_[3]):_[3],B={text:1!==B.length||S?B:B[0],moreThanMaxCharacters:R,maxLineWidth:T-(_[1]+_[3]+A),textBaseline:\\\"top\\\",autoWrapText:S,lineClamp:y,wordBreak:\\\"break-word\\\",heightLimit:b-Math.floor(_[0]+_[2]),pickable:!1,dx:\\\"left\\\"===w?A:0,x:P},v.setAttributes(x.text?Object.assign({},x.text,B):B),v.attribute.text)&&(R=x.text.textBaseline,T=b-(_[0]+_[2]),S=0,S=\\\"middle\\\"===R?_[0]+(T-v.AABBBounds.height())/2:\\\"bottom\\\"===R?_[0]+T-v.AABBBounds.height():_[0],v.setAttributes({y:S})),m;if(p||\\\"empty\\\"!==m.role){var R,T,A=d||s?\\\"text\\\":g.isHeader(u,c)?null!=(y=g._getHeaderLayoutMap(u,c).headerType)?y:\\\"text\\\":null!=(w=g.getBodyColumnType(u,c))?w:\\\"text\\\",P=x._vtable.padding,B=x.text.textAlign,b=x.text.textBaseline;let e,t,i;return i=o?(t=g.getColsWidth(o.start.col,o.end.col),g.getRowsHeight(o.start.row,o.end.row)):(t=g.getColWidth(u),g.getRowHeight(c)),isPromise(l)?(m.removeAllChild(),dealPromiseData(l,g,callUpdateCellContentForPromiseValue.bind(null,{type:A,value:l,define:C,table:g,col:u,row:c,cellWidth:t,cellHeight:i,oldCellGroup:m,padding:P,textAlign:B,textBaseline:b,mayHaveIcon:h,addNew:p,range:o,customResult:a,customStyle:n}))):e=updateCellContent(A,l,C,g,u,c,t,i,m,P,B,b,h,p,x,o,a),r&&(R=e.attribute.width,T=e.attribute.height,e.contentWidth=R,e.contentHeight=T,f?dealWithMergeCellSizeForShadow(o,t,i,P,B,b,g,e):dealWithMergeCellSize(o,t,i,P,B,b,g)),e}}}function updateCellContent(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p,f,m){var b;if(isPromise(t)&&(t=r.getCellValue(o,n)),!g&&(s.row!==n||s.col!==o))return null;!g&&s.parent&&r.reactCustomLayout&&(C=s.getChildByName(\\\"custom-container\\\"))&&(({col:C,row:b}=C),isNumber_default(C))&&isNumber_default(b)&&r.reactCustomLayout.removeCustomCell(C,b);var C=createCell(e,t,i,r,o,n,r.getColWidth(o),a,l,g?r.scenegraph.getColGroup(o):s.parent,g?0:r.scenegraph.getCellGroupY(n),h,d,u,c,p,f,m);return g||!s.parent||(s.parent.insertAfter(C,s),s.parent.removeChild(s),null==(b=r.scenegraph))||!b.proxy.cellCache.get(o)||null!=(b=r.scenegraph)&&b.proxy.cellCache.set(o,C),C}function canUseFastUpdate(e,t,i,r,o,n){var a=n.getBodyColumnType(e,t),l=n.isAutoRowHeight(t),s=n.getCellValue(e,t);return!(n.isHeader(e,t)||\\\"cell\\\"!==i.role||\\\"text\\\"!==a||r||l||o||\\\"text\\\"!==(null==(a=i.firstChild)?void 0:a.type)||isPromise(s))}function callUpdateCellContentForPromiseValue(e){var{type:t,value:i,define:r,table:o,col:n,row:a,cellWidth:l,cellHeight:s,oldCellGroup:h,padding:d,textAlign:u,textBaseline:c,mayHaveIcon:g,addNew:p,range:f,customResult:m,customStyle:b}=e,b=getStyleTheme(b||o._getCellStyle(f?f.start.col:n,f?f.start.row:a),o,f?f.start.col:n,f?f.start.row:a,getProp2).theme;b.group.cornerRadius=getCellCornerRadius(n,a,o),updateCellContent(t,i,r,o,n,a,l,s,h,d,u,c,g,p,b,f,m)}function dealWithMergeCellSize(t,i,r,o,n,a,l){for(let d=t.start.col;d<=t.end.col;d++)for(let e=t.start.row;e<=t.end.row;e++){var s,h=l.scenegraph.highPerformanceGetCell(d,e,!0);\\\"cell\\\"===h.role&&(t.start.row!==t.end.row&&h.contentHeight!==r&&updateCellContentHeight(h,r,r,l.isAutoRowHeight(e),o,n,a,l),t.start.col!==t.end.col&&h.contentWidth!==i&&updateCellContentWidth(h,i,r,0,l.isAutoRowHeight(e),o,n,a,l.scenegraph),h.contentWidth=i,h.contentHeight=r,s=l.getRowHeight(e),resizeCellGroup(h,l.getColWidth(d),s,t,l))}}function dealWithMergeCellSizeForShadow(e,t,i,r,o,n,a,l){var{col:s,row:h}=l,h=(e.start.row!==e.end.row&&l.contentHeight!==i&&updateCellContentHeight(l,i,i,a.isAutoRowHeight(h),r,o,n,a),e.start.col!==e.end.col&&l.contentWidth!==t&&updateCellContentWidth(l,t,i,0,a.isAutoRowHeight(h),r,o,n,a.scenegraph),l.contentWidth=t,l.contentHeight=i,a.getRowHeight(h));resizeCellGroup(l,a.getColWidth(s),h,e,a)}function resizeCellGroup(e,t,i,r,o){let n,a,{col:l,row:s}=e,h=-o.getColsWidth(r.start.col,l-1),d=0;if(null!=(n=o.options.customConfig)&&n._disableColumnAndRowSizeRound)for(let e=r.start.row;e<=s-1;e++)d-=o.getRowHeight(e);else d=-o.getRowsHeight(r.start.row,s-1);e.forEachChildren(e=>{var t;\\\"number\\\"==typeof e._dx?(e.skipMergeUpdate=!0,e.setAttributes({dx:(null!=(t=e._dx)?t:0)+h})):(e.skipMergeUpdate=!0,e._dx=null!=(t=e.attribute.dx)?t:0,e.setAttributes({dx:(null!=(t=e.attribute.dx)?t:0)+h})),e.skipMergeUpdate=!1,\\\"number\\\"==typeof e._dy?(e.skipMergeUpdate=!0,e.setAttributes({dy:(null!=(t=e._dy)?t:0)+d})):(e._dy=null!=(t=e.attribute.dy)?t:0,e.skipMergeUpdate=!0,e.setAttributes({dy:(null!=(t=e.attribute.dy)?t:0)+d})),e.skipMergeUpdate=!1});var u=null!=(a=e.attribute.strokeArrayWidth)?a:e.attribute.lineWidth,c=isArray_default(u),g=[0,0,0,0],c=(l===r.start.col&&(g[3]=c?u[3]:u),s===r.start.row&&(g[0]=c?u[0]:u),l===r.end.col&&(g[1]=c?u[1]:u),s===r.end.row&&(g[2]=c?u[2]:u),t!==e.attribute.width),u=i!==e.attribute.height;return e.skipMergeUpdate=!0,e.setAttributes({width:t,height:i,strokeArrayWidth:g}),e.skipMergeUpdate=!1,e.mergeStartCol=r.start.col,e.mergeStartRow=r.start.row,e.mergeEndCol=r.end.col,e.mergeEndRow=r.end.row,{widthChange:c,heightChange:u}}function getCustomCellMergeCustom(e,t,i,r){if(r.internalProps.customMergeCell){var o=r.getCustomMerge(e,t);if(o){var n,a,{range:o,customLayout:l,customRender:s}=o;if(l||s)return l=dealWithCustom(l,s,o.start.col,o.start.row,r.getColsWidth(o.start.col,o.end.col),r.getRowsHeight(o.start.row,o.end.row),!1,r.isAutoRowHeight(t),[0,0,0,0],o,r).elementsGroup,0<i.childrenCount&&l?i.insertBefore(l,i.firstChild):l&&i.appendChild(l),s=r.getRowHeight(t),l=r.getColWidth(e),n=i.attribute.width,a=i.attribute.height,i.contentWidth=n,i.contentHeight=a,resizeCellGroup(i,l,s,o,r),o}}}function isMergeCellGroup(e){return!!(\\\"cell\\\"===e.role&&isNumber_default(e.mergeStartCol)&&isNumber_default(e.mergeStartRow)&&isNumber_default(e.mergeEndCol)&&isNumber_default(e.mergeEndRow))}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var utilCheckBoxMark=new CheckBox({}),utilRadioMark=new Radio({}),utilButtonMark=new Tag({});function computeCheckboxCellHeight(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){var f,m=validToString(isObject_default(e)?e.text:e).split(\\\"\\\\n\\\")||[],b=p.getColsWidth(t,r),C=getProp2(\\\"size\\\",o,t,i,p);let v=0;return v=n?(f=getProp2(\\\"spaceBetweenTextAndIcon\\\",o,t,i,p),b=b-(g[1]+g[3])-a-C-f,utilCheckBoxMark.setAttributes({text:{maxLineWidth:b,text:m,fontSize:l,fontStyle:s,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:\\\"break-word\\\",lineClamp:c},icon:{width:Math.floor(C/1.4),height:Math.floor(C/1.4)},box:{width:C,height:C},spaceBetweenTextAndIcon:f}),utilCheckBoxMark.render(),utilCheckBoxMark.AABBBounds.height()):Math.max(C,m.length*u)}function computeRadioCellHeight(o,n,a,l,s,h,d,u,c,g,p,f,m,b,C){var e;if(isArray_default(o)){let r=0;const t=C.getBodyColumnDefine(n,a),v=getProp2(\\\"spaceBetweenRadio\\\",s,n,a,C),i=null!=(e=null==t?void 0:t.radioDirectionInCell)?e:\\\"vertical\\\";return\\\"vertical\\\"===i?o.forEach((e,t)=>{var i=computeSingleRadioCellHeight(e,n,a,l,s,h,d,u,c,g,p,f,m,b,C);r+=i,t!==o.length-1&&(r+=v)}):\\\"horizontal\\\"===i&&o.forEach(e=>{var t=computeSingleRadioCellHeight(e,n,a,l,s,h,d,u,c,g,p,f,m,b,C);r=Math.max(t,r)}),r}return computeSingleRadioCellHeight(o,n,a,l,s,h,d,u,c,g,p,f,m,b,C)}function computeSingleRadioCellHeight(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){var f=validToString(isObject_default(e)?e.text:e).split(\\\"\\\\n\\\")||[],m=p.getColsWidth(t,r),b=getProp2(\\\"size\\\",o,t,i,p);let C=getProp2(\\\"outerRadius\\\",o,t,i,p);var v,y=isNumber_default(C)?2*C:b;let w=0;return w=n?(v=getProp2(\\\"spaceBetweenTextAndIcon\\\",o,t,i,p),m=m-(g[1]+g[3])-a-y-v,isNumber_default(C)||(C=Math.round(b/2)),utilRadioMark.setAttributes({text:{maxLineWidth:m,text:f,fontSize:l,fontStyle:s,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:\\\"break-word\\\",lineClamp:c},circle:{outerRadius:C},spaceBetweenTextAndIcon:v}),utilRadioMark.render(),utilRadioMark.AABBBounds.height()):Math.max(b,f.length*u)}function computeSwitchCellHeight(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){return getProp2(\\\"boxWidth\\\",o,t,i,p)}function computeButtonCellHeight(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){var f=validToString(isObject_default(e)?e.text:e).split(\\\"\\\\n\\\")||[],m=p.getColsWidth(t,r),b=getProp2(\\\"buttonPadding\\\",o,t,i,p),C=getProp2(\\\"buttonLineWidth\\\",o,t,i,p);let v=0;return v=n?(m=m-(g[1]+g[3]),utilButtonMark.setAttributes({text:f,textStyle:{maxLineWidth:m,fontSize:l,fontStyle:s,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:\\\"break-word\\\",lineClamp:c},padding:b,panel:{visible:!0,fill:\\\"red\\\",stroke:\\\"red\\\",lineWidth:C}}),utilRadioMark.render(),utilRadioMark.AABBBounds.height()):f.length*u+2*b}init_esbuild_inject();var customAlphabetCharSet=\\\"\\\",textMeasureMode=\\\"quick\\\",textMeasureModule=new ContainerModule((e,t,i,r)=>{(i(TextMeasureContribution)?r:e)(TextMeasureContribution).to(FastTextMeasureContribution).inSingletonScope()}),restoreTextMeasureModule=new ContainerModule((e,t,i,r)=>{(i(TextMeasureContribution)?r:e)(TextMeasureContribution).to(DefaultTextMeasureContribution).inSingletonScope()}),text_measure_default=textMeasureModule,fastTextMeasureCache=new Map;function getFastTextMeasure(e,t,i,r=\\\"normal\\\"){var o=e+`-${t}-${i}-`+r,n=fastTextMeasureCache.get(o);return n||(n={fontSize:e,fontFamily:i,fontWeight:t,fontStyle:r},n=new TextMeasure(Object.assign({defaultFontParams:{fontFamily:DefaultTextStyle.fontFamily,fontSize:DefaultTextStyle.fontSize},getTextBounds:getTextBounds,specialCharSet:`{}()//&-/: .,@%'\\\"~…=——${TextMeasure.ALPHABET_CHAR_SET}${TextMeasure.ALPHABET_CHAR_SET.toUpperCase()}0123456789`+customAlphabetCharSet},{}),n),fastTextMeasureCache.set(o,n),n)}var FastTextMeasureContribution=class extends DefaultTextMeasureContribution{_fastMeasure(e,t){var{fontSize:i,fontFamily:r=\\\"Arial,sans-serif\\\",fontWeight:o=\\\"normal\\\",fontStyle:n=\\\"normal\\\"}=t,i=getFastTextMeasure(i,o,r,n).measure(e,textMeasureMode);return isValid_default(i.fontBoundingBoxAscent)||isValid_default(i.fontBoundingBoxDescent)||(({ascent:o,descent:r}=this.measureTextBoundADscentEstimate(t)),i.fontBoundingBoxAscent=o,i.fontBoundingBoxDescent=r),i}measureTextWidth(e,t){return this._fastMeasure(e,t).width}measureText(e,t){return this._fastMeasure(e,t)}_measureTextWithoutAlignBaseline(e,t,i){return this._fastMeasure(e,t)}_measureTextWithAlignBaseline(e,t,i){return this._fastMeasure(e,t)}},TextMeasureTool=class{measureText(e,t){var{fontSize:i,fontFamily:r=\\\"Arial,sans-serif\\\",fontWeight:o=\\\"normal\\\",fontStyle:n=\\\"normal\\\"}=t;return getFastTextMeasure(i,o,r,n).measure(e,textMeasureMode)}measureTextWidth(e,t){var{fontSize:i,fontFamily:r=\\\"Arial,sans-serif\\\",fontWeight:o=\\\"normal\\\",fontStyle:n=\\\"normal\\\"}=t;return getFastTextMeasure(i,o,r,n).measure(e,textMeasureMode).width}clipText(e,t,i){var r;return 0===e.length?{str:\\\"\\\",width:0}:(r=this.measureTextWidth(e,t))<=i?{str:e,width:r}:i<(r=this.measureTextWidth(e[0],t))?{str:\\\"\\\",width:0}:this._clipText(e,t,i,0,e.length-1)}_clipText(e,t,i,r,o){var n,a=Math.floor((r+o)/2),l=e.substring(0,a+1),s=this.measureTextWidth(l,t);let h;return i<s?l.length<=1?{str:\\\"\\\",width:0}:(n=e.substring(0,a),(h=this.measureTextWidth(n,t))<=i?{str:n,width:h}:this._clipText(e,t,i,r,a)):s<i?a>=e.length-1?{str:e,width:this.measureTextWidth(e,t)}:(n=e.substring(0,a+2),(h=this.measureTextWidth(n,t))>=i?{str:l,width:s}:this._clipText(e,t,i,a,o)):{str:l,width:s}}clipTextWithSuffix(e,t,i,r){var o,n;return\\\"\\\"===r?this.clipText(e,t,i):0===e.length?{str:\\\"\\\",width:0}:(o=this.measureTextWidth(e,t))<=i?{str:e,width:o}:i<(o=this.measureTextWidth(r,t))?{str:\\\"\\\",width:0}:((n=this._clipText(e,t,i-=o,0,e.length-1)).str+=r,n.width+=o,n)}},textMeasure=new TextMeasureTool,utilTextMark=new Text({ignoreBuf:!0});function measureTextBounds(e){return utilTextMark.initAttributes(Object.assign(Object.assign({},e),{ignoreBuf:!0})),utilTextMark.AABBBounds}var MenuType,utilRichTextMark=new RichText({width:0,height:0,textConfig:[]});function computeRowsHeight(a,o,n,t=!0,l){\\\"undefined\\\"!=typeof window&&window.performance.now();var s,h,d,u,c=[],g=[];if(l)for(let e=o;e<=n;e++)c[e]=a.getRowHeight(e);var r,p,e=a.internalProps.layoutMap,f=(a.isPivotTable()&&(e.enableUseGetBodyCache(),e.enableUseHeaderPathCache()),a.defaultHeaderRowHeight,\\\"auto\\\"===a.defaultHeaderRowHeight||isArray_default(a.defaultHeaderRowHeight)&&a.defaultHeaderRowHeight.some(e=>\\\"auto\\\"===e)),m=a.isAutoRowHeight(o)||\\\"adaptive\\\"===a.heightMode&&!1!==a.options.autoHeightInAdaptiveMode,b=\\\"auto\\\"===a.options.defaultRowHeight;if(m||f||b){n=null!=n?n:a.rowCount-1,(0===(o=null!=o?o:0)&&n===a.rowCount-1||t)&&a._clearRowRangeHeightsMap();for(let i=o;i<a.columnHeaderLevelCount;i++){let e=0,t=a.colCount-1;(a.isPivotTable()&&!a.isPivotChart()||a.isPivotChart()&&!a.internalProps.layoutMap.indicatorsAsCol)&&checkPivotFixedStyleAndNoWrap(a,i)&&!getCellMergeInfo(a,a.rowHeaderLevelCount,i)&&(e=0,t=a.rowHeaderLevelCount),!m&&\\\"auto\\\"!==a.getDefaultRowHeight(i)||(r=computeRowHeight(i,e,t,a),g[i]=Math.round(r),\\\"only-body\\\"!==a.heightAdaptiveMode&&l)||a._setRowHeight(i,r)}for(let e=a.rowCount-a.bottomFrozenRowCount;e<=n;e++)!m&&\\\"auto\\\"!==a.getDefaultRowHeight(e)||(p=computeRowHeight(e,0,a.colCount-1,a),l?g[e]=Math.round(p):a._setRowHeight(e,p));if(!(n<a.columnHeaderLevelCount||!m&&!b))if(a.internalProps.transpose||a.isPivotTable()&&!a.internalProps.layoutMap.indicatorsAsCol||a.options.customComputeRowHeight||!checkFixedStyleAndNoWrap(a,o))if(a.internalProps.transpose||a.isPivotTable()&&!a.internalProps.layoutMap.indicatorsAsCol)for(let e=Math.max(o,a.columnHeaderLevelCount);e<=n;e++){var C=checkFixedStyleAndNoWrapForTranspose(a,e)?computeRowHeight(e,0,a.rowHeaderLevelCount,a):computeRowHeight(e,0,a.colCount-1,a);l?g[e]=Math.round(C):a._setRowHeight(e,C)}else for(let t=Math.max(o,a.columnHeaderLevelCount);t<=n;t++){var v=computeRowHeight(t,0,a.colCount-1,a);l?g[t]=Math.round(v):a._setRowHeight(t,v)}else{fillRowsHeight(computeRowHeight(a.columnHeaderLevelCount,0,a.colCount-1,a),a.columnHeaderLevelCount,a.rowCount-1-a.bottomFrozenRowCount,a,l?g:void 0);for(let e=a.rowCount-a.bottomFrozenRowCount;e<=n;e++){var y=computeRowHeight(e,0,a.colCount-1,a);l?g[e]=Math.round(y):a._setRowHeight(e,y)}}}else if(\\\"adaptive\\\"!==a.heightMode&&!a.autoFillHeight||a.clearRowHeightCache(),l)for(let e=o;e<=n;e++)g[e]=a.getRowHeight(e);if((0===o&&n===a.rowCount-1||t)&&a._clearRowRangeHeightsMap(),\\\"adaptive\\\"===a.heightMode){a._clearRowRangeHeightsMap();let e=a.tableNoFrameHeight,r=0,o=a.rowCount;\\\"only-body\\\"===a.heightAdaptiveMode&&(f=a.getRowsHeight(0,a.columnHeaderLevelCount-1),b=a.isPivotChart()?a.getBottomFrozenRowsHeight():0,e=a.tableNoFrameHeight-f-b,r=a.columnHeaderLevelCount,o=a.isPivotChart()?a.rowCount-a.bottomFrozenRowCount:a.rowCount);let t=0;for(let i=r;i<o;i++)t+=l&&null!=(s=g[i])?s:a.getRowHeight(i);var w=e/t;for(let n=r;n<o;n++){var _=n===o-1?e-(l?g.reduce((e,t,i)=>i>=r&&i<=o-2?e+t:e,0):a.getRowsHeight(r,o-2)):Math.round((l&&null!=(_=g[n])?_:a.getRowHeight(n))*w);l?g[n]=_:a._setRowHeight(n,_,!1)}}else if(a.autoFillHeight){a._clearRowRangeHeightsMap();var S=a.tableNoFrameHeight;let t=0,i=0;for(let e=0;e<a.rowCount;e++){var x=l&&null!=(x=g[e])?x:a.getRowHeight(e);(e<a.columnHeaderLevelCount||a.isPivotChart()&&e>=a.rowCount-a.bottomFrozenRowCount)&&(i+=x),t+=x}if((a.scenegraph._dealAutoFillHeightOriginRowsHeight=t)<S&&0<t-i){const M=a.columnHeaderLevelCount,E=a.isPivotChart()?a.rowCount-a.bottomFrozenRowCount:a.rowCount,H=(S-i)/(t-i);for(let e=M;e<E;e++){var R=e===E-1?S-i-(l?g.reduce((e,t,i)=>i>=M&&i<=E-2?e+t:e,0):a.getRowsHeight(M,E-2)):Math.round((l&&null!=(R=g[e])?R:a.getRowHeight(e))*H);l?g[e]=R:a._setRowHeight(e,R,!1)}}}if(l){for(let e=o;e<=n;e++){var T=null!=(T=g[e])?T:a.getRowHeight(e);isValid_default(T)&&a._setRowHeight(e,T)}for(let t=0;t<=a.frozenRowCount-1;t++){var A=a.getRowHeight(t);A!==(null!=(h=c[t])?h:a.getRowHeight(t))&&a.scenegraph.updateRowHeight(t,A-(null!=(h=c[t])?h:a.getRowHeight(t)),!0)}for(let i=a.rowCount-a.bottomFrozenRowCount;i<=a.rowCount-1;i++){var P=a.getRowHeight(i);P!==(null!=(d=c[i])?d:a.getRowHeight(i))&&a.scenegraph.updateRowHeight(i,P-(null!=(d=c[i])?d:a.getRowHeight(i)),!0)}for(let r=a.scenegraph.proxy.rowStart;r<=a.scenegraph.proxy.rowEnd;r++){var B=a.getRowHeight(r);B!==(null!=(u=c[r])?u:a.getRowHeight(r))&&a.scenegraph.updateRowHeight(r,B-(null!=(u=c[r])?u:a.getRowHeight(r)),!0)}}a.isPivotTable()&&(e.disableUseGetBodyCache(),e.disableUseHeaderPathCache())}function computeRowHeight(e,t,i,r){if(!(r.isAutoRowHeight(e)||\\\"adaptive\\\"===r.heightMode&&!1!==r.options.autoHeightInAdaptiveMode)&&\\\"auto\\\"!==r.getDefaultRowHeight(e))return r.getDefaultRowHeight(e);let o;if(r.options.customComputeRowHeight){var n=r.options.customComputeRowHeight({row:e,table:r});if(\\\"number\\\"==typeof n)return n;if(\\\"auto\\\"!==n)return r.getDefaultRowHeight(e)}if(r.isPivotChart()&&e>=r.columnHeaderLevelCount&&e<r.rowCount-r.bottomFrozenRowCount)if(r.internalProps.layoutMap.indicatorsAsCol){var n=r.internalProps.layoutMap.getOptimunHeightForChart(e);if(0<n)return n}else{n=r.getDefaultRowHeight(e);if(isNumber_default(n))return n}for(let l=t;l<=i;l++){var a=computeCustomRenderHeight(l,e,r);if(!a||(o=isValid_default(o)?Math.max(a.height,o):a.height,a.renderDefault)){if(r.isPivotChart()){var a=r.internalProps.layoutMap.getAxisConfigInPivotChart(l,e);if(a){var a=Factory2.getFunction(\\\"computeAxisComponentHeight\\\")(a,r);if(\\\"number\\\"==typeof a){o=isValid_default(o)?Math.max(a,o):a;continue}}}r.isPivotChart()&&(r.isLeftFrozenColumn(l)&&r.isBottomFrozenRow(e)||r.isRightFrozenColumn(l)&&r.isBottomFrozenRow(e))||(a=computeTextHeight(l,e,r.isHeader(l,e)?null==(a=r._getHeaderLayoutMap(l,e))?void 0:a.headerType:r.getBodyColumnType(l,e),r),o=isValid_default(o)?Math.max(a,o):a)}}return isValid_default(o)?o:(n=r.getDefaultRowHeight(e),isNumber_default(n)?n:r.defaultRowHeight)}function checkFixedStyleAndNoWrap(e,t){var i,r=e.internalProps.layoutMap,o=e.columnHeaderLevelCount;if((e.internalProps.autoWrapText||e.internalProps.enableLineBreak||e.isPivotChart())&&(e.isAutoRowHeight(t)||\\\"adaptive\\\"===e.options.heightMode))return!1;for(let a=0;a<e.colCount;a++){var n=r.getBody(a,o);if(\\\"radio\\\"===n.cellType)return!1;if(\\\"function\\\"==typeof n.style||\\\"function\\\"==typeof n.icon||null!=(i=n.define)&&i.customRender||null!=(i=n.define)&&i.customLayout||\\\"function\\\"==typeof(null==(i=n.define)?void 0:i.icon))return!1;n=e._getCellStyle(a,o);if(\\\"function\\\"==typeof n.padding||\\\"function\\\"==typeof n.fontSize||\\\"function\\\"==typeof n.lineHeight||!0===n.autoWrapText)return!1}return!0}function checkFixedStyleAndNoWrapForTranspose(e,t){var i,r=e.internalProps.layoutMap;return!((e.internalProps.autoWrapText||e.internalProps.enableLineBreak)&&(e.isAutoRowHeight(t)||\\\"adaptive\\\"===e.options.heightMode)||\\\"function\\\"==typeof(r=r.getBody(e.rowHeaderLevelCount,t)).style||\\\"function\\\"==typeof r.icon||null!=(i=r.define)&&i.customRender||null!=(i=r.define)&&i.customLayout||\\\"function\\\"==typeof(null==(i=r.define)?void 0:i.icon)||\\\"function\\\"==typeof(r=e._getCellStyle(e.rowHeaderLevelCount,t)).padding||\\\"function\\\"==typeof r.fontSize||\\\"function\\\"==typeof r.lineHeight||!0===r.autoWrapText)}function checkPivotFixedStyleAndNoWrap(e,t){var i,r=e.internalProps.layoutMap;return!(e.internalProps.autoWrapText&&(e.isAutoRowHeight(t)||\\\"adaptive\\\"===e.options.heightMode)||\\\"function\\\"==typeof(r=r.getHeader(e.rowHeaderLevelCount,t)).style||\\\"function\\\"==typeof r.icons||null!=(i=r.define)&&i.headerCustomRender||null!=(i=r.define)&&i.headerCustomLayout||\\\"function\\\"==typeof(null==(i=r.define)?void 0:i.icon)||\\\"function\\\"==typeof(r=e._getCellStyle(e.rowHeaderLevelCount,t)).padding||\\\"function\\\"==typeof r.fontSize||\\\"function\\\"==typeof r.lineHeight||!0===r.autoWrapText)}function fillRowsHeight(t,i,r,o,n){if(!o.internalProps.useOneRowHeightFillAll){for(let e=i;e<=r;e++)n?n[e]=t:o._setRowHeight(e,t);o.internalProps.useOneRowHeightFillAll=!0}}function computeCustomRenderHeight(n,a,l){var s=l.getCustomRender(n,a);let h=l.getCustomLayout(n,a);if(s||h){let e,t=1,i=0,r=!1,o=!1;(l.isHeader(n,a)||null!=(c=l.getBodyColumnDefine(n,a))&&c.mergeCell||l.hasCustomMerge())&&(e=l.getCellRange(n,a),t=e.end.row-e.start.row+1);var d,u,c={col:null!=(c=null==e?void 0:e.start.col)?c:n,row:null!=(c=null==e?void 0:e.start.row)?c:a,dataValue:l.getCellOriginValue(n,a),value:l.getCellValue(n,a)||\\\"\\\",rect:getCellRect(n,a,l),table:l,originCol:n,originRow:a,forComputation:!0};return\\\"react-custom-layout\\\"===h&&(h=(null==(u=l.reactCustomLayout)?void 0:u.getCustomLayoutFunc(n,a))||emptyCustomLayout),isFunction_default(h)?(u=h(c),o=(r=(i=u.rootContainer&&(u.rootContainer=decodeReactDom(u.rootContainer),dealPercentCalc(u.rootContainer,l.getColWidth(n),0),u.rootContainer.setStage(l.scenegraph.stage),null!=(d=u.rootContainer.AABBBounds.height()))?d:0,u.renderDefault),u.enableCellPadding)):r=\\\"function\\\"==typeof s?(d=s(c),i=null!=(u=null==d?void 0:d.expectedHeight)?u:0,null==d?void 0:d.renderDefault):(i=null!=(c=null==s?void 0:s.expectedHeight)?c:0,null==s?void 0:s.renderDefault),o&&(u=getQuadProps(getProp2(\\\"padding\\\",l._getCellStyle(n,a),n,a,l)),i+=u[0]+u[2]),{height:i/t,renderDefault:r}}}function computeTextHeight(e,t,i,r){let o,n,a,l,s=0;var h,d=r.getCellValue(e,t),u=r._getCellStyle(e,t);let c=0,g=0;const p=[];let f=0;const m=[];let b=0,C=!1,v=((C=\\\"body\\\"!==r.getCellLocation(e,t)||!(null==(h=r.getBodyColumnDefine(e,t))||!h.icon)||!(null==h||!h.tree)||(null==h?void 0:h.dragOrder))&&null!=(h=r.getCellIcons(e,t))&&h.forEach(e=>{var t;e.positionType!==IconPosition.absoluteRight&&e.positionType!==IconPosition.inlineFront&&e.positionType!==IconPosition.inlineEnd?(g+=(null!=(t=e.width)?t:0)+(null!=(t=e.marginLeft)?t:0)+(null!=(t=e.marginRight)?t:0),c=Math.max(c,null!=(t=e.height)?t:0)):e.positionType===IconPosition.inlineFront?(p.push(e),f=Math.max(f,(null!=(t=e.height)?t:0)+(null!=(t=e.marginLeft)?t:0)+(null!=(t=e.marginRight)?t:0))):e.positionType===IconPosition.inlineEnd&&(m.push(e),b=Math.max(b,(null!=(t=e.height)?t:0)+(null!=(t=e.marginLeft)?t:0)+(null!=(t=e.marginRight)?t:0)))}),1),y=e;(r.isHeader(e,t)||null!=(o=r.getBodyColumnDefine(e,t))&&o.mergeCell||r.hasCustomMerge())&&(h=r.getCellRange(e,t),v=h.end.row-h.start.row+1,e=h.start.col,y=h.end.col);const w=getQuadProps(getProp2(\\\"padding\\\",u,e,t,r)),_=getProp2(\\\"fontSize\\\",u,e,t,r),S=getProp2(\\\"fontStyle\\\",u,e,t,r),x=getProp2(\\\"fontWeight\\\",u,e,t,r),R=null!=(n=getProp2(\\\"lineHeight\\\",u,e,t,r))?n:_,T=getProp2(\\\"fontFamily\\\",u,e,t,r),A=getProp2(\\\"autoWrapText\\\",u,e,t,r),P=getProp2(\\\"lineClamp\\\",u,e,t,r),B=getProp2(\\\"underline\\\",u,e,t,r),M=null!=(a=getProp2(\\\"underlineOffset\\\",u,e,t,r))?a:0;if(\\\"text\\\"!==i&&\\\"link\\\"!==i&&\\\"progressbar\\\"!==i&&\\\"checkbox\\\"!==i&&\\\"radio\\\"!==i&&\\\"switch\\\"!==i&&\\\"button\\\"!==i)s=R;else if(\\\"checkbox\\\"===i)s=computeCheckboxCellHeight(d,e,t,y,u,A,g,_,S,x,T,R,P,w,r);else if(\\\"radio\\\"===i)s=computeRadioCellHeight(d,e,t,y,u,A,g,_,S,x,T,R,P,w,r);else if(\\\"switch\\\"===i)s=computeSwitchCellHeight(d,e,t,y,u,A,g,_,S,x,T,R,P,w,r);else if(\\\"button\\\"===i)s=computeButtonCellHeight(d,e,t,y,u,A,g,_,S,x,T,R,P,w,r);else{const E=breakString(d,r).text,H=r.getColsWidth(e,y);p.length||m.length?A?((h=Object.assign({text:null==d?void 0:d.toString(),fontFamily:T,fontSize:_,fontStyle:S,fontWeight:x,lineHeight:R})).textBaseline=\\\"middle\\\",u=[...p.map(e=>dealWithRichTextIcon(e)),h,...m.map(e=>dealWithRichTextIcon(e))],utilRichTextMark.setAttributes({width:H-(w[1]+w[3])-g,height:0,textConfig:u}),s=utilRichTextMark.AABBBounds.height()):(s=0,E.forEach((e,t)=>{var i;null!=(i=r.options.customConfig)&&i.multilinesForXTable&&0!==t||(0===t&&p.length?s+=Math.max(R,f):t===E.length-1&&m.length?s+=Math.max(R,b):s+=R)})):s=A?(d=getHierarchyOffset(e,t,r),(measureTextBounds({maxLineWidth:H-(w[1]+w[3])-g-d,text:E,fontSize:_,fontStyle:S,fontWeight:x,fontFamily:T,lineHeight:R,wordBreak:\\\"break-word\\\",whiteSpace:1!==E.length||A?\\\"normal\\\":\\\"no-wrap\\\",lineClamp:P}).height()||(\\\"number\\\"==typeof R?R:_))+(B?M:0)):null!=(l=r.options.customConfig)&&l.multilinesForXTable?R:E.length*R}return(Math.max(s,c)+w[0]+w[2])/v}function getCellRect(e,t,i){return{left:0,top:0,right:i.getColWidth(e),bottom:i.getRowHeight(t),width:i.getColWidth(e),height:0}}function getCellMergeRange(e,t){var i,r,o,n,a,l;return t&&t.proxy?(({mergeStartCol:i,mergeEndCol:r,mergeStartRow:o,mergeEndRow:n,col:a,row:l}=e),{colStart:i,colEnd:r,rowStart:o,rowEnd:n}):{colStart:0,colEnd:0,rowStart:0,rowEnd:0}}function expendCellRange(e,t){var i=e.start.col,r=e.end.col,o=e.start.row,n=e.end.row;let a=i,l=r,s=o,h=n;for(let u=i;u<=r;u++)for(let e=o;e<=n;e++){var d=t.getCellRange(u,e);d&&(a=Math.min(a,d.start.col),l=Math.max(l,d.end.col),s=Math.min(s,d.start.row),h=Math.max(h,d.end.row))}return e.start.col=a,e.end.col=l,e.start.row=s,e.end.row=h,e}function updateRowHeight(t,e,i,r){r||t.table._setRowHeight(e,t.table.getRowHeight(e)+i,!0);for(let h=0;h<t.table.colCount;h++){var o,n=t.getCell(h,e);\\\"empty\\\"===n.role||(o=getCellMergeInfo(t.table,h,e))&&o.start.col!==h||(updateCellHeightForRow(t,n,h,e,n.attribute.height+i,i,t.table.isHeader(h,e)),t.updateCellContentWhileResize(h,e))}let a=0,l=0;l=e<t.table.frozenRowCount?(a=e+1,t.table.frozenRowCount-1):e>=t.table.rowCount-t.table.bottomFrozenRowCount?(a=e+1,t.table.rowCount-1):(a=e+1,Math.min(t.proxy.rowEnd,t.table.rowCount-t.table.bottomFrozenRowCount-1));for(let d=0;d<t.table.colCount;d++)for(let e=a;e<=l;e++){var s=t.highPerformanceGetCell(d,e);\\\"cell\\\"===s.role&&s.setAttribute(\\\"y\\\",s.attribute.y+i)}}function updateCellHeightForRow(e,t,i,r,o,n,a){t&&updateCellHeight(e,t,i,r,o,n,a)}function updateCellHeight(a,l,s,h,t,i,e){if(l.attribute.height!==t||l.needUpdateHeight){l.needUpdateHeight=!1,l.setAttribute(\\\"height\\\",t);var d=null==(d=a.table.getCellRawRecord(s,h))?void 0:d.vtableMerge,u=!!a.table.getCustomMerge(s,h),d=d||u?\\\"text\\\":a.table.isHeader(s,h)?null!=(d=a.table._getHeaderLayoutMap(s,h).headerType)?d:\\\"text\\\":null!=(u=a.table.getBodyColumnType(s,h))?u:\\\"text\\\";if(\\\"progressbar\\\"===d){var u=a.table.getBodyColumnDefine(s,h),c=a.table._getCellStyle(s,h),g=a.table.getCellValue(s,h),p=a.table.getCellOriginValue(s,h),f=getQuadProps(getProp2(\\\"padding\\\",c,s,h,a.table));let e;null!=u&&u.mergeCell&&(e=a.table.getCellRange(s,h));u=Factory2.getFunction(\\\"createProgressBarCell\\\")(u,c,l.attribute.width,g,p,s,h,f,a.table,e),c=l.getChildByName(\\\"progress-bar\\\");l.insertBefore(u,c),l.removeChild(c),c.removeAllChild(),c.release(),updateMergeCellContentHeight(l,t,i,a.table.isAutoRowHeight(h),!0,a.table)}else if(\\\"sparkline\\\"===d){l.removeAllChild();g=a.table._getCellStyle(s,h),p=getQuadProps(getProp2(\\\"padding\\\",g,s,h,a.table));Factory2.getFunction(\\\"createSparkLineCellGroup\\\")(l,l.parent,l.attribute.x,l.attribute.y,s,h,l.attribute.width,l.attribute.height,p,a.table,getStyleTheme(g,a.table,s,h,getProp2).theme,!1)}else if(\\\"image\\\"===d||\\\"video\\\"===d)updateImageCellContentWhileResize(l,s,h,0,i,a.table);else if(\\\"axis\\\"===(null==(f=l.firstChild)?void 0:f.name))null!=(u=l.firstChild)&&u.originAxis.resize(l.attribute.width,l.attribute.height);else{let n=!0;c=l.getChildByName(CUSTOM_CONTAINER_NAME)||l.getChildByName(CUSTOM_MERGE_CONTAINER_NAME);if(c){let o;l.removeChild(c);var r,m,b=getCustomCellMergeCustom(s,h,l,a.table);if(b)for(let e=b.start.row;e<=b.end.row;e++)e!==h&&((m=(r=a.getCell(s,e)).getChildByName(CUSTOM_CONTAINER_NAME)||r.getChildByName(CUSTOM_MERGE_CONTAINER_NAME)).removeAllChild(),r.removeChild(m),getCustomCellMergeCustom(s,e,r,a.table));else{let i,r;p=a.table.getCellLocation(s,h),g=(a.table.getCellRawRecord(s,h)||{}).vtableMerge;if(r=g&&a.table.options.groupTitleCustomLayout?a.table.options.groupTitleCustomLayout:\\\"body\\\"!==p?(d=a.table.getHeaderDefine(s,h),i=null==d?void 0:d.headerCustomRender,null==d?void 0:d.headerCustomLayout):(f=a.table.getBodyColumnDefine(s,h),i=(null==f?void 0:f.customRender)||a.table.customRender,null==f?void 0:f.customLayout),(i||r)&&isMergeCellGroup(l))for(let t=l.mergeStartCol;t<=l.mergeEndCol;t++)for(let e=l.mergeStartRow;e<=l.mergeEndRow;e++)e!==h&&a.updateCellContent(t,e);if(r||i){u=getQuadProps(getProp2(\\\"padding\\\",a.table._getCellStyle(s,h),s,h,a.table));let e=l.attribute.width,t=l.attribute.height;isMergeCellGroup(l)&&(e=a.table.getColsWidth(l.mergeStartCol,l.mergeEndCol),t=a.table.getRowsHeight(l.mergeStartRow,l.mergeEndRow));c=dealWithCustom(r,i,s,h,e,t,!1,a.table.isAutoRowHeight(h),u,isMergeCellGroup(l)?{start:{col:l.mergeStartCol,row:l.mergeStartRow},end:{col:l.mergeEndCol,row:l.mergeEndRow}}:void 0,a.table);o=c.elementsGroup,n=c.renderDefault}0<l.childrenCount&&o?l.insertBefore(o,l.firstChild):o&&l.appendChild(o)}}updateMergeCellContentHeight(l,t,i,a.table.isAutoRowHeight(h),n,a.table)}}}function updateMergeCellContentHeight(i,r,o,n,a,l){if(isMergeCellGroup(i)){r=0;for(let e=i.mergeStartRow;e<=i.mergeEndRow;e++)r+=l.getRowHeight(e);var{colStart:s,colEnd:h,rowStart:d,rowEnd:u}=getCellMergeRange(i,l.scenegraph);for(let t=s;t<=h;t++)for(let e=d;e<=u;e++){var c,g,p=l.scenegraph.getCell(t,e);\\\"cell\\\"===p.role&&(p.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})}),a&&updateCellContentHeight(p,r,o,n,getQuadProps(getProp2(\\\"padding\\\",c=l._getCellStyle(s,d),t,e,l)),c.textAlign,c.textBaseline,l),c=l.getRowHeight(e),g=l.getColWidth(t),g=(p.contentHeight=r,resizeCellGroup(p,g,c,{start:{col:i.mergeStartCol,row:i.mergeStartRow},end:{col:i.mergeEndCol,row:i.mergeEndRow}},l)).widthChange,g)&&(p.needUpdateWidth=!0)}}else{var e=l._getCellStyle(i.col,i.row);updateCellContentHeight(i,r,o,n,getQuadProps(getProp2(\\\"padding\\\",e,i.col,i.row,l)),e.textAlign,e.textBaseline,l)}}function updateColWidth(e,i,r,t){t||e.table._setColWidth(i,e.table.getColWidth(i)+r,!0);var o=e.getColGroup(i,!0),n=e.getColGroupInRightTopCorner(i),o=(o&&!n&&updateColunmWidth(o,r,\\\"col-corner\\\",e),n&&updateColunmWidth(n,r,\\\"right-top\\\",e),e.getColGroup(i)),n=(o&&updateColunmWidth(o,r,\\\"row-body\\\",e),e.getColGroupInLeftBottomCorner(i)),o=(n&&updateColunmWidth(n,r,\\\"left-bottom\\\",e),e.getColGroupInBottom(i)),a=(o&&updateColunmWidth(o,r,\\\"bottom\\\",e),e.getColGroupInRightBottomCorner(i));a&&updateColunmWidth(a,r,\\\"right-bottom\\\",e),i<e.frozenColCount?(e.cornerHeaderGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)}),e.rowHeaderGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)})):(e.colHeaderGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)}),e.bodyGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)})),n&&e.leftBottomCornerGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)}),o&&e.bottomFrozenGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)}),a&&e.rightBottomCornerGroup.forEachChildrenSkipChild((e,t)=>{e.col>i&&e.setAttribute(\\\"x\\\",e.attribute.x+r)})}function updateColunmWidth(e,r,s,h){let t,d,u,c,g,p,f,o=!1;const n=null!=(t=null==e?void 0:e.attribute.width)?t:0;if(null!=e&&e.setAttribute(\\\"width\\\",n+r),null!=e&&e.forEachChildren((t,e)=>{if(updateCellWidth(h,t,t.col,t.row,n,n+r,r,\\\"row-body\\\"!==s||t.col<h.table.rowHeaderLevelCount,h.table.internalProps.autoWrapText)){var i=getCellMergeInfo(h.table,t.col,t.row);if(i&&i.end.row-i.start.row)for(let e=i.start.row;e<=i.end.row;e++)resetRowHeight(h,e);else resetRowHeight(h,t.row);o=!0}}),o){let e,t,i,r=0;for(let o=0;o<h.table.colCount;o++)if(\\\"col-corner\\\"===s?(i=0,e=h.getColGroup(o,!0),t=null!=(d=h.colHeaderGroup.attribute.height)?d:0):\\\"row-body\\\"===s?(i=h.table.frozenRowCount,e=h.getColGroup(o,!1),t=null!=(u=h.bodyGroup.attribute.height)?u:0):\\\"bottom\\\"===s?(i=h.table.rowCount-h.table.bottomFrozenRowCount,e=h.getColGroupInBottom(o),t=null!=(c=h.bottomFrozenGroup.attribute.height)?c:0):\\\"left-bottom\\\"===s?(i=h.table.rowCount-h.table.bottomFrozenRowCount,e=h.getColGroupInLeftBottomCorner(o),t=null!=(g=h.leftBottomCornerGroup.attribute.height)?g:0):\\\"right-top\\\"===s?(i=0,e=h.getColGroupInRightTopCorner(o),t=null!=(p=h.rightTopCornerGroup.attribute.height)?p:0):\\\"right-bottom\\\"===s&&(i=h.table.rowCount-h.table.bottomFrozenRowCount,e=h.getColGroupInRightBottomCorner(o),t=null!=(f=h.rightBottomCornerGroup.attribute.height)?f:0),e){let i=0;e.forEachChildren(e=>{var t;e.setAttribute(\\\"y\\\",i),i+=null!=(t=h.table.getRowHeight(e.row))?t:0}),r=i}h.updateContainerHeight(i,r-t);for(let n=0;n<h.table.frozenColCount;n++){var m=h.getColGroupInLeftBottomCorner(n);let t=0;null!=m&&m.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=h.table.getRowHeight(e.row)})}for(let a=h.table.colCount-h.table.rightFrozenColCount;a<h.table.colCount;a++){var b=h.getColGroupInRightBottomCorner(a);let t=0;null!=b&&b.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=h.table.getRowHeight(e.row)})}for(let l=h.table.frozenColCount;l<h.table.colCount-h.table.rightFrozenColCount;l++){var C=h.getColGroupInBottom(l);let t=0;null!=C&&C.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=h.table.getRowHeight(e.row)})}}}function updateCellWidth(a,t,l,s,e,i,r,o,n){if(t.attribute.width===i&&!t.needUpdateWidth)return!1;t.needUpdateWidth=!1,t.setAttribute(\\\"width\\\",i);var h=t;if(!h)return!1;var d=a.table.isAutoRowHeight(s),u=null==(u=a.table.getCellRawRecord(l,s))?void 0:u.vtableMerge,c=!!a.table.getCustomMerge(l,s),u=u||c?\\\"text\\\":a.table.isHeader(l,s)?null!=(u=a.table._getHeaderLayoutMap(l,s).headerType)?u:\\\"text\\\":null!=(c=a.table.getBodyColumnType(l,s))?c:\\\"text\\\";let g=!1;if(\\\"progressbar\\\"===u){var c=a.table.getBodyColumnDefine(l,s),p=a.table._getCellStyle(l,s),f=a.table.getCellValue(l,s),m=a.table.getCellOriginValue(l,s),b=getQuadProps(getProp2(\\\"padding\\\",p,l,s,a.table));let e;null!=c&&c.mergeCell&&(e=a.table.getCellRange(l,s));var c=Factory2.getFunction(\\\"createProgressBarCell\\\")(c,p,h.attribute.width,f,m,l,s,b,a.table,e),p=h.getChildByName(\\\"progress-bar\\\"),f=(h.insertBefore(c,p),h.removeChild(p),p.removeAllChild(),p.release(),updateMergeCellContentWidth(h,i,r,d,!0,a.table));g=g||f}else if(\\\"sparkline\\\"===u){h.removeAllChild();var m=a.table._getCellStyle(l,s),b=getQuadProps(getProp2(\\\"padding\\\",m,l,s,a.table));Factory2.getFunction(\\\"createSparkLineCellGroup\\\")(h,h.parent,h.attribute.x,h.attribute.y,l,s,h.attribute.width,h.attribute.height,b,a.table,getStyleTheme(m,a.table,l,s,getProp2).theme,!1)}else if(\\\"image\\\"===u||\\\"video\\\"===u)updateImageCellContentWhileResize(h,l,s,r,0,a.table);else if(\\\"axis\\\"===(null==(c=h.firstChild)?void 0:c.name)){p=a.table.internalProps.layoutMap.getAxisConfigInPivotChart(l,s),f=getQuadProps(getProp2(\\\"padding\\\",a.table._getCellStyle(l,s),l,s,a.table));p&&(m=new(Factory2.getComponent(\\\"axis\\\"))(p,h.attribute.width,h.attribute.height,null!=(b=p.__vtablePadding)?b:f,a.table),h.clear(),h.appendChild(m.component),m.overlap())}else if(\\\"axis\\\"===(null==(u=t.firstChild)?void 0:u.name))null!=(c=t.firstChild)&&c.originAxis.resize(t.attribute.width,t.attribute.height);else{let n=!0;p=t.getChildByName(CUSTOM_CONTAINER_NAME)||t.getChildByName(CUSTOM_MERGE_CONTAINER_NAME);if(p){let o;t.removeChild(p);var C,v,y=getCustomCellMergeCustom(l,s,t,a.table);if(y)for(let e=y.start.col;e<=y.end.col;e++)e!==l&&((v=(C=a.getCell(e,s)).getChildByName(CUSTOM_CONTAINER_NAME)||C.getChildByName(CUSTOM_MERGE_CONTAINER_NAME)).removeAllChild(),C.removeChild(v),getCustomCellMergeCustom(e,s,C,a.table));else{let i,r;b=a.table.getCellLocation(l,s),f=(a.table.getCellRawRecord(l,s)||{}).vtableMerge;if(r=f&&a.table.options.groupTitleCustomLayout?a.table.options.groupTitleCustomLayout:\\\"body\\\"!==b?(m=a.table.getHeaderDefine(l,s),i=null==m?void 0:m.headerCustomRender,null==m?void 0:m.headerCustomLayout):(u=a.table.getBodyColumnDefine(l,s),i=(null==u?void 0:u.customRender)||a.table.customRender,null==u?void 0:u.customLayout),(i||r)&&isMergeCellGroup(h))for(let t=h.mergeStartCol;t<=h.mergeEndCol;t++)if(t!==l)for(let e=h.mergeStartRow;e<=h.mergeEndRow;e++)a.updateCellContent(t,e);if(r||i){c=getQuadProps(getProp2(\\\"padding\\\",a.table._getCellStyle(l,s),l,s,a.table));let e=h.attribute.width,t=h.attribute.height;isMergeCellGroup(h)&&(e=a.table.getColsWidth(h.mergeStartCol,h.mergeEndCol),t=a.table.getRowsHeight(h.mergeStartRow,h.mergeEndRow));p=dealWithCustom(r,i,l,s,e,t,!1,a.table.isAutoRowHeight(s),c,isMergeCellGroup(h)?{start:{col:h.mergeStartCol,row:h.mergeStartRow},end:{col:h.mergeEndCol,row:h.mergeEndRow}}:void 0,a.table);o=p.elementsGroup,n=p.renderDefault,g=!0}0<t.childrenCount&&o?t.insertBefore(o,t.firstChild):o&&t.appendChild(o)}}f=updateMergeCellContentWidth(h,i,r,d,n,a.table);g=g||f}return n=n||a.table._getCellStyle(l,s).autoWrapText,!(!d||!n)&&g}function updateMergeCellContentWidth(n,a,l,s,h,d){if(isMergeCellGroup(n)){a=0;let i=!1;for(let e=n.mergeStartCol;e<=n.mergeEndCol;e++)a+=d.getColWidth(e);let r=0;for(let t=n.mergeStartRow;t<=n.mergeEndRow;t++)r+=d.getRowHeight(t);var{colStart:u,colEnd:c,rowStart:g,rowEnd:p}=getCellMergeRange(n,d.scenegraph);for(let o=u;o<=c;o++)for(let t=g;t<=p;t++)if(o!==n.col||t===n.row){var f=d.scenegraph.getCell(o,t);if(\\\"cell\\\"===f.role){f.forEachChildren(e=>{e.setAttributes({dx:0,dy:0})});let e=!1;h&&(b=getQuadProps(getProp2(\\\"padding\\\",m=d._getCellStyle(u,g),o,t,d)),C=m.textAlign,m=m.textBaseline,e=updateCellContentWidth(f,a,r,l,s,b,C,m,d.scenegraph),b=getHierarchyOffset(f.col,f.row,d))&&(C=f.getChildByName(\\\"text\\\"),\\\"icon-left\\\"!==(null==(m=f.getChildByName(\\\"expand\\\")||f.getChildByName(\\\"collapse\\\"))?void 0:m.role))&&C&&C.setAttribute(\\\"dx\\\",b);var m=d.getRowHeight(t),b=d.getColWidth(o),C=(f.contentWidth=a,resizeCellGroup(f,b,m,{start:{col:n.mergeStartCol,row:n.mergeStartRow},end:{col:n.mergeEndCol,row:n.mergeEndRow}},d)).heightChange;C&&(f.needUpdateHeight=!0),i=i||e}}return i}var e=d._getCellStyle(n.col,n.row),t=getQuadProps(getProp2(\\\"padding\\\",e,n.col,n.row,d)),i=e.textAlign,e=e.textBaseline;return updateCellContentWidth(n,a,d.getRowHeight(n.row),l,s,t,i,e,d.scenegraph)}function resetRowHeight(e,t){var i=Math.round(computeRowHeight(t,0,e.table.colCount-1,e.table));e.table._setRowHeight(t,i,!0);for(let n=0;n<e.table.colCount;n++){var r=i,o=e.highPerformanceGetCell(n,t);\\\"empty\\\"!==o.role&&updateCellHeightForRow(e,o,n,t,r,r-o.attribute.height,e.table.isHeader(n,t))}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),function(e){e.dropDown=\\\"dropDown\\\",e.contextmenu=\\\"contextmenu\\\",e.custom=\\\"custom\\\"}(MenuType=MenuType||{});var menuStyle={fontSize:12,fontFamily:\\\"Arial,sans-serif\\\",color:\\\"#000\\\",highlightColor:\\\"#2E68CF\\\",hoverBgColor:\\\"#EEE\\\",lineHeight:30,bgColor:\\\"#FFF\\\",cornerRadius:4,borderWidth:.5,borderColor:\\\"#CCC\\\",menuPadding:6,menuItemPadding:9,maxLineWidth:200},MenuHandler=class{constructor(e){this._table=e,this._menuInstance=new Group2({x:0,y:0,fill:menuStyle.bgColor,stroke:menuStyle.borderColor,cornerRadius:menuStyle.cornerRadius,lineWidth:menuStyle.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:MenuType.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(e){e.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(e,t,i,r,o,n){if(o===MenuType.dropDown&&this.checkDropDownMenuChange(i,r)){var a=this.getMenuInfo(i,r,o);if(!a)return;var{menuInfo:a,highlightIndex:l}=a;this.updateMenuInfo(i,r,o,a,l),this.updateMenuInstance(a,l)}else if(o===MenuType.contextmenu&&this.checkContextMenuChange(e,t)){a=this.getMenuInfo(i,r,o);if(!a)return;var{menuInfo:l,highlightIndex:a}=a;this.updateMenuInfo(i,r,o,l,a),this.updateMenuInstance(l,a)}this.updatePosition(e-this._table.scenegraph.x,t-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(e,t,i,r,o){this._menuInfo.col=e,this._menuInfo.row=t,this._menuInfo.type=i,this._menuInfo.menuInfo=r,this._menuInfo.highlightIndex=o}checkDropDownMenuChange(e,t){var{type:i,col:r,row:o}=this._menuInfo;return i!==MenuType.dropDown||e!==r||t!==o}checkContextMenuChange(e,t){var{type:i,menuInfo:r}=this._menuInfo;return i!==MenuType.contextmenu||r!==(null==(i=this._table.internalProps.menu)?void 0:i.contextMenuItems)}updateMenuInstance(e,s){this._menuInstance.removeAllChild();let h=menuStyle.menuPadding;const d=menuStyle.menuPadding;let u=0;e.forEach((e,t)=>{var i=s===t;let r,o;\\\"string\\\"==typeof e?o=e:\\\"object\\\"==typeof e&&(o=e.text,r=i?e.selectedIcon:e.icon);const n=new Group2({y:h,x:d,height:menuStyle.lineHeight,fill:menuStyle.bgColor});n.role=\\\"menu-item\\\",this._menuInstance.appendChild(n),n.stateProxy=e=>\\\"hover\\\"===e?{fill:menuStyle.hoverBgColor}:{fill:menuStyle.bgColor},n.addEventListener(\\\"pointerenter\\\",e=>{n.addState(\\\"hover\\\",!0,!1),this._table.scenegraph.updateNextFrame()}),n.addEventListener(\\\"pointerleave\\\",e=>{n.removeState(\\\"hover\\\",!1),this._table.scenegraph.updateNextFrame()});var a,l,i=new Text({x:menuStyle.menuItemPadding,y:menuStyle.menuItemPadding,fill:i?menuStyle.highlightColor:menuStyle.color,text:o,textBaseline:\\\"top\\\",fontSize:menuStyle.fontSize,fontFamily:menuStyle.fontFamily,pickable:!1,maxLineWidth:menuStyle.maxLineWidth,ellipsis:\\\"…\\\"});n.addChild(i),r&&(i.AABBBounds.height(),a=null!=(a=r.width)?a:16,l=null!=(l=r.height)?l:16,(l=new Icon({x:menuStyle.menuItemPadding,y:(menuStyle.lineHeight-l)/2,width:a,height:l,image:r.svg,pickable:!1})).role=\\\"menu-icon\\\",n.insertBefore(l,i),i.setAttribute(\\\"x\\\",a+menuStyle.menuItemPadding)),u=Math.max(n.AABBBounds.width(),u),h+=menuStyle.lineHeight}),this._menuInstance.setAttributes({width:u+2*menuStyle.menuItemPadding+2*menuStyle.menuPadding,height:h+menuStyle.menuPadding}),this._menuInstance.forEachChildren(e=>{e.setAttribute(\\\"width\\\",u+2*menuStyle.menuItemPadding)})}updatePosition(e,t){this._menuInstance.setAttributes({x:this._menuInfo.type===MenuType.dropDown?e-this._menuInstance.attribute.width:e,y:t}),this._menuInfo.x=MenuType.dropDown?e-this._menuInstance.attribute.width:e,this._menuInfo.y=t}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(r,o,e){if(e===MenuType.dropDown){let t=this._table.globalDropDownMenu,i=(\\\"function\\\"==typeof(t=this._table._getHeaderLayoutMap(r,o).dropDownMenu)&&(t=t({row:o,col:r,table:this._table})),-1);if(Array.isArray(t))for(let e=0;e<t.length;e++)if(this._table._dropDownMenuIsHighlight(r,o,e)){i=e;break}return{menuInfo:t,highlightIndex:i}}if(e===MenuType.contextmenu){var t,i=null==(i=this._table.internalProps.menu)?void 0:i.contextMenuItems;let e;return Array.isArray(i)?e=i:\\\"function\\\"==typeof i&&(t=(this._table.isHeader(r,o)?this._table.getHeaderDefine(r,o):this._table.getBodyColumnDefine(r,o)).field,e=i(t,o,r)),{menuInfo:e,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener(\\\"click\\\",e=>{var t,i=e.target;i&&\\\"menu-item\\\"===i.role&&(i=this.getEventInfo(i),t=this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type),(i=Object.assign(i,t)).event=e.nativeEvent,this._table.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,i))})}getEventInfo(i){var e=i.parent;let r=0;e.forEachChildren((e,t)=>e===i&&(r=t-1,!0));var e=\\\"string\\\"==typeof this._menuInfo.menuInfo[r]?this._menuInfo.menuInfo[r]:this._menuInfo.menuInfo[r].text,t=\\\"string\\\"!=typeof this._menuInfo.menuInfo[r]&&this._menuInfo.menuInfo[r].menuKey||e;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:r,highlight:r===this._menuInfo.highlightIndex,text:e,menuKey:t}}get bounds(){return this._menuInstance.globalAABBBounds}},regedIcons=(init_esbuild_inject(),get3()),DrillIcon=class{constructor(){var e=regedIcons.drillDown;this.icon=new Icon({x:-1e3,y:-1e3,image:e.svg,width:e.width,height:e.height,dx:-e.width/2,dy:-e.height/2,visible:!1,funcType:e.funcType,cursor:e.cursor}),this.icon.role=\\\"icon-drill\\\"}appand(e){e.appendChild(this.icon)}update(e,t,i,r,o,n){var a,l;!e||r&&o?this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}):(a=regedIcons.drillDown,l=regedIcons.drillUp,this.icon.setAttributes({x:t,y:i,image:(r?a:l).svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image)),n.updateNextFrame()}},CellMover=(init_esbuild_inject(),class{constructor(e){var t=e.theme.dragHeaderSplitLine.lineWidth,i=e.theme.dragHeaderSplitLine.lineColor,r=e.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=createSymbol({visible:!1,pickable:!1,x:0,y:0,symbolType:\\\"triangle\\\",fill:i}),this.columnMoverLine=createLine({visible:!1,pickable:!1,stroke:i,lineWidth:t,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=createRect({visible:!1,pickable:!1,fill:r,x:0,y:0,width:0,height:0}),this.table=e}appand(e){e.appendChild(this.columnMoverLabel),e.appendChild(this.columnMoverLine),e.appendChild(this.columnMoverBack)}show(e,t,i){var r=this.table.getCellLocation(e,t),o=getCellMergeInfo(this.table,e,t);o&&(e=o.start.col,t=o.start.row);let n=0,a=0,l=0,s=0,h=0,d=0,u=0,c=0,g=Math.PI;var p=[];return\\\"columnHeader\\\"===r?(n=this.table.getColsWidth(0,e-1)-this.table.stateManager.scroll.horizontalBarPos,a=this.table.getRowsHeight(0,this.table.frozenRowCount-1),s=this.table.tableNoFrameHeight,l=o?this.table.getColsWidth(o.start.col,o.end.col):this.table.getColWidth(e),h=n-i,u=n+l,c=2,p.push({x:0,y:0}),p.push({x:0,y:this.table.tableNoFrameHeight})):\\\"rowHeader\\\"!==r&&!this.table.internalProps.layoutMap.isSeriesNumberInBody(e,t)||(a=this.table.getRowsHeight(0,t-1)-this.table.stateManager.scroll.verticalBarPos,n=this.table.getColsWidth(0,this.table.frozenColCount-1),l=this.table.tableNoFrameWidth,s=o?this.table.getRowsHeight(o.start.row,o.end.row):this.table.getRowHeight(t),d=a-i,u=2,c=a+s,g=Math.PI/2,p.push({x:0,y:0}),p.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:n-h,y:a-d,width:l,height:s,dx:h,dy:d}),this.columnMoverLine.setAttributes({x:u,y:c,visible:!0,points:p}),this.columnMoverLabel.setAttributes({visible:!0,x:u,y:c,angle:g}),{backX:n-h,lineX:u,backY:a-d,lineY:c}}hide(){this.columnMoverLabel.setAttribute(\\\"visible\\\",!1),this.columnMoverLine.setAttribute(\\\"visible\\\",!1),this.columnMoverBack.setAttribute(\\\"visible\\\",!1)}update(e,t,i,r){\\\"number\\\"==typeof e&&\\\"number\\\"==typeof t?(this.columnMoverLabel.setAttribute(\\\"x\\\",t),this.columnMoverLine.setAttribute(\\\"x\\\",t),this.columnMoverBack.setAttribute(\\\"x\\\",e)):\\\"number\\\"==typeof i&&\\\"number\\\"==typeof r&&(this.columnMoverLabel.setAttribute(\\\"y\\\",r),this.columnMoverLine.setAttribute(\\\"y\\\",r),this.columnMoverBack.setAttribute(\\\"y\\\",i))}updateStyle(){var e=this.table.theme.dragHeaderSplitLine.lineWidth,t=this.table.theme.dragHeaderSplitLine.lineColor,i=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:t}),this.columnMoverLine.setAttributes({stroke:t,lineWidth:e}),this.columnMoverBack.setAttributes({fill:i})}});function getColX(e,t,i){if(i)return Math.min(t.tableNoFrameWidth,t.getAllColsWidth())-t.getColsWidth(e,t.colCount-1);let r=t.getColsWidth(0,e);return e>=t.frozenColCount&&(r-=t.scrollLeft),r}function getRowY(e,t,i){if(i)return Math.min(t.tableNoFrameWidth,t.getAllRowsHeight())-t.getRowsHeight(e,t.rowCount-1);let r=t.getRowsHeight(0,e);return e>=t.frozenRowCount&&(r-=t.scrollTop),r}init_esbuild_inject();var TableComponent=class{constructor(e){this.table=e;var t=this.table.theme,i=(this.createScrollBar(),null==(i=t.columnResize)?void 0:i.lineColor),r=null==(r=t.columnResize)?void 0:r.lineWidth,o=null==(o=t.columnResize)?void 0:o.bgColor,n=null==(n=t.columnResize)?void 0:n.width,a=null==(a=null==(a=t.columnResize)?void 0:a.labelVisible)||a,l=null==(l=t.columnResize)?void 0:l.labelColor,s=null==(s=t.columnResize)?void 0:s.labelFontSize,h=null==(h=t.columnResize)?void 0:h.labelFontFamily,d=null==(d=t.columnResize)?void 0:d.labelBackgroundFill,u=null==(u=t.columnResize)?void 0:u.labelBackgroundCornerRadius,a=(this.labelVisible=a,this.columnResizeLine=createLine({visible:!1,pickable:!1,stroke:i,lineWidth:r,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=createLine({visible:!1,pickable:!1,stroke:o,lineWidth:n,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),createText({visible:!1,pickable:!1,x:0,y:0,fontSize:s,fill:l,fontFamily:h,text:\\\"\\\",textBaseline:\\\"top\\\",dx:16,dy:-s/2})),c=createRect({visible:!1,pickable:!1,fill:d,x:0,y:0,width:5*s*.8,height:s+8,cornerRadius:u,dx:12,dy:-s/2-4}),c=(this.columnResizeLabel=createGroup({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(c),this.columnResizeLabel.appendChild(a),this.rowResizeLine=createLine({visible:!1,pickable:!1,stroke:i,lineWidth:r,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=createLine({visible:!1,pickable:!1,stroke:o,lineWidth:n,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),createText({visible:!1,pickable:!1,x:0,y:0,fontSize:s,fill:l,fontFamily:h,text:\\\"\\\",textBaseline:\\\"top\\\",dx:16,dy:-s/2})),a=createRect({visible:!1,pickable:!1,fill:d,x:0,y:0,width:5*s*.8,height:s+8,cornerRadius:u,dx:12,dy:-s/2-4}),o=(this.rowResizeLabel=createGroup({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(a),this.rowResizeLabel.appendChild(c),this.cellMover=new CellMover(this.table),null==(r=null==(i=t.frozenColumnLine)?void 0:i.shadow)?void 0:r.width),h=null==(l=null==(n=t.frozenColumnLine)?void 0:n.shadow)?void 0:l.startColor,s=null==(u=null==(d=t.frozenColumnLine)?void 0:d.shadow)?void 0:u.endColor;this.frozenShadowLine=createRect({visible:!0,pickable:!1,x:0,y:0,width:o,height:0,fill:{gradient:\\\"linear\\\",x0:0,y0:0,x1:1,y1:0,stops:[{color:h,offset:0},{color:s,offset:1}]}}),this.rightFrozenShadowLine=createRect({visible:!0,pickable:!1,x:0,y:0,width:o,height:0,fill:{gradient:\\\"linear\\\",x0:0,y0:0,x1:1,y1:0,stops:[{color:s,offset:0},{color:h,offset:1}]}}),this.menu=new MenuHandler(this.table),this.drillIcon=new DrillIcon}addToGroup(e){e.addChild(this.frozenShadowLine),e.addChild(this.rightFrozenShadowLine),e.addChild(this.columnResizeBgLine),e.addChild(this.columnResizeLine),e.addChild(this.columnResizeLabel),e.addChild(this.rowResizeBgLine),e.addChild(this.rowResizeLine),e.addChild(this.rowResizeLabel),(this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(e.addChild(this.hScrollBar),e):(e.stage.defaultLayer.addChild(this.hScrollBar),e.stage.defaultLayer)).addChild(this.vScrollBar),this.menu.bindTableComponent(e),this.drillIcon.appand(e),this.cellMover.appand(e)}createScrollBar(){var e=this.table.theme,t=null==(t=e.scrollStyle)?void 0:t.scrollRailColor,i=null==(i=e.scrollStyle)?void 0:i.scrollSliderColor,r=null==(r=e.scrollStyle)?void 0:r.scrollSliderCornerRadius,o=null==(o=e.scrollStyle)?void 0:o.width,n=null==(n=e.scrollStyle)?void 0:n.horizontalPadding,e=null==(e=e.scrollStyle)?void 0:e.verticalPadding,r=isValid_default(r)?{cornerRadius:r,fill:i}:{fill:i};this.hScrollBar=new ScrollBar({direction:\\\"horizontal\\\",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:this.table.tableNoFrameWidth,height:o,padding:n,railStyle:{fill:t},sliderStyle:r,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new ScrollBar({direction:\\\"vertical\\\",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:o,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:e,railStyle:{fill:t},sliderStyle:r,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var e,t,i,r,o=this.table.stateManager.scroll.horizontalBarPos,n=this.table.stateManager.scroll.verticalBarPos,a=this.table.theme,l=null==(l=a.scrollStyle)?void 0:l.width,s=null==(s=a.scrollStyle)?void 0:s.visible,h=null!=(h=null==(h=a.scrollStyle)?void 0:h.horizontalVisible)?h:s,a=null!=(a=null==(a=a.scrollStyle)?void 0:a.verticalVisible)?a:s,s=Math.ceil(this.table.scenegraph.tableGroup.attribute.width),d=Math.ceil(this.table.scenegraph.tableGroup.attribute.height),u=this.table.getAllRowsHeight(),c=this.table.getAllColsWidth(),g=this.table.getFrozenRowsHeight(),p=this.table.getFrozenColsWidth(),f=this.table.getBottomFrozenRowsHeight(),m=this.table.getRightFrozenColsWidth(),b=null!=(b=this.table.options.customConfig)&&b._disableColumnAndRowSizeRound?1:0;s+b<c?(e=Math.min(d,u),r=Math.max(.05,(s-p)/(c-p)),t=this.table.theme.scrollStyle.hoverOn,i=0,i=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(t?l:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:e-(t?l:-this.table.scenegraph.tableGroup.attribute.y),this.hScrollBar.setAttributes({x:p+(t?0:this.table.scenegraph.tableGroup.attribute.x),y:i,width:s-p-m,range:[0,r],visible:\\\"always\\\"===h}),e=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds,this.hScrollBar._viewPosition={x:e.x1,y:e.y1},\\\"always\\\"===h&&this.hScrollBar.showAll()):this.hScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:0,visible:!1}),d+b<u?(t=Math.min(s,c),i=Math.max(.05,(d-g)/(u-g)),p=0,m=this.table.theme.scrollStyle.hoverOn,p=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(m?l:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:t-(m?l:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:p,y:g+(m?0:this.table.scenegraph.tableGroup.attribute.y),height:d-g-f,range:[0,i],visible:\\\"always\\\"===a}),r=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds,this.vScrollBar._viewPosition={x:r.x1,y:r.y1},\\\"always\\\"===a&&this.vScrollBar.showAll()):this.vScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,height:0,visible:!1}),this.table.stateManager.setScrollLeft(o),this.table.stateManager.setScrollTop(n)}hideResizeCol(){this.columnResizeLine.setAttribute(\\\"visible\\\",!1),this.columnResizeBgLine.setAttribute(\\\"visible\\\",!1),this.columnResizeLabel.setAttribute(\\\"visible\\\",!1),this.columnResizeLabel.hideAll()}showResizeCol(e,t,i){var r=getColX(e,this.table,i);this.columnResizeLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:r,y:t}),this.columnResizeLabel.lastChild.setAttribute(\\\"text\\\",this.table.getColWidth(e)+\\\"px\\\"))}updateResizeCol(e,t,i){var r=getColX(e,this.table,i);this.columnResizeLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:r,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:r,y:t}),this.columnResizeLabel.lastChild.setAttribute(\\\"text\\\",Math.floor(this.table.getColWidth(e))+\\\"px\\\"))}hideResizeRow(){this.rowResizeLine.setAttribute(\\\"visible\\\",!1),this.rowResizeBgLine.setAttribute(\\\"visible\\\",!1),this.rowResizeLabel.setAttribute(\\\"visible\\\",!1),this.rowResizeLabel.hideAll()}showResizeRow(e,t,i){var r=getRowY(e,this.table,i);this.rowResizeLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:r,x:t}),this.rowResizeLabel.lastChild.setAttribute(\\\"text\\\",this.table.getRowHeight(e)+\\\"px\\\"))}updateResizeRow(e,t,i){var r=getRowY(e,this.table,i);this.rowResizeLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:r,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:r,x:t}),this.rowResizeLabel.lastChild.setAttribute(\\\"text\\\",Math.floor(this.table.getRowHeight(e))+\\\"px\\\"))}hideMoveCol(){this.cellMover.hide()}showMoveCol(e,t,i){return this.cellMover.show(e,t,i)}updateMoveCol(e,t,i,r){this.cellMover.update(e,t,i,r)}setFrozenColumnShadow(e,t){var i;e<0?this.frozenShadowLine.setAttributes({visible:!1}):(i=getColX(e,this.table,t),this.frozenShadowLine.setAttributes({visible:!0,x:i,height:this.table.getDrawRange().height}))}setRightFrozenColumnShadow(e){var t;e>=this.table.colCount?this.rightFrozenShadowLine.setAttributes({visible:!1}):(t=getColX(e,this.table,!0),this.rightFrozenShadowLine.setAttributes({visible:!0,x:t-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height}))}hideVerticalScrollBar(){var e=this.table.theme.scrollStyle.visible,t=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;\\\"focus\\\"!==t&&\\\"scrolling\\\"!==t||(this.vScrollBar.setAttribute(\\\"visible\\\",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var e=this.table.theme.scrollStyle.visible,t=null!=(t=this.table.theme.scrollStyle.verticalVisible)?t:e;\\\"focus\\\"!==t&&\\\"scrolling\\\"!==t||(this.vScrollBar.setAttribute(\\\"visible\\\",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var e=this.table.theme.scrollStyle.visible,t=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;\\\"focus\\\"!==t&&\\\"scrolling\\\"!==t||(this.hScrollBar.setAttribute(\\\"visible\\\",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var e=this.table.theme.scrollStyle.visible,t=null!=(t=this.table.theme.scrollStyle.horizontalVisible)?t:e;\\\"focus\\\"!==t&&\\\"scrolling\\\"!==t||(this.hScrollBar.setAttribute(\\\"visible\\\",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(e){var t=this.vScrollBar.attribute.range,t=t[1]-t[0],i=e*(1-t),i=(this.vScrollBar.setAttribute(\\\"range\\\",[i,i+t]),this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds);this.vScrollBar._viewPosition={x:i.x1,y:i.y1}}updateHorizontalScrollBarPos(e){var t=this.hScrollBar.attribute.range,t=t[1]-t[0],i=e*(1-t),i=(this.hScrollBar.setAttribute(\\\"range\\\",[i,i+t]),this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds);this.hScrollBar._viewPosition={x:i.x1,y:i.y1}}updateStyle(){var e=this.table.theme,t=null==(t=e.scrollStyle)?void 0:t.scrollRailColor,i=null==(i=e.scrollStyle)?void 0:i.scrollSliderColor,r=null==(r=e.scrollStyle)?void 0:r.scrollSliderCornerRadius,o=null==(o=e.scrollStyle)?void 0:o.width,n=null==(n=e.scrollStyle)?void 0:n.horizontalPadding,a=null==(a=e.scrollStyle)?void 0:a.verticalPadding,r=isValid_default(r)?{cornerRadius:r,fill:i}:{fill:i},n=(this.hScrollBar.setAttributes({height:o,padding:n,railStyle:{fill:t},sliderStyle:r}),this.vScrollBar.setAttributes({width:o,padding:a,railStyle:{fill:t},sliderStyle:r}),null==(i=e.columnResize)?void 0:i.lineColor),a=null==(o=e.columnResize)?void 0:o.lineWidth,r=null==(t=e.columnResize)?void 0:t.bgColor,o=null==(i=e.columnResize)?void 0:i.width,i=(this.columnResizeLine.setAttributes({stroke:n,lineWidth:a}),this.columnResizeBgLine=createLine({stroke:r,lineWidth:o}),null==(t=e.columnResize)?void 0:t.labelColor),a=null==(n=e.columnResize)?void 0:n.labelFontSize,o=null==(r=e.columnResize)?void 0:r.labelFontFamily,n=null==(t=e.columnResize)?void 0:t.labelBackgroundFill,t=null==(r=e.columnResize)?void 0:r.labelBackgroundCornerRadius,r=null==(r=null==(r=e.columnResize)?void 0:r.labelVisible)||r,o=(this.labelVisible=r,this.columnResizeLabel.lastChild.setAttributes({fontSize:a,fill:i,fontFamily:o,dy:-a/2}),this.columnResizeLabel.firstChild.setAttributes({fill:n,width:5*a*.8,height:a+8,cornerRadius:t,dy:-a/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:a,fill:i,fontFamily:o,dy:-a/2}),this.rowResizeLabel.firstChild.setAttributes({fill:n,width:5*a*.8,height:a+8,cornerRadius:t,dy:-a/2-4}),null==(i=null==(r=e.frozenColumnLine)?void 0:r.shadow)?void 0:i.width),a=null==(t=null==(n=e.frozenColumnLine)?void 0:n.shadow)?void 0:t.startColor,n=null==(i=null==(r=e.frozenColumnLine)?void 0:r.shadow)?void 0:i.endColor;this.frozenShadowLine.setAttributes({width:o,fill:{gradient:\\\"linear\\\",x0:0,y0:0,x1:1,y1:0,stops:[{color:a,offset:0},{color:n,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:o,fill:{gradient:\\\"linear\\\",x0:0,y0:0,x1:1,y1:0,stops:[{color:n,offset:0},{color:a,offset:1}]}}),this.cellMover.updateStyle()}};function createFrameBorder(r,o,e,t,n){if(o){var a=\\\"table\\\"===e,{shadowBlur:l,shadowOffsetX:s,shadowOffsetY:h,shadowColor:d,cornerRadius:u,borderColor:c,borderLineWidth:g,borderLineDash:p}=o;let i=!1;var f={},m={pickable:!1},s=(l&&a&&(m.shadowBlur=l,m.shadowOffsetX=s,m.shadowOffsetY=h,m.shadowColor=d,m.stroke=!0,m.stroke=d,m.lineWidth=1,i=!0),g&&(m.stroke=!0,m.fill=!1,m.stroke=getStroke(null!=c?c:\\\"#E1E4E8\\\",t,g),m.lineWidth=g,p&&(m.lineDash=p),m.lineCap=\\\"butt\\\"),Array.isArray(c)&&(m.strokeArrayColor=getQuadProps(c)),Array.isArray(g)&&(m.strokeArrayWidth=getQuadProps(g),m.lineWidth=1),u&&(f.cornerRadius=m.cornerRadius=u),m.strokeArrayWidth?m.strokeArrayWidth[0]:null!=(l=m.lineWidth)?l:0),d=m.strokeArrayWidth?m.strokeArrayWidth[1]:null!=(h=m.lineWidth)?h:0,c=m.strokeArrayWidth?m.strokeArrayWidth[2]:null!=(p=m.lineWidth)?p:0,h=m.strokeArrayWidth?m.strokeArrayWidth[3]:null!=(l=m.lineWidth)?l:0;if(r.setAttributes(f),!n)if(m.stroke)if(m.x=h/2,m.y=s/2,m.pickable=!1,a){u&&(Array.isArray(u)?(p=getQuadProps(u),(f.cornerRadius=m.cornerRadius=p)[0]&&(p[0]=p[0]+Math.min(h,s)/2),p[1]&&(p[1]=p[1]+Math.min(s,d)/2),p[2]&&(p[2]=p[2]+Math.min(d,c)/2),p[3]&&(p[3]=p[3]+Math.min(c,h)/2)):isArray_default(g)?((f.cornerRadius=m.cornerRadius=l=[])[0]=u+Math.min(h,s)/2,l[1]=u+Math.min(s,d)/2,l[2]=u+Math.min(d,c)/2,l[3]=u+Math.min(c,h)/2):(m.cornerRadius=u+(null!=(a=m.lineWidth)?a:0)/2,f.cornerRadius=u+(null!=(p=m.lineWidth)?p:0)/2));let e,t;o.innerBorder?(m.x=r.attribute.x+h/2,m.y=r.attribute.y+s/2,m.width=r.attribute.width-h/2-d/2,m.height=r.attribute.height-s/2-c/2):(m.x=r.attribute.x-h/2,m.y=r.attribute.y-s/2,m.width=r.attribute.width+h/2+d/2,m.height=r.attribute.height+s/2+c/2),i?(m.fill=\\\"white\\\",m.notAdjustPos=!0,(t=createGroup(m)).name=\\\"table-border-rect\\\",e=createRect({x:h/2,y:s/2,width:r.attribute.width,height:r.attribute.height,fill:\\\"red\\\",cornerRadius:r.attribute.cornerRadius,globalCompositeOperation:\\\"destination-out\\\"}),t.addChild(e),g=createRect({x:h/2,y:s/2,width:r.attribute.width,height:r.attribute.height,fill:\\\"transparent\\\",pickable:!1,globalCompositeOperation:\\\"source-over\\\"}),t.addChild(g)):(t=createRect(m)).name=\\\"table-border-rect\\\",o.innerBorder&&!i?r.parent.insertAfter(t,r):r.parent.insertBefore(t,r),r.border=t}else{m.width=r.attribute.width-h/2-d/2,m.height=r.attribute.height-s/2-c/2;l=createRect(m);l.name=\\\"border-rect\\\",r.addChild(l),r.border=l}else{a=createRect({fill:!1,stroke:!1,pickable:!1,lineWidth:0});a.name=\\\"border-rect\\\",r.addChild(a),r.border=a}}}function updateFrameBorder(e,t,i){var r,o;t&&(o=t.borderColor,null!=(r=e.border))&&r.setAttribute(\\\"stroke\\\",getStroke(o,i))}function getStroke(t,e,i){let r=!0;return!e&&!isArray_default(i)||isArray_default(t)?e?r=e:isArray_default(t)?isArray_default(t)&&(r=!0):r=t:r=(null!=e?e:i).map(e=>!!e&&t),r}function updateFrameBorderSize(e){var t,i,r,o;e.border&&(t=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[0]:null!=(t=e.border.attribute.lineWidth)?t:0,i=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[1]:null!=(i=e.border.attribute.lineWidth)?i:0,r=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[2]:null!=(r=e.border.attribute.lineWidth)?r:0,o=e.border.attribute.strokeArrayWidth?e.border.attribute.strokeArrayWidth[3]:null!=(o=e.border.attribute.lineWidth)?o:0,e.border.setAttributes({borderLeft:o,borderTop:t,borderRight:i,borderBottom:r,width:e.attribute.width-o/2-i/2,height:e.attribute.height-t/2-r/2}),\\\"group\\\"===e.border.type)&&e.border.firstChild.setAttributes({width:e.attribute.width,height:e.attribute.height})}function updateCornerRadius(e){var t,i,r,o,n,a,l,s,h,d;e.theme.frameStyle.cornerRadius&&(d=e.theme.frameStyle.cornerRadius,({cornerHeaderGroup:t,colHeaderGroup:i,rowHeaderGroup:r,bodyGroup:o,rightTopCornerGroup:n,leftBottomCornerGroup:a,rightBottomCornerGroup:l,rightFrozenGroup:s,bottomFrozenGroup:h}=e.scenegraph),t.setAttribute(\\\"cornerRadius\\\",0),i.setAttribute(\\\"cornerRadius\\\",0),r.setAttribute(\\\"cornerRadius\\\",0),o.setAttribute(\\\"cornerRadius\\\",0),n.setAttribute(\\\"cornerRadius\\\",0),a.setAttribute(\\\"cornerRadius\\\",0),l.setAttribute(\\\"cornerRadius\\\",0),s.setAttribute(\\\"cornerRadius\\\",0),h.setAttribute(\\\"cornerRadius\\\",0),d=toBoxArray(d),0<t.attribute.width&&0<t.attribute.height?setCornerRadius(t,[d[0],0,0,0]):0<i.attribute.height?setCornerRadius(i,[d[0],0,0,0]):0<r.attribute.width?setCornerRadius(r,[d[0],0,0,0]):setCornerRadius(o,[d[0],0,0,0]),0<a.attribute.width&&0<a.attribute.height?setCornerRadius(a,[0,0,0,d[3]]):0<h.attribute.height?setCornerRadius(h,[0,0,0,d[3]]):0<r.attribute.width?setCornerRadius(r,[0,0,0,d[3]]):setCornerRadius(o,[0,0,0,d[3]]),0<n.attribute.width&&0<n.attribute.height?setCornerRadius(n,[0,d[1],0,0]):0<i.attribute.height?setCornerRadius(i,[0,d[1],0,0]):0<s.attribute.width?setCornerRadius(s,[0,d[1],0,0]):setCornerRadius(o,[0,d[1],0,0]),0<l.attribute.width&&0<l.attribute.height?setCornerRadius(l,[0,0,d[2],0]):0<s.attribute.width?setCornerRadius(s,[0,0,d[2],0]):0<h.attribute.height?setCornerRadius(h,[0,0,d[2],0]):setCornerRadius(o,[0,0,d[2],0]))}function setCornerRadius(e,t){e.setAttribute(\\\"cornerRadius\\\",t),e.border&&e.border.setAttribute(\\\"cornerRadius\\\",t)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var CHART_NUMBER_TYPE=genNumberType(),Chart=class cb1 extends Group{constructor(e,t){var i;super(t),this.type=\\\"chart\\\",this.numberType=CHART_NUMBER_TYPE,this.isShareChartSpec=e,t.chartInstance?this.chartInstance=t.chartInstance:((i=this.chartInstance=new t.ClassType(t.spec,merge({},this.attribute.tableChartOption,{renderCanvas:t.canvas,mode:\\\"node\\\"===this.attribute.mode?\\\"node\\\":\\\"desktop-browser\\\",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:t.dpr,interactive:!1,animation:!1,autoFit:!1}))).renderSync(),i.getStage().enableDirtyBounds(),t.chartInstance=this.chartInstance=i)}activate(o){var e,t;this.active=!0;let{col:i,row:r}=this.parent,{x1:n,y1:a,x2:l,y2:s}=this.getViewBox(),h=getTableBounds(i,r,o).intersect({x1:n-o.scrollLeft,x2:l-o.scrollLeft,y1:a-o.scrollTop,y2:s-o.scrollTop});null!=(t=this.activeChartInstance)&&t.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,merge({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:\\\"desktop-browser\\\",canvasControled:!1,viewBox:{x1:0,x2:l-n,y1:0,y2:s-a},dpr:o.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:e=>{var t=this.stage,i=e.window.getContext(),r=t.window.getViewBoxTransform(),t=t.window.getViewBox();i.inuse=!0,i.clearMatrix(),i.setTransform(r.a,r.b,r.c,r.d,r.e,r.f,!0),i.translate(t.x1,t.y1),i.setTransformForCurrent(!0),i.beginPath(),i.rect(h.x1,h.y1,h.x2-h.x1,h.y2-h.y1),i.clip(),i.clearMatrix(),o.options.canvas&&!e.needRender&&(e.pauseRender(),o.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),o.scenegraph.updateNextFrame())},afterRender(e){e.window.getContext().inuse=!1,e.needRender=!1,d.resumeRender()}}));const d=this.activeChartInstance.getStage(),u=this.globalTransMatrix.clone(),c=this.stage.window.getViewBoxTransform();u.multiply(c.a,c.b,c.c,c.d,c.e,c.f),d.window.setViewBoxTransform&&d.window.setViewBoxTransform(u.a,u.b,u.c,u.d,u.e,u.f),this.activeChartInstance.renderSync(),null!=(e=null==(t=o.internalProps.layoutMap)?void 0:t.updateDataStateToActiveChartInstance)&&e.call(t,this.activeChartInstance),this.activeChartInstance.on(\\\"click\\\",e=>{var t;!1===(null==(t=this.attribute.spec.select)?void 0:t.enable)?o.scenegraph.updateChartState(null):cb1.temp&&o.scenegraph.updateChartState(null==e?void 0:e.datum)}),this.activeChartInstance.on(\\\"brushEnd\\\",e=>{var t;o.scenegraph.updateChartState(null==(t=null==e?void 0:e.value)?void 0:t.inBrushData),cb1.temp=0,setTimeout(()=>{cb1.temp=1},0)}),null!=(t=o._bindChartEvent)&&t.call(o,this.activeChartInstance)}deactivate(){var e;this.active=!1,null!=(e=this.activeChartInstance)&&e.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),null!=(e=this.activeChartInstance)&&e.release(),this.activeChartInstance=null}updateData(e){this.attribute.data=e}getViewBox(){var e,t=this.parent,i=this.attribute.cellPadding,r=this.stage.table,{x1:o,y1:n}=t.globalAABBBounds;return{x1:Math.ceil(o+i[3]+r.scrollLeft+(null!=(e=null==(e=r.options.viewBox)?void 0:e.x1)?e:0)),x2:Math.ceil(o+t.attribute.width-i[1]+r.scrollLeft+(null!=(o=null==(e=r.options.viewBox)?void 0:e.x1)?o:0)),y1:Math.ceil(n+i[0]+r.scrollTop+(null!=(o=null==(e=r.options.viewBox)?void 0:e.y1)?o:0)),y2:Math.ceil(n+t.attribute.height-i[2]+r.scrollTop+(null!=(o=null==(e=r.options.viewBox)?void 0:e.y1)?o:0))}}};function getTableBounds(e,t,i){var r=i.internalProps.layoutMap,o=new Bounds,n=i.scenegraph.tableGroup.globalAABBBounds;return o.x1=n.x1,o.x2=n.x2,o.y1=n.y1,o.y2=n.y2,r.isLeftBottomCorner(e,t)||r.isRightTopCorner(e,t)||r.isLeftTopCorner(e,t)||r.isRightBottomCorner(e,t)||(r.isFrozenColumn(e,t)?(o.y1=n.y1+i.getFrozenRowsHeight(),o.y2=n.y2-i.getBottomFrozenRowsHeight()):r.isFrozenRow(e,t)?(o.x1=n.x1+i.getFrozenColsWidth(),o.x2=n.x2-i.getRightFrozenColsWidth()):r.isRightFrozenColumn(e,t)?(o.y1=n.y1+i.getFrozenRowsHeight(),o.y2=n.y2-i.getBottomFrozenRowsHeight()):r.isBottomFrozenRow(e,t)?(o.x1=n.x1+i.getFrozenColsWidth(),o.x2=n.x2-i.getRightFrozenColsWidth()):r.isFrozenColumn(e,t)||r.isRightFrozenColumn(e,t)||(o.x1=n.x1+i.getFrozenColsWidth(),o.x2=n.x2-i.getRightFrozenColsWidth(),o.y1=n.y1+i.getFrozenRowsHeight(),o.y2=n.y2-i.getBottomFrozenRowsHeight())),o.x1=o.x1+(null!=(n=null==(r=i.options.viewBox)?void 0:r.x1)?n:0),o.x2=o.x2+(null!=(n=null==(r=i.options.viewBox)?void 0:r.x1)?n:0),o.y1=o.y1+(null!=(n=null==(r=i.options.viewBox)?void 0:r.y1)?n:0),o.y2=o.y2+(null!=(n=null==(r=i.options.viewBox)?void 0:r.y1)?n:0),o}Chart.temp=1,init_esbuild_inject();var chartRenderKeys=[],chartRenderQueueList=[],batchRenderChartCount=5,isHandlingChartQueue=!1;function setBatchRenderChartCount(e){isValid_default(e)&&(batchRenderChartCount=e)}function IsHandlingChartQueue(){return isHandlingChartQueue}function renderChart(e){var t,i,{axes:r,dataId:o,data:n,spec:a,ClassType:l,canvas:s,mode:h,modeParams:d,dpr:u}=e.attribute;let c=e.chartInstance;c||((c=new l(a,{renderCanvas:s,mode:\\\"node\\\"===h?\\\"node\\\":\\\"desktop-browser\\\",modeParams:d,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:u,interactive:!1,animation:!1,autoFit:!1})).renderSync(),e.chartInstance=c);var s=e.getViewBox(),h=(s.x2<=s.x1&&(s.x2=s.x1+1),s.y2<=s.y1&&(s.y2=s.y1+1),c.updateViewBox({x1:0,x2:s.x2-s.x1,y1:0,y2:s.y2-s.y1},!1,!1),c.getStage()),d=e.globalTransMatrix.clone(),u=e.stage.window.getViewBoxTransform(),l=(d.multiply(u.a,u.b,u.c,u.d,u.e,u.f),h.window.setViewBoxTransform&&h.window.setViewBoxTransform(d.a,d.b,d.c,d.d,d.e,d.f),e.getRootNode()).table;let g=!1;if(l.options.specFormat&&(s=l.options.specFormat(e.attribute.spec,c,e)).needFormatSpec&&s.spec&&(u=s.spec,c.updateSpecSync(u),g=null==(d=s.updateSpec)||d),!g)if(null!=r&&r.forEach((e,t)=>{var i;\\\"band\\\"===e.type?c.updateModelSpec({type:\\\"axes\\\",index:t},{domain:e.domain.slice(0)},!0):c.updateModelSpecSync({type:\\\"axes\\\",index:t},{min:null!=(i=null==(i=e.range)?void 0:i.min)?i:0,max:null!=(i=null==(i=e.range)?void 0:i.max)?i:0,tick:{tickMode:null==(i=e.tick)?void 0:i.tickMode}},!0)}),null!=(u=null==(h=l.internalProps.layoutMap)?void 0:h.updateDataStateToActiveChartInstance)&&u.call(h,c),\\\"string\\\"==typeof o)c.updateDataSync(o,null!=n?n:[]);else{var p=[];for(const f in o){const m=o[f],b=a.series.find(e=>{var t;return(null==(t=null==e?void 0:e.data)?void 0:t.id)===f});p.push({id:f,values:m?null!=(t=null==n?void 0:n.filter(e=>e.hasOwnProperty(m)))?t:[]:null!=n?n:[],fields:null==(t=null==b?void 0:b.data)?void 0:t.fields}),c.updateFullDataSync||c.updateDataSync(f,m?null!=(i=null==n?void 0:n.filter(e=>e.hasOwnProperty(m)))?i:[]:null!=n?n:[])}null!=(s=c.updateFullDataSync)&&s.call(c,p)}cacheStageCanvas(c.getStage(),e)}function startRenderChartQueue(t){isHandlingChartQueue=!0,0<chartRenderQueueList.length?requestAnimationFrame(()=>{var e=chartRenderQueueList.splice(0,batchRenderChartCount);chartRenderKeys.splice(0,batchRenderChartCount),e.forEach(e=>{renderChart(e),e.addUpdateBoundTag()}),t.render(),startRenderChartQueue(t)}):isHandlingChartQueue=!1}var cacheCanvasSizeLimit=2e3;function cacheStageCanvas(i,e){var t,{viewWidth:r,viewHeight:o}=i;if(r<cacheCanvasSizeLimit&&o<cacheCanvasSizeLimit)e.cacheCanvas=toCanvas(i),e.isShareChartSpec||(null!=(t=e.chartInstance)&&t.release(),e.chartInstance=null,e.setAttribute(\\\"chartInstance\\\",null));else{var n=Math.ceil(o/cacheCanvasSizeLimit),a=Math.ceil(r/cacheCanvasSizeLimit),l=[];for(let t=0;t<n;t++)for(let e=0;e<a;e++){var s=e*cacheCanvasSizeLimit,h=t*cacheCanvasSizeLimit,d=r<s+cacheCanvasSizeLimit?r:s+cacheCanvasSizeLimit,u=o<h+cacheCanvasSizeLimit?o:h+cacheCanvasSizeLimit,c=d-s,g=u-h,p=new Bounds,d=(p.setValue(s,h,d,u),toCanvas(i,!1,p));l.push({canvas:d,x:s,y:h,width:c,height:g})}e.cacheCanvas=l}}function toCanvas(e,t=!0,i){var r,o;return\\\"released\\\"!==e.releaseStatus&&(r=e.window.getViewBoxTransform(),(o=renderToNewWindow(e,t,i)).setViewBoxTransform(r.a,r.b,r.c,r.d,0,0),e.renderTo(o),o.getNativeHandler().nativeCanvas)||null}function renderToNewWindow(e,t=0,i){var r=e.window.getViewBoxTransform(),o=container.get(VWindow),n=i?-i.x1:0,a=i?-i.y1:0,l=i?i.x2:e.viewWidth,s=i?i.y2:e.viewHeight,h=i?i.width():e.viewWidth,d=i?i.height():e.viewHeight;return o.create({viewBox:{x1:n,y1:a,x2:l,y2:s},width:h*r.a,height:d*r.d,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:\\\"\\\"}),e.renderTo(o),o}var __decorate59=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},ChartRender=Symbol[\\\"for\\\"](\\\"ChartRender\\\"),ChartRenderContribution=Symbol[\\\"for\\\"](\\\"ChartRenderContribution\\\"),DefaultCanvasChartRender=class extends BaseRender{constructor(){super(...arguments),this.numberType=CHART_NUMBER_TYPE}drawShape(e,a,t,i,r,o,n,l){var s,h,d=getTheme(e,null==o?void 0:o.theme).group,{dataId:u,data:c,spec:g}=e.attribute,{width:p=d.width,height:d=d.height}=(e.getViewBox(),e.attribute),f=e.getRootNode().table,{active:m,cacheCanvas:b,activeChartInstance:C}=e;if(!m&&b)isArray_default(b)?b.forEach(e=>{var{x:t,y:i,width:r,height:o,canvas:n}=e;a.drawImage(n,t,i,r,o)}):a.drawImage(b,t,i,p,d);else if(C){f.options.specFormat&&(m=f.options.specFormat(e.attribute.spec,C,e)).needFormatSpec&&m.spec&&(b=m.spec,C.updateSpecSync(b));var p=e.getViewBox(),d=(C.updateViewBox({x1:0,x2:p.x2-p.x1,y1:0,y2:p.y2-p.y1},!1,!1),C.getStage()),m=(d.needRender=!0,e.globalTransMatrix.clone()),b=e.stage.window.getViewBoxTransform().clone();if(b.multiply(m.a,m.b,m.c,m.d,m.e,m.f),d.window.setViewBoxTransform(b.a,b.b,b.c,b.d,b.e,b.f),\\\"string\\\"==typeof u)C.updateDataSync(u,null!=c?c:[]);else{var v=[];for(const y in u){const w=u[y],_=g.series.find(e=>{var t;return(null==(t=null==e?void 0:e.data)?void 0:t.id)===y});v.push({id:y,values:w?null!=(s=null==c?void 0:c.filter(e=>e.hasOwnProperty(w)))?s:[]:null!=c?c:[],fields:null==(s=null==_?void 0:_.data)?void 0:s.fields}),C.updateFullDataSync||C.updateDataSync(y,w?null!=(h=null==c?void 0:c.filter(e=>e.hasOwnProperty(w)))?h:[]:null!=c?c:[])}null!=(p=C.updateFullDataSync)&&p.call(C,v)}}else f.internalProps.renderChartAsync?(-1===chartRenderKeys.indexOf(e.parent.col+\\\"+\\\"+e.parent.row)&&(chartRenderKeys.push(e.parent.col+\\\"+\\\"+e.parent.row),chartRenderQueueList.push(e)),IsHandlingChartQueue()||startRenderChartQueue(f)):renderChart(e)}draw(e,t,i,r){this._draw(e,{},!1,i,r)}},DefaultCanvasChartRender=__decorate59([injectable()],DefaultCanvasChartRender),__decorate60=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),BeforeImageRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g,p=e.attribute.shape;\\\"circle\\\"===p&&(({width:p=s.width,height:g=s.height}=e.attribute),t.beginPath(),t.arc(i+p/2,r+g/2,Math.min(p,g)/2,0,2*Math.PI),t.closePath(),t.save(),t.clip())}},BeforeImageRenderContribution=__decorate60([injectable()],BeforeImageRenderContribution),AfterImageRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g=e.attribute.shape;\\\"circle\\\"===g&&t.restore()}},AfterImageRenderContribution=__decorate60([injectable()],AfterImageRenderContribution),BeforeGifImageRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g=e.attribute.isGif;g&&e.playing&&(e.attribute.opacity=0)}},BeforeGifImageRenderContribution=__decorate60([injectable()],BeforeGifImageRenderContribution),AfterGifImageRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g=e.attribute.isGif;g&&e.playing&&(e.attribute.opacity=1,t.globalAlpha=e.attribute.opacity,e.renderFrame(t,i,r))}};function getCellHoverColor(i,r){let e,t,o,n,a,l,s,h,d,u,c,g,p;if(\\\"cell\\\"===i.role&&isValid_default(i.mergeStartCol)&&isValid_default(i.mergeStartRow)&&isValid_default(i.mergeEndCol)&&isValid_default(i.mergeEndRow)){var{colStart:f,colEnd:m,rowStart:b,rowEnd:C}=getCellMergeRange(i,r.scenegraph);for(let t=f;t<=m;t++)for(let e=b;e<=C;e++){var v=isCellHover(r.stateManager,t,e,i);!v||g&&\\\"cellBgColor\\\"!==v||(g=v)}}else\\\"cell\\\"===i.role&&(g=isCellHover(r.stateManager,i.col,i.row,i));if(g)return(f=r.internalProps.layoutMap).isCornerHeader(i.col,i.row)?p=(null==(e=r.theme.cornerHeaderStyle)?void 0:e.hover)||(null==(t=r.theme.headerStyle)?void 0:t.hover):f.isColumnHeader(i.col,i.row)?p=null==(o=r.theme.headerStyle)?void 0:o.hover:f.isRowHeader(i.col,i.row)?p=null==(n=r.theme.rowHeaderStyle)?void 0:n.hover:f.isBottomFrozenRow(i.col,i.row)?p=(null==(a=r.theme.bottomFrozenStyle)?void 0:a.hover)||(r.isListTable()?null==(l=r.theme.bodyStyle)?void 0:l.hover:null==(s=r.theme.headerStyle)?void 0:s.hover):f.isRightFrozenColumn(i.col,i.row)?p=(null==(h=r.theme.rightFrozenStyle)?void 0:h.hover)||(r.isListTable()?null==(d=r.theme.bodyStyle)?void 0:d.hover:null==(u=r.theme.rowHeaderStyle)?void 0:u.hover):r.isHeader(i.col,i.row)||(p=null==(c=r.theme.bodyStyle)?void 0:c.hover),getProp2(g,p,i.col,i.row,r)}function isCellHover(e,i,r,o){var{highlightScope:n,disableHeader:a,cellPos:l}=e.hover,s=e.table,h=s.isHeader(i,r);if(!h||!a){let t;if(n===HighlightScope.single&&l.col===i&&l.row===r?t=\\\"cellBgColor\\\":n===HighlightScope.column&&l.col===i?t=l.col===i&&l.row===r?\\\"cellBgColor\\\":\\\"inlineColumnBgColor\\\":n===HighlightScope.row&&l.row===r?t=l.col===i&&l.row===r?\\\"cellBgColor\\\":\\\"inlineRowBgColor\\\":n===HighlightScope.cross&&(l.col===i&&l.row===r?t=\\\"cellBgColor\\\":l.col===i?t=\\\"inlineColumnBgColor\\\":l.row===r&&(t=\\\"inlineRowBgColor\\\")),t){let e;h?(a=s.getHeaderDefine(i,r),e=null==a?void 0:a.disableHeaderHover,o.firstChild&&\\\"axis\\\"===o.firstChild.name&&null!=(n=s.options.hover)&&n.disableAxisHover&&(e=!0)):(l=s.getBodyColumnDefine(i,r),e=null==l?void 0:l.disableHover),e&&(t=void 0)}return t}}function getCellSelectColor(i,r){let e,t,o,n,a,l,s,h,d,u,c,g,p;if(\\\"cell\\\"===i.role&&isValid_default(i.mergeStartCol)&&isValid_default(i.mergeStartRow)&&isValid_default(i.mergeEndCol)&&isValid_default(i.mergeEndRow)){var{colStart:f,colEnd:m,rowStart:b,rowEnd:C}=getCellMergeRange(i,r.scenegraph);for(let t=f;t<=m;t++)for(let e=b;e<=C;e++){var v=isCellSelected(r.stateManager,t,e,i);!v||g&&\\\"cellBgColor\\\"!==v||(g=v)}}else\\\"cell\\\"===i.role&&(g=isCellSelected(r.stateManager,i.col,i.row,i));if(g)return(f=r.internalProps.layoutMap).isCornerHeader(i.col,i.row)?p=(null==(e=r.theme.cornerHeaderStyle)?void 0:e.select)||(null==(t=r.theme.headerStyle)?void 0:t.select):f.isColumnHeader(i.col,i.row)?p=null==(o=r.theme.headerStyle)?void 0:o.select:f.isRowHeader(i.col,i.row)?p=null==(n=r.theme.rowHeaderStyle)?void 0:n.select:f.isBottomFrozenRow(i.col,i.row)?p=(null==(a=r.theme.bottomFrozenStyle)?void 0:a.select)||(r.isListTable()?null==(l=r.theme.bodyStyle)?void 0:l.select:null==(s=r.theme.headerStyle)?void 0:s.select):f.isRightFrozenColumn(i.col,i.row)?p=(null==(h=r.theme.rightFrozenStyle)?void 0:h.select)||(r.isListTable()?null==(d=r.theme.bodyStyle)?void 0:d.select:null==(u=r.theme.rowHeaderStyle)?void 0:u.select):r.isHeader(i.col,i.row)||(p=null==(c=r.theme.bodyStyle)?void 0:c.select),getProp2(g,p,i.col,i.row,r)}function isSelectMultipleRange(e){return e.start.col!==e.end.col||e.start.row!==e.end.row}function getSelectModeRange(e,t,i){let r;var{highlightScope:o,cellPos:n,ranges:a}=e.select,l=a[0],s=Math.min(l.start.col,l.end.col),h=Math.max(l.start.col,l.end.col),d=Math.min(l.start.row,l.end.row),l=Math.max(l.start.row,l.end.row);return o===HighlightScope.single&&n.col===t&&n.row===i?r=\\\"cellBgColor\\\":o===HighlightScope.column&&s<=t&&t<=h?r=cellInRange(a[0],t,i)?\\\"cellBgColor\\\":\\\"inlineColumnBgColor\\\":o===HighlightScope.row&&d<=i&&i<=l?r=cellInRange(a[0],t,i)?\\\"cellBgColor\\\":\\\"inlineRowBgColor\\\":o===HighlightScope.cross&&(cellInRange(a[0],t,i)?r=\\\"cellBgColor\\\":s<=t&&t<=h?r=\\\"inlineColumnBgColor\\\":d<=i&&i<=l&&(r=\\\"inlineRowBgColor\\\")),r}function getSelectMode(e,t,i){let r;var{highlightScope:o,cellPos:n}=e.select;return o===HighlightScope.single&&n.col===t&&n.row===i?r=\\\"cellBgColor\\\":o===HighlightScope.column&&n.col===t?r=n.col===t&&n.row===i?\\\"cellBgColor\\\":\\\"inlineColumnBgColor\\\":o===HighlightScope.row&&n.row===i?r=n.col===t&&n.row===i?\\\"cellBgColor\\\":\\\"inlineRowBgColor\\\":o===HighlightScope.cross&&(n.col===t&&n.row===i?r=\\\"cellBgColor\\\":n.col===t?r=\\\"inlineColumnBgColor\\\":n.row===i&&(r=\\\"inlineRowBgColor\\\")),r}function isCellSelected(t,i,r,e){var{highlightInRange:o,disableHeader:n,ranges:a}=t.select;let l;o=1===a.length&&isSelectMultipleRange(null==a?void 0:a[0])&&o;if(o?1===(null==a?void 0:a.length)&&a[0].start&&a[0].end:1===(null==a?void 0:a.length)&&a[0].end.col===a[0].start.col&&a[0].end.row===a[0].start.row){if(t.table.isHeader(i,r)&&n)return;!(l=(o?getSelectModeRange:getSelectMode)(t,i,r))||isCellDisableSelect(t.table,i,r)&&(l=void 0)}else if(\\\"replace\\\"===t.table.theme.selectionStyle.selectionFillMode)for(let e=0;e<a.length;e++){var s=a[e],h=Math.min(s.start.col,s.end.col),d=Math.max(s.start.col,s.end.col),u=Math.min(s.start.row,s.end.row),s=Math.max(s.start.row,s.end.row);if(h<=i&&u<=r&&i<=d&&r<=s){l=\\\"cellBgColor\\\";break}}return l}function isCellDisableSelect(e,t,i){var r=null==(r=e.options.select)?void 0:r.disableSelect;if(\\\"function\\\"==typeof r?r(t,i,e):r)return!0;if(e.isHeader(t,i)){if(null==(r=e.options.select)?void 0:r.disableHeaderSelect)return!0;r=e.getHeaderDefine(t,i);if(null==r?void 0:r.disableHeaderSelect)return!0}else{r=e.getBodyColumnDefine(t,i),r=null==r?void 0:r.disableSelect;if(\\\"function\\\"==typeof r?r(t,i,e):r)return!0}return!1}AfterGifImageRenderContribution=__decorate60([injectable()],AfterGifImageRenderContribution),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __decorate61=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},SplitGroupBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var{stroke:g=s.stroke,strokeArrayWidth:p=s.strokeArrayWidth,strokeArrayColor:f=s.strokeArrayColor}=e.attribute;g&&(Array.isArray(p)||Array.isArray(f))&&(c.doStroke=!1)}},SplitGroupBeforeRenderContribution=__decorate61([injectable()],SplitGroupBeforeRenderContribution),SplitGroupAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,a,l,s,e,t,i,r,h,o,d,u){let c,g,{stroke:p=h.stroke,strokeArrayColor:f=h.strokeArrayColor,strokeArrayWidth:m=h.strokeArrayWidth,lineWidth:b=h.lineWidth,strokeColor:C=h.stroke,cornerRadius:v=h.cornerRadius}=n.attribute,y,w,{width:_=h.width,height:S=h.height}=n.attribute;if(p&&(Array.isArray(m)||0!==b)&&(Array.isArray(f)||Array.isArray(m))){if(\\\"number\\\"==typeof b&&1&b||Array.isArray(m)&&m.some(e=>1&e)){var x=n.stage.table;if(!x)return;var R=\\\"bottom-right\\\"===(null==(c=null==x?void 0:x.theme)?void 0:c.cellBorderClipDirection),{width:x,height:R}=(R?(l=Math.floor(l)-.5,s=Math.floor(s)-.5,\\\"cell\\\"===n.role&&(0===n.col&&(l+=1),0===n.row)&&(s+=1)):(l=Math.floor(l)+.5,s=Math.floor(s)+.5),null!=(g=x.options.customConfig)&&g._disableColumnAndRowSizeRound&&(_=Math.round(_),S=Math.round(S)),getCellSizeForDraw(n,Math.ceil(_),Math.ceil(S),R));y=x,w=R}else y=Math.ceil(_),w=Math.ceil(S);0===v||isArray_default(v)&&v.every(e=>0===e)?renderStroke(n,a,l,s,h,p,m||b,f||C,y,w):(a.beginPath(),createRectPath(a,l,s,y,w,v,new Array(4).fill(0).map((e,o)=>(e,t,i,r)=>{renderStrokeWithCornerRadius(o,e,t,i,r,n,a,l,s,h,p,m||b,f||C,y,w)})),a.stroke())}}};function getWidthInfo(e){if(!Array.isArray(e))return{isSplitDraw:!1,width:e};let t;for(let r=0;r<e.length;r++){var i=e[r];if(i)if(t){if(i!==t)return{isSplitDraw:!0}}else t=i}return{isSplitDraw:!1,width:t}}function renderStroke(e,t,i,r,o,n,a,l,s,h,d,u){var c=getWidthInfo(a),g=!Array.isArray(a),p=!Array.isArray(n),f=Array.isArray(u),m=Array.isArray(l)||c.isSplitDraw,{lineDash:b=o.lineDash}=(t.setStrokeStyle(e,e.attribute,i,r,o),e.attribute);let C=!1;b.length&&b.some(e=>Array.isArray(e))&&(C=!0),t.beginPath(),t.moveTo(i,r);var v,y=(p||n[0])&&(g||a[0]),w=(p||n[1])&&(g||a[1]),_=(p||n[2])&&(g||a[2]),p=(p||n[3])&&(g||a[3]);y?(y=(g?c.width:a[0])/2,v=(g?c.width:a[0])/2,f&&Array.isArray(u[0])?(t.moveTo(i-y+(s+y+v)*u[0][0],r),t.lineTo(i-y+(s+y+v)*(u[0][1]-u[0][0]),r),t.moveTo(i+s+v,r)):(t.moveTo(i-y,r),t.lineTo(i+s+v,r)),(m||C)&&(l&&l[0]?t.strokeStyle=l[0]:l&&!l[0]&&(t.strokeStyle=\\\"transparent\\\"),g||(t.lineWidth=a[0]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,C&&t.setLineDash(null!=(y=b[0])?y:[]),t.stroke(),t.beginPath(),t.moveTo(i+s,r))):t.moveTo(i+s,r),w?(v=(g?c.width:a[1])/2,y=(g?c.width:a[1])/2,f&&Array.isArray(u[1])?(t.moveTo(i+s,r-v+h*u[1][0]),t.lineTo(i+s,r-v+(h+v+y)*(u[1][1]-u[1][0])),t.moveTo(i+s,r+h+y)):(t.moveTo(i+s,r-v),t.lineTo(i+s,r+h+y)),(m||C)&&(l&&l[1]?t.strokeStyle=l[1]:l&&!l[1]&&(t.strokeStyle=\\\"transparent\\\"),g||(t.lineWidth=a[1]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,C&&t.setLineDash(null!=(w=b[1])?w:[]),t.stroke(),t.beginPath(),t.moveTo(i+s,r+h))):t.moveTo(i+s,r+h),_?(v=(g?c.width:a[2])/2,y=(g?c.width:a[2])/2,f&&Array.isArray(u[2])?(t.moveTo(i-v+(s+v+y)*u[2][0],r+h),t.lineTo(i-v+(s+v+y)*(u[2][1]-u[2][0]),r+h),t.moveTo(i-v,r+h)):(t.moveTo(i-v,r+h),t.lineTo(i+s+y,r+h)),(m||C)&&(l&&l[2]?t.strokeStyle=l[2]:l&&!l[2]&&(t.strokeStyle=\\\"transparent\\\"),g||(t.lineWidth=a[2]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,C&&t.setLineDash(null!=(w=b[2])?w:[]),t.stroke(),t.beginPath(),t.moveTo(i,r+h))):t.moveTo(i,r+h),p?(_=(g?c.width:a[3])/2,v=(g?c.width:a[3])/2,f&&Array.isArray(u[3])?(t.moveTo(i,r-_+(h+_+v)*u[3][0]),t.lineTo(i,r-_+(h+_+v)*(u[3][1]-u[3][0])),t.moveTo(i,r-_)):(t.moveTo(i,r-_),t.lineTo(i,r+h+v)),(m||C)&&(l&&l[3]?t.strokeStyle=l[3]:l&&!l[3]&&(t.strokeStyle=\\\"transparent\\\"),g||(t.lineWidth=a[3]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,C&&t.setLineDash(null!=(y=b[3])?y:[]),t.stroke(),t.beginPath(),t.moveTo(i,r))):t.moveTo(i,r),m||C||(!g&&c.width&&(t.lineWidth=c.width),t.stroke()),t.lineDashOffset=0,t.setLineDash([])}var SplitGroupAfterRenderContribution=__decorate61([injectable()],SplitGroupAfterRenderContribution),DashGroupBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var{lineDash:g=s.lineDash,stroke:p=s.stroke,strokeArrayColor:f=s.strokeArrayColor,strokeArrayWidth:m=s.strokeArrayWidth}=e.attribute;p&&Array.isArray(g)&&g.length&&null!=(p=g[0])&&p.length&&!Array.isArray(f)&&!Array.isArray(m)&&(c.doStroke=!1)}},DashGroupBeforeRenderContribution=__decorate61([injectable()],DashGroupBeforeRenderContribution),DashGroupAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u){var{lineDash:c=s.lineDash,stroke:g=s.stroke,strokeArrayColor:p=s.strokeArrayColor,strokeArrayWidth:f=s.strokeArrayWidth,lineWidth:m=s.lineWidth}=e.attribute;if(!g||!(Array.isArray(c)&&c.length&&null!=(g=c[0])&&g.length)||Array.isArray(p)||Array.isArray(f))return;var g=e.stage.table;if(!g)return;p=isArray_default(c[0])?getQuadLineDash(c):[c,c,c,c];let b,C,{width:v=s.width,height:y=s.height}=e.attribute;y=null!=(f=g.options.customConfig)&&f._disableColumnAndRowSizeRound?(v=Math.round(v),Math.round(y)):(v=Math.ceil(v),Math.ceil(y)),C=1&m?(0,({width:f,height:m}=((c=\\\"bottom-right\\\"===g.theme.cellBorderClipDirection)?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,\\\"cell\\\"===e.role&&(0===e.col&&(i+=1),0===e.row)&&(r+=1)):(i=Math.floor(i)+.5,r=Math.floor(r)+.5),getCellSizeForDraw(e,Math.ceil(v+0),Math.ceil(y+0),c))),b=f,m):(b=Math.ceil(v),Math.ceil(y)),t.setStrokeStyle(e,e.attribute,i,r,s),t.beginPath(),t.moveTo(i,r),t.lineTo(i+b,r),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash(null!=(g=p[0])?g:[]),t.stroke(),t.beginPath(),t.moveTo(i+b,r),t.lineTo(i+b,r+C),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash(null!=(c=p[1])?c:[]),t.stroke(),t.beginPath(),t.moveTo(i,r+C),t.lineTo(i+b,r+C),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash(null!=(f=p[2])?f:[]),t.stroke(),t.beginPath(),t.moveTo(i,r),t.lineTo(i,r+C),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash(null!=(m=p[3])?m:[]),t.stroke(),t.lineDashOffset=0,t.setLineDash([])}},DashGroupAfterRenderContribution=__decorate61([injectable()],DashGroupAfterRenderContribution),AdjustPosGroupBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var{lineWidth:g=s.lineWidth,stroke:p=s.stroke,lineDash:f=s.lineDash,strokeArrayWidth:m=s.strokeArrayWidth,strokeArrayColor:b=s.strokeArrayColor,notAdjustPos:C}=e.attribute;!0!==C&&p&&Array.isArray(f)&&!f.length&&!Array.isArray(b)&&!Array.isArray(m)&&1&g&&(c.doStroke=!1)}},AdjustPosGroupBeforeRenderContribution=__decorate61([injectable()],AdjustPosGroupBeforeRenderContribution),AdjustPosGroupAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u){var{lineWidth:c=s.lineWidth,stroke:g=s.stroke,lineDash:p=s.lineDash,strokeArrayWidth:f=s.strokeArrayWidth,strokeArrayColor:m=s.strokeArrayColor,notAdjustPos:b,cornerRadius:C=s.cornerRadius}=e.attribute;let{width:v=s.width,height:y=s.height}=e.attribute;!0!==b&&g&&Array.isArray(p)&&!p.length&&!Array.isArray(m)&&!Array.isArray(f)&&1&c&&(b=e.stage.table)&&(null!=(g=b.options.customConfig)&&g._disableColumnAndRowSizeRound&&(v=Math.round(v),y=Math.round(y)),t.beginPath(),({width:f,height:c}=((m=\\\"bottom-right\\\"===(null==(p=null==b?void 0:b.theme)?void 0:p.cellBorderClipDirection))?(i=Math.floor(i)-.5,r=Math.floor(r)-.5,\\\"cell\\\"===e.role&&(0===e.col&&(i+=1),0===e.row)&&(r+=1)):(i=Math.floor(i)+.5,r=Math.floor(r)+.5),getCellSizeForDraw(e,Math.ceil(v),Math.ceil(y),m))),C?createRectPath(t,i,r,f+0,c+0,C):t.rect(i,r,f,c),t.setStrokeStyle(e,e.attribute,i,r,s),t.stroke())}},AdjustPosGroupAfterRenderContribution=__decorate61([injectable()],AdjustPosGroupAfterRenderContribution),AdjustColorGroupBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g,p;\\\"cell\\\"===e.role&&(g=e.stage.table)&&((p=getCellSelectColor(e,g))?e.attribute._vtableHightLightFill=p:g.stateManager.interactionState!==InteractionState.scrolling&&(p=getCellHoverColor(e,g))&&(e.attribute._vtableHightLightFill=p))}},AdjustColorGroupBeforeRenderContribution=__decorate61([injectable()],AdjustColorGroupBeforeRenderContribution),AdjustColorGroupAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u){var c;e.attribute._vtableHightLightFill&&!d&&a&&(c=e.attribute.fill,e.attribute.fill=e.attribute._vtableHightLightFill,t.setCommonStyle(e,e.attribute,i,r,s),t.fill(),e.attribute.fill=c,e.attribute._vtableHightLightFill=void 0)}},AdjustColorGroupAfterRenderContribution=__decorate61([injectable()],AdjustColorGroupAfterRenderContribution),ClipBodyGroupBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var g,p=e.stage.table;p&&(\\\"body\\\"===e.role?drawClipRect(t,-(null!=(g=e.attribute.x)?g:0)+p.getFrozenColsWidth(),-(null!=(g=e.attribute.y)?g:0)+p.getFrozenRowsHeight(),e.parent.attribute.width-p.getFrozenColsWidth()-p.getRightFrozenColsWidth(),e.parent.attribute.height-p.getFrozenRowsHeight()-p.getBottomFrozenRowsHeight()):\\\"row-header\\\"===e.role?drawClipRect(t,0,-(null!=(g=e.attribute.y)?g:0)+p.getFrozenRowsHeight(),p.getFrozenColsWidth(),e.parent.attribute.height-p.getFrozenRowsHeight()-p.getBottomFrozenRowsHeight()):\\\"col-header\\\"===e.role?drawClipRect(t,-(null!=(g=e.attribute.x)?g:0)+p.getFrozenColsWidth(),0,e.parent.attribute.width-p.getFrozenColsWidth()-p.getRightFrozenColsWidth(),p.getFrozenRowsHeight()):\\\"right-frozen\\\"===e.role?drawClipRect(t,0,-(null!=(g=e.attribute.y)?g:0)+p.getFrozenRowsHeight(),p.getRightFrozenColsWidth(),e.parent.attribute.height-p.getFrozenRowsHeight()-p.getBottomFrozenRowsHeight()):\\\"bottom-frozen\\\"===e.role?drawClipRect(t,-(null!=(g=e.attribute.x)?g:0)+p.getFrozenColsWidth(),0,e.parent.attribute.width-p.getFrozenColsWidth()-p.getRightFrozenColsWidth(),p.getBottomFrozenRowsHeight()):\\\"corner-header\\\"===e.role?drawClipRect(t,0,0,p.getFrozenColsWidth(),p.getFrozenRowsHeight()):\\\"corner-right-top-header\\\"===e.role?drawClipRect(t,0,0,p.getRightFrozenColsWidth(),p.getFrozenRowsHeight()):\\\"corner-right-bottom-header\\\"===e.role?drawClipRect(t,0,0,p.getRightFrozenColsWidth(),p.getBottomFrozenRowsHeight()):\\\"corner-left-bottom-header\\\"===e.role&&drawClipRect(t,0,0,p.getFrozenColsWidth(),p.getBottomFrozenRowsHeight()))}},ClipBodyGroupBeforeRenderContribution=__decorate61([injectable()],ClipBodyGroupBeforeRenderContribution),precision=Math.pow(2,24);function drawClipRect(e,t,i,r,o){e.beginPath();var n=e.applyedMatrix;Math.abs(n.f)>precision||Math.abs(n.g)>precision?e.rect(t-precision,i-precision,r+2*precision,o+2*precision):e.rect(t,i,r,o)}function getCellSizeForDraw(i,r,o,n){var a=i.stage.table;if(a)if(\\\"cell\\\"===i.role){let e=i.col,t=i.row;var l=getCellMergeInfo(a,e,t);l&&(e=l.end.col,t=l.end.row),(e===a.colCount-1&&!n||e===a.frozenColCount-1&&a.scrollLeft&&!n||0===e&&n)&&--r,(t===a.rowCount-1&&!n||t===a.frozenRowCount-1&&a.scrollTop&&!n||0===t&&n)&&--o}else\\\"corner-frozen\\\"===i.role&&(a.scrollLeft&&!n&&--r,a.scrollTop)&&!n&&--o;return{width:r,height:o}}function getQuadLineDash(e){return 1===e.length?[e[0],e[0],e[0],e[0]]:2===e.length?[e[0],e[1],e[0],e[1]]:e}var __decorate62=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},SplitRectBeforeRenderContribution2=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,t,i,r,o,n,a,l,s,h,d,u,c){var{stroke:g=s.stroke,strokeArrayWidth:p=s.strokeArrayWidth,strokeArrayColor:f=s.strokeArrayColor}=e.attribute;g&&(Array.isArray(g)||Array.isArray(p)||Array.isArray(f))&&(c.doStroke=!1)}},SplitRectBeforeRenderContribution2=__decorate62([injectable()],SplitRectBeforeRenderContribution2),SplitRectAfterRenderContribution2=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(n,a,l,s,e,t,i,r,h,o,d,u){let{width:c=h.width,height:g=h.height,stroke:p=h.stroke,strokeArrayColor:f=h.strokeArrayColor,strokeArrayWidth:m=h.strokeArrayWidth,lineWidth:b=h.lineWidth,strokeColor:C=h.stroke,cornerRadius:v=h.cornerRadius}=n.attribute;if(p&&(Array.isArray(m)||0!==b)&&(Array.isArray(p)||Array.isArray(f)||Array.isArray(m)))\\\"border-rect\\\"!==n.name&&\\\"table-border-rect\\\"!==n.name&&(\\\"number\\\"==typeof b&&1&b||Array.isArray(m)&&m.some(e=>1&e))&&(l=Math.floor(l)+.5,s=Math.floor(s)+.5),0===v||isArray_default(v)&&v.every(e=>0===e)?renderStroke(n,a,l,s,h,p,m||b,f||C,Math.ceil(c+0),Math.ceil(g+0)):(a.beginPath(),createRectPath(a,l,s,c,g,v,new Array(4).fill(0).map((e,o)=>(e,t,i,r)=>{renderStrokeWithCornerRadius(o,e,t,i,r,n,a,l,s,h,p,m||b,f||C,Math.ceil(c+0),Math.ceil(g+0))})),a.stroke())}};function renderStrokeWithCornerRadius(e,t,i,r,o,n,a,l,s,h,d,u,c,g,p){var f=n,m=h,b=getWidthInfo(u),C=!Array.isArray(u),v=!Array.isArray(d),y=Array.isArray(c)||b.isSplitDraw,{lineDash:f=m.lineDash}=(a.stroke(),a.setStrokeStyle(n,n.attribute,l,s,h),f.attribute);let w=!1;f.length&&f.some(e=>Array.isArray(e))&&(w=!0),a.beginPath(),a.moveTo(l,s);var m=(v||d[0])&&(C||u[0]),_=(v||d[1])&&(C||u[1]),S=(v||d[2])&&(C||u[2]),v=(v||d[3])&&(C||u[3]);m&&0===e?(C?b.width:u[0],C?b.width:u[0],a.moveTo(t,i),a.lineTo(r,o),(y||w)&&(c&&c[0]?a.strokeStyle=c[0]:c&&!c[0]&&(a.strokeStyle=\\\"transparent\\\"),C||(a.lineWidth=u[0]),a.lineDashOffset=a.currentMatrix.e/a.currentMatrix.a,w&&a.setLineDash(null!=(m=f[0])?m:[]),a.stroke(),a.beginPath())):0===e&&a.moveTo(l+g,s),_&&1===e?(C?b.width:u[1],C?b.width:u[1],a.moveTo(t,i),a.lineTo(r,o),(y||w)&&(c&&c[1]?a.strokeStyle=c[1]:c&&!c[1]&&(a.strokeStyle=\\\"transparent\\\"),C||(a.lineWidth=u[1]),a.lineDashOffset=a.currentMatrix.f/a.currentMatrix.d,w&&a.setLineDash(null!=(m=f[1])?m:[]),a.stroke(),a.beginPath(),a.moveTo(l+g,s+p))):1===e&&a.moveTo(l+g,s+p),S&&2===e?(C?b.width:u[2],C?b.width:u[2],a.moveTo(t,i),a.lineTo(r,o),(y||w)&&(c&&c[2]?a.strokeStyle=c[2]:c&&!c[2]&&(a.strokeStyle=\\\"transparent\\\"),C||(a.lineWidth=u[2]),a.lineDashOffset=a.currentMatrix.e/a.currentMatrix.a,w&&a.setLineDash(null!=(_=f[2])?_:[]),a.stroke(),a.beginPath(),a.moveTo(l,s+p))):2===e&&a.moveTo(l,s+p),v&&3===e?(C?b.width:u[3],C?b.width:u[3],a.moveTo(t,i),a.lineTo(r,o),(y||w)&&(c&&c[3]?a.strokeStyle=c[3]:c&&!c[3]&&(a.strokeStyle=\\\"transparent\\\"),C||(a.lineWidth=u[3]),a.lineDashOffset=a.currentMatrix.f/a.currentMatrix.d,w&&a.setLineDash(null!=(m=f[3])?m:[]),a.stroke(),a.beginPath(),a.moveTo(l,s))):3===e&&a.moveTo(l,s),a.closePath(),y||w||(!C&&b.width&&(a.lineWidth=b.width),a.stroke()),a.lineDashOffset=0,a.setLineDash([]),a.beginPath()}SplitRectAfterRenderContribution2=__decorate62([injectable()],SplitRectAfterRenderContribution2),init_esbuild_inject();var loadingImage,__decorate63=function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a},VTableDrawItemInterceptorContribution=class{constructor(){this.order=1,this.interceptors=[new ImageDrawItemInterceptorContribution]}afterDrawItem(e,t,i,r,o){for(let n=0;n<this.interceptors.length;n++)if(this.interceptors[n].afterDrawItem&&this.interceptors[n].afterDrawItem(e,t,i,r,o))return!0;return!1}beforeDrawItem(t,i,r,o,n){if(t.in3dMode&&!r.in3dInterceptor||t.shadowRoot||(t.baseGraphic||t.attribute.globalZIndex||t.interactiveGraphic))for(let e=0;e<this.interceptors.length;e++)if(this.interceptors[e].beforeDrawItem&&this.interceptors[e].beforeDrawItem(t,i,r,o,n))return!0;return!1}},VTableDrawItemInterceptorContribution=__decorate63([injectable()],VTableDrawItemInterceptorContribution),ImageDrawItemInterceptorContribution=class{constructor(){this.order=1}afterDrawItem(e,t,i,r,o){return\\\"image\\\"===e.type&&this.drawItem(e,t,i,r,o),!1}drawItem(e,t,i,r,o){var{image:n,gif:a}=e.attribute;if(a&&e.playing)return!1;if(!n||!e.resources)return!1;var a=e.resources.get(n);if(!a||\\\"loading\\\"!==a.state)return!1;loadingImage||(l=(a=get3()).loading_pic.svg,h=a.loading_pic.width,a=a.loading_pic.height,loadingImage=createImage({width:h,height:a,image:l}));var l,s,h=loadingImage.attribute.image;return!(!n||!loadingImage.resources||\\\"success\\\"!==(a=loadingImage.resources.get(h)).state||(l=i.context,l.highPerformanceSave(),e.parent&&l.setTransformFromMatrix(e.parent.globalTransMatrix,!0),e.glyphHost&&e.glyphHost.parent&&l.setTransformFromMatrix(e.glyphHost.parent.globalTransMatrix,!0),({width:h,height:s}=calcKeepAspectRatioSize(a.data.width,a.data.height,(n=e.AABBBounds).width(),n.height())),l.drawImage(a.data,n.x1+(n.width()-h)/2,n.y1+(n.height()-s)/2,h,s),l.highPerformanceRestore(),0))}},__decorate64=(init_esbuild_inject(),function(e,t,i,r){var o,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\\\"object\\\"==typeof Reflect&&\\\"function\\\"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(n<3?o(a):3<n?o(t,i,a):o(t,i))||a);return 3<n&&a&&Object.defineProperty(t,i,a),a}),SuffixTextBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,i,r,o,n,a,l,s,h,e,d,u,c){var{underline:g=h.underline,lineThrough:p=h.lineThrough,direction:f=h.direction,whiteSpace:m=h.whiteSpace,fontSize:b=h.fontSize,verticalMode:C=h.verticalMode,ellipsis:v=h.ellipsis,textAlign:y=h.textAlign,textBaseline:w=h.textBaseline,x:_=h.x,y:S=h.y}=t.attribute;let x=!1;if(Array.isArray(t)?(R=null==(R=t.cache)?void 0:R.layoutData,v&&R&&R.lines.every(e=>\\\"\\\"===e.str)&&(x=!0)):(R=t.cache,v&&R&&\\\"\\\"===R.clipedText&&0===R.clipedWidth&&(x=!0)),x){var R=isString_default(v)?v:\\\"...\\\",v=null!=(v=calculateLineHeight(t.attribute.lineHeight,b))?v:b;let e=0;v!==b&&(\\\"top\\\"===w?e=(v-b)/2:\\\"middle\\\"!==w&&\\\"bottom\\\"===w&&(e=-(v-b)/2)),a&&(u?u(i,t.attribute,h):s&&(i.setStrokeStyle(t,t.attribute,_-r,S-o,h),i.strokeText(R,_,S+e))),n&&(d?d(i,t.attribute,h):l&&(i.setCommonStyle(t,t.attribute,_-r,S-o,h),i.fillText(R,_,S+e),this.drawUnderLine(g,p,t,_,S+e,0,h,i,R)))}}drawUnderLine(e,t,i,r,o,n,a,l,s){var h,d,u,c,g,p,f,m,b,C,v;t+e<=0||(({textAlign:p=a.textAlign,textBaseline:C=a.textBaseline,fontSize:h=a.fontSize,fontFamily:f=a.fontFamily,fontWeight:m=a.fontWeight,fontStyle:b=a.fontStyle,fill:v=a.fill,opacity:d=a.opacity,underlineOffset:u=a.underlineOffset,underlineDash:c=a.underlineDash,fillOpacity:g=a.fillOpacity}=i.attribute),(e||t)&&(f=textDrawOffsetX(p,p=textMeasure.measureTextWidth(s,{fontSize:h,fontFamily:f,fontWeight:m,fontStyle:b})),m=textLayoutOffsetY(C,h,h),b={lineWidth:0,stroke:v,opacity:d,strokeOpacity:g},e&&(b.lineWidth=e,l.setStrokeStyle(i,b,r,o,a),l.setLineDash(c),l.beginPath(),l.moveTo(r+f,C=o+m+h+u,n),l.lineTo(r+f+p,C,n),l.stroke()),t)&&(b.lineWidth=t,l.setStrokeStyle(i,b,r,o,a),l.beginPath(),l.moveTo(r+f,v=o+m+h/2,n),l.lineTo(r+f+p,v,n),l.stroke()))}},SuffixTextBeforeRenderContribution=__decorate64([injectable()],SuffixTextBeforeRenderContribution),contributions_default=new ContainerModule((e,t,i,r)=>{i(SplitRectBeforeRenderContribution)?r(SplitRectBeforeRenderContribution).to(SplitRectBeforeRenderContribution2).inSingletonScope():(e(SplitRectBeforeRenderContribution2).toSelf().inSingletonScope(),e(RectRenderContribution).toService(SplitRectBeforeRenderContribution2)),i(SplitRectAfterRenderContribution)?r(SplitRectAfterRenderContribution).to(SplitRectAfterRenderContribution2).inSingletonScope():(e(SplitRectAfterRenderContribution2).toSelf().inSingletonScope(),e(RectRenderContribution).toService(SplitRectAfterRenderContribution2)),e(DefaultCanvasChartRender).toSelf().inSingletonScope(),e(ChartRender).to(DefaultCanvasChartRender),e(GraphicRender).to(DefaultCanvasChartRender),e(BeforeImageRenderContribution).toSelf().inSingletonScope(),e(ImageRenderContribution).toService(BeforeImageRenderContribution),e(AfterImageRenderContribution).toSelf().inSingletonScope(),e(ImageRenderContribution).toService(AfterImageRenderContribution),e(BeforeGifImageRenderContribution).toSelf().inSingletonScope(),e(ImageRenderContribution).toService(BeforeGifImageRenderContribution),e(AfterGifImageRenderContribution).toSelf().inSingletonScope(),e(ImageRenderContribution).toService(AfterGifImageRenderContribution),e(AdjustColorGroupBeforeRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(AdjustColorGroupBeforeRenderContribution),e(AdjustColorGroupAfterRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(AdjustColorGroupAfterRenderContribution),e(SplitGroupAfterRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(SplitGroupAfterRenderContribution),e(SplitGroupBeforeRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(SplitGroupBeforeRenderContribution),e(DashGroupBeforeRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(DashGroupBeforeRenderContribution),e(DashGroupAfterRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(DashGroupAfterRenderContribution),e(AdjustPosGroupBeforeRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(AdjustPosGroupBeforeRenderContribution),e(AdjustPosGroupAfterRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(AdjustPosGroupAfterRenderContribution),e(ClipBodyGroupBeforeRenderContribution).toSelf().inSingletonScope(),e(GroupRenderContribution).toService(ClipBodyGroupBeforeRenderContribution),e(VTableDrawItemInterceptorContribution).toSelf().inSingletonScope(),e(DrawItemInterceptor).toService(VTableDrawItemInterceptorContribution),e(SuffixTextBeforeRenderContribution).toSelf().inSingletonScope(),e(TextRenderContribution).toService(SuffixTextBeforeRenderContribution)});function computeColsWidth(o,e,t,n){o.internalProps.columnWidthConfig&&o._parseColumnWidthConfig(o.internalProps.columnWidthConfig),o.isPivotTable()&&o.internalProps.columnWidthConfigForRowHeader&&o._parseColumnWidthConfigForRowHeader(o.internalProps.columnWidthConfigForRowHeader),t=null!=t?t:o.colCount-1,0===(e=null!=e?e:0)&&t===o.colCount-1&&o._clearColRangeWidthsMap();var i,r,a=o.internalProps.layoutMap,l=(o.isPivotTable()&&(a.enableUseGetBodyCache(),a.enableUseHeaderPathCache()),[]),s=[];if(n)for(let e=0;e<o.colCount;e++)l[e]=o.getColWidth(e);for(let p=e;p<=t;p++){let e;o.internalProps.transpose||\\\"only-header\\\"!==(null==(r=null==(r=o.internalProps.layoutMap.columnObjects)?void 0:r[p])?void 0:r.columnWidthComputeMode)&&\\\"only-header\\\"!==o.columnWidthComputeMode||!(\\\"showHeader\\\"in o.internalProps.layoutMap)?e=o.internalProps.transpose||\\\"only-body\\\"!==(null==(i=null==(r=o.internalProps.layoutMap.columnObjects)?void 0:r[p])?void 0:i.columnWidthComputeMode)&&\\\"only-body\\\"!==o.columnWidthComputeMode?computeColWidth(p,0,o.rowCount-1,o):computeColWidth(p,o.internalProps.layoutMap.getBodyRange().start.row,o.internalProps.layoutMap.getBodyRange().end.row,o):(r=o.internalProps.layoutMap.showHeader,o.internalProps.layoutMap.showHeader=!0,e=computeColWidth(p,0,o.internalProps.layoutMap.headerLevelCount-1,o),o.internalProps.layoutMap.showHeader=r),o._setColContentWidth(p,e),o.getColWidth(p)!==e&&o._clearColRangeWidthsMap(p),n?s[p]=Math.round(o._adjustColWidth(p,e)):o._setColWidth(p,o._adjustColWidth(p,e),!1,!0)}if(\\\"adaptive\\\"===o.widthMode){o._clearColRangeWidthsMap();var h=o.tableNoFrameWidth;let t=0,i=0,r=o.colCount;if(\\\"only-body\\\"===o.widthAdaptiveMode){for(let e=0;e<o.colCount;e++){var d=n&&null!=(d=s[e])?d:o.getColWidth(e);(e<o.rowHeaderLevelCount||o.isPivotChart()&&e>=o.colCount-o.rightFrozenColCount)&&(t+=d)}i=o.rowHeaderLevelCount,r=o.isPivotChart()?o.colCount-o.rightFrozenColCount:o.colCount}getAdaptiveWidth(h-t,i,r,n,s,o)}else if(o.autoFillWidth){o._clearColRangeWidthsMap();h=o.tableNoFrameWidth;let e=0,t=0;for(let i=0;i<o.colCount;i++){var u=n&&null!=(u=s[i])?u:o.getColWidth(i);(i<o.rowHeaderLevelCount+o.leftRowSeriesNumberCount||o.isPivotChart()&&i>=o.colCount-o.rightFrozenColCount)&&(e+=u),t+=u}t<h&&t>e&&getAdaptiveWidth(h-e,o.rowHeaderLevelCount+o.leftRowSeriesNumberCount,o.isPivotChart()?o.colCount-o.rightFrozenColCount:o.colCount,n,s,o)}if(n){for(let e=0;e<o.colCount;e++){var c=null!=(c=null!=(c=s[e])?c:o.getColWidth(e))?c:o.getColWidth(e);c!==l[e]&&o._setColWidth(e,c,!1,!0)}o.stateManager.checkFrozen();for(let t=0;t<o.colCount;t++){var g=o.getColWidth(t);g!==l[t]&&o.scenegraph.updateColWidth(t,g-l[t],!0,!0)}o.scenegraph.updateContainer(!0)}o.isPivotTable()&&(a.disableUseGetBodyCache(),a.disableUseHeaderPathCache())}function computeColWidth(e,t,i,r,o=!1){let n=getColWidthDefinedWidthResizedWidth(e,r);return r.internalProps.transpose&&\\\"auto\\\"===n&&(\\\"only-header\\\"===r.columnWidthComputeMode&&e>=r.rowHeaderLevelCount||\\\"only-body\\\"===r.columnWidthComputeMode&&e<r.rowHeaderLevelCount)&&(n=r.getDefaultColumnWidth(e)),o&&!r.internalProps.transpose?computeAutoColWidth(n,e,t,i,o,r):\\\"number\\\"==typeof n?n:\\\"auto\\\"!==n&&\\\"string\\\"==typeof n?r._adjustColWidth(e,r._colWidthDefineToPxWidth(n)):computeAutoColWidth(n,e,t,i,o,r)}function computeAutoColWidth(e,t,i,r,o,n){let a=0,l=1,s=1;if(5e3<r-i&&(s=Math.ceil((r-i)/5e3)),n.isPivotChart()&&t>=n.rowHeaderLevelCount&&t<n.colCount-n.rightFrozenColCount){if(n.internalProps.layoutMap.indicatorsAsCol)return n.defaultColWidth;var h=n.internalProps.layoutMap.getOptimunWidthForChart(t);if(0<h)return h}for(let C=i;C<=r;C+=l){if(n.isPivotChart()){var d=n.internalProps.layoutMap,u=d.getAxisConfigInPivotChart(t,C);if(u){u=Factory2.getFunction(\\\"computeAxisComponentWidth\\\")(u,n);if(\\\"number\\\"==typeof u){a=Math.max(u,a);continue}}else if(d.isLeftBottomCorner(t,C)||d.isRightTopCorner(t,C)||d.isRightBottomCorner(t,C))continue}u=computeCustomRenderWidth(t,C,n);if(!u||(a=Math.max(u.width,a),u.renderDefault)){d=e;if(\\\"number\\\"!=typeof d||\\\"standard\\\"!==n.widthMode||o){var c=n.isHeader(t,C)?null==(c=n._getHeaderLayoutMap(t,C))?void 0:c.headerType:n.getBodyColumnType(t,C);if(isValid_default(c)&&\\\"text\\\"!==c&&\\\"link\\\"!==c&&\\\"progressbar\\\"!==c&&\\\"checkbox\\\"!==c&&\\\"radio\\\"!==c&&\\\"switch\\\"!==c&&\\\"button\\\"!==c)a=Math.max(a,n.getColWidthDefinedNumber(t)||0);else{let e=0;var g,p=n.internalProps.layoutMap;if(p.isHeader(t,C)){var f=p.getHeader(t,C);if(\\\"only-body\\\"===(null==(g=null==f?void 0:f.define)?void 0:g.columnWidthComputeMode))continue;isValid_default(null==f?void 0:f.hierarchyLevel)&&(e=(null!=(g=f.hierarchyLevel)?g:0)*(\\\"tree\\\"===p.rowHierarchyType&&null!=(f=p.rowHierarchyIndent)?f:0),p.rowHierarchyTextStartAlignment)&&!n.internalProps.headerHelper.getHierarchyIcon(t,C)&&(e+=n.internalProps.headerHelper.getHierarchyIconWidth())}else n.isListTable()&&(l=s,null!=(g=n.getBodyColumnDefine(t,C)))&&g.tree&&(f=n.dataSource.getIndexKey(n.getRecordShowIndexByCell(t,C)),e=Array.isArray(f)&&n.getHierarchyState(t,C)!==HierarchyState.none?(f.length-1)*(null!=(m=p.hierarchyIndent)?m:0):0,p.hierarchyTextStartAlignment)&&!n.internalProps.bodyHelper.getHierarchyIcon(t,C)&&(e+=n.internalProps.headerHelper.getHierarchyIconWidth());var m=computeTextWidth(t,C,c,n);a=Math.max(m+e,a),1<l&&0<n.bottomFrozenRowCount&&C<n.rowCount-n.bottomFrozenRowCount&&C+l>=n.rowCount-n.bottomFrozenRowCount&&(C=n.rowCount-n.bottomFrozenRowCount-l,l=1,s=1)}}else a=Math.max(d,a)}}var h=n.getMinColWidth(t),b=n.getMaxColWidth(t);return a<h?h:a>b?b:a=a<=0?n.defaultColWidth:a}function computeCustomRenderWidth(n,a,l){var s=l.getCustomRender(n,a);let h=l.getCustomLayout(n,a);if(s||h){let e,t=1,i=0,r=!1,o=!1;(l.isHeader(n,a)||null!=(c=l.getBodyColumnDefine(n,a))&&c.mergeCell||l.hasCustomMerge())&&(e=l.getCellRange(n,a),t=e.end.col-e.start.col+1);var d,u,c={col:null!=(c=null==e?void 0:e.start.col)?c:n,row:null!=(c=null==e?void 0:e.start.row)?c:a,dataValue:l.getCellOriginValue(n,a),value:l.getCellValue(n,a)||\\\"\\\",rect:getCellRect2(n,a,l),table:l,originCol:n,originRow:a,forComputation:!0};return\\\"react-custom-layout\\\"===h&&(h=(null==(u=l.reactCustomLayout)?void 0:u.getCustomLayoutFunc(n,a))||emptyCustomLayout),isFunction_default(h)?(u=h(c),o=(r=(i=u.rootContainer?(u.rootContainer=decodeReactDom(u.rootContainer),dealPercentCalc(u.rootContainer,0,l.getRowHeight(a)),d=u.rootContainer.attribute.width,u.rootContainer.setStage(l.scenegraph.stage),0<d?d:null!=(d=u.rootContainer.AABBBounds.width())?d:0):0,u.renderDefault),u.enableCellPadding)):r=\\\"function\\\"==typeof s?(d=s(c),i=null!=(u=null==d?void 0:d.expectedWidth)?u:0,null==d?void 0:d.renderDefault):(i=null!=(c=null==s?void 0:s.expectedWidth)?c:0,null==s?void 0:s.renderDefault),i=Math.ceil(i),o&&(u=getQuadProps(getProp2(\\\"padding\\\",l._getCellStyle(n,a),n,a,l)),i+=u[1]+u[3]),{width:i/t,renderDefault:r}}}function computeTextWidth(e,t,i,r){let o,n,a,l,s=0;var h=r.getCellValue(e,t),d=r._getCellStyle(e,t);let u=0,c=!1,g=((c=\\\"body\\\"!==r.getCellLocation(e,t)||!(null==(S=r.getBodyColumnDefine(e,t))||!S.icon)||!(null==S||!S.tree)||(null==S?void 0:S.dragOrder))&&null!=(S=r.getCellIcons(e,t))&&S.forEach(e=>{var t;e.positionType!==IconPosition.absoluteRight&&(u+=(null!=(t=e.width)?t:0)+(null!=(t=e.marginLeft)?t:0)+(null!=(t=e.marginRight)?t:0))}),1);(r.isHeader(e,t)||null!=(o=r.getBodyColumnDefine(e,t))&&o.mergeCell||r.hasCustomMerge())&&(S=r.getCellRange(e,t),g=S.end.col-S.start.col+1);const p=getQuadProps(getProp2(\\\"padding\\\",d,e,t,r)),f=p[1]+p[3],m=getProp2(\\\"fontSize\\\",d,e,t,r),b=getProp2(\\\"fontFamily\\\",d,e,t,r),C=getProp2(\\\"fontWeight\\\",d,e,t,r);let v;\\\"checkbox\\\"===i?v=isObject_default(h)?h.text:h:\\\"radio\\\"===i?isArray_default(h)?(v=\\\"\\\",\\\"vertical\\\"===(S=null!=(n=null==(S=r.getBodyColumnDefine(e,t))?void 0:S.radioDirectionInCell)?n:\\\"vertical\\\")?h.forEach(e=>{v+=(isObject_default(e)?e.text:e).toString()+\\\"\\\\n\\\"}):\\\"horizontal\\\"===S&&h.forEach(e=>{v+=(isObject_default(e)?e.text:e).toString()})):v=isObject_default(h)?h.text:h:v=\\\"button\\\"===i?null!=(a=null!=(S=getOrApply(r.getBodyColumnDefine(e,t).text,{col:e,row:t,table:r,context:null,value:h,dataValue:r.getCellOriginValue(e,t)}))?S:h)?a:\\\"\\\":h;var y,w,_,S=breakString(v,r).text;return 1<=S.length&&(1!==S.length||\\\"\\\"!==S[0])?S.forEach(e=>{var t=r.measureText(e,{fontSize:m,fontFamily:b,fontWeight:C}).width;s=Math.max((t+f+4+u)/g,s)}):s=Math.max((f+4+u)/g,s),!1!==r.internalProps.limitMaxAutoWidth&&(s=Math.min(\\\"number\\\"==typeof r.internalProps.limitMaxAutoWidth?r.internalProps.limitMaxAutoWidth:450,s)),\\\"checkbox\\\"===i?(S=getProp2(\\\"size\\\",d,e,t,r),s+=S,v&&(S=getProp2(\\\"spaceBetweenTextAndIcon\\\",d,e,t,r),s+=S)):\\\"radio\\\"===i?(S=getProp2(\\\"size\\\",d,e,t,r),y=getProp2(\\\"outerRadius\\\",d,e,t,r),y=isNumber_default(y)?2*y:S,S=getProp2(\\\"spaceBetweenTextAndIcon\\\",d,e,t,r),isArray_default(h)?(w=r.getBodyColumnDefine(e,t),_=getProp2(\\\"spaceBetweenRadio\\\",d,e,t,r),\\\"vertical\\\"===(w=null!=(l=null==w?void 0:w.radioDirectionInCell)?l:\\\"vertical\\\")?s=s+y+S:\\\"horizontal\\\"===w&&(s=(s+=(y+S)*h.length)+_*(h.length-1))):(s+=y,v&&(s+=S))):\\\"switch\\\"===i?(w=getProp2(\\\"boxWidth\\\",d,e,t,r),s=w):\\\"button\\\"===i&&(_=getProp2(\\\"buttonPadding\\\",d,e,t,r),s+=2*_),s}function getCellRect2(e,t,i){return{left:0,top:0,right:i.getColWidth(e),bottom:i.getRowHeight(t),width:null,height:null}}function getColWidthDefinedWidthResizedWidth(e,t){var i=t.getColWidthDefined(e);return t.internalProps._widthResizedColMap.has(e)?t.getColWidth(e):i}function getAdaptiveWidth(i,e,t,o,n,a,r){var l;let s=0;var h=[],d=[];let u=0;for(let y=e;y<t;y++){var c=o&&null!=(c=n[y])?c:a.getColWidth(y),g=a.getMaxColWidth(y),p=a.getMinColWidth(y);c!==g&&c!==p?(s+=c,h.push(y)):i-=c,null==(g=a.options.customConfig)||!g.shrinkSparklineFirst||\\\"sparkline\\\"===a.getBodyColumnType(y,0)&&(d.push({col:y,width:c}),u+=c-a.defaultColWidth)}var f=i/s;if(null!=(l=a.options.customConfig)&&l.shrinkSparklineFirst&&f<1&&s-i<u)for(let e=0;e<d.length;e++){var{col:m,width:b}=d[e],C=(s-i)/d.length,b=Math.floor(b-C);o?n[m]=a._adjustColWidth(m,b):r?a.scenegraph.setColWidth(m,a._adjustColWidth(m,b)):a._setColWidth(m,a._adjustColWidth(m,b),!1,!0)}else for(let t=0;t<h.length;t++){const w=h[t];var v=t===h.length-1?i-h.reduce((e,t,i)=>{var r;return t!==w?e+(o?null!=(r=n[t])?r:a.getColWidth(w):a.getColWidth(t)):e},0):Math.round((o&&null!=(v=n[w])?v:a.getColWidth(w))*f);o?n[w]=a._adjustColWidth(w,v):r?a.scenegraph.setColWidth(w,a._adjustColWidth(w,v)):a._setColWidth(w,a._adjustColWidth(w,v),!1,!0)}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var emptyGroup=new Group2({});function createComplexColumn(p,f,m,b,e,C,v,y,w){let _,S,x,R,T,A=0;p.lastChild&&p.lastChild.row===b-1?A=p.lastChild.attribute.y+p.lastChild.attribute.height:p.colHeight&&(A=p.colHeight);for(let O=b;O<=e;O++){var P,B,M,E,H=O;let e,t,i,r,o=y.getCellLocation(f,H),n=y.getCellValue(f,H),a=m,l=y.getRowHeight(H),s=!1;y.internalProps.customMergeCell&&(I=y.getCustomMerge(f,H))&&(({range:I,text:B,style:M,customLayout:E,customRender:z}=I),e=I,(t=e.start.col!==e.end.col||e.start.row!==e.end.row)&&(P=dealMerge(e,C,y,b>e.start.row),a=P.cellWidth,l=P.cellHeight),n=B,i=M,(E||z)&&(r=dealWithCustom(E,z,I.start.col,I.start.row,y.getColsWidth(I.start.col,I.end.col),y.getRowsHeight(I.start.row,I.end.row),!1,y.isAutoRowHeight(H),[0,0,0,0],e,y)),s=!0);let h,d=f,u=H,c=(e&&(d=e.start.col,u=e.start.row),!y.isPivotTable()&&(\\\"columnHeader\\\"===o||\\\"cornerHeader\\\"===o)&&H>=y.columnHeaderLevelCount&&(o=\\\"body\\\"),h=(y.isPivotTable()||!y.isSeriesNumberInBody(f,H))&&\\\"body\\\"!==o?y.getHeaderDefine(d,u):y.getBodyColumnDefine(d,u),\\\"body\\\"!==o||(null==h?void 0:h.dragOrder)||!(null==h||!h.icon)||!(null==h||!h.tree)),g=(!e&&(y.internalProps.enableTreeNodeMerge||\\\"body\\\"!==o||null!=h&&h.mergeCell)&&(e=y.getCellRange(f,H),t=e.start.col!==e.end.col||e.start.row!==e.end.row)&&(P=dealMerge(e,C,y,b>e.start.row),a=P.cellWidth,l=P.cellHeight),!1);y.internalProps.enableTreeNodeMerge&&t&&(({vtableMergeName:M,vtableMerge:E}=null!=(B=y.getCellRawRecord(e.start.col,e.start.row))?B:{}),g=E)&&(c=!0,y.options.groupTitleCustomLayout&&(r=dealWithCustom(y.options.groupTitleCustomLayout,void 0,e.start.col,e.start.row,y.getColsWidth(e.start.col,e.end.col),y.getRowsHeight(e.start.row,e.end.row),!1,y.isAutoRowHeight(H),[0,0,0,0],e,y)),y.options.groupTitleFieldFormat?n=y.options.groupTitleFieldFormat(B,f,H,y):M&&(n=M));var I,L,k,F,D,z=!g&&!s&&null!=(S=y.isHeader(f,H)?null!=(_=y._getHeaderLayoutMap(f,H).headerType)?_:\\\"text\\\":y.getBodyColumnType(f,H))?S:\\\"text\\\";if(isPromise(n)?(createEmptyCellGroup(f,H,0,A,a,l,p),dealPromiseData(n,y,callCreateCellForPromiseValue.bind(null,{type:z,value:n,define:h,table:y,col:f,row:H,colWidth:m,cellWidth:a,cellHeight:l,columnGroup:p,y:A,customStyle:i,mayHaveIcon:c,cellLocation:o,range:e,customResult:r,defaultRowHeight:v})),p.updateColumnRowNumber(H),I=y.getRowHeight(H),p.updateColumnHeight(I),A+=I):((L=getStyleTheme(i||y._getCellStyle(e?e.start.col:f,e?e.start.row:H),y,e?e.start.col:f,e?e.start.row:H,getProp2).theme).group.cornerRadius=getCellCornerRadius(f,H,y),L.group.width=m,L.group.height=Array.isArray(v)?v[H]:v,L._vtable.padding&&(x=L._vtable.padding),L.text.textAlign&&(R=L.text.textAlign),L.text.textBaseline&&(T=L.text.textBaseline),\\\"body\\\"===o||L.group.fill||(L.group.fill=\\\"#fff\\\"),L=createCell(z,n,h,y,f,H,m,a,l,p,A,x,R,T,c,L,e,r),p.updateColumnRowNumber(H),t?(k=y.getRowHeight(H),F=(y.getColWidth(f),L.attribute).width,D=L.attribute.height,L.contentWidth=F,L.contentHeight=D,dealWithMergeCellSize(e,F,D,x,R,T,y),p.updateColumnHeight(k),A+=k):(p.updateColumnHeight(l),A+=l)),w&&w<H)break}return p.setAttribute(\\\"width\\\",m),{width:m,height:A}}function callCreateCellForPromiseValue(e){let t,i,r;var{type:o,value:n,define:a,table:l,col:s,row:h,colWidth:d,cellWidth:u,cellHeight:c,columnGroup:g,y:p,cellLocation:f,mayHaveIcon:m,customStyle:b,range:C,customResult:v,defaultRowHeight:y}=e,b=getStyleTheme(b||l._getCellStyle(C?C.start.col:s,C?C.start.row:h),l,C?C.start.col:s,C?C.start.row:h,getProp2).theme;b.group.cornerRadius=getCellCornerRadius(s,h,l),b.group.width=d,b.group.height=Array.isArray(y)?y[h]:y,b._vtable.padding&&(t=b._vtable.padding),b.text.textAlign&&(i=b.text.textAlign),b.text.textBaseline&&(r=b.text.textBaseline),\\\"body\\\"===f||b.group.fill||(b.group.fill=\\\"#fff\\\"),createCell(o,n,a,l,s,h,d,u,c,g,p,t,i,r,m,b,C,v)}function dealMerge(i,r,o,e){let n=0,a=0;var t=r.get(`${i.start.col},${i.start.row};${i.end.col},`+i.end.row);if(!t||e){for(let e=i.start.col;e<=i.end.col;e++)n+=o.getColWidth(e);for(let t=i.start.row;t<=i.end.row;t++)a+=o.getRowHeight(t);r.set(`${i.start.col},${i.start.row};${i.end.col},`+i.end.row,{cellWidth:n,cellHeight:a})}else n=t.cellWidth,a=t.cellHeight;return{cellWidth:n,cellHeight:a}}function createEmptyCellGroup(e,t,i,r,o,n,a){var l=new Group2({x:i,y:r,width:o,height:n});l.role=\\\"cell\\\",l.col=e,l.row=t,a.addChild(l)}function createColGroup(r,o,n,a,l,s,h,d,u,c){if(!(l<a||h<s)){var g=u.internalProps.defaultHeaderRowHeight,p=u.defaultRowHeight;let e=0,t=0;for(let i=a;i<=l;i++){var f=i,m=u.getColWidth(f),b=new Group2({x:o+e,y:n,width:m,height:0,clip:!1,pickable:!1}),{width:b,height:f}=(b.role=\\\"column\\\",b.col=i,r.addChild(b),createComplexColumn(b,f,m,s,h,u.scenegraph.mergeMap,\\\"columnHeader\\\"===d&&isNumber_default(g)?g:p,u,c));e+=b,t=Math.max(t,f)}r.setAttribute(\\\"width\\\",e),r.setAttribute(\\\"height\\\",t)}}function createGroupForFirstScreen(e,t,i,r,o,n,a,l,s){var h=s.table,{leftBottomCornerGroup:d,rightTopCornerGroup:u,rightBottomCornerGroup:c}=h.scenegraph;let g,p,f,m;s.setParamsForRow(),s.setParamsForColumn(),g=((\\\"adaptive\\\"===h.widthMode||h.options.autoWrapText&&(\\\"adaptive\\\"===h.heightMode||h.isAutoRowHeight(h.columnHeaderLevelCount)))&&(f=h.colCount-1),Math.min(s.firstScreenColLimit-1,h.colCount-1)),p=(\\\"adaptive\\\"===h.heightMode&&(m=h.rowCount-1),Math.min(s.firstScreenRowLimit-1,h.rowCount-1)),0===h.internalProps._widthResizedColMap.size&&computeColsWidth(h,0,null!=f?f:g),0===h.internalProps._heightResizedRowMap.size&&computeRowsHeight(h,0,\\\"auto\\\"===h.options.canvasHeight?h.rowCount-1:null!=m?m:p),g<h.colCount-h.rightFrozenColCount&&computeColsWidth(h,h.colCount-h.rightFrozenColCount,h.colCount-1),p<h.rowCount-h.bottomFrozenRowCount&&computeRowsHeight(h,h.rowCount-h.bottomFrozenRowCount,h.rowCount-1),h.scenegraph.colHeaderGroup.setAttribute(\\\"x\\\",h.getFrozenColsWidth()),h.scenegraph.rowHeaderGroup.setAttribute(\\\"y\\\",h.getFrozenRowsHeight()),h.scenegraph.bottomFrozenGroup.setAttribute(\\\"x\\\",h.getFrozenColsWidth()),h.scenegraph.rightFrozenGroup.setAttribute(\\\"y\\\",h.getFrozenRowsHeight()),h.scenegraph.bodyGroup.setAttributes({x:h.getFrozenColsWidth(),y:h.getFrozenRowsHeight()}),createColGroup(e,a,l,0,h.frozenColCount-1,0,h.frozenRowCount-1,h.isListTable()?\\\"columnHeader\\\":\\\"cornerHeader\\\",h),g-h.rightFrozenColCount>=h.frozenColCount&&createColGroup(t,a,l,h.frozenColCount,g-h.rightFrozenColCount,0,h.frozenRowCount-1,\\\"columnHeader\\\",h),0<h.frozenColCount&&(0<h.leftRowSeriesNumberCount&&createColGroup(i,a,l,0,h.leftRowSeriesNumberCount-1,h.frozenRowCount,p-h.bottomFrozenRowCount,\\\"rowHeader\\\",h),h.frozenColCount>h.leftRowSeriesNumberCount&&createColGroup(i,a,l,h.leftRowSeriesNumberCount,Math.min(h.frozenColCount-1,h.rowHeaderLevelCount+h.leftRowSeriesNumberCount-1),h.frozenRowCount,p-h.bottomFrozenRowCount,\\\"rowHeader\\\",h),h.frozenColCount>h.rowHeaderLevelCount+h.leftRowSeriesNumberCount)&&createColGroup(i,a,l,h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,h.frozenColCount-1,h.frozenRowCount,p-h.bottomFrozenRowCount,\\\"body\\\",h),0<h.bottomFrozenRowCount&&(0<h.frozenColCount&&(0<h.leftRowSeriesNumberCount&&createColGroup(d,a,l,0,h.leftRowSeriesNumberCount-1,h.rowCount-1-h.bottomFrozenRowCount+1,h.rowCount-1,\\\"rowHeader\\\",h),0<h.rowHeaderLevelCount&&createColGroup(d,a,l,h.leftRowSeriesNumberCount,h.leftRowSeriesNumberCount+h.rowHeaderLevelCount-1,h.rowCount-1-h.bottomFrozenRowCount+1,h.rowCount-1,\\\"rowHeader\\\",h),h.frozenColCount>h.rowHeaderLevelCount+h.leftRowSeriesNumberCount)&&createColGroup(d,a,l,h.rowHeaderLevelCount+h.leftRowSeriesNumberCount,h.frozenColCount-1,h.rowCount-1-h.bottomFrozenRowCount+1,h.rowCount-1,\\\"body\\\",h),g-h.rightFrozenColCount>=h.frozenColCount)&&createColGroup(o,a,l,h.frozenColCount,g-h.rightFrozenColCount,h.rowCount-1-h.bottomFrozenRowCount+1,h.rowCount-1,h.isPivotChart()?\\\"rowHeader\\\":\\\"body\\\",h),0<h.rightFrozenColCount&&(createColGroup(u,a,l,h.colCount-1-h.rightFrozenColCount+1,h.colCount-1,0,h.frozenRowCount-1,\\\"columnHeader\\\",h),createColGroup(r,a,l,h.colCount-1-h.rightFrozenColCount+1,h.colCount-1,h.frozenRowCount,p-h.bottomFrozenRowCount,h.isPivotChart()?\\\"rowHeader\\\":\\\"body\\\",h)),0<h.bottomFrozenRowCount&&0<h.rightFrozenColCount&&createColGroup(c,a,l,h.colCount-1-h.rightFrozenColCount+1,h.colCount-1,h.rowCount-1-h.bottomFrozenRowCount+1,h.rowCount-1,\\\"body\\\",h),g-h.rightFrozenColCount>=h.frozenColCount&&createColGroup(n,a,l,h.frozenColCount,g-h.rightFrozenColCount,h.frozenRowCount,p-h.bottomFrozenRowCount,\\\"body\\\",h),n.firstChild||t.firstChild||e.firstChild||i.firstChild?(s.currentRow=null!=(h=null!=(u=null==(d=n.firstChild)?void 0:d.rowNumber)?u:null==(c=i.firstChild)?void 0:c.rowNumber)?h:s.totalRow,s.rowEnd=s.currentRow,s.rowUpdatePos=s.rowEnd+1,s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.currentCol=null!=(h=null!=(u=null!=(h=null!=(u=null==(d=n.lastChild)?void 0:d.col)?u:null==(c=t.lastChild)?void 0:c.col)?h:null==(d=i.lastChild)?void 0:d.col)?u:null==(c=e.lastChild)?void 0:c.col)?h:s.totalCol,s.colEnd=s.currentCol,s.colUpdatePos=s.colEnd+1,s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.progress()):(s.currentRow=s.totalRow,s.rowEnd=s.currentRow,s.rowUpdatePos=s.rowEnd+1,s.referenceRow=s.rowStart+Math.floor((s.rowEnd-s.rowStart)/2),s.currentCol=s.totalCol,s.colEnd=s.currentCol,s.colUpdatePos=s.colEnd+1,s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2))}function getFirstChild(e){let t=e.firstChild;for(;t&&\\\"group\\\"!==t.type;)t=t._next;return t}function getLastChild(e){let t=e.lastChild;for(;t&&\\\"group\\\"!==t.type;)t=t._prev;return t}function getPrevGroup(e){let t=e._prev;for(;t&&\\\"group\\\"!==t.type;)t=t._prev;return t}function getNextGroup(e){let t=e._next;for(;t&&\\\"group\\\"!==t.type;)t=t._next;return t}function updateAutoColumn(e,t,i,r=\\\"left\\\"){for(let l=e;l<=t;l++){var o=i.scenegraph.getColGroup(l),o=(o&&moveColumnGroup(o,i,r),i.scenegraph.getColGroup(l,!0)),o=(o&&moveColumnGroup(o,i,r),i.scenegraph.getColGroupInBottom(l));o&&moveColumnGroup(o,i,r)}var n=Math.min(i.scenegraph.proxy.colLimit,i.scenegraph.proxy.bodyRightCol-i.scenegraph.proxy.bodyLeftCol+1),n=i.getColsWidth(i.frozenColCount,i.frozenColCount+n),a=i.getColsWidth(i.frozenColCount,i.colCount-1);i.scenegraph.proxy.xLimitLeft=n/2,i.scenegraph.proxy.xLimitRight=a-n/2}function moveColumnGroup(e,t,i=\\\"left\\\"){var r;\\\"left\\\"===i?(r=(r=getPrevGroup(e))?r.attribute.x+t.getColWidth(e._prev.col):t.getColsWidth(t.frozenColCount,e.col-1),e.setAttribute(\\\"x\\\",r)):(r=(r=getNextGroup(e))?r.attribute.x-t.getColWidth(e.col):t.getColsWidth(t.frozenColCount,e.col-1),e.setAttribute(\\\"x\\\",r))}emptyGroup.role=\\\"empty\\\",init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var __awaiter7=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function dynamicSetX(t,i,r,o){return __awaiter7(this,void 0,void 0,function*(){var e;i&&(e=i.col,move(r?o.bodyRightCol-o.colEnd:o.screenLeftCol-o.referenceCol,e,i.left,t,o),r&&(e=o.table.scenegraph.getColGroup(o.colEnd))&&(e=e.attribute.x+e.attribute.width-(o.table.tableNoFrameWidth-o.table.getFrozenColsWidth()-o.table.getRightFrozenColsWidth())-t,o.deltaX=-e,o.table.scenegraph.setBodyAndColHeaderX(-t+o.deltaX)),o.table.scenegraph.updateNextFrame())})}function move(e,t,i,r,o){0<e?moveColumn(e,\\\"left\\\",o.screenLeftCol,i,r,o):e<0&&moveColumn(-e,\\\"right\\\",o.screenLeftCol,i,r,o),o.updateDeltaX(r,i,t),o.table.scenegraph.setBodyAndColHeaderX(-r+o.deltaX)}function moveColumn(o,n,a,l,e,s){return __awaiter7(this,void 0,void 0,function*(){var e,t,i,r;\\\"left\\\"===n&&s.colEnd+o>s.bodyRightCol?o=s.bodyRightCol-s.colEnd:\\\"right\\\"===n&&s.colStart-o<s.bodyLeftCol&&(o=s.colStart-s.bodyLeftCol),0!==o&&(o<0&&(n=\\\"left\\\"===n?\\\"right\\\":\\\"left\\\",o=-o),o<s.colEnd-s.colStart?(r=\\\"left\\\"===n?s.colStart:s.colEnd-o+1,e=\\\"left\\\"===n?s.colStart+o-1:s.colEnd,i=\\\"left\\\"===n?s.colEnd+1:s.colStart-o,t=\\\"left\\\"===n?s.colEnd+o:s.colStart-1,computeColsWidth(s.table,i,t),updatePartColPosition(r,e,n,s),r=i,e=t,s.colStart=\\\"left\\\"===n?s.colStart+o:s.colStart-o,s.colEnd=\\\"left\\\"===n?s.colEnd+o:s.colEnd-o,updateColContent(r,e,s),updateAutoColumn(r,e,s.table,n),t=s.table.scenegraph.getColGroup(a)||s.table.scenegraph.getColGroup(a,!0),r=l-(t.attribute.x+s.table.getFrozenColsWidth()+s.table.scenegraph.proxy.deltaX),s.table.scenegraph.proxy.deltaX+=r,s.currentCol=\\\"left\\\"===n?s.currentCol+o:s.currentCol-o,s.totalCol=Math.max(0,Math.min(s.table.colCount-1,\\\"left\\\"===n?s.totalCol+o:s.totalCol-o)),s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.colUpdatePos=i,s.colUpdateDirection=n):(e=\\\"left\\\"===n?s.colStart+o:s.colStart-o,t=\\\"left\\\"===n?s.colEnd+o:s.colEnd-o,computeColsWidth(s.table,e,t),updateAllColPosition(s.table.getColsWidth(s.bodyLeftCol,e-1),o,n,s),r=t,s.colStart=i=e,s.colEnd=t,updateColContent(i,r,s),updateAutoColumn(i,r,s.table,s.bodyRightCol-(s.colEnd-s.colStart+1)<t?\\\"right\\\":\\\"left\\\"),s.currentCol=\\\"left\\\"===n?s.currentCol+o:s.currentCol-o,s.totalCol=Math.max(0,Math.min(s.table.colCount-1,\\\"left\\\"===n?s.totalCol+o:s.totalCol-o)),s.referenceCol=s.colStart+Math.floor((s.colEnd-s.colStart)/2),s.colUpdatePos=s.colStart,s.colUpdateDirection=s.bodyRightCol-(s.colEnd-s.colStart+1)<t?\\\"right\\\":\\\"left\\\"),s.table.scenegraph.updateNextFrame())})}function updateColGroupPosition(e,t,i){e.col=t,e.forEachChildren(e=>{e.col=t,e.needUpdate=!0}),e.setAttribute(\\\"x\\\",i),e.needUpdate=!0}function updateColGroupContent(t,i){if(t){let e=t.firstChild;for(;e;)e=i.updateCellGroupContent(e)._next;t.needUpdate=!1,t.setAttribute(\\\"width\\\",i.table.getColWidth(t.col))}}function updateColGroupContentAsync(t,i){if(t){var r=i.screenTopRow,o=Math.max(i.bodyTopRow,r-+i.screenRowCount),n=Math.min(i.bodyBottomRow,r+2*i.screenRowCount,i.table.rowCount-1);for(let e=o;e<=n;e++){var a=i.highPerformanceGetCell(t.col,e,!0);i.updateCellGroupContent(a)}i.rowUpdatePos=i.rowStart,t.needUpdate=!1,t.setAttribute(\\\"width\\\",i.table.getColWidth(t.col))}}function updatePartColPosition(e,t,i,r){for(let o=e;o<=t;o++)0<r.table.scenegraph.bodyGroup.childrenCount&&\\\"group\\\"===r.table.scenegraph.bodyGroup.firstChild.type&&updateColPosition(r.table.scenegraph.bodyGroup,i,r),0<r.table.scenegraph.colHeaderGroup.childrenCount&&\\\"group\\\"===r.table.scenegraph.colHeaderGroup.firstChild.type&&updateColPosition(r.table.scenegraph.colHeaderGroup,i,r),0<r.table.scenegraph.bottomFrozenGroup.childrenCount&&\\\"group\\\"===r.table.scenegraph.bottomFrozenGroup.firstChild.type&&updateColPosition(r.table.scenegraph.bottomFrozenGroup,i,r)}function updateColPosition(e,t,i){var r,o;\\\"left\\\"===t?(updateColGroupPosition(o=getFirstChild(e),(r=getLastChild(e)).col+1,r.attribute.x+i.table.getColWidth(r.col)),e.appendChild(o),e.border&&e.appendChild(e.border)):(updateColGroupPosition(r=getLastChild(e),(o=getFirstChild(e)).col-1,o.attribute.x-i.table.getColWidth(o.col-1)),e.insertBefore(r,e.firstChild))}function updateColContent(e,t,i){for(let o=e;o<=t;o++){var r=i.table.scenegraph.getColGroup(o,!0),r=(r&&updateColGroupContent(r,i),i.table.scenegraph.getColGroupInBottom(o)),r=(r&&updateColGroupContent(r,i),i.table.scenegraph.getColGroupInRightTopCorner(o)),r=(r&&updateColGroupContent(r,i),i.table.scenegraph.getColGroupInRightBottomCorner(o)),r=(r&&updateColGroupContent(r,i),i.table.scenegraph.getColGroup(o));r&&updateColGroupContentAsync(r,i)}updateColumnContainerWidth(i.table.scenegraph.colHeaderGroup),updateColumnContainerWidth(i.table.scenegraph.bottomFrozenGroup),updateColumnContainerWidth(i.table.scenegraph.bodyGroup),i.progress()}function updateAllColPosition(i,r,o,n){n.table.scenegraph.colHeaderGroup.forEachChildren((e,t)=>{\\\"group\\\"===e.type&&updateColGroupPosition(e,\\\"left\\\"===o?e.col+r:e.col-r,0===t?i:e._prev.attribute.x+n.table.getColWidth(e._prev.col))}),n.table.scenegraph.bottomFrozenGroup.forEachChildren((e,t)=>{\\\"group\\\"===e.type&&updateColGroupPosition(e,\\\"left\\\"===o?e.col+r:e.col-r,0===t?i:e._prev.attribute.x+n.table.getColWidth(e._prev.col))}),n.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{\\\"group\\\"===e.type&&updateColGroupPosition(e,\\\"left\\\"===o?e.col+r:e.col-r,0===t?i:e._prev.attribute.x+n.table.getColWidth(e._prev.col))})}function updateColumnContainerWidth(e){var t,i=getLastChild(e);i&&(e.setAttribute(\\\"width\\\",i.attribute.x+i.attribute.width),e.border)&&(t=e.border).setAttribute(\\\"width\\\",i.attribute.x+i.attribute.width-(null!=(i=t.attribute.borderLeft)?i:0)/2-(null!=(i=t.attribute.borderRight)?i:0)/2)}function updateAutoRow(e,t,n,a,l,i=\\\"up\\\",s){var h;if(\\\"up\\\"===i)for(let r=e;r<=t;r++)for(let i=n;i<=a;i++){var d=l.scenegraph.highPerformanceGetCell(r,i,!0);if(\\\"cell\\\"===d.role&&d.row){let t;if(d._prev)t=(null==(h=d._prev)?void 0:h.attribute.y)+l.getRowHeight(d._prev.row);else if(s){var u=a===l.rowCount-l.bottomFrozenRowCount-1?a:a+1;if(t=l.scenegraph.highPerformanceGetCell(r,u,!0).attribute.y,isValid_default(t))for(let e=i;e<u;e++)t-=l.getRowHeight(e)}else t=getEstimatePosition(d.row,l);isValid_default(t)&&d.setAttribute(\\\"y\\\",t)}}else for(let o=e;o<=t;o++)for(let i=a;i>=n;i--){var c=l.scenegraph.highPerformanceGetCell(o,i,!0);if(\\\"cell\\\"===c.role&&c.row){let t;if(c._next)t=(null==(g=c._next)?void 0:g.attribute.y)-l.getRowHeight(c.row);else if(s){var g=n<=l.frozenRowCount?l.frozenRowCount:n-1;t=n<=l.frozenRowCount?0:l.scenegraph.highPerformanceGetCell(o,g,!0).attribute.y;for(let e=g;e<i;e++)t+=l.getRowHeight(e)}else t=getEstimatePosition(c.row,l);isValid_default(t)&&c.setAttribute(\\\"y\\\",t)}}var r=Math.min(l.scenegraph.proxy.rowLimit,l.scenegraph.proxy.bodyBottomRow-l.scenegraph.proxy.bodyTopRow+1),r=l.getRowsHeight(l.frozenRowCount,l.frozenRowCount+r),o=l.getRowsHeight(l.frozenRowCount,l.rowCount-1);l.scenegraph.proxy.yLimitTop=r/2,l.scenegraph.proxy.yLimitBottom=o-r/2}function getEstimatePosition(e,t){return e<t.frozenRowCount?t.getRowsHeight(0,e-1):e>=t.rowCount-t.bottomFrozenRowCount?t.getRowsHeight(t.rowCount-t.bottomFrozenRowCount,e-1):t.getRowsHeight(t.frozenRowCount,e-1)}init_esbuild_inject(),init_esbuild_inject();var __awaiter8=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function dynamicSetY(t,i,r,o){return __awaiter8(this,void 0,void 0,function*(){var e;i&&(e=i.row,move2(r?o.bodyBottomRow-o.rowEnd:e-o.referenceRow,e,i.top,t,o),r)&&\\\"cell\\\"===(e=o.table.scenegraph.highPerformanceGetCell(o.colStart,o.rowEnd,!0)).role&&(e=e.attribute.y+e.attribute.height-(o.table.tableNoFrameHeight-o.table.getFrozenRowsHeight()-o.table.getBottomFrozenRowsHeight())-t,o.deltaY=-e,o.updateBody(t-o.deltaY))})}function move2(e,t,i,r,o){0<e?moveCell(e,\\\"up\\\",t,i,r,o):e<0&&moveCell(-e,\\\"down\\\",t,i,r,o),o.updateDeltaY(r,i,t),o.updateBody(r-o.deltaY)}function moveCell(a,l,s,e,t,h){return __awaiter8(this,void 0,void 0,function*(){if(\\\"up\\\"===l&&h.rowEnd+a>h.bodyBottomRow?a=h.bodyBottomRow-h.rowEnd:\\\"down\\\"===l&&h.rowStart-a<h.bodyTopRow&&(a=h.rowStart-h.bodyTopRow),0!==a){if(a<0&&(l=\\\"up\\\"===l?\\\"down\\\":\\\"up\\\",a=-a),a<h.rowEnd-h.rowStart){var i=\\\"up\\\"===l?h.rowStart:h.rowEnd-a+1,r=\\\"up\\\"===l?h.rowStart+a-1:h.rowEnd,o=\\\"up\\\"===l?h.rowEnd+1:h.rowStart-a,n=\\\"up\\\"===l?h.rowEnd+a:h.rowStart-1;let e,t;t=h.table.isAutoRowHeight(i)?(e=o,n):(e=Math.max(h.bodyTopRow,s-+h.screenRowCount),Math.min(h.bodyBottomRow,s+2*h.screenRowCount,h.table.rowCount-1)),computeRowsHeight(h.table,e,t,!1),updatePartRowPosition(i,r,l,h),h.rowStart=\\\"up\\\"===l?h.rowStart+a:h.rowStart-a,h.rowEnd=\\\"up\\\"===l?h.rowEnd+a:h.rowEnd-a;r=updateRowContent(e,t,h,!0);h.table.isAutoRowHeight(i)&&(updateAutoRow(h.bodyLeftCol,h.bodyRightCol,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<n?\\\"down\\\":\\\"up\\\",!0),updateAutoRow(0,h.table.frozenColCount-1,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<n?\\\"down\\\":\\\"up\\\",!0),updateAutoRow(h.table.colCount-h.table.rightFrozenColCount,h.table.colCount-1,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<n?\\\"down\\\":\\\"up\\\",!0)),h.currentRow=\\\"up\\\"===l?h.currentRow+a:h.currentRow-a,h.totalRow=Math.max(0,Math.min(h.bodyBottomRow,\\\"up\\\"===l?h.totalRow+a:h.totalRow-a,h.table.rowCount-1)),h.referenceRow=h.rowStart+Math.floor((h.rowEnd-h.rowStart)/2),h.table.isAutoRowHeight(i)&&r?h.rowUpdatePos=Math.min(h.rowUpdatePos,h.rowEnd+1):h.rowUpdatePos=Math.min(h.rowUpdatePos,o),h.rowUpdateDirection=l}else{n=\\\"up\\\"===l?h.rowStart+a:h.rowStart-a,i=Math.min(h.table.rowCount-1,\\\"up\\\"===l?h.rowEnd+a:h.rowEnd-a),r=h.table.getRowsHeight(h.bodyTopRow,n-1);let e,t;t=h.table.isAutoRowHeight(n)?(e=n,i):(e=Math.max(h.bodyTopRow,s-+h.screenRowCount),Math.min(h.bodyBottomRow,s+2*h.screenRowCount,h.table.rowCount-1)),computeRowsHeight(h.table,e,t,!1),updateAllRowPosition(r,a,l,h),h.rowStart=n,h.rowEnd=i;o=updateRowContent(e,t,h,!0);h.table.isAutoRowHeight(n)&&(updateAutoRow(h.bodyLeftCol,h.bodyRightCol,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<i?\\\"down\\\":\\\"up\\\"),updateAutoRow(0,h.table.frozenColCount-1,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<i?\\\"down\\\":\\\"up\\\"),updateAutoRow(h.table.colCount-h.table.rightFrozenColCount,h.table.colCount-1,e,t,h.table,h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<i?\\\"down\\\":\\\"up\\\")),h.currentRow=\\\"up\\\"===l?h.currentRow+a:h.currentRow-a,h.totalRow=Math.max(0,Math.min(h.bodyBottomRow,\\\"up\\\"===l?h.totalRow+a:h.totalRow-a,h.table.rowCount-1)),h.referenceRow=h.rowStart+Math.floor((h.rowEnd-h.rowStart)/2),h.table.isAutoRowHeight(n)&&o?h.rowUpdatePos=h.rowEnd+1:h.rowUpdatePos=h.rowStart,h.rowUpdateDirection=h.bodyBottomRow-(h.rowEnd-h.rowStart+1)<i?\\\"down\\\":\\\"up\\\"}h.table.scenegraph.updateNextFrame(),yield h.progress()}})}function updatePartRowPosition(t,i,r,o){for(let e=0;e<o.table.frozenColCount;e++){var n=o.table.scenegraph.getColGroup(e);if(n)for(let e=t;e<=i;e++)updateCellGroupPosition(n,r,o)}for(let s=o.table.colCount-o.table.rightFrozenColCount;s<o.table.colCount;s++){var a=o.table.scenegraph.getColGroup(s);if(a)for(let e=t;e<=i;e++)updateCellGroupPosition(a,r,o)}for(let h=o.bodyLeftCol;h<=o.bodyRightCol;h++){var l=o.table.scenegraph.getColGroup(h);if(l)for(let e=t;e<=i;e++)updateCellGroupPosition(l,r,o)}}function updateCellGroupPosition(e,t,i){var r;1<=e.childrenCount&&(\\\"up\\\"===t?(r=e.firstChild,i.updateCellGroupPosition(r,e.lastChild.row+1,e.lastChild.attribute.y+i.table.getRowHeight(e.lastChild.row)),e.appendChild(r)):(r=e.lastChild,i.updateCellGroupPosition(r,e.firstChild.row-1,e.firstChild.attribute.y-i.table.getRowHeight(r.row)),e.insertBefore(r,e.firstChild)))}function updateAllRowPosition(i,r,o,n){for(let l=0;l<n.table.frozenColCount;l++){var e=n.table.scenegraph.getColGroup(l);null!=e&&e.forEachChildren((e,t)=>{n.updateCellGroupPosition(e,\\\"up\\\"===o?e.row+r:e.row-r,0===t?i:e._prev.attribute.y+n.table.getRowHeight(e._prev.row))})}for(let s=n.table.colCount-n.table.rightFrozenColCount;s<n.table.colCount;s++){var t=n.table.scenegraph.getColGroup(s);null!=t&&t.forEachChildren((e,t)=>{n.updateCellGroupPosition(e,\\\"up\\\"===o?e.row+r:e.row-r,0===t?i:e._prev.attribute.y+n.table.getRowHeight(e._prev.row))})}for(let h=n.bodyLeftCol;h<=n.bodyRightCol;h++){var a=n.table.scenegraph.getColGroup(h);null!=a&&a.forEachChildren((e,t)=>{n.updateCellGroupPosition(e,\\\"up\\\"===o?e.row+r:e.row-r,0===t?i:e._prev.attribute.y+n.table.getRowHeight(e._prev.row))})}}function updateRowContent(t,i,r,e=!1){for(let u=0;u<r.table.frozenColCount;u++)for(let e=t;e<=i;e++){var o=r.highPerformanceGetCell(u,e,!0);r.updateCellGroupContent(o)}for(let c=r.table.colCount-r.table.rightFrozenColCount;c<r.table.colCount;c++)for(let e=t;e<=i;e++){var n=r.highPerformanceGetCell(c,e);r.updateCellGroupContent(n)}let a=r.bodyLeftCol,l=r.bodyRightCol,s=!0;var h;e&&(h=r.screenLeftCol,a=Math.max(r.bodyLeftCol,h-+r.screenColCount),l=Math.min(r.bodyRightCol,h+2*r.screenColCount),a===r.bodyLeftCol&&l===r.bodyRightCol||(s=!1));for(let g=a;g<=l;g++)for(let e=t;e<=i;e++){var d=r.highPerformanceGetCell(g,e);r.updateCellGroupContent(d)}return updateColumnContainerHeight(r.table.scenegraph.rowHeaderGroup),updateColumnContainerHeight(r.table.scenegraph.rightFrozenGroup),updateColumnContainerHeight(r.table.scenegraph.bodyGroup),r.table.scenegraph.updateNextFrame(),s}function updateColumnContainerHeight(e){var t,i=getLastChild(e);i&&(i=getLastChild(i))&&(e.setAttribute(\\\"height\\\",i.attribute.y+i.attribute.height),e.border)&&(t=e.border).setAttribute(\\\"height\\\",i.attribute.y+i.attribute.height-(null!=(i=t.attribute.borderTop)?i:0)/2-(null!=(i=t.attribute.borderBottom)?i:0)/2)}init_esbuild_inject();var __awaiter9=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function sortVertical(d){var u;return __awaiter9(this,void 0,void 0,function*(){let e,t;d.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{\\\"group\\\"===e.type&&(e.needUpdate=!0,null!=e)&&e.forEachChildren(e=>{e.needUpdate=!0})}),t=d.table.isAutoRowHeight(d.rowStart)?(e=d.rowStart,d.rowEnd):(e=Math.max(d.bodyTopRow,d.screenTopRow-+d.screenRowCount),Math.min(d.bodyBottomRow,d.screenTopRow+2*d.screenRowCount,d.table.rowCount-1));var i=d.table.getAllRowsHeight(),r=(computeRowsHeight(d.table,e,t),d.table.getAllRowsHeight());i!==r&&d.table.scenegraph.updateContainerHeight(d.table.frozenRowCount,r-i);for(let l=0;l<(null!=(u=d.table.frozenColCount)?u:0);l++){var o=d.table.scenegraph.getColGroup(l);null!=o&&o.setAttribute(\\\"chartInstance\\\",void 0);for(let e=d.rowStart;e<=d.rowEnd;e++)d.table.scenegraph.updateCellContent(l,e);for(let t=d.table.rowCount-d.table.bottomFrozenRowCount;t<d.table.rowCount;t++)d.table.scenegraph.updateCellContent(l,t)}for(let s=d.colStart;s<=d.colEnd;s++){var n=d.table.scenegraph.getColGroup(s);null!=n&&n.setAttribute(\\\"chartInstance\\\",void 0);for(let e=d.table.rowCount-d.table.bottomFrozenRowCount;e<d.table.rowCount;e++)d.table.scenegraph.updateCellContent(s,e)}for(let h=d.table.colCount-d.table.rightFrozenColCount;h<d.table.colCount;h++){var a=d.table.scenegraph.getColGroup(h);null!=a&&a.setAttribute(\\\"chartInstance\\\",void 0);for(let e=d.rowStart;e<=d.rowEnd;e++)d.table.scenegraph.updateCellContent(h,e);for(let t=d.table.rowCount-d.table.bottomFrozenRowCount;t<d.table.rowCount;t++)d.table.scenegraph.updateCellContent(h,t)}updateRowContent(e,t,d),d.table.isAutoRowHeight(e)&&updateAutoRow(d.bodyLeftCol,d.bodyRightCol,e,t,d.table,d.bodyBottomRow-(d.rowEnd-d.rowStart+1)<d.rowEnd?\\\"down\\\":\\\"up\\\"),d.rowUpdatePos=d.rowStart,d.rowUpdateDirection=d.bodyBottomRow-(d.rowEnd-d.rowStart+1)<d.rowEnd?\\\"down\\\":\\\"up\\\",d.table.scenegraph.updateNextFrame(),d.table.isAutoRowHeight(d.rowStart)||(yield d.progress())})}init_esbuild_inject();var __awaiter10=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function sortHorizontal(a){return __awaiter10(this,void 0,void 0,function*(){a.table.scenegraph.bodyGroup.forEachChildren((e,t)=>{\\\"group\\\"===e.type&&(e.needUpdate=!0,null!=e)&&e.forEachChildren(e=>{e.needUpdate=!0})});var e=Math.max(a.bodyLeftCol,a.screenLeftCol-+a.screenColCount),t=Math.min(a.bodyRightCol,a.screenLeftCol+2*a.screenColCount);computeColsWidth(a.table,e,t);for(let o=a.colStart;o<=a.colEnd;o++){var i=a.table.scenegraph.getColGroup(o);null!=i&&i.setAttribute(\\\"chartInstance\\\",void 0);for(let e=a.table.rowCount-a.table.bottomFrozenRowCount;e<a.table.rowCount;e++)a.table.scenegraph.updateCellContent(o,e)}for(let n=a.table.colCount-a.table.rightFrozenColCount;n<a.table.colCount;n++){var r=a.table.scenegraph.getColGroup(n);null!=r&&r.setAttribute(\\\"chartInstance\\\",void 0);for(let e=a.rowStart;e<=a.rowEnd;e++)a.table.scenegraph.updateCellContent(n,e);for(let t=a.table.rowCount-a.table.bottomFrozenRowCount;t<a.table.rowCount;t++)a.table.scenegraph.updateCellContent(n,t)}updateColContent(e,t,a),a.colUpdatePos=a.colStart,a.colUpdateDirection=a.bodyRightCol-(a.colEnd-a.colStart+1)<a.colEnd?\\\"right\\\":\\\"left\\\",a.table.scenegraph.updateNextFrame(),yield a.progress()})}function handleTextStick(a){let l=a.internalProps.stick.changedCells,{scrollTop:e,scrollLeft:t,frozenRowCount:s,frozenColCount:h}=(l.forEach(t=>{a.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{e.setAttributes({dx:t.dx,dy:t.dy})})}),l.clear(),a),d=a.getFrozenRowsHeight(),u=a.getFrozenColsWidth(),i=a.getRowAt(e+d+1).row,r=a.getColAt(t+u+1).col,c=Math.max(i,a.frozenRowCount),g=Math.max(r,a.frozenColCount),p=a.getAllRowsHeight()>a.tableNoFrameHeight?a.getRowAt(e+a.tableNoFrameHeight-a.getBottomFrozenRowsHeight()-1).row:a.rowCount-a.bottomFrozenRowCount-1,f=a.getAllColsWidth()>a.tableNoFrameWidth?a.getColAt(t+a.tableNoFrameWidth-a.getRightFrozenColsWidth()-1).col:a.colCount-a.rightFrozenColCount-1;if(!(f<0||p<0)){for(let i=0;i<s&&!(f<g);i++)[g,f].forEach(e=>{var t=a._getCellStyle(e,i);null!=t&&t.textStick&&\\\"vertical\\\"!==(null==t?void 0:t.textStick)&&adjustCellContentHorizontalLayout(a.scenegraph.getCell(e,i),u+a.tableX,a.tableNoFrameWidth-a.getRightFrozenColsWidth()+a.tableX,l,null==t?void 0:t.textStickBaseOnAlign,a)});for(let r=0;r<h&&!(p<c);r++)[c,p].forEach(e=>{var t=a._getCellStyle(r,e);null!=t&&t.textStick&&\\\"horizontal\\\"!==(null==t?void 0:t.textStick)&&adjustCellContentVerticalLayout(a.scenegraph.getCell(r,e),d+a.tableY,a.tableNoFrameHeight-a.getBottomFrozenRowsHeight()+a.tableY,l,null==t?void 0:t.textStickBaseOnAlign,a)});for(let o=g;o<=f&&!(p<c);o++)[c,p].forEach(e=>{var t=a._getCellStyle(o,e);null!=t&&t.textStick&&\\\"horizontal\\\"!==(null==t?void 0:t.textStick)&&adjustCellContentVerticalLayout(a.scenegraph.getCell(o,e),d+a.tableY,a.tableNoFrameHeight-a.getBottomFrozenRowsHeight()+a.tableY,l,null==t?void 0:t.textStickBaseOnAlign,a)});for(let n=c;n<=p&&!(f<g);n++)[g,f].forEach(e=>{var t=a._getCellStyle(e,n);null!=t&&t.textStick&&\\\"vertical\\\"!==(null==t?void 0:t.textStick)&&adjustCellContentHorizontalLayout(a.scenegraph.getCell(e,n),u+a.tableX,a.tableNoFrameWidth-a.getRightFrozenColsWidth()+a.tableX,l,null==t?void 0:t.textStickBaseOnAlign,a)})}}function adjustCellContentVerticalLayout(e,i,r,o,n,a){if(isNumber_default(e.mergeStartCol)&&isNumber_default(e.mergeStartRow)&&isNumber_default(e.mergeEndCol)&&isNumber_default(e.mergeEndRow)){var{colStart:l,colEnd:s,rowStart:h,rowEnd:d}=getCellMergeRange(e,a.scenegraph);for(let t=l;t<=s;t++)for(let e=h;e<=d;e++){var u=a.scenegraph.getCell(t,e);\\\"cell\\\"===u.role&&dealVertical(u,i,r,o,n)}}else dealVertical(e,i,r,o,n)}function dealVertical(e,t,i,r,o){var n=e.getChildByName(\\\"text\\\",!0)||e.getChildByName(\\\"image\\\",!0);if(n){if(\\\"image\\\"===n.type){var a=n.attribute.image;if(!a||!n.resources)return;if(\\\"success\\\"!==n.resources.get(a).state)return}var a=null!=(a=n.textBaseline)?a:\\\"top\\\",l=(n.AABBBounds.width(),n.globalAABBBounds.y1),s=n.globalAABBBounds.y2;if(\\\"middle\\\"===a&&o){var a=e.globalAABBBounds.y1+(null!=(a=null==(a=e.firstChild)?void 0:a.attribute.dy)?a:0),h=a+(null!=(h=null!=(h=e.contentHeight)?h:e.attribute.height)?h:0);if(a<t||i<h){const d=Math.max(a,t),u=Math.min(h,i),c=n.globalTransMatrix.f-(u+d)/2+n.AABBBounds.height()/2;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(h=null==(a=e.firstChild)?void 0:a.attribute.dx)?h:0,dy:null!=(a=null==(n=e.firstChild)?void 0:n.attribute.dy)?a:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dy\\\",(null!=(t=e.attribute.dy)?t:0)-c+2)})}}else if(l<t){const g=l-t;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(n=null==(h=e.firstChild)?void 0:h.attribute.dx)?n:0,dy:null!=(l=null==(a=e.firstChild)?void 0:a.attribute.dy)?l:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dy\\\",(null!=(t=e.attribute.dy)?t:0)-g+2)})}else if(i<s){const p=s-i;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(n=null==(h=e.firstChild)?void 0:h.attribute.dx)?n:0,dy:null!=(l=null==(a=e.firstChild)?void 0:a.attribute.dy)?l:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dy\\\",(null!=(t=e.attribute.dy)?t:0)-p)})}}}function adjustCellContentHorizontalLayout(e,i,r,o,n,a){if(isNumber_default(e.mergeStartCol)&&isNumber_default(e.mergeStartRow)&&isNumber_default(e.mergeEndCol)&&isNumber_default(e.mergeEndRow)){var{colStart:l,colEnd:s,rowStart:h,rowEnd:d}=getCellMergeRange(e,a.scenegraph);for(let t=l;t<=s;t++)for(let e=h;e<=d;e++){var u=a.scenegraph.getCell(t,e);\\\"cell\\\"===u.role&&dealHorizontal(u,i,r,o,n)}}else dealHorizontal(e,i,r,o,n)}function dealHorizontal(e,t,i,r,o){var n=e.getChildByName(\\\"text\\\",!0)||e.getChildByName(\\\"image\\\",!0);if(n){if(\\\"image\\\"===n.type){var a=n.attribute.image;if(!a||!n.resources)return;if(\\\"success\\\"!==n.resources.get(a).state)return}var a=null!=(a=null!=(a=n.attribute.textAlign)?a:n.textAlign)?a:\\\"left\\\",l=(n.AABBBounds.width(),n.globalAABBBounds.x1),s=n.globalAABBBounds.x2;if(\\\"center\\\"===a&&o){var a=e.globalAABBBounds.x1+(null!=(a=null==(a=e.firstChild)?void 0:a.attribute.dx)?a:0),h=a+(null!=(h=null!=(h=e.contentWidth)?h:e.attribute.width)?h:0);if(a<t||i<h){const d=Math.max(a,t),u=Math.min(h,i),c=n.globalTransMatrix.e-(u+d)/2;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(h=null==(a=e.firstChild)?void 0:a.attribute.dx)?h:0,dy:null!=(a=null==(n=e.firstChild)?void 0:n.attribute.dy)?a:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dx\\\",(null!=(t=e.attribute.dx)?t:0)-c+2)})}}else if(l<t){const g=l-t;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(n=null==(h=e.firstChild)?void 0:h.attribute.dx)?n:0,dy:null!=(l=null==(a=e.firstChild)?void 0:a.attribute.dy)?l:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dx\\\",(null!=(t=e.attribute.dx)?t:0)-g+2)})}else if(i<s){const p=s-i;r.has(e.col+\\\"-\\\"+e.row)||r.set(e.col+\\\"-\\\"+e.row,{col:e.col,row:e.row,dx:null!=(n=null==(h=e.firstChild)?void 0:h.attribute.dx)?n:0,dy:null!=(l=null==(a=e.firstChild)?void 0:a.attribute.dy)?l:0}),e.forEachChildren(e=>{var t;e.setAttribute(\\\"dx\\\",(null!=(t=e.attribute.dx)?t:0)-p)})}}}function checkHaveTextStick(e){var t=e.internalProps.layoutMap.headerObjects,i=e.internalProps.layoutMap.columnObjects;for(let n=0;n<t.length;n++){var r=t[n];if(r&&null!=(r=r.style)&&r.textStick)return!0}for(let a=0;a<i.length;a++){var o=i[a];if(o&&null!=(o=o.style)&&o.textStick)return!0}return!!(e.theme.headerStyle.textStick||e.theme.rowHeaderStyle.textStick||e.theme.bodyStyle.textStick)}init_esbuild_inject();var __awaiter11=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})},SceneProxy=class{constructor(e){this.isRelease=!1,this.mode=\\\"column\\\",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=e,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*e.tableNoFrameWidth/e.defaultColWidth))):this.table.isAutoRowHeight(e.columnHeaderLevelCount)?this.rowLimit=Math.max(100,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight)):(\\\"autoWidth\\\"!==this.table.widthMode&&(this.rowLimit=Math.max(200,Math.ceil(2*e.tableNoFrameHeight/e.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*e.tableNoFrameWidth/e.defaultColWidth))),this.table.internalProps.transpose?this.mode=\\\"row\\\":this.table.isPivotTable()&&(this.mode=\\\"pivot\\\"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount),this.table.options.maintainedColumnCount&&(this.colLimit=this.table.options.maintainedColumnCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;var e=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1),t=(this.totalActualBodyColCount=e,this.totalCol=this.bodyLeftCol+e-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol,this.table.defaultColWidth),e=(this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/t),t*e),i=t*(this.bodyRightCol-this.bodyLeftCol+1),i=(this.xLimitLeft=e/2,this.xLimitRight=i-e/2,5*this.table.tableNoFrameWidth);this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(i/t))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;var e=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1),t=(this.totalActualBodyRowCount=e,this.totalRow=this.bodyTopRow+e-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow,this.table.defaultRowHeight),e=(this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/t),t*e),i=t*(this.bodyBottomRow-this.bodyTopRow+1),i=(this.yLimitTop=e/2,this.yLimitBottom=i-e/2,5*this.table.tableNoFrameHeight);this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/t),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(i/t))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;var e=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=e,this.totalRow=this.rowStart+e-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;var e=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=e,this.totalCol=this.bodyLeftCol+e-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){var e=this.table.defaultColWidth,t=(this.taskColCount=+Math.ceil(this.table.tableNoFrameWidth/e),5*this.table.tableNoFrameWidth),t=(this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(t/e)),this.table.defaultRowHeight),e=(this.taskRowCount=+Math.ceil(this.table.tableNoFrameHeight/t),5*this.table.tableNoFrameHeight);this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/t),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(e/t))}createGroupForFirstScreen(e,t,i,r,o,n,a,l){createGroupForFirstScreen(e,t,i,r,o,n,a,l,this)}progress(){return __awaiter11(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((e,t)=>{setTimeout(()=>__awaiter11(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),handleTextStick(this.table),this.table.scenegraph.updateNextFrame(),e())}),16)})})}createRow(){return __awaiter11(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return __awaiter11(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(e){var i=Math.min(this.totalRow,this.currentRow+e);if(computeRowsHeight(this.table,this.currentRow+1,i,!1),this.rowEnd=i,this.table.frozenColCount){let e=0;for(let t=0;t<this.table.frozenColCount;t++){var r=this.table.scenegraph.getColGroup(t),r=(this.table.isListTable(),createComplexColumn(r,t,r.attribute.width,this.currentRow+1,i,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table)).height;e=Math.max(e,r),this.table.scenegraph.rowHeaderGroup.setAttribute(\\\"height\\\",e)}}if(this.table.rightFrozenColCount){let e=0;for(let t=this.table.colCount-this.table.rightFrozenColCount;t<this.table.colCount;t++){var o=this.table.scenegraph.getColGroup(t),o=(this.table.isPivotChart(),createComplexColumn(o,t,o.attribute.width,this.currentRow+1,i,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table)).height;e=Math.max(e,o),this.table.scenegraph.rightFrozenGroup.setAttribute(\\\"height\\\",e)}}let t=0;for(let a=this.bodyLeftCol;a<=this.bodyRightCol;a++){var n=this.table.scenegraph.getColGroup(a);n&&(this.table.rowHeaderLevelCount,n=createComplexColumn(n,a,n.attribute.width,this.currentRow+1,i,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table).height,t=Math.max(t,n))}this.table.scenegraph.bodyGroup.setAttribute(\\\"height\\\",t),this.currentRow=i,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(e){var t=Math.min(this.totalCol,this.currentCol+e);computeColsWidth(this.table,this.currentCol+1,t),this.colEnd=t;for(let a=0;a<this.table.rowCount;a++){var i=this.highPerformanceGetCell(this.currentCol,a);\\\"cell\\\"===i.role&&isNumber_default(i.mergeStartCol)&&i.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(i.col,i.row)}this.table.frozenRowCount&&(n=(o=this.table.scenegraph.colHeaderGroup.lastChild instanceof Group2?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev).attribute.x+o.attribute.width,o=o.attribute.y,createColGroup(this.table.scenegraph.colHeaderGroup,n,o,this.currentCol+1,t,0,this.table.frozenRowCount-1,\\\"columnHeader\\\",this.table)),this.table.bottomFrozenRowCount&&(o=(n=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof Group2?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev).attribute.x+n.attribute.width,n=n.attribute.y,createColGroup(this.table.scenegraph.bottomFrozenGroup,o,n,this.currentCol+1,t,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,\\\"columnHeader\\\",this.table));let r=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof Group2?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);var o=(r=r||this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof Group2?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev)).attribute.x+r.attribute.width,n=r.attribute.y;createColGroup(this.table.scenegraph.bodyGroup,o,n,this.currentCol+1,t,this.rowStart,this.rowEnd,\\\"body\\\",this.table),this.currentCol=t,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(r,o=!1){return __awaiter11(this,void 0,void 0,function*(){var e=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,t=this.table.getAllRowsHeight()-e,i=this.table.getTargetRowAt(r+this.table.scenegraph.colHeaderGroup.attribute.height);i&&(this.screenTopRow=i.row),!(r<e&&this.rowStart===this.bodyTopRow||t<r&&this.rowEnd===this.bodyBottomRow)&&(this.table.scenegraph.bodyGroup.firstChild&&\\\"group\\\"===this.table.scenegraph.bodyGroup.firstChild.type&&0!==this.table.scenegraph.bodyGroup.firstChild.childrenCount||this.table.scenegraph.rowHeaderGroup.firstChild&&\\\"group\\\"===this.table.scenegraph.rowHeaderGroup.firstChild.type&&0!==this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount)?this.dynamicSetY(r,i,o):(this.updateDeltaY(r),this.updateBody(r-this.deltaY))})}setX(r,o=!1){return __awaiter11(this,void 0,void 0,function*(){var e=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,t=this.table.getAllColsWidth()-e,i=this.table.getTargetColAt(r+this.table.scenegraph.rowHeaderGroup.attribute.width);i&&(this.screenLeftCol=i.col),r<e&&this.colStart===this.bodyLeftCol||t<r&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&\\\"group\\\"===this.table.scenegraph.bodyGroup.firstChild.type&&0===this.table.scenegraph.bodyGroup.firstChild.childrenCount?(this.updateDeltaX(r),this.table.scenegraph.setBodyAndColHeaderX(-r+this.deltaX)):this.dynamicSetX(r,i,o)})}dynamicSetY(e,t,i=!1){return __awaiter11(this,void 0,void 0,function*(){dynamicSetY(e,t,i,this)})}dynamicSetX(e,t,i=!1){return __awaiter11(this,void 0,void 0,function*(){dynamicSetX(e,t,i,this)})}updateBody(e){this.table.scenegraph.setBodyAndRowHeaderY(-e)}updateRowCellGroupsAsync(){return __awaiter11(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(e){var t=Math.min(this.bodyBottomRow,this.rowUpdatePos+e);this.table.isAutoRowHeight(this.rowUpdatePos)&&computeRowsHeight(this.table,this.rowUpdatePos,t,!1),updateRowContent(this.rowUpdatePos,t,this),this.table.isAutoRowHeight(this.rowUpdatePos)&&(updateAutoRow(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0),updateAutoRow(0,this.table.frozenColCount-1,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0),updateAutoRow(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,t,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=t+1}updateBottomFrozenCellGroups(){var e=this.table.rowCount-this.table.bottomFrozenRowCount,t=this.table.rowCount-1;this.table.isAutoRowHeight(e)&&computeRowsHeight(this.table,e,t,!1),updateRowContent(e,t,this),this.table.isAutoRowHeight(e)&&(updateAutoRow(this.bodyLeftCol,this.bodyRightCol,e,t,this.table,this.rowUpdateDirection),updateAutoRow(0,this.table.frozenColCount-1,e,t,this.table,this.rowUpdateDirection),updateAutoRow(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,e,t,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){var e=this.table.colCount-this.table.rightFrozenColCount,t=this.table.colCount-1;\\\"autoWidth\\\"===this.table.widthMode&&computeColsWidth(this.table,e,t,!1),updateColContent(e,t,this),this.table.isAutoRowHeight(this.rowStart)&&updateAutoColumn(e,t,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return __awaiter11(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(e){var t=Math.min(this.bodyRightCol,this.colUpdatePos+e);computeColsWidth(this.table,this.colUpdatePos,t),updateColContent(this.colUpdatePos,t,this),this.colUpdatePos=t+1}updateCellGroupPosition(e,t,i){e.row=t,e.mergeStartCol=void 0,e.mergeStartRow=void 0,e.mergeEndCol=void 0,e.mergeEndRow=void 0,e.setAttribute(\\\"y\\\",i),e.needUpdate=!0,e.needUpdateForAutoRowHeight=!0}updateCellGroupContent(e){var t;return e.needUpdate&&\\\"cell\\\"===e.role&&(t=this.table.scenegraph.updateCellContent(e.col,e.row),e.needUpdate=!1,t)||e}sortCellVertical(){return __awaiter11(this,void 0,void 0,function*(){yield sortVertical(this)})}sortCellHorizontal(){return __awaiter11(this,void 0,void 0,function*(){yield sortHorizontal(this)})}highPerformanceGetCell(t,i,r){if(i>=this.table.frozenRowCount&&i<this.table.rowCount-this.table.bottomFrozenRowCount&&(i<this.rowStart||i>this.rowEnd))return emptyGroup;if(t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return emptyGroup;if(this.cellCache.get(t)){var o=this.cellCache.get(t);if((o._next||o._prev)&&Math.abs(o.row-i)<i){let e=getCellByCache(o,i);return(e=e&&(r||\\\"shadow-cell\\\"!==e.role)?e:this.table.scenegraph.getCell(t,i,r)).row&&this.cellCache.set(t,e),e}o=this.table.scenegraph.getCell(t,i,r);return o.col===t&&o.row&&this.cellCache.set(t,o),o}o=this.table.scenegraph.getCell(t,i,r);return o.col===t&&o.row&&this.cellCache.set(t,o),o}updateDeltaY(t,i,r){if(this.rowStart===this.bodyTopRow){var o=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);\\\"cell\\\"===o.role&&(o=o.attribute.y,this.deltaY=-o)}else if(this.rowEnd===this.bodyBottomRow){var o=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);\\\"cell\\\"===o.role&&(o=o.attribute.y+o.attribute.height-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()),this.deltaY=-o)}else if(isValid_default(i)&&isValid_default(r)){let e=this.table.scenegraph.highPerformanceGetCell(this.colStart,r,!0);\\\"cell\\\"!==e.role&&(e=this.table.scenegraph.highPerformanceGetCell(0,r,!0));var o=t-this.deltaY,n=i-o,o=e.attribute.y-o+this.table.getFrozenRowsHeight();this.deltaY=n-o}}updateDeltaX(e,t,i){var r,o,n;this.colStart===this.bodyLeftCol?(n=this.table.scenegraph.getColGroup(this.colStart))&&(n=n.attribute.x,this.deltaX=-n):this.colEnd===this.bodyRightCol?(n=this.table.scenegraph.getColGroup(this.colEnd))&&(n=n.attribute.x+n.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()),this.deltaX=-n):isValid_default(t)&&isValid_default(i)&&(n=this.table.scenegraph.getColGroup(i)||this.table.scenegraph.getColGroup(i,!0),o=t-(r=e-this.deltaX),n=n.attribute.x-r+this.table.getFrozenColsWidth(),this.deltaX=o-n)}release(){this.isRelease=!0}};function getCellByCache(e,t){var i,r;return e?e.row===t?e:(i=e._prev,r=e._next,t<e.row&&i&&i.row===e.row-1?getCellByCache(i,t):e.row<t&&r&&r.row===e.row+1?getCellByCache(r,t):null):null}function moveHeaderPosition(e,t,o,n,i,a){var l=a.scenegraph;for(let r=e;r<=t;r++){const c=a.getColWidth(r),g=a.scenegraph.getColGroup(r,!0),p=a.scenegraph.getColGroup(r),f=a.scenegraph.getColGroupInBottom(r),m=a.scenegraph.getColGroupInLeftBottomCorner(r),b=a.scenegraph.getColGroupInRightBottomCorner(r);g&&(g.setAttribute(\\\"width\\\",c),g.forEachChildren(e=>{e.setAttribute(\\\"width\\\",c)})),p&&(p.setAttribute(\\\"width\\\",c),p.forEachChildren(e=>{e.setAttribute(\\\"width\\\",c)})),f&&(f.setAttribute(\\\"width\\\",c),f.forEachChildren(e=>{e.setAttribute(\\\"width\\\",c)})),b&&(b.setAttribute(\\\"width\\\",c),b.forEachChildren(e=>{e.setAttribute(\\\"width\\\",c)})),m&&(m.setAttribute(\\\"width\\\",c),m.forEachChildren(e=>{e.setAttribute(\\\"width\\\",c)}))}if(l.updateContainer(),\\\"column\\\"===i)for(let r=e;r<=t;r++){var s=a.scenegraph.getColGroup(r);null!=s&&s.setAttribute(\\\"chartInstance\\\",void 0);for(let e=0;e<=a.frozenRowCount-1;e++)l.updateCellContent(r,e);for(let t=l.bodyRowStart;t<=l.bodyRowEnd;t++)l.updateCellContent(r,t);for(let i=a.rowCount-a.bottomFrozenRowCount;i<=a.rowCount-1;i++)l.updateCellContent(r,i)}else{for(let t=0;t<=a.frozenColCount-1;t++){var h=a.scenegraph.getColGroup(t);null!=h&&h.setAttribute(\\\"chartInstance\\\",void 0);for(let e=o;e<=n;e++)l.updateCellContent(t,e)}for(let i=l.bodyColStart;i<=l.bodyColEnd;i++){var d=a.scenegraph.getColGroup(i);null!=d&&d.setAttribute(\\\"chartInstance\\\",void 0);for(let e=o;e<=n;e++)l.updateCellContent(i,e)}for(let r=a.colCount-a.rightFrozenColCount;r<=a.colCount-1;r++){var u=a.scenegraph.getColGroup(r);null!=u&&u.setAttribute(\\\"chartInstance\\\",void 0);for(let e=o;e<=n;e++)l.updateCellContent(r,e)}}}function updateAllSelectComponent(i){i.customSelectedRangeComponents.forEach((e,t)=>{updateComponent(e,t,i)}),i.selectingRangeComponents.forEach((e,t)=>{updateComponent(e,t,i)}),i.selectedRangeComponents.forEach((e,t)=>{updateComponent(e,t,i)})}function updateComponent(e,t,i){var r=i.table,[o,n,a,l]=t.split(\\\"-\\\"),s=parseInt(o,10),h=parseInt(n,10),d=parseInt(a,10),u=parseInt(l,10);let c,g=s,p=h,f=d,m=u;switch(e.role){case\\\"rowHeader\\\":(c=r.getBodyVisibleRowRange())&&(p=Math.max(h,c.rowStart-1),m=Math.min(u,c.rowEnd+1));break;case\\\"columnHeader\\\":case\\\"bottomFrozen\\\":(c=r.getBodyVisibleCellRange())&&(g=Math.max(s,c.colStart-1),f=Math.min(d,c.colEnd+1));break;case\\\"cornerHeader\\\":case\\\"rightTopCorner\\\":case\\\"leftBottomCorner\\\":case\\\"rightBottomCorner\\\":break;case\\\"rightFrozen\\\":(c=r.getBodyVisibleCellRange())&&(p=Math.max(h,c.rowStart-1),m=Math.min(u,c.rowEnd+1));break;default:(c=r.getBodyVisibleCellRange())&&(p=Math.max(h,c.rowStart-1),m=Math.min(u,c.rowEnd+1),g=Math.max(s,c.colStart-1),f=Math.min(d,c.colEnd+1))}var o=r.getColsWidth(g,f),n=r.getRowsHeight(p,m),a=i.highPerformanceGetCell(g,p).globalAABBBounds,l=i.highPerformanceGetCell(f,m).globalAABBBounds;e.rect.setAttributes({x:a.x1-i.tableGroup.attribute.x,y:a.y1-i.tableGroup.attribute.y,width:o,height:n,visible:!0}),e.fillhandle&&null!=(a=e.fillhandle)&&a.setAttributes({x:l.x2-i.tableGroup.attribute.x-3,y:l.y2-i.tableGroup.attribute.y-3,width:6,height:6,visible:!0});let b=!!r.frozenColCount&&s===r.frozenColCount,C=(!b&&r.frozenColCount&&0<r.scrollLeft&&s>=r.frozenColCount&&r.getColsWidth(0,s-1)-r.scrollLeft<r.getFrozenColsWidth()&&(b=!0),!!r.rightFrozenColCount&&0<r.rightFrozenColCount&&d===r.colCount-r.rightFrozenColCount-1),v=(!C&&r.rightFrozenColCount&&d<r.colCount-r.rightFrozenColCount&&r.getColsWidth(0,d)-r.scrollLeft>r.tableNoFrameWidth-r.getRightFrozenColsWidth()&&(C=!0),!r.frozenRowCount||h===r.frozenRowCount),y=(!v&&r.frozenRowCount&&0<r.scrollTop&&h>=r.frozenRowCount&&r.getRowsHeight(0,h-1)-r.scrollTop<r.getFrozenRowsHeight()&&(v=!0),!!r.bottomFrozenRowCount&&u===r.rowCount-r.bottomFrozenRowCount-1),w=(!y&&r.bottomFrozenRowCount&&u<r.rowCount-r.bottomFrozenRowCount&&r.getRowsHeight(0,u)-r.scrollTop>r.tableNoFrameHeight-r.getBottomFrozenRowsHeight()&&(y=!0),b&&e.rect.attribute.stroke[3]||C&&e.rect.attribute.stroke[1]||v&&e.rect.attribute.stroke[0]||y&&e.rect.attribute.stroke[2]?(b&&e.rect.attribute.stroke[3]&&i.tableGroup.insertAfter(e.rect,\\\"columnHeader\\\"===e.role?i.cornerHeaderGroup:\\\"bottomFrozen\\\"===e.role?i.leftBottomCornerGroup:i.rowHeaderGroup),y&&e.rect.attribute.stroke[2]&&i.tableGroup.insertAfter(e.rect,\\\"rowHeader\\\"===e.role?i.leftBottomCornerGroup:\\\"rightFrozen\\\"===e.role?i.rightBottomCornerGroup:i.bottomFrozenGroup),v&&e.rect.attribute.stroke[0]&&i.tableGroup.insertAfter(e.rect,\\\"rowHeader\\\"===e.role?i.cornerHeaderGroup:\\\"rightFrozen\\\"===e.role?i.rightTopCornerGroup:i.colHeaderGroup),C&&e.rect.attribute.stroke[1]&&i.tableGroup.insertAfter(e.rect,\\\"columnHeader\\\"===e.role?i.rightTopCornerGroup:\\\"bottomFrozen\\\"===e.role?i.rightBottomCornerGroup:i.rightFrozenGroup),e.rect.attribute.x<r.getFrozenColsWidth()&&0<r.scrollLeft&&(\\\"body\\\"===e.role||\\\"columnHeader\\\"===e.role||\\\"bottomFrozen\\\"===e.role)&&(l=e.rect.attribute.width-(r.getFrozenColsWidth()-e.rect.attribute.x),e.rect.setAttributes({x:e.rect.attribute.x+(r.getFrozenColsWidth()-e.rect.attribute.x),width:0<l?l:0}),null!=(a=e.fillhandle))&&a.setAttributes({visible:0<l}),0<r.getRightFrozenColsWidth()&&0<i.rightFrozenGroup.attribute.height&&e.rect.attribute.x+e.rect.attribute.width>i.rightFrozenGroup.attribute.x&&(\\\"body\\\"===e.role||\\\"columnHeader\\\"===e.role||\\\"bottomFrozen\\\"===e.role)&&(l=i.rightFrozenGroup.attribute.x-e.rect.attribute.x,e.rect.setAttributes({x:e.rect.attribute.x,width:0<l?l:0}),null!=(a=e.fillhandle))&&a.setAttributes({visible:0<l-o}),e.rect.attribute.y<i.colHeaderGroup.attribute.height&&0<r.scrollTop&&(\\\"body\\\"===e.role||\\\"rowHeader\\\"===e.role||\\\"rightFrozen\\\"===e.role)&&(l=e.rect.attribute.height-(i.colHeaderGroup.attribute.height-e.rect.attribute.y),e.rect.setAttributes({y:e.rect.attribute.y+(i.colHeaderGroup.attribute.height-e.rect.attribute.y),height:0<l?l:0}),null!=(o=e.fillhandle))&&o.setAttributes({visible:0<l}),0<i.bottomFrozenGroup.attribute.width&&0<i.bottomFrozenGroup.attribute.height&&e.rect.attribute.y+e.rect.attribute.height>i.bottomFrozenGroup.attribute.y&&(\\\"body\\\"===e.role||\\\"rowHeader\\\"===e.role||\\\"rightFrozen\\\"===e.role)&&(a=i.bottomFrozenGroup.attribute.y-e.rect.attribute.y,e.rect.setAttributes({y:e.rect.attribute.y,height:0<a?a:0}),null!=(l=e.fillhandle))&&l.setAttributes({visible:0<a-n})):i.tableGroup.insertAfter(e.rect,\\\"body\\\"===e.role?i.bodyGroup:\\\"columnHeader\\\"===e.role?i.colHeaderGroup:\\\"rowHeader\\\"===e.role?i.rowHeaderGroup:\\\"cornerHeader\\\"===e.role?i.cornerHeaderGroup:\\\"rightTopCorner\\\"===e.role?i.rightTopCornerGroup:\\\"rightFrozen\\\"===e.role?i.rightFrozenGroup:\\\"leftBottomCorner\\\"===e.role?i.leftBottomCornerGroup:\\\"bottomFrozen\\\"===e.role?i.bottomFrozenGroup:i.rightBottomCornerGroup),0);\\\"number\\\"==typeof e.rect.attribute.lineWidth&&(w=Math.ceil(e.rect.attribute.lineWidth/2)),d===r.colCount-1&&(Array.isArray(e.rect.attribute.lineWidth)&&(w=Math.ceil((null!=(o=e.rect.attribute.lineWidth[1])?o:0)/2)),e.rect.setAttributes({width:e.rect.attribute.width-w})),0===s&&(Array.isArray(e.rect.attribute.lineWidth)&&(w=Math.ceil((null!=(a=e.rect.attribute.lineWidth[3])?a:0)/2)),e.rect.setAttributes({x:e.rect.attribute.x+w,width:e.rect.attribute.width-w})),u===r.rowCount-1&&(Array.isArray(e.rect.attribute.lineWidth)&&(w=Math.ceil((null!=(n=e.rect.attribute.lineWidth[2])?n:0)/2)),e.rect.setAttributes({height:e.rect.attribute.height-w})),0===h&&(Array.isArray(e.rect.attribute.lineWidth)&&(w=Math.ceil((null!=(l=e.rect.attribute.lineWidth[0])?l:0)/2)),e.rect.setAttributes({y:e.rect.attribute.y+w,height:e.rect.attribute.height-w}))}function updateCellSelectBorder(e,t,i=!0){const l=e.table,r=t.start.col,o=t.start.row,n=t.end.col,a=t.end.row,s=t.skipBodyMerge;let h=Math.max(Math.min(n,r),0),d=Math.max(Math.min(a,o),0),u=Math.min(Math.max(n,r),l.colCount-1),c=Math.min(Math.max(a,o),l.rowCount-1);const g=()=>{let i=!1;for(let a=h;a<=u;a++){if(a===h)for(let e=d;e<=c;e++)if(l.isHeader(a,e)||!s){var t=getCellMergeInfo(l,a,e);if(t&&t.start.col<h){h=t.start.col,i=!0;break}}if(!i&&a===u)for(let e=d;e<=c;e++)if(l.isHeader(a,e)||!s){var r=getCellMergeInfo(l,a,e);if(r&&Math.min(r.end.col,l.colCount-1)>u){u=r.end.col,i=!0;break}}if(i)break}if(!i)for(let t=d;t<=c;t++){if(t===d)for(let e=h;e<=u;e++)if(l.isHeader(e,t)||!s){var o=getCellMergeInfo(l,e,t);if(o&&o.start.row<d){d=o.start.row,i=!0;break}}if(!i&&t===c)for(let e=h;e<=u;e++)if(l.isHeader(e,t)||!s){var n=getCellMergeInfo(l,e,t);if(n&&Math.min(n.end.row,l.rowCount-1)>c){c=n.end.row,i=!0;break}}if(i)break}i&&g()};i&&(g(),t.start.col>t.end.col?(t.start.col=Math.max(h,u),t.end.col=Math.min(h,u)):(t.start.col=Math.min(h,u),t.end.col=Math.max(h,u)),t.start.row>t.end.row?(t.start.row=Math.max(d,c),t.end.row=Math.min(d,c)):(t.start.row=Math.min(d,c),t.end.row=Math.max(d,c))),e.selectingRangeComponents.forEach((e,t)=>{var i;e.rect[\\\"delete\\\"](),null!=(i=e.fillhandle)&&i[\\\"delete\\\"]()}),e.selectingRangeComponents=new Map;let p=!1,f=!1,m=!1,b=!1,C=!1,v=!1,y=!1,w=!1,_=!1;var S,x,R,T,A;h<=l.frozenColCount-1&&d<=l.frozenRowCount-1&&(v=!0),u>=l.colCount-l.rightFrozenColCount&&d<=l.frozenRowCount-1&&(y=!0),h<=l.frozenColCount-1&&c>=l.rowCount-l.bottomFrozenRowCount&&(_=!0),u>=l.colCount-l.rightFrozenColCount&&c>=l.rowCount-l.bottomFrozenRowCount&&(w=!0),h<=l.frozenColCount-1&&c>=l.frozenRowCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&(p=!0),u>=l.colCount-l.rightFrozenColCount&&c>=l.frozenRowCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&(f=!0),d<=l.frozenRowCount-1&&u>=l.frozenColCount&&h<=l.colCount-l.rightFrozenColCount-1&&(m=!0),c>=l.rowCount-l.bottomFrozenRowCount&&u>=l.frozenColCount&&h<=l.colCount-l.rightFrozenColCount-1&&(b=!0),h<=l.colCount-l.rightFrozenColCount-1&&u>=l.frozenColCount&&d<=l.rowCount-l.bottomFrozenRowCount-1&&c>=l.frozenRowCount&&(C=!0),v&&(R=Math.min(u,l.frozenColCount-1),x=Math.min(c,l.frozenRowCount-1),S=[!0,!m,!p,!0],e.createCellSelectBorder(h,d,R,x,\\\"cornerHeader\\\",\\\"\\\"+h+d+u+c,S)),y&&(R=Math.max(h,l.colCount-l.rightFrozenColCount),x=Math.min(c,l.frozenRowCount-1),S=[!0,!0,!f,!m],e.createCellSelectBorder(R,d,u,x,\\\"rightTopCorner\\\",\\\"\\\"+h+d+u+c,S)),_&&(R=Math.min(u,l.frozenColCount-1),x=Math.max(d,l.rowCount-l.bottomFrozenRowCount),S=[!p,!b,!0,!0],e.createCellSelectBorder(h,x,R,c,\\\"leftBottomCorner\\\",\\\"\\\"+h+d+u+c,S)),w&&(x=Math.max(h,l.colCount-l.rightFrozenColCount),R=Math.max(d,l.rowCount-l.bottomFrozenRowCount),S=[!f,!0,!0,!b],e.createCellSelectBorder(x,R,u,c,\\\"rightBottomCorner\\\",\\\"\\\"+h+d+u+c,S)),m&&(x=Math.max(h,l.frozenColCount),R=Math.min(u,l.colCount-l.rightFrozenColCount-1),S=Math.min(c,l.frozenRowCount-1),T=[!0,!y,!C,!v],e.createCellSelectBorder(x,d,R,S,\\\"columnHeader\\\",\\\"\\\"+h+d+u+c,T)),b&&(x=Math.max(h,l.frozenColCount),R=Math.min(u,l.colCount-l.rightFrozenColCount-1),S=Math.max(d,l.rowCount-l.bottomFrozenRowCount),T=[!C,!w,!0,!_],e.createCellSelectBorder(x,S,R,c,\\\"bottomFrozen\\\",\\\"\\\"+h+d+u+c,T)),p&&(x=Math.max(d,l.frozenRowCount),S=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),R=Math.min(u,l.frozenColCount-1),T=[!v,!C,!_,!0],e.createCellSelectBorder(h,x,R,S,\\\"rowHeader\\\",\\\"\\\"+h+d+u+c,T)),f&&(x=Math.max(d,l.frozenRowCount),R=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),S=Math.max(h,l.colCount-l.rightFrozenColCount),T=[!y,!0,!w,!C],e.createCellSelectBorder(S,x,u,R,\\\"rightFrozen\\\",\\\"\\\"+h+d+u+c,T)),C&&(S=Math.max(h,l.frozenColCount),x=Math.max(d,l.frozenRowCount),R=Math.min(u,l.colCount-l.rightFrozenColCount-1),T=Math.min(c,l.rowCount-l.bottomFrozenRowCount-1),A=[!m,!f,!b,!p],e.createCellSelectBorder(S,x,R,T,\\\"body\\\",\\\"\\\"+h+d+u+c,A))}function hideCellSelectBorder(e){e.selectingRangeComponents.forEach((e,t)=>{e.rect.setAttribute(\\\"opacity\\\",0)}),e.selectedRangeComponents.forEach((e,t)=>{e.rect.setAttribute(\\\"opacity\\\",0)})}function restoreCellSelectBorder(e){e.selectingRangeComponents.forEach((e,t)=>{e.rect.setAttribute(\\\"opacity\\\",1)}),e.selectedRangeComponents.forEach((e,t)=>{e.rect.setAttribute(\\\"opacity\\\",1)})}function createCellSelectBorder(e,t,i,r,o,n,a,l){let s,h,d,u,c,g,p,f,m,b=!(null==(s=e.table.options.excelOptions)||!s.fillHandle);var C,v;1<(null==(h=e.table.stateManager.select.ranges)?void 0:h.length)?(b=!1,e.removeFillHandleFromSelectComponents()):1===(null==(d=e.table.stateManager.select.ranges)?void 0:d.length)&&(C=Math.max(e.table.stateManager.select.ranges[0].start.row,e.table.stateManager.select.ranges[0].end.row),v=Math.max(e.table.stateManager.select.ranges[0].start.col,e.table.stateManager.select.ranges[0].end.col),e.table.isHeader(v,C))&&(b=!1),!Array.isArray(l)||!1!==l[1]&&!1!==l[2]||(b=!1);const y=Math.min(t,r),w=Math.min(i,o),_=Math.max(t,r),S=Math.max(i,o),x=e.highPerformanceGetCell(y,w).globalAABBBounds,R=e.highPerformanceGetCell(_,S).globalAABBBounds,T=e.table.theme,A=null==(u=T.selectionStyle)?void 0:u.cellBorderColor,P=null==(c=T.selectionStyle)?void 0:c.cellBorderLineWidth,B=createRect({pickable:!1,fill:\\\"replace\\\"!==(null==(g=T.selectionStyle)?void 0:g.selectionFillMode)&&(null!=(f=null==(p=T.selectionStyle)?void 0:p.cellBgColor)?f:\\\"rgba(0, 0, 255,0.1)\\\"),lineWidth:P,stroke:l.map(e=>!!e&&A),x:x.x1-e.tableGroup.attribute.x,y:x.y1-e.tableGroup.attribute.y,width:0,height:0,visible:!0,cornerRadius:getCornerRadius(n,null==(m=e.table.theme.frameStyle)?void 0:m.cornerRadius,t,i,r,o,e.table)});let M;b&&(M=createRect({pickable:!1,fill:A,stroke:A,x:R.x2-3,y:R.y2-3,width:6,height:6,visible:!0})),e.lastSelectId=a,e.selectingRangeComponents.set(y+`-${w}-${_}-${S}-`+a,{rect:B,fillhandle:M,role:n}),e.tableGroup.insertAfter(B,\\\"body\\\"===n?e.bodyGroup:\\\"columnHeader\\\"===n?e.colHeaderGroup:\\\"rowHeader\\\"===n?e.rowHeaderGroup:\\\"cornerHeader\\\"===n?e.cornerHeaderGroup:\\\"rightTopCorner\\\"===n?e.rightTopCornerGroup:\\\"rightFrozen\\\"===n?e.rightFrozenGroup:\\\"leftBottomCorner\\\"===n?e.leftBottomCornerGroup:\\\"bottomFrozen\\\"===n?e.bottomFrozenGroup:e.rightBottomCornerGroup),b&&e.tableGroup.insertAfter(M,\\\"body\\\"===n?e.bodyGroup:\\\"columnHeader\\\"===n?e.colHeaderGroup:\\\"rowHeader\\\"===n?e.rowHeaderGroup:\\\"cornerHeader\\\"===n?e.cornerHeaderGroup:\\\"rightTopCorner\\\"===n?e.rightTopCornerGroup:\\\"rightFrozen\\\"===n?e.rightFrozenGroup:\\\"leftBottomCorner\\\"===n?e.leftBottomCornerGroup:\\\"bottomFrozen\\\"===n?e.bottomFrozenGroup:e.rightBottomCornerGroup)}function getCornerRadius(e,t,i,r,o,n,a){if(t){var l=Array.isArray(t)?t:[t,t,t,t],s=a.colCount-1,h=a.rowCount-1,d=[0,0,0,0];let e=!1;return 0===i&&0===r?(d[0]=l[0],e=!0):o===s&&n===h?(d[2]=l[2],e=!0):0===i&&n===h?(d[3]=l[3],e=!0):o===s&&0===r&&(d[1]=l[1],e=!0),e?d:void 0}}function moveSelectingRangeComponentsToSelectedRangeComponents(r){r.selectingRangeComponents.forEach((e,t)=>{var i;r.selectedRangeComponents.get(t)&&(r.selectingRangeComponents.get(t).rect[\\\"delete\\\"](),null!=(i=r.selectingRangeComponents.get(t).fillhandle))&&i[\\\"delete\\\"](),r.selectedRangeComponents.set(t,e)}),r.selectingRangeComponents=new Map,r.updateNextFrame()}function deleteLastSelectedRangeComponents(r){r.selectedRangeComponents.forEach((e,t)=>{var i;t.split(\\\"-\\\")[4]===r.lastSelectId&&(e.rect[\\\"delete\\\"](),null!=(i=e.fillhandle)&&i[\\\"delete\\\"](),r.selectedRangeComponents[\\\"delete\\\"](t))})}function deleteAllSelectBorder(e){e.selectedRangeComponents.forEach((e,t)=>{var i;e.rect[\\\"delete\\\"](),null!=(i=e.fillhandle)&&i[\\\"delete\\\"]()}),e.selectedRangeComponents=new Map}function deleteAllSelectingBorder(e){e.selectingRangeComponents.forEach((e,t)=>{var i;e.rect[\\\"delete\\\"](),null!=(i=e.fillhandle)&&i[\\\"delete\\\"]()}),e.selectingRangeComponents=new Map}function removeFillHandleFromSelectComponents(e){e.selectedRangeComponents.forEach((e,t)=>{var i;null!=(i=e.fillhandle)&&i[\\\"delete\\\"](),e.fillhandle=void 0})}function updateRow(e,t,i,o,r){var n;const a=o.scenegraph,l=deduplication(e.map(e=>e.row)).sort((e,t)=>t-e),s=deduplication(t.map(e=>e.row)).sort((e,t)=>e-t),h=deduplication(i.map(e=>e.row)).sort((e,t)=>e-t);let d;h.length&&(d=_getUpdateRowIndexUseCellNode(h[0]-1,h[h.length-1]+1,a)),s.length&&(p=_getUpdateRowIndexUseCellNode(s[0]-1,s[s.length-1]+1,a),d=isValid_default(d)?isValid_default(p)?Math.min(d,p):d:p),l.length&&(p=_getUpdateRowIndexUseCellNode(l[0]-1,l[l.length-1]+1,a),d=isValid_default(d)?isValid_default(p)?Math.min(d,p):d:p),l.forEach(e=>{removeRow(e,a,r)});const u=o.rowHeightsMap;l.forEach(e=>{u[\\\"delete\\\"](e)}),l.length&&(resetRowNumber(a),p=_getUpdateRowIndex(l[l.length-1]-1,l[0]-l.length+1,a),d=isValid_default(d)?isValid_default(p)?Math.min(d,p):d:p);let c;a.table._clearRowRangeHeightsMap(),s.forEach(e=>{var t=addRow(e,a,r);c=null!=c?c:t,u.insert(e)}),resetRowNumberAndY(a),s.length&&(p=_getUpdateRowIndex(s[0]-1,s[s.length-1]+1,a),d=isValid_default(d)?isValid_default(p)?Math.min(d,p):d:p);for(let m=0;m<o.colCount;m++)h.forEach(e=>{if(e<o.frozenRowCount){var i=getCellMergeInfo(a.table,m,e);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.row;e<=i.end.row;e++)updateCell(t,e,a.table,!1);else updateCell(m,e,a.table,!1)}else if(e>o.rowCount-1||e<a.table.rowCount-a.table.bottomFrozenRowCount&&(e<a.proxy.rowStart||e>a.proxy.rowEnd))removeCellGroup(e,a);else{var r=getCellMergeInfo(a.table,m,e);if(r)for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)updateCell(t,e,a.table,!1);else updateCell(m,e,a.table,!1)}});if(h.length&&(p=_getUpdateRowIndex(h[0]-1,h[h.length-1]+1,a),d=isValid_default(d)?isValid_default(p)?Math.min(d,p):d:p),isNumber_default(c)){for(let t=0;t<Math.max(o.colCount,null!=(n=o.internalProps._oldColCount)?n:o.colCount);t++)for(let e=c;e<Math.max(o.rowCount,null!=(g=o.internalProps._oldRowCount)?g:o.rowCount);e++){var g=a.highPerformanceGetCell(t,e,!0);g&&(g.needUpdate=!0)}d=isValid_default(d)?isValid_default(c)?Math.min(d,c):d:c}isNumber_default(d)&&(a.proxy.rowUpdatePos=Math.min(a.proxy.rowUpdatePos,d)),s.length?(isNumber_default(c)||(p=Math.min(...s),a.proxy.rowUpdatePos=Math.min(p,a.proxy.rowUpdatePos)),a.proxy.rowUpdateDirection=\\\"up\\\",a.proxy.updateCellGroups(2*a.proxy.screenRowCount),f()):l.length&&(setRowSeriesNumberCellNeedUpdate(l[l.length-1],a),a.proxy.updateCellGroups(2*a.proxy.screenRowCount),f()),a.proxy.progress();var p=o.getRowsHeight(o.frozenRowCount,o.rowCount-1-o.bottomFrozenRowCount);function f(){if((null==s?void 0:s[(null==s?void 0:s.length)-1])>=o.rowCount-o.bottomFrozenRowCount||(null==h?void 0:h[(null==h?void 0:h.length)-1])>=o.rowCount-o.bottomFrozenRowCount||(null==l?void 0:l[0])>=o.rowCount-o.bottomFrozenRowCount){for(let t=0;t<o.colCount;t++)for(let e=o.rowCount-o.bottomFrozenRowCount;e<o.rowCount;e++){var i=a.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}a.proxy.updateBottomFrozenCellGroups()}}a.updateContainerHeight(a.table.frozenRowCount,p-a.bodyGroup.attribute.height)}function removeRow(e,t,i){var r,o=t.proxy;e>=o.rowStart&&e<=o.rowEnd&&(removeCellGroup(e,t),o.rowEnd--,o.currentRow--),i||(o.bodyBottomRow--,r=Math.min(o.rowLimit,o.bodyBottomRow-o.bodyTopRow+1),o.totalActualBodyRowCount=r,o.totalRow=Math.min(o.table.rowCount-1,o.rowStart+r-1))}function addRow(e,t,i){var r,o=t.proxy;if(i||(o.bodyBottomRow++,r=Math.min(o.rowLimit,o.bodyBottomRow-o.bodyTopRow+1),o.totalActualBodyRowCount=r,o.totalRow=o.rowStart+r-1),!(e<o.rowStart))return e>o.rowEnd?o.rowEnd-o.rowStart+1<o.rowLimit?(o.rowEnd++,o.currentRow++,addRowCellGroup(e,t),e):void 0:(o.rowEnd-o.rowStart+1<o.rowLimit&&(o.rowEnd++,o.currentRow++,addRowCellGroup(e,t)),e)}function resetRowNumber(r){function i(e,t){e.row=t;var i=getCellMergeInfo(r.table,e.col,e.row);i?(e.mergeStartCol=i.start.col,e.mergeEndCol=i.end.col,e.mergeStartRow=i.start.row,e.mergeEndRow=i.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}r.bodyGroup.forEachChildren(e=>{let t=r.bodyRowStart;null!=e&&e.forEachChildren(e=>{i(e,t),t++})}),r.rowHeaderGroup.forEachChildren(e=>{let t=r.bodyRowStart;null!=e&&e.forEachChildren(e=>{i(e,t),t++})}),r.rightFrozenGroup.forEachChildren(e=>{let t=r.bodyRowStart;null!=e&&e.forEachChildren(e=>{i(e,t),t++})}),r.bottomFrozenGroup.forEachChildren(e=>{let t=r.table.rowCount-r.table.bottomFrozenRowCount;null!=e&&e.forEachChildren(e=>{i(e,t),t++})}),r.leftBottomCornerGroup.forEachChildren(e=>{let t=r.table.rowCount-r.table.bottomFrozenRowCount;null!=e&&e.forEachChildren(e=>{i(e,t),t++})}),r.rightBottomCornerGroup.forEachChildren(e=>{let t=r.table.rowCount-r.table.bottomFrozenRowCount;null!=e&&e.forEachChildren(e=>{i(e,t),t++})})}function resetRowNumberAndY(o){function r(e,t,i){e.row=t,e.setAttribute(\\\"y\\\",i);var r=getCellMergeInfo(o.table,e.col,e.row);r?(e.mergeStartCol=r.start.col,e.mergeEndCol=r.end.col,e.mergeStartRow=r.start.row,e.mergeEndRow=r.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}o.bodyGroup.forEachChildren(e=>{let t=o.bodyRowStart,i=o.getCellGroupY(t);null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})}),o.rowHeaderGroup.forEachChildren(e=>{let t=o.bodyRowStart,i=o.getCellGroupY(t);null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})}),o.rightFrozenGroup.forEachChildren(e=>{let t=o.bodyRowStart,i=o.getCellGroupY(t);null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})}),o.bottomFrozenGroup.forEachChildren(e=>{let t=o.table.rowCount-o.table.bottomFrozenRowCount,i=0;null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})}),o.leftBottomCornerGroup.forEachChildren(e=>{let t=o.table.rowCount-o.table.bottomFrozenRowCount,i=0;null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})}),o.rightBottomCornerGroup.forEachChildren(e=>{let t=o.table.rowCount-o.table.bottomFrozenRowCount,i=0;null!=e&&e.forEachChildren(e=>{r(e,t,i),t++,i+=e.attribute.height})})}function addRowCellGroup(e,t){for(let n=0;n<t.table.colCount;n++){var i,r,o=new Group2({x:0,y:0,width:t.table.getColWidth(n),height:t.table.getRowHeight(e)});o.role=\\\"cell\\\",o.col=n,o.row=e,o.needUpdate=!0,o&&((i=t.getColGroup(n))&&(i.firstChild&&e<i.firstChild.row?(i.insertBefore(o,i.firstChild),i.firstChild.row=i.firstChild.row+1):i.lastChild&&e>i.lastChild.row?i.appendChild(o):(r=t.highPerformanceGetCell(n,e,!0))!==o&&(i.insertBefore(o,r),r&&(r.row=r.row+1),r!==i.lastChild)&&i.lastChild&&(i.lastChild.row=i.lastChild.row+1)))}}function removeCellGroup(i,e){for(let t=0;t<e.table.colCount;t++){var r=e.getColGroup(t,!1);if(r){let t;r.forEachChildren(e=>e.row===i&&(t=e,!0)),t&&(r.updateColumnHeight(-t.attribute.height),r.removeChild(t))}}}function _getUpdateRowIndex(t,i,r){let o;for(let a=0;a<r.table.colCount;a++){var n=r.table.getCellRange(a,t);let e;n.start.row<=t+1&&n.end.row>=t+1&&(addNeedUpdateTag(n,r),e=n.start.row);n=r.table.getCellRange(a,i);n.start.row<=i+1&&n.end.row>=i+1&&(addNeedUpdateTag(n,r),e=n.start.row),isValid_default(e)&&(o=isValid_default(o)?Math.min(o,e):e)}return o}function _getUpdateRowIndexUseCellNode(t,i,r){let o;for(let a=0;a<r.table.colCount;a++){let e;var n=r.highPerformanceGetCell(a,t),n=(n.mergeStartRow&&n.mergeEndRow&&n.mergeEndRow>t&&(addNeedUpdateTag({start:{row:n.mergeStartRow,col:r.table.isAutoRowHeight(i)?0:n.mergeStartCol},end:{row:n.mergeEndRow,col:r.table.isAutoRowHeight(i)?r.table.colCount-1:n.mergeEndCol}},r),e=n.mergeStartRow),r.highPerformanceGetCell(a,i));n.mergeStartRow&&n.mergeEndRow&&n.mergeStartRow<i&&(addNeedUpdateTag({start:{row:n.mergeStartRow,col:r.table.isAutoRowHeight(i)?0:n.mergeStartCol},end:{row:n.mergeEndRow,col:r.table.isAutoRowHeight(i)?r.table.colCount-1:n.mergeEndCol}},r),e=n.mergeStartRow),isValid_default(e)&&(o=isValid_default(o)?Math.min(o,e):e)}return o}function addNeedUpdateTag(e,t){var{start:i,end:r}=e;for(let n=i.col;n<=r.col;n++)for(let e=i.row;e<=r.row;e++){var o=t.highPerformanceGetCell(n,e,!0);o&&(o.needUpdate=!0)}}function setRowSeriesNumberCellNeedUpdate(t,i){if(i.table.isHasSeriesNumber())for(let e=t;e<=i.table.rowCount-1;e++)updateCell(0,e,i.table,!1)}function createReactContainer(e){var t=e.internalProps;t.bodyDomContainer=document.createElement(\\\"div\\\"),t.bodyDomContainer.id=\\\"vtable-body-dom-container\\\",t.bodyDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.bodyDomContainer),t.headerDomContainer=document.createElement(\\\"div\\\"),t.headerDomContainer.id=\\\"vtable-header-dom-container\\\",t.headerDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.headerDomContainer),t.frozenBodyDomContainer=document.createElement(\\\"div\\\"),t.frozenBodyDomContainer.id=\\\"vtable-frozen-body-dom-container\\\",t.frozenBodyDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.frozenBodyDomContainer),t.frozenHeaderDomContainer=document.createElement(\\\"div\\\"),t.frozenHeaderDomContainer.id=\\\"vtable-frozen-header-dom-container\\\",t.frozenHeaderDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.frozenHeaderDomContainer),t.rightFrozenBodyDomContainer=document.createElement(\\\"div\\\"),t.rightFrozenBodyDomContainer.id=\\\"vtable-right-frozen-body-dom-container\\\",t.rightFrozenBodyDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.rightFrozenBodyDomContainer),t.rightFrozenHeaderDomContainer=document.createElement(\\\"div\\\"),t.rightFrozenHeaderDomContainer.id=\\\"vtable-right-frozen-header-dom-container\\\",t.rightFrozenHeaderDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.rightFrozenHeaderDomContainer),t.frozenBottomDomContainer=document.createElement(\\\"div\\\"),t.frozenBottomDomContainer.id=\\\"vtable-frozen-bottom-dom-container\\\",t.frozenBottomDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.frozenBottomDomContainer),t.bottomDomContainer=document.createElement(\\\"div\\\"),t.bottomDomContainer.id=\\\"vtable-bottom-dom-container\\\",t.bottomDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.bottomDomContainer),t.rightFrozenBottomDomContainer=document.createElement(\\\"div\\\"),t.rightFrozenBottomDomContainer.id=\\\"vtable-right-frozen-bottom-dom-container\\\",t.rightFrozenBottomDomContainer.classList.add(\\\"table-component-container\\\"),t.element.appendChild(t.rightFrozenBottomDomContainer)}function updateReactContainer(e){var t,i,r,o,n,a,l,s,h,{headerDomContainer:d,bodyDomContainer:u,frozenBodyDomContainer:c,frozenHeaderDomContainer:g,rightFrozenBodyDomContainer:p,rightFrozenHeaderDomContainer:f,bottomDomContainer:m,frozenBottomDomContainer:b,rightFrozenBottomDomContainer:C}=e.internalProps;(d||u||c||g||p||f||m||b||C)&&(o=e.getAllColsWidth(),t=Math.min(o,e.tableNoFrameWidth),h=(i=e.getFrozenColsWidth())+(r=e.getRightFrozenColsWidth()),o=Math.min(o-h,t-h),h=e.getAllRowsHeight(),n=Math.min(h,e.tableNoFrameHeight),s=(a=e.getFrozenRowsHeight())+(l=e.getBottomFrozenRowsHeight()),h=Math.min(h-s,n-s),0<e.frozenColCount?(d.style.left=e.tableX+i+\\\"px\\\",u.style.left=e.tableX+i+\\\"px\\\",m.style.left=e.tableX+i+\\\"px\\\"):0===e.frozenColCount&&(d.style.left=e.tableX+\\\"px\\\",u.style.left=e.tableX+\\\"px\\\",m.style.left=e.tableX+\\\"px\\\"),c.style.left=e.tableX+\\\"px\\\",g.style.left=e.tableX+\\\"px\\\",d.style.width=o+\\\"px\\\",d.style.height=a+\\\"px\\\",u.style.top=e.tableY+\\\"px\\\",u.style.width=o+\\\"px\\\",u.style.height=h+\\\"px\\\",u.style.top=e.tableY+a+\\\"px\\\",c.style.width=i+\\\"px\\\",c.style.height=h+\\\"px\\\",c.style.top=e.tableY+a+\\\"px\\\",g.style.width=i+\\\"px\\\",g.style.height=a+\\\"px\\\",g.style.top=e.tableY+\\\"px\\\",p.style.width=r+\\\"px\\\",p.style.height=h+\\\"px\\\",p.style.top=e.tableY+a+\\\"px\\\",p.style.left=e.tableX+t-r+\\\"px\\\",f.style.width=r+\\\"px\\\",f.style.height=a+\\\"px\\\",f.style.top=e.tableY+\\\"px\\\",f.style.left=e.tableX+t-r+\\\"px\\\",m.style.width=o+\\\"px\\\",m.style.height=l+\\\"px\\\",m.style.top=e.tableY+n-l+\\\"px\\\",b.style.width=i+\\\"px\\\",b.style.height=l+\\\"px\\\",b.style.top=e.tableY+n-l+\\\"px\\\",C.style.width=r+\\\"px\\\",C.style.height=l+\\\"px\\\",C.style.top=e.tableY+n-l+\\\"px\\\",C.style.left=e.tableX+t-r+\\\"px\\\")}function updateReactComponentContainer(t){if(t.table.reactCustomLayout){var{table:i,stage:r}=t,o=r.pluginService.findPluginsByName(\\\"ReactAttributePlugin\\\")[0],{htmlMap:e,renderId:n}=o;for(const c in e){var a=e[c],{graphic:l,wrapContainer:s,renderId:h}=a;if(h===n){let e;if(t.frozenColCount>i.frozenColCount){h=getTargetCell(l);if(!h)continue;var{col:h,row:d}=h;d>=i.rowCount-i.bottomFrozenRowCount&&h<t.frozenColCount&&h>=i.frozenColCount&&l.attribute.react.container===i.frozenBottomDomContainer?e=i.bottomDomContainer:d>=i.frozenRowCount&&h<t.frozenColCount&&h>=i.frozenColCount&&l.attribute.react.container===i.frozenBodyDomContainer?e=i.bodyDomContainer:d<i.frozenRowCount&&h<t.frozenColCount&&h>=i.frozenColCount&&l.attribute.react.container===i.frozenHeaderDomContainer&&(e=i.headerDomContainer)}else if(t.frozenColCount<i.frozenColCount){d=getTargetCell(l);if(!d)continue;var{col:h,row:u}=d;u>=i.rowCount-i.bottomFrozenRowCount&&h<i.frozenColCount&&h>=t.frozenColCount&&l.attribute.react.container===i.bottomDomContainer?e=i.frozenBottomDomContainer:u>=i.frozenRowCount&&h<i.frozenColCount&&h>=t.frozenColCount&&l.attribute.react.container===i.bodyDomContainer?e=i.frozenBodyDomContainer:u<i.frozenRowCount&&h<i.frozenColCount&&h>=t.frozenColCount&&l.attribute.react.container===i.headerDomContainer&&(e=i.frozenHeaderDomContainer)}e&&(e.appendChild(s),a.nativeContainer=e,a.container=e,l.attribute.react.container=e,o.updateStyleOfWrapContainer(l,r,s,e,l.attribute.react))}}}}function dealFrozen(t){var e;if(t.table.frozenColCount>t.table.rowHeaderLevelCount){t.rowHeaderGroup.setAttribute(\\\"height\\\",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute(\\\"y\\\",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute(\\\"height\\\",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.table.rowHeaderLevelCount;e++)moveColumnFromBodyToRowHeader(t),moveColumnFromColHeaderToCornerHeader(t),moveColumnFromBottomToLeftBottomCorner(t)}else if(t.table.frozenColCount<t.table.rowHeaderLevelCount){t.bodyGroup.setAttribute(\\\"height\\\",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute(\\\"y\\\",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute(\\\"height\\\",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.table.rowHeaderLevelCount-t.table.frozenColCount;e++)moveColumnFromRowHeaderToBody(t),moveColumnFromCornerHeaderToColHeader(t),moveColumnFromLeftBottomCornerToBottom(t)}t.bodyGroup.setAttribute(\\\"x\\\",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute(\\\"x\\\",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount&&t.component.setFrozenColumnShadow(t.table.frozenColCount-1):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0,t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(e=null!=(e=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?e:null==(e=t.cornerHeaderGroup.firstChild)?void 0:e.childrenCount)?e:t.table.frozenRowCount}function resetFrozen(t){var e;if(t.frozenColCount>t.table.frozenColCount){t.bodyGroup.setAttribute(\\\"height\\\",t.rowHeaderGroup.attribute.height),t.bodyGroup.setAttribute(\\\"y\\\",t.rowHeaderGroup.attribute.y),t.colHeaderGroup.setAttribute(\\\"height\\\",t.cornerHeaderGroup.attribute.height);for(let e=0;e<t.frozenColCount-t.table.frozenColCount;e++)moveColumnFromRowHeaderToBody(t),moveColumnFromCornerHeaderToColHeader(t),moveColumnFromLeftBottomCornerToBottom(t)}else if(t.frozenColCount<t.table.frozenColCount){t.rowHeaderGroup.setAttribute(\\\"height\\\",t.bodyGroup.attribute.height),t.rowHeaderGroup.setAttribute(\\\"y\\\",t.bodyGroup.attribute.y),t.cornerHeaderGroup.setAttribute(\\\"height\\\",t.colHeaderGroup.attribute.height);for(let e=0;e<t.table.frozenColCount-t.frozenColCount;e++)moveColumnFromBodyToRowHeader(t),moveColumnFromColHeaderToCornerHeader(t),moveColumnFromBottomToLeftBottomCorner(t)}updateReactComponentContainer(t),t.recreateAllSelectRangeComponents(),t.frozenColCount=t.table.frozenColCount,t.frozenRowCount=null!=(e=null!=(e=null==(e=t.colHeaderGroup.firstChild)?void 0:e.childrenCount)?e:null==(e=t.cornerHeaderGroup.firstChild)?void 0:e.childrenCount)?e:t.table.frozenRowCount,t.proxy.colStart=null!=(e=null==(e=t.bodyGroup.firstChild)?void 0:e.col)?e:t.table.frozenColCount,t.bodyGroup.setAttribute(\\\"x\\\",t.rowHeaderGroup.attribute.width),t.colHeaderGroup.setAttribute(\\\"x\\\",t.cornerHeaderGroup.attribute.width),t.updateContainer(),t.updateBorderSizeAndPosition(),t.isPivot||t.table.transpose?t.table.options.frozenColCount?t.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):(t.component.setFrozenColumnShadow(t.table.frozenColCount-1),t.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)),t.hasFrozen=!0}function moveColumnFromBodyToRowHeader(e){var t=e.bodyGroup.firstChild instanceof Group2?e.bodyGroup.firstChild:null;t&&(e.rowHeaderGroup.appendChild(t),e.rowHeaderGroup.setAttribute(\\\"width\\\",e.rowHeaderGroup.attribute.width+t.attribute.width),e.bodyGroup.setAttribute(\\\"width\\\",e.bodyGroup.attribute.width-t.attribute.width))}function moveColumnFromColHeaderToCornerHeader(e){var t=e.colHeaderGroup.firstChild instanceof Group2?e.colHeaderGroup.firstChild:null;t&&(e.cornerHeaderGroup.appendChild(t),e.cornerHeaderGroup.setAttribute(\\\"width\\\",e.cornerHeaderGroup.attribute.width+t.attribute.width),e.colHeaderGroup.setAttribute(\\\"width\\\",e.colHeaderGroup.attribute.width-t.attribute.width))}function moveColumnFromRowHeaderToBody(e){var t=e.rowHeaderGroup.lastChild instanceof Group2?e.rowHeaderGroup.lastChild:null==(t=e.rowHeaderGroup.lastChild)?void 0:t._prev;t&&(insertBefore(e.bodyGroup,t,e.bodyGroup.firstChild),e.bodyGroup.setAttribute(\\\"width\\\",e.bodyGroup.attribute.width+t.attribute.width),e.rowHeaderGroup.setAttribute(\\\"width\\\",e.rowHeaderGroup.attribute.width-t.attribute.width))}function moveColumnFromCornerHeaderToColHeader(e){var t=e.cornerHeaderGroup.lastChild instanceof Group2?e.cornerHeaderGroup.lastChild:null==(t=e.cornerHeaderGroup.lastChild)?void 0:t._prev;t&&(insertBefore(e.colHeaderGroup,t,e.colHeaderGroup.firstChild),e.colHeaderGroup.setAttribute(\\\"width\\\",e.colHeaderGroup.attribute.width+t.attribute.width),e.cornerHeaderGroup.setAttribute(\\\"width\\\",e.cornerHeaderGroup.attribute.width-t.attribute.width))}function moveColumnFromBottomToLeftBottomCorner(e){var t=e.bottomFrozenGroup.firstChild instanceof Group2?e.bottomFrozenGroup.firstChild:null;t&&(e.leftBottomCornerGroup.appendChild(t),e.leftBottomCornerGroup.setAttribute(\\\"width\\\",e.leftBottomCornerGroup.attribute.width+t.attribute.width),e.bottomFrozenGroup.setAttribute(\\\"width\\\",e.bottomFrozenGroup.attribute.width-t.attribute.width),e.table.isPivotChart())&&t.forEachChildren(e=>{e.setAttributes({stroke:!1,fill:!1})})}function moveColumnFromLeftBottomCornerToBottom(r){var e=r.leftBottomCornerGroup.lastChild instanceof Group2?r.leftBottomCornerGroup.lastChild:null==(e=r.leftBottomCornerGroup.lastChild)?void 0:e._prev;e&&(insertBefore(r.bottomFrozenGroup,e,r.bottomFrozenGroup.firstChild),r.bottomFrozenGroup.setAttribute(\\\"width\\\",r.bottomFrozenGroup.attribute.width+e.attribute.width),r.leftBottomCornerGroup.setAttribute(\\\"width\\\",r.leftBottomCornerGroup.attribute.width-e.attribute.width),r.table.isPivotChart())&&e.forEachChildren(e=>{var t=r.table._getCellStyle(e.col,e.row),i=r.table.getCellRange(e.col,e.row),t=getStyleTheme(t,r.table,(i?i.start:e).col,(i?i.start:e).row,getProp2).theme;e.setAttributes({fill:null!=(i=null==(i=null==t?void 0:t.group)?void 0:i.fill)?i:void 0,stroke:null!=(t=null==(i=null==t?void 0:t.group)?void 0:i.stroke)?t:void 0})})}function dealRightFrozen(i,r){var{table:o,rightTopCornerGroup:n,rightFrozenGroup:a,rightBottomCornerGroup:l,bottomFrozenGroup:s,bodyGroup:h,colHeaderGroup:d}=r,u=r.table.rightFrozenColCount;if(u<i){for(let e=o.colCount-u-1;e>=o.colCount-i;e--)insertBefore(a,r.getColGroup(e),a.firstChild),insertBefore(n,r.getColGroup(e,!0),n.firstChild),insertBefore(l,r.getColGroupInBottom(e),l.firstChild);let t=0;a.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width}),t=0,n.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width}),t=0,l.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width})}else if(i<u){for(let e=o.colCount-u;e<o.colCount-i;e++){var c=r.getColGroup(e),c=(c.setAttribute(\\\"x\\\",h.lastChild.attribute.x+o.getColWidth(h.lastChild.col)),h.appendChild(c),r.getColGroupInRightTopCorner(e)),c=(c.setAttribute(\\\"x\\\",d.lastChild.attribute.x+o.getColWidth(d.lastChild.col)),d.appendChild(c),r.getColGroupInRightBottomCorner(e));c.setAttribute(\\\"x\\\",s.lastChild.attribute.x+o.getColWidth(s.lastChild.col)),s.appendChild(c)}let t=0;a.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width}),t=0,n.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width}),t=0,l.forEachChildren(e=>{e.setAttribute(\\\"x\\\",t),t+=e.attribute.width})}a.setAttribute(\\\"width\\\",o.getColsWidth(o.colCount-i,o.colCount-1)),n.setAttribute(\\\"width\\\",o.getColsWidth(o.colCount-i,o.colCount-1)),l.setAttribute(\\\"width\\\",o.getColsWidth(o.colCount-i,o.colCount-1)),o.internalProps.rightFrozenColCount=i,r.updateContainer(),r.component.updateScrollBar(),r.updateNextFrame()}function dealBottomFrozen(o,n){let{table:a,proxy:e,bottomFrozenGroup:t,leftBottomCornerGroup:i,rightBottomCornerGroup:r}=n;t.childrenCount||(e.table.isPivotChart()||(createColGroup(i,0,0,0,a.frozenColCount-1,0,-1,\\\"rowHeader\\\",a),createColGroup(r,0,0,a.colCount-a.rightFrozenColCount,a.colCount-1,0,-1,\\\"body\\\",a)),createColGroup(t,0,0,e.colStart,e.colEnd,0,-1,\\\"body\\\",a));var l=n.table.bottomFrozenRowCount;if(l<o){for(let i=0;i<a.frozenColCount;i++){var s=n.getColGroupInLeftBottomCorner(i);for(let e=a.rowCount-l-1;e>=a.rowCount-o;e--)insertBefore(s,n.getCell(i,e,!0),s.firstChild);let t=0;s.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}for(let r=e.colStart;r<=e.colEnd;r++){var h=n.getColGroupInBottom(r);for(let e=a.rowCount-l-1;e>=a.rowCount-o;e--)insertBefore(h,n.getCell(r,e,!0),h.firstChild);let t=0;h.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}if(0<a.rightFrozenColCount)for(let i=a.colCount-a.rightFrozenColCount;i<a.colCount;i++){var d=n.getColGroupInRightBottomCorner(i);for(let e=a.rowCount-l-1;e>=a.rowCount-o;e--)insertBefore(d,n.getCell(i,e,!0),d.firstChild);let t=0;d.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}}else if(o<l){for(let i=0;i<a.rowHeaderLevelCount;i++){var u=n.getColGroup(i);for(let e=a.rowCount-l;e<a.rowCount-o;e++){var c=n.getCell(i,e,!0);c.setAttribute(\\\"y\\\",u.lastChild.attribute.y+a.getRowHeight(u.lastChild.row)),u.appendChild(c)}var g=n.getColGroupInLeftBottomCorner(i);let t=0;g.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}for(let r=e.colStart;r<=e.colEnd;r++){var p=n.getColGroup(r);for(let e=a.rowCount-l;e<a.rowCount-o;e++){var f=n.getCell(r,e,!0);f.setAttribute(\\\"y\\\",p.lastChild.attribute.y+a.getRowHeight(p.lastChild.row)),p.appendChild(f)}var m=n.getColGroupInBottom(r);let t=0;m.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}if(0<a.rightFrozenColCount)for(let i=a.colCount-a.rightFrozenColCount;i<a.colCount;i++){var b=n.getColGroup(i);for(let e=a.rowCount-l;e<a.rowCount-o;e++){var C=n.getCell(i,e,!0);C.setAttribute(\\\"y\\\",b.lastChild.attribute.y+a.getRowHeight(b.lastChild.row)),b.appendChild(C)}var v=n.getColGroupInRightBottomCorner(i);let t=0;v.forEachChildren(e=>{e.setAttribute(\\\"y\\\",t),t+=a.getRowHeight(e.row)})}}t.setAttribute(\\\"height\\\",a.getRowsHeight(a.rowCount-o,a.rowCount-1)),i.setAttribute(\\\"height\\\",a.getRowsHeight(a.rowCount-o,a.rowCount-1)),r.setAttribute(\\\"height\\\",a.getRowsHeight(a.rowCount-o,a.rowCount-1)),a.internalProps.bottomFrozenRowCount=o,n.updateContainer(),n.component.updateScrollBar(),n.updateNextFrame()}function insertBefore(e,t,i){t&&e&&(i?e.insertBefore(t,i):e.appendChild(t))}function resetRowFrozen(t){var e;if(t.frozenRowCount>t.table.frozenRowCount){t.bodyGroup.setAttribute(\\\"width\\\",t.colHeaderGroup.attribute.width),t.bodyGroup.setAttribute(\\\"x\\\",t.colHeaderGroup.attribute.x),t.rowHeaderGroup.setAttribute(\\\"width\\\",t.cornerHeaderGroup.attribute.width);for(let e=0;e<t.frozenRowCount-t.table.frozenRowCount;e++)moveRowFromColHeaderToBody(t),moveRowFromCornerHeaderToRowHeader(t),moveRowFromTopRightCornerToRight(t)}else if(t.frozenRowCount<t.table.frozenRowCount){t.colHeaderGroup.setAttribute(\\\"width\\\",t.bodyGroup.attribute.width),t.colHeaderGroup.setAttribute(\\\"x\\\",t.bodyGroup.attribute.x),t.cornerHeaderGroup.setAttribute(\\\"width\\\",t.rowHeaderGroup.attribute.width);for(let e=0;e<t.table.frozenRowCount-t.frozenRowCount;e++)moveRowFromBodyToColHeader(t),moveRowFromRowHeaderToCornerHeader(t),moveRowFromRightToTopRightCorner(t)}updateReactComponentContainer(t),t.recreateAllSelectRangeComponents(),t.frozenRowCount=t.table.frozenRowCount,t.frozenColCount=null!=(e=null==(e=t.rowHeaderGroup)?void 0:e.childrenCount)?e:0,t.proxy.rowStart=null!=(e=null==(e=null==(e=t.bodyGroup.firstChild)?void 0:e.firstChild)?void 0:e.row)?e:t.table.frozenRowCount,t.bodyGroup.setAttribute(\\\"y\\\",t.colHeaderGroup.attribute.height),t.rowHeaderGroup.setAttribute(\\\"y\\\",t.cornerHeaderGroup.attribute.height),t.updateContainer(),t.updateBorderSizeAndPosition(),t.hasFrozen=!0}function moveRowFromBodyToColHeader(e){let t,i=!1;for(let o=0;o<e.bodyGroup.childrenCount;o++){var r=e.bodyGroup.children[o].firstChild;null!=(t=e.colHeaderGroup.children[o])&&t.appendChild(r),i||(e.colHeaderGroup.setAttribute(\\\"height\\\",e.colHeaderGroup.attribute.height+r.attribute.height),e.bodyGroup.setAttribute(\\\"height\\\",e.bodyGroup.attribute.height-r.attribute.height),i=!0)}}function moveRowFromRowHeaderToCornerHeader(e){let t,i=!1;for(let o=0;o<e.rowHeaderGroup.childrenCount;o++){var r=e.rowHeaderGroup.children[o].firstChild;null!=(t=e.cornerHeaderGroup.children[o])&&t.appendChild(r),i||(e.cornerHeaderGroup.setAttribute(\\\"height\\\",e.cornerHeaderGroup.attribute.height+r.attribute.height),e.rowHeaderGroup.setAttribute(\\\"height\\\",e.rowHeaderGroup.attribute.height-r.attribute.height),i=!0)}}function moveRowFromRightToTopRightCorner(e){let t,i=!1;for(let o=0;o<e.rightFrozenGroup.childrenCount;o++){var r=e.rightFrozenGroup.children[o].firstChild;null!=(t=e.rightTopCornerGroup.children[o])&&t.appendChild(r),i||(e.rightTopCornerGroup.setAttribute(\\\"height\\\",e.rightTopCornerGroup.attribute.height+r.attribute.height),e.rightFrozenGroup.setAttribute(\\\"height\\\",e.rightFrozenGroup.attribute.height-r.attribute.height),i=!0)}}function moveRowFromColHeaderToBody(e){let t=!1;for(let r=0;r<e.colHeaderGroup.childrenCount;r++){var i=e.colHeaderGroup.children[r].lastChild;insertBefore(e.bodyGroup.children[r],i,e.bodyGroup.children[r].firstChild),t||(e.colHeaderGroup.setAttribute(\\\"height\\\",e.colHeaderGroup.attribute.height-i.attribute.height),e.bodyGroup.setAttribute(\\\"height\\\",e.bodyGroup.attribute.height+i.attribute.height),t=!0)}}function moveRowFromCornerHeaderToRowHeader(e){let t=!1;for(let r=0;r<e.cornerHeaderGroup.childrenCount;r++){var i=e.cornerHeaderGroup.children[r].lastChild;insertBefore(e.rowHeaderGroup.children[r],i,e.rowHeaderGroup.children[r].firstChild),t||(e.cornerHeaderGroup.setAttribute(\\\"height\\\",e.cornerHeaderGroup.attribute.height-i.attribute.height),e.rowHeaderGroup.setAttribute(\\\"height\\\",e.rowHeaderGroup.attribute.height+i.attribute.height),t=!0)}}function moveRowFromTopRightCornerToRight(e){let t=!1;for(let r=0;r<e.rightTopCornerGroup.childrenCount;r++){var i=e.rightTopCornerGroup.children[r].lastChild;insertBefore(e.rightFrozenGroup.children[r],i,e.rightFrozenGroup.children[r].firstChild),t||(e.rightTopCornerGroup.setAttribute(\\\"height\\\",e.rightTopCornerGroup.attribute.height-i.attribute.height),e.rightFrozenGroup.setAttribute(\\\"height\\\",e.rightFrozenGroup.attribute.height+i.attribute.height),t=!0)}}function updateChartSizeForResizeColWidth(a,l){let s=a.table,h=s.internalProps.layoutMap,d=-1===l?\\\"all\\\":s.internalProps.columnResizeType;if(\\\"column\\\"===d){var u=a.getColGroup(l),c=a.getColGroup(l,!0),g=a.getColGroupInBottom(l,!0);null!=u&&u.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=c&&c.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=g&&g.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),\\\"adaptive\\\"===s.widthMode&&l<s.colCount-1&&(u=a.getColGroup(l+1),c=a.getColGroup(l+1,!0),g=a.getColGroupInBottom(l+1,!0),null!=u&&u.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=c&&c.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=g)&&g.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))})}else{let e,t,i,r=s.rowHeaderLevelCount,o=s.colCount-1;\\\"indicator\\\"===d?h.indicatorsAsCol?e=h.getIndicatorKey(l,s.columnHeaderLevelCount):(c=(u=h.getCellHeaderPaths(l,s.columnHeaderLevelCount-1)).colHeaderPaths[u.colHeaderPaths.length-1],t=c.dimensionKey,i=c.value):\\\"indicatorGroup\\\"===d&&(u=(g=s.internalProps.layoutMap).getCellHeaderPaths(s.stateManager.columnResize.col,s.columnHeaderLevelCount),c=g.getHeadNodeByRowOrColDimensions(u.colHeaderPaths.slice(0,u.colHeaderPaths.length-1)),r=c.startInTotal+s.frozenColCount,o=c.startInTotal+s.frozenColCount+c.size-1);for(let n=r;n<=o;n++){var p=a.getColGroup(n),f=a.getColGroup(n,!0),m=a.getColGroupInBottom(n,!0);if(p){if(\\\"indicator\\\"===d){var b=h.getIndicatorKey(n,s.columnHeaderLevelCount);if(h.indicatorsAsCol&&b!==e)continue;if(!h.indicatorsAsCol){b=h.getCellHeaderPaths(n,s.columnHeaderLevelCount-1),b=null==b?void 0:b.colHeaderPaths[b.colHeaderPaths.length-1];if(!b||t!==b.dimensionKey||i!==b.value)continue}}p.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=f&&f.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))}),null!=m&&m.forEachChildren(e=>{updateChartGraphicSize(e,s.getColWidth(e.col),s.getRowHeight(e.row))})}}}}function updateChartSizeForResizeRowHeight(n,a){let e,l=n.table,s=l.internalProps.layoutMap,h=l.stateManager,d=-1===a?\\\"all\\\":l.internalProps.rowResizeType,u,c,g,p=l.columnHeaderLevelCount,f=l.rowCount-1;\\\"indicator\\\"===d?s.indicatorsAsCol?(i=null==(e=(i=s.getCellHeaderPaths(l.rowHeaderLevelCount-1,a)).rowHeaderPaths)?void 0:e[i.rowHeaderPaths.length-1],c=null==i?void 0:i.dimensionKey,g=null==i?void 0:i.value):u=s.getIndicatorKey(l.rowHeaderLevelCount,a):\\\"indicatorGroup\\\"===d&&(t=(i=l.internalProps.layoutMap).getCellHeaderPaths(l.rowHeaderLevelCount,a),t=i.getHeadNodeByRowOrColDimensions(t.rowHeaderPaths.slice(0,t.rowHeaderPaths.length-1)),p=t.startInTotal+l.frozenRowCount,f=t.startInTotal+l.frozenRowCount+t.size-1);var t,i=[{startCol:n.proxy.colStart,endCol:n.proxy.colEnd}];l.frozenColCount&&i.push({startCol:0,endCol:l.frozenColCount-1}),l.rightFrozenColCount&&i.push({startCol:l.colCount-l.rightFrozenColCount,endCol:l.colCount-1}),i.forEach(({startCol:e,endCol:t})=>{for(let o=e;o<=t;o++)if(\\\"row\\\"===d){var i=n.highPerformanceGetCell(o,a);if(\\\"cell\\\"!==i.role)continue;updateChartGraphicSize(i,l.getColWidth(i.col),l.getRowHeight(i.row)),\\\"adaptive\\\"===l.heightMode&&a<l.rowCount-1&&updateChartGraphicSize(i=n.highPerformanceGetCell(o,a+1),l.getColWidth(i.col),l.getRowHeight(i.row))}else for(let e=p;e<=f;e++){if(\\\"indicator\\\"===d){var r=s.getIndicatorKey(h.table.rowHeaderLevelCount,e);if(!s.indicatorsAsCol&&r!==u)continue;if(s.indicatorsAsCol){r=s.getCellHeaderPaths(h.table.rowHeaderLevelCount-1,e),r=null==r?void 0:r.rowHeaderPaths[r.rowHeaderPaths.length-1];if(!r||c!==r.dimensionKey||g!==r.value)continue}}r=n.highPerformanceGetCell(o,e);\\\"cell\\\"===r.role&&updateChartGraphicSize(r,l.getColWidth(r.col),l.getRowHeight(r.row))}})}function clearChartCacheImage(e){for(let i=e.proxy.colStart;i<=e.proxy.colEnd;i++){var t=e.getColGroup(i);null!=(t=null==t?void 0:t.getChildren())&&t.forEach(e=>{e.children.forEach(e=>{\\\"chart\\\"===e.type&&(e.cacheCanvas=null,e.addUpdateBoundTag())})})}}function updateChartState(e,t){var i=e.table;if(i.isPivotChart()){var r=i._selectedDataItemsInChart.length;if(null!==t&&0!==(null==t?void 0:t.length)&&0!==Object.keys(t).length||0!==r){const n=[];if(Array.isArray(t))t.forEach(e=>{if(e&&0!==e.key&&0<Object.keys(e).length){var t={};for(const i in e)i.startsWith(\\\"VGRAMMAR_\\\")||i.startsWith(\\\"__VCHART\\\")||(t[i]=e[i]);n.push(t)}});else if(t&&0!==t.key&&0<Object.keys(t).length){var o={};for(const a in t)a.startsWith(\\\"VGRAMMAR_\\\")||a.startsWith(\\\"__VCHART\\\")||(o[a]=t[a]);n.push(o)}isEqual(i._selectedDataItemsInChart,n)||(i._selectedDataItemsInChart=n,i.internalProps.layoutMap.updateDataStateToChartInstance(),clearChartCacheImage(e),i.scenegraph.updateNextFrame())}}}function updateChartGraphicSize(e,t,i){e.forEachChildren(e=>{\\\"chart\\\"===e.type&&(e.cacheCanvas=null,e.setAttributes({width:Math.ceil(t-e.attribute.cellPadding[3]-e.attribute.cellPadding[1]),height:Math.ceil(i-e.attribute.cellPadding[0]-e.attribute.cellPadding[2])}))})}function initSceneGraph(e){var t=e.table.tableNoFrameWidth,i=e.table.tableNoFrameHeight,i=(e.tableGroup=new Group2({x:0,y:0,width:t,height:i,clip:!0,pickable:!1}),e.tableGroup.role=\\\"table\\\",createContainerGroup(0,0,!e.table.options.enableTreeStickCell)),r=(i.role=\\\"col-header\\\",e.colHeaderGroup=i,createContainerGroup(0,0,!e.table.options.enableTreeStickCell)),o=(r.role=\\\"corner-header\\\",e.cornerHeaderGroup=r,createContainerGroup(0,0,!0)),t=(o.role=\\\"row-header\\\",e.rowHeaderGroup=o,createContainerGroup(t,0,!0)),n=(t.role=\\\"body\\\",e.bodyGroup=t,createContainerGroup(0,0,!0)),a=(n.role=\\\"right-frozen\\\",e.rightFrozenGroup=n,createContainerGroup(0,0,!0)),l=(a.role=\\\"bottom-frozen\\\",e.bottomFrozenGroup=a,createContainerGroup(0,0)),s=(l.role=\\\"component\\\",e.componentGroup=l,createContainerGroup(0,0,!0)),h=(s.role=\\\"corner-right-top-header\\\",e.rightTopCornerGroup=s,createContainerGroup(0,0,!0)),d=(h.role=\\\"corner-right-bottom-header\\\",e.rightBottomCornerGroup=h,createContainerGroup(0,0,!0));d.role=\\\"corner-left-bottom-header\\\",e.leftBottomCornerGroup=d,e.tableGroup.addChild(t),e.tableGroup.addChild(o),e.tableGroup.addChild(a),e.tableGroup.addChild(i),e.tableGroup.addChild(n),e.tableGroup.addChild(h),e.tableGroup.addChild(s),e.tableGroup.addChild(d),e.tableGroup.addChild(r),e.tableGroup.addChild(l)}function createContainerGroup(e,t,i){return new Group2({x:0,y:0,width:e,height:t,clip:null!=i&&i,pickable:!1})}function updateContainerChildrenX(e,i){return e.forEachChildrenSkipChild((e,t)=>{e.setAttribute(\\\"x\\\",i),i+=e.attribute.width}),i}function hideHoverIcon(e,t,i){-1!==e&&-1!==t&&(updateCellRangeIcon(e,t,e=>\\\"mouseenter_cell\\\"===e.attribute.visibleTime,e=>{e.setAttribute(\\\"opacity\\\",0);var t=e.parent.getChildByName(\\\"icon-back\\\");t&&t.setAttribute(\\\"visible\\\",!1)},i),i.updateNextFrame())}function showHoverIcon(e,t,i){-1!==e&&-1!==t&&(updateCellRangeIcon(e,t,e=>\\\"mouseenter_cell\\\"===e.attribute.visibleTime,e=>{e.setAttribute(\\\"opacity\\\",1)},i),i.updateNextFrame())}function hideClickIcon(e,t,i){-1!==e&&-1!==t&&(updateCellRangeIcon(e,t,e=>\\\"click_cell\\\"===e.attribute.visibleTime,e=>{e.setAttribute(\\\"opacity\\\",0)},i),i.updateNextFrame())}function showClickIcon(e,t,i){-1!==e&&-1!==t&&(updateCellRangeIcon(e,t,e=>\\\"click_cell\\\"===e.attribute.visibleTime,e=>{e.setAttribute(\\\"opacity\\\",1)},i),i.updateNextFrame())}function getIconByXY(e,t,i,r,o){let n;return o.getCell(e,t).forEachChildren(e=>{e.role&&e.role.startsWith(\\\"icon\\\")&&e.containsPoint(i,r,IContainPointMode.GLOBAL)&&(n=e)}),n}function setIconHoverStyle(t,e,i,r,o){var n,a,l,s;(t.attribute.backgroundColor||t.attribute.hoverImage)&&updateCellRangeIcon(e,i,e=>e.name===t.name,t=>{var i;if(t.attribute.backgroundColor){let e=t.parent.getChildByName(\\\"icon-back\\\");e?e.setAttributes({x:(null!=(i=t.attribute.x)?i:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(i=t.attribute.y)?i:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(i=t.attribute.dx)?i:0,dy:null!=(i=t.attribute.dy)?i:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,visible:!0}):(e=createRect({x:(null!=(i=t.attribute.x)?i:0)+(t.AABBBounds.width()-t.backgroundWidth)/2,y:(null!=(i=t.attribute.y)?i:0)+(t.AABBBounds.height()-t.backgroundHeight)/2,dx:null!=(i=t.attribute.dx)?i:0,dy:null!=(i=t.attribute.dy)?i:0,width:t.backgroundWidth,height:t.backgroundHeight,fill:t.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0})).name=\\\"icon-back\\\",t.parent.insertBefore(e,t)}t.attribute.hoverImage&&t.attribute.image!==t.attribute.hoverImage&&(t.image=t.attribute.hoverImage)},o),t.tooltip&&(({x1:n,x2:a,y1:s,y2:l}=t.globalAABBBounds),s={content:t.tooltip.title,referencePosition:{rect:{left:n,right:a,top:s,bottom:l,width:t.globalAABBBounds.width(),height:t.globalAABBBounds.height()},placement:t.tooltip.placement},disappearDelay:t.tooltip.disappearDelay,style:Object.assign({},null==(n=o.table.internalProps.theme)?void 0:n.tooltipStyle,null==(a=t.tooltip)?void 0:a.style)},o.table.internalProps.tooltipHandler.isBinded(s)||o.table.showTooltip(e,i,s))}function setIconNormalStyle(t,e,i,r){(t.attribute.backgroundColor||t.attribute.hoverImage)&&updateCellRangeIcon(e,i,e=>e.name===t.name,e=>{var t=e.parent.getChildByName(\\\"icon-back\\\");t&&t.setAttribute(\\\"visible\\\",!1),e.attribute.hoverImage&&e.attribute.image!==e.attribute.originImage&&(e.image=e.attribute.originImage)},r)}function updateIcon(e,t,i,r,o){const n=e.name;updateCellRangeIcon(i,r,e=>e.name===n,e=>{dealWithIcon(t,e),e.name=t.name},o),o.updateNextFrame()}function resetSortIcon(e,t,r,o){var n=o.getCell(e,t);if(isValid_default(n.mergeStartCol)&&isValid_default(n.mergeStartRow)&&isValid_default(n.mergeEndCol)&&isValid_default(n.mergeEndRow))for(let i=n.mergeStartCol;i<=n.mergeEndCol;i++)for(let e=n.mergeStartRow;e<=n.mergeEndRow;e++){let t;o.getCell(i,e).forEachChildren(e=>\\\"sort\\\"===e.attribute.funcType&&(t=e,!0)),t&&(dealWithIcon(r,t),t.name=r.name)}else{let t;traverseObject(n,\\\"children\\\",e=>\\\"sort\\\"===e.attribute.funcType&&(t=e,!0)),t&&(dealWithIcon(r,t),t.name=r.name)}}function checkSameCell(e,t,i,r,o){var n=o.getCellRange(e,t),a=o.getCellRange(i,r);return n.start.col===a.start.col&&n.start.row===a.start.row&&n.end.col===a.end.col&&n.end.row===a.end.row}function updateSortIcon(e){var{col:t,row:i,iconMark:r,order:o,oldSortCol:n,oldSortRow:a,oldIconMark:l,scene:s}=e,o=s.table.internalProps.headerHelper.getSortIcon(o,s.table,t,i);r&&updateIcon(r,o,t,i,s),checkSameCell(t,i,n,a,s.table)||(r=s.table.internalProps.headerHelper.getSortIcon(\\\"normal\\\",s.table,n,a),l?updateIcon(l,r,n,a,s):resetSortIcon(n,a,r,s))}function updateFrozenIcon(r){for(let o=0;o<r.table.colCount;o++)for(let i=0;i<r.table.columnHeaderLevelCount;i++)updateCellRangeIcon(o,i,e=>\\\"frozen\\\"===e.attribute.funcType,e=>{var t=r.table.internalProps.headerHelper.getFrozenIcon(o,i);dealWithIcon(t,e),e.name=t.name},r)}function updateHierarchyIcon(e,t,i){let r;r=(i.table.isHeader(e,t)?i.table.internalProps.headerHelper:i.table.internalProps.bodyHelper).getHierarchyIcon(e,t),updateCellRangeIcon(e,t,e=>e.attribute.funcType===IconFuncTypeEnum.collapse||e.attribute.funcType===IconFuncTypeEnum.expand,e=>{dealWithIcon(r,e),e.name=r.name},i)}function updateCellGroupIcon(e,t,i){e&&\\\"empty\\\"!==e.role&&e.forEachChildren(e=>{\\\"group\\\"===e.type?updateCellGroupIcon(e,t,i):t(e)&&i(e)})}function updateCellRangeIcon(e,t,i,r,o){var n=o.getCell(e,t);if(\\\"cell\\\"===n.role&&isValid_default(n.mergeStartCol)&&isValid_default(n.mergeStartRow)&&isValid_default(n.mergeEndCol)&&isValid_default(n.mergeEndRow)){var{colStart:a,colEnd:l,rowStart:s,rowEnd:h}=getCellMergeRange(n,o);for(let t=a;t<=l;t++)for(let e=s;e<=h;e++)updateCellGroupIcon(o.highPerformanceGetCell(t,e),i,r)}else updateCellGroupIcon(n,i,r)}function residentHoverIcon(e,t,i){updateCellRangeIcon(e,t,e=>e.attribute.funcType===IconFuncTypeEnum.dropDown,e=>{e.oldVisibleTime=e.attribute.visibleTime,e.setAttribute(\\\"visibleTime\\\",\\\"always\\\"),e.setAttribute(\\\"opacity\\\",1)},i)}function resetResidentHoverIcon(e,t,i){updateCellRangeIcon(e,t,e=>e.attribute.funcType===IconFuncTypeEnum.dropDown,e=>{e.oldVisibleTime&&e.setAttribute(\\\"visibleTime\\\",e.oldVisibleTime),e.setAttribute(\\\"opacity\\\",\\\"always\\\"===e.attribute.visibleTime?1:0)},i)}function createCornerCell(e,t){var{bgColor:i,borderColor:r,borderLineWidth:o,borderLineDash:n}=t,i={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:i};return i.stroke=getStroke(r,void 0),i.lineWidth=o,n&&(i.lineDash=n),i.lineCap=\\\"butt\\\",Array.isArray(r)&&(i.strokeArrayColor=getQuadProps(r)),Array.isArray(o)&&(i.strokeArrayWidth=getQuadProps(o),i.lineWidth=1),e.setAttributes(i),e.role=\\\"corner-frozen\\\",e}function updateCol(e,t,i,o){var r;const n=o.scenegraph,a=deduplication2(e.map(e=>e.col)).sort((e,t)=>t-e),l=deduplication2(t.map(e=>e.col)).sort((e,t)=>e-t),s=deduplication2(i.map(e=>e.col)).sort((e,t)=>e-t),h=(a.forEach(e=>{removeCol(e,n)}),o.colWidthsMap);let d;if(a.forEach(e=>{h.delAndReorder(e)}),a.length&&resetColNumber(n),n.table._clearColRangeWidthsMap(),l.forEach(e=>{var t=addCol(e,n);resetColNumber(n),d=null!=d?d:t,h.addAndReorder(e)}),resetColNumberAndX(n),s.forEach(e=>{for(let r=0;r<o.rowCount;r++){var i=getCellMergeInfo(n.table,e,r);if(i)for(let t=i.start.col;t<=i.end.col;t++)for(let e=i.start.col;e<=i.end.col;e++)updateCell(e,r,n.table,!1);else updateCell(e,r,n.table,!1)}}),isNumber_default(d)){for(let t=d;t<Math.max(o.colCount,null!=(r=o.internalProps._oldColCount)?r:o.colCount);t++)for(let e=0;e<Math.max(o.rowCount,null!=(u=o.internalProps._oldRowCount)?u:o.rowCount);e++){var u=n.highPerformanceGetCell(t,e,!0);u&&(u.needUpdate=!0)}n.proxy.colUpdatePos=d}l.length?(isNumber_default(d)||(c=Math.min(...l),n.proxy.colUpdatePos=c),n.proxy.colUpdateDirection=\\\"left\\\",n.proxy.updateColGroups(2*n.proxy.screenColCount),g(),n.proxy.progress()):a.length&&(n.proxy.updateColGroups(2*n.proxy.screenColCount),g(),n.proxy.progress());var c=o.getColsWidth(o.frozenColCount,o.colCount-1);function g(){if((null==l?void 0:l[(null==l?void 0:l.length)-1])>=o.colCount-o.rightFrozenColCount||(null==s?void 0:s[(null==s?void 0:s.length)-1])>=o.colCount-o.rightFrozenColCount||(null==a?void 0:a[0])>=o.colCount-o.rightFrozenColCount){for(let t=o.colCount-o.rightFrozenColCount;t<o.colCount;t++)for(let e=0;e<o.rowCount;e++){var i=n.highPerformanceGetCell(t,e,!0);i&&(i.needUpdate=!0)}n.proxy.updateRightFrozenCellGroups()}}n.updateContainerWidth(n.table.frozenColCount,c-n.bodyGroup.attribute.width)}function removeCol(e,t){var i=t.proxy,r=(e>=t.table.rowHeaderLevelCount&&(e>=t.table.colCount-t.table.rightFrozenColCount||((r=t.getColGroup(e,!1))&&r.parent===t.bodyGroup&&t.bodyGroup.removeChild(r),(r=t.getColGroupInBottom(e))&&r.parent===t.bottomFrozenGroup&&t.bottomFrozenGroup.removeChild(r),(r=t.getColGroup(e,!0))&&r.parent===t.colHeaderGroup&&t.colHeaderGroup.removeChild(r))),e>=i.colStart&&e<=i.colEnd&&(i.colEnd--,i.currentCol--),i.bodyRightCol--,Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1));i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1}function addCol(e,t){var i=t.proxy,r=(i.bodyRightCol++,Math.min(i.colLimit,i.bodyRightCol-i.bodyLeftCol+1));if(i.totalActualBodyColCount=r,i.totalCol=i.colStart+r-1,!(e<i.colStart))return e>i.colEnd?i.colEnd-i.colStart+1<i.colLimit?(i.colEnd++,i.currentCol++,addColGroup(e,t),e):void 0:(i.colEnd-i.colStart+1<i.colLimit&&(i.colEnd++,i.currentCol++,addColGroup(e,t)),e)}function deduplication2(e){var t=[];for(let i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t}function resetColNumber(i){let r=i.bodyColStart;function t(e){e.col=r;var t=getCellMergeInfo(i.table,e.col,e.row);t&&(e.mergeStartCol=t.start.col,e.mergeStartCol=t.start.col,e.mergeEndCol=t.end.col,e.mergeEndCol=t.end.col),e.role}i.bodyGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{t(e)}),r++}),r=i.bodyColStart,i.colHeaderGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{t(e)}),r++}),r=i.bodyColStart,i.bottomFrozenGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{t(e)}),r++})}function resetColNumberAndX(i){let r=i.bodyColStart,t=i.getCellGroupX(r);function o(e){e.col=r;var t=getCellMergeInfo(i.table,e.col,e.row);t&&(e.mergeStartCol=t.start.col,e.mergeStartCol=t.start.col,e.mergeEndCol=t.end.col,e.mergeEndCol=t.end.col),e.role}i.bodyGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++}),r=i.bodyColStart,t=i.getCellGroupX(r),i.colHeaderGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++}),r=i.bodyColStart,t=i.getCellGroupX(r),i.bottomFrozenGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++}),r=i.table.colCount-i.table.rightFrozenColCount,t=0,i.rightFrozenGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++}),r=i.table.colCount-i.table.rightFrozenColCount,t=0,i.rightTopCornerGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++}),r=i.table.colCount-i.table.rightFrozenColCount,t=0,i.rightBottomCornerGroup.forEachChildren(e=>{e.col=r,null!=e&&e.forEachChildren(e=>{o(e)}),e.setAttribute(\\\"x\\\",t),t+=e.attribute.width,r++})}function addColGroup(e,a){var t,i;function r(e,t,i,r){for(let n=i;n<=r;n++){var o=new Group2({x:0,y:0,width:a.table.getColWidth(t),height:a.table.getRowHeight(n)});o.role=\\\"cell\\\",o.col=t,o.row=n,o.needUpdate=!0,e.appendChild(o)}}a.colHeaderGroup&&0<a.table.columnHeaderLevelCount&&((t=new Group2({x:0,y:0,width:a.table.getColWidth(e),height:0,clip:!1,pickable:!1})).role=\\\"column\\\",(i=a.getColGroup(t.col=e,!0))?a.colHeaderGroup.insertBefore(t,i):a.colHeaderGroup.appendChild(t),r(t,e,0,a.table.columnHeaderLevelCount-1)),a.bodyGroup&&((i=new Group2({x:0,y:0,width:a.table.getColWidth(e),height:0,clip:!1,pickable:!1})).role=\\\"column\\\",(t=a.getColGroup(i.col=e,!1))?a.bodyGroup.insertBefore(i,t):a.bodyGroup.appendChild(i),r(i,e,a.bodyRowStart,a.bodyRowEnd)),a.bottomFrozenGroup&&0<a.table.bottomFrozenRowCount&&((t=new Group2({x:0,y:0,width:a.table.getColWidth(e),height:0,clip:!1,pickable:!1})).role=\\\"column\\\",(i=a.getColGroupInBottom(t.col=e))?a.bottomFrozenGroup.insertBefore(t,i):a.bottomFrozenGroup.appendChild(t),r(t,e,a.table.rowCount-a.table.bottomFrozenRowCount,a.table.rowCount-1))}function dealWithAnimationAppear(e){var t;if(e.options.animationAppear){let i,r,o,n;n=!0===e.options.animationAppear?(i=500,r=0,o=\\\"one-by-one\\\",\\\"column\\\"):(i=null!=(t=e.options.animationAppear.duration)?t:500,r=null!=(t=e.options.animationAppear.delay)?t:0,o=null!=(t=e.options.animationAppear.type)?t:\\\"one-by-one\\\",null!=(t=e.options.animationAppear.direction)?t:\\\"row\\\");var l=e.scenegraph,{colEnd:s,rowEnd:h}=l.proxy;for(let a=0;a<=s;a++)for(let t=0;t<=h;t++){var d=l.highPerformanceGetCell(a,t);d&&\\\"cell\\\"===d.role&&d.forEachChildren(e=>{e.setAttribute(\\\"opacity\\\",0),e.animate().wait(\\\"one-by-one\\\"===o?(\\\"row\\\"===n?t:a)*(i-r):r).to({opacity:1},i,\\\"linear\\\")})}}}function temporarilyUpdateSelectRectStyle(i,e){var t=e.selectedRangeComponents;t.forEach((e,t)=>{e.rect.setAttributes(i)}),e.updateNextFrame()}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),registerForVrender(),container.load(contributions_default),container.load(text_measure_default);var Scenegraph=class{constructor(e){let t,i;this._needUpdateContainer=!1,this.table=e,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,setPoptipTheme(this.table.theme.textPopTipStyle),i=\\\"node\\\"===Env.mode?(vglobal.setEnv(\\\"node\\\",e.options.modeParams),t=e.canvasWidth,e.canvasHeight):e.options.canvas&&e.options.viewBox?(vglobal.setEnv(\\\"browser\\\"),t=e.options.viewBox.x2-e.options.viewBox.x1,e.options.viewBox.y2-e.options.viewBox.y1):(vglobal.setEnv(\\\"browser\\\"),t=e.canvas.width,e.canvas.height),this.stage=createStage(Object.assign({canvas:e.canvas,width:t,height:i,disableDirtyBounds:!1,background:e.theme.underlayBackgroundColor,dpr:e.internalProps.pixelRatio,enableLayout:!0,beforeRender:e=>{this.table.options.beforeRender&&this.table.options.beforeRender(e),this.table.animationManager.ticker.start()},afterRender:e=>{this.table.options.afterRender&&this.table.options.afterRender(e),this.table.fireListeners(\\\"after_render\\\",null)},canvasControled:!e.options.canvas,viewBox:e.options.viewBox},e.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:\\\"round\\\"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var e;return null!=(e=null==(e=this.tableGroup.attribute)?void 0:e.width)?e:0}get height(){var e;return null!=(e=null==(e=this.tableGroup.attribute)?void 0:e.height)?e:0}get x(){var e;return null!=(e=null==(e=this.tableGroup.attribute)?void 0:e.x)?e:0}get y(){var e;return null!=(e=null==(e=this.tableGroup.attribute)?void 0:e.y)?e:0}get bodyRowStart(){var e;return null!=(e=this.proxy.rowStart)?e:0}get bodyRowEnd(){var e;return null!=(e=this.proxy.rowEnd)?e:this.table.rowCount-1}get bodyColStart(){var e;return null!=(e=this.proxy.colStart)?e:0}get bodyColEnd(){var e;return null!=(e=this.proxy.colEnd)?e:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),initSceneGraph(this)}clearCells(){var e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName(\\\"poptipForText\\\").forEach(e=>{e.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),null!=(e=this.proxy)&&e.release(),null!=(e=this.table.reactCustomLayout)&&e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new TableComponent(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(e=!1){e||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(e=>{\\\"poptipForText\\\"===e.name&&this.stage.pluginService.register(e)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new SceneProxy(this.table),createFrameBorder(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(createCornerCell(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),createCornerCell(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),createCornerCell(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(e,t,i){let r,o,n,a,l,s,h;var d;return(h=!(h=0<this.table.rightFrozenColCount&&e>=this.table.colCount-this.table.rightFrozenColCount&&t<this.table.frozenRowCount?null==(r=this.rightTopCornerGroup.getColGroup(e))?void 0:r.getRowGroup(t):0<this.table.bottomFrozenRowCount&&t>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<this.table.frozenColCount?null==(o=this.leftBottomCornerGroup.getColGroup(e))?void 0:o.getRowGroup(t):0<this.table.rightFrozenColCount&&0<this.table.bottomFrozenRowCount&&e>=this.table.colCount-this.table.rightFrozenColCount&&t>=this.table.rowCount-this.table.bottomFrozenRowCount?null==(n=this.rightBottomCornerGroup.getColGroup(e))?void 0:n.getRowGroup(t):0<this.table.rightFrozenColCount&&e>this.table.colCount-1-this.table.rightFrozenColCount?null==(a=this.rightFrozenGroup.getColGroup(e))?void 0:a.getRowGroup(t):0<this.table.bottomFrozenRowCount&&t>this.table.rowCount-1-this.table.bottomFrozenRowCount?null==(l=this.bottomFrozenGroup.getColGroup(e))?void 0:l.getRowGroup(t):null==(s=this.getColGroup(e,t<this.frozenRowCount))?void 0:s.getRowGroup(t))||\\\"shadow-cell\\\"!==h.role||i||(d=this.table.getCellRange(e,t)).start.col===e&&d.start.row===t?h:this.getCell(d.start.col,d.start.row))||emptyGroup}highPerformanceGetCell(e,t,i){return this.proxy.highPerformanceGetCell(e,t,i)}getColGroup(e,t=!1){return(e<this.frozenColCount&&t?this.cornerHeaderGroup:e<this.frozenColCount?this.rowHeaderGroup:t&&0<this.table.rightFrozenColCount&&e>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup:!t&&0<this.table.rightFrozenColCount&&e>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup:t?this.colHeaderGroup:this.bodyGroup).getColGroup(e)||void 0}getColGroupInBottom(e,t=!1){if(t){var i=null!=(i=this.getColGroupInLeftBottomCorner(e))?i:this.getColGroupInRightBottomCorner(e);if(i)return i}if(0<this.table.bottomFrozenRowCount)return this.bottomFrozenGroup.getColGroup(e)}getColGroupInLeftBottomCorner(e){if(0<this.table.bottomFrozenRowCount)return this.leftBottomCornerGroup.getColGroup(e)}getColGroupInRightTopCorner(e){if(0<this.table.rightFrozenColCount)return this.rightTopCornerGroup.getColGroup(e)}getColGroupInRightBottomCorner(e){if(0<this.table.rightFrozenColCount&&0<this.table.bottomFrozenRowCount)return this.rightBottomCornerGroup.getColGroup(e)}getCellSize(e,t){var i=this.getCell(e,t),r=getCellMergeInfo(this.table,e,t);let o=i.attribute.width,n=i.attribute.height;return r&&(o/=r.end.col-r.start.col+1,n/=r.end.row-r.start.row+1),{width:o,height:n}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var e;(0<(null==(e=null==(e=this.table.stateManager.select)?void 0:e.ranges)?void 0:e.length)||0<(null==(e=null==(e=this.table.stateManager.select)?void 0:e.customSelectRanges)?void 0:e.length))&&updateAllSelectComponent(this)}hideHoverIcon(e,t){hideHoverIcon(e,t,this)}showHoverIcon(e,t){showHoverIcon(e,t,this)}hideClickIcon(e,t){hideClickIcon(e,t,this)}showClickIcon(e,t){showClickIcon(e,t,this)}getIcon(e,t,i,r){return getIconByXY(e,t,i,r,this)}setIconHoverStyle(e,t,i,r){setIconHoverStyle(e,t,i,r,this)}updateSortIcon(e){var{col:t,row:i,iconMark:r,order:o,oldSortCol:n,oldSortRow:a,oldIconMark:l}=e;updateSortIcon({col:t,row:i,iconMark:r,order:o,oldSortCol:n,oldSortRow:a,oldIconMark:l,scene:this})}updateFrozenIcon(e,t){updateFrozenIcon(this)}updateHierarchyIcon(e,t){updateHierarchyIcon(e,t,this)}setIconNormalStyle(e,t,i){setIconNormalStyle(e,t,i,this)}residentHoverIcon(e,t){residentHoverIcon(e,t,this)}resetResidentHoverIcon(e,t){resetResidentHoverIcon(e,t,this)}deactivateChart(e,t){var i,r;-1!==e&&-1!==t&&null!=(i=null==(r=null==(r=this.getCell(e,t))?void 0:r.firstChild)?void 0:r.deactivate)&&i.call(r)}activateChart(e,t){var i,r,o;if(-1!==e&&-1!==t)return null!=(i=null==(r=null==(o=this.getCell(e,t))?void 0:o.firstChild)?void 0:r.activate)&&i.call(r,this.table),null==(r=null==o?void 0:o.firstChild)?void 0:r.activeChartInstance}removeInteractionBorder(e,t){var i=this.getCell(e,t);i.setAttribute(\\\"highlightStroke\\\",void 0),i.setAttribute(\\\"highlightStrokeArrayWidth\\\",void 0),i.setAttribute(\\\"highlightStrokeArrayColor\\\",void 0)}createCellSelectBorder(e,t,i,r,o,n,a){createCellSelectBorder(this,e,t,i,r,o,n,a)}moveSelectingRangeComponentsToSelectedRangeComponents(){moveSelectingRangeComponentsToSelectedRangeComponents(this)}deleteLastSelectedRangeComponents(){deleteLastSelectedRangeComponents(this)}deleteAllSelectBorder(){deleteAllSelectBorder(this),deleteAllSelectingBorder(this)}updateCellSelectBorder(e,t=!0){updateCellSelectBorder(this,e,t)}removeFillHandleFromSelectComponents(){removeFillHandleFromSelectComponents(this)}recreateAllSelectRangeComponents(){deleteAllSelectBorder(this),this.table.stateManager.select.ranges.forEach(e=>{updateCellSelectBorder(this,e),moveSelectingRangeComponentsToSelectedRangeComponents(this)})}updateColWidth(e,t,i,r){updateColWidth(this,e,Math.round(t),r),i||this.updateContainer(!0)}updateChartSizeForResizeColWidth(e){updateChartSizeForResizeColWidth(this,e)}updateChartSizeForResizeRowHeight(e){updateChartSizeForResizeRowHeight(this,e)}updateChartState(e){this.table.isPivotChart()&&updateChartState(this,e)}updateCheckboxCellState(e,i,r){var t;this.table.transpose?null!=(t=this.bodyGroup.children)&&t.forEach(e=>{var t;null!=(t=e.getChildAt(i))&&t.getChildren().forEach(e=>{\\\"checkbox\\\"===e.name&&(\\\"indeterminate\\\"===r?(e.setAttribute(\\\"indeterminate\\\",!0),e.setAttribute(\\\"checked\\\",void 0)):(e.setAttribute(\\\"indeterminate\\\",void 0),e.setAttribute(\\\"checked\\\",r)))})}):null!=(t=null==(t=this.getColGroup(e))?void 0:t.children)&&t.forEach(e=>{e.getChildren().find(e=>{\\\"checkbox\\\"===e.name&&(\\\"indeterminate\\\"===r?(e.setAttribute(\\\"indeterminate\\\",!0),e.setAttribute(\\\"checked\\\",void 0)):(e.setAttribute(\\\"indeterminate\\\",void 0),e.setAttribute(\\\"checked\\\",r)))})})}updateHeaderCheckboxCellState(e,t,i){var r;this.table.transpose?null!=(r=this.rowHeaderGroup.children)&&r.forEach(e=>{e.getChildAt(t).getChildren().forEach(e=>{\\\"checkbox\\\"===e.name&&(\\\"indeterminate\\\"===i?(e.setAttribute(\\\"indeterminate\\\",!0),e.setAttribute(\\\"checked\\\",void 0)):(e.setAttribute(\\\"indeterminate\\\",void 0),e.setAttribute(\\\"checked\\\",i)))})}):null!=(r=this.getColGroup(e,!0).children)&&r.forEach(e=>{e.getChildren().find(e=>{\\\"checkbox\\\"===e.name&&(\\\"indeterminate\\\"===i?(e.setAttribute(\\\"indeterminate\\\",!0),e.setAttribute(\\\"checked\\\",void 0)):(e.setAttribute(\\\"indeterminate\\\",void 0),e.setAttribute(\\\"checked\\\",i)))})})}updateAutoColWidth(e){this.table.internalProps._widthResizedColMap[\\\"delete\\\"](e);var t=this.table.getColWidth(e),i=computeColWidth(e,0,this.table.rowCount-1,this.table,!0);i!==t&&this.updateColWidth(e,i-t)}recalculateColWidths(){var e=this.table;\\\"adaptive\\\"===e.widthMode||e.autoFillWidth||e.internalProps.transpose?computeColsWidth(this.table,0,this.table.colCount-1,!0):(e._clearColRangeWidthsMap(),0<e.frozenColCount&&computeColsWidth(this.table,0,e.frozenColCount-1,!0),0<e.rightFrozenColCount&&computeColsWidth(this.table,e.rightFrozenColCount,e.colCount-1,!0),computeColsWidth(e,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){var e=this.table;e.internalProps.useOneRowHeightFillAll=!1,\\\"adaptive\\\"===e.heightMode||e.autoFillHeight?computeRowsHeight(this.table,0,this.table.rowCount-1,!0,!0):(0<e.frozenRowCount&&computeRowsHeight(this.table,0,e.frozenRowCount-1,!0,!0),0<e.bottomFrozenRowCount&&computeRowsHeight(this.table,e.bottomFrozenRowCount,e.rowCount-1,!0,!0),computeRowsHeight(e,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){this.proxy.resize(),\\\"adaptive\\\"!==this.table.widthMode&&!this.table.autoFillWidth||(0===this.table.internalProps._widthResizedColMap.size?this.recalculateColWidths():this.dealWidthMode()),\\\"adaptive\\\"===this.table.heightMode?0===this.table.internalProps._heightResizedRowMap.size?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),(\\\"adaptive\\\"===this.table.widthMode||\\\"adaptive\\\"===this.table.heightMode||this.table.autoFillWidth||this.table.autoFillHeight)&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var o;if(this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:Math.min(this.table.tableNoFrameWidth,Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0)),height:Math.min(this.table.tableNoFrameHeight,Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0))}),this.tableGroup.border){var n=null==(n=this.tableGroup.border)?void 0:n.attribute;let e,t,i,r;r=null!=n&&n.strokeArrayWidth?(e=n.strokeArrayWidth?n.strokeArrayWidth[0]:null!=(o=n.lineWidth)?o:0,t=n.strokeArrayWidth?n.strokeArrayWidth[1]:null!=(o=n.lineWidth)?o:0,i=n.strokeArrayWidth?n.strokeArrayWidth[2]:null!=(o=n.lineWidth)?o:0,n.strokeArrayWidth?n.strokeArrayWidth[3]:null!=(o=n.lineWidth)?o:0):(e=null!=(o=null==n?void 0:n.lineWidth)?o:0,t=null!=(o=null==n?void 0:n.lineWidth)?o:0,i=null!=(o=null==n?void 0:n.lineWidth)?o:0,null!=(o=null==n?void 0:n.lineWidth)?o:0),\\\"rect\\\"===this.tableGroup.border.type?null!=(n=this.table.theme.frameStyle)&&n.innerBorder?this.tableGroup.border.setAttributes({x:this.table.tableX+r/2,y:this.table.tableY+e/2,width:this.tableGroup.attribute.width-r/2-t/2,height:this.tableGroup.attribute.height-e/2-i/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-r/2,y:this.table.tableY-e/2,width:this.tableGroup.attribute.width+r/2+t/2,height:this.tableGroup.attribute.height+e/2+i/2}):\\\"group\\\"===this.tableGroup.border.type&&(null!=(o=this.table.theme.frameStyle)&&o.innerBorder?(this.tableGroup.border.setAttributes({x:this.table.tableX+r/2,y:this.table.tableY+e/2,width:this.tableGroup.attribute.width-r/2-t/2,height:this.tableGroup.attribute.height-e/2-i/2}),null!=(n=this.tableGroup.border.firstChild)&&n.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-r/2-t/2,height:this.tableGroup.attribute.height-e/2-i/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-r/2,y:this.table.tableY-e/2,width:this.tableGroup.attribute.width+r/2+t/2,height:this.tableGroup.attribute.height+e/2+i/2}),null!=(o=this.tableGroup.border.firstChild)&&o.setAttributes({x:r/2,y:e/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}0<this.table.bottomFrozenRowCount&&(this.bottomFrozenGroup.setAttribute(\\\"y\\\",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),0<this.table.rightFrozenColCount&&(this.rightFrozenGroup.setAttribute(\\\"x\\\",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(e,t,i){updateRowHeight(this,e,t=Math.round(t),i),this.updateContainerHeight(e,t)}updateRowsHeight(e,t,i){for(let n=0;n<e.length;n++){var r,o=e[n];o>=this.proxy.rowStart&&o<=this.proxy.rowEnd&&(r=t[n],updateRowHeight(this,o,Math.round(r),i),this._updateContainerHeight(o,r))}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(e,t){e<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(t),this.cornerHeaderGroup.setDeltaWidth(t),this.colHeaderGroup.setDeltaX(t),this.bodyGroup.setDeltaX(t)):(this.colHeaderGroup.setDeltaWidth(t),this.bodyGroup.setDeltaWidth(t)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(e,t){e<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(t),this.cornerHeaderGroup.setDeltaHeight(t),this.rowHeaderGroup.setDeltaY(t),this.bodyGroup.setDeltaY(t),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(t)):e>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(t),this.bottomFrozenGroup.setDeltaHeight(t),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(t)):(this.rowHeaderGroup.setDeltaHeight(t),this.bodyGroup.setDeltaHeight(t),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(t))}updateContainerHeight(e,t){this._updateContainerHeight(e,t),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(e,t){var i=this.table.getColWidth(e);i!==t&&(this.updateColWidth(e,t-i),this.table._clearColRangeWidthsMap(e))}setRowHeight(e,t){var i=this.table.getRowHeight(e);i!==t&&((e>=this.proxy.rowStart&&e<=this.proxy.rowEnd||e>=this.table.rowCount-this.table.bottomFrozenRowCount&&e<=this.table.rowCount-1||e<this.table.frozenRowCount)&&this.updateRowHeight(e,t-i),this.table._clearRowRangeHeightsMap(e))}setX(e,t=!1){this.table.scenegraph.proxy.setX(-e,t)}setY(e,t=!1){this.table.scenegraph.proxy.setY(-e,t)}setBodyAndRowHeaderY(e){var t=null==(t=this.bodyGroup.firstChild)?void 0:t.firstChild,i=null==(i=this.bodyGroup.firstChild)?void 0:i.lastChild;0===e&&t&&t.row===this.table.frozenRowCount&&t.attribute.y+e<0?e=-t.attribute.y:i&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&i.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&i.attribute.y+i.attribute.height+e<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(e=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-i.attribute.y-i.attribute.height),this.colHeaderGroup.attribute.height+e!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute(\\\"y\\\",this.colHeaderGroup.attribute.height+e),this.rowHeaderGroup.setAttribute(\\\"y\\\",this.cornerHeaderGroup.attribute.height+e),0<this.table.rightFrozenColCount&&this.rightFrozenGroup.setAttribute(\\\"y\\\",this.rightTopCornerGroup.attribute.height+e),this.updateNextFrame())}setBodyAndColHeaderX(e){var t=this.bodyGroup.firstChild,i=this.bodyGroup.lastChild;0===e&&t&&t.col===this.table.frozenColCount&&t.attribute.x+e<0?e=-t.attribute.x:i&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&i.col===this.table.colCount-this.table.rightFrozenColCount-1&&i.attribute.x+i.attribute.width+e<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(e=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-i.attribute.x-i.attribute.width),this.table.getFrozenColsWidth()+e!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute(\\\"x\\\",this.table.getFrozenColsWidth()+e),this.colHeaderGroup.setAttribute(\\\"x\\\",this.table.getFrozenColsWidth()+e),0<this.table.bottomFrozenRowCount&&this.bottomFrozenGroup.setAttribute(\\\"x\\\",this.table.getFrozenColsWidth()+e),this.updateNextFrame())}afterScenegraphCreated(){this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),handleTextStick(this.table),this.table.options.animationAppear&&dealWithAnimationAppear(this.table),this.updateNextFrame()}dealWidthMode(){var r=this.table;if(\\\"adaptive\\\"===r.widthMode){r._clearColRangeWidthsMap();var o=r.tableNoFrameWidth;let e=0;for(let t=0;t<r.colCount;t++)(t<r.rowHeaderLevelCount||r.isPivotChart()&&t>=r.colCount-r.rightFrozenColCount)&&(e+=r.getColWidth(t));var n=r.rowHeaderLevelCount,a=r.isPivotChart()?r.colCount-r.rightFrozenColCount:r.colCount;getAdaptiveWidth(o-e,n,a,!1,[],r,!0)}else if(r.autoFillWidth){r._clearColRangeWidthsMap();o=r.tableNoFrameWidth;let e=0,t=0;for(let i=0;i<r.colCount;i++){var l=r.getColWidth(i);(i<r.rowHeaderLevelCount||r.isPivotChart()&&i>=r.colCount-r.rightFrozenColCount)&&(e+=l),t+=l}t<o&&t>e&&(n=r.rowHeaderLevelCount,a=r.isPivotChart()?r.colCount-r.rightFrozenColCount:r.colCount,getAdaptiveWidth(o-e,n,a,!1,[],r,!0))}let t=0,i=(this.bodyGroup.forEachChildrenSkipChild(e=>{t+=e.attribute.width}),this.bodyGroup.setAttribute(\\\"width\\\",t),0),s=(this.colHeaderGroup.forEachChildrenSkipChild(e=>{i+=e.attribute.width}),this.colHeaderGroup.setAttribute(\\\"width\\\",i),0),h=(this.rowHeaderGroup.forEachChildrenSkipChild(e=>{s+=e.attribute.width}),this.rowHeaderGroup.setAttribute(\\\"width\\\",s),0);this.cornerHeaderGroup.forEachChildrenSkipChild(e=>{h+=e.attribute.width}),this.cornerHeaderGroup.setAttribute(\\\"width\\\",h),this.colHeaderGroup.setAttribute(\\\"x\\\",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute(\\\"y\\\",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var r=this.table;if(\\\"adaptive\\\"===r.heightMode){r._clearRowRangeHeightsMap();var o=r.getRowsHeight(0,r.columnHeaderLevelCount-1),n=r.isPivotChart()?r.getBottomFrozenRowsHeight():0,a=r.tableNoFrameHeight-o-n,l=r.columnHeaderLevelCount,s=r.isPivotChart()?r.rowCount-r.bottomFrozenRowCount:r.rowCount;let e=0;for(let t=l;t<s;t++)e+=r.getRowHeight(t);var h=a/e;for(let i=l;i<s;i++){var d=i===s-1?a-r.getRowsHeight(l,s-2):Math.round(r.getRowHeight(i)*h);this.setRowHeight(i,d)}}else if(r.autoFillHeight){r._clearRowRangeHeightsMap();var u=r.tableNoFrameHeight;let t=0,i=0;for(let e=0;e<r.rowCount;e++){var c=r.getRowHeight(e);(e<r.columnHeaderLevelCount||r.isPivotChart()&&e>=r.rowCount-r.bottomFrozenRowCount)&&(i+=c),t+=c}if((null!=(o=this._dealAutoFillHeightOriginRowsHeight)?o:t)<u&&0<t-i){var g=r.columnHeaderLevelCount,p=r.isPivotChart()?r.rowCount-r.bottomFrozenRowCount:r.rowCount,f=(u-i)/(t-i);for(let e=g;e<p;e++){var m=e===p-1?u-i-r.getRowsHeight(g,p-2):Math.round(r.getRowHeight(e)*f);this.setRowHeight(e,m)}}}}dealFrozen(){dealFrozen(this)}resetFrozen(){resetFrozen(this)}resetRowFrozen(){resetRowFrozen(this)}updateCellLayoutWidthCertainWidth(e,a,l){const s=e.attribute.width;let h=!1;return e.forEachChildren((e,t)=>{var i=getCellMergeInfo(this.table,l,t+=a),i=(i?e=this.getCell(i.start.col,i.start.row):e.setAttribute(\\\"width\\\",s),this.table._getCellStyle(l,t)),i=getQuadProps(getProp2(\\\"padding\\\",i,l,t,this.table)),r=e.getChildByName(\\\"text\\\");let o=0,n=0;n=r?(o=r.AABBBounds.height()+(i[0]+i[2]),r.setAttribute(\\\"maxLineWidth\\\",s-(i[1]+i[3])),r.AABBBounds.height()+(i[0]+i[2])):(r=e.getChildAt(1),o=r.AABBBounds.height()+(i[0]+i[2]),r._cellWidth=s-(i[1]+i[3]),r.layout(),r.AABBBounds.height()+(i[0]+i[2]));r=this.table.getRowHeight(t);e.attribute.height!==n&&(e.setAttribute(\\\"height\\\",n),r===o||n>r)&&(h=!0)}),h}updateHeaderPosition(e,t,i,r,o){moveHeaderPosition(e,t,i,r,o,this.table)}updateContainerAttrWidthAndX(){var e,t=updateContainerChildrenX(this.cornerHeaderGroup,0),i=updateContainerChildrenX(this.rowHeaderGroup,0),r=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?updateContainerChildrenX(this.colHeaderGroup,0<this.colHeaderGroup.firstChild.col?this.table.getColsWidth(null!=(r=this.table.frozenColCount)?r:0,this.colHeaderGroup.firstChild.col-1):0):0,o=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?updateContainerChildrenX(this.bodyGroup,0<this.bodyGroup.firstChild.col?this.table.getColsWidth(null!=(o=this.table.frozenColCount)?o:0,this.bodyGroup.firstChild.col-1):0):0,n=updateContainerChildrenX(0<this.rightFrozenGroup.childrenCount?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&updateContainerChildrenX(this.bottomFrozenGroup,0<this.bottomFrozenGroup.firstChild.col?this.table.getColsWidth(null!=(e=this.table.frozenColCount)?e:0,this.bottomFrozenGroup.firstChild.col-1):0),updateContainerChildrenX(this.leftBottomCornerGroup,0),updateContainerChildrenX(this.rightTopCornerGroup,0),updateContainerChildrenX(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(t-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(t-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(r-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(i-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(r-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(n-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(n-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(n-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(o-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute(\\\"x\\\",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute(\\\"x\\\",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute(\\\"x\\\",this.rowHeaderGroup.attribute.width)}updateContainer(e=!1){e?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{this.updateContainerSync()},0)):(this._needUpdateContainer=!0,this.updateContainerSync())}updateContainerSync(){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(e,t){var i=null!=(i=this.table.getCellRawRecord(e,t))&&i.vtableMerge?\\\"text\\\":this.table.isHeader(e,t)?this.table._getHeaderLayoutMap(e,t).headerType:this.table.getBodyColumnType(e,t),r=this.getCell(e,t);\\\"image\\\"!==i&&\\\"video\\\"!==i||updateImageCellContentWhileResize(r,e,t,0,0,this.table)}createFrameBorder(){this.updateTableSize();var e,t=!this.isPivot&&!this.table.internalProps.transpose;createFrameBorder(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,t?[!0,!0,!0,!1]:void 0),createFrameBorder(this.rowHeaderGroup,(this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle:this.table.theme.bodyStyle).frameStyle,this.rowHeaderGroup.role,t?[!0,!1,!0,!0]:void 0),createFrameBorder(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,t?[!0,!0,!0,!1]:void 0),createFrameBorder(this.cornerHeaderGroup,(this.isPivot?this.table.theme.cornerHeaderStyle:this.table.theme.headerStyle).frameStyle,this.cornerHeaderGroup.role,t?[!0,!1,!0,!0]:void 0),null!=(e=this.table.theme.cornerLeftBottomCellStyle)&&e.frameStyle&&createFrameBorder(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,t?[!0,!1,!0,!0]:void 0),null!=(e=this.table.theme.bottomFrozenStyle)&&e.frameStyle&&createFrameBorder(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,t?[!0,!0,!0,!1]:void 0),null!=(e=this.table.theme.rightFrozenStyle)&&e.frameStyle&&createFrameBorder(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),null!=(t=this.table.theme.cornerRightTopCellStyle)&&t.frameStyle&&createFrameBorder(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),null!=(e=this.table.theme.cornerRightBottomCellStyle)&&e.frameStyle&&createFrameBorder(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),createFrameBorder(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(e,t,i){var r,o=this.table.theme.columnResize.resizeHotSpotSize/2;let n;return i?i.stage&&(e<i.globalAABBBounds.x1+o?n={col:i.col-1,row:i.row,x:i.globalAABBBounds.x1}:i.globalAABBBounds.x2-o<e&&(n={col:i.col,row:i.row,x:i.globalAABBBounds.x2}),n&&0<this.table.rightFrozenColCount&&n.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(n.col=n.col+1,n.rightFrozen=!0),n)||{col:-1,row:-1}:t>=(r=this.table.getDrawRange()).top&&t<=r.bottom&&(n=this.table.getCellAtRelativePosition(e-o,t)).col===this.table.colCount-1?n:{col:-1,row:-1}}getResizeRowAt(e,t,i){var r=this.table.theme.columnResize.resizeHotSpotSize/2;if(i){let e;if(t<i.globalAABBBounds.y1+r?e={col:i.col,row:i.row-1,y:i.globalAABBBounds.y1}:i.globalAABBBounds.y2-r<t&&(e={col:i.col,row:i.row,y:i.globalAABBBounds.y2}),e&&0<this.table.bottomFrozenRowCount&&e.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(e.row=e.row+1,e.bottomFrozen=!0),e)return e}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(e){this.clear?this.table.internalProps.rightFrozenColCount=e:dealRightFrozen(e,this)}dealWidthBottomFrozen(e){this.clear?this.table.internalProps.bottomFrozenRowCount=e:dealBottomFrozen(e,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),updateFrameBorderSize(this.bodyGroup),this.rowHeaderGroup.attribute.width,updateFrameBorder(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),updateFrameBorderSize(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,updateFrameBorder(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),updateFrameBorderSize(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),updateFrameBorderSize(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),updateFrameBorderSize(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),updateFrameBorderSize(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),updateFrameBorderSize(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),updateFrameBorderSize(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),updateFrameBorderSize(this.rightBottomCornerGroup)),updateCornerRadius(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(e,t){var i=this.getCell(e,t).getChildByName(\\\"text\\\",!0);if(i&&\\\"text\\\"===i.type){if(i.attribute.moreThanMaxCharacters)return this.table.getCellValue(e,t);if(i.cliped)return this.table.getCellValue(e,t)}else if(i&&\\\"richtext\\\"===i.type)if(i.attribute.ellipsis&&i._frameCache&&i.attribute.height<i._frameCache.actualHeight)return i.attribute.textConfig.find(e=>e.text),this.table.getCellValue(e,t);return null}updateDrill(e,t,i,r,o){this.component.drillIcon.update(e,t,i,r,o,this)}updateCellContent(e,t,i=!1){if(!this.clear)return updateCell(e,t,this.table,void 0,void 0,i)}setPixelRatio(e){this.stage.disableDirtyBounds(),this.stage.window.setDpr(e),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(e,t,i=[],r=!0,o){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;var n=deduplication(t.map(e=>e.row)).sort((e,t)=>e-t),a=deduplication(i.map(e=>e.row)).sort((e,t)=>e-t),n=this.table.getAllRowsHeight()-[...n,...a].reduce((e,t)=>e+this.table.getRowHeight(t),0)<=this.table.tableNoFrameHeight;if(updateRow(e,t,i,this.table,o),r&&this.recalculateColWidths(),\\\"adaptive\\\"===this.table.heightMode||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||n))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight(this.table.columnHeaderLevelCount))for(let e=0;e<a.length;e++){var l=a[e],s=this.table.getRowHeight(l),h=computeRowHeight(l,0,this.table.colCount-1,this.table);(l>=this.proxy.rowStart&&l<=this.proxy.rowEnd||l>=this.table.rowCount-this.table.bottomFrozenRowCount&&l<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(l,h-s)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(e,t,i=[]){updateCol(e,t,i,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)updateCell(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)updateCell(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)updateCell(e,t,this.table,!1)}getColumnGroupX(e){return e<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,e-1):e<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,e-1):e<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,e-1):0}getCellGroupY(e){return e<this.table.frozenRowCount?this.table.getRowsHeight(0,e-1):e<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.frozenRowCount,e-1):e<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,e-1):0}getCellGroupX(e){return e<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,e-1):e<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,e-1):e<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,e-1):0}updateDomContainer(){updateReactContainer(this.table)}setLoadingHierarchyState(e,t){var i,r=this.getCell(e,t),r=r.getChildByName(\\\"collapse\\\",!0)||r.getChildByName(\\\"expand\\\",!0);r&&(i=get3()[InternalIconName.loadingIconName])&&dealWithIcon(i,r,e,t)}temporarilyUpdateSelectRectStyle(e){temporarilyUpdateSelectRectStyle(e,this)}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}};function checkCellInSelect(e,t,i){for(let r=0;r<i.length;r++)if(cellInRange(i[r],e,t))return!0;return!1}function checkMultiCellInSelect(e,t,i,r){for(let o=0;o<i.length;o++)if(rangeIntersected(i[o],{start:e,end:t}))return!0;return!1}function updateCell2(i,e,t){var r=i.highPerformanceGetCell(e,t);if(\\\"cell\\\"===r.role&&isValid_default(r.mergeStartCol)&&isValid_default(r.mergeStartRow)&&isValid_default(r.mergeEndCol)&&isValid_default(r.mergeEndRow)){var{colStart:o,colEnd:n,rowStart:a,rowEnd:l}=getCellMergeRange(r,i);for(let t=o;t<=n;t++)for(let e=a;e<=l;e++){var s=i.highPerformanceGetCell(t,e);\\\"cell\\\"===s.role&&s.addUpdateBoundTag()}}else r.addUpdateBoundTag()}function clearColHover(e,t,i,r,o){var n=e.table;for(let l=0;l<n.columnHeaderLevelCount;l++)updateCell2(e,t,l);var a=e.getColGroup(t);return null!=a&&a.addUpdateBoundTag(),!0}function updateColHover(e,t,i,r,o,n){var a=e.table;for(let s=0;s<a.columnHeaderLevelCount;s++)updateCell2(e,t,s);var l=e.getColGroup(t);return null!=l&&l.addUpdateBoundTag(),!0}function clearRowHover(e,t,i,r,o){var n=e.table;for(let a=0;a<n.colCount;a++)updateCell2(e,a,i);return!0}function updateRowHover(e,t,i,r,o,n){var a=e.table;for(let l=0;l<a.colCount;l++)updateCell2(e,l,i);return!0}function clearSingleHover(e,t,i,r,o){return updateCell2(e,t,i),!0}function updateSingleHover(e,t,i,r,o){return updateCell2(e,t,i),!0}function updateHoverPosition(t,i,r){var e=t.table,o=e.scenegraph,{highlightScope:n,singleStyle:a,disableHeader:l,cellPos:s,cellPosContainHeader:h}=t.hover,d=s.col,u=s.row;if(n!==HighlightScope.none&&(!l||h.col===i&&h.row===r)||(c=h.col,g=h.row,o.hideHoverIcon(c,g),o.showHoverIcon(i,r),h.col=i,h.row=r),(l&&e.isHeader(i,r)||n===HighlightScope.none)&&(r=i=-1),d!==i||u!==r){o.deactivateChart(d,u),o.activateChart(i,r);let e=!1;var{ranges:c,highlightScope:g}=t.select;-1!==d&&-1!==u&&(e=clearHover(o,d,u,c,a,n,g),l||o.hideHoverIcon(d,u)),-1===i||-1===r?(s.col=-1,s.row=-1,!e||d===i&&u===r||t.table.scenegraph.updateNextFrame()):(n===HighlightScope.single?e=!!updateSingleHover(o,i,r,c,g)||e:n===HighlightScope.row?e=!!updateRowHover(o,i,r,c,g,a)||e:n===HighlightScope.column?e=!!updateColHover(o,i,r,c,g,a)||e:n===HighlightScope.cross&&(e=!!updateRowHover(o,i,r,c,g,a)||e,e=!!updateColHover(o,i,r,c,g,a)||e),n===HighlightScope.none||l||o.showHoverIcon(i,r),s.col=i,s.row=r,e&&t.table.scenegraph.updateNextFrame())}}function clearHover(e,t,i,r,o,n,a){let l=!1;return n===HighlightScope.single?l=!!clearSingleHover(e,t,i,r,a)||l:n===HighlightScope.row?l=!!clearRowHover(e,t,i,r,a)||l:n===HighlightScope.column?l=!!clearColHover(e,t,i,r,a)||l:n===HighlightScope.cross&&(l=!!clearRowHover(e,t,i,r,a)||l,l=!!clearColHover(e,t,i,r,a)||l),l}function dealFreeze(e,t,i){!(0<i.frozenColCount)||e!==i.frozenColCount-1?i.setFrozenColCount(e+1):i.setFrozenColCount(0)}function dealSort(t,i,r,e){let o,n,a=null,l=!1;if(Array.isArray(r.sortState))for(let e=0;e<r.sortState.length&&((n=r.sortState[e])&&(a=r._getHeaderCellBySortState(n)),!(l=a?isTarget(t,i,a.col,a.row,r):l));e++);else n=r.sortState,(a=n?r._getHeaderCellBySortState(n):a)&&(l=isTarget(t,i,a.col,a.row,r));var s=r.getHeaderDefine(t,i);if(n&&l&&null!=s&&s.sort?n.order=\\\"asc\\\"===n.order?\\\"desc\\\":\\\"desc\\\"===n.order?\\\"normal\\\":\\\"asc\\\":null!=s&&s.sort?n={field:r.getHeaderField(t,i),order:\\\"asc\\\"}:l&&null!=s&&s.showSort||(n={field:r.getHeaderField(t,i),order:\\\"normal\\\"}),n.event=e,!r.fireListeners(TABLE_EVENT_TYPE.SORT_CLICK,n).includes(!1)){let e=!1,t=r.internalProps.sortState?Array.isArray(r.internalProps.sortState)&&(e=!0)?r.internalProps.sortState:[r.internalProps.sortState]:[];Array.isArray(t)&&(0<=(h=t.findIndex(e=>e.field===n.field))?t[h]=n:t.push(n)),t=t.filter(e=>\\\"normal\\\"!==e.order),t=r.internalProps.multipleSort&&(e=!0)?t:t.splice(-1),t=e&&t.length?t:t[0],r.internalProps.sortState=t,r.stateManager.setSortState(t),null!=s&&s.sort&&executeSort(t,r,s),r.internalProps.useOneRowHeightFillAll=!1,r.internalProps.layoutMap.clearCellRangeMap(),r.scenegraph.sortCell();var h=!(null==(o=r.stateManager.select.ranges)||!o.length);r.stateManager.updateSelectPos(-1,-1),r.stateManager.endSelectCells(!0,h)}}function executeSort(e,r,t){e=Array.isArray(e)||!e?e:[e],r.dataSource.sort((e||[]).map(t=>{var e,i=r.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field);return{field:t.field,order:t.order||\\\"asc\\\",orderFn:\\\"function\\\"==typeof(null==(e=null==i?void 0:i.define)?void 0:e.sort)?null==(e=null==i?void 0:i.define)?void 0:e.sort:defaultOrderFn}}))}function isTarget(e,t,i,r,o){return o._getLayoutCellId(e,t)===o._getLayoutCellId(i,r)}function updateSelectPosition(i,t,r,e,o,n,a=!0,l=!1){var{table:s,interactionState:h}=i,d=s.scenegraph,{cellPos:u,disableCtrlMultiSelect:c}=i.select;if(-1!==t&&-1!==r&&a&&s._makeVisibleCell(t,r),-1!==t&&-1!==r&&a&&(h===InteractionState.grabing&&0<i.select.ranges.length?(t>(g=i.select.ranges[i.select.ranges.length-1]).start.col&&t>g.end.col&&s._makeVisibleCell(t+1,r),r>g.start.row&&r>g.end.row&&s._makeVisibleCell(t,r+1),t<g.start.col&&t<g.end.col&&s._makeVisibleCell(t-1,r),r<g.start.row&&r<g.end.row&&s._makeVisibleCell(t,r-1)):s._makeVisibleCell(t,r)),n){i.select.ranges=[],d.deleteAllSelectBorder();let e=0,t=0;var{disableHeaderSelect:g,disableRowSeriesNumberSelect:p}=(null==(g=s.options.keyboardOptions)?void 0:g.selectAllOnCtrlA)||{},p=(g&&(e=s.rowHeaderLevelCount,t=s.columnHeaderLevelCount),(p||g&&s.transpose)&&s.options.rowSeriesNumber&&(e+=1),i.select.ranges.push({start:{col:e,row:t},end:{col:s.colCount-1,row:s.rowCount-1}}),i.select.ranges[i.select.ranges.length-1]);d.updateCellSelectBorder(p,!1)}else if(-1===u.col||-1===u.row||-1!==t&&-1!==r)if(h!==InteractionState[\\\"default\\\"]||s.eventManager.isDraging||s.stateManager.isResizeCol()){if((h===InteractionState.grabing||s.eventManager.isDraging)&&!s.stateManager.isResizeCol()){let e=!0;-1===u.col&&(u.col=t),-1===u.row&&(u.row=r),u.col=t,u.row=r;g=i.select.ranges[i.select.ranges.length-1];g&&(s.internalProps.layoutMap.isSeriesNumberInBody(g.start.col,g.start.row)?(e=!1,g.end={col:s.colCount-1,row:r}):i.fillHandle.isFilling?\\\"top\\\"===i.fillHandle.direction?r===i.fillHandle.beforeFillMinRow&&r===i.fillHandle.beforeFillMaxRow?g.start.row=g.end.row=r:r<=i.fillHandle.beforeFillMinRow?(g.start.row<g.end.row&&(p=g.start.row,g.start.row=g.end.row,g.end.row=p),g.end.row=r):r===i.fillHandle.beforeFillMaxRow&&(g.start.row>g.end.row?g.start.row=r:g.end.row=r):\\\"bottom\\\"===i.fillHandle.direction?r>=i.fillHandle.beforeFillMaxRow&&(g.start.row>g.end.row&&(h=g.start.row,g.start.row=g.end.row,g.end.row=h),g.end.row=r):\\\"left\\\"===i.fillHandle.direction?t===i.fillHandle.beforeFillMinCol&&t===i.fillHandle.beforeFillMaxCol?g.start.col=g.end.col=t:t<=i.fillHandle.beforeFillMinCol?(g.start.col<g.end.col&&(p=g.start.col,g.start.col=g.end.col,g.end.col=p),g.end.col=t):t===i.fillHandle.beforeFillMaxCol&&(g.start.col>g.end.col?g.start.col=t:g.end.col=t):\\\"right\\\"===i.fillHandle.direction&&t>=i.fillHandle.beforeFillMaxCol&&(g.start.col>g.end.col&&(h=g.start.col,g.start.col=g.end.col,g.end.col=h),g.end.col=t):(g.end={col:t,row:r},p=l?{start:{col:t,row:r},end:{col:t,row:r}}:s.getCellRange(t,r),g.start.col<p.end.col?g.end.col=p.end.col:g.start.col>p.start.col&&(g.end.col=p.start.col),g.start.row<p.end.row?g.end.row=p.end.row:g.start.row>p.start.row&&(g.end.row=p.start.row),\\\"body\\\"===i.select.headerSelectMode&&(s.isRowHeader(t,r)?(g.start.col=s.rowHeaderLevelCount+s.leftRowSeriesNumberCount,g.end.col=s.colCount-1):s.isColumnHeader(t,r)?(g.start.row=s.columnHeaderLevelCount,g.end.row=s.rowCount-1):s.internalProps.layoutMap.isSeriesNumberInBody(t,r)?(g.start.col=s.leftRowSeriesNumberCount,g.end.col=s.colCount-1):s.isCornerHeader(t,r)?(g.start.col=s.rowHeaderLevelCount+s.leftRowSeriesNumberCount,g.start.row=s.columnHeaderLevelCount,g.end.col=s.colCount-1,g.end.row=s.rowCount-1):s.isSeriesNumber(t,r)&&(g.start.col=s.leftRowSeriesNumberCount,g.start.row=s.columnHeaderLevelCount,g.end.col=s.colCount-1,g.end.row=s.rowCount-1)),l&&(g.skipBodyMerge=!0)),g)&&g.start.row<=s.rowCount-1&&g.end.row<=s.rowCount-1&&g.start.col<=s.colCount-1&&g.end.col<=s.colCount-1&&d.updateCellSelectBorder(g,e)}}else{var f,h=i.select.ranges[i.select.ranges.length-1];if(e&&h)o&&!c||(u.col=t,u.row=r),\\\"cell\\\"!==i.select.headerSelectMode&&s.isColumnHeader(t,r)?(p=Math.min(h.start.col,h.end.col,t),g=Math.max(h.start.col,h.end.col,t),m=Math.min(h.start.row,h.end.row,r),f=s.rowCount-1,\\\"body\\\"===i.select.headerSelectMode?(h.start={col:p,row:s.columnHeaderLevelCount},h.end={col:g,row:s.rowCount-1}):(h.start={col:p,row:m},h.end={col:g,row:f})):\\\"cell\\\"!==i.select.headerSelectMode&&s.isRowHeader(t,r)?(p=Math.min(h.start.col,h.end.col,t),m=s.colCount-1,g=Math.min(h.start.row,h.end.row,r),f=Math.max(h.start.row,h.end.row,r),\\\"body\\\"===i.select.headerSelectMode?(h.start={col:s.leftRowSeriesNumberCount+s.rowHeaderLevelCount,row:g},h.end={col:s.colCount-1,row:f}):(h.start={col:p,row:g},h.end={col:m,row:f})):\\\"cell\\\"!==i.select.headerSelectMode&&s.isSeriesNumberInBody(t,r)?(p=Math.min(h.start.col,h.end.col,t),g=s.colCount-1,m=Math.min(h.start.row,h.end.row,r),f=Math.max(h.start.row,h.end.row,r),\\\"body\\\"===i.select.headerSelectMode?(h.start={col:s.leftRowSeriesNumberCount,row:m},h.end={col:s.colCount-1,row:f}):(h.start={col:p,row:m},h.end={col:g,row:f})):h.end={col:t,row:r},d.deleteLastSelectedRangeComponents(),d.updateCellSelectBorder(h);else{let e=!0;-1===u.col||-1===u.row||o&&!c||(i.select.ranges=[],d.deleteAllSelectBorder()),\\\"cell\\\"!==i.select.headerSelectMode&&s.isColumnHeader(t,r)?(p=s.getCellRange(t,r),\\\"body\\\"===i.select.headerSelectMode?i.select.ranges.push({start:{col:p.start.col,row:s.columnHeaderLevelCount},end:{col:p.end.col,row:s.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:p.start.col,row:p.start.row},end:{col:p.end.col,row:s.rowCount-1},skipBodyMerge:!0})):\\\"cell\\\"!==i.select.headerSelectMode&&s.isRowHeader(t,r)?(m=s.getCellRange(t,r),\\\"body\\\"===i.select.headerSelectMode?i.select.ranges.push({start:{col:s.rowHeaderLevelCount+s.leftRowSeriesNumberCount,row:m.start.row},end:{col:s.colCount-1,row:m.end.row},skipBodyMerge:!0}):i.select.ranges.push({start:{col:m.start.col,row:m.start.row},end:{col:s.colCount-1,row:m.end.row},skipBodyMerge:!0})):s.internalProps.layoutMap.isSeriesNumberInHeader(t,r)?(e=!1,\\\"body\\\"===i.select.headerSelectMode?i.select.ranges.push({start:{col:s.leftRowSeriesNumberCount,row:s.columnHeaderLevelCount},end:{col:s.colCount-1,row:s.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:0,row:0},end:{col:s.colCount-1,row:s.rowCount-1},skipBodyMerge:!0})):s.internalProps.layoutMap.isSeriesNumberInBody(t,r)?(e=!1,\\\"body\\\"===i.select.headerSelectMode?i.select.ranges.push({start:{col:s.leftRowSeriesNumberCount,row:r},end:{col:s.colCount-1,row:r},skipBodyMerge:!0}):i.select.ranges.push({start:{col:t,row:r},end:{col:s.colCount-1,row:r},skipBodyMerge:!0})):s.internalProps.layoutMap.isCornerHeader(t,r)?(e=!1,\\\"body\\\"===i.select.headerSelectMode?i.select.ranges.push({start:{col:s.rowHeaderLevelCount+s.leftRowSeriesNumberCount,row:s.columnHeaderLevelCount},end:{col:s.colCount-1,row:s.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:s.leftRowSeriesNumberCount,row:0},end:{col:s.colCount-1,row:s.rowCount-1},skipBodyMerge:!0})):0<=t&&0<=r&&(g=l?{start:{col:t,row:r},end:{col:t,row:r}}:s.getCellRange(t,r),i.select.ranges.push({start:{col:g.start.col,row:g.start.row},end:{col:g.end.col,row:g.end.row},skipBodyMerge:l||void 0})),u.col=t,u.row=r;var m,h=null==(f=i.select.ranges)?void 0:f[i.select.ranges.length-1];h&&h.start.row<=s.rowCount-1&&h.end.row<=s.rowCount-1&&h.start.col<=s.colCount-1&&h.end.col<=s.colCount-1&&d.updateCellSelectBorder(h,e)}}else u.col=-1,u.row=-1,i.select.ranges=[],d.deleteAllSelectBorder();d.updateNextFrame()}function selectEnd(e){e.moveSelectingRangeComponentsToSelectedRangeComponents()}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var PIVOT_TABLE_EVENT_TYPE=extend(TABLE_EVENT_TYPE,{PIVOT_SORT_CLICK:\\\"pivot_sort_click\\\",DRILLMENU_CLICK:\\\"drillmenu_click\\\"}),PIVOT_CHART_EVENT_TYPE=extend(TABLE_EVENT_TYPE,{VCHART_EVENT_TYPE:\\\"vchart_event_type\\\"});function updateDrill(e,t,i,r,o){var n=o.getCellLocation(e,t);let a=0,l=0,s=!1;\\\"columnHeader\\\"===n?(a=o.getColsWidth(0,o.rowHeaderLevelCount-1)-(0===o.frozenColCount?o.scrollLeft:0),l=o.getRowsHeight(0,t-1)+o.getRowHeight(t)/2,s=!0):\\\"rowHeader\\\"===n&&(l=o.getRowsHeight(0,o.columnHeaderLevelCount-1),a=o.getColsWidth(0,e-1)+o.getColWidth(e)/2,s=!0),o.scenegraph.updateDrill(s,a,l,i,r)}function clearChartHover(e,t,i){var r=i.scenegraph.getCell(e,t).getChildByName(\\\"sparkline\\\"),o=null==r?void 0:r.getChildByName(\\\"highlight-line\\\"),r=null==r?void 0:r.getChildByName(\\\"highlight-symbol\\\");o&&o.setAttributes({visible:!1,pickable:!1}),r&&r.setAttributes({visible:!1,pickable:!1}),i.scenegraph.updateNextFrame()}function updateChartHover(e,t,i,r,o){var n=o.scenegraph.getCell(e,t).getChildByName(\\\"sparkline\\\"),a=null==n?void 0:n.getChildByName(\\\"sparkline-line\\\"),l=null==n?void 0:n.getChildByName(\\\"sparkline-symbol-group\\\");if(!a)return!1;var s,h=a.bandwidth,d=a.min,u=a.max,c=a.attribute.points;let g;i-=n.globalAABBBounds.x1,n.globalAABBBounds.y1;for(let C=0;C<c.length;C++){var{x:p,y:f,defined:m,rawData:b}=c[C];if(Math.abs(i-p)<h/2&&(g={point:c[C],points:c,pointsBandWidth:h,pointData:b},m)){var b=n.getChildByName(\\\"highlight-line\\\"),b=(b?b.setAttributes({points:[{x:p,y:u},{x:p,y:d}],visible:!0,pickable:!0}):((m=createLine({points:[{x:p,y:u},{x:p,y:d}],lineWidth:null==(m=a.hover)?void 0:m.strokeWidth,stroke:null==(b=a.hover)?void 0:b.stroke})).name=\\\"highlight-line\\\",n.addChild(m)),n.getChildByName(\\\"highlight-symbol\\\"));b?b.setAttributes({x:p,y:f,visible:!0,pickable:!0}):((m=createSymbol({x:p,y:f,stroke:l.hover.stroke,lineWidth:l.hover.strokeWidth,fill:l.hover.fill,size:2*l.hover.size,symbolType:\\\"circle\\\"})).name=\\\"highlight-symbol\\\",n.addChild(m));break}}return o.scenegraph.updateNextFrame(),g&&(s={col:e,row:t,field:o.getHeaderField(e,t),value:o.getCellValue(e,t),dataValue:o.getCellOriginValue(e,t),cellHeaderPaths:o.internalProps.layoutMap.getCellHeaderPaths(e,t),title:o.getBodyColumnDefine(e,t).title,cellRange:o.getCellRelativeRect(e,t),sparkline:{pointData:g.pointData},scaleRatio:o.canvas.getBoundingClientRect().width/o.canvas.offsetWidth},o.fireListeners(TABLE_EVENT_TYPE.MOUSEOVER_CHART_SYMBOL,s)),!0}function adjustMoveHeaderTarget(e,t,i){var r,o,n=i.getCellRange(e.col,e.row);return i.isColumnHeader(e.col,e.row)?(r=i.getCellRange(t.col,n.start.row),t.row>=i.columnHeaderLevelCount&&(t.row=i.columnHeaderLevelCount-1),t.col>=e.col?t.col=r.end.col:t.col=r.start.col):i.isRowHeader(e.col,e.row)&&(r=i.internalProps.layoutMap,n=i.getCellRange(n.start.col,t.row),t.col>=i.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount&&(t.col=i.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount-1),\\\"tree\\\"===r.rowHierarchyType?(o=r.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths,r=r.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,o.length<=r.length&&(o=r[o.length-1])&&(t.row>=e.row?t.row=o.startInTotal+o.size-1+i.columnHeaderLevelCount:t.row=o.startInTotal+i.columnHeaderLevelCount)):t.row>=e.row?t.row=n.end.row:t.row=n.start.row),t}function startMoveCol(e,t,i,r,o,n){var a,l,s,h;\\\"canMoveHeaderPosition\\\"in o.table.internalProps.layoutMap&&(o.columnMove.moving=!0,o.columnMove.colSource=e,o.columnMove.rowSource=t,o.columnMove.x=i-o.table.tableX,o.columnMove.y=r-o.table.tableY,a=\\\"columnHeader\\\"===(a=o.table.getCellLocation(e,t))?o.columnMove.x:\\\"rowHeader\\\"===a||o.table.internalProps.layoutMap.isSeriesNumberInBody(e,t)?o.columnMove.y:0,({backX:a,lineX:h,backY:l,lineY:s}=o.table.scenegraph.component.showMoveCol(e,t,a)),o.table.fireListeners(TABLE_EVENT_TYPE.CHANGE_HEADER_POSITION_START,{col:e,row:t,x:i,y:r,backX:a,lineX:h,backY:l,lineY:s,event:n}),h=!(null==(a=o.select.ranges)||!a.length),o.table.stateManager.updateSelectPos(-1,-1),o.table.stateManager.endSelectCells(!0,h),o.table.scenegraph.updateNextFrame())}function updateMoveCol(o,n,a,l,s,h){if(\\\"canMoveHeaderPosition\\\"in s.table.internalProps.layoutMap){var d=adjustMoveHeaderTarget({col:s.columnMove.colSource,row:s.columnMove.rowSource},{col:o,row:n},s.table);if(s.table.internalProps.layoutMap.canMoveHeaderPosition({col:s.columnMove.colSource,row:s.columnMove.rowSource},{col:d.col,row:d.row})){let e,t,i,r;s.columnMove.x=a-s.table.tableX,s.columnMove.y=l-s.table.tableY,s.columnMove.colTarget=d.col,s.columnMove.rowTarget=d.row,s.updateCursor(\\\"grabbing\\\");var u=s.table.getCellLocation(s.columnMove.colSource,s.columnMove.rowSource);\\\"columnHeader\\\"===u?(t=s.columnMove.x,e=s.table.isLeftFrozenColumn(o)?s.columnMove.colTarget>=s.columnMove.colSource?s.table.getColsWidth(0,s.columnMove.colTarget):s.table.getColsWidth(0,s.columnMove.colTarget-1):s.table.isRightFrozenColumn(o)?s.table.tableNoFrameWidth-s.table.getColsWidth(d.col+1,s.table.colCount-1):(s.columnMove.colTarget>=s.columnMove.colSource?s.table.getColsWidth(0,s.columnMove.colTarget):s.table.getColsWidth(0,s.columnMove.colTarget-1))-s.table.stateManager.scroll.horizontalBarPos):\\\"rowHeader\\\"!==u&&!s.table.internalProps.layoutMap.isSeriesNumberInBody(o,n)||(r=s.columnMove.y,i=s.table.isFrozenRow(n)?s.columnMove.rowTarget>=s.columnMove.rowSource?s.table.getRowsHeight(0,s.columnMove.rowTarget):s.table.getRowsHeight(0,s.columnMove.rowTarget-1):s.table.isBottomFrozenRow(n)?s.table.tableNoFrameHeight-s.table.getRowsHeight(d.row+1,s.table.rowCount-1):(s.columnMove.rowTarget>=s.columnMove.rowSource?s.table.getRowsHeight(0,s.columnMove.rowTarget):s.table.getRowsHeight(0,s.columnMove.rowTarget-1))-s.table.stateManager.scroll.verticalBarPos),s.table.scenegraph.component.updateMoveCol(t,e,r,i),s.table.fireListeners(TABLE_EVENT_TYPE.CHANGING_HEADER_POSITION,{col:o,row:n,x:a,y:l,backX:t,lineX:e,backY:r,lineY:i,event:h}),s.table.scenegraph.updateNextFrame()}else s.updateCursor(\\\"not-allowed\\\"),s.columnMove.colTarget=s.columnMove.colSource,s.columnMove.rowTarget=s.columnMove.rowSource}}function endMoveCol(t){let e,i,r=!1;if(\\\"canMoveHeaderPosition\\\"in t.table.internalProps.layoutMap&&t.columnMove.moving&&0<=t.columnMove.colSource&&0<=t.columnMove.rowSource&&0<=t.columnMove.colTarget&&0<=t.columnMove.rowTarget&&!0!==(null==(e=t.table.options.customConfig)?void 0:e.notUpdateInColumnRowMove)){var o=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),n=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),a=t.table._moveHeaderPosition({col:t.columnMove.colSource,row:t.columnMove.rowSource},{col:t.columnMove.colTarget,row:t.columnMove.rowTarget});if(!a||a.targetIndex===a.sourceIndex)return t.updateCursor(),t.columnMove.moving=!1,delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget,t.table.scenegraph.component.hideMoveCol(),t.table.scenegraph.updateNextFrame(),!1;{t.table.internalProps.useOneRowHeightFillAll=!1,t.table.internalProps.layoutMap.clearCellRangeMap();var l=t.table.getCellRange(t.columnMove.colSource,t.columnMove.rowSource),s=t.table.getCellRange(t.columnMove.colTarget,t.columnMove.rowTarget),h=Math.min(l.start.col,s.start.col,o.start.col,n.start.col),d=Math.max(l.end.col,s.end.col,o.end.col,n.end.col),u=Math.min(l.start.row,s.start.row,o.start.row,n.start.row);let e=Math.max(l.end.row,s.end.row,o.end.row,n.end.row);\\\"row\\\"===a.moveType&&\\\"tree\\\"===t.table.internalProps.layoutMap.rowHierarchyType&&(e=a.targetIndex>a.sourceIndex?e+a.targetSize-1:e+a.sourceSize-1),!t.table.transpose&&t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)&&(t.table.changeRecordOrder(a.sourceIndex,a.targetIndex),t.changeCheckboxAndRadioOrder(a.sourceIndex,a.targetIndex)),\\\"column\\\"===a.moveType?clearWidthsAndHeightsCache(h,d,0,-1,t.table):clearWidthsAndHeightsCache(0,-1,u,e,t.table),t.table.clearCellStyleCache(),t.table.internalProps.layoutMap.isSeriesNumberInBody(t.columnMove.colSource,t.columnMove.rowSource)?t.table.scenegraph.updateHeaderPosition(t.table.scenegraph.proxy.colStart,t.table.scenegraph.proxy.colEnd,t.table.scenegraph.proxy.rowStart,t.table.scenegraph.proxy.rowEnd,a.moveType):\\\"column\\\"===a.moveType?t.table.scenegraph.updateHeaderPosition(h,d,0,-1,a.moveType):t.table.scenegraph.updateHeaderPosition(0,-1,u,e,a.moveType),\\\"adjustFrozenCount\\\"===t.table.internalProps.frozenColDragHeaderMode&&t.table.isListTable()&&(t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&!t.table.isLeftFrozenColumn(t.columnMove.colSource)?t.table.frozenColCount+=l.end.col-l.start.col+1:t.table.isLeftFrozenColumn(t.columnMove.colSource)&&!t.table.isLeftFrozenColumn(t.columnMove.colTarget)&&(t.table.frozenColCount-=l.end.col-l.start.col+1),t.table.isRightFrozenColumn(t.columnMove.colTarget)&&!t.table.isRightFrozenColumn(t.columnMove.colSource)?t.table.rightFrozenColCount+=l.end.col-l.start.col+1:t.table.isRightFrozenColumn(t.columnMove.colSource)&&!t.table.isRightFrozenColumn(t.columnMove.colTarget)&&(t.table.rightFrozenColCount-=l.end.col-l.start.col+1)),r=!0}}return t.columnMove.moving=!1,setTimeout(()=>{delete t.columnMove.colSource,delete t.columnMove.rowSource,delete t.columnMove.colTarget,delete t.columnMove.rowTarget},0),t.table.scenegraph.component.hideMoveCol(),t.columnResize.col<t.table.frozenColCount&&!t.table.isPivotTable()&&!t.table.transpose?(t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount)):t.columnResize.col>=t.table.colCount-t.table.rightFrozenColCount&&!t.table.isPivotTable()&&!t.table.transpose?t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount):t.table.options.frozenColCount?t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1):t.table.options.rightFrozenColCount&&t.table.scenegraph.component.setRightFrozenColumnShadow(t.table.colCount-t.table.rightFrozenColCount),t.table.scenegraph.updateNextFrame(),!0===(null==(i=t.table.options.customConfig)?void 0:i.notUpdateInColumnRowMove)||r}function clearWidthsAndHeightsCache(e,t,i,r,o){for(let n=e;n<=t;n++)o._clearColRangeWidthsMap(n);for(let a=i;a<=r;a++)o._clearRowRangeHeightsMap(a)}function getIconAndPositionFromTarget(e){var t;return e&&(t=null!=(t=e.role)&&t.startsWith(\\\"icon\\\")?e:\\\"richtext\\\"===e.type?e._currentHoverIcon:void 0)?\\\"richtext\\\"===e.type?{icon:t,position:{left:e.globalAABBBounds.x1+t.globalAABBBounds.x1,right:e.globalAABBBounds.x1+t.globalAABBBounds.x2,top:e.globalAABBBounds.y1+t.globalAABBBounds.y1,bottom:e.globalAABBBounds.y1+t.globalAABBBounds.y2,width:t.globalAABBBounds.x2-t.globalAABBBounds.x1,height:t.globalAABBBounds.y2-t.globalAABBBounds.y1},type:\\\"richtext-icon\\\"}:{icon:t,position:{left:t.globalAABBBounds.x1,right:t.globalAABBBounds.x2,top:t.globalAABBBounds.y1,bottom:t.globalAABBBounds.y2,width:t.globalAABBBounds.x2-t.globalAABBBounds.x1,height:t.globalAABBBounds.y2-t.globalAABBBounds.y1},type:\\\"icon\\\"}:void 0}function updateResizeColumn(e,t,i){e=Math.ceil(e),t=Math.ceil(t);let r=i.columnResize.isRightFrozen?i.columnResize.x-e:e-i.columnResize.x;if(!(Math.abs(r)<1)){var o=i.table.getColWidth(i.columnResize.col),n=o,a=(n+=r,i.table.getMinColWidth(i.columnResize.col)),l=i.table.getMaxColWidth(i.columnResize.col);if(n<a||l<n){if(o===a||o===l)return;r=l-o<o-a?l-o:a-o}if(i.table.getColWidth(i.columnResize.col)+r<i.table.internalProps.limitMinWidth&&(n=i.table.internalProps.limitMinWidth,r=n-i.table.getColWidth(i.columnResize.col)),\\\"adaptive\\\"===i.table.widthMode&&i.columnResize.col<i.table.colCount-1){l=i.table.getColWidth(i.columnResize.col+1),a=i.table.getMinColWidth(i.columnResize.col+1),o=i.table.getMaxColWidth(i.columnResize.col+1),n=l;if((n-=r)<a||o<n){if(l===a||l===o)return;r=o-l<l-a?o-l:a-l}n-r<i.table.internalProps.limitMinWidth&&(r=n-i.table.internalProps.limitMinWidth)}r=Math.ceil(r),(i.columnResize.col<i.table.rowHeaderLevelCount||i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount?updateResizeColForColumn:\\\"indicator\\\"===i.table.internalProps.columnResizeType?updateResizeColForIndicator:\\\"indicatorGroup\\\"===i.table.internalProps.columnResizeType?updateResizeColForIndicatorGroup:\\\"all\\\"===i.table.internalProps.columnResizeType?updateResizeColForAll:updateResizeColForColumn)(r,i),i.columnResize.x=e,i.table.scenegraph.component.updateResizeCol(i.columnResize.col,t,i.columnResize.isRightFrozen),i.columnResize.col<i.table.frozenColCount&&!i.table.isPivotTable()&&!i.table.transpose?i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1,i.columnResize.isRightFrozen):i.table.options.frozenColCount&&i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1),(i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount&&!i.table.isPivotTable()&&!i.table.transpose||i.table.options.rightFrozenColCount)&&i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount),i.table.scenegraph.updateNextFrame()}}function updateResizeColForColumn(e,t){\\\"adaptive\\\"===t.table.widthMode&&t.columnResize.col<t.table.colCount-1?(t.table.scenegraph.updateColWidth(t.columnResize.col,e),t.table.scenegraph.updateColWidth(t.columnResize.col+1,-e),t.table.internalProps._widthResizedColMap.add(t.columnResize.col),t.table.internalProps._widthResizedColMap.add(t.columnResize.col+1)):(t.table.scenegraph.updateColWidth(t.columnResize.col,e),t.table.internalProps._widthResizedColMap.add(t.columnResize.col))}function updateResizeColForAll(e,t){var i=t.table.internalProps.layoutMap;for(let o=t.table.frozenColCount;o<t.table.colCount-t.table.rightFrozenColCount;o++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!i.indicatorsAsCol)){var r=i.getBody(o,t.table.columnHeaderLevelCount);if(null!=r&&r.disableColumnResize)continue}t.table.scenegraph.updateColWidth(o,e),t.table.internalProps._widthResizedColMap.add(o)}}function updateResizeColForIndicator(e,t){var i,r=t.table.internalProps.layoutMap;let o,n,a;r.indicatorsAsCol?o=r.getIndicatorKey(t.columnResize.col,t.table.columnHeaderLevelCount):(i=(i=r.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount-1)).colHeaderPaths[i.colHeaderPaths.length-1],n=i.dimensionKey,a=i.value);for(let s=t.table.rowHeaderLevelCount;s<t.table.colCount-t.table.rightFrozenColCount;s++){var l=r.getIndicatorKey(s,t.table.columnHeaderLevelCount);r.indicatorsAsCol&&l===o?(t.table.scenegraph.updateColWidth(s,e),t.table.internalProps._widthResizedColMap.add(s)):r.indicatorsAsCol||(l=null==(l=r.getCellHeaderPaths(s,t.table.columnHeaderLevelCount-1))?void 0:l.colHeaderPaths[l.colHeaderPaths.length-1])&&n===l.dimensionKey&&a===l.value&&(t.table.scenegraph.updateColWidth(s,e),t.table.internalProps._widthResizedColMap.add(s))}}function updateResizeColForIndicatorGroup(e,t){var i=t.table.internalProps.layoutMap,r=i.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount),r=i.getHeadNodeByRowOrColDimensions(r.colHeaderPaths.slice(0,r.colHeaderPaths.length-1)),o=r.startInTotal+t.table.frozenColCount,n=r.startInTotal+t.table.frozenColCount+r.size-1,a=t.table.getColsWidth(o,n),l=e;for(let h=o;h<=n;h++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!i.indicatorsAsCol)){var s=i.getBody(h,t.table.columnHeaderLevelCount);if(null!=s&&s.disableColumnResize)continue}let e=t.table.getColWidth(h)/a*l;0<e&&e<.5?e=.5:e<0&&-.5<=e&&(e=-.5),t.table.scenegraph.updateColWidth(h,e),t.table.internalProps._widthResizedColMap.add(h)}}function setRadioState(e,t,i,r,o,n){var a=n.table.getRecordShowIndexByCell(e,t);0<=a&&(a=n.table.dataSource.getIndexKey(a),\\\"column\\\"===r?isNumber_default(o)?(n.radioState[i]={},n.radioState[i][a]=o):n.radioState[i]=a:(n.radioState[i]||(n.radioState[i]={}),isNumber_default(o)?n.radioState[i][a]=o:n.radioState[i][a]=!0))}function getCellRadioState(e,t,i){var r=i.getBodyColumnDefine(e,t),r=null==r?void 0:r.field,o=i.getCellType(e,t);if(isValid_default(r)&&\\\"radio\\\"===o){o=i.dataSource.getIndexKey(i.getRecordShowIndexByCell(e,t)),r=null==(n=i.stateManager.radioState)?void 0:n[r];if(isNumber_default(r)){if(r===o)return!0}else if(isObject_default(r)){var n=r[o];if(isNumber_default(n))return n}}return!1}function syncRadioState(e,t,i,r,o,n,a){var l,s=a.table.getRecordShowIndexByCell(e,t);if(0<=s){s=a.table.dataSource.getIndexKey(s);if(\\\"column\\\"===r){if(!isValid_default(a.radioState[i])&&n)return isNumber_default(o)?(a.radioState[i]={},a.radioState[i][s]=o):a.radioState[i]=s,!0;if(isNumber_default(a.radioState[i])&&!isNumber_default(o))return a.radioState[i]===s;if(isNumber_default(a.radioState[i])&&isNumber_default(o))return!1;if(isObject_default(a.radioState[i])&&!isNumber_default(o))return!1;if(isObject_default(a.radioState[i])&&isNumber_default(o))return a.radioState[i][s]===o}else if(\\\"cell\\\"===r){if(!isValid_default(a.radioState[i])&&n)return a.radioState[i]={},isNumber_default(o)?a.radioState[i][s]=o:a.radioState[i][s]=!0,!0;if(!isValid_default(null==(l=a.radioState[i])?void 0:l[s])&&n)return isNumber_default(o)?a.radioState[i][s]=o:a.radioState[i][s]=!0,!0;if(isBoolean_default(null==(l=a.radioState[i])?void 0:l[s])&&!isNumber_default(o))return a.radioState[i][s];if(isBoolean_default(null==(l=a.radioState[i])?void 0:l[s])&&isNumber_default(o))return!1;if(isNumber_default(null==(l=a.radioState[i])?void 0:l[s])&&!isNumber_default(o))return!1;if(isNumber_default(null==(l=a.radioState[i])?void 0:l[s])&&isNumber_default(o))return a.radioState[i][s]===o}}return n}function setCellRadioState(e,t,i,r){var o,n=r.scenegraph.getCell(e,t);n&&(isNumber_default(i)?null!=(o=n.getChildAt(i))&&o._handlePointerUp():null!=(o=n.getChildByName(\\\"radio\\\"))&&o._handlePointerUp())}function changeRadioOrder(t,i,e){var{radioState:r,table:o}=e;if((i=o.internalProps.transpose?(t=o.getRecordShowIndexByCell(t,0),o.getRecordShowIndexByCell(i,0)):(t=o.getRecordShowIndexByCell(0,t),o.getRecordShowIndexByCell(0,i)))<t){o=r[t];for(let e=t;e>i;e--)r[e]=r[e-1];r[i]=o}else if(t<i){o=r[t];for(let e=t;e<i;e++)r[e]=r[e+1];r[i]=o}}function setCheckedState(e,t,i,r,o){var n=o.table.getRecordShowIndexByCell(e,t);0<=n&&(n=o.table.dataSource.getIndexKey(n).toString(),o.checkedState.has(n)?o.checkedState.get(n)[i]=r:o.checkedState.set(n,{[i]:r}))}function setHeaderCheckedState(t,i,e){var r;e.headerCheckedState[t]=i,null!=(r=e.checkedState)&&r.forEach(e=>{e[t]=i})}function syncCheckedState(e,t,i,r,o){var n;if(o.table.isHeader(e,t)){if(!isValid_default(o.headerCheckedState[i])){if(\\\"function\\\"==typeof r)return;if(isValid_default(r))o.headerCheckedState[i]=r;else if(0<(null==(a=o.checkedState)?void 0:a.size))return o.updateHeaderCheckedState(i,e,t)}return o.headerCheckedState[i]}var a=o.table.getRecordShowIndexByCell(e,t);if(0<=a){a=o.table.dataSource.getIndexKey(a).toString();if(isValid_default(null==(n=o.checkedState.get(a))?void 0:n[i]))return o.checkedState.get(a)[i];o.checkedState.has(a)?o.checkedState.get(a)[i]=r:o.checkedState.set(a,{[i]:r})}return r}function initCheckedState(e,r){r.checkedState.clear(),r.headerCheckedState={};let o=!(r.radioState={});if(r._checkboxCellTypeFields=[],r._headerCheckFuncs={},r.table.internalProps.layoutMap.headerObjects.forEach((e,t)=>{var i;\\\"checkbox\\\"===e.headerType&&(null==(i=e.define.checked)||\\\"function\\\"==typeof i?(o=!0,\\\"function\\\"==typeof i&&(r._headerCheckFuncs[e.field]=i)):r.headerCheckedState[e.field]=i,\\\"checkbox\\\"!==e.define.cellType&&!isFunction_default(e.define.cellType)||e.fieldFormat||r._checkboxCellTypeFields.push(e.field))}),1===r.table.leftRowSeriesNumberCount)r.headerCheckedState._vtable_rowSeries_number=!1,r._checkboxCellTypeFields.push(\\\"_vtable_rowSeries_number\\\"),o=!0;else if(1<r.table.leftRowSeriesNumberCount){for(let e=0;e<r.table.leftRowSeriesNumberCount;e++)r.headerCheckedState[\\\"_vtable_rowSeries_number_\\\"+e]=!1,r._checkboxCellTypeFields.push(\\\"_vtable_rowSeries_number_\\\"+e);o=!0}o&&initRecordCheckState(e,r)}function updateHeaderCheckedState(o,n,a,l){let s=!0,h=!0,d=!1;return n.checkedState.forEach((e,t)=>{t=t.includes(\\\",\\\")?t.split(\\\",\\\").map(e=>Number(e)):Number(t);var i=n.table.getTableIndexByRecordIndex(t),i=n.table.transpose?n.table.getCustomMerge(i,l):n.table.getCustomMerge(a,i),r=null==(r=n.table.dataSource)?void 0:r.get(t);i||(null==(i=n.table.internalProps.rowSeriesNumber)||!i.enableTreeCheckbox)&&null!=r&&r.vtableMerge||(!0!==(null==e?void 0:e[o])?s=!1:(h=!1,d=!0))}),s?(n.headerCheckedState[o]=!0,s):h?n.headerCheckedState[o]=!1:!!d&&(n.headerCheckedState[o]=\\\"indeterminate\\\")}function initLeftRecordsCheckState(e,r){for(let o=r.checkedState.size;o<e.length;o++){const n=e[o];r._checkboxCellTypeFields.forEach(e=>{var t=n[e];let i;isObject_default(t)?i=t.checked:\\\"boolean\\\"==typeof t&&(i=t);t=o.toString();r.checkedState.get(t)||r.checkedState.set(t,{}),r.checkedState.get(t)[e]=i})}}function setCellCheckboxState(e,t,i,r){var o,n,a=r.scenegraph.getCell(e,t),a=null==a?void 0:a.getChildByName(\\\"checkbox\\\");a?(({checked:o,indeterminate:n}=a.attribute),n?(i||a._handlePointerUp(),a._handlePointerUp()):o?i||a._handlePointerUp():i&&a._handlePointerUp()):(n=r.getHeaderField(e,t),r.isHeader(e,t)?(r.stateManager.setHeaderCheckedState(n,i),\\\"checkbox\\\"===r.getCellType(e,t)&&r.scenegraph.updateCheckboxCellState(e,t,i)):(r.stateManager.setCheckedState(e,t,n,i),\\\"checkbox\\\"===r.getCellType(e,t)&&r.stateManager.headerCheckedState[n]!==(o=r.stateManager.updateHeaderCheckedState(n,e,t))&&r.scenegraph.updateHeaderCheckboxCellState(e,t,o)))}function setCellCheckboxStateByAttribute(e,t,i,r){var o=r.scenegraph.getCell(e,t),o=null==o?void 0:o.getChildByName(\\\"checkbox\\\");o&&(\\\"indeterminate\\\"===i?(o.setAttribute(\\\"indeterminate\\\",!0),o.setAttribute(\\\"checked\\\",void 0)):(o.setAttribute(\\\"indeterminate\\\",void 0),o.setAttribute(\\\"checked\\\",i)))}function changeCheckboxOrder(t,i,e){var{checkedState:r,table:o}=e;let n,a;if(o.internalProps.transpose?(t=o.getRecordShowIndexByCell(t,0),i=o.getRecordShowIndexByCell(i,0)):(n=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,t),a=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,i)),isNumber_default(n)&&isNumber_default(a)){if(i<t){o=r.get(t.toString());for(let e=t;e>i;e--)r.set(e.toString(),r.get((e-1).toString()));r.set(i.toString(),o)}else if(t<i){o=r.get(t.toString());for(let e=t;e<i;e++)r.set(e.toString(),r.get((e+1).toString()));r.set(i.toString(),o)}}else if(isArray_default(n)&&isArray_default(a))if((t=n[n.length-1])>(i=a[a.length-1])){o=r.get(n.toString());for(let e=t;e>i;e--){var l=[...n],s=(l[l.length-1]=e,[...n]);s[s.length-1]=e-1,r.set(l.toString(),r.get(s.toString()))}r.set(a.toString(),o)}else if(t<i){o=r.get(n.toString());for(let e=t;e<i;e++){var h=[...n],d=(h[h.length-1]=e,[...n]);d[d.length-1]=e+1,r.set(h.toString(),r.get(d.toString()))}r.set(a.toString(),o)}}function getGroupCheckboxState(r){const o=[],n=r.dataSource,a=n.dataConfig.groupByRules.length+1;return n.currentIndexedData.forEach((e,t)=>{var i;isArray_default(e)&&e.length===a&&(i=n.getOriginRecordIndexForGroup(e),o[i]=r.stateManager.checkedState.get(e.toString()))}),o}function initRecordCheckState(e,n){const a=n.table,t=a.isPivotTable()?0:a.internalProps.transpose?a.rowHeaderLevelCount:a.columnHeaderLevelCount,i=a.isPivotTable()?isArray_default(e)?e.length:0:a.internalProps.transpose?a.colCount:a.rowCount;for(let l=0;l+t<i;l++){const s=a.isPivotTable()?e[l]:a.dataSource.get(l);n._checkboxCellTypeFields.forEach(e=>{var t,i=s&&s[e];let r;isObject_default(i)?r=i.checked:\\\"boolean\\\"==typeof i&&(r=i),null==r&&(o=n._headerCheckFuncs[e])&&(t=n.table.getCellAddrByFieldRecord(e,l),r=getOrApply(o,{col:t.col,row:t.row,table:n.table,context:null,value:i}));var o=(a.isPivotTable()?l:n.table.dataSource.getIndexKey(l)).toString();n.checkedState.get(o)||n.checkedState.set(o,{}),n.checkedState.get(o)[e]=r})}}function updateResizeRow(e,t,i){e=Math.ceil(e),t=Math.ceil(t);let r=i.rowResize.isBottomFrozen?i.rowResize.y-t:t-i.rowResize.y;var o;Math.abs(r)<1||(i.table.getRowHeight(i.rowResize.row),r,(o=i.table.getRowHeight(i.rowResize.row)+r)<i.table.internalProps.limitMinHeight&&(o=i.table.internalProps.limitMinHeight,r=o-i.table.getRowHeight(i.rowResize.row)),\\\"adaptive\\\"===i.table.heightMode&&i.rowResize.row<i.table.rowCount-1&&(o=i.table.getRowHeight(i.rowResize.row+1),(o-=r)-r<i.table.internalProps.limitMinHeight)&&(r=o-i.table.internalProps.limitMinHeight),r=Math.ceil(r),(i.rowResize.row<i.table.columnHeaderLevelCount||i.rowResize.row>=i.table.rowCount-i.table.bottomFrozenRowCount?updateResizeColForRow:\\\"indicator\\\"===i.table.internalProps.rowResizeType?updateResizeColForIndicator2:\\\"indicatorGroup\\\"===i.table.internalProps.rowResizeType?updateResizeColForIndicatorGroup2:\\\"all\\\"===i.table.internalProps.rowResizeType?updateResizeColForAll2:updateResizeColForRow)(r,i),i.rowResize.y=t,i.table.scenegraph.component.updateResizeRow(i.rowResize.row,e,i.rowResize.isBottomFrozen),i.table.scenegraph.updateNextFrame())}function updateResizeColForRow(e,t){\\\"adaptive\\\"===t.table.heightMode&&t.rowResize.row<t.table.rowCount-1?(t.table.scenegraph.updateRowHeight(t.rowResize.row,e),t.table.scenegraph.updateRowHeight(t.rowResize.row+1,-e),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row+1)):(t.table.scenegraph.updateRowHeight(t.rowResize.row,e),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row))}function updateResizeColForAll2(e,t){for(let i=t.table.frozenRowCount;i<t.table.rowCount-t.table.bottomFrozenRowCount;i++)t.table.scenegraph.updateRowHeight(i,e),t.table.internalProps._heightResizedRowMap.add(i)}function updateResizeColForIndicator2(e,t){var i,r,o,n=t.table.internalProps.layoutMap;let a,l,s;n.indicatorsAsCol?(o=null==(i=(o=n.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,t.rowResize.row)).rowHeaderPaths)?void 0:i[o.rowHeaderPaths.length-1],l=null==o?void 0:o.dimensionKey,s=null==o?void 0:o.value):a=n.getIndicatorKey(t.table.rowHeaderLevelCount,t.rowResize.row);for(let d=t.table.columnHeaderLevelCount;d<t.table.rowCount-t.table.bottomFrozenRowCount;d++){var h=n.getIndicatorKey(t.table.rowHeaderLevelCount,d);(!n.indicatorsAsCol&&h===a||n.indicatorsAsCol&&(h=null==(r=null==(h=n.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,d))?void 0:h.rowHeaderPaths)?void 0:r[h.rowHeaderPaths.length-1])&&l===h.dimensionKey&&s===h.value)&&(t.table.scenegraph.updateRowHeight(d,e),t.table.internalProps._heightResizedRowMap.add(d))}}function updateResizeColForIndicatorGroup2(e,t){var i=t.table.internalProps.layoutMap,r=i.getCellHeaderPaths(t.table.rowHeaderLevelCount,t.rowResize.row),r=i.getHeadNodeByRowOrColDimensions(r.rowHeaderPaths.slice(0,r.rowHeaderPaths.length-1)),i=r.startInTotal+t.table.frozenRowCount,o=r.startInTotal+t.table.frozenRowCount+r.size-1,n=t.table.getRowsHeight(i,o),a=e;for(let l=i;l<=o;l++){let e=t.table.getRowHeight(l)/n*a;0<e&&e<.5?e=.5:e<0&&-.5<=e&&(e=-.51),t.table.scenegraph.updateRowHeight(l,e),t.table.internalProps._heightResizedRowMap.add(l)}}function deletaCustomSelectRanges(e){var t=e.table.scenegraph.customSelectedRangeComponents;t.forEach((e,t)=>{e.rect[\\\"delete\\\"]()}),t.clear(),e.select.customSelectRanges=[]}function addCustomSelectRanges(e,t){let o=t.table.scenegraph.customSelectedRangeComponents;e.forEach(e=>{var t,{range:i,style:r}=e,r=createRect({fill:null!=(t=r.cellBgColor)&&t,stroke:null!=(t=r.cellBorderColor)&&t,lineWidth:null!=(t=r.cellBorderLineWidth)?t:0,lineDash:null!=(t=r.cellBorderLineDash)?t:[],pickable:!1});o.set(`${i.start.col}-${i.start.row}-${i.end.col}-`+i.end.row,{rect:r,role:\\\"body\\\"})}),t.select.customSelectRanges=e,updateAllSelectComponent(t.table.scenegraph),t.table.scenegraph.updateNextFrame()}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var StateManager=class{constructor(e){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=debounce2(e=>{this.updateInteractionState(null!=e?e:InteractionState[\\\"default\\\"])},100),this.table=e,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=InteractionState[\\\"default\\\"],this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new Bounds,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:\\\"normal\\\"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=InteractionState[\\\"default\\\"],this.select={highlightScope:HighlightScope.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:HighlightScope.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new Bounds,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:\\\"normal\\\"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var{highlightMode:e,disableHover:t,disableHeaderHover:i}=null!=(e=this.table.options.hover)?e:{highlightMode:\\\"cell\\\"};t?this.hover.highlightScope=HighlightScope.none:\\\"cross\\\"===e?this.hover.highlightScope=HighlightScope.cross:\\\"row\\\"===e?this.hover.highlightScope=HighlightScope.row:\\\"column\\\"===e?this.hover.highlightScope=HighlightScope.column:\\\"cell\\\"===e&&(this.hover.highlightScope=HighlightScope.single),this.hover.singleStyle=!t,this.hover.disableHeader=i,this.hover.highlightScope!==HighlightScope.none&&!i||(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var{headerSelectMode:e,disableSelect:t,disableHeaderSelect:i,highlightMode:r,highlightInRange:o}=Object.assign({},{headerSelectMode:\\\"inline\\\",disableSelect:!1,disableHeaderSelect:!1,highlightMode:\\\"cell\\\",highlightInRange:!1},this.table.options.select);this.select.highlightScope=!0===t?HighlightScope.none:\\\"cross\\\"===r?HighlightScope.cross:\\\"row\\\"===r?HighlightScope.row:\\\"column\\\"===r?HighlightScope.column:HighlightScope.single,this.select.singleStyle=!t,this.select.disableHeader=i,this.select.headerSelectMode=e,this.select.highlightInRange=o,this.select.disableCtrlMultiSelect=!1===(null==(r=this.table.options.keyboardOptions)?void 0:r.ctrlMultiSelect)}isSelected(t,i){let r=!1;return this.select.ranges.forEach(e=>{cellInRange(e,t,i)&&(r=!0)}),r}setSortState(e){const n=this;var t=(e=!e||Array.isArray(e)?e:[e])&&e.reduce((e,t)=>{var i,r=null==(r=function(e){const r=[];return function o(e,i=0){e.forEach(e=>{var t=e.startInTotal?null!==(t=e.startInTotal+n.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?t:0:i;e.columns?o(e.columns,t):r.push(Object.assign(Object.assign({},e),{startIndex:t}))})}(e),r}(this.table.internalProps.columns))?void 0:r.find(e=>(null==e?void 0:e.field)===(null==t?void 0:t.field));return this.table.internalProps.transpose?e.push({field:t.field,order:t.order,row:null!==(i=(null==r?void 0:r.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?i:0,col:null==r?void 0:r.level}):e.push({field:t.field,order:t.order,col:null!==(i=(null==r?void 0:r.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?i:0,row:null==r?void 0:r.level}),e},[]);this.sort=t||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(e){var t;this.interactionState!==e&&(e===InteractionState.scrolling&&(this.interactionStateBeforeScroll=this.interactionState),t=this.interactionState,this.interactionState=e,t===InteractionState.scrolling)&&InteractionState[\\\"default\\\"]}updateHoverhighlightScope(e){this.hover.highlightScope!==e&&(this.hover.highlightScope=e)}updateHoverPos(e,t){updateHoverPosition(this,e,t)}updateSelectPos(e,t,i=!1,r=!1,o=!1,n=!0,a=!1){-1!==t&&(this.select.selecting=!0),updateSelectPosition(this,e=(e=e<0?-1:e)>this.table.colCount-1?this.table.colCount-1:e,t=(t=t<0?-1:t)>this.table.rowCount-1?this.table.rowCount-1:t,i,r,o,n,a)}checkCellRangeInSelect(e,t){return checkMultiCellInSelect(e,t,this.select.ranges,this.select.highlightScope)}updateHoverIcon(e,t,i,r){var o,n,a;null!=(o=this.residentHoverIcon)&&o.icon&&i===(null==(o=this.residentHoverIcon)?void 0:o.icon)||((o=getIconAndPositionFromTarget(i))?\\\"richtext-icon\\\"===o.type?(a=o.icon,this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(n=this.residentHoverIcon)?void 0:n.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),a.attribute.tooltip&&(n={content:a.attribute.tooltip.title,referencePosition:{rect:o.position,placement:a.attribute.tooltip.placement},style:Object.assign({},null==(n=this.table.internalProps.theme)?void 0:n.tooltipStyle,null==(n=a.tooltip)?void 0:n.style,null==(n=null==(n=a.attribute)?void 0:n.tooltip)?void 0:n.style),disappearDelay:a.attribute.tooltip.disappearDelay},this.table.internalProps.tooltipHandler.isBinded(n)||this.table.showTooltip(e,t,n))):(a=o.icon)!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(n=this.residentHoverIcon)?void 0:n.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=e,this.hoverIcon.row=t,this.hoverIcon.icon=a,this.table.scenegraph.setIconHoverStyle(a,e,t,r),this.table.scenegraph.updateNextFrame()):this.hoverIcon.icon&&this.hoverIcon.icon!==(null==(o=this.residentHoverIcon)?void 0:o.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()))}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(i=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,0!==this.select.ranges.length){var r=this.select.ranges[this.select.ranges.length-1];this.table.isSeriesNumber(this.select.cellPos.col,this.select.cellPos.row)||this.table.isHeader(this.select.cellPos.col,this.select.cellPos.row)||expendCellRange(r,this.table);let e=!1;for(let t=0;t<this.select.ranges.length-1;t++){var o=this.select.ranges[t];if(o&&o.start.col===r.start.col&&o.start.row===r.start.row&&o.end.col===r.end.col&&o.end.row===r.end.row){e=!0;break}}e?(this.select.ranges.pop(),deleteAllSelectingBorder(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):selectEnd(this.table.scenegraph);var n=this.select.ranges[this.select.ranges.length-1].end.col,a=this.select.ranges[this.select.ranges.length-1].end.row;i&&this.table.fireListeners(TABLE_EVENT_TYPE.SELECTED_CELL,{ranges:this.select.ranges,col:n,row:a})}}else e&&0===this.select.ranges.length&&this.table.fireListeners(TABLE_EVENT_TYPE.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(e,t,i,r){this.columnResize.resizing=!0,this.columnResize.col=e,this.columnResize.x=t,this.columnResize.isRightFrozen=r,this.table.scenegraph.component.showResizeCol(e,i,r),this.table.scenegraph.updateNextFrame()}updateResizeCol(e,t){updateResizeColumn(e,t,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(e,t,i,r){this.rowResize.resizing=!0,this.rowResize.row=e,this.rowResize.y=i,this.rowResize.isBottomFrozen=r,this.table.scenegraph.component.showResizeRow(e,t,r),this.table.scenegraph.updateNextFrame()}updateResizeRow(e,t){updateResizeRow(e,t,this)}startFillSelect(e,t){this.fillHandle.isFilling=!0,this.fillHandle.startX=e,this.fillHandle.startY=t;var i=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(i.start.col,i.end.col),this.fillHandle.beforeFillMinRow=Math.min(i.start.row,i.end.row),this.fillHandle.beforeFillMaxCol=Math.max(i.start.col,i.end.col),this.fillHandle.beforeFillMaxRow=Math.max(i.start.row,i.end.row),this.table.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;var e=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),t=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),i=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),r=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===e&&this.fillHandle.beforeFillMinRow===t&&this.fillHandle.beforeFillMaxCol===i&&this.fillHandle.beforeFillMaxRow===r||this.table.eventManager.isDraging&&this.table.fireListeners(TABLE_EVENT_TYPE.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(e,t,i,r,o){startMoveCol(e,t,i,r,this,o)}updateMoveCol(e,t,i,r,o){updateMoveCol(e,t,i,r,this,o)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return endMoveCol(this)}checkFrozen(){let e,t=this.table.options.frozenColCount||(this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?(null!=(e=this.table.rowHeaderLevelCount)?e:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0);var i;t&&(t>this.table.colCount&&(t=this.table.colCount),i=this.table._getMaxFrozenWidth(),this.table.getColsWidth(0,t-1)>i?this.table.internalProps.unfreezeAllOnExceedsMaxWidth?(this.table._setFrozenColCount(0),this.setFrozenCol(-1)):(i=this.table._getComputedFrozenColCount(t),this.table._setFrozenColCount(i),this.setFrozenCol(i)):this.table.frozenColCount!==t&&(this.table._setFrozenColCount(t),this.setFrozenCol(t)))}setFrozenCol(e){e!==this.frozen.col&&(this.frozen.col=e,this.table.scenegraph.updateFrozen()),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(e){e!==this.frozen.row&&(this.frozen.row=e,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var e=this.table.getAllRowsHeight(),t=this.scroll.verticalBarPos,i=this.table.tableNoFrameHeight;e<=t+i&&this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL_VERTICAL_END,{scrollTop:t,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(t=this.table.theme.scrollStyle)?void 0:t.width,viewHeight:i,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var e=this.table.getAllColsWidth(),t=this.scroll.horizontalBarPos,i=this.table.tableNoFrameWidth;e<=t+i&&this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:t,scrollHeight:null==(e=this.table.theme.scrollStyle)?void 0:e.width,scrollWidth:null==(t=this.table.theme.scrollStyle)?void 0:t.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:i})}updateVerticalScrollBar(e){var t=this.table.getAllRowsHeight(),i=this.scroll.verticalBarPos;let r=Math.ceil(e*(t-this.table.scenegraph.height));var o,n=(r=isValid_default(r)&&!isNaN(r)?r:0)-this.table.scenegraph.proxy.deltaY-i;this.table.fireListeners(TABLE_EVENT_TYPE.CAN_SCROLL,{event:void 0,scrollTop:r-this.table.scenegraph.proxy.deltaY,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(o=this.table.theme.scrollStyle)?void 0:o.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"vertical\\\",scrollRatioY:e,dy:n}).some(e=>!1===e)?(o=this.scroll.verticalBarPos/(t-this.table.scenegraph.height),this.table.scenegraph.component.updateVerticalScrollBarPos(o)):(this.scroll.verticalBarPos=r,this.table.scenegraph.setY(-this.scroll.verticalBarPos,1===e),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"vertical\\\",scrollRatioY:e,dy:n}),i!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd())}updateHorizontalScrollBar(e){var t=this.table.getAllColsWidth(),i=this.scroll.horizontalBarPos;let r=Math.ceil(e*(t-this.table.scenegraph.width));var o,n=(r=isValid_default(r)&&!isNaN(r)?r:0)-this.table.scenegraph.proxy.deltaX-i;this.table.fireListeners(TABLE_EVENT_TYPE.CAN_SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:r-this.table.scenegraph.proxy.deltaX,scrollHeight:null==(o=this.table.theme.scrollStyle)?void 0:o.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"horizontal\\\",scrollRatioX:e,dx:n}).some(e=>!1===e)?(o=this.scroll.horizontalBarPos/(t-this.table.scenegraph.width),this.table.scenegraph.component.updateHorizontalScrollBarPos(o)):(this.scroll.horizontalBarPos=r,this.table.scenegraph.setX(-this.scroll.horizontalBarPos,1===e),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(t=this.table.theme.scrollStyle)?void 0:t.width,scrollWidth:null==(o=this.table.theme.scrollStyle)?void 0:o.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"horizontal\\\",scrollRatioX:e,dx:n}),i!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd())}setScrollTop(t,i,e=!0){var r=this.table.getAllRowsHeight(),o=null!=(o=this.table.options.customConfig)&&o._disableColumnAndRowSizeRound?1:0,o=(t=Math.max(0,Math.min(t,r-this.table.scenegraph.height-o)),t=Math.ceil(t),this.scroll.verticalBarPos),n=t/(r-this.table.scenegraph.height);if((o!==t||!0===(null==(l=null==(l=this.table.options)?void 0:l.customConfig)?void 0:l.scrollEventAlwaysTrigger))&&e){let e=t;var a,l=(e=isValid_default(e)&&!isNaN(e)?e:0)-o;if(this.table.fireListeners(TABLE_EVENT_TYPE.CAN_SCROLL,{event:null==i?void 0:i.nativeEvent,scrollTop:e,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(a=this.table.theme.scrollStyle)?void 0:a.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"vertical\\\",scrollRatioY:n,dy:l}).some(e=>!1===e))return a=this.scroll.verticalBarPos/(r-this.table.scenegraph.height),void this.table.scenegraph.component.updateVerticalScrollBarPos(a)}t===this.scroll.verticalBarPos&&!this.table.isPivotChart()||this.updateHoverPos(-1,-1),this.scroll.verticalBarPos=t,isValid_default(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t),this.table.scenegraph.component.updateVerticalScrollBarPos(n);l=this.scroll.verticalBarPos-o;this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL,{event:null==i?void 0:i.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"vertical\\\",scrollRatioY:n,dy:l}),o!==t&&e&&this.checkVerticalScrollBarEnd()}setScrollLeft(t,i,e=!0){this.table.scrollLeft;var r=this.table.getAllColsWidth(),o=(this.table.getFrozenColsWidth(),null!=(o=this.table.options.customConfig)&&o._disableColumnAndRowSizeRound?1:0),o=(t=Math.max(0,Math.min(t,r-this.table.scenegraph.width-o)),t=Math.ceil(t),this.scroll.horizontalBarPos),n=t/(r-this.table.scenegraph.width);if((o!==t||!0===(null==(l=null==(l=this.table.options)?void 0:l.customConfig)?void 0:l.scrollEventAlwaysTrigger))&&e){let e=t;var a,l=(e=isValid_default(e)&&!isNaN(e)?e:0)-o;if(this.table.fireListeners(TABLE_EVENT_TYPE.CAN_SCROLL,{event:null==i?void 0:i.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:e,scrollHeight:null==(a=this.table.theme.scrollStyle)?void 0:a.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"horizontal\\\",scrollRatioX:n,dx:l}).some(e=>!1===e))return a=this.scroll.horizontalBarPos/(r-this.table.scenegraph.width),void this.table.scenegraph.component.updateHorizontalScrollBarPos(a)}t!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1),this.scroll.horizontalBarPos=t,isValid_default(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t),this.table.scenegraph.component.updateHorizontalScrollBarPos(n);l=this.scroll.horizontalBarPos-o;this.table.fireListeners(TABLE_EVENT_TYPE.SCROLL,{event:null==i?void 0:i.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:null==(r=this.table.theme.scrollStyle)?void 0:r.width,scrollWidth:null==(a=this.table.theme.scrollStyle)?void 0:a.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:\\\"horizontal\\\",scrollRatioX:n,dx:l}),o!==t&&e&&this.checkHorizontalScrollBarEnd()}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(e){this.table.scenegraph.component.showVerticalScrollBar(),e&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var e;null!=(e=this.table.scenegraph)&&e.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(e){this.table.scenegraph.component.showHorizontalScrollBar(),e&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var e;null!=(e=this.table.scenegraph)&&e.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(e,t,i,r){this.menu.isShow&&this.menu.x===i&&this.menu.y===r?this.hideMenu():this.showContextMenu(e,t,i,r)}showContextMenu(e,t,i,r){var o;null!=(o=this.table.internalProps.menu)&&o.contextMenuItems&&(\\\"html\\\"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=i,this.menu.y=r,this.table.scenegraph.component.menu.attach(i,r,e,t,MenuType.contextmenu)),this.table.fireListeners(TABLE_EVENT_TYPE.SHOW_MENU,{x:i,y:r,col:e,row:t,type:\\\"contextmenu\\\"}))}triggerDropDownMenu(e,t,i,r,o){this.table.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_ICON_CLICK,{col:e,row:t,event:o}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(e,t,i,r)}showDropDownMenu(e,t,i,r){\\\"html\\\"===this.table.internalProps.menu.renderMode?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(i,r,e,t,MenuType.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(TABLE_EVENT_TYPE.SHOW_MENU,{x:i,y:r,col:e,row:t,type:\\\"dropDown\\\"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);var o=this.table.scenegraph.getCell(e,t);let n;o.forEachChildren(e=>e.attribute.funcType===IconFuncTypeEnum.dropDown&&(n=e,!0)),n&&(this.residentHoverIcon={col:e,row:t,icon:n},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,o),this.table.scenegraph.residentHoverIcon(e,t))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(TABLE_EVENT_TYPE.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon)&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null)}setDropDownMenuHighlight(e){this.menu.dropDownMenuHighlight=e;for(let o=0;o<e.length;o++){var{col:t,row:i}=e[o],r=this.table.getCellRange(t,i);if(r)for(let t=r.start.col;t<=r.end.col;t++)for(let e=r.start.row;e<=r.end.row;e++)this.table.scenegraph.updateCellContent(t,e)}}dropDownMenuIsHighlight(o,n,a){var t=this.menu.dropDownMenuHighlight;if(Array.isArray(t))for(let e=0;e<t.length;e++){var l=t[e];let{col:i,row:r}=l;var{field:l,menuKey:s}=l;if(\\\"number\\\"!=typeof i||\\\"number\\\"!=typeof r)if(this.table.isPivotTable()&&(Array.isArray(l),1)){var h=this.table.internalProps.layoutMap.getPivotCellAdress(l);if(!h)continue;i=h.col,r=h.row}else{h=this.table.internalProps.layoutMap.getHeaderCellAddressByField(l);if(!h)continue;i=h.col,r=h.row}if(isValid_default(i)&&isValid_default(r)&&this.table.isCellRangeEqual(o,n,i,r)){let t=this.table._getHeaderLayoutMap(null!=i?i:o,null!=r?r:n).dropDownMenu||this.table.globalDropDownMenu;if(t=\\\"function\\\"==typeof t?t({row:r,col:i,table:this.table}):t)for(let e=0;e<t.length;e++){var d=t[e];if(isObject_default(d)&&(d.menuKey||d.text)===(s||\\\"\\\")&&e===a)return!0;if(isString_default(d)&&d===s&&e===a)return!0}}}return!1}triggerSort(t,i,e,r){if(this.table.isPivotTable())o=(o=this.table.getPivotSortState(t,i))?o.toUpperCase():\\\"NORMAL\\\",this.table.sort(t,i,\\\"ASC\\\"===o?\\\"DESC\\\":\\\"DESC\\\"===o?\\\"NORMAL\\\":\\\"ASC\\\"),this.table.fireListeners(PIVOT_TABLE_EVENT_TYPE.PIVOT_SORT_CLICK,{col:t,row:i,order:o||\\\"normal\\\",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,i),cellLocation:this.table.getCellLocation(t,i),event:r});else{var o=[...this.sort],n=this.table.internalProps.multipleSort||!o.length?null:this.sort[this.sort.length-1];dealSort(t,i,this.table,r);const a=this.table.getCellRange(t,i),l=this.sort.find(e=>e.col===a.start.col&&e.row===a.start.row),s=this.table.internalProps.multipleSort||!n?null:n.col,h=this.table.internalProps.multipleSort||!n?null:n.row,d=o.findIndex(e=>e.col===t&&e.row===i);0<=d&&o.splice(d,1),this.table.scenegraph.updateSortIcon({col:t,row:i,iconMark:e,order:null==l?void 0:l.order,oldSortCol:s,oldSortRow:h,oldIconMark:null==n?void 0:n.icon}),l&&(l.icon=e),this.table.internalProps.multipleSort||o.forEach(e=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:\\\"normal\\\",oldSortCol:e.col,oldSortRow:e.row,oldIconMark:null})}),this.table.fireListeners(PIVOT_TABLE_EVENT_TYPE.AFTER_SORT,{order:null==l?void 0:l.order,field:this.table.getHeaderField(t,i),event:r})}}updateSortState(e){var t;e=Array.isArray(e)?e:[e];for(let l=0;l<e.length;l++){if(e[l].field===(null==(i=this.sort[l])?void 0:i.field)&&e[e.length-1].order===(null==(i=this.sort[l])?void 0:i.order))return;var i=!this.table.internalProps.multipleSort&&(null==(i=this.sort[l])?void 0:i.col)||null,r=!this.table.internalProps.multipleSort&&(null==(r=this.sort[l])?void 0:r.row)||null,o=(\\\"asc\\\"!==(null==(o=this.sort[l])?void 0:o.order)&&null!=(o=this.sort[l])&&o.order,this.setSortState(e.slice(0,l+1)),this.table.internalProps.layoutMap.getHeaderCellAddressByField(e[l].field)),o=(this.sort[l].col=o.col,this.sort[l].row=o.row,this.table.scenegraph.getCell(this.sort[l].col,this.sort[l].row));let t;traverseObject(o,\\\"children\\\",e=>\\\"sort\\\"===e.attribute.funcType&&(t=e,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[l].col,row:this.sort[l].row,iconMark:t,order:this.sort[l].order,oldSortCol:i,oldSortRow:r,oldIconMark:null==(o=this.sort[l])?void 0:o.icon})}const n=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(t=>{e.some(e=>e.field===t.field)||n.push(t)});for(let s=0;s<n.length;s++){var a=n[s];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:null!==(t=a.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)?t:0,oldSortRow:a.level,oldIconMark:null})}}triggerFreeze(e,t,i){var r;this.table.isPivotTable()||this.table.transpose||(dealFreeze(e,t,this.table),this.table.hasListeners(PIVOT_TABLE_EVENT_TYPE.FREEZE_CLICK)&&(r=this.table.internalProps.layoutMap.columnObjects.slice(0,e+1),this.table.fireListeners(PIVOT_TABLE_EVENT_TYPE.FREEZE_CLICK,{col:e,row:t,fields:r.reduce((e,t)=>e.concat(t.field),[]),colCount:this.table.frozenColCount})),this.frozen.icon=i)}updateCursor(e=\\\"default\\\"){this.table.getElement().style.cursor=e}updateDrillState(e,t,i,r,o,n){this.drill.dimensionKey=e,this.drill.title=t,this.drill.drillDown=i,this.drill.drillUp=r,updateDrill(this.drill.col=o,this.drill.row=n,i,r,this.table)}updateSparklineHoverPose(e,t,i,r){-1!==this.sparkLine.col&&-1!==this.sparkLine.row&&clearChartHover(this.sparkLine.col,this.sparkLine.row,this.table);let o=!1;(o=-1!==e&&-1!==t?updateChartHover(e,t,i,r,this.table):o)?(this.sparkLine.col=e,this.sparkLine.row=t):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(e,t,i,r){return setCheckedState(e,t,i,r,this)}setHeaderCheckedState(e,t){return setHeaderCheckedState(e,t,this)}syncCheckedState(e,t,i,r){return syncCheckedState(e,t,i,r,this)}initCheckedState(e){return initCheckedState(e,this)}updateHeaderCheckedState(e,t,i){return updateHeaderCheckedState(e,this,t,i)}initLeftRecordsCheckState(e){return initLeftRecordsCheckState(e,this)}setRadioState(e,t,i,r,o){setRadioState(e,t,i,r,o,this)}syncRadioState(e,t,i,r,o,n){return syncRadioState(e,t,i,r,o,n,this)}changeCheckboxAndRadioOrder(e,t){this.checkedState.size&&changeCheckboxOrder(e,t,this),this.radioState.length&&changeRadioOrder(e,t,this)}setCustomSelectRanges(e){deletaCustomSelectRanges(this),addCustomSelectRanges(e,this)}};function bindMediaClick(c){\\\"browser\\\"===Env.mode&&c.on(TABLE_EVENT_TYPE.CLICK_CELL,e=>{var{col:i,row:r}=e;if(\\\"image\\\"!==e.target.type||!e.target.role||!e.target.role.startsWith(\\\"icon\\\")){var t=c.internalProps.layoutMap.isHeader(i,r)?(c.isPivotTable()?c._getHeaderLayoutMap(i,r):c.getHeaderDefine(i,r)).headerType:c.getBodyColumnType(i,r),o=c.isHeader(i,r)?c.getHeaderDefine(i,r):c.getBodyColumnDefine(i,r),n=c.getCellValue(i,r),a=c.getCellOriginValue(i,r);if(\\\"link\\\"===t){if(!1!==getOrApply(o.linkJump,{col:i,row:r,table:c,value:n,dataValue:a,cellHeaderPaths:void 0})){var l=o.templateLink;let e,t=getOrApply(o.linkDetect,{col:i,row:r,table:c,value:n,dataValue:a,cellHeaderPaths:void 0});if(t=!1!==t,l){var s=c.getCellOriginRecord(i,r);if(s&&s.vtableMerge)return;const h=Object.assign({__value:n,__dataValue:a},s);e=isFunction_default(l)?l(h,i,r,c):l.replace(/\\\\{\\\\s*(\\\\S+?)\\\\s*\\\\}/g,(e,t)=>h[t])}else{if(t&&!regUrl.test(n))return;e=n}e&&(a=o.linkTarget,s=o.linkWindowFeatures,window.open(e,a,s))}}else if(\\\"image\\\"===t){i=o.clickToPreview;if(!1!==i){const d=document.createElement(\\\"div\\\");d.style.width=\\\"100%\\\",d.style.height=\\\"100%\\\",d.style.position=\\\"absolute\\\",d.style.top=\\\"0\\\",d.style.left=\\\"0\\\",d.style.backgroundColor=\\\"rgba(30, 30, 30, 0.4)\\\",d.style.display=\\\"flex\\\",d.style.justifyContent=\\\"center\\\",d.style.alignItems=\\\"center\\\",d.style.overflow=\\\"hidden\\\",d.style.zIndex=\\\"9999\\\",d.addEventListener(\\\"click\\\",e=>{e.target===d&&document.body.removeChild(d)});r=new Image;r.src=n,r.style.maxWidth=\\\"80%\\\",r.style.maxHeight=\\\"80%\\\",d.appendChild(r),document.body.appendChild(d)}}else if(\\\"video\\\"===t){l=o.clickToPreview;if(!1!==l){const u=document.createElement(\\\"div\\\");u.style.width=\\\"100%\\\",u.style.height=\\\"100%\\\",u.style.position=\\\"absolute\\\",u.style.top=\\\"0\\\",u.style.left=\\\"0\\\",u.style.backgroundColor=\\\"rgba(30, 30, 30, 0.4)\\\",u.style.display=\\\"flex\\\",u.style.justifyContent=\\\"center\\\",u.style.alignItems=\\\"center\\\",u.style.overflow=\\\"hidden\\\",u.style.zIndex=\\\"9999\\\",u.addEventListener(\\\"click\\\",e=>{e.target===u&&document.body.removeChild(u)});a=document.createElement(\\\"video\\\");a.src=n,a.style.maxWidth=\\\"80%\\\",a.style.maxHeight=\\\"80%\\\",a.setAttribute(\\\"preload\\\",\\\"auto\\\"),a.setAttribute(\\\"controls\\\",\\\"true\\\"),u.appendChild(a),document.body.appendChild(u)}}}})}function bindDrillEvent(o){o.on(TABLE_EVENT_TYPE.MOUSEENTER_CELL,e=>{var t,{col:i,row:r}=e;-1!==i&&-1!==r&&(null!=(t=o.internalProps.layoutMap.getHeaderDimension(i,r))&&t.drillDown||null!=t&&t.drillUp?o.stateManager.updateDrillState(t.dimensionKey,t.title,t.drillDown,t.drillUp,i,r):o.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1))}),o.on(TABLE_EVENT_TYPE.MOUSELEAVE_TABLE,e=>{o.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})}function drillClick(e){e.fireListeners(PIVOT_TABLE_EVENT_TYPE.DRILLMENU_CLICK,e.stateManager.drill)}function checkHaveDrill(e){var t=e.internalProps.layoutMap.rowsDefine,i=e.internalProps.layoutMap.columnsDefine;for(let n=0;n<t.length;n++){var r=t[n];if(\\\"string\\\"!=typeof r&&(r.drillDown||r.drillUp))return!0}for(let a=0;a<i.length;a++){var o=i[a];if(\\\"string\\\"!=typeof o&&(o.drillDown||o.drillUp))return!0}return!1}function bindSparklineHoverEvent(n){if(!n.eventManager.bindSparklineHoverEvent){let e=!1;(e=n.isPivotTable()?n.internalProps.layoutMap.indicatorsDefine.some(e=>\\\"string\\\"!=typeof e&&\\\"sparkline\\\"===e.cellType):n.internalProps.layoutMap.columnObjects.some(e=>\\\"sparkline\\\"===e.cellType||\\\"function\\\"==typeof e.cellType))&&(n.eventManager.bindSparklineHoverEvent=!0,n.on(TABLE_EVENT_TYPE.MOUSEMOVE_CELL,e=>{var{col:t,row:i,x:r,y:o}=e;\\\"sparkline\\\"!==n.getBodyColumnType(t,i)&&n.stateManager.updateSparklineHoverPose(-1,-1,0,0),n.stateManager.updateSparklineHoverPose(t,i,r,o)}),n.on(TABLE_EVENT_TYPE.MOUSELEAVE_TABLE,e=>{n.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}}function handleWhell(e,t,i=!0){let r,{deltaX:o,deltaY:n}=e;e.shiftKey&&e.deltaY&&(o=n,n=0);var[a,l]=optimizeScrollXY(o,n,{horizontal:1,vertical:1});(a||l)&&t.interactionState!==InteractionState.scrolling&&t.updateInteractionState(InteractionState.scrolling),a&&(t.setScrollLeft(t.scroll.horizontalBarPos+a,e),t.showHorizontalScrollBar(!0)),l&&(t.setScrollTop(t.scroll.verticalBarPos+l,e),t.showVerticalScrollBar(!0)),i&&t.resetInteractionState(t.interactionStateBeforeScroll),null!=(r=e.nativeEvent)&&r.cancelable&&(\\\"none\\\"===t.table.internalProps.overscrollBehavior||Math.abs(n)>=Math.abs(o)&&0!==n&&isVerticalScrollable(n,t)||Math.abs(n)<=Math.abs(o)&&0!==o&&isHorizontalScrollable(o,t))&&e.nativeEvent.preventDefault()}function optimizeScrollXY(e,t,i){var r=Math.abs(e/t),o=2<r?0:t;return[Math.ceil((r<=.5?0:e)*(null!=(r=i.horizontal)?r:0)),Math.ceil(o*(null!=(r=i.vertical)?r:0))]}function isVerticalScrollable(e,t){return 0!=t.table.getAllRowsHeight()-t.table.scenegraph.height&&!isScrollToTop(e,t)&&!isScrollToBottom(e,t)}function isHorizontalScrollable(e,t){return 0!=t.table.getAllColsWidth()-t.table.scenegraph.width&&!isScrollToLeft(e,t)&&!isScrollToRight(e,t)}function isScrollToTop(e,t){return 0!=t.table.getAllRowsHeight()-t.table.scenegraph.height&&e<=0&&t.scroll.verticalBarPos<1}function isScrollToBottom(e,t){var i=null!=(i=t.table.options.customConfig)&&i._disableColumnAndRowSizeRound?1:0,r=t.table.getAllRowsHeight()-t.table.scenegraph.height;return 0!=r&&0<=e&&Math.abs(t.scroll.verticalBarPos-r)<1+i}function isScrollToLeft(e,t){return 0!=t.table.getAllColsWidth()-t.table.scenegraph.width&&e<=0&&t.scroll.horizontalBarPos<1}function isScrollToRight(e,t){var i=null!=(i=t.table.options.customConfig)&&i._disableColumnAndRowSizeRound?1:0,r=t.table.getAllColsWidth()-t.table.scenegraph.width;return 0!=r&&0<=e&&Math.abs(t.scroll.horizontalBarPos-r)<1+i}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var InertiaScroll=class{constructor(e){this.stateManager=e}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,i){this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var e=Date.now(),t=e-this.lastTime;let i=!0;var r=Math.pow(this.friction,t/16),o=r*this.speedX,r=r*this.speedY;let n=0,a=0;.05<Math.abs(o)&&(i=!1,n=(this.speedX+o)/2*t),.05<Math.abs(r)&&(i=!1,a=(this.speedY+r)/2*t),null!=(t=this.scrollHandle)&&t.call(this,n,a),i?this.runingId=null:(this.lastTime=e,this.speedX=o,this.speedY=r,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}};function fireMoveColEventListeners(e,t,i){var r;t&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.colSource)&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.rowSource)&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.colTarget)&&-1!==(null==(r=e.stateManager.columnMove)?void 0:r.rowTarget)?e.hasListeners(TABLE_EVENT_TYPE.CHANGE_HEADER_POSITION)&&e.fireListeners(TABLE_EVENT_TYPE.CHANGE_HEADER_POSITION,{target:{col:e.stateManager.columnMove.colTarget,row:e.stateManager.columnMove.rowTarget},source:{col:e.stateManager.columnMove.colSource,row:e.stateManager.columnMove.rowSource},event:i}):t||e.hasListeners(TABLE_EVENT_TYPE.CHANGE_HEADER_POSITION_FAIL)&&e.fireListeners(TABLE_EVENT_TYPE.CHANGE_HEADER_POSITION_FAIL,{target:{col:e.stateManager.columnMove.colTarget,row:e.stateManager.columnMove.rowTarget},source:{col:e.stateManager.columnMove.colSource,row:e.stateManager.columnMove.rowSource},event:i})}function bindTableGroupListener(a){const g=a.table,s=g.stateManager;g.scenegraph.tableGroup.addEventListener(\\\"pointermove\\\",i=>{var e=null!=(e=null==(e=g.eventManager.LastPointerXY)?void 0:e.x)?e:i.x,t=null!=(t=null==(t=g.eventManager.LastPointerXY)?void 0:t.y)?t:i.y,r=(g.eventManager.LastPointerXY={x:i.x,y:i.y},a.touchSetTimeout&&(clearTimeout(a.touchSetTimeout),a.touchSetTimeout=void 0),getCellEventArgsSet(i));if(r.eventArgs&&g.hasListeners(TABLE_EVENT_TYPE.MOUSEMOVE_TABLE)&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEMOVE_TABLE,{col:r.eventArgs.col,row:r.eventArgs.row,x:r.abstractPos.x,y:r.abstractPos.y,event:i.nativeEvent,target:null==(n=null==r?void 0:r.eventArgs)?void 0:n.target,mergeCellInfo:null==(n=r.eventArgs)?void 0:n.mergeInfo}),s.interactionState!==InteractionState.grabing||null!=(n=g.editorManager)&&n.editingEditor){null!=(n=g.options.select)&&n.disableDragSelect||!g.eventManager.isDraging||!s.isSelecting()||null!=(n=g.editorManager)&&n.editingEditor||a.dealTableSelect(r,!0);var o,n=i.path.find(e=>\\\"cell\\\"===e.role);if(!g.hasListeners(TABLE_EVENT_TYPE.MOUSELEAVE_CELL)||-1===g.stateManager.hover.cellPos.col||-1===g.stateManager.hover.cellPos.row||(null==n?void 0:n.col)===g.stateManager.hover.cellPos.col&&(null==n?void 0:n.row)===g.stateManager.hover.cellPos.row||g.fireListeners(TABLE_EVENT_TYPE.MOUSELEAVE_CELL,{col:g.stateManager.hover.cellPos.col,row:g.stateManager.hover.cellPos.row,cellRange:g.getCellRangeRelativeRect({col:g.stateManager.hover.cellPos.col,row:g.stateManager.hover.cellPos.row}),scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,event:i.nativeEvent,target:null==(o=null==r?void 0:r.eventArgs)?void 0:o.target}),!g.hasListeners(TABLE_EVENT_TYPE.MOUSEENTER_CELL)||\\\"cell\\\"!==(null==n?void 0:n.role)||!isValid_default(n.col)||!isValid_default(n.row)||n.col===g.stateManager.hover.cellPos.col&&n.row===g.stateManager.hover.cellPos.row||n.col===(null==(o=g.stateManager.hover.cellPosContainHeader)?void 0:o.col)&&n.row===(null==(o=g.stateManager.hover.cellPosContainHeader)?void 0:o.row)||g.fireListeners(TABLE_EVENT_TYPE.MOUSEENTER_CELL,{col:n.col,row:n.row,cellRange:g.getCellRangeRelativeRect({col:n.col,row:n.row}),scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,event:i.nativeEvent,target:null==(o=null==r?void 0:r.eventArgs)?void 0:o.target,mergeCellInfo:null==(n=r.eventArgs)?void 0:n.mergeInfo}),a.dealIconHover(r),a.dealTableHover(r),g.theme.columnResize.visibleOnHover&&a.checkColumnResize(r,!0),r.eventArgs&&g.hasListeners(TABLE_EVENT_TYPE.MOUSEMOVE_CELL)){let e,t;null!=(o=r.eventArgs)&&o.target&&(o=getIconAndPositionFromTarget(null==(n=r.eventArgs)?void 0:n.target))&&(e=o.icon,t=o.position),g.fireListeners(TABLE_EVENT_TYPE.MOUSEMOVE_CELL,{col:r.eventArgs.col,row:r.eventArgs.row,x:r.abstractPos.x,y:r.abstractPos.y,event:i.nativeEvent,targetIcon:e?{name:e.name,position:t,funcType:e.attribute.funcType}:void 0,target:null==(n=null==r?void 0:r.eventArgs)?void 0:n.target,mergeCellInfo:null==(o=r.eventArgs)?void 0:o.mergeInfo})}}else 1<=Math.abs(e-i.x)+Math.abs(t-i.y)&&(s.isResizeCol()||s.isResizeRow()||(s.isMoveCol()?a.dealColumnMover(r):s.isFillHandle()?a.dealFillSelect(r,!0):(null==(n=g.options.select)?void 0:n.disableDragSelect)||a.dealTableSelect(r,!0)))}),g.scenegraph.tableGroup.addEventListener(\\\"pointerout\\\",e=>{var t=getCellEventArgsSet(e),t=null==(t=null==t?void 0:t.eventArgs)?void 0:t.target;\\\"table\\\"===(null==t?void 0:t.role)&&a.dealTableHover()}),g.scenegraph.tableGroup.addEventListener(\\\"pointerover\\\",e=>{var t,i=getCellEventArgsSet(e),r=null==(r=null==i?void 0:i.eventArgs)?void 0:r.target;r&&g.hasListeners(TABLE_EVENT_TYPE.MOUSEOVER_CHART_SYMBOL)&&\\\"symbol\\\"===r.type&&(r=e.composedPath().find(e=>\\\"cell\\\"===e.roll))&&(({col:r,row:t}=r),t={col:r,row:t,field:g.getHeaderField(r,t),value:g.getCellValue(r,t),dataValue:g.getCellOriginValue(r,t),cellHeaderPaths:g.internalProps.layoutMap.getCellHeaderPaths(r,t),title:g.getBodyColumnDefine(r,t).title,cellRange:g.getCellRelativeRect(r,t),event:e.nativeEvent,sparkline:{pointData:void 0},scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,target:null==(r=null==i?void 0:i.eventArgs)?void 0:r.target},g.fireListeners(TABLE_EVENT_TYPE.MOUSEOVER_CHART_SYMBOL,t))}),g.scenegraph.tableGroup.addEventListener(\\\"pointerenter\\\",e=>{(g.theme.scrollStyle.horizontalVisible&&\\\"focus\\\"===g.theme.scrollStyle.horizontalVisible||!g.theme.scrollStyle.horizontalVisible&&\\\"focus\\\"===g.theme.scrollStyle.visible)&&s.showHorizontalScrollBar(),(g.theme.scrollStyle.verticalVisible&&\\\"focus\\\"===g.theme.scrollStyle.verticalVisible||!g.theme.scrollStyle.verticalVisible&&\\\"focus\\\"===g.theme.scrollStyle.visible)&&s.showVerticalScrollBar(),g.hasListeners(TABLE_EVENT_TYPE.MOUSEENTER_TABLE)&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEENTER_TABLE,{event:e.nativeEvent})}),g.scenegraph.tableGroup.addEventListener(\\\"pointerleave\\\",e=>{s.isResizeCol()||s.isResizeRow()||s.isMoveCol()||s.isSelecting()||(s.updateInteractionState(InteractionState[\\\"default\\\"]),s.updateCursor()),(g.theme.scrollStyle.horizontalVisible&&\\\"focus\\\"===g.theme.scrollStyle.horizontalVisible||!g.theme.scrollStyle.horizontalVisible&&\\\"focus\\\"===g.theme.scrollStyle.visible)&&s.hideHorizontalScrollBar(),(g.theme.scrollStyle.verticalVisible&&\\\"focus\\\"===g.theme.scrollStyle.verticalVisible||!g.theme.scrollStyle.verticalVisible&&\\\"focus\\\"===g.theme.scrollStyle.visible)&&s.hideVerticalScrollBar(),g.hasListeners(TABLE_EVENT_TYPE.MOUSELEAVE_CELL)&&-1!==g.stateManager.hover.cellPos.col&&-1!==g.stateManager.hover.cellPos.row&&g.fireListeners(TABLE_EVENT_TYPE.MOUSELEAVE_CELL,{col:g.stateManager.hover.cellPos.col,row:g.stateManager.hover.cellPos.row,cellRange:g.getCellRangeRelativeRect({col:g.stateManager.hover.cellPos.col,row:g.stateManager.hover.cellPos.row}),scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,event:e.nativeEvent,target:void 0}),a.dealTableHover();var t=e.target;t&&!t.isDescendantsOf(g.scenegraph.tableGroup)&&g.fireListeners(TABLE_EVENT_TYPE.MOUSELEAVE_TABLE,{event:e.nativeEvent})});var e=e=>{var t=e.target;g.getElement().contains(t)||getPromiseValue(null==(t=g.editorManager)?void 0:t.completeEdit(e),e=>{!1!==e&&(s.updateInteractionState(InteractionState[\\\"default\\\"]),a.dealTableHover())})},t=e=>{var t=e.target;g.getElement().contains(t)||g.internalProps.menuHandler.containElement(t)||getPromiseValue(null==(t=g.editorManager)?void 0:t.completeEdit(e),e=>{var t;!1!==e&&null!=(t=g.options.select)&&t.outsideClickDeselect&&(t=!(null==(t=s.select.ranges)||!t.length),a.dealTableSelect(),s.endSelectCells(!0,t))})};a.globalEventListeners.push({name:\\\"pointerup\\\",env:\\\"document\\\",callback:e}),a.globalEventListeners.push({name:\\\"pointerdown\\\",env:\\\"document\\\",callback:t}),vglobal.addEventListener(\\\"pointerup\\\",e),vglobal.addEventListener(\\\"pointerdown\\\",t),g.scenegraph.tableGroup.addEventListener(\\\"pointerdown\\\",r=>{var e;if(g.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:r.nativeEvent}),g.eventManager.isDown=!0,g.eventManager.LastBodyPointerXY={x:r.x,y:r.y},g.eventManager.LastPointerXY={x:r.x,y:r.y},0===r.button){const o=getCellEventArgsSet(r);a.downIcon=void 0,s.interactionState===InteractionState[\\\"default\\\"]&&(g.isPivotChart()&&\\\"chart\\\"!==(null==(e=null==o?void 0:o.eventArgs)?void 0:e.target.type)&&g.scenegraph.updateChartState(null),(null==(e=o.eventArgs)?void 0:e.target)!==(null==(e=s.residentHoverIcon)?void 0:e.icon)&&s.hideMenu(),\\\"chart\\\"!==(null==(e=null==o?void 0:o.eventArgs)?void 0:e.target.type))&&getPromiseValue(null==(e=g.editorManager)?void 0:e.completeEdit(r.nativeEvent),e=>{if(!1!==e){var t,i=null!=(i=null==(i=null==(i=null==o?void 0:o.eventArgs)?void 0:i.target)?void 0:i.role)&&i.startsWith(\\\"icon\\\")?o.eventArgs.target:null!=(i=r.target.role)&&i.startsWith(\\\"icon\\\")?r.target:void 0;if((a.downIcon=i)&&!1!==i.attribute.interactive)i.attribute.funcType===IconFuncTypeEnum.dragReorder&&(s.startMoveCol(o.eventArgs.col,o.eventArgs.row,o.abstractPos.x,o.abstractPos.y,null==(i=null==(i=o.eventArgs)?void 0:i.event)?void 0:i.nativeEvent),s.updateInteractionState(InteractionState.grabing));else{if(a.cellIsHeaderCheck(o))return;if(\\\"touch\\\"===r.pointerType)a.touchEnd=!1,a.touchSetTimeout=setTimeout(()=>{a.isTouchdown=!1,a.touchMove=!0,(!a.touchEnd&&(a.checkColumnResize(o,!0)||a.checkRowResize(o,!0))||!a.touchEnd&&a.checkColumnMover(o)||a.dealTableSelect(o)&&!a.touchEnd)&&s.updateInteractionState(InteractionState.grabing)},500),!g.hasListeners(TABLE_EVENT_TYPE.MOUSEENTER_CELL)||\\\"cell\\\"!==(null==(i=r.path.find(e=>\\\"cell\\\"===e.role))?void 0:i.role)||!isValid_default(i.col)||!isValid_default(i.row)||i.col===g.stateManager.hover.cellPos.col&&i.row===g.stateManager.hover.cellPos.row||i.col===(null==(t=g.stateManager.hover.cellPosContainHeader)?void 0:t.col)&&i.row===(null==(t=g.stateManager.hover.cellPosContainHeader)?void 0:t.row)||g.fireListeners(TABLE_EVENT_TYPE.MOUSEENTER_CELL,{col:i.col,row:i.row,cellRange:g.getCellRangeRelativeRect({col:i.col,row:i.row}),scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,event:r.nativeEvent,target:null==(t=null==o?void 0:o.eventArgs)?void 0:t.target,mergeCellInfo:null==(i=o.eventArgs)?void 0:i.mergeInfo}),a.dealTableHover(o);else{if(!a.checkCellFillhandle(o)&&(a.checkColumnResize(o,!0)||a.checkRowResize(o,!0)))return g.scenegraph.updateChartState(null),void s.updateInteractionState(InteractionState.grabing);if(a.checkColumnMover(o))return void s.updateInteractionState(InteractionState.grabing);if(a.checkCellFillhandle(o,!0)&&a.dealFillSelect(o))return void s.updateInteractionState(InteractionState.grabing);a.dealTableSelect(o)&&s.updateInteractionState(InteractionState.grabing)}}g.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_CELL)&&(t=getCellEventArgsSet(r)).eventArgs&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_CELL,{col:t.eventArgs.col,row:t.eventArgs.row,event:r.nativeEvent,target:null==(i=null==t?void 0:t.eventArgs)?void 0:i.target,mergeCellInfo:t.eventArgs.mergeInfo})}})}}),g.scenegraph.tableGroup.addEventListener(\\\"pointerup\\\",e=>{var t,i;0===e.button&&(\\\"grabing\\\"===s.interactionState?(s.updateInteractionState(InteractionState[\\\"default\\\"]),s.isResizeCol()?endResizeCol(g):s.isResizeRow()?endResizeRow(g):s.isMoveCol()?(t=g.stateManager.endMoveCol(),fireMoveColEventListeners(g,t,e.nativeEvent)):s.isSelecting()&&(g.stateManager.endSelectCells(),g.stateManager.isFillHandle()&&g.stateManager.endFillSelect(),t=getCellEventArgsSet(e),g.eventManager.isDraging)&&t.eventArgs&&g.hasListeners(TABLE_EVENT_TYPE.DRAG_SELECT_END)&&((t={event:e.nativeEvent,cells:[],col:t.eventArgs.target.col,row:t.eventArgs.target.row,scaleRatio:g.canvas.getBoundingClientRect().width/g.canvas.offsetWidth,target:null==(i=null==t?void 0:t.eventArgs)?void 0:i.target,mergeCellInfo:null==(i=t.eventArgs)?void 0:i.mergeInfo}).cells=g.getSelectedCellInfos(),g.fireListeners(TABLE_EVENT_TYPE.DRAG_SELECT_END,t))):s.interactionState===InteractionState.scrolling&&s.updateInteractionState(InteractionState[\\\"default\\\"]),g.hasListeners(TABLE_EVENT_TYPE.MOUSEUP_CELL))&&(i=getCellEventArgsSet(e)).eventArgs&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEUP_CELL,{col:i.eventArgs.col,row:i.eventArgs.row,event:e.nativeEvent,target:null==(t=null==i?void 0:i.eventArgs)?void 0:t.target,mergeCellInfo:null==(t=i.eventArgs)?void 0:t.mergeInfo})}),g.scenegraph.tableGroup.addEventListener(\\\"rightdown\\\",i=>{var r=getCellEventArgsSet(i);if(r.eventArgs){s.triggerContextMenu(r.eventArgs.col,r.eventArgs.row,r.abstractPos.x,r.abstractPos.y);var{col:o,row:n}=r.eventArgs;if(g.hasListeners(TABLE_EVENT_TYPE.CONTEXTMENU_CELL)){var a,l=g.getCellInfo(o,n);let e,t;null!=(a=r.eventArgs)&&a.target&&(a=getIconAndPositionFromTarget(null==(a=r.eventArgs)?void 0:a.target))&&(e=a.icon,t=a.position);r=Object.assign(Object.assign({},l),{event:i.nativeEvent,cells:[],targetIcon:e?{name:e.name,position:t,funcType:e.attribute.funcType}:void 0,target:null==(a=null==r?void 0:r.eventArgs)?void 0:a.target,mergeCellInfo:null==(a=r.eventArgs)?void 0:a.mergeInfo});cellInRanges(g.stateManager.select.ranges,o,n)?r.cells=g.getSelectedCellInfos():r.cells=[[l]],g.fireListeners(TABLE_EVENT_TYPE.CONTEXTMENU_CELL,r)}}}),g.scenegraph.tableGroup.addEventListener(\\\"pointertap\\\",i=>{if(!g.stateManager.columnResize.resizing){var r=getCellEventArgsSet(i);if(!a.touchMove&&0===i.button&&r.eventArgs&&g.hasListeners(TABLE_EVENT_TYPE.CLICK_CELL)){var{col:o,row:n}=r.eventArgs,o=g.getCellInfo(o,n);let e,t;null!=(n=r.eventArgs)&&n.target&&(n=getIconAndPositionFromTarget(null==(n=r.eventArgs)?void 0:n.target))&&(e=n.icon,t=n.position);var n=Object.assign(Object.assign({},o),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:e?{name:e.name,position:t,funcType:e.attribute.funcType}:void 0,target:null==(n=null==r?void 0:r.eventArgs)?void 0:n.target,mergeCellInfo:null==(o=r.eventArgs)?void 0:o.mergeInfo});g.fireListeners(TABLE_EVENT_TYPE.CLICK_CELL,n)}!g.stateManager.columnResize.resizing&&!g.stateManager.columnMove.moving&&(a.dealIconClick(i,r),null!=r)&&r.eventArgs&&a.touchSetTimeout&&\\\"touch\\\"===i.pointerType&&(o=getCellEventArgsSet(i),a.touchSetTimeout)&&(clearTimeout(a.touchSetTimeout),r=!(null==(n=s.select.ranges)||!n.length),a.dealTableSelect(o),s.endSelectCells(!0,r),a.touchSetTimeout=void 0)}}),g.scenegraph.stage.addEventListener(\\\"pointerdown\\\",i=>{var e;const r=getCellEventArgsSet(i);null!=(e=r.eventArgs)&&e.target&&(null==(e=r.eventArgs)?void 0:e.target)===(null==(e=s.residentHoverIcon)?void 0:e.icon)||s.hideMenu(),getPromiseValue(null==(e=g.editorManager)?void 0:e.completeEdit(i.nativeEvent),e=>{var t;!1===e||(t=null!=(t=i.target.role)&&t.startsWith(\\\"icon\\\")?i.target:void 0,a.downIcon=t)||a.checkCellFillhandle(r)||s.columnResize.resizing||!a.checkColumnResize(r,!0)||(g.scenegraph.updateChartState(null),s.updateInteractionState(InteractionState.grabing),t=r.eventArgs,null!=t&&t.targetCell)||g.getCellAt(r.abstractPos.x-g.theme.columnResize.resizeHotSpotSize/2,r.abstractPos.y)&&g.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&g.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:i.nativeEvent})})}),g.scenegraph.stage.addEventListener(\\\"pointerup\\\",e=>{\\\"grabing\\\"===s.interactionState&&(s.updateInteractionState(InteractionState[\\\"default\\\"]),s.isResizeCol()?endResizeCol(g):s.isResizeRow()&&endResizeRow(g))}),g.scenegraph.stage.addEventListener(\\\"pointertap\\\",e=>{var t,i=e.target;g.eventManager.isDraging||!i||!i.isDescendantsOf(g.scenegraph.stage)&&i.stage!==i||i.isDescendantsOf(g.scenegraph.tableGroup)?g.eventManager.isDraging&&s.isSelecting()&&s.endSelectCells():(s.updateInteractionState(InteractionState[\\\"default\\\"]),a.dealTableHover(),i=!(null==(i=s.select.ranges)||!i.length),null!=(t=null==(t=g.options.select)?void 0:t.blankAreaClickDeselect)&&!t||a.dealTableSelect(),s.endSelectCells(!0,i),s.updateCursor(),g.scenegraph.updateChartState(null))}),g.scenegraph.stage.addEventListener(\\\"pointermove\\\",e=>{var t=getCellEventArgsSet(e);s.isResizeCol()||a.checkColumnResize(t)?g.stateManager.select&&a.checkCellFillhandle(t)?s.updateCursor(\\\"crosshair\\\"):s.updateCursor(\\\"col-resize\\\"):s.isResizeRow()||a.checkRowResize(t)?g.stateManager.select&&a.checkCellFillhandle(t)?s.updateCursor(\\\"crosshair\\\"):s.updateCursor(\\\"row-resize\\\"):s.isMoveCol()||s.updateCursor()}),g.scenegraph.tableGroup.addEventListener(\\\"checkbox_state_change\\\",i=>{var e=getCellEventArgsSet(i),{col:t,row:r}=e.eventArgs,o=g.getCellInfo(t,r),n=getCellMergeInfo(g,t,r);if(n)for(let t=n.start.col;t<=n.end.col;t++)for(let e=n.start.row;e<=n.end.row;e++)g.scenegraph.getCell(t,e).forEachChildren(e=>{\\\"checkbox\\\"===e.name&&e.setAttributes({checked:i.target.attribute.checked,indeterminate:i.target.attribute.indeterminate})});var a,e=Object.assign(Object.assign({},o),{event:i.nativeEvent,target:null==(a=null==e?void 0:e.eventArgs)?void 0:a.target,mergeCellInfo:null==(a=null==e?void 0:e.eventArgs)?void 0:a.mergeInfo,checked:i.detail.checked});g.isHeader(t,r)?(g.stateManager.setHeaderCheckedState(o.field,i.detail.checked),\\\"checkbox\\\"===g.getCellType(t,r)&&g.scenegraph.updateCheckboxCellState(t,r,i.detail.checked)):(g.stateManager.setCheckedState(t,r,o.field,i.detail.checked),\\\"checkbox\\\"===g.getCellType(t,r)&&g.stateManager.headerCheckedState[o.field]!==(a=g.stateManager.updateHeaderCheckedState(o.field,t,r))&&g.scenegraph.updateHeaderCheckboxCellState(t,r,a)),g.fireListeners(TABLE_EVENT_TYPE.CHECKBOX_STATE_CHANGE,e),g.scenegraph.updateNextFrame()}),g.scenegraph.tableGroup.addEventListener(\\\"radio_checked\\\",e=>{let t,i,r,o=getCellEventArgsSet(e),{col:n,row:a,target:l}=o.eventArgs,s=g.getCellInfo(n,a),h=null==(t=regIndexReg.exec(l.id))?void 0:t[1],d=getCellMergeInfo(g,n,a);if(d)for(let t=d.start.col;t<=d.end.col;t++)for(let e=d.start.row;e<=d.end.row;e++)g.scenegraph.getCell(t,e).forEachChildren(e=>{\\\"radio\\\"===e.name&&e.id===l.id&&e.setAttributes({checked:!0})});var u=g.getBodyColumnDefine(n,a).radioCheckType||\\\"column\\\";if(\\\"cell\\\"===u)if(d)for(let t=d.start.col;t<=d.end.col;t++)for(let e=d.start.row;e<=d.end.row;e++)g.scenegraph.getCell(t,e).forEachChildren(e=>{\\\"radio\\\"===e.name&&e.id!==l.id&&e.setAttributes({checked:!1})});else g.scenegraph.getCell(n,a).forEachChildren(e=>{\\\"radio\\\"===e.name&&e.id!==l.id&&e.setAttributes({checked:!1})});else\\\"column\\\"===u&&g.scenegraph.getColGroup(n).forEachChildren(e=>{e.forEachChildren(e=>{\\\"radio\\\"===e.name&&e.id!==l.id&&e.setAttributes({checked:!1})})});var c=h?Number(h):void 0,u=(g.stateManager.setRadioState(n,a,s.field,u,c),Object.assign(Object.assign({},s),{event:e.nativeEvent,target:null==(i=null==o?void 0:o.eventArgs)?void 0:i.target,mergeCellInfo:null==(r=null==o?void 0:o.eventArgs)?void 0:r.mergeInfo,radioIndexInCell:c}));g.fireListeners(TABLE_EVENT_TYPE.RADIO_STATE_CHANGE,u),g.scenegraph.updateNextFrame()}),g.scenegraph.tableGroup.addEventListener(\\\"switch_state_change\\\",i=>{var e,t=getCellEventArgsSet(i),{col:r,row:o}=t.eventArgs,n=g.getCellInfo(r,o),a=getCellMergeInfo(g,r,o);if(a)for(let t=a.start.col;t<=a.end.col;t++)for(let e=a.start.row;e<=a.end.row;e++)g.scenegraph.getCell(t,e).forEachChildren(e=>{\\\"switch\\\"===e.name&&e.setAttributes({checked:i.target.attribute.checked})});t=Object.assign(Object.assign({},n),{event:i.nativeEvent,target:null==(e=null==t?void 0:t.eventArgs)?void 0:e.target,mergeCellInfo:null==(e=null==t?void 0:t.eventArgs)?void 0:e.mergeInfo,checked:i.detail.checked});g.stateManager.setCheckedState(r,o,n.field,i.detail.checked),g.fireListeners(TABLE_EVENT_TYPE.SWITCH_STATE_CHANGE,t),g.scenegraph.updateNextFrame()}),g.scenegraph.stage.addEventListener(\\\"wheel\\\",e=>{var t;e.path.find(e=>\\\"legend\\\"===e.name)||(null!=(t=g.editorManager)&&t.completeEdit(),g.eventManager._enableTableScroll&&handleWhell(e,s))})}function bindGesture(e){const t=e.table;e.gesture=new Gesture(t.scenegraph.tableGroup,{tap:{interval:300}}),e.gesture.on(\\\"doubletap\\\",e=>{dblclickHandler(e,t)})}function endResizeCol(e){e.stateManager.endResizeCol();var t=[];for(let i=0;i<e.colCount;i++)t.push(e.getColWidth(i));e.fireListeners(TABLE_EVENT_TYPE.RESIZE_COLUMN_END,{col:e.stateManager.columnResize.col,colWidths:t})}function endResizeRow(e){e.stateManager.endResizeRow(),e.fireListeners(TABLE_EVENT_TYPE.RESIZE_ROW_END,{row:e.stateManager.rowResize.row,rowHeight:e.getRowHeight(e.stateManager.rowResize.row)})}function dblclickHandler(i,r){var o=getCellEventArgsSet(i);let n=-1,a=-1;o.eventArgs&&(n=o.eventArgs.col,a=o.eventArgs.row);var l=r.getCellValue(n,a),s=null==(s=null==(s=o.eventArgs)?void 0:s.targetCell)?void 0:s.globalAABBBounds;if(s&&r.internalProps.focusControl.setFocusRect(new Rect2(s.x1+r.scrollLeft,s.y1+r.scrollTop,s.x2-s.x1,s.y2-s.y1),l),r.hasListeners(TABLE_EVENT_TYPE.DBLCLICK_CELL)){var s=r.getCellInfo(n,a);let e,t;null!=(l=o.eventArgs)&&l.target&&(l=getIconAndPositionFromTarget(null==(l=o.eventArgs)?void 0:l.target))&&(e=l.icon,t=l.position);l=Object.assign(Object.assign({},s),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:e?{name:e.name,position:t,funcType:e.attribute.funcType}:void 0,target:null==(l=null==o?void 0:o.eventArgs)?void 0:l.target,mergeCellInfo:null==(s=null==o?void 0:o.eventArgs)?void 0:s.mergeInfo});r.fireListeners(TABLE_EVENT_TYPE.DBLCLICK_CELL,l)}}function bindScrollBarListener(e){const t=e.table,i=t.stateManager,r=t.scenegraph,o=(r.component.vScrollBar.addEventListener(\\\"pointerover\\\",e=>{i.showVerticalScrollBar()}),r.component.hScrollBar.addEventListener(\\\"pointerover\\\",e=>{i.showHorizontalScrollBar()}),r.component.vScrollBar.addEventListener(\\\"pointerout\\\",e=>{i.interactionState!==InteractionState.scrolling&&i.hideVerticalScrollBar()}),r.component.hScrollBar.addEventListener(\\\"pointerout\\\",e=>{i.interactionState!==InteractionState.scrolling&&i.hideHorizontalScrollBar()}),r.component.vScrollBar.addEventListener(\\\"pointermove\\\",e=>{r.table.stateManager.updateCursor(\\\"default\\\"),e.stopPropagation()}),r.component.vScrollBar.addEventListener(\\\"pointerdown\\\",e=>{e.stopPropagation(),r.table.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&r.table.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),r.component.vScrollBar.addEventListener(\\\"scrollDown\\\",e=>{var t;r.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},r.table.eventManager.isDown=!0,i.interactionState!==InteractionState.scrolling&&i.updateInteractionState(InteractionState.scrolling),r.table.stateManager.hideMenu(),null!=(t=r.table.editorManager)&&t.completeEdit(),r.table.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&r.table.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),r.component.vScrollBar.addEventListener(\\\"pointerup\\\",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===InteractionState.scrolling&&i.updateInteractionState(InteractionState[\\\"default\\\"])}),r.component.vScrollBar.addEventListener(\\\"pointerupoutside\\\",()=>{i.fastScrolling=!1,i.interactionState===InteractionState.scrolling&&i.updateInteractionState(InteractionState[\\\"default\\\"])}),r.component.vScrollBar.addEventListener(\\\"scrollUp\\\",e=>{r.table.eventManager.isDraging=!1}),r.component.hScrollBar.addEventListener(\\\"pointermove\\\",e=>{r.table.stateManager.updateCursor(\\\"default\\\"),e.stopPropagation()}),r.component.hScrollBar.addEventListener(\\\"pointerdown\\\",e=>{e.stopPropagation(),r.table.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&r.table.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),r.component.hScrollBar.addEventListener(\\\"scrollDown\\\",e=>{var t;r.table.eventManager.LastBodyPointerXY={x:e.x,y:e.y},r.table.eventManager.isDown=!0,i.interactionState!==InteractionState.scrolling&&i.updateInteractionState(InteractionState.scrolling),r.table.stateManager.hideMenu(),null!=(t=r.table.editorManager)&&t.completeEdit(),r.table.hasListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE)&&r.table.fireListeners(TABLE_EVENT_TYPE.MOUSEDOWN_TABLE,{event:e.nativeEvent})}),r.component.hScrollBar.addEventListener(\\\"pointerup\\\",()=>{i.fastScrolling=!1,r.table.eventManager.isDraging=!1,i.interactionState===InteractionState.scrolling&&i.updateInteractionState(InteractionState[\\\"default\\\"])}),r.component.hScrollBar.addEventListener(\\\"pointerupoutside\\\",()=>{i.fastScrolling=!1,i.interactionState===InteractionState.scrolling&&i.updateInteractionState(InteractionState[\\\"default\\\"])}),r.component.hScrollBar.addEventListener(\\\"scrollUp\\\",e=>{r.table.eventManager.isDraging=!1}),throttle2(i.updateVerticalScrollBar,20)),n=throttle2(i.updateHorizontalScrollBar,20);r.component.vScrollBar.addEventListener(\\\"scrollDrag\\\",e=>{r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==InteractionState.scrolling&&i.updateInteractionState(InteractionState.scrolling);var t=e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]);o(t,e)}),r.component.hScrollBar.addEventListener(\\\"scrollDrag\\\",e=>{r.table.eventManager.isDown&&(r.table.eventManager.isDraging=!0),i.fastScrolling=!0,i.interactionState!==InteractionState.scrolling&&i.updateInteractionState(InteractionState.scrolling);var t=e.detail.value[0]/(1-e.detail.value[1]+e.detail.value[0]);n(t)})}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var defaultPixelRatio=1;function getPixelRatio(){return isNode?defaultPixelRatio=1:1<(defaultPixelRatio=Math.ceil(window.devicePixelRatio||1))&&defaultPixelRatio%2!=0&&(defaultPixelRatio+=1),defaultPixelRatio}getPixelRatio();var __awaiter12=function(e,t,l,s){return new(l=l||Promise)(function(i,r){function o(e){try{a(s.next(e))}catch(t){r(t)}}function n(e){try{a(s[\\\"throw\\\"](e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,n)}a((s=s.apply(e,t||[])).next())})};function bindContainerDomListener(n){const v=n.table,a=v.stateManager,e=v.internalProps.handler;function l(e){var t;v.hasListeners(TABLE_EVENT_TYPE.KEYDOWN)&&(t={keyCode:null!=(t=e.keyCode)?t:e.which,code:e.code,event:e,scaleRatio:v.canvas.getBoundingClientRect().width/v.canvas.offsetWidth},v.fireListeners(TABLE_EVENT_TYPE.KEYDOWN,t))}e.on(v.getElement(),\\\"blur\\\",e=>{n.dealTableHover()}),e.on(v.getElement(),\\\"keydown\\\",i=>{var e,t;if(\\\"a\\\"===i.key&&(i.ctrlKey||i.metaKey))null!=(r=v.keyboardOptions)&&r.selectAllOnCtrlA&&(i.preventDefault(),n.deelTableSelectAll());else if(0<=a.select.cellPos.col&&0<=a.select.cellPos.row&&(\\\"ArrowUp\\\"===i.key||\\\"ArrowDown\\\"===i.key||\\\"ArrowLeft\\\"===i.key||\\\"ArrowRight\\\"===i.key)){if((null==(r=null==(r=v.options.keyboardOptions)?void 0:r.moveEditCellOnArrowKeys)||!r)&&null!=(r=v.editorManager)&&r.editingEditor||!1===(null==(r=v.options.keyboardOptions)?void 0:r.moveSelectedCellOnArrowKeys))return;let e,t;if(i.preventDefault(),i.stopPropagation(),\\\"ArrowUp\\\"===i.key?t=i.ctrlKey||i.metaKey?(e=a.select.cellPos.col,0):(i.shiftKey,e=a.select.cellPos.col,Math.min(v.rowCount-1,Math.max(0,a.select.cellPos.row-1))):\\\"ArrowDown\\\"===i.key?t=i.ctrlKey||i.metaKey?(e=a.select.cellPos.col,v.rowCount-1):(i.shiftKey,e=a.select.cellPos.col,Math.min(v.rowCount-1,Math.max(0,a.select.cellPos.row+1))):\\\"ArrowLeft\\\"===i.key?i.ctrlKey||i.metaKey?(e=0,t=a.select.cellPos.row):(i.shiftKey,t=a.select.cellPos.row,e=Math.min(v.colCount-1,Math.max(0,a.select.cellPos.col-1))):\\\"ArrowRight\\\"===i.key&&(i.ctrlKey||i.metaKey?(e=v.colCount-1,t=a.select.cellPos.row):(i.shiftKey,t=a.select.cellPos.row,e=Math.min(v.colCount-1,Math.max(0,a.select.cellPos.col+1)))),isCellDisableSelect(v,e,t))return;v.selectCell(e,t,i.shiftKey),null!=(r=null==(r=v.options.keyboardOptions)?void 0:r.moveEditCellOnArrowKeys)&&r&&null!=(r=v.editorManager)&&r.editingEditor&&(v.editorManager.completeEdit(),v.getElement().focus(),v.getEditor(e,t))&&v.editorManager.startEditCell(e,t)}else if(\\\"Escape\\\"===i.key)null!=(r=v.editorManager)&&r.cancelEdit(),v.getElement().focus();else if(\\\"Enter\\\"===i.key){if(null!=(r=v.editorManager)&&r.editingEditor){if(l(i),v.editorManager.completeEdit(),v.getElement().focus(),!0===(null==(r=v.options.keyboardOptions)?void 0:r.moveFocusCellOnEnter)){var r=a.select.cellPos.col,o=Math.min(v.rowCount-1,Math.max(0,a.select.cellPos.row+1));if(isCellDisableSelect(v,r,o))return;v.selectCell(r,o,i.shiftKey)}return}if(!0===(null==(r=v.options.keyboardOptions)?void 0:r.moveFocusCellOnEnter)){var o=a.select.cellPos.col,r=Math.min(v.rowCount-1,Math.max(0,a.select.cellPos.row+1));if(isCellDisableSelect(v,o,r))return;v.selectCell(o,r,i.shiftKey)}else null!=(r=null==(o=v.options.keyboardOptions)?void 0:o.editCellOnEnter)&&!r||1!==(null!=(r=null==(o=v.stateManager.select.ranges)?void 0:o.length)?r:0)||(o=v.stateManager.select.ranges[0].start.col,r=v.stateManager.select.ranges[0].start.row,e=v.stateManager.select.ranges[0].end.col,t=v.stateManager.select.ranges[0].end.row,o===e&&r===t&&v.getEditor(o,r)&&v.editorManager.startEditCell(o,r))}else if(\\\"Tab\\\"===i.key){if((null==(t=null==(e=v.options.keyboardOptions)?void 0:e.moveFocusCellOnTab)||t)&&0<=a.select.cellPos.col&&0<=a.select.cellPos.row){if(a.select.cellPos.col===v.colCount-1&&a.select.cellPos.row===v.rowCount-1)return;let e,t;if(i.preventDefault(),e=a.select.cellPos.col===v.colCount-1?(t=Math.min(v.rowCount-1,a.select.cellPos.row+1),v.rowHeaderLevelCount):(t=a.select.cellPos.row,a.select.cellPos.col+1),isCellDisableSelect(v,e,t))return;v.selectCell(e,t),null!=(o=v.editorManager)&&o.editingEditor&&(v.editorManager.completeEdit(),v.getElement().focus(),v.getEditor(e,t))&&v.editorManager.startEditCell(e,t)}}else i.ctrlKey||i.metaKey||i.shiftKey||!(\\\"keydown\\\"===(r=v.options.editCellTrigger)||Array.isArray(r)&&r.includes(\\\"keydown\\\"))||null!=(e=v.editorManager)&&e.editingEditor||i.key.match(/^[a-zA-Z0-9+\\\\-*\\\\/%=.,\\\\s]$/)&&v.editorManager.startEditCell(a.select.cellPos.col,a.select.cellPos.row,\\\"\\\");l(i)}),e.on(v.getElement(),\\\"copy\\\",r=>__awaiter12(this,void 0,void 0,function*(){var e,t,i;null!=(e=v.keyboardOptions)&&e.copySelected&&(e=v.getCopyValue(),isValid_default(e))&&(r.preventDefault(),t=yield navigator.permissions.query({name:\\\"clipboard-write\\\"}),null!=(i=navigator.clipboard)&&i.write&&\\\"granted\\\"===t.state?(i=(e=>{const o=[\\\"<table>\\\"],t=['<meta name=\\\"author\\\" content=\\\"Visactor\\\"/>','<style type=\\\"text/css\\\">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(\\\"\\\"),n=e.split(\\\"\\\\r\\\\n\\\");return n.forEach(function(e,t){const i=e.split(\\\"\\\\t\\\"),r=[];0===t&&o.push(\\\"<tbody>\\\"),i.forEach(function(e,t){var i=e?e.toString().replace(/&/g,\\\"&amp;\\\").replace(/'/g,\\\"&#39;\\\").replace(/</g,\\\"&lt;\\\").replace(/>/g,\\\"&gt;\\\").replace(/\\\\n/g,\\\"<br>\\\").replace(/(<br(\\\\s*|\\\\/)>(\\\\r\\\\n|\\\\n)?|\\\\r\\\\n|\\\\n)/g,\\\"<br>\\\\r\\\\n\\\").replace(/\\\\x20{2,}/gi,e=>`<span style=\\\"mso-spacerun: yes\\\">${\\\"&nbsp;\\\".repeat(e.length-1)} </span>`).replace(/\\\\t/gi,\\\"&#9;\\\"):\\\" \\\";r.push(`<td>${i}</td>`)}),o.push(\\\"<tr>\\\",...r,\\\"</tr>\\\"),t===n.length-1&&o.push(\\\"</tbody>\\\")}),o.push(\\\"</table>\\\"),[t,o.join(\\\"\\\")].join(\\\"\\\")})(e),navigator.clipboard.write([new ClipboardItem({\\\"text/html\\\":new Blob([i],{type:\\\"text/html\\\"}),\\\"text/plain\\\":new Blob([e],{type:\\\"text/plain\\\"})})])):browser2.IE?window.clipboardData.setData(\\\"Text\\\",e):r.clipboardData.setData(\\\"text/plain\\\",e),v.fireListeners(TABLE_EVENT_TYPE.COPY_DATA,{cellRange:v.stateManager.select.ranges,copyData:e}))})),e.on(v.getElement(),\\\"paste\\\",e=>{var t;if(null!=(t=v.keyboardOptions)&&t.pasteValueToCell&&v.changeCellValues&&(null==(t=v.editorManager)||!t.editingEditor)&&0<(null==(t=v.stateManager.select.ranges)?void 0:t.length))if(null!=(t=navigator.clipboard)&&t.read)navigator.clipboard.read().then(e=>{for(const t of e)t.types.includes(\\\"text/html\\\")?function(e){const t=v.stateManager.select.ranges,i=t.length,o=Math.min(t[i-1].start.col,t[i-1].end.col),n=Math.min(t[i-1].start.row,t[i-1].end.row),a=Math.max(t[i-1].start.col,t[i-1].end.col),l=Math.max(t[i-1].start.row,t[i-1].end.row);let s=0,h=0,d=[];e.getType(\\\"text/html\\\").then(e=>{e.text().then(e=>{var t;if(e&&/(<table)|(<TABLE)/g.test(e)){for(const r of Array.from(e.matchAll(u))){var i=r[1],i=Array.from(i.matchAll(c)).map(e=>e[1].replace(/(<(?!br)([^>]+)>)/gi,\\\"\\\").replace(/<br(\\\\s*|\\\\/)>[\\\\r\\\\n]?/gim,\\\"\\\\n\\\").replace(/&amp;/g,\\\"&\\\").replace(/&lt;/g,\\\"<\\\").replace(/&gt;/g,\\\">\\\").replace(/&#9;/gi,\\\"\\\\t\\\").replace(/&nbsp;/g,\\\" \\\"));d.push(i),s=Math.max(s,null!=(i=null==i?void 0:i.length)?i:0)}h=null!=(t=d.length)?t:0,d=p(d,h,s,l-n+1,a-o+1),v.changeCellValues(o,n,d,!0)}else navigator.clipboard.read().then(e=>{for(const t of e)t.types.includes(\\\"text/plain\\\")&&t.getType(\\\"text/plain\\\").then(e=>{e.text().then(g)})})})})}(t):1===t.types.length&&\\\"text/plain\\\"===t.types[0]&&function(e){const t=v.stateManager.select.ranges,i=t.length,r=Math.min(t[i-1].start.col,t[i-1].end.col),o=Math.min(t[i-1].start.row,t[i-1].end.row),a=Math.max(t[i-1].start.col,t[i-1].end.col),l=Math.max(t[i-1].start.row,t[i-1].end.row);let s=0,h=0;e.getType(\\\"text/plain\\\").then(e=>{e.text().then(e=>{var t=e.replace(/\\\\r(?!\\\\n)/g,\\\"\\\\r\\\\n\\\").split(\\\"\\\\r\\\\n\\\");let n=[];1<t.length&&\\\"\\\"===t[t.length-1]&&t.pop(),t.forEach(function(e,t){var i;const r=e.split(\\\"\\\\t\\\"),o=[];n.push(o),r.forEach(function(e,t){e.includes(\\\"\\\\n\\\")&&(e=e.replace(/^\\\"(.*)\\\"$/,\\\"$1\\\").replace(/[\\\"]*/g,e=>new Array(Math.floor(e.length/2)).fill('\\\"').join(\\\"\\\"))),o.push(e)}),s=Math.max(s,null!=(i=null==o?void 0:o.length)?i:0)}),h=null!=(t=n.length)?t:0,n=p(n,h,s,l-o+1,a-r+1),v.changeCellValues(r,o,n,!0)})})}(t)});else{const i=v.stateManager.select.ranges,r=Math.min(i[0].start.col,i[0].end.col),o=Math.min(i[0].start.row,i[0].end.row),n=(e.clipboardData||window.Clipboard).getData(\\\"text\\\").split(\\\"\\\\n\\\"),a=[];n.forEach(function(e,t){const i=e.split(\\\"\\\\t\\\"),r=[];a.push(r),i.forEach(function(e,t){t===i.length-1&&(e=e.trim()),r.push(e)})}),v.changeCellValues(r,o,a)}}),e.on(v.getElement(),\\\"contextmenu\\\",e=>{var t;!1!==(null==(t=v.eventOptions)?void 0:t.preventDefaultContextMenu)?e.preventDefault():i(e)}),v.options.canvas||e.on(v.getContainer(),\\\"resize\\\",e=>{var t;v.isReleased||0===e.width&&0===e.height||((v.autoFillWidth||v.autoFillHeight)&&null!=(t=v.editorManager)&&t.completeEdit(),isValid_default(v.options.pixelRatio)||v.setPixelRatio(getPixelRatio()),e.windowSizeNotChange)||v.resize()});const u=/<tr[^>]*>([\\\\s\\\\S]*?)<\\\\/tr>/g,c=/<td[^>]*>([\\\\s\\\\S]*?)<\\\\/td>/g;function g(e){var t=v.stateManager.select.ranges,i=t.length,r=Math.min(t[i-1].start.col,t[i-1].end.col),o=Math.min(t[i-1].start.row,t[i-1].end.row),n=Math.max(t[i-1].start.col,t[i-1].end.col),i=Math.max(t[i-1].start.row,t[i-1].end.row);let a=0,l,s=[];e.split(\\\"\\\\n\\\").forEach(function(e,t){var i;const r=e.split(\\\"\\\\t\\\"),o=[];s.push(o),r.forEach(function(e,t){t===r.length-1&&(e=e.trim()),o.push(e)}),a=Math.max(a,null!=(i=null==o?void 0:o.length)?i:0)}),l=null!=(t=s.length)?t:0,s=p(s,l,a,i-o+1,n-r+1),v.changeCellValues(r,o,s,!0)}function p(i,r,o,e,n){if(o<n||r<e){if(n%o!=0||e%r!=0)return i;var a=[];for(let t=0;t<e;t++){var l=[];a.push(l);for(let e=0;e<n;e++){var s=t%r,h=e%o;l.push(i[s][h])}}return a}return i}var t=e=>{v.eventManager.LastBodyPointerXY={x:e.x,y:e.y},v.eventManager.isDown=!0};n.globalEventListeners.push({name:\\\"pointerdown\\\",env:\\\"body\\\",callback:t}),document.body.addEventListener(\\\"pointerdown\\\",t);const i=e=>{var t,i,r;e.target!==v.canvas&&(t=e,a.menu.isShow&&setTimeout(()=>{v.internalProps.menuHandler.pointInMenuElement(t.clientX,t.clientY)||a.menu.isShow&&a.hideMenu()},0),a.isResizeCol()?endResizeCol(v):a.isResizeRow()?endResizeRow(v):a.isMoveCol()?(r=v.stateManager.endMoveCol(),fireMoveColEventListeners(v,r,t)):a.isSelecting()&&null!=(r=null==(r=v.stateManager.select)?void 0:r.ranges)&&r.length&&(r=v.stateManager.select.ranges[v.stateManager.select.ranges.length-1].end.col,i=v.stateManager.select.ranges[v.stateManager.select.ranges.length-1].end.row,v.stateManager.endSelectCells(),v.hasListeners(TABLE_EVENT_TYPE.DRAG_SELECT_END))&&((r={event:t,cells:[],col:r,row:i,scaleRatio:v.canvas.getBoundingClientRect().width/v.canvas.offsetWidth,target:void 0}).cells=v.getSelectedCellInfos(),v.fireListeners(TABLE_EVENT_TYPE.DRAG_SELECT_END,r))),v.eventManager.LastBodyPointerXY=null,v.eventManager.isDown=!1,v.eventManager.isDraging=!1,v.eventManager.inertiaScroll.endInertia(),\\\"grabing\\\"===a.interactionState&&a.isResizeCol()?endResizeCol(v):\\\"grabing\\\"===a.interactionState&&a.isResizeRow()?endResizeRow(v):a.isMoveCol()&&(i=v.stateManager.endMoveCol(),fireMoveColEventListeners(v,i,e))};n.globalEventListeners.push({name:\\\"pointerup\\\",env:\\\"document\\\",callback:i}),document.addEventListener(\\\"pointerup\\\",i);t=e=>{v.eventManager.isDown&&v.eventManager.LastBodyPointerXY&&(t=null!=(t=null==(t=v.eventManager.LastBodyPointerXY)?void 0:t.x)?t:e.x,i=null!=(i=null==(i=v.eventManager.LastBodyPointerXY)?void 0:i.y)?i:e.y,1<Math.abs(t-e.x)||1<Math.abs(i-e.y))&&(v.eventManager.isDraging=!0);let{x:c,y:g}=v._getMouseAbstractPoint(e,!1);a.interactionState===InteractionState.grabing&&(a.isResizeCol()?(n.dealColumnResize(c,g),v.hasListeners(TABLE_EVENT_TYPE.RESIZE_COLUMN)&&v.fireListeners(TABLE_EVENT_TYPE.RESIZE_COLUMN,{col:v.stateManager.columnResize.col,colWidth:v.getColWidth(v.stateManager.columnResize.col)})):a.isResizeRow()&&(n.dealRowResize(c,g),v.hasListeners(TABLE_EVENT_TYPE.RESIZE_ROW))&&v.fireListeners(TABLE_EVENT_TYPE.RESIZE_ROW,{row:v.stateManager.rowResize.row,rowHeight:v.getRowHeight(v.stateManager.rowResize.row)}));var t=v.stateManager.isSelecting();if(n._enableTableScroll&&n.isDraging&&t&&0<(null==(i=v.stateManager.select.ranges)?void 0:i.length)){const p=v.getDrawRange(),f=v.getFrozenRowsHeight(),m=v.getBottomFrozenRowsHeight(),b=v.getFrozenColsWidth(),C=v.getRightFrozenColsWidth(),r=v.stateManager.select.ranges[v.stateManager.select.ranges.length-1].start;if(!v.isSeriesNumber(r.col,r.row)){var t=v.stateManager.select.ranges[v.stateManager.select.ranges.length-1].end,i=(!1===v.isFrozenRow(r.row)||!1===v.isFrozenRow(t.row))&&v.getAllRowsHeight()>v.tableNoFrameHeight,t=(!1===v.isFrozenColumn(r.col)||!1===v.isFrozenColumn(t.col))&&v.getAllColsWidth()>v.tableNoFrameWidth;if((g>p.bottom-m||g<p.top+f)&&i||(c>p.right-C||c<p.left+b)&&t){v.eventManager.scrollXSpeed=0,v.eventManager.scrollYSpeed=0;let s=!1,h=!1,d=!1,u=!1;g>p.bottom-m&&i&&v.scrollTop+v.tableNoFrameHeight<v.getAllRowsHeight()?(s=!0,v.eventManager.scrollYSpeed=-(g-p.bottom+m)/50):g<p.top+f&&i&&0<v.scrollTop&&(h=!0,v.eventManager.scrollYSpeed=-(g-p.top-f)/50),c>p.right-C&&t&&v.scrollLeft+v.tableNoFrameWidth<v.getAllColsWidth()?(d=!0,v.eventManager.scrollXSpeed=-(c-p.right+C)/50):c<p.left+b&&t&&0<v.scrollLeft&&(u=!0,v.eventManager.scrollXSpeed=-(c-p.left-b)/50),v.eventManager.inertiaScroll.startInertia(v.eventManager.scrollXSpeed,v.eventManager.scrollYSpeed,1),v.eventManager.inertiaScroll.setScrollHandle((e,t)=>{let i,r,o=(handleWhell({deltaX:-e,deltaY:-t},v.stateManager,!1),s?r=v.scrollTop+p.height-m-20:h&&(r=v.scrollTop+f+20),d?i=v.scrollLeft+p.width-C-20:u&&(i=v.scrollLeft+b+20),!1),n=!1;d||u||(c>v.tableNoFrameWidth-v.getRightFrozenColsWidth()&&c<v.tableNoFrameWidth||0<c&&c<v.getFrozenColsWidth()?(i=c,n=!0):i=v.scrollLeft+c),s||h||(g>v.tableNoFrameHeight-v.getBottomFrozenRowsHeight()&&g<v.tableNoFrameHeight||0<g&&g<v.getFrozenRowsHeight()?(r=g,o=!0):r=v.scrollTop+g),v.stateManager.updateInteractionState(InteractionState.grabing);var a=v.getTargetColAtConsiderRightFrozen(i,n),l=v.getTargetRowAtConsiderBottomFrozen(r,o);isValid_default(a)&&isValid_default(l)&&v.stateManager.updateSelectPos(a.col,l.row,!1,!1,!1,!1)})}else v.eventManager.inertiaScroll.isInertiaScrolling()?v.eventManager.inertiaScroll.endInertia():v.eventManager.scrollYSpeed=0}}};n.globalEventListeners.push({name:\\\"pointermove\\\",env:\\\"body\\\",callback:t}),document.body.addEventListener(\\\"pointermove\\\",t)}function bindTouchListener(o){const n=o.table,r=n.stateManager,t=n.scenegraph;o.touchMovePoints=[],n.scenegraph.tableGroup.addEventListener(\\\"touchstart\\\",e=>{e.target.isChildOf(t.component.vScrollBar)||e.target.isChildOf(t.component.vScrollBar)||(o.isTouchdown=!0,o.touchMovePoints.push({x:e.page.x,y:e.page.y,timestamp:Date.now()}))});var e=e=>{var t,i;o.touchMove&&e.preventDefault(),o.isTouchdown&&isTouchEvent2(e)&&((null==(t=null==(t=o.downIcon)?void 0:t.attribute)?void 0:t.funcType)===IconFuncTypeEnum.dragReorder||(4<o.touchMovePoints.length&&o.touchMovePoints.shift(),o.touchMovePoints.push({x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,timestamp:Date.now()}),o._enableTableScroll&&(handleWhell({deltaX:t=-o.touchMovePoints[o.touchMovePoints.length-1].x+o.touchMovePoints[o.touchMovePoints.length-2].x,deltaY:i=-o.touchMovePoints[o.touchMovePoints.length-1].y+o.touchMovePoints[o.touchMovePoints.length-2].y},r),e.cancelable)&&(\\\"none\\\"===n.internalProps.overscrollBehavior||Math.abs(i)>=Math.abs(t)&&0!==i&&isVerticalScrollable(i,r)||Math.abs(i)<=Math.abs(t)&&0!==t&&isHorizontalScrollable(t,r))))&&e.preventDefault()},e=(window.addEventListener(\\\"touchmove\\\",e,{passive:!1}),o.globalEventListeners.push({name:\\\"touchmove\\\",env:\\\"window\\\",callback:e}),e=>{var t,i,r;o.touchEnd=!0,o.touchMove=!1,o.isTouchdown&&isTouchEvent2(e)&&((null==(t=null==(t=o.downIcon)?void 0:t.attribute)?void 0:t.funcType)===IconFuncTypeEnum.dragReorder?e.preventDefault():null!=(t=o.touchMovePoints)&&t.length&&(4<o.touchMovePoints.length&&o.touchMovePoints.shift(),o.touchMovePoints.push({x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY,timestamp:Date.now()}),o._enableTableScroll)&&(t=o.touchMovePoints[0],r=((i=o.touchMovePoints[(null==(i=o.touchMovePoints)?void 0:i.length)-1]).x-t.x)/(i.timestamp-t.timestamp),o.inertiaScroll.startInertia(r,(i.y-t.y)/(i.timestamp-t.timestamp),.95),n.eventManager.inertiaScroll.setScrollHandle((e,t)=>{handleWhell({deltaX:-e,deltaY:-t},n.stateManager)})),o.isTouchdown=!1,o.touchMovePoints=[])}),e=(window.addEventListener(\\\"touchend\\\",e),o.globalEventListeners.push({name:\\\"touchend\\\",env:\\\"window\\\",callback:e}),e=>{o.touchEnd=!0,o.touchMove=!1,o.isTouchdown&&(o.isTouchdown=!1,o.touchMovePoints=[])});window.addEventListener(\\\"touchcancel\\\",e),o.globalEventListeners.push({name:\\\"touchcancel\\\",env:\\\"window\\\",callback:e})}function isTouchEvent2(e){return!!e.changedTouches}function bindAxisClickEvent(a){a.isPivotChart()&&a.scenegraph.tableGroup.addEventListener(\\\"click\\\",i=>{if(!a.stateManager.columnMove.moving&&!a.stateManager.columnResize.resizing)if(\\\"axis-label\\\"===i.target.name){var{col:r,row:o}=getCellEventArgsSet(i).eventArgs,n=a.internalProps.layoutMap;let e,t;o=(t=n.indicatorsAsCol?(e=n.getDimensionKeyInChartSpec(n.rowHeaderLevelCount,o),n.getCellHeaderPaths(n.rowHeaderLevelCount-2,o).rowHeaderPaths):(e=n.getDimensionKeyInChartSpec(r,n.columnHeaderLevelCount),n.getCellHeaderPaths(r,n.columnHeaderLevelCount-1).colHeaderPaths)).map(e=>({key:e.dimensionKey,value:e.value})).filter(e=>e.key);o.push({key:e,value:i.target.attribute.text}),a._selectedDimensionInChart.length&&isSameSelectedDimension(a._selectedDimensionInChart,o)||(a._selectedDimensionInChart=o,n.updateDataStateToChartInstance(),clearChartCacheImage(a.scenegraph),a.scenegraph.updateNextFrame())}else null!=(r=a._selectedDimensionInChart)&&r.length&&(a._selectedDimensionInChart.length=0,a.internalProps.layoutMap.updateDataStateToChartInstance(),clearChartCacheImage(a.scenegraph),a.scenegraph.updateNextFrame())})}function isSameSelectedDimension(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i].key!==t[i].key||e[i].value!==t[i].value)return!1;return!0}function bindAxisHoverEvent(r){r.isPivotChart()&&(r.on(TABLE_EVENT_TYPE.MOUSEENTER_CELL,i=>{r.scenegraph.getCell(i.col,i.row).forEachChildren(e=>{var t;\\\"axis\\\"===e.name&&(t=getAxisPosition(i.col,i.row,r.internalProps.layoutMap),i.axisPosition=t,r.fireListeners(TABLE_EVENT_TYPE.MOUSEENTER_AXIS,i))})}),r.on(TABLE_EVENT_TYPE.MOUSELEAVE_CELL,i=>{r.scenegraph.getCell(i.col,i.row).forEachChildren(e=>{var t;\\\"axis\\\"===e.name&&(t=getAxisPosition(i.col,i.row,r.internalProps.layoutMap),i.axisPosition=t,r.fireListeners(TABLE_EVENT_TYPE.MOUSELEAVE_AXIS,i))})}))}function getAxisPosition(e,t,i){if(i.indicatorsAsCol){if(i.hasTwoIndicatorAxes&&t===i.columnHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return\\\"top\\\";if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)return\\\"bottom\\\";if(e===i.rowHeaderLevelCount-1&&t>=i.rowHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return\\\"left\\\"}else{if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return\\\"left\\\";if(e===i.colCount-i.rightFrozenColCount&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return\\\"right\\\";if(t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount);}return\\\"bottom\\\"}function bindGroupTitleCheckboxChange(s){s.on(\\\"checkbox_state_change\\\",t=>{if(!0===(null==(i=s.internalProps.rowSeriesNumber)?void 0:i.enableTreeCheckbox)){var{col:i,row:r,checked:o}=t,n=s.getCellOriginRecord(i,r),a=s.dataSource.currentPagerIndexedData,l=s.getRecordShowIndexByCell(i,r);let e=a[l];isNumber_default(e)&&(e=[e]),n.vtableMerge?o?(s.getHierarchyState(i,r)===HierarchyState.collapse?updateChildrenCheckboxState(!0,e,s):setAllChildrenCheckboxState(!0,l,e,a,s),updateGroupTitleCheckboxState(l,e,a,s)):(s.getHierarchyState(i,r)===HierarchyState.collapse?updateChildrenCheckboxState(!1,e,s):setAllChildrenCheckboxState(!1,l,e,a,s),updateGroupTitleCheckboxState(l,e,a,s),s.stateManager.headerCheckedState._vtable_rowSeries_number!==(n=s.stateManager.updateHeaderCheckedState(\\\"_vtable_rowSeries_number\\\",i,r))&&s.scenegraph.updateHeaderCheckboxCellState(i,r,n)):updateGroupTitleCheckboxState(l,e,a,s)}})}function setAllChildrenCheckboxState(e,t,i,r,o){let n,a=t+1;for(;isArray_default(r[a])&&(null==(n=r[a])?void 0:n.length)>i.length;){var l=o.columnHeaderLevelCount+a;o.stateManager.setCheckedState(0,l,\\\"_vtable_rowSeries_number\\\",e),setCellCheckboxStateByAttribute(0,l,e,o),a++}}function updateGroupTitleCheckboxState(t,e,i,r){let o,n=e.length-1;if(0<n){let e=t-1;for(;0<n&&0<=e;)(isArray_default(i[e])&&(null==(o=i[e])?void 0:o.length)===n||1===n&&isNumber_default(i[e]))&&(updateParentCheckboxState(0,r.columnHeaderLevelCount+e,i[e],r),n--),e--}}function updateParentCheckboxState(e,t,i,r){let o=r.stateManager.checkedState,n=i.toString(),a=isArray_default(i)?i.length:1,l=!1;const s=[];var h,d;o.forEach((e,t)=>{l&&(t.split(\\\",\\\").length===a?l=!1:s.push(e._vtable_rowSeries_number)),t===n&&(l=!0)}),0!==s.length&&(h=s.every(e=>!!e),d=s.every(e=>!e),h?(r.stateManager.setCheckedState(e,t,\\\"_vtable_rowSeries_number\\\",!0),setCellCheckboxStateByAttribute(e,t,!0,r)):d?(r.stateManager.setCheckedState(e,t,\\\"_vtable_rowSeries_number\\\",!1),setCellCheckboxStateByAttribute(e,t,!1,r)):(r.stateManager.setCheckedState(e,t,\\\"_vtable_rowSeries_number\\\",\\\"indeterminate\\\"),setCellCheckboxStateByAttribute(e,t,\\\"indeterminate\\\",r)))}function updateChildrenCheckboxState(i,e,t){let r=t.stateManager.checkedState,o=e.toString(),n=isArray_default(e)?e.length:1,a=!1;r.forEach((e,t)=>{a&&(t.split(\\\",\\\").length===n?a=!1:e._vtable_rowSeries_number=i),t===o&&(a=!0)})}function bindButtonClickEvent(o){o.on(TABLE_EVENT_TYPE.CLICK_CELL,e=>{var{col:t,row:i,target:r}=e;\\\"button\\\"!==r.name||r.attribute.disable||o.hasListeners(TABLE_EVENT_TYPE.BUTTON_CLICK)&&o.fireListeners(TABLE_EVENT_TYPE.BUTTON_CLICK,{col:t,row:i,event:e.event})})}function bindIconClickEvent(h){h.on(TABLE_EVENT_TYPE.ICON_CLICK,e=>{var{col:t,row:i,x:r,y:o,funcType:n,icon:a,event:l}=e,s=h.stateManager;n===IconFuncTypeEnum.dropDown?s.triggerDropDownMenu(t,i,r,o,l):n===IconFuncTypeEnum.sort?s.triggerSort(t,i,a,l):n===IconFuncTypeEnum.frozen?s.triggerFreeze(t,i,a):n===IconFuncTypeEnum.drillDown?drillClick(h):n!==IconFuncTypeEnum.collapse&&n!==IconFuncTypeEnum.expand||(o=!(null==(r=s.select.ranges)||!r.length),s.updateSelectPos(-1,-1),s.endSelectCells(!0,o),h.toggleHierarchyState(t,i))})}function bindDropdownMenuClickEvent(e){e.on(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,()=>{e.stateManager.hideMenu()})}function bindDBClickAutoColumnWidthEvent(n){n.on(TABLE_EVENT_TYPE.DBLCLICK_CELL,e=>{if(e.federatedEvent){var t=getCellEventArgsSet(e.federatedEvent),i=n.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,null==(i=t.eventArgs)?void 0:i.targetCell),r=null!=(r=n.options.disableDblclickAutoResizeColWidth)?r:null==(r=n.options.resize)?void 0:r.disableDblclickAutoResizeColWidth;if(n.eventManager.checkCellFillhandle(t))n.fireListeners(TABLE_EVENT_TYPE.DBLCLICK_FILL_HANDLE,{});else if(n._canResizeColumn(i.col,i.row)&&0<=i.col&&!r){n.scenegraph.updateAutoColWidth(i.col),n.internalProps._widthResizedColMap.add(i.col),n.scenegraph.updateChartSizeForResizeColWidth(i.col);var t=n.stateManager,o=(t.columnResize.col<t.table.frozenColCount&&!t.table.isPivotTable()&&!t.table.transpose&&t.table.scenegraph.component.setFrozenColumnShadow(t.table.frozenColCount-1,t.columnResize.isRightFrozen),[]);for(let e=0;e<n.colCount;e++)o.push(n.getColWidth(e));n.fireListeners(TABLE_EVENT_TYPE.RESIZE_COLUMN_END,{col:i.col,colWidths:o})}}})}function rightButtonClickEvent(a){a.on(TABLE_EVENT_TYPE.CONTEXTMENU_CELL,e=>{var{col:t,row:i}=e,r=a.getSelectedCellRanges();let o=!1;if(0<r.length)for(let e=0;e<r.length;e++){var n=r[e];if(t>=n.start.col&&t<=n.end.col&&i>=n.start.row&&i<=n.end.row){o=!0;break}}o||a.selectCell(t,i)})}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var defaultStyle8,EventManager2=class{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.table=e,this.handleTextStickBindId=[],this.inertiaScroll=new InertiaScroll(e.stateManager),\\\"node\\\"===Env.mode||e.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){bindTableGroupListener(this),bindContainerDomListener(this),bindScrollBarListener(this),bindTouchListener(this),bindGesture(this)}updateEventBinder(){setTimeout(()=>{var e;this.table.isReleased||(checkHaveTextStick(this.table)&&0===(null==(e=this.handleTextStickBindId)?void 0:e.length)?(this.handleTextStickBindId.push(this.table.on(TABLE_EVENT_TYPE.SCROLL,e=>{handleTextStick(this.table)})),this.handleTextStickBindId.push(this.table.on(TABLE_EVENT_TYPE.RESIZE_COLUMN_END,e=>{handleTextStick(this.table)})),this.handleTextStickBindId.push(this.table.on(TABLE_EVENT_TYPE.RESIZE_ROW_END,e=>{handleTextStick(this.table)}))):!checkHaveTextStick(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),bindSparklineHoverEvent(this.table))},0)}bindSelfEvent(){this.table.isReleased||(bindIconClickEvent(this.table),bindDropdownMenuClickEvent(this.table),this.updateEventBinder(),bindMediaClick(this.table),bindDBClickAutoColumnWidthEvent(this.table),this.table.isPivotTable()&&checkHaveDrill(this.table)&&bindDrillEvent(this.table),bindSparklineHoverEvent(this.table),bindAxisClickEvent(this.table),bindAxisHoverEvent(this.table),bindGroupTitleCheckboxChange(this.table),bindButtonClickEvent(this.table),rightButtonClickEvent(this.table))}dealTableHover(e){var t;e&&(t=e.eventArgs,t)?this.table.stateManager.updateHoverPos(t.col,t.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(e){var t=e.eventArgs;t?this.table.stateManager.updateHoverIcon(t.col,t.row,t.target,t.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(e){}dealTableSelect(e,t){var i,r;return e?(i=e.eventArgs,!!i&&!(\\\"checkbox\\\"===i.target.name||\\\"radio\\\"===i.target.name||\\\"switch\\\"===i.target.name||\\\"button\\\"===i.target.name||(this.table.isHeader(i.col,i.row)&&isCellDisableSelect(this.table,i.col,i.row)?(t||this.table.stateManager.updateSelectPos(-1,-1),1):!this.table.isHeader(i.col,i.row)&&isCellDisableSelect(this.table,i.col,i.row)?(t||(r=!(null==(r=this.table.stateManager.select.ranges)||!r.length),this.table.stateManager.updateSelectPos(-1,-1),r&&this.table.stateManager.endSelectCells(!0,r)),1):!this.table.isPivotChart()||\\\"axis-label\\\"!==(null==(r=null==e?void 0:e.eventArgs)?void 0:r.target.name)&&\\\"chart\\\"!==(null==(r=null==e?void 0:e.eventArgs)?void 0:r.target.type)?(this.table.stateManager.updateSelectPos(i.col,i.row,i.event.shiftKey,i.event.ctrlKey||i.event.metaKey,!1,!t&&(null==(i=null==(r=this.table.options.select)?void 0:r.makeSelectCellVisible)||i)),0):(this.table.stateManager.updateSelectPos(-1,-1),1)))):(this.table.stateManager.updateSelectPos(-1,-1),!1)}dealFillSelect(i,r){var o=i.eventArgs;if(o){if(null!=(n=null==(n=this.table.stateManager.select)?void 0:n.ranges)&&n.length&&this.table.stateManager.isFillHandle()){let e,t;var n=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];r&&(isValid_default(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-i.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-i.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-i.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-i.abstractPos.x)?0<this.table.stateManager.fillHandle.startY-i.abstractPos.y?this.table.stateManager.fillHandle.direction=\\\"top\\\":this.table.stateManager.fillHandle.direction=\\\"bottom\\\":0<this.table.stateManager.fillHandle.startX-i.abstractPos.x?this.table.stateManager.fillHandle.direction=\\\"left\\\":this.table.stateManager.fillHandle.direction=\\\"right\\\",t=(this.table.stateManager.fillHandle.directionRow?(e=o.row,n.end):(e=n.end.row,o)).col),this.table.stateManager.updateSelectPos(r?t:n.end.col,r?e:n.end.row,!0,o.event.ctrlKey||o.event.metaKey,!1,!r)}else this.table.stateManager.updateSelectPos(o.col,o.row,o.event.shiftKey,o.event.ctrlKey||o.event.metaKey,!1,!r);return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(TABLE_EVENT_TYPE.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(e){}checkColumnResize(e,t){var i=e.eventArgs;return!(this.table.options.enableTreeStickCell&&!i||(i=this.table.scenegraph.getResizeColAt(e.abstractPos.x,e.abstractPos.y,null==i?void 0:i.targetCell),this.table._canResizeColumn(i.col,i.row)&&0<=i.col?(t&&this.table.stateManager.startResizeCol(i.col,e.abstractPos.x,e.abstractPos.y,i.rightFrozen),0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),1)))}checkRowResize(e,t){var i=e.eventArgs;if(i){i=this.table.scenegraph.getResizeRowAt(e.abstractPos.x,e.abstractPos.y,i.targetCell);if(this.table._canResizeRow(i.col,i.row)&&0<=i.row)return t&&this.table.stateManager.startResizeRow(i.row,e.abstractPos.x,e.abstractPos.y,i.bottomFrozen),!0}return!1}cellIsHeaderCheck(e,t){var i=e.eventArgs,{col:r,row:o,target:n}=i;return!!this.table.isHeader(r,o)&&\\\"checkbox\\\"===this.table.getCellType(i.col,i.row)&&\\\"checkbox\\\"===n.name}checkCellFillhandle(e,t){var i;if(null!=(r=this.table.options.excelOptions)&&r.fillHandle){var r=e.eventArgs;if(r&&null!=(r=null==(r=this.table.stateManager.select)?void 0:r.ranges)&&r.length){var r=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),o=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),r=this.table.scenegraph.highPerformanceGetCell(r,o).globalAABBBounds,o=Math.abs(e.abstractPos.x-r.x2),r=Math.abs(e.abstractPos.y-r.y2);if(null!=(i=this.table.stateManager.fillHandle)&&i.isFilling||o<=9&&r<=9)return t&&this.table.stateManager.startFillSelect(e.abstractPos.x,e.abstractPos.y),!0}}return!1}dealColumnResize(e,t){this.table.stateManager.updateResizeCol(e,t)}dealRowResize(e,t){this.table.stateManager.updateResizeRow(e,t)}checkColumnMover(e){var t=e.eventArgs;return!(!t||!this.table._canDragHeaderPosition(t.col,t.row)||(this.table.stateManager.startMoveCol(t.col,t.row,e.abstractPos.x,e.abstractPos.y,null==(t=null==t?void 0:t.event)?void 0:t.nativeEvent),0))}dealColumnMover(e){var t=e.eventArgs;isValid_default(t.col)&&isValid_default(t.row)&&this.table.stateManager.updateMoveCol(t.col,t.row,e.abstractPos.x,e.abstractPos.y,null==(t=null==t?void 0:t.event)?void 0:t.nativeEvent)}startColumnResize(e){}dealIconClick(e,t){var i=t.eventArgs,{target:i,event:r,col:o,row:n}=i||{target:e.target,event:e,col:-1,row:-1},a=i;if(a.role&&a.role.startsWith(\\\"icon-\\\"))return this.table.fireListeners(TABLE_EVENT_TYPE.ICON_CLICK,{name:a.name,x:(a.globalAABBBounds.x1+a.globalAABBBounds.x2)/2,y:a.globalAABBBounds.y2,col:o,row:n,funcType:a.attribute.funcType,icon:a,event:r}),!0;if(i instanceof RichText){a=i.pickIcon(r.global);if(a)return this.table.fireListeners(TABLE_EVENT_TYPE.ICON_CLICK,{name:a.attribute.id,x:a.globalX+a.globalAABBBounds.width()/2,y:a.globalY+a.AABBBounds.height(),col:o,row:n,funcType:a.attribute.funcType,icon:a,event:r}),!0}return!1}release(){this.gesture.release(),this.globalEventListeners.forEach(e=>{\\\"document\\\"===e.env?document.removeEventListener(e.name,e.callback):\\\"body\\\"===e.env?document.body.removeEventListener(e.name,e.callback):\\\"window\\\"===e.env&&window.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}},DEFAULT_BAR_COLOR=(init_esbuild_inject(),init_esbuild_inject(),e=>{var t=e.value;return 80<Number(t)?\\\"#20a8d8\\\":50<Number(t)?\\\"#4dbd74\\\":20<Number(t)?\\\"#ffc107\\\":\\\"#f86c6b\\\"}),ProgressBarStyle=class joc extends Style{static get DEFAULT(){return defaultStyle8=defaultStyle8||new joc}constructor(e={},t={}){var i;super(e,t),this._showBar=null==(i=e.showBar)||i,this._barColor=null!=(i=e.barColor)?i:DEFAULT_BAR_COLOR,this._barPositiveColor=null!=(i=e.barPositiveColor)?i:\\\"#4dbd74\\\",this._barNegativeColor=null!=(i=e.barNegativeColor)?i:\\\"#f86c6b\\\",this._barAxisColor=null!=(i=e.barAxisColor)?i:\\\"black\\\",this._barBgColor=e.barBgColor,this._barHeight=null!=(i=e.barHeight)?i:3,this._barHeight=null!=(i=e.barHeight)?i:3,this._barBottom=null!=(i=e.barBottom)?i:0,this._barPadding=null!=(i=e.barPadding)?i:[0,0,0,0],this._showBarMark=null!=(i=e.showBarMark)&&i,this._barMarkPositiveColor=null!=(i=e.barMarkPositiveColor)?i:\\\"#4dbd74\\\",this._barMarkNegativeColor=null!=(i=e.barMarkNegativeColor)?i:\\\"#f86c6b\\\",this._barMarkWidth=null!=(i=e.barMarkWidth)?i:2,this._barMarkPosition=null!=(i=e.barMarkPosition)?i:\\\"right\\\",this._barRightToLeft=null!=(i=e.barRightToLeft)&&i}get showBar(){return this._showBar}set showBar(e){this._showBar=e}get barColor(){return this._barColor}set barColor(e){this._barColor=e}get barBgColor(){return this._barBgColor}set barBgColor(e){this._barBgColor=e}get barHeight(){return this._barHeight}set barHeight(e){this._barHeight=e}get barBottom(){return this._barBottom}set barBottom(e){this._barBottom=e}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(e){this._barPositiveColor=e}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(e){this._barNegativeColor=e}get barAxisColor(){return this._barAxisColor}set barAxisColor(e){this._barAxisColor=e}get barPadding(){return this._barPadding}set barPadding(e){this._barPadding=e}get showBarMark(){return this._showBarMark}set showBarMark(e){this._showBarMark=e}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(e){this._barMarkPositiveColor=e}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(e){this._barMarkNegativeColor=e}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(e){this._barMarkWidth=e}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(e){this._barMarkPosition=e}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(e){this._barRightToLeft=e}clone(){return new joc(this,null)}},ICON_PROP_KEYS=(init_esbuild_inject(),[\\\"type\\\",\\\"content\\\",\\\"style\\\",\\\"color\\\",\\\"width\\\",\\\"height\\\",\\\"marginRight\\\",\\\"marginLeft\\\",\\\"src\\\",\\\"svg\\\",\\\"name\\\",\\\"path\\\",\\\"positionType\\\",\\\"tooltip\\\",\\\"hover\\\",\\\"cursor\\\",\\\"shape\\\",\\\"interactive\\\",\\\"isGif\\\"]),iconPropKeys=ICON_PROP_KEYS,BodyHelper=class{constructor(e){this._table=e;var t=get3();this.expandIcon=t[InternalIconName.expandIconName],this.collapseIcon=t[InternalIconName.collapseIconName]}getIcons(i,r,t,o,e){const n=[],a=this.getHierarchyIcon(i,r);a&&n.push(a);var l=this._table.getBodyColumnDefine(i,r).icon;if(l){let e;e=\\\"function\\\"==typeof l?l({col:i,row:r,value:t,dataValue:o,table:this._table}):l;const s=get3(),h=e=>{var t=\\\"string\\\"==typeof e?s[e]:e;t&&n.push(t)};Array.isArray(e)?e.forEach((e,t)=>{h(e)}):h(e)}return e&&n.forEach((e,t)=>{(e.content||e.src)&&(n[t]=this.getCellIconFromRecordValue(e,i,r))}),n}getStyleClass(e){switch(e){case\\\"text\\\":case\\\"link\\\":return TextStyle;case\\\"image\\\":case\\\"video\\\":return ImageStyle;case\\\"chart\\\":case\\\"sparkline\\\":return Style;case\\\"progressbar\\\":return ProgressBarStyle;case\\\"checkbox\\\":return CheckboxStyle;case\\\"radio\\\":return RadioStyle;case\\\"switch\\\":return SwitchStyle;case\\\"button\\\":return ButtonStyle}return TextStyle}getCellIconFromRecordValue(e,r,o){if(Array.isArray(e))return e.map(e=>this.getCellIconFromRecordValue(e,r,o));if(!obj.isObject(e)||\\\"function\\\"==typeof e)return this._table.getFieldData(e,r,o);const n={},a=e;return iconPropKeys.forEach(e=>{var t,i;void 0!==a[e]&&(i=this._table.getFieldData(a[e],r,o),isValid_default(i)?n[e]=i:null!=(t=(i=this._table)._hasField)&&t.call(i,a[e],r,o)||(n[e]=a[e]))}),n}getHierarchyIcon(e,t){var i=this._table.getHierarchyState(e,t);return i===HierarchyState.expand?this.expandIcon:i===HierarchyState.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var e;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}};function createElement(e,t){var i=document.createElement(e);return t&&i.classList.add(...t),i}function importStyle2(){var e;\\\"node\\\"!==Env.mode&&((e=document.createElement(\\\"style\\\")).id=\\\"vtable-menu-styleSheet\\\",e.textContent=\\\"\\\\n@keyframes vtable__menu-element--shown-animation {\\\\n\\\\t0% {\\\\n\\\\t\\\\topacity: 0;\\\\n\\\\t}\\\\n\\\\t100% {\\\\n\\\\t\\\\topacity: 1;\\\\n\\\\t}\\\\n}\\\\n.vtable__menu-element {\\\\n\\\\tposition: absolute;\\\\n\\\\tbox-sizing: border-box;\\\\n\\\\tborder-radius: 4px;\\\\n\\\\tbackground-color: #fff;\\\\n\\\\tpadding: 6px 0;\\\\n\\\\t/* pointer-events: none; */\\\\n\\\\tuser-select: none;\\\\n\\\\tcolor: #000;\\\\n\\\\tmax-width: 300px;\\\\n\\\\tz-index: 99999;\\\\n\\\\tborder: #CCC 0.5px solid;\\\\n\\\\tcursor: default;\\\\n\\\\twidth: max-content;\\\\n\\\\tbox-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);\\\\n  max-height: 100%;\\\\n  overflow-y: auto;\\\\n}\\\\n.vtable__menu-element--hidden {\\\\n\\\\topacity: 0;\\\\n\\\\t/* transform: translate(-50%, -50%); */\\\\n\\\\ttransition: opacity 75ms linear;\\\\n\\\\tz-index: -9999;\\\\n}\\\\n.vtable__menu-element--shown {\\\\n\\\\topacity: 1;\\\\n\\\\t/* transform: translate(-50%, -50%); */\\\\n\\\\tanimation: vtable__menu-element--shown-animation 150ms ease-out;\\\\n}\\\\n.vtable__menu-element__content {\\\\n\\\\tfont-family: Roboto;\\\\n\\\\tfont-size: 12px;\\\\n\\\\toverflow: hidden;\\\\n\\\\tdisplay: inline-block;\\\\n\\\\t/* height: 100%; */\\\\n\\\\tline-height: 30px;\\\\n}\\\\n.vtable__menu-element__item {\\\\n\\\\theight: 32px;\\\\n\\\\tpadding: 0px 12px;\\\\n\\\\tcursor: pointer;\\\\n\\\\tposition: relative;\\\\n\\\\tdisplay: flex;\\\\n\\\\talign-items: center;\\\\n\\\\tjustify-content: flex-start;\\\\n}\\\\n.vtable__menu-element__item:hover {\\\\n\\\\tbackground-color: rgba(27, 31, 35, 0.06);\\\\n}\\\\n.vtable__menu-element__icon{\\\\n\\\\t/* vertical-align: top; */\\\\n\\\\tdisplay: flex;\\\\n\\\\t/* line-height: 30px; */\\\\n\\\\tmargin-right: 6px;\\\\n}\\\\n.vtable__menu-element__no-event {\\\\n\\\\tpointer-events: none;\\\\n}\\\\n.vtable__menu-element--select {\\\\n\\\\tcolor: #2E68CF;\\\\n}.vtable__menu-element--normal {\\\\n\\\\tcolor: rgba(20, 20, 20, 0.9);;\\\\n}\\\\n.vtable__menu-element__split {\\\\n\\\\theight: 0px;\\\\n\\\\tborder: 1px solid rgb(209, 213, 218);\\\\n\\\\tmargin: 5px 0;\\\\n}\\\\n.vtable__menu-element__title {\\\\n\\\\tcolor: rgb(149, 149, 149);\\\\n}\\\\n.vtable__menu-element__arrow {\\\\n\\\\tposition: absolute;\\\\n\\\\tright: 3px;\\\\n\\\\tfont-weight: bold;\\\\n\\\\tmargin-top: 1px;\\\\n}\\\\n.vtable__menu-element__item-text {\\\\n\\\\tmargin-right: 15px;\\\\n}\\\\n\\\",document.head.appendChild(e))}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),importStyle2();var CLASSNAME=\\\"vtable__menu-element\\\",ITEM_CLASSNAME=CLASSNAME+\\\"__item\\\",CONTENT_CLASSNAME=CLASSNAME+\\\"__content\\\",HIDDEN_CLASSNAME=CLASSNAME+\\\"--hidden\\\",SHOWN_CLASSNAME=CLASSNAME+\\\"--shown\\\",NORAML_CLASSNAME=CLASSNAME+\\\"--normal\\\",SELECT_CLASSNAME=CLASSNAME+\\\"--select\\\",ICOM_CLASSNAME=CLASSNAME+\\\"__icon\\\",SPLIT_CLASSNAME=CLASSNAME+\\\"__split\\\",TITLE_CLASSNAME=CLASSNAME+\\\"__title\\\",ARROW_CLASSNAME=CLASSNAME+\\\"__arrow\\\",NOEVENT_CLASSNAME=CLASSNAME+\\\"__no-event\\\",ITEMTEXT_CLASSNAME=CLASSNAME+\\\"__item-text\\\";function createMenuDomElement(){return createElement(\\\"div\\\",[CLASSNAME,HIDDEN_CLASSNAME])}function isMenuHighlight(i,r,o,e,t,n){var a=i.getCellRange(e,t);for(let d=0;d<r.length;d++){var l=r[d];let{col:e,row:t}=l;var{field:l,menuKey:s}=l;if(\\\"number\\\"!=typeof e||\\\"number\\\"!=typeof t)if(i.isPivotTable()&&(Array.isArray(l),1)){var h=i.internalProps.layoutMap.getPivotCellAdress(l);if(!h)continue;e=h.col,t=h.row}else{h=i.internalProps.layoutMap.getHeaderCellAddressByField(l);if(!h)continue;e=h.col,t=h.row}if(isValid_default(e)&&isValid_default(t)&&cellInRange(a,e,t)&&o===s)return!0}return!1}var defaultStyle9,MenuElement=class{constructor(d){var e;this._handler=new EventHandler,this._rootElement=createMenuDomElement(),this._secondElement=createMenuDomElement(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener(\\\"wheel\\\",e=>{e.stopPropagation()}),null!=(e=this._rootElement)&&e.addEventListener(\\\"mousedown\\\",e=>{e.stopPropagation(),e.preventDefault()}),null!=(e=this._rootElement)&&e.addEventListener(\\\"contextmenu\\\",e=>{e.stopPropagation(),e.preventDefault()}),null!=(e=this._rootElement)&&e.addEventListener(\\\"touchend\\\",e=>{var t,i,r,o,n,a;e.stopPropagation(),e.preventDefault(),this._rootElement.classList.contains(HIDDEN_CLASSNAME)||(({col:t,row:i,dropDownIndex:a,menuKey:r,text:o,hasChildren:n}=e.target),\\\"number\\\"!=typeof a||n||(n=d.isPivotTable()?d.internalProps.layoutMap.getPivotDimensionInfo(t,i):d.getHeaderField(t,i),a=d._dropDownMenuIsHighlight(t,i,a),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,{col:t,row:i,field:n,menuKey:r,text:o,highlight:a,cellLocation:d.getCellLocation(t,i),event:e}),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,null),d.fireListeners(TABLE_EVENT_TYPE.HIDE_MENU,null)),e.stopPropagation())}),null!=(e=this._rootElement)&&e.addEventListener(\\\"click\\\",e=>{var t,i,r,o,n,a;e.stopPropagation(),e.preventDefault(),this._rootElement.classList.contains(HIDDEN_CLASSNAME)||(({col:t,row:i,dropDownIndex:a,menuKey:r,text:o,hasChildren:n}=e.target),\\\"number\\\"!=typeof a||n||(n=d.isPivotTable()?d.internalProps.layoutMap.getPivotDimensionInfo(t,i):d.getHeaderField(t,i),a=d._dropDownMenuIsHighlight(t,i,a),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,{col:t,row:i,field:n,menuKey:r,text:o,highlight:a,cellLocation:d.getCellLocation(t,i),event:e}),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,null),d.fireListeners(TABLE_EVENT_TYPE.HIDE_MENU,null)),e.stopPropagation())}),null!=(e=this._rootElement)&&e.addEventListener(\\\"mousemove\\\",t=>{if(!this._rootElement.classList.contains(HIDDEN_CLASSNAME)){t.stopPropagation();var{hasChildren:i,dropDownIndex:r,col:o,row:n,sub:e}=t.target;if(i){this._showChildrenIndex=r;var a=this._secondElement,l=(null!=a&&a.classList.remove(HIDDEN_CLASSNAME),null!=a&&a.classList.add(SHOWN_CLASSNAME),a.innerHTML=\\\"\\\",null==(i=this._menuInstanceInfo.content[r])?void 0:i.children);for(let e=0;e<l.length;e++){var s=l[e],h=createItem(s,!!d.stateManager.menu.dropDownMenuHighlight&&isMenuHighlight(d,d.stateManager.menu.dropDownMenuHighlight,\\\"object\\\"==typeof s?(null==s?void 0:s.menuKey)||(null==s?void 0:s.text):s,o,n,e));h.col=o,h.row=n,h.dropDownIndex=e,\\\"string\\\"==typeof s?(h.text=s,h.menuKey=s):\\\"object\\\"==typeof s&&(h.text=s.text,h.menuKey=s.menuKey||s.text),h.sub=!0,h.sub=!0,a.appendChild(h)}r=t.target.getBoundingClientRect();this._bindSecondElement(d,o,n,r.right,r.top)}else!e&&null!=(i=this._secondElement)&&i.classList.contains(SHOWN_CLASSNAME)&&setTimeout(()=>{var e;!0!==this._mouseEnterSecondElement&&(this._showChildrenIndex=-1,null!=(e=this._secondElement)&&e.classList.remove(SHOWN_CLASSNAME),null!=e)&&e.classList.add(HIDDEN_CLASSNAME)},300)}}),null!=(e=this._secondElement)&&e.addEventListener(\\\"wheel\\\",e=>{e.stopPropagation()}),null!=(e=this._secondElement)&&e.addEventListener(\\\"mousemove\\\",e=>{this._rootElement.classList.contains(HIDDEN_CLASSNAME)||e.stopPropagation()}),null!=(e=this._secondElement)&&e.addEventListener(\\\"mouseenter\\\",e=>{this._mouseEnterSecondElement=!0}),null!=(e=this._secondElement)&&e.addEventListener(\\\"mouseleave\\\",e=>{this._mouseEnterSecondElement=!1}),null!=(e=this._secondElement)&&e.addEventListener(\\\"mousedown\\\",e=>{e.stopPropagation(),e.preventDefault()}),null!=(e=this._secondElement)&&e.addEventListener(\\\"click\\\",l=>{if(l.stopPropagation(),l.preventDefault(),!this._secondElement.classList.contains(HIDDEN_CLASSNAME)){let{col:o,row:n,dropDownIndex:e,menuKey:a,text:t,hasChildren:i}=l.target;if(\\\"number\\\"==typeof e&&!i){var s=d.isPivotTable()?d.internalProps.layoutMap.getPivotDimensionInfo(o,n):d.getHeaderField(o,n);let r=!1;this._menuInstanceInfo.content.forEach((t,e)=>{if(\\\"object\\\"==typeof t&&t.children&&t.children.length)for(let e=0;e<t.children.length;e++){var i=t.children[e];if(isMenuHighlight(d,d.stateManager.menu.dropDownMenuHighlight,\\\"object\\\"==typeof i?null==i?void 0:i.menuKey:i,o,n,-1)&&a===(\\\"object\\\"==typeof i?null==i?void 0:i.menuKey:i))return void(r=!0)}}),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,{col:o,row:n,field:s,cellHeaderPaths:d.isPivotTable()?d.getCellHeaderPaths(o,n):void 0,menuKey:a,text:t,highlight:r,cellLocation:d.getCellLocation(o,n),event:l}),d.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,null),d.fireListeners(TABLE_EVENT_TYPE.HIDE_MENU,null)}l.stopPropagation()}})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();var e=this._rootElement;null!=e&&e.parentElement&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(i,r,o,t){var n,a=this._rootElement,e=this._secondElement;if(this._menuInstanceInfo=t,null!=a&&a.classList.remove(SHOWN_CLASSNAME),null!=a&&a.classList.add(HIDDEN_CLASSNAME),null!=e&&e.classList.remove(SHOWN_CLASSNAME),null!=e&&e.classList.add(HIDDEN_CLASSNAME),this._canBindToCell(i,r,o)){if(a.innerHTML=\\\"\\\",Array.isArray(t.content)){var l=t.content;for(let e=0;null!==(d=e<(null==l?void 0:l.length))&&d;e++){var s=l[e];let t=!!i.stateManager.menu.dropDownMenuHighlight&&isMenuHighlight(i,i.stateManager.menu.dropDownMenuHighlight,\\\"object\\\"==typeof s?(null==s?void 0:s.menuKey)||(null==s?void 0:s.text):s,r,o,e);if(i.stateManager.menu.dropDownMenuHighlight&&\\\"object\\\"==typeof s&&Array.isArray(s.children)&&s.children.length)for(let e=0;e<s.children.length;e++){var h=s.children[e];if(isMenuHighlight(i,i.stateManager.menu.dropDownMenuHighlight,\\\"object\\\"==typeof h?(null==h?void 0:h.menuKey)||(null==h?void 0:h.text):h,r,o,e)){t=!0;break}}var d=createItem(s,t);d.col=r,d.row=o,d.dropDownIndex=e,\\\"string\\\"==typeof s?(d.text=s,d.menuKey=s):\\\"object\\\"==typeof s&&(d.text=s.text,d.menuKey=s.menuKey||s.text,null!=(n=s.children))&&n.length&&(d.hasChildren=!0),a.appendChild(d)}}if(this._bindToCell(i,r,o,t.position,t.referencePosition))return null!=a&&a.classList.add(SHOWN_CLASSNAME),null!=a&&a.classList.remove(HIDDEN_CLASSNAME),!0}else this.unbindFromCell();return!1}unbindFromCell(){var e=this._rootElement,t=this._secondElement;this._menuInstanceInfo=void 0,null!=e&&e.parentElement&&(e.classList.remove(SHOWN_CLASSNAME),e.classList.add(HIDDEN_CLASSNAME)),null!=t&&t.parentElement&&(t.classList.remove(SHOWN_CLASSNAME),t.classList.add(HIDDEN_CLASSNAME))}_canBindToCell(e,t,i){var r=e.getCellRangeRelativeRect({col:t,row:i}),o=null!=(o=e.internalProps.menu.parentElement)?o:e.getElement(),{top:r,bottom:n,left:a,right:l}=r;return!!e.isFrozenCell(t,i)||!(n<e.getFrozenRowsHeight()||l<e.getFrozenColsWidth()||a>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||r>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()||(({offsetHeight:n,offsetWidth:l}=o),n<r)||l<a)}_bindToCell(o,e,t,n,a){var l=this._rootElement,s=null!=(s=o.internalProps.menu.parentElement)?s:o.getElement(),{width:h,height:d,left:u,top:c}=s.getBoundingClientRect();if(l){l.parentElement!==s&&s.appendChild(l),l.style.left=\\\"0px\\\";l.style.maxWidth=.8*h+\\\"px\\\";var g=l.offsetWidth,p=l.offsetHeight;let e,t;n?(e=n.x,t=n.y):a&&(e=a.rect.right-g,t=a.rect.bottom);var f=s.getBoundingClientRect(),m=f.width/s.offsetWidth,f=f.height/s.offsetHeight;(t=t*f+p>d?(d-p)/f:t)<0&&(t/=2);let i=0,r=0;return o.getElement()!==s&&(({left:d,top:p}=o.getElement().getBoundingClientRect()),i=p-c,r=d-u),l.style.top=t+i+\\\"px\\\",e<0?e=0:e*m+g>h&&(e=(h-g)/m),l.style.left=e+r+\\\"px\\\",!0}return!1}_bindSecondElement(e,t,i,r,o){var n=this._secondElement,a=this._rootElement,l=null!=(l=e.internalProps.menu.parentElement)?l:e.getElement(),{width:s,left:h,top:d}=l.getBoundingClientRect(),a=a.getBoundingClientRect().width;if(n){n.parentElement!==l&&l.appendChild(n),n.style.left=\\\"0px\\\";n.style.maxWidth=.8*s+\\\"px\\\";l=n.clientWidth,h=r-h;n.style.top=o-4-d+\\\"px\\\";let e=h;return e+l>s?e=e-l-a:e+=4,n.style.left=e+\\\"px\\\",!0}return!1}pointInMenuElement(e,t){var i=this._rootElement,{x:r,y:o,width:n,height:a}=i.getBoundingClientRect();if(r-5<e&&e<r+n+5&&o-5<t&&t<o+a+5)return!0;if(this._secondElement){var{x:r,y:n,width:o,height:a}=i.getBoundingClientRect();if(r-5<e&&e<r+o+5&&n-5<t&&t<n+a+5)return!0}return!1}};function createItem(e,t){var i=createElement(\\\"div\\\",[ITEM_CLASSNAME,t?SELECT_CLASSNAME:NORAML_CLASSNAME]);if(\\\"string\\\"==typeof e){var r=createElement(\\\"span\\\",[CONTENT_CLASSNAME,NOEVENT_CLASSNAME,ITEMTEXT_CLASSNAME]);r.innerHTML=e,i.appendChild(r)}else if(\\\"object\\\"==typeof e){r=null!=(r=e.type)?r:\\\"item\\\";if(\\\"split\\\"===r)return null!=i&&i.classList.add(SPLIT_CLASSNAME),i;null!=(o=null==e?void 0:e.icon)&&o.svg&&(regUrl.test(e.icon.svg)?(o=new Image,e.icon.width?o.style.width=e.icon.width.toString()+\\\"px\\\":o.style.width=\\\"16px\\\",e.icon.height?o.style.height=e.icon.height.toString()+\\\"px\\\":o.style.height=\\\"16px\\\",o.src=e.icon.svg,i.appendChild(o)):((o=createElement(\\\"span\\\",[ICOM_CLASSNAME,NOEVENT_CLASSNAME])).innerHTML=(t&&e.selectedIcon&&e.selectedIcon.svg?e.selectedIcon:e.icon).svg,e.icon.width&&o.children[0].setAttribute(\\\"width\\\",e.icon.width.toString()),e.icon.height&&o.children[0].setAttribute(\\\"height\\\",e.icon.height.toString()),i.appendChild(o)));var o=createElement(\\\"span\\\",[CONTENT_CLASSNAME,NOEVENT_CLASSNAME,ITEMTEXT_CLASSNAME]);o.innerHTML=e.text,i.appendChild(o),\\\"title\\\"===r?null!=i&&i.classList.add(NOEVENT_CLASSNAME,TITLE_CLASSNAME):null!=(o=null==e?void 0:e.children)&&o.length&&((r=createElement(\\\"span\\\",[CONTENT_CLASSNAME,NOEVENT_CLASSNAME,ARROW_CLASSNAME])).innerHTML=t?'<svg width=\\\"8\\\" height=\\\"12\\\" viewBox=\\\"0 0 10 17\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" style=\\\"vertical-align: baseline\\\"><path d=\\\"M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z\\\" fill=\\\"#2E68CF\\\" fill-opacity=\\\"0.65\\\"></path></svg>':'<svg width=\\\"8\\\" height=\\\"12\\\" viewBox=\\\"0 0 10 17\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" style=\\\"vertical-align: baseline\\\"><path d=\\\"M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z\\\" fill=\\\"#141414\\\" fill-opacity=\\\"0.65\\\"></path></svg>',i.appendChild(r))}return i}init_esbuild_inject(),init_esbuild_inject();var defaultStyle10,defaultStyle11,defaultStyle12,EVENT_TYPE3={CHANGE_STYLE:\\\"change_style\\\"},Style2=class Tsc extends EventTarget3{static get EVENT_TYPE(){return EVENT_TYPE3}static get DEFAULT(){return defaultStyle9=defaultStyle9||new Tsc}constructor(e={},t={}){var i;super(),this._defaultPadding=[10,16,10,16],this._color=null!=(i=e.color)?i:null==t?void 0:t.color,this._strokeColor=null!=(i=null==e?void 0:e.strokeColor)?i:null==t?void 0:t.strokeColor,this._fontSize=null!=(i=e.fontSize)?i:null==t?void 0:t.fontSize,this._fontFamily=null!=(i=e.fontFamily)?i:null==t?void 0:t.fontFamily,this._fontWeight=null!=(i=e.fontWeight)?i:null==t?void 0:t.fontWeight,this._fontVariant=null!=(i=e.fontVariant)?i:null==t?void 0:t.fontVariant,this._fontStyle=null!=(i=e.fontStyle)?i:null==t?void 0:t.fontStyle,this._textOverflow=(null!=(i=e.textOverflow)?i:null==t?void 0:t.textOverflow)||\\\"ellipsis\\\",this._textStick=null!=(i=null!=(i=e.textStick)?i:null==t?void 0:t.textStick)&&i,this._textStickBaseOnAlign=null!=(i=null!=(i=e.textStickBaseOnAlign)?i:null==t?void 0:t.textStickBaseOnAlign)&&i,this._marked=null!=(i=null!=(i=e.marked)?i:null==t?void 0:t.marked)&&i,this._textAlign=(null!=(i=e.textAlign)?i:null==t?void 0:t.textAlign)||\\\"left\\\",this._textBaseline=(null!=(i=e.textBaseline)?i:null==t?void 0:t.textBaseline)||\\\"middle\\\",this._bgColor=null!=(i=e.bgColor)?i:null==t?void 0:t.bgColor,this._padding=null!=(i=null!=(i=e.padding)?i:null==t?void 0:t.padding)?i:this._defaultPadding,this._borderColor=null!=(i=e.borderColor)?i:null==t?void 0:t.borderColor,this._lineHeight=null!=(i=e.lineHeight)?i:null==t?void 0:t.lineHeight,this._underline=null!=(i=e.underline)?i:null==t?void 0:t.underline,this._underlineColor=null!=(i=e.underlineColor)?i:null==t?void 0:t.underlineColor,this._underlineDash=null!=(i=e.underlineDash)?i:null==t?void 0:t.underlineDash,this._underlineOffset=null!=(i=e.underlineOffset)?i:null==t?void 0:t.underlineOffset,this._lineThrough=null!=(i=e.lineThrough)?i:null==t?void 0:t.lineThrough,this._lineThroughColor=null!=(i=e.lineThroughColor)?i:null==t?void 0:t.lineThroughColor,this._lineThroughDash=null!=(i=e.lineThroughDash)?i:null==t?void 0:t.lineThroughDash,this._linkColor=null!=(i=e.linkColor)?i:null==t?void 0:t.linkColor,this._cursor=null!=(i=e.cursor)?i:null==t?void 0:t.cursor,this._borderLineWidth=null!=(i=e.borderLineWidth)?i:null==t?void 0:t.borderLineWidth,this._borderLineDash=null!=(i=e.borderLineDash)?i:null==t?void 0:t.borderLineDash}get bgColor(){return this._bgColor}set bgColor(e){this._bgColor=e}get color(){return this._color}set color(e){this._color=e}get strokeColor(){return this._strokeColor}set strokeColor(e){this._strokeColor=e}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize=e}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e}get textOverflow(){return this._textOverflow}set textOverflow(e){this._textOverflow=e}get padding(){var e;return null!=(e=this._padding)?e:this._defaultPadding}set padding(e){this._padding=e}get borderColor(){return this._borderColor}set borderColor(e){this._borderColor=e}get textStick(){return this._textStick}set textStick(e){this._textStick=e}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(e){this._textStickBaseOnAlign=e}get marked(){return this._marked}set marked(e){this._marked=e}get textAlign(){return this._textAlign}set textAlign(e){this._textAlign=e}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e}get underline(){return this._underline}set underline(e){this._underline=e}get underlineColor(){return this._underlineColor}set underlineColor(e){this._underlineColor=e}get underlineDash(){return this._underlineDash}set underlineDash(e){this._underlineDash=e}get underlineOffset(){return this._underlineOffset}set underlineOffset(e){this._underlineOffset=e}get lineThrough(){return this._lineThrough}set lineThrough(e){this._lineThrough=e}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(e){this._lineThroughColor=e}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(e){this._lineThroughDash=e}get linkColor(){return this._linkColor}set linkColor(e){this._linkColor=e}get cursor(){return this._cursor}set cursor(e){this._cursor=e}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(e){this._borderLineWidth=e}get borderLineDash(){return this._borderLineDash}set borderLineDash(e){this._borderLineDash=e}clone(){return new Tsc(this)}},ImageStyle2=class buc extends Style2{static get DEFAULT(){return defaultStyle10=defaultStyle10||new buc}constructor(e={},t={}){var i;super(e,t),this.textAlign=(null!=(i=e.textAlign)?i:null==t?void 0:t.textAlign)||\\\"center\\\"}clone(){return new buc(this)}},TextHeaderStyle=(init_esbuild_inject(),init_esbuild_inject(),class fuc extends Style2{static get DEFAULT(){return defaultStyle11=defaultStyle11||new fuc}constructor(e={},t=null){var i;super(e,t),this._autoWrapText=null!=(i=null==e?void 0:e.autoWrapText)?i:null==t?void 0:t.autoWrapText,this._lineClamp=null!=(i=null==e?void 0:e.lineClamp)?i:null==t?void 0:t.lineClamp}clone(){return new fuc(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(e){this._lineClamp=e}get autoWrapText(){return this._autoWrapText}set autoWrapText(e){this._autoWrapText=e}}),CheckboxStyle2=(init_esbuild_inject(),class muc extends Style2{static get DEFAULT(){return defaultStyle12=defaultStyle12||new muc}constructor(e={},t={},i={}){var r;super(e,t),this._size=(null!=(r=null!=(r=null==e?void 0:e.size)?r:null==t?void 0:t.size)?r:null==i?void 0:i.size)||14,this._spaceBetweenTextAndIcon=(null!=(r=null!=(r=null==e?void 0:e.spaceBetweenTextAndIcon)?r:null==t?void 0:t.spaceBetweenTextAndIcon)?r:null==i?void 0:i.spaceBetweenTextAndIcon)||8,this._defaultFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.defaultFill)?r:null==i?void 0:i.defaultFill,this._defaultStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.defaultStroke)?r:null==i?void 0:i.defaultStroke,this._disableFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableFill)?r:null==i?void 0:i.disableFill,this._checkedFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkedFill)?r:null==i?void 0:i.checkedFill,this._checkedStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkedStroke)?r:null==i?void 0:i.checkedStroke,this._disableCheckedFill=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableCheckedFill)?r:null==i?void 0:i.disableCheckedFill,this._disableCheckedStroke=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.disableCheckedStroke)?r:null==i?void 0:i.disableCheckedStroke,this._checkIconImage=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.checkIconImage)?r:null==i?void 0:i.checkIconImage,this._indeterminateIconImage=null!=(r=null==(r=null==e?void 0:e.checkboxStyle)?void 0:r.indeterminateIconImage)?r:null==i?void 0:i.indeterminateIconImage}get size(){return this._size}set size(e){this._size=e}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(e){this._spaceBetweenTextAndIcon=e}get defaultFill(){return this._defaultFill}set defaultFill(e){this._defaultFill=e}get defaultStroke(){return this._defaultStroke}set defaultStroke(e){this._defaultStroke=e}get disableFill(){return this._disableFill}set disableFill(e){this._disableFill=e}get checkedFill(){return this._checkedFill}set checkedFill(e){this._checkedFill=e}get checkedStroke(){return this._checkedStroke}set checkedStroke(e){this._checkedStroke=e}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(e){this._disableCheckedFill=e}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(e){this._disableCheckedStroke=e}get checkIconImage(){return this._checkIconImage}set checkIconImage(e){this._checkIconImage=e}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(e){this._indeterminateIconImage=e}getStyle(e){return new muc(e,this)}clone(){return new muc(this)}});function of3(e,t,i,r,o,n){var a;return e||t?e instanceof Style2?e:\\\"function\\\"==typeof e?of3(e(i),t,i,r,o,n):(e=e||{},o&&!isValid_default(e.autoWrapText)&&(e.autoWrapText=!0),r===CheckboxStyle2?new CheckboxStyle2(null!=e?e:{},null!=t?t:{},null!=(a=n.checkboxStyle)?a:{}):new r(null!=e?e:{},null!=t?t:{})):r.DEFAULT}var HeaderHelper=class{constructor(e){this._table=e;var t=get3();this.freezeIcon=t[InternalIconName.freezeIconName],this.frozenIcon=t[InternalIconName.frozenIconName],this.frozenCurrentIcon=t[InternalIconName.frozenCurrentIconName],this.normalIcon=t[InternalIconName.normalIconName],this.upIcon=t[InternalIconName.upwardIconName],this.downIcon=t[InternalIconName.downwardIconName],this.dropDownAbsoluteIcon=t[InternalIconName.dropdownIconName],this.expandIcon=t[InternalIconName.expandIconName],this.collapseIcon=t[InternalIconName.collapseIconName]}getIcons(i,r){const o=[];if(this._table.isPivotTable()){var{showSort:n,sort:a}=this._table.internalProps.layoutMap.getHeader(i,r);if(\\\"function\\\"==typeof n?n({col:i,row:r,table:this._table}):n){let e=this._table.getPivotSortState(i,r);var n=\\\"ASC\\\"===(e=e&&e.toUpperCase())?this.upIcon:\\\"DESC\\\"===e?this.downIcon:this.normalIcon;n&&o.push(n)}else a&&(n=this.getSortIconForPivotTable(this._table.getPivotSortState(i,r),this._table,i,r))&&o.push(n)}else{var l=this._table.sortState;let t;t=void 0;var s=this._table.getCellRange(i,r);if(l)if(Array.isArray(l))for(let e=0;e<l.length;e++){var h=l[e],d=this._table._getHeaderCellBySortState(h);if(d&&cellInRange(s,d.col,d.row)){({order:t}=h);break}}else{a=this._table._getHeaderCellBySortState(l);a&&cellInRange(s,a.col,a.row)&&({order:t}=l)}n=this.getSortIcon(t,this._table,i,r);n&&o.push(n)}this._table.showFrozenIcon&&i<this._table.allowFrozenColCount&&(a=this.getFrozenIcon(i,r))&&o.push(a),this.checkDropDownIcon(this._table,i,r)&&(n=this.dropDownAbsoluteIcon,o.push(n));a=this.getDropDownStateIcons(this._table,i,r),a.length&&o.push(...a),n=this._table._getHeaderLayoutMap(i,r).headerIcon,a=this.getHierarchyIcon(i,r);if(a&&o.push(a),n){let e;e=\\\"function\\\"==typeof n?n({col:i,row:r,value:this._table.getCellValue(i,r),dataValue:this._table.getCellOriginValue(i,r),table:this._table}):n;const u=get3(),c=e=>{var t=\\\"string\\\"==typeof e?u[e]:e;t&&o.push(t)};Array.isArray(e)?e.forEach((e,t)=>{c(e)}):c(e)}return o}getFrozenIcon(e,t){if(this._table.isPivotTable()||this._table.transpose)return null;if(this._table.rightFrozenColCount&&e>=this._table.colCount-this._table.rightFrozenColCount)return null;var i=this._table.getHeaderDefine(e,t);if(i.columns&&0<i.columns.length)return null;let r=this.freezeIcon;return this._table.options.frozenColCount-1>e?r=this.frozenIcon:this._table.options.frozenColCount-1===e&&(r=this.frozenCurrentIcon),r}getSortIcon(e,t,i,r){var o=\\\"asc\\\"===e?this.upIcon:\\\"desc\\\"===e?this.downIcon:this.normalIcon,n=t.getHeaderDefine(i,r);let a;return n&&(a=\\\"function\\\"==typeof n.showSort?n.showSort({col:i,row:r,table:this._table}):n.showSort),!n||!1===a||!isValid_default(a)&&!n.sort||n.columns&&0<n.columns.length?null:o}getSortIconForPivotTable(e,t,i,r){var o=t.getHeaderDefine(i,r);let n;return o&&(n=\\\"function\\\"==typeof o.showSort?o.showSort({col:i,row:r,table:this._table}):o.showSort),!o||!1===n||!isValid_default(n)&&!o.sort||o.columns&&0<o.columns.length?null:\\\"ASC\\\"===(null==e?void 0:e.toUpperCase())?this.upIcon:\\\"DESC\\\"===(null==e?void 0:e.toUpperCase())?this.downIcon:this.normalIcon}getDropDownStateIcons(o,n,a){var l,e=o.getHeaderDefine(n,a);let s=o._getHeaderLayoutMap(n,a).dropDownMenu,h=(\\\"function\\\"==typeof s&&(s=s({row:a,col:n,table:o})),o.globalDropDownMenu);\\\"function\\\"==typeof h&&(h=h({row:a,col:n,table:o}));var d=[];if(Array.isArray(s)&&s.length||Array.isArray(h)&&h.length&&(null==(e=null==e?void 0:e.columns)||!e.length)){var u=s||h;let t=-1,i=-1;for(let r=0;r<u.length;r++){var c=u[r];if(\\\"object\\\"==typeof c&&c.children&&c.children.length)for(let e=0;e<c.children.length;e++){var g=c.children[e];if(null!=(l=o.stateManager.menu)&&l.dropDownMenuHighlight&&isMenuHighlight(o,null==(l=o.stateManager.menu)?void 0:l.dropDownMenuHighlight,\\\"object\\\"==typeof g?null==g?void 0:g.menuKey:g,n,a,r)){t=r,i=e;break}}if(o._dropDownMenuIsHighlight(n,a,r)){t=r;break}}-1!==t&&(e=-1!==i?u[t].children[i]:u[t]).stateIcon&&(e.stateIcon.svg?d.push({type:\\\"svg\\\",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,svg:e.stateIcon.svg,positionType:IconPosition.right,marginRight:0,funcType:IconFuncTypeEnum.dropDownState,interactive:!1}):e.stateIcon.src&&d.push({type:\\\"image\\\",name:e.stateIcon.src||e.stateIcon.svg,width:e.stateIcon.width||22,height:e.stateIcon.height||22,src:e.stateIcon.src,positionType:IconPosition.right,marginRight:0,funcType:IconFuncTypeEnum.dropDownState,interactive:!1}))}return d}getDropDownIconRect(e,t,i){var r=null!=(r=null!=(r=null==(r=this.downIcon.hover)?void 0:r.width)?r:null==(r=this.downIcon)?void 0:r.width)?r:0,o=null!=(o=null!=(o=null==(o=this.downIcon.hover)?void 0:o.height)?o:null==(o=this.downIcon)?void 0:o.height)?o:0,n=e.right-2-r,a=\\\"middle\\\"===i?e.top+e.height/2-r/2:\\\"top\\\"===i?e.top+t/2:\\\"bottom\\\"===i?e.bottom-2*t:e.top;return{left:n,right:e.right-2,top:a,bottom:o+a,width:r,height:o}}getHierarchyIcon(e,t){var i=this._table._getHeaderLayoutMap(e,t).hierarchyState;if(i)return i===HierarchyState.expand?this.expandIcon:i===HierarchyState.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var e;return this.expandIcon.width+(null!=(e=this.expandIcon.marginLeft)?e:0)+(null!=(e=this.expandIcon.marginRight)?e:0)}checkDropDownIcon(t,i,r){if(t.isPivotTable()){let e=t._getHeaderLayoutMap(i,r).dropDownMenu;if(\\\"function\\\"==typeof e&&(e=e({row:r,col:i,table:t})),Array.isArray(e)&&e.length)return!0}else{var o=t.getHeaderDefine(i,r),n=o.dropDownMenu;let e=t.globalDropDownMenu;if(\\\"function\\\"==typeof e&&(e=e({row:r,col:i,table:t})),Array.isArray(n)&&n.length||(!Array.isArray(o.dropDownMenu)||0!==o.dropDownMenu.length)&&Array.isArray(e)&&e.length&&(null==(n=null==o?void 0:o.columns)||!n.length))return!0}return!1}getStyleClass(e){switch(e){case\\\"text\\\":case\\\"link\\\":return TextHeaderStyle;case\\\"image\\\":case\\\"video\\\":return ImageStyle2;case\\\"checkbox\\\":return CheckboxStyle2}}setTableColumnsEditor(){const r=(e,i)=>{null!=e&&e.forEach((e,t)=>{e.editor&&(i[t].editor=e.editor),e.columns&&r(e.columns,i[t].columns)})};r(this._table.options.columns,this._table.internalProps.columns)}},FocusInput=(init_esbuild_inject(),class extends EventTarget{constructor(e,t){var i,r;super(),this._table=e,\\\"node\\\"!==Env.mode&&((i=document.createElement(\\\"div\\\")).style.opacity=\\\"0\\\",i.dataset.vtable=\\\"vtable\\\",i.style.pointerEvents=\\\"none\\\",i.classList.add(\\\"input-container\\\"),r=this._input=document.createElement(\\\"input\\\"),i.appendChild(r),r.classList.add(\\\"table-focus-control\\\"),r.dataset.vtable=\\\"vtable\\\",r.readOnly=!0,t.appendChild(i),this._container=i)}focus(){this._input.focus({preventScroll:!0})}setFocusRect(e,t){var i=this._input,r=(i.value=t,i.select(),e.top-this._table.scrollTop),o=e.left-this._table.scrollLeft;i.style.top=r.toFixed()+\\\"px\\\",i.style.left=o.toFixed()+\\\"px\\\",i.style.width=e.width.toFixed()+\\\"px\\\",i.style.height=e.height.toFixed()+\\\"px\\\"}get input(){return this._input}release(){var e;null!=(e=this._container.parentElement)&&e.removeChild(this._container)}}),NumberRangeMap=(init_esbuild_inject(),class{constructor(e){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=e}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(e,t){var i;isValid_default(t)&&(i=this.table.getRowHeight(e),this.data.has(e)||(this._keys.push(e),this._sorted=!1),this.data.set(e,t),this.totalSum+=t,this.updateDifference(e,t-i))}remove(e){var t,i;this.data.has(e)&&(t=this.data.get(e),this.data[\\\"delete\\\"](e),-1!==(i=this._keys.indexOf(e))&&this._keys.splice(i,1),this.totalSum-=t,i=this.table.getRowHeight(e),this.updateDifference(e,i-t))}put(e,t){var i;isValid_default(t)&&(this.data.has(e)?(i=this.data.get(e))!==t&&(this.data.set(e,t),this.totalSum+=i=t-i,this.updateDifference(e,i)):this.add(e,t))}get(e){return this.data.get(e)}has(e){return this.data.has(e)}_sort(){var e=this._keys;this._sorted||(e.sort((e,t)=>e<t?-1:t<e?1:0),this._sorted=!0)}updateDifference(e,t){var i=null!=(i=this.difference.get(e))?i:0;this.difference.set(e,i+t),this.update()}getSumInRange(e,t){return this.calculatePrefixSum(t)-this.calculatePrefixSum(e-1)}updateCumulativeSum(e,t){for(var[i,r]of this.cumulativeSum)i>=e&&this.cumulativeSum.set(i,r+t)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(var[i,r]of this.difference)i<=t&&(e+=r);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(e){let t,i=0;for(let r=e;0<=r;r--){if(this.cumulativeSum.has(r)){i+=this.cumulativeSum.get(r);break}i+=null!=(t=this.data.get(r))?t:this.table.getRowHeight(r)}return this.cumulativeSum.set(e,i),i}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(var[e]of this.cumulativeSum)for(var[t,i]of this.difference)e>=t&&(t=this.cumulativeSum.get(e),this.cumulativeSum.set(e,t+i));this.difference.clear()}insert(e,t){for(let r=e;r<=this.getLastIndex();r++)this.cumulativeSum[\\\"delete\\\"](r);var i=this.getLastIndex()+1;this.adjustOrder(e,e+1,i-e),isValid_default(t)&&this.put(e,t)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){var e=this.getLastIndex();this.remove(e)}\\\"delete\\\"(t){if(this.has(t)){for(let e=t;e<=this.getLastIndex();e++)this.cumulativeSum[\\\"delete\\\"](e);var i=this.getLastIndex();this.adjustOrder(t+1,t,i-t),this.delLast()}}adjustOrder(i,r,o){this.clearRange(),this._sort();var n=this._keys;if(r<i){var a=[];for(let e=indexFirst2(n,i+o-1);0<=e;e--){var l=n[e];if(i<=l)a.push(this.get(l));else if(r<=l&&l<i)this.put(l+o,this.get(l));else if(l<r)break}for(let t=0;t<o;t++)this.put(r+t,a[o-1-t])}var s=n.length;if(i<r){var h=[];for(let e=indexFirst2(n,i);e<s;e++){var d=n[e];if(i<=d&&d<i+o)h.push(this.get(d));else if(i+o<=d&&d<=r)this.put(d-o,this.get(d));else if(r<d)break}for(let t=0;t<o;t++)this.put(r+t,h[t])}}exchangeOrder(r,o,n,a,l){var s=this._keys;if(this._sorted||(s.sort((e,t)=>e<t?-1:t<e?1:0),this._sorted=!0),n<r){var h=[],d=[];for(let e=indexFirst2(s,n);e<indexFirst2(s,r)+o;e++){var u=s[e];(r<=u&&u<r+o?d:h).push(this.get(u))}for(let t=0;t<o;t++)this.put(l+t,d[t]);for(let i=0;i<h.length;i++)this.put(l+o+i,h[i])}else{var c=[],g=[];for(let e=indexFirst2(s,r);e<indexFirst2(s,n)+a;e++){var p=s[e];(r<=p&&p<r+o?g:c).push(this.get(p))}for(let t=0;t<o;t++)this.put(l+t,g[t]);for(let i=0;i<c.length;i++)this.put(r+i,c[i])}}});function indexFirst2(e,t){let i=0,r=e.length-1;for(;i<=r;){var o=Math.floor((i+r)/2);if(e[o]===t)return o;t<e[o]?r=o-1:i=o+1}return r<0?0:r}init_esbuild_inject();var Direction2,RowSeriesNumberHelper=class{constructor(e){this._table=e;var t=get3();this.dragReorderIconName=t[InternalIconName.dragReorderIconName]}getIcons(e,t){return[this.dragReorderIconName]}},DimensionTree=(init_esbuild_inject(),init_esbuild_inject(),class{constructor(e,t,i=\\\"grid\\\",r=void 0){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:\\\"\\\",value:\\\"\\\",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new NumberMap,this.dimensionKeysIncludeVirtual=new NumberMap,this.cache=new Map,this.sizeIncludeParent=null!=r,this.setExpandLevel=r,this.hierarchyType=i,this.sharedVar=t,this.reset(e)}reset(e){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new NumberMap,this.dimensionKeysIncludeVirtual=new NumberMap,this.tree.children=e,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(i,e,t){var r;i.startIndex=e,i.startInTotal=(null!=(n=t.startInTotal)?n:0)+i.startIndex,i.hide&&(this.hasHideNode=!0),(null!=(n=i.dimensionKey)?n:i.indicatorKey)&&(i.virtual||this.dimensionKeys.contain(i.indicatorKey?IndicatorDimensionKeyPlaceholder:i.dimensionKey)||this.dimensionKeys.put(i.level,i.indicatorKey?IndicatorDimensionKeyPlaceholder:i.dimensionKey),this.dimensionKeysIncludeVirtual.contain(i.indicatorKey?IndicatorDimensionKeyPlaceholder:i.dimensionKey)||this.dimensionKeysIncludeVirtual.put(i.level,i.indicatorKey?IndicatorDimensionKeyPlaceholder:i.dimensionKey),i.id||(i.id=++this.sharedVar.seqId));let o=i.dimensionKey&&this.sizeIncludeParent?1:0;var n=i.children||i.columns;return\\\"grid\\\"===this.hierarchyType||null===this.hierarchyType?1<=(null==n?void 0:n.length)?n.forEach(e=>{var t;e.level=(null!=(t=i.level)?t:0)+1,\\\"grid\\\"===this.hierarchyType&&(e.afterSpanLevel=(null!=(t=i.afterSpanLevel)?t:0)+(null!=(t=i.levelSpan)?t:1)),this.totalLevel=Math.max(this.totalLevel,e.level+1),o+=this.setTreeNode(e,o,i)}):o=1:i.hierarchyState===HierarchyState.expand&&1<=(null==n?void 0:n.length)?n.forEach(e=>{var t;e.level=(null!=(t=i.level)?t:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),o+=this.setTreeNode(e,o,i)}):i.hierarchyState===HierarchyState.collapse&&1<=(null==n?void 0:n.length)?n.forEach(e=>{var t;e.level=(null!=(t=i.level)?t:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,o,i)}):!i.hierarchyState&&i.level+1<this.setExpandLevel&&(1<=(null==n?void 0:n.length)||!0===n)?(null!=(r=n[0])&&r.indicatorKey&&\\\"grid-tree\\\"===this.hierarchyType||(i.hierarchyState=HierarchyState.expand),1<=(null==n?void 0:n.length)&&n.forEach(e=>{var t;e.level=(null!=(t=i.level)?t:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,e.level+1),o+=this.setTreeNode(e,o,i)})):1<=(null==n?void 0:n.length)||!0===n?(null!=(r=n[0])&&r.indicatorKey&&\\\"grid-tree\\\"===this.hierarchyType||(i.hierarchyState=HierarchyState.collapse),1<=(null==n?void 0:n.length)&&n.forEach(e=>{var t;e.level=(null!=(t=i.level)?t:0)+1,this.totalLevel=Math.max(this.totalLevel,e.level+1),this.setTreeNode(e,o,i)})):(i.hierarchyState=HierarchyState.none,o=1),i.size=o}getTreePath(e,t=30){var i=[];return this.searchPath(e,this.tree,i,t),i.shift(),i}findNodeById(e,t){return e.find(e=>e.id===t)}searchPath(i,r,o,n){if(r&&!(i<r.startIndex||i>=r.startIndex+r.size)&&(o.push(r),r.children)&&0!==r.children.length&&!(r.level>=n)){var a=i-r.startIndex;if(this.cache.has(r.level+1)){var l=this.cache.get(r.level+1);if(a>=l.startIndex&&a<l.startIndex+l.size)return void this.searchPath(a,l,o,n)}let e=0,t=r.children.length-1;for(;e<=t;){const s=Math.floor((e+t)/2),h=r.children[s];if(a>=h.startIndex&&a<h.startIndex+h.size){this.cache.set(h.level,h);const d=[];this.cache.forEach((e,t)=>{t>h.level&&d.push(t)}),d.forEach(e=>{this.cache[\\\"delete\\\"](e)}),this.searchPath(a,h,o,n);break}a<h.startIndex?t=s-1:e=s+1}}}movePosition(r,o,n){let a,l,s;const h=(t,e)=>{if(void 0===l||void 0===s){t.level===r&&(t.startInTotal===o&&(l=e),t.startInTotal<=n)&&n<=t.startInTotal+t.size-1&&(s=e);var i=t.children||t.columns;if(i&&t.level<r){a=t;for(let e=0;e<i.length;e++)(o>=i[e].startInTotal&&o<=i[e].startInTotal+i[e].size||n>=i[e].startInTotal&&n<=i[e].startInTotal+i[e].size)&&h(i[e],e)}}};h(this.tree,0);var e=a.children||a.columns,t=e.splice(l,1);t.unshift(s,0),Array.prototype.splice.apply(e,t)}getCopiedTree(){var e=cloneDeep(this.tree.children);return clearNode(e),e}});function generateLayoutTree(i,e){null!=e&&e.forEach(e=>{var t={dimensionKey:e.dimensionKey,indicatorKey:e.indicatorKey,value:e.value,hierarchyState:e.hierarchyState,children:void 0,virtual:null!=(t=e.virtual)&&t,levelSpan:null!=(t=e.levelSpan)?t:1};i.push(t),e.children&&(t.children=[],generateLayoutTree(t.children,e.children))})}function countLayoutTree(e,t){let i=0;return null!=e&&e.forEach(e=>{!t&&e.children&&0!==e.children.length||i++,e.children&&(i+=countLayoutTree(e.children,t))}),i}function dealHeader(i,r,e,t,o,n){var a,l;const s=i.id,h=null!=(l=null==(l=n.rowsDefine)?void 0:l.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===i.dimensionKey))?l:null==(l=n.columnsDefine)?void 0:l.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===i.dimensionKey),d=null==(l=n.indicatorsDefine)?void 0:l.find(e=>\\\"string\\\"!=typeof e&&(i.indicatorKey?e.indicatorKey===i.indicatorKey:e.title===i.value&&!i.dimensionKey)),u={id:s,title:null!=(l=i.value)?l:null==d?void 0:d.title,field:i.dimensionKey,style:\\\"function\\\"==typeof(null==(l=null!=d?d:h)?void 0:l.headerStyle)?null==(l=null!=d?d:h)?void 0:l.headerStyle:Object.assign({},null==(l=null!=d?d:h)?void 0:l.headerStyle),headerType:null!=(l=null!=(l=null==d?void 0:d.headerType)?l:null==h?void 0:h.headerType)?l:\\\"text\\\",headerIcon:null!=(l=null==d?void 0:d.headerIcon)?l:null==h?void 0:h.headerIcon,define:Object.assign({},i,null!=d?d:Object.assign({},h,{sort:void 0})),fieldFormat:null!=(l=null==d?void 0:d.headerFormat)?l:null==h?void 0:h.headerFormat,dropDownMenu:null!=(l=null==d?void 0:d.dropDownMenu)?l:null==h?void 0:h.dropDownMenu,pivotInfo:{value:i.value,dimensionKey:i.dimensionKey,isPivotCorner:!1},width:null==h?void 0:h.width,minWidth:null==h?void 0:h.minWidth,maxWidth:null==h?void 0:h.maxWidth,showSort:null!=(l=null==d?void 0:d.showSort)?l:null==h?void 0:h.showSort,sort:null==d?void 0:d.sort,description:null==h?void 0:h.description};d?(d.customRender&&(i.customRender=d.customRender),isValid_default(null==(l=n._indicators)?void 0:l.find(e=>e.indicatorKey===d.indicatorKey))||null==(l=n._indicators)||l.push({id:++n.sharedVar.seqId,indicatorKey:d.indicatorKey,field:d.indicatorKey,fieldFormat:null==d?void 0:d.format,cellType:null!=(a=null!=(a=null==d?void 0:d.cellType)?a:null==d?void 0:d.columnType)?a:\\\"text\\\",chartModule:\\\"chartModule\\\"in d?d.chartModule:null,chartSpec:\\\"chartSpec\\\"in d?d.chartSpec:null,noDataRenderNothing:\\\"noDataRenderNothing\\\"in d&&d.noDataRenderNothing,sparklineSpec:\\\"sparklineSpec\\\"in d?d.sparklineSpec:null,style:null==d?void 0:d.style,icon:null==d?void 0:d.icon,define:Object.assign({},i,d,{dragHeader:null==h?void 0:h.dragHeader}),width:null==d?void 0:d.width,minWidth:null==d?void 0:d.minWidth,maxWidth:null==d?void 0:d.maxWidth,disableColumnResize:null==d?void 0:d.disableColumnResize})):i.indicatorKey&&!isValid_default(null==(a=n._indicators)?void 0:a.find(e=>e.indicatorKey===i.indicatorKey))&&null!=(l=n._indicators)&&l.push({id:++n.sharedVar.seqId,indicatorKey:i.indicatorKey,field:i.indicatorKey,cellType:\\\"text\\\",define:Object.assign({},i)}),e[s]=u,n._headerObjects[s]=u;for(let c=o-1;0<=c;c--)r[c][n.colIndex]=t[c];if(r[o][n.colIndex]=s,1<i.levelSpan)for(let t=1;t<i.levelSpan;t++){if(!r[o+t]){r[o+t]=[];for(let e=0;e<n.colIndex;e++)r[o+t][e]=r[o][e]}r[o+t][n.colIndex]=s}if(1<=(null==(a=i.children)?void 0:a.length))n._addHeaders(r,o+(null!=(l=i.levelSpan)?l:1),null!=(a=i.children)?a:[],[...t,...Array(null!=(l=i.levelSpan)?l:1).fill(s)],e);else{for(let e=o+1;e<r.length;e++)r[e][n.colIndex]=s;n.colIndex++}}function dealHeaderForGridTreeMode(t,i,r,o,n,a,l,e,s,h,d,u){var c,g;const p=t.id,f=null!=(y=null==(y=u.rowsDefine)?void 0:y.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t.dimensionKey))?y:null==(y=u.columnsDefine)?void 0:y.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t.dimensionKey),m=null==(y=u.indicatorsDefine)?void 0:y.find(e=>\\\"string\\\"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value&&!t.dimensionKey)),b={id:p,title:null!=(y=t.value)?y:null==m?void 0:m.title,field:t.dimensionKey,style:\\\"function\\\"==typeof(null==(y=null!=m?m:f)?void 0:y.headerStyle)?null==(y=null!=m?m:f)?void 0:y.headerStyle:Object.assign({},null==(y=null!=m?m:f)?void 0:y.headerStyle),headerType:null!=(y=null!=(y=null==m?void 0:m.headerType)?y:null==f?void 0:f.headerType)?y:\\\"text\\\",headerIcon:null!=(y=null==m?void 0:m.headerIcon)?y:null==f?void 0:f.headerIcon,define:Object.assign(t,{linkJump:null==(y=null!=m?m:f)?void 0:y.linkJump,linkDetect:null==(y=null!=m?m:f)?void 0:y.linkDetect,templateLink:null==(y=null!=m?m:f)?void 0:y.templateLink,keepAspectRatio:null!=(y=null==(y=null!=m?m:f)?void 0:y.keepAspectRatio)&&y,imageAutoSizing:null==(y=null!=m?m:f)?void 0:y.imageAutoSizing,headerCustomRender:null==(y=null!=m?m:f)?void 0:y.headerCustomRender,headerCustomLayout:null==(y=null!=m?m:f)?void 0:y.headerCustomLayout,dragHeader:null==f?void 0:f.dragHeader,disableHeaderHover:!(null==(y=null!=m?m:f)||!y.disableHeaderHover),disableHeaderSelect:!(null==(y=null!=m?m:f)||!y.disableHeaderSelect),showSort:null!=(y=null==m?void 0:m.showSort)?y:null==f?void 0:f.showSort,hide:null==m?void 0:m.hide}),fieldFormat:null!=(y=null==m?void 0:m.headerFormat)?y:null==f?void 0:f.headerFormat,dropDownMenu:null!=(y=null==m?void 0:m.dropDownMenu)?y:null==f?void 0:f.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:a,hierarchyState:t.hierarchyState,width:null==f?void 0:f.width,minWidth:null==f?void 0:f.minWidth,maxWidth:null==f?void 0:f.maxWidth,showSort:null!=(y=null==m?void 0:m.showSort)?y:null==f?void 0:f.showSort,sort:null==m?void 0:m.sort,description:null==f?void 0:f.description,parentCellId:o[o.length-1]};m?(m.customRender&&(t.customRender=m.customRender),isValid_default(null==(y=u._indicators)?void 0:y.find(e=>e.indicatorKey===m.indicatorKey))||null==(y=u._indicators)||y.push({id:++u.sharedVar.seqId,indicatorKey:m.indicatorKey,field:m.indicatorKey,fieldFormat:null==m?void 0:m.format,cellType:null!=(g=null!=(g=null==m?void 0:m.cellType)?g:null==m?void 0:m.columnType)?g:\\\"text\\\",chartModule:\\\"chartModule\\\"in m?m.chartModule:null,chartSpec:\\\"chartSpec\\\"in m?m.chartSpec:null,noDataRenderNothing:\\\"noDataRenderNothing\\\"in m&&m.noDataRenderNothing,sparklineSpec:\\\"sparklineSpec\\\"in m?m.sparklineSpec:null,style:null==m?void 0:m.style,icon:null==m?void 0:m.icon,define:Object.assign({},t,m,{dragHeader:null==f?void 0:f.dragHeader}),width:null==m?void 0:m.width,minWidth:null==m?void 0:m.minWidth,maxWidth:null==m?void 0:m.maxWidth,disableColumnResize:null==m?void 0:m.disableColumnResize})):t.indicatorKey&&!isValid_default(null==(g=u._indicators)?void 0:g.find(e=>e.indicatorKey===t.indicatorKey))&&null!=(y=u._indicators)&&y.push({id:++u.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:\\\"text\\\",define:Object.assign({},t)}),r[p]=b,u._headerObjects[p]=b;for(let w=n-1;0<=w;w--)i[w][u.colIndex]=o[w];i[n][u.colIndex]=p;var C=Math.min((h?d:!d)?l:l-1,null!=(g=t.levelSpan)?g:1e3);if(0<C)for(let t=n+1;t<C;t++){if(!i[t]){i[t]=[];for(let e=0;e<u.colIndex;e++)i[t][e]=i[n][e]}i[t][u.colIndex]=p}if(1<=(null==(y=(t.hierarchyState===HierarchyState.expand&&t).children)?void 0:y.length))u._addHeadersForGridTreeMode(i,n+(null!=(g=t.levelSpan)?g:1),null!=(y=t.children)?y:[],[...o,...Array(null!=(g=t.levelSpan)?g:1).fill(p)],a,l,e&&t.hierarchyState===HierarchyState.expand,s,r,h);else{var v=(h?d:!d)?l:l-1;for(let e=n+1;e<v;e++)i[e]||(i[e]=[]),i[e][u.colIndex]=p;if(n<=v-1&&(h&&!1===d||!h&&!0===d)){let e=t;for(var y=v-n;e&&(null==(c=e.children)||!c[0].indicatorKey);)e=e.children[0];u._addHeadersForGridTreeMode(i,l-1,null!=(g=e.children)?g:[],[...o,...Array(Math.max(y,null!=(g=t.levelSpan)?g:1)).fill(p)],a,l,!0,s,r,h)}else u.colIndex++}}function dealHeaderForTreeMode(t,i,e,r,o,n,a,l,s){var h,d;const u=t.id,c=l.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t.dimensionKey),g=null==(d=s.indicatorsDefine)?void 0:d.find(e=>\\\"string\\\"!=typeof e&&(t.indicatorKey?e.indicatorKey===t.indicatorKey:e.title===t.value)),p={id:u,title:null!=(d=t.value)?d:g.title,field:t.dimensionKey,style:t.level+1===n||\\\"function\\\"==typeof(null==(d=null!=g?g:c)?void 0:d.headerStyle)?null==(d=null!=g?g:c)?void 0:d.headerStyle:Object.assign({},null==(d=null!=g?g:c)?void 0:d.headerStyle,{textAlign:\\\"left\\\"}),headerType:null!=(d=null!=(d=null==g?void 0:g.headerType)?d:null==c?void 0:c.headerType)?d:\\\"text\\\",headerIcon:null!=(d=null==g?void 0:g.headerIcon)?d:null==c?void 0:c.headerIcon,define:Object.assign(t,{linkJump:null==(d=null!=g?g:c)?void 0:d.linkJump,linkDetect:null==(d=null!=g?g:c)?void 0:d.linkDetect,templateLink:null==(d=null!=g?g:c)?void 0:d.templateLink,keepAspectRatio:null!=(d=null==(d=null!=g?g:c)?void 0:d.keepAspectRatio)&&d,imageAutoSizing:null==(d=null!=g?g:c)?void 0:d.imageAutoSizing,headerCustomRender:null==(d=null!=g?g:c)?void 0:d.headerCustomRender,headerCustomLayout:null==(d=null!=g?g:c)?void 0:d.headerCustomLayout,dragHeader:null==c?void 0:c.dragHeader,disableHeaderHover:!(null==(d=null!=g?g:c)||!d.disableHeaderHover),disableHeaderSelect:!(null==(d=null!=g?g:c)||!d.disableHeaderSelect),showSort:null!=(d=null==g?void 0:g.showSort)?d:null==c?void 0:c.showSort,hide:null==g?void 0:g.hide}),fieldFormat:null!=(d=null==g?void 0:g.headerFormat)?d:null==c?void 0:c.headerFormat,dropDownMenu:null!=(d=null==g?void 0:g.dropDownMenu)?d:null==c?void 0:c.dropDownMenu,pivotInfo:{value:t.value,dimensionKey:t.dimensionKey,isPivotCorner:!1},hierarchyLevel:t.level,dimensionTotalLevel:n,hierarchyState:t.hierarchyState,width:null==c?void 0:c.width,minWidth:null==c?void 0:c.minWidth,maxWidth:null==c?void 0:c.maxWidth,parentCellId:r[r.length-1]};g?(g.customRender&&(t.customRender=g.customRender),isValid_default(null==(d=s._indicators)?void 0:d.find(e=>e.indicatorKey===g.indicatorKey))||null==(d=s._indicators)||d.push({id:++s.sharedVar.seqId,indicatorKey:g.indicatorKey,field:g.indicatorKey,fieldFormat:null==g?void 0:g.format,cellType:null!=(h=null!=(h=null==g?void 0:g.cellType)?h:null==g?void 0:g.columnType)?h:\\\"text\\\",chartModule:\\\"chartModule\\\"in g?g.chartModule:null,chartSpec:\\\"chartSpec\\\"in g?g.chartSpec:null,noDataRenderNothing:\\\"noDataRenderNothing\\\"in g&&g.noDataRenderNothing,sparklineSpec:\\\"sparklineSpec\\\"in g?g.sparklineSpec:null,style:null==g?void 0:g.style,icon:null==g?void 0:g.icon,define:Object.assign({},t,g,{dragHeader:null==c?void 0:c.dragHeader}),width:null==g?void 0:g.width,minWidth:null==g?void 0:g.minWidth,maxWidth:null==g?void 0:g.maxWidth,disableColumnResize:null==g?void 0:g.disableColumnResize})):t.indicatorKey&&!isValid_default(null==(h=s._indicators)?void 0:h.find(e=>e.indicatorKey===t.indicatorKey))&&null!=(d=s._indicators)&&d.push({id:++s.sharedVar.seqId,indicatorKey:t.indicatorKey,field:t.indicatorKey,cellType:\\\"text\\\",define:Object.assign({},t)}),e[u]=p,s._headerObjects[u]=p,i[o][s.colIndex]=u;for(let f=o-1;0<=f;f--)i[f][s.colIndex]=r[f];if(t.hierarchyState===HierarchyState.expand&&1<=(null==(h=t.children)?void 0:h.length))a&&s.colIndex++,s._addHeadersForTreeMode(i,o,null!=(d=t.children)?d:[],[...r,u],n,a&&t.hierarchyState===HierarchyState.expand,l,e);else{a&&s.colIndex++;for(let e=o+1;e<i.length;e++)i[e][s.colIndex]=u}}function clearNode(e){for(let i=0;i<e.length;i++){var t=e[i],t=(delete t.level,delete t.startIndex,delete t.id,delete t.levelSpan,delete t.size,delete t.startInTotal,t.children||t.columns);t&&clearNode(t)}}function deleteTreeHideNode(e,t,i,r,o){var n;for(let a=e.length-1;0<=a;a--){const l=e[a];t.push(l),r&&l.hide?e.splice(a,1):l.indicatorKey?\\\"function\\\"==typeof(n=null==(n=null==i?void 0:i.find(e=>e.indicatorKey===l.indicatorKey))?void 0:n.hide)?n({dimensionPaths:t,table:o})&&e.splice(a,1):n&&e.splice(a,1):l.children&&0<l.children.length&&deleteTreeHideNode(l.children,t,i,r,o),t.pop()}}function checkHasAggregation(e){var t=e.columnObjects;for(let r=0;r<t.length;r++){var i=t[r];if(null!=i&&i.aggregation)return!0}return!1}function checkHasAggregationOnTop(e){var t=e.columnObjects;let i=0;for(let o=0;o<t.length;o++){var r=t[o];null!=r&&r.aggregation&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(e=>e.showOnTop).length):r.aggregation.showOnTop&&(i=Math.max(i,1)))}return i}function checkHasAggregationOnBottom(e){var t=e.columnObjects;let i=0;for(let o=0;o<t.length;o++){var r=t[o];null!=r&&r.aggregation&&(Array.isArray(null==r?void 0:r.aggregation)?i=Math.max(i,r.aggregation.filter(e=>!e.showOnTop).length):r.aggregation.showOnTop||(i=Math.max(i,1)))}return i}function checkHasTreeDefine(e){if(e._table.options.groupBy)return!0;var t=e._table.options.columns;if(isArray_default(t)&&0<t.length)for(let e=0;e<t.length;e++){var i=t[e];if(!isString_default(i)&&i.tree)return!0}return!1}function hasAutoImageColumn(e){var{columns:t,rows:i,indicators:r}=e.options;if(e.isPivotTable()){if(isArray_default(t)&&0<t.length)for(let e=0;e<t.length;e++){var o=t[e];if(!isString_default(o)&&(\\\"image\\\"===o.headerType||\\\"video\\\"===o.headerType||\\\"function\\\"==typeof o.headerType)&&o.imageAutoSizing)return!0}if(isArray_default(i)&&0<i.length)for(let e=0;e<i.length;e++){var n=i[e];if(!isString_default(n)&&(\\\"image\\\"===n.headerType||\\\"video\\\"===n.headerType||\\\"function\\\"==typeof n.headerType)&&n.imageAutoSizing)return!0}if(isArray_default(r)&&0<r.length)for(let e=0;e<r.length;e++){var a=r[e];if(!isString_default(a)&&((\\\"image\\\"===a.cellType||\\\"video\\\"===a.cellType||\\\"function\\\"==typeof a.cellType)&&a.imageAutoSizing||(\\\"image\\\"===a.headerType||\\\"video\\\"===a.headerType||\\\"function\\\"==typeof a.headerType)&&a.imageAutoSizing))return!0}}else if(isArray_default(t)&&0<t.length)for(let e=0;e<t.length;e++){var l=t[e];if((\\\"image\\\"===l.cellType||\\\"video\\\"===l.cellType||\\\"function\\\"==typeof l.cellType)&&l.imageAutoSizing||(\\\"image\\\"===l.headerType||\\\"video\\\"===l.headerType||\\\"function\\\"==typeof l.headerType)&&l.imageAutoSizing)return!0}return!1}function parseColKeyRowKeyForPivotTable(r,e){let t,i,o,n,a,l,s,h,d,u,c,g,p,f,m,b,C;e.columnTree&&(!1!==r.options.indicatorsAsCol&&!1!==r.options.supplementIndicatorNodes&&(r.internalProps.columnTree=supplementIndicatorNodesForCustomTree(r.internalProps.columnTree,e.indicators)),b=new DimensionTree(null!=(t=r.internalProps.columnTree)?t:[],r.layoutNodeId,r.options.columnHierarchyType,\\\"grid\\\"!==r.options.columnHierarchyType?null!=(i=r.options.columnExpandLevel)?i:1:void 0)),e.rowTree&&(!1===r.options.indicatorsAsCol&&!1!==r.options.supplementIndicatorNodes&&(r.internalProps.rowTree=supplementIndicatorNodesForCustomTree(r.internalProps.rowTree,e.indicators)),C=new DimensionTree(null!=(o=r.internalProps.rowTree)?o:[],r.layoutNodeId,r.options.rowHierarchyType,\\\"grid\\\"!==r.options.rowHierarchyType?null!=(n=r.options.rowExpandLevel)?n:1:void 0));const v=null!=(a=null==C?void 0:C.dimensionKeys)&&a.count?C.dimensionKeys.valueArr():null!=(s=null==(l=e.rows)?void 0:l.reduce((e,t)=>(\\\"string\\\"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?s:[],y=null!=(h=null==b?void 0:b.dimensionKeys)&&h.count?b.dimensionKeys.valueArr():null!=(u=null==(d=e.columns)?void 0:d.reduce((e,t)=>(\\\"string\\\"==typeof t?e.push(t):e.push(t.dimensionKey),e),[]))?u:[],w=null!=(g=null==(c=e.indicators)?void 0:c.reduce((e,t)=>{var i;return\\\"string\\\"==typeof t?e.push(t):(e.push(t.indicatorKey),(t.chartSpec||t.sparklineSpec)&&(null!=(i=r.internalProps.dataConfig)&&i.aggregationRules?r.internalProps.dataConfig.aggregationRules.find(e=>e.indicatorKey===t.indicatorKey)||r.internalProps.dataConfig.aggregationRules.push({field:t.indicatorKey,indicatorKey:t.indicatorKey,aggregationType:AggregationType.NONE}):r.internalProps.dataConfig?r.internalProps.dataConfig.aggregationRules=[{field:t.indicatorKey,indicatorKey:t.indicatorKey,aggregationType:AggregationType.NONE}]:r.internalProps.dataConfig={aggregationRules:[{field:t.indicatorKey,indicatorKey:t.indicatorKey,aggregationType:AggregationType.NONE}]})),e},[]))?g:[];return\\\"grid\\\"!==e.rowHierarchyType&&1<=(null!=(f=null==(p=e.extensionRows)?void 0:p.length)?f:0)&&(null!=(m=e.extensionRows)&&m.forEach(e=>{const t=[];e.rows.forEach(e=>{\\\"string\\\"==typeof e?t.push(e):t.push(e.dimensionKey)}),v.push(...t)})),{rowKeys:v,columnKeys:y,indicatorKeys:w,columnDimensionTree:b,rowDimensionTree:C}}function supplementIndicatorNodesForCustomTree(e,r){const o=(e,i)=>{e.forEach(e=>{var t;e.indicatorKey||i||null!=(t=e.children)&&t.length&&e.children?e.children&&Array.isArray(e.children)&&o(e.children,i||!!e.indicatorKey):e.children=null==r?void 0:r.map(e=>{var t;return\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}})})};return null!=e&&e.length?o(e,!1):e=null==r?void 0:r.map(e=>{var t;return\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}}),e}function deleteHideIndicatorNode(e,t,i,r){var o=[];for(let a=0;a<(null==t?void 0:t.length);a++){var n=t[a];null!=n&&n.hide&&o.push(n)}(o.length||i)&&deleteTreeHideNode(e,[],o,i,r)}function getRowAt(e,t){var i;return _getTargetFrozenRowAt(t,e)||(null!=(i=getTargetRowAt(e,t))?i:{top:-1,row:-1,bottom:-1,height:-1})}function getColAt(e,t){var i;return _getTargetFrozenColAt(t,e)||(null!=(i=getTargetColAt(e,t))?i:{left:-1,col:-1,right:-1,width:1})}function getCellAt(e,t,i){var{row:r,top:o,bottom:n,height:a}=getRowAt(t,i),{col:l,left:s,right:h,width:d}=getColAt(e,i);return{row:r,col:l,rect:{left:s,right:h,top:o,bottom:n,width:d,height:a}}}function getTargetColAt(i,r){if(0===i)return{left:0,col:0,right:0,width:0};var o=computeTargetColByX(i,r),n=r.getColsWidth(0,o);if(n<=i){var a=o;let e=n-r.getColWidth(a);var l=r.internalProps.colCount;for(let t=a;t<l;t++){var s=r.getColWidth(t),h=e+s;if(Math.round(e)<=Math.round(i)&&Math.round(i)<Math.round(h))return{left:e,col:t,right:h,width:s};e=h}return null}{let e=n;for(let t=o;0<=t;t--){var d=r.getColWidth(t),u=e-d;if(Math.round(u)<=Math.round(i)&&Math.round(i)<Math.round(e))return{left:u,col:t,right:e,width:d};e=u}return null}}function getTargetRowAt(a,l){var e;if(0===a)return{top:0,row:0,bottom:0,height:0};const s=!0===(null==(e=l.options.customConfig)?void 0:e._disableColumnAndRowSizeRound)?Math.floor:Math.round,t=computeTargetRowByY(a,l),h=l.getRowsHeight(0,t);return(h<=a?e=>{let t=h-l.getRowHeight(e);var i=l.internalProps.rowCount;for(let n=e;n<i;n++){var r=l.getRowHeight(n),o=t+r;if(s(t)<=s(a)&&s(a)<s(o))return{top:t,row:n,bottom:o,height:r};t=o}return null}:e=>{let t=h;for(let o=e;0<=o;o--){var i=l.getRowHeight(o),r=t-i;if(s(r)<=s(a)&&s(a)<s(t))return{top:r,row:o,bottom:t,height:i};t=r}return null})(t)}function getTargetColAtConsiderRightFrozen(t,i,r){if(0===t)return{left:0,col:0,right:0,width:0};if(t-=r.tableX,i&&t>r.tableNoFrameWidth-r.getRightFrozenColsWidth()&&t<r.tableNoFrameWidth&&t<=r.getAllColsWidth())for(let e=0;e<r.rightFrozenColCount;e++)if(t>r.tableNoFrameWidth-r.getColsWidth(r.colCount-e-1,r.colCount-1))return{col:r.colCount-e-1,left:void 0,right:void 0,width:void 0};return getTargetColAt(t,r)}function getTargetRowAtConsiderBottomFrozen(t,i,r){if(0===t)return{top:0,row:0,bottom:0,height:0};if(t-=r.tableY,i&&t>r.tableNoFrameHeight-r.getBottomFrozenRowsHeight()&&t<r.tableNoFrameHeight)for(let e=0;e<r.rightFrozenColCount;e++)if(t>r.tableNoFrameHeight-r.getRowsHeight(r.rowCount-e-1,r.rowCount-1))return{row:r.rowCount-e-1,top:void 0,bottom:void 0,height:void 0};return getTargetRowAt(t,r)}function computeTargetRowByY(e,t){let i=t.defaultRowHeight;return t._rowRangeHeightsMap.get(\\\"$0$\\\"+(t.rowCount-1))&&(i=t._rowRangeHeightsMap.get(\\\"$0$\\\"+(t.rowCount-1))/t.rowCount),Math.min(Math.ceil(e/i),t.rowCount-1)}function computeTargetColByX(i,r){if(r._colRangeWidthsMap.get(\\\"$0$\\\"+(r.colCount-1))){let e=0,t=r.colCount-1;for(;1<t-e;){var o=Math.floor((e+t)/2);if(i<r._colRangeWidthsMap.get(\\\"$0$\\\"+o))t=o;else{if(!(i>r._colRangeWidthsMap.get(\\\"$0$\\\"+o)))return o;e=o}}return t}return Math.min(Math.ceil(i/r.internalProps.defaultColWidth),r.colCount-1)}function getCellAtRelativePosition(e,t,i){e-=i.tableX;let r=!1,o=(0<(t-=i.tableY)&&t<i.getFrozenRowsHeight()&&(r=!0),!1),n=(0<e&&e<i.getFrozenColsWidth()&&(o=!0),!1),a=(t>i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()&&t<i.tableNoFrameHeight&&t<=i.getAllRowsHeight()&&(n=!0),!1);e>i.tableNoFrameWidth-i.getRightFrozenColsWidth()&&e<i.tableNoFrameWidth&&e<=i.getAllColsWidth()&&(a=!0);var l,s,h,d,u,c,g=getTargetColAtConsiderRightFrozen((o||a?e:e+i.scrollLeft)+i.tableX,a,i),p=getTargetRowAtConsiderBottomFrozen((r||n?t:t+i.scrollTop)+i.tableY,n,i);return g&&p?(({row:p,top:l,bottom:s,height:h}=p),({col:g,left:d,right:u,width:c}=g),{row:p,col:g,rect:{left:d,right:u,top:l,bottom:s,width:c,height:h}}):{col:-1,row:-1}}function isValidAlignDomain(e){return 2===e.length&&isValidNumber_default(e[0])&&isValidNumber_default(e[1])&&e[1]>=e[0]}function getScaleInfo(e){var t=e[1]-e[0];let i=e[0]<=0?0-e[0]:0,r=0<e[1]?+e[1]:0;return 0==t?e[0]<0?(i=1,r=0):0<e[0]&&(i=0,r=1):(i/=t,r/=t),{total:t,negative:i,positive:r,includeZero:e[1]*e[0]<0,domain:e,extendable_min:!0,extendable_max:!0}}function inDifferentCrossZero(e,t){var{positive:i,negative:r,extendable_min:o,extendable_max:n,domain:a}=e,{positive:l,negative:s,extendable_min:h,extendable_max:d,domain:u}=t;if(0<l){if(!h)return!1;let e=r/i;n&&(e=r/Math.max(i,l),a[1]=-a[0]/e),u[0]=-u[1]*e}else if(0<s){if(!d)return!1;let e=i/r;o&&(e=i/Math.max(r,r),a[0]=-a[1]/e),u[1]=-u[0]*e}return!0}function inOnlyZeroDomain(e,t){var{extendable_min:i,extendable_max:r,domain:o}=e,{positive:n,negative:a,domain:l}=t;return!(0===n&&0===a||0<n&&!r||0<a&&!i||(o[0]=l[0],o[1]=l[1],0))}function inAllCrossZero(e,t){var{positive:i,negative:r,extendable_max:o,domain:n}=e,{positive:a,negative:l,extendable_min:s,domain:h}=t;if(o&&s){var d=Math.max(r,l)/Math.max(i,a);n[1]=-n[0]/d,h[0]=-h[1]*d}else if(s)h[0]=-h[1]*(r/i);else{if(!o)return!1;n[1]=-n[0]/(l/a)}return!0}function inNoCrossDifferentSide(e,t){var{extendable_min:i,domain:r}=e,{extendable_max:o,domain:n}=t;return!(!i||!o||(r[0]=-r[1],n[1]=-n[0],0))}function getNewRangeToAlign(e,t){var i=[e.min,e.max],r=[t.min,t.max];if(isValidAlignDomain(i)&&isValidAlignDomain(r)){var o=getScaleInfo(i),n=getScaleInfo(r),{positive:a,negative:l,extendable_min:s,extendable_max:h,includeZero:d}=o,{positive:u,negative:c,extendable_min:g,extendable_max:p,includeZero:f}=n;if(0===a&&0===l){if(!inOnlyZeroDomain(o,n))return}else if(0===u&&0===c){if(!inOnlyZeroDomain(n,o))return}else if(d||f)if(d&&!f){if(!inDifferentCrossZero(o,n))return}else if(f&&!d){if(!inDifferentCrossZero(n,o))return}else{if(l===c)return;if(c<l){if(!inAllCrossZero(o,n))return}else if(!inAllCrossZero(n,o))return}else{if(0===l&&0===u){if(!inNoCrossDifferentSide(o,n))return}else if(0===c&&0===a&&!inNoCrossDifferentSide(n,o))return;if(0===l&&0===c)if(0===i[0]&&0<r[0]){if(!g)return;r[0]=0}else{if(!(0===r[0]&&0<i[0]))return;if(!s)return;i[0]=0}if(0===a&&0===u)if(0===i[1]&&0<r[1]){if(!p)return;r[1]=0}else{if(!(0===r[1]&&0<i[1]))return;if(!h)return;i[1]=0}}return{range1:i,range2:r}}}function getZeroAlignTickAlignTicks(e,t,i,r,o,n){var a=Factory2.getFunction(\\\"getAxisDomainRangeAndLabels\\\"),{axisOption:l,isZeroAlign:s}=getAxisOption(t,i,0===r?\\\"right\\\":\\\"left\\\",n),l=a(e.min,e.max,l,s,\\\"bottom\\\"===o||\\\"top\\\"===o?n._table.getColWidth(t)||n._table.tableNoFrameWidth:n._table.getRowHeight(i)||n._table.tableNoFrameHeight).ticks;return l}function getTickModeFunction(e,i,r,t){return 0!==t&&e?()=>e.map(e=>{var t=(e-i.min)/(i.max-i.min),t=(r.max-r.min)*t+r.min;return Math.round(100*t)/100}):void 0}function getAxisOption(e,t,r,o){const n=o.getRawChartSpec(e,t),i=null!=(a=n.axes)?a:[];if(o._table.pivotChartAxes.forEach(t=>{-1===i.findIndex(e=>t.orient===e.orient)&&i.push(t)}),n&&isArray_default(i)){var a=i.find(e=>e.orient===r);if(a){var{seriesIndex:l,seriesId:s}=a;let e,i;isValid_default(s)&&isArray_default(n.series)?e=(isArray_default(s)?s:[s]).map(t=>{var e=n.series.findIndex(e=>e.id===t);return 0<=e&&(i=n.series[e]),e}):isValid_default(l)&&isArray_default(n.series)&&(e=l);var{isZeroAlign:s,isTickAlign:l}=checkZeroAlign(n,r,o);return{axisOption:a,isPercent:n.percent,isZeroAlign:s,isTickAlign:l,seriesIndice:e,theme:n.theme,chartType:null!=(a=null==i?void 0:i.type)?a:n.type}}}var s=o._table.pivotChartAxes.find(e=>e.orient===r),{isZeroAlign:l,isTickAlign:a}=checkZeroAlign(n,r,o);return{axisOption:s,isPercent:!1,isZeroAlign:l,isTickAlign:a,theme:n.theme,chartType:n.type}}function checkZeroAlign(e,t,i){const r=[];var o;\\\"left\\\"===t||\\\"right\\\"===t?r.push(\\\"left\\\",\\\"right\\\"):\\\"top\\\"!==t&&\\\"bottom\\\"!==t||r.push(\\\"top\\\",\\\"bottom\\\"),o=e&&isArray_default(e.axes)?e.axes:i._table.pivotChartAxes;let n=!1,a=!1;if(isArray_default(o)){const l=[];o.forEach(e=>{r.includes(e.orient)&&l.push(e)});for(let e=0;e<l.length;e++){const s=l[e];s.sync&&s.sync.axisId&&l.find(e=>e.id===s.sync.axisId)&&(n=n||s.sync.zeroAlign,a=a||s.sync.tickAlign)}}return{isZeroAlign:n,isTickAlign:a}}function getAxisRange(t,i,r,o,n){var e;if(isArray_default(n)){var a={min:1/0,max:-1/0};for(let e=0;e<n.length;e++){var l=getAxisRange(t,i,r,o,n[e]);l&&(a.min=Math.min(a.min,l.min),a.max=Math.max(a.max,l.max))}return isFinite(a.min)&&isFinite(a.max)?a:null}let s=null==i?void 0:i[n];return(s=isArray_default(s)?s[0]:s)?((e=merge({},null!=(e=null==(e=t[s])?void 0:e[null!=o?o:\\\"\\\"])?e:{min:0,max:1})).positiveMax&&e.positiveMax>e.max&&(e.max=e.positiveMax),e.negativeMin&&e.negativeMin<e.min&&(e.min=e.negativeMin),e.min===e.max&&(0<e.min?e.min=0:e.max=0),e):null}function isTopOrBottomAxis(e,t,i){return!!i._table.isPivotChart()&&(!!(i.indicatorsAsCol&&i.hasTwoIndicatorAxes&&t===i.columnHeaderLevelCount-1&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)||t===i.rowCount-i.bottomFrozenRowCount&&e>=i.rowHeaderLevelCount&&e<i.colCount-i.rightFrozenColCount)}function isLeftOrRightAxis(e,t,i){if(i._table.isPivotChart())if(i.indicatorsAsCol){if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return!0}else{if(e===i.rowHeaderLevelCount-1&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return!0;if(e===i.colCount-i.rightFrozenColCount&&t>=i.columnHeaderLevelCount&&t<i.rowCount-i.bottomFrozenRowCount)return!0}return!1}function getChartAxisRange(e,t,i,r,o,n,a){var l,{axisOption:s,isPercent:h,isZeroAlign:d,isTickAlign:u,seriesIndice:c,theme:g,chartType:p}=getAxisOption(e,t,r,a),f=getAxisRange(a.dataset.collectedValues,o,d,n,null!=c?c:i);if(f)return h&&(f.min=f.min<0?-1:0,f.max=0<f.max?1:0),(null!=s&&s.zero||f.min===f.max)&&(f.min=Math.min(f.min,0),f.max=Math.max(f.max,0)),({range:h,ticks:l}=Factory2.getFunction(\\\"getAxisDomainRangeAndLabels\\\")(f.min,f.max,s,d,\\\"bottom\\\"===r||\\\"top\\\"===r?a._table.getColWidth(e)||a._table.tableNoFrameWidth:a._table.getRowHeight(t)||a._table.tableNoFrameHeight)),null!=s&&s.nice&&(f.min=h[0],f.max=h[1]),h=l,isNumber_default(null==s?void 0:s.min)&&(f.min=s.min),isNumber_default(null==s?void 0:s.max)&&(f.max=s.max),{index:null!=c?c:i,range:f,ticks:h,isZeroAlign:d,isTickAlign:u,axisOption:s,theme:g,chartType:p}}function getAxisRangeAndTicks(e,t,i,r,o,n,a,l){var s,{range:h,isZeroAlign:d,isTickAlign:u,axisOption:c}=getChartAxisRange(e,t,i,r,n,a,l),{targetRange:u,targetTicks:g}=getTargetRangeAndTicks(e,t,i,d,u,h,n,o,a,l);return 0!==i&&g&&(({range:d,ticks:s}=Factory2.getFunction(\\\"getAxisDomainRangeAndLabels\\\")(h.min,h.max,merge({},c,{nice:!0,tick:{forceTickCount:g.length}}),d,\\\"bottom\\\"===r||\\\"top\\\"===r?l._table.getColWidth(e)||l._table.tableNoFrameWidth:l._table.getRowHeight(t)||l._table.tableNoFrameHeight,{targetTicks:g,targetRange:u})),h.min=d[0],h.max=d[1]),{axisOption:c,range:h,targetTicks:g,targetRange:u}}function getTargetRangeAndTicks(e,t,i,r,o,n,a,l,s,h){let d,u;var c,g;return{targetTicks:d=(r||o)&&(g=getChartAxisRange(e,t,a.length-1-i,l,a,s,h))&&(({range:g,ticks:c}=g),u=g,r&&(g=getNewRangeToAlign(n,g))&&(n.min=g.range1[0],n.max=g.range1[1],u.min=g.range2[0],u.max=g.range2[1]),o)?r?getZeroAlignTickAlignTicks(u,e,t,i,l,h):c:d,targetRange:u}}function mergeStyle(e,t){e=e.clone();for(const r in t){var i=t[r];isValid_default(i)&&(e[\\\"_\\\"+r]=i)}return e}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),function(e){e.vertical=\\\"vertical\\\",e.horizontal=\\\"horizontal\\\"}(Direction2=Direction2||{}),init_esbuild_inject();var EMPTY_STYLE={};function getCellStyle(r,o,n){var e=null==(e=n.customCellStylePlugin)?void 0:e.getCustomCellStyle(r,o),a=n.internalProps.layoutMap;if(a.isHeader(r,o)){let t;t=!n.isPivotTable()||n.isBottomFrozenRow(o)||n.isRightFrozenColumn(r)?r+\\\"-\\\"+o:(s=n.getHeaderDefine(r,o),l=n.isCornerHeader(r,o),null!=s&&s.dimensionKey?l?\\\"dim-cor-\\\"+s.dimensionKey:\\\"dim-\\\"+s.dimensionKey:null!=s&&s.indicatorKey?\\\"ind-\\\"+s.indicatorKey:r+\\\"-\\\"+o);let i=n.headerStyleCache.get(t);if(!i){var l=a.getHeader(r,o);let e;if(n.isPivotChart()&&isTopOrBottomAxis(r,o,a)&&a.isAxisCell(r,o)?e=null!=(s=null==(s=a.getBody(r,n.rowHeaderLevelCount).style)?void 0:s.padding)?s:n.theme.bodyStyle.padding:n.isPivotChart()&&isLeftOrRightAxis(r,o,a)&&a.isAxisCell(r,o)&&(e=null!=(s=null==(s=a.getBody(n.columnHeaderLevelCount,o).style)?void 0:s.padding)?s:n.theme.bodyStyle.padding),(!l||l.isEmpty)&&(a.isLeftBottomCorner(r,o)||a.isRightBottomCorner(r,o)||a.isCornerHeader(r,o)||a.isRightTopCorner(r,o)))return EMPTY_STYLE;var s=n.internalProps.headerHelper.getStyleClass((null==l?void 0:l.headerType)||\\\"text\\\");i=a.isBottomFrozenRow(r,o)&&n.theme.bottomFrozenStyle?of3(e?{padding:e}:{},n.theme.bottomFrozenStyle,{col:r,row:o,table:n,value:n.getCellValue(r,o),dataValue:n.getCellOriginValue(r,o),cellHeaderPaths:n.getCellHeaderPaths(r,o)},s,n.options.autoWrapText,n.theme):a.isRightFrozenColumn(r,o)&&n.theme.rightFrozenStyle?of3(e?{padding:e}:{},n.theme.rightFrozenStyle,{col:r,row:o,table:n,value:n.getCellValue(r,o),dataValue:n.getCellOriginValue(r,o),cellHeaderPaths:n.getCellHeaderPaths(r,o)},s,n.options.autoWrapText,n.theme):(l=(null==l?void 0:l.style)||{},e&&(l.padding=e),of3(l,a.isColumnHeader(r,o)||a.isBottomFrozenRow(r,o)?n.theme.headerStyle:a.isRowHeader(r,o)||a.isRightFrozenColumn(r,o)?n.theme.rowHeaderStyle:n.theme.cornerHeaderStyle,{col:r,row:o,table:n,value:n.getCellValue(r,o),dataValue:n.getCellOriginValue(r,o),cellHeaderPaths:n.getCellHeaderPaths(r,o)},s,n.options.autoWrapText,n.theme)),n.headerStyleCache.set(t,i)}return e?mergeStyle(i,e):i}let i,t;null!=(s=null==(l=n.internalProps)?void 0:l.dataConfig)&&s.mappingRules&&!n.isHeader(r,o)&&null!=(l=null==(s=null==(l=n.internalProps)?void 0:l.dataConfig)?void 0:s.mappingRules)&&l.forEach((e,t)=>{e.bgColor&&n.internalProps.layoutMap.getIndicatorKey(r,o)===e.bgColor.indicatorKey&&(i=e.bgColor.mapping)});var h,s=n.getCellType(r,o),l=n.getCellOriginRecord(r,o);let d;return t=null!=l&&l.vtableMerge?\\\"merge-title\\\":n.isSeriesNumberInBody(r,o)?r+\\\"-series-\\\"+s:n.isListTable()&&!n.transpose||n.isPivotTable()&&n.internalProps.layoutMap.indicatorsAsCol?r+s:o+s,(d=(null!=l&&l.vtableMerge?n.bodyMergeTitleCache:a.isBottomFrozenRow(o)?n.bodyBottomStyleCache:n.bodyStyleCache).get(t))||(s=a.getBody(r,o),h=n.internalProps.bodyHelper.getStyleClass(n.getCellType(r,o)),s=null==s?void 0:s.style,d=of(s,null!=l&&l.vtableMerge&&n.theme.groupTitleStyle?n.theme.groupTitleStyle:a.isBottomFrozenRow(o)&&n.theme.bottomFrozenStyle?n.theme.bottomFrozenStyle:a.isRightFrozenColumn(r)&&n.theme.rightFrozenStyle?n.theme.rightFrozenStyle:n.theme.bodyStyle,{col:r,row:o,table:n,value:n.getCellValue(r,o),dataValue:n.getCellOriginValue(r,o),cellHeaderPaths:n.getCellHeaderPaths(r,o)},h,n.options.autoWrapText,n.theme),i&&(d=mergeStyle(d,{bgColor:i})),isFunction_default(s)||(a.isBottomFrozenRow(o)?n.bodyBottomStyleCache:n.bodyStyleCache).set(t,d)),e?mergeStyle(d,e):d}function isInteger(e){return Math.floor(e)===e}init_esbuild_inject();var Animateaaa=class extends ACustomAnimate{onUpdate(e,t,i){var r;this.from.x!==this.to.x&&(r=e?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*t),this.params.table.scrollLeft=r),this.from.y!==this.to.y&&(r=e?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*t),this.params.table.scrollTop=r)}},TableAnimationManager=class{constructor(e){this.table=e,this.timeline=new DefaultTimeline,this.ticker=new DefaultTicker,this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=createRect({})}scrollTo(e,t){var i={x:this.table.scrollLeft,y:this.table.scrollTop},{col:r,row:o}=e;let n,a,l=r,s=o;isNumber_default(r)&&!isInteger(r)&&(l=Math.floor(r),n=r-l),isNumber_default(o)&&!isInteger(o)&&(s=Math.floor(o),a=o-s);var h=this.table.getCellRect(null!=l?l:0,null!=s?s:0);let{left:d,top:u}=h;n&&(d+=n*h.width),a&&(u+=a*h.height);h={x:isNumber_default(r)?d-this.table.getFrozenColsWidth():this.table.scrollLeft,y:isNumber_default(o)?u-this.table.getFrozenRowsHeight():this.table.scrollTop},o=isBoolean_default(t)?t?3e3:0:null!=(r=null==t?void 0:t.duration)?r:3e3,r=isBoolean_default(t)?t?\\\"linear\\\":\\\"\\\":null!=(r=null==t?void 0:t.easing)?r:\\\"linear\\\";new Animate(Generator.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new Animateaaa(i,h,o,r,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}};function getCustomMergeCellFunc(e){return isFunction_default(e)?e:isArray_default(e)?(t,i)=>e.find(e=>e.range.start.col<=t&&e.range.end.col>=t&&e.range.start.row<=i&&e.range.end.row>=i):void 0}init_esbuild_inject();var toBoxArray2=style.toBoxArray,isTouchEvent3=event.isTouchEvent,rangeReg=/^\\\\$(\\\\d+)\\\\$(\\\\d+)$/,BaseTable=(importStyle(),class extends EventTarget3{static get EVENT_TYPE(){return TABLE_EVENT_TYPE}constructor(e,t={}){var i;if(super(),this.showFrozenIcon=!0,this.version=\\\"1.17.3\\\",this.id=\\\"VTable\\\"+Date.now(),this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=throttle22(this.render.bind(this),200),!e&&\\\"node\\\"!==t.mode&&!t.canvas)throw new Error(\\\"vtable's container is undefined\\\");!1===(null==(k=t.customConfig)?void 0:k.imageAnonymous)&&(vglobal.isImageAnonymous=!1);let{frozenColCount:r=0,unfreezeAllOnExceedsMaxWidth:o,frozenRowCount:n,defaultRowHeight:a=40,defaultHeaderRowHeight:l,defaultColWidth:s=80,defaultHeaderColWidth:h,widthMode:d=\\\"standard\\\",heightMode:u=\\\"standard\\\",autoFillWidth:c=!1,autoFillHeight:g=!1,widthAdaptiveMode:p=\\\"only-body\\\",heightAdaptiveMode:f=\\\"only-body\\\",keyboardOptions:m,eventOptions:b,rowSeriesNumber:C,columnResizeMode:v,rowResizeMode:y=\\\"none\\\",resize:w,dragHeaderMode:_,dragOrder:S,showFrozenIcon:x,allowFrozenColCount:R,padding:T,customRender:F,pixelRatio:A=defaultPixelRatio,renderChartAsync:D,renderChartAsyncBatchCount:z,canvasWidth:P,canvasHeight:B,overscrollBehavior:M,limitMinWidth:E,limitMinHeight:H,clearDOM:O=!0}=t;this.container=e,this.options=t,this._widthMode=d,this._heightMode=u,this._widthAdaptiveMode=p,this._heightAdaptiveMode=f,this._autoFillWidth=c,this._autoFillHeight=g,this.customRender=F,this.padding={top:0,right:0,left:0,bottom:0},T&&(\\\"number\\\"==typeof T?(this.padding.top=T,this.padding.left=T,this.padding.bottom=T,this.padding.right=T):(T.top&&(this.padding.top=T.top),T.bottom&&(this.padding.bottom=T.bottom),T.left&&(this.padding.left=T.left),T.right&&(this.padding.right=T.right))),(isValid_default(B)||isValid_default(P))&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.canvasWidth=isNumber_default(P)?P:void 0,this.canvasHeight=isNumber_default(B)?B:void 0,this.columnWidthComputeMode=null!=(k=t.columnWidthComputeMode)?k:\\\"normal\\\";var I=this.internalProps={};void 0!==x&&(this.showFrozenIcon=x),\\\"number\\\"==typeof R&&R<=0&&(this.showFrozenIcon=!1),this.options.canvas?(\\\"node\\\"!==Env.mode&&(I.element=this.options.canvas.parentElement,I.element.style.position=\\\"relative\\\"),I.focusControl=new FocusInput(this,I.element),I.canvas=this.options.canvas,I.context=I.canvas.getContext(\\\"2d\\\")):\\\"node\\\"!==Env.mode&&(I.element=createRootElement(this.padding),I.focusControl=new FocusInput(this,I.element),I.canvas=document.createElement(\\\"canvas\\\"),I.element.appendChild(I.canvas),I.context=I.canvas.getContext(\\\"2d\\\"),null!=(k=t.customConfig))&&k.createReactContainer&&createReactContainer(this),I.handler=new EventHandler,isNumber_default(this.options.resizeTime)&&(I.handler.resizeTime=this.options.resizeTime),I.pixelRatio=A,I.frozenColCount=r,I.frozenRowCount=n,I.unfreezeAllOnExceedsMaxWidth=null==o||o,I.defaultRowHeight=a,I.defaultHeaderRowHeight=null!=l?l:a,I.defaultColWidth=s,I.defaultHeaderColWidth=null!=h?h:s,I.keyboardOptions=m,I.eventOptions=b,I.rowSeriesNumber=C,I.columnResizeMode=null!=(k=null==w?void 0:w.columnResizeMode)?k:v,I.rowResizeMode=null!=(k=null==w?void 0:w.rowResizeMode)?k:y,I.dragHeaderMode=null!=(k=null!=(k=null==S?void 0:S.dragHeaderMode)?k:_)?k:\\\"none\\\",I.renderChartAsync=D,setBatchRenderChartCount(z),I.overscrollBehavior=null!=M?M:\\\"auto\\\",I._rowHeightsMap=new NumberRangeMap(this),I._rowRangeHeightsMap=new Map,I._colRangeWidthsMap=new Map,I._widthResizedColMap=new Set,I._heightResizedRowMap=new Set,this.colWidthsMap=new NumberMap,this.colContentWidthsMap=new NumberMap,this.colWidthsLimit={};const N=this;if(I.calcWidthContext={_:I,get full(){var e;return\\\"node\\\"===Env.mode?N.canvasWidth/(null!=A?A:1):this._.canvas.width/(null!=(e=this._.context.pixelRatio)?e:window.devicePixelRatio)}},I.cellTextOverflows={},I.focusedTable=!1,I.theme=themes_default.of(null!=(k=t.theme)?k:themes_default.DEFAULT),I.theme.isPivot=this.isPivotTable(),setIconColor(I.theme.functionalIconsStyle),e&&(O&&(e.innerHTML=\\\"\\\"),e.appendChild(I.element)),this._updateSize(),I.bodyHelper=new BodyHelper(this),I.headerHelper=new HeaderHelper(this),I.rowSeriesNumberHelper=new RowSeriesNumberHelper(this),I.autoWrapText=t.autoWrapText,I.enableLineBreak=t.enableLineBreak,I.allowFrozenColCount=null!=(k=t.allowFrozenColCount)?k:0,I.limitMaxAutoWidth=null!=(k=t.limitMaxAutoWidth)?k:450,I.limitMinWidth=null!=E?\\\"number\\\"==typeof E?E:E?10:0:10,I.limitMinHeight=null!=H?\\\"number\\\"==typeof H?H:H?10:0:10,this.scenegraph=new Scenegraph(this),this.stateManager=new StateManager(this),this.eventManager=new EventManager2(this),this.animationManager=new TableAnimationManager(this),t.legends){I.legends=[];var L=Factory2.getFunction(\\\"createLegend\\\");if(Array.isArray(t.legends))for(let e=0;e<t.legends.length;e++)I.legends.push(L(t.legends[e],this));else I.legends.push(L(t.legends,this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}I.tooltip=Object.assign({parentElement:this.getElement(),renderMode:\\\"html\\\",isShowOverflowTextTooltip:!1,confine:!0,position:Placement.bottom},t.tooltip),\\\"html\\\"===I.tooltip.renderMode&&(k=Factory2.getComponent(\\\"tooltipHandler\\\"))&&(I.tooltipHandler=new k(this,I.tooltip.confine)),I.menu=Object.assign({renderMode:\\\"html\\\"},t.menu),Array.isArray(null==(k=t.menu)?void 0:k.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(k=t.menu)?void 0:k.dropDownMenuHighlight),!Array.isArray(null==(k=t.menu)?void 0:k.defaultHeaderMenuItems)&&\\\"function\\\"!=typeof(null==(k=t.menu)?void 0:k.defaultHeaderMenuItems)||(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),\\\"html\\\"===I.menu.renderMode&&(k=Factory2.getComponent(\\\"menuHandler\\\"),I.menuHandler=new k(this)),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,I.stick={changedCells:new Map},I.customMergeCell=getCustomMergeCellFunc(t.customMergeCell);var k=Factory2.getComponent(\\\"customCellStylePlugin\\\");k&&(this.customCellStylePlugin=new k(this,null!=(i=t.customCellStyle)?i:[],null!=(i=t.customCellStyleArrangement)?i:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){\\\"auto\\\"!==this.options.canvasHeight&&\\\"auto\\\"!==this.options.canvasWidth||setTimeout(()=>{let t,i,r,o,n,a,l,s,h,d,u,c,g,p,f,m,b,C,v,y,w,_,S,x,R,T;if(\\\"auto\\\"===this.options.canvasHeight){let e=0;null!=(t=this.theme.frameStyle)&&t.innerBorder?e+=null!=(o=toBoxArray2(null!=(r=null==(i=this.internalProps.theme.frameStyle)?void 0:i.shadowBlur)?r:[0])[1])?o:0:this.theme.frameStyle&&(A=toBoxArray2(null!=(a=null==(n=this.internalProps.theme.frameStyle)?void 0:n.borderLineWidth)?a:[null]),P=toBoxArray2(null!=(s=null==(l=this.internalProps.theme.frameStyle)?void 0:l.shadowBlur)?s:[0]),e+=(null!=(h=A[0])?h:0)+(null!=(d=P[0])?d:0)+((null!=(u=A[2])?u:0)+(null!=(c=P[2])?c:0))),T=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-e:2e4,this.getAllRowsHeight())+e}else T=this.canvasHeight;if(\\\"auto\\\"===this.options.canvasWidth){let e=0;var A,P;null!=(g=this.theme.frameStyle)&&g.innerBorder?e+=null!=(m=toBoxArray2(null!=(f=null==(p=this.internalProps.theme.frameStyle)?void 0:p.shadowBlur)?f:[0])[2])?m:0:this.theme.frameStyle&&(A=toBoxArray2(null!=(C=null==(b=this.internalProps.theme.frameStyle)?void 0:b.borderLineWidth)?C:[null]),P=toBoxArray2(null!=(y=null==(v=this.internalProps.theme.frameStyle)?void 0:v.shadowBlur)?y:[0]),e+=(null!=(w=A[1])?w:0)+(null!=(_=P[1])?_:0)+((null!=(S=A[3])?S:0)+(null!=(x=P[3])?x:0))),R=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-e:2e4,this.getAllColsWidth())+e}else R=this.canvasWidth;this.setCanvasSize(R,T)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(e,t){this.canvasWidth=e,this.canvasHeight=t,this.options.canvasHeight=t,this.options.canvasWidth=e,this.resize()}resize(){var e;this._updateSize(),null!=(e=this.internalProps.legends)&&e.forEach(e=>{null!=e&&e.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(e){this.internalProps.rowCount=e}get colCount(){var e;return null!=(e=this.internalProps.colCount)?e:0}set colCount(e){this.internalProps.colCount=e}get frozenColCount(){var e;return null!=(e=null!=(e=null==(e=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:e.frozenColCount)?e:null==(e=this.internalProps)?void 0:e.frozenColCount)?e:0}set frozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;var t=this._getMaxFrozenWidth();this.getColsWidth(0,e-1)>t&&(this.internalProps.unfreezeAllOnExceedsMaxWidth?this.internalProps.frozenColCount=0:(t=this._getComputedFrozenColCount(e),this.internalProps.frozenColCount=t)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e,this.options.frozenColCount=e;var t=this._getMaxFrozenWidth();this.getColsWidth(0,e-1)>t&&(this.internalProps.unfreezeAllOnExceedsMaxWidth?this.internalProps.frozenColCount=0:(t=this._getComputedFrozenColCount(e),this.internalProps.frozenColCount=t)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(e){e>=this.colCount&&(e=0),this.internalProps.frozenColCount=e}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var e;return null!=(e=null!=(e=null==(e=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:e.frozenRowCount)?e:null==(e=this.internalProps)?void 0:e.frozenRowCount)?e:0}set frozenRowCount(e){this.internalProps.frozenRowCount=e,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var e;return null!=(e=null!=(e=null==(e=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:e.rightFrozenColCount)?e:null==(e=this.internalProps)?void 0:e.rightFrozenColCount)?e:0}set rightFrozenColCount(e){this.scenegraph.dealWidthRightFrozen(e)}get bottomFrozenRowCount(){var e;return null!=(e=null!=(e=null==(e=null==(e=this.internalProps)?void 0:e.layoutMap)?void 0:e.bottomFrozenRowCount)?e:null==(e=this.internalProps)?void 0:e.bottomFrozenRowCount)?e:0}set bottomFrozenRowCount(e){this.scenegraph.dealWidthBottomFrozen(e)}get defaultRowHeight(){return isNumber_default(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(e){this.internalProps.defaultRowHeight=e,this.options.defaultRowHeight=e}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(e){this.internalProps.defaultHeaderRowHeight=e,this.options.defaultHeaderRowHeight=e}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(e){this.internalProps.defaultColWidth=e,this.options.defaultColWidth=e}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(e){this.internalProps.defaultHeaderColWidth=e,this.options.defaultHeaderColWidth=e}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(e){this.internalProps._colWidthsMap=e}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(e){this.internalProps._colContentWidthsMap=e}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(e){this.internalProps._colRangeWidthsMap=e}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(e){this.internalProps._rowRangeHeightsMap=e}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(e){this.internalProps._rowHeightsMap=e}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(e){this.internalProps._colWidthsLimit=e}get keyboardOptions(){var e;return null!=(e=this.internalProps.keyboardOptions)?e:null}set keyboardOptions(e){this.internalProps.keyboardOptions=null!=e?e:void 0}get eventOptions(){var e;return null!=(e=this.internalProps.eventOptions)?e:null}set eventOptions(e){this.internalProps.eventOptions=null!=e?e:void 0}get widthMode(){return this._widthMode}set widthMode(e){e!==this._widthMode&&(this._widthMode=e,this.options.widthMode=e)}get heightMode(){return this._heightMode}set heightMode(e){e!==this._heightMode&&(this._heightMode=e,this.options.heightMode=e)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(e){e!==this._autoFillWidth&&(this._autoFillWidth=e)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(e){e!==this._autoFillHeight&&(this._autoFillHeight=e)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(e){e!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=e)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(e){e!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=e)}_colWidthDefineToPxWidth(e){return\\\"auto\\\"===e?0:_toPxWidth(this,e)}_getMaxFrozenWidth(){var e;return _toPxWidth(this,null!=(e=this.options.maxFrozenWidth)?e:\\\"80%\\\")}_getComputedFrozenColCount(e){var t=this._getMaxFrozenWidth();let i=e;for(;this.getColsWidth(0,i-1)>t&&!(--i<=0););return i}_getColWidthLimits(e){var t,i=this.colWidthsLimit[e];return i?(t={},i.min&&(t.min=_toPxWidth(this,i.min),t.minDef=i.min),i.max&&(t.max=_toPxWidth(this,i.max),t.maxDef=i.max),t):null}_adjustColWidth(e,t){var i=this._getColWidthLimits(e);return Math.max(_applyColWidthLimits(i,t),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==(null==(e=this.internalProps)?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;const i=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var e;return\\\"node\\\"===Env.mode?i/(null!=t?t:1):this._.canvas.width/(null!=(e=this._.context.pixelRatio)?e:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var i=this.padding;let r=0,o=0;if(this.tableX=0,this.tableY=0,this.options.canvas&&this.options.viewBox)r=this.options.viewBox.x2-this.options.viewBox.x1,o=this.options.viewBox.y2-this.options.viewBox.y1,null!=(n=null==this?void 0:this.scenegraph)&&n.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(r,o));else if(\\\"browser\\\"===Env.mode){var n=this.getElement();let e=0,t=0;var a=isValid_default(this.canvasWidth),l=isValid_default(this.canvasHeight),a=(this.canvasSizeSeted&&(a&&(e=this.canvasWidth),l)&&(t=this.canvasHeight),a&&l||!n.parentElement||(s=n.parentElement.style||window.getComputedStyle(n.parentElement),a||(e=n.parentElement.offsetWidth-(parseInt(s.paddingLeft,10)||0)-(parseInt(s.paddingRight,10)||0)),l||(t=n.parentElement.offsetHeight-parseInt(s.paddingTop||\\\"0px\\\",10)-parseInt(s.paddingBottom||\\\"0px\\\",20)),e=(null!=e?e:1)-(this.options.tableSizeAntiJitter?1:0),t=(null!=t?t:1)-(this.options.tableSizeAntiJitter?1:0)),n.style.width=e&&e-i.left-i.right+\\\"px\\\"||\\\"0px\\\",n.style.height=t&&t-i.top-i.bottom+\\\"px\\\"||\\\"0px\\\",this.internalProps).canvas;r=(null!=(s=null==(l=a.parentElement)?void 0:l.offsetWidth)?s:1)-(this.options.tableSizeAntiJitter?1:0),o=(null!=(i=null==(n=a.parentElement)?void 0:n.offsetHeight)?i:1)-(this.options.tableSizeAntiJitter?1:0),null!=(l=null==this?void 0:this.scenegraph)&&l.stage?null==(s=this.options)||!s.viewBox||null!=(n=this.options)&&n.canvas||this.scenegraph.stage.resize(r,o):(a.style.width=\\\"\\\",a.style.height=\\\"\\\",a.width=r,a.height=o,a.style.width=r+\\\"px\\\",a.style.height=o+\\\"px\\\"),null!=(i=this.options)&&i.viewBox&&(r=this.options.viewBox.x2-this.options.viewBox.x1,o=this.options.viewBox.y2-this.options.viewBox.y1),null!=(l=null==this?void 0:this.scenegraph)&&l.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(r,o))}else\\\"node\\\"===Env.mode&&(r=this.canvasWidth-1,o=this.canvasHeight-1);var s=Math.floor(r-getVerticalScrollBarSize(this.getTheme().scrollStyle)),n=Math.floor(o-getHorizontalScrollBarSize(this.getTheme().scrollStyle));null!=(a=this.internalProps.theme)&&a.frameStyle&&(a=toBoxArray2(null!=(l=null==(i=this.internalProps.theme.frameStyle)?void 0:i.borderLineWidth)?l:[null]),i=toBoxArray2(null!=(l=null==(i=this.internalProps.theme.frameStyle)?void 0:i.shadowBlur)?l:[0]),null!=(l=this.theme.frameStyle)&&l.innerBorder?(this.tableX=0,this.tableY=0,this.tableNoFrameWidth=s-(null!=(l=i[1])?l:0),this.tableNoFrameHeight=n-(null!=(l=i[2])?l:0)):(this.tableX=(null!=(l=a[3])?l:0)+(null!=(l=i[3])?l:0),this.tableY=(null!=(l=a[0])?l:0)+(null!=(l=i[0])?l:0),this.tableNoFrameWidth=s-((null!=(l=a[1])?l:0)+(null!=(s=i[1])?s:0))-((null!=(l=a[3])?l:0)+(null!=(s=i[3])?s:0)),this.tableNoFrameHeight=n-((null!=(l=a[0])?l:0)+(null!=(s=i[0])?s:0))-((null!=(n=a[2])?n:0)+(null!=(l=i[2])?l:0))))}updateViewBox(e){var t=(null!=(t=null==(t=null==(t=this.options)?void 0:t.viewBox)?void 0:t.x2)?t:0)-(null!=(t=null==(t=null==(t=this.options)?void 0:t.viewBox)?void 0:t.x1)?t:0),i=(null!=(i=null==(i=null==(i=this.options)?void 0:i.viewBox)?void 0:i.y2)?i:0)-(null!=(i=null==(i=null==(i=this.options)?void 0:i.viewBox)?void 0:i.y1)?i:0),r=e.x2-e.x1,o=e.y2-e.y1;this.options.viewBox=e,t!=r||i!=o?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(e,t,i,r,o,n){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(e,t,i,r,o,n)}get rowHierarchyType(){return\\\"grid\\\"}getColsWidth(e,t){if(t<e)return 0;e=Math.max(e,0),t=Math.min(t,(null!=(i=this.colCount)?i:1/0)-1);var i=this._colRangeWidthsMap.get(`$${e}$`+t);if(null!=i)return i;var i=this._colRangeWidthsMap.get(`$${e}$`+(t-1));if(null!=i)return i=i+this.getColWidth(t),0<=e&&0<=t&&!Number.isNaN(i)&&this._colRangeWidthsMap.set(`$${e}$`+t,Math.round(i)),Math.round(i);let r=0;for(let o=e;o<=t;o++)r+=this.getColWidth(o);return 0<=e&&0<=t&&this._colRangeWidthsMap.set(`$${e}$`+t,Math.round(r)),Math.round(r)}getRowHeight(t){if(isValid_default(this.rowHeightsMap.get(t))){if(null!=(i=this.options.customConfig)&&i._disableColumnAndRowSizeRound){var i=this.rowHeightsMap.get(t);let e;return e=t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t),e=Number(e.toFixed(2)),Number.isInteger(e)?Math.ceil(i):Math.floor(i)}return this.rowHeightsMap.get(t)}i=this.getDefaultRowHeight(t);return isNumber_default(i)?i:this.defaultRowHeight}getDefaultColumnWidth(e){var t;return this.isRowHeader(e,0)||this.isCornerHeader(e,0)?Array.isArray(this.defaultHeaderColWidth)?null!=(t=this.defaultHeaderColWidth[e])?t:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(e,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?null!=(t=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])?t:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(e){var t;return this.isColumnHeader(0,e)||this.isCornerHeader(0,e)||this.isSeriesNumberInHeader(0,e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(t=this.defaultHeaderRowHeight[e])?t:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(e)?Array.isArray(this.defaultHeaderRowHeight)?null!=(t=this.defaultHeaderRowHeight[0<this.columnHeaderLevelCount?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])?t:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(e,t,i){var r;this.rowHeightsMap.put(e,null!=(r=this.options.customConfig)&&r._disableColumnAndRowSizeRound?t:Math.round(t)),i&&this._clearRowRangeHeightsMap(e)}setRowHeight(e,t){this.scenegraph.setRowHeight(e,t),this.scenegraph.updateChartSizeForResizeRowHeight(e),this.internalProps._heightResizedRowMap.add(e)}getRowsHeight(i,r){if(r<i||0===this.rowCount)return 0;i=Math.max(i,0),r=Math.min(r,(null!=(t=this.rowCount)?t:1/0)-1);let o=0;var t=\\\"auto\\\"===this.options.defaultRowHeight;if(\\\"standard\\\"!==this.heightMode||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||t||0!==this.internalProps._heightResizedRowMap.size){if(null!=(t=this.options.customConfig)&&t._disableColumnAndRowSizeRound){t=this.rowHeightsMap.getSumInRange(i,r);let e;return e=r<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,r):r>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(r,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,r),e=Number(e.toFixed(2)),Number.isInteger(e)?Math.ceil(t):Math.floor(t)}o=this.rowHeightsMap.getSumInRange(i,r)}else{for(let e=i;e<Math.min(r+1,this.columnHeaderLevelCount);e++)o+=this.getRowHeight(e);r>=this.columnHeaderLevelCount&&(o+=this.defaultRowHeight*(Math.min(r,this.rowCount-this.bottomFrozenRowCount-1)-Math.max(this.columnHeaderLevelCount,i)+1));for(let t=this.rowCount-this.bottomFrozenRowCount;t<r+1;t++)o+=this.getRowHeight(t)}return Math.round(o)}getColWidthDefined(e){var t=this.internalProps.layoutMap;return\\\"autoWidth\\\"===this.widthMode?\\\"auto\\\":(t=(null!=(t=null==t?void 0:t.getColumnWidthDefined(e))?t:{}).width,\\\"number\\\"==typeof t&&t<=0?0:t||this.getDefaultColumnWidth(e))}getColWidthDefinedNumber(e){var t=this.getColWidthDefined(e);return this._adjustColWidth(e,this._colWidthDefineToPxWidth(t))}isAutoRowHeight(e){return\\\"autoHeight\\\"===this.heightMode||!!this.options.customComputeRowHeight||(0<=e&&e<this.columnHeaderLevelCount?\\\"auto\\\"===this.getDefaultRowHeight(e):\\\"auto\\\"===this.internalProps.defaultRowHeight)}getColWidth(e){var t=null!=(t=this.colWidthsMap.get(e))?t:this.getDefaultColumnWidth(e);return\\\"adaptive\\\"===this.widthMode&&\\\"number\\\"==typeof t||this.transpose&&\\\"number\\\"==typeof t?this._colWidthDefineToPxWidth(t):this._adjustColWidth(e,this._colWidthDefineToPxWidth(t))}_setColWidth(e,t,i,r){this.colWidthsMap.put(e,\\\"number\\\"==typeof t?Math.round(t):t),i&&this._clearColRangeWidthsMap(e),r||this.stateManager.checkFrozen()}setColWidth(e,t){this.scenegraph.setColWidth(e,t),this.scenegraph.updateChartSizeForResizeColWidth(e),this.internalProps._widthResizedColMap.add(e)}_clearColRangeWidthsMap(e){if(\\\"number\\\"!=typeof e)this._colRangeWidthsMap.clear();else for(const r of this._colRangeWidthsMap.keys()){var t,i=rangeReg.exec(r);i&&(t=Number(i[1]),i=Number(i[2]),t<=e)&&e<=i&&this._colRangeWidthsMap[\\\"delete\\\"](r)}}_clearRowRangeHeightsMap(e){this.rowHeightsMap.clearRange()}_getColContentWidth(e){return Number(this.colContentWidthsMap.get(e))}_setColContentWidth(e,t){this.colContentWidthsMap.put(e,t)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getMaxColWidth(e){var t=this.colWidthsLimit[e];let i=null!=(t=t&&t.max)?t:1/0;return i=\\\"string\\\"==typeof i?_toPxWidth(this,i):i}setMaxColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).max=t}getMinColWidth(e){var t=this.colWidthsLimit[e];let i=null!=(t=t&&t.min)?t:0;return i=\\\"string\\\"==typeof i?_toPxWidth(this,i):i}setMinColWidth(e,t){(this.colWidthsLimit[e]||(this.colWidthsLimit[e]={})).min=t}getCellRect(e,t){var i=this.isFrozenCell(e,t),r=this.getColWidth(e),o=!(i&&i.col&&this.isRightFrozenColumn(e,t))||this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,e-1)||0:this.tableNoFrameWidth-(null!=(o=this.getColsWidth(e,this.colCount-1))?o:0),n=this.getRowHeight(t),i=!(i&&i.row&&this.isBottomFrozenRow(e,t))||this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,t-1):this.tableNoFrameHeight-(null!=(i=this.getRowsHeight(t,this.rowCount-1))?i:0);return new Rect2(Math.round(o),Math.round(i),Math.round(r),Math.round(n))}getMergeCellRect(e,t){var i=this.getCellRange(e,t),r=this.getColsWidth(0,i.start.col-1)||0,o=this.getColsWidth(i.start.col,i.end.col),n=this.getRowsHeight(0,i.start.row-1)||0,i=this.getRowsHeight(i.start.row,i.end.row);return new Rect2(Math.round(r),Math.round(n),Math.round(o),Math.round(i))}getCellRelativeRect(e,t){var i=this.isFrozenCell(e,t);let r=!0,o=!0;null!=i&&i.col&&null!=i&&i.row?(r=!1,o=!1):null!=i&&i.col?r=!1:null!=i&&i.row&&(o=!1);i=this.getCellRect(e,t);return this._toRelativeRect(i,r,o)}getCellRangeRelativeRect(i){if(i.start){var r=this.isFrozenCell(i.start.col,i.start.row);let e=!0,t=!0;return null!=r&&r.col&&null!=r&&r.row?(e=!1,t=!1):null!=r&&r.col?e=!1:null!=r&&r.row&&(t=!1),this._toRelativeRect(this.getCellsRect(i.start.col,i.start.row,i.end.col,i.end.row),e,t)}var r=this.getCellRange(i.col,i.row),e=this.isFrozenCell(i.col,i.row);let t=!0,o=!0;return null!=e&&e.col&&null!=e&&e.row?(t=!1,o=!1):null!=e&&e.col?t=!1:null!=e&&e.row&&(o=!1),this._toRelativeRect(this.getCellsRect(r.start.col,r.start.row,r.end.col,r.end.row),t,o)}getVisibleCellRangeRelativeRect(e){var t=e.start?e:this.getCellRange(e.col,e.row);return this._getVisiableRect(this.getCellRangeRelativeRect(e),t)}_getVisiableRect(e,t){var i=t.start.col>=this.frozenColCount?Math.max(e.left,1<=this.frozenColCount?this.getColsWidth(0,this.frozenColCount-1):0):e.left,r=Math.min(e.right,this.tableNoFrameWidth),o=e.copy(),i=(o.left=i,o.right=r,t.start.row>=this.frozenRowCount?Math.max(e.top,1<=this.frozenRowCount?this.getRowsHeight(0,this.frozenRowCount-1):0):e.top),r=Math.min(e.bottom,this.tableNoFrameHeight);return o.top=i,o.bottom=r,o}getCellsRect(e,t,i,r){let o,n,a,l,s,h,d=this.getColsWidth(0,e-1)||0,u=this.getColsWidth(e,i);var c=this.scrollLeft;this.isLeftFrozenColumn(e)&&this.isRightFrozenColumn(i)?u=this.tableNoFrameWidth-(null!=(o=this.getColsWidth(e+1,this.colCount-1))?o:0)-d:this.isLeftFrozenColumn(e)&&!this.isLeftFrozenColumn(i)?u=Math.max(u-c,this.getColsWidth(e,this.frozenColCount-1)):!this.isRightFrozenColumn(e)&&this.isRightFrozenColumn(i)?(d=Math.min(d-c,this.tableNoFrameWidth-this.getRightFrozenColsWidth()),u=this.tableNoFrameWidth-(null!=(n=this.getColsWidth(e+1,this.colCount-1))?n:0)-d):this.isRightFrozenColumn(e)&&(d=this.tableNoFrameWidth-(null!=(a=this.getColsWidth(e,this.colCount-1))?a:0));let g=this.getRowsHeight(0,t-1),p=this.getRowsHeight(t,r);c=this.scrollTop;return this.isTopFrozenRow(t)&&this.isBottomFrozenRow(r)?p=this.tableNoFrameHeight-(null!=(l=this.getRowsHeight(t+1,this.rowCount-1))?l:0)-g:this.isTopFrozenRow(t)&&!this.isTopFrozenRow(r)?p=Math.max(p-c,this.getRowsHeight(t,this.frozenRowCount-1)):!this.isBottomFrozenRow(t)&&this.isBottomFrozenRow(r)?(g=Math.min(g-c,this.tableNoFrameHeight-this.getBottomFrozenRowsHeight()),p=this.tableNoFrameHeight-(null!=(s=this.getRowsHeight(t+1,this.rowCount-1))?s:0)-g):this.isBottomFrozenRow(t)&&(g=this.tableNoFrameHeight-(null!=(h=this.getRowsHeight(t,this.rowCount-1))?h:0)),new Rect2(Math.round(d),Math.round(g),Math.round(u),Math.round(p))}getCellsRectWidth(e,t,i,r){var o=this.isFrozenCell(e,t),n=this.isFrozenCell(i,r);let a=this.getColsWidth(e,i);return o&&o.col&&(o=this.scrollLeft,n&&n.col||(a-=o,a=Math.max(a,this.getColsWidth(e,this.frozenColCount-1)))),a}getCellRangeRect(e){var t;return e.start?this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row):(t=this.getCellRange(e.col,e.row),this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row))}getCellRangeRectWidth(e){var t;return e.start?this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row):(t=this.getCellRange(e.col,e.row),this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row))}isFrozenCell(e,t){var i=this.isFrozenRow(t),r=this.isFrozenColumn(e);return i||r?{row:i,col:r}:null}getRowAt(e){return getRowAt(e,this)}getColAt(e){return getColAt(e,this)}getCellAt(e,t){return getCellAt(e,t,this)}getCellAtRelativePosition(e,t){return getCellAtRelativePosition(e,t,this)}_checkRowCol(e,t){return 0<=e&&e<this.colCount&&0<=t&&t<this.rowCount}_makeVisibleCell(e,t){var i,r,o;!this._checkRowCol(e,t)||(i=this.isFrozenCell(e,t))&&i.col&&i.row||(r=this.getCellRect(e,t),(o=_getScrollableVisibleRect(this)).contains(r))||(i&&i.col||this.getColsWidth(0,this.frozenColCount-1)+r.width>this.canvas.width||(r.left<o.left?this.scrollLeft-=o.left-r.left:o.right<r.right&&(this.scrollLeft-=o.right-r.right)),i&&i.row)||this.getRowsHeight(0,this.frozenRowCount-1)+r.height>this.canvas.height||(r.top<o.top?this.scrollTop-=o.top-r.top:o.bottom<r.bottom&&(this.scrollTop-=o.bottom-r.bottom))}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((e,t)=>{setTimeout(()=>{e()},0)})}_toRelativeRect(e,t=!0,i=!0){var r=e.copy(),o=this.getVisibleRect();return r.offsetLeft(this.tableX-(t?o.left:0)),r.offsetTop(this.tableY-(i?o.top:0)),r.offsetLeft(null!=(o=null==(o=this.options.viewBox)?void 0:o.x1)?o:0),r.offsetTop(null!=(o=null==(o=this.options.viewBox)?void 0:o.y1)?o:0),r}getVisibleRect(){var{scrollTop:e,scrollLeft:t}=this,i=this.tableNoFrameWidth,r=this.tableNoFrameHeight;return new Rect2(t,e,i,r)}get visibleRowCount(){var e=this.frozenRowCount,t=this.getVisibleRect(),i=0<e?t.top+this.getRowsHeight(0,e-1):t.top,r=this.getTargetRowAt(i);if(!r)return 0;i=Math.max(r.top>=i?r.row:r.row+1,e);let o=this.getRowsHeight(0,i-1),n=0;var a=this.rowCount;for(let s=i;s<a;s++){var l=o+this.getRowHeight(s);if(t.bottom<l)break;n++,o=l}return n}getBodyVisibleCellRange(){var{scrollTop:e,scrollLeft:t}=this,i=this.getFrozenRowsHeight(),r=this.getFrozenColsWidth(),o=this.getBottomFrozenRowsHeight(),n=this.getRightFrozenColsWidth(),i=this.getRowAt(e+i+1).row,r=this.getColAt(t+r+1).col,e=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(e+this.tableNoFrameHeight-1-o).row:this.rowCount-1,o=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-n).col:this.colCount-1;return o<0||e<0?null:{rowStart:i,colStart:r,rowEnd:e,colEnd:o}}getBodyVisibleRowRange(){var e=this.scrollTop,t=this.getFrozenRowsHeight(),i=this.getBottomFrozenRowsHeight(),t=this.getRowAt(e+t+1).row,e=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(e+this.tableNoFrameHeight-1-i).row:this.rowCount-1;return e<0?null:{rowStart:t,rowEnd:e}}getBodyVisibleColRange(){var e=this.scrollLeft,t=this.getFrozenColsWidth(),i=this.getRightFrozenColsWidth(),t=this.getColAt(e+t+1).col,e=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-i).col:this.colCount-1;return e<0?null:{colStart:t,colEnd:e}}get visibleColCount(){var e=this.frozenColCount,t=this.getVisibleRect(),i=0<e?t.left+this.getColsWidth(0,e-1):t.left,r=this.getTargetColAt(i);if(!r)return 0;i=Math.max(r.left>=i?r.col:r.col+1,e);let o=this.getColsWidth(0,i-1),n=0;var a=this.colCount;for(let s=i;s<a;s++){var l=o+this.getColWidth(s);if(t.right<l)break;n++,o=l}return n}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(e){this.stateManager.setScrollTop(e)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(e){this.stateManager.setScrollLeft(e)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(e){this.scrollLeft=Math.ceil(e)}setScrollTop(e){this.scrollTop=Math.ceil(e)}getCellOverflowText(e,t){return this.scenegraph.getCellOverflowText(e,t)}addReleaseObj(e){if(!e||!e.release||\\\"function\\\"!=typeof e.release)throw new Error(\\\"not releaseObj!\\\");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(e)}dispose(){this.release()}release(){var e,t,i=this.internalProps;this.isReleased||(null!=(e=null==(t=i.tooltipHandler)?void 0:t.release)&&e.call(t),null!=(e=null==(t=i.menuHandler)?void 0:t.release)&&e.call(t),IconCache.clearAll(),null!=(t=super.release)&&t.call(this),null!=(t=null==(e=i.handler)?void 0:e.release)&&t.call(e),this.eventManager.release(),null!=(t=null==(e=i.focusControl)?void 0:e.release)&&t.call(e),null!=(e=i.legends)&&e.forEach(e=>{null!=e&&e.release()}),null!=(t=i.title)&&t.release(),(i.title=null)!=(e=i.emptyTip)&&e.release(),i.emptyTip=null,i.layoutMap.release(),i.releaseList&&(i.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),i.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),i.focusControl.release(),t=i.element.parentElement,t&&!this.options.canvas&&t.removeChild(i.element),null!=(t=null==(i=null==(e=this.editorManager)?void 0:e.editingEditor)?void 0:i.onEnd)&&t.call(i),this.isReleased=!0,this.scenegraph=null,(this.internalProps=null)!=(e=this.reactCustomLayout)&&e.clearCache())}fireListeners(e,t){return super.fireListeners(e,t)}updateOption(t){this.options=t,this._hasAutoImageColumn=void 0;var{frozenColCount:e=0,unfreezeAllOnExceedsMaxWidth:i,defaultRowHeight:r=40,defaultHeaderRowHeight:o,defaultColWidth:n=80,defaultHeaderColWidth:a=80,keyboardOptions:l,eventOptions:s,rowSeriesNumber:h,columnResizeMode:d,rowResizeMode:u=\\\"none\\\",resize:c,dragHeaderMode:g,dragOrder:p,showFrozenIcon:f,allowFrozenColCount:m,padding:b,pixelRatio:C,widthMode:v,heightMode:y,autoFillWidth:w,autoFillHeight:_,widthAdaptiveMode:S,heightAdaptiveMode:x,customRender:R,renderChartAsync:T,renderChartAsyncBatchCount:A,canvasWidth:P,canvasHeight:B,overscrollBehavior:M,limitMinWidth:E,limitMinHeight:H}=t,I=(C&&C!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=C),b&&(\\\"number\\\"==typeof b?(this.padding.top=b,this.padding.left=b,this.padding.bottom=b,this.padding.right=b):(b.top&&(this.padding.top=b.top),b.bottom&&(this.padding.bottom=b.bottom),b.left&&(this.padding.left=b.left),b.right&&(this.padding.right=b.right))),this.showFrozenIcon=\\\"boolean\\\"!=typeof f||f,\\\"number\\\"==typeof m&&m<=0&&(this.showFrozenIcon=!1),this.widthMode=null!=v?v:\\\"standard\\\",this.heightMode=null!=y?y:\\\"standard\\\",this._widthAdaptiveMode=null!=S?S:\\\"only-body\\\",this._heightAdaptiveMode=null!=x?x:\\\"only-body\\\",this.autoFillWidth=null!=w&&w,this.autoFillHeight=null!=_&&_,this.customRender=R,this.canvasWidth=isNumber_default(P)?P:void 0,this.canvasHeight=isNumber_default(B)?B:void 0,this.internalProps);if(\\\"node\\\"===Env.mode||t.canvas||updateRootElementPadding(I.element,this.padding),this.columnWidthComputeMode=null!=(C=t.columnWidthComputeMode)?C:\\\"normal\\\",I.frozenColCount=e,I.unfreezeAllOnExceedsMaxWidth=null==i||i,I.defaultRowHeight=r,I.defaultHeaderRowHeight=null!=o?o:r,I.defaultColWidth=n,I.defaultHeaderColWidth=null!=a?a:n,I.keyboardOptions=l,I.eventOptions=s,I.rowSeriesNumber=h,I.columnResizeMode=null!=(b=null==c?void 0:c.columnResizeMode)?b:d,I.rowResizeMode=null!=(f=null==c?void 0:c.rowResizeMode)?f:u,I.dragHeaderMode=null!=(v=null!=(m=null==p?void 0:p.dragHeaderMode)?m:g)?v:\\\"none\\\",I.renderChartAsync=T,setBatchRenderChartCount(A),I.overscrollBehavior=null!=M?M:\\\"auto\\\",I.cellTextOverflows={},I._rowHeightsMap=new NumberRangeMap(this),I._rowRangeHeightsMap=new Map,I._colRangeWidthsMap=new Map,I._widthResizedColMap=new Set,I._heightResizedRowMap=new Set,this.colWidthsMap=new NumberMap,this.colContentWidthsMap=new NumberMap,this.colWidthsLimit={},I.stick.changedCells.clear(),I.theme=themes_default.of(null!=(y=t.theme)?y:themes_default.DEFAULT),I.theme.isPivot=this.isPivotTable(),setIconColor(I.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),I.autoWrapText=t.autoWrapText,I.enableLineBreak=t.enableLineBreak,I.allowFrozenColCount=null!=(S=t.allowFrozenColCount)?S:0,I.limitMaxAutoWidth=null!=(x=t.limitMaxAutoWidth)?x:450,I.limitMinWidth=null!=E?\\\"number\\\"==typeof E?E:E?10:0:10,I.limitMinHeight=null!=H?\\\"number\\\"==typeof H?H:H?10:0:10,null!=(w=I.legends)&&w.forEach(e=>{null!=e&&e.release()}),null!=(_=I.title)&&_.release(),(I.title=null)!=(R=I.emptyTip)&&R.release(),I.emptyTip=null,I.layoutMap.release(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){I.legends=[];var L=Factory2.getFunction(\\\"createLegend\\\");if(Array.isArray(t.legends))for(let e=0;e<t.legends.length;e++)I.legends.push(L(t.legends[e],this));else I.legends.push(L(t.legends,this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}I.tooltip=Object.assign({parentElement:this.getElement(),renderMode:\\\"html\\\",isShowOverflowTextTooltip:!1,confine:!0,position:Placement.bottom},t.tooltip),\\\"html\\\"!==I.tooltip.renderMode||I.tooltipHandler||(P=Factory2.getComponent(\\\"tooltipHandler\\\"),I.tooltipHandler=new P(this,I.tooltip.confine)),I.menu=Object.assign({renderMode:\\\"html\\\"},t.menu),Array.isArray(null==(B=t.menu)?void 0:B.dropDownMenuHighlight)&&this.setDropDownMenuHighlight(null==(C=t.menu)?void 0:C.dropDownMenuHighlight),!Array.isArray(null==(e=t.menu)?void 0:e.defaultHeaderMenuItems)&&\\\"function\\\"!=typeof(null==(i=t.menu)?void 0:i.defaultHeaderMenuItems)||(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),\\\"html\\\"!==I.menu.renderMode||I.menuHandler||(o=Factory2.getComponent(\\\"menuHandler\\\"),I.menuHandler=new o(this)),this.clearCellStyleCache(),this.clearColWidthCache(),this.clearRowHeightCache(),I.customMergeCell=getCustomMergeCellFunc(t.customMergeCell),null!=(r=this.customCellStylePlugin)&&r.updateCustomCell(null!=(a=t.customCellStyle)?a:[],null!=(n=t.customCellStyleArrangement)?n:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();var e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(0<this.bottomFrozenRowCount){let e=0;for(let t=this.rowCount-this.bottomFrozenRowCount;t<=this.rowCount-1;t++)e+=this.getRowHeight(t);return e}return 0}getRightFrozenColsWidth(){if(0<this.rightFrozenColCount){let e=0;for(let t=this.colCount-this.rightFrozenColCount;t<=this.colCount-1;t++)e+=this.getColWidth(t);return e}return 0}getDrawRange(){var e=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),t=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new Rect2(this.tableX,this.tableY,e,t)}_getMouseAbstractPoint(e,t=!0){if(!e)return{inTable:!1,x:void 0,y:void 0};var i=(r=isTouchEvent3(e)?e.changedTouches[0]:e).clientX||r.pageX+window.scrollX,r=r.clientY||r.pageY+window.scrollY,o=this.internalProps.canvas.getBoundingClientRect();let n=!0;o.right<=i&&(n=!1),o.bottom<=r&&(n=!1);var a=o.width,a=a/(this.canvas.offsetWidth||a),l=o.height,l=l/(this.canvas.offsetHeight||l),r={x:(i-o.left)/a+(t?this.scrollLeft:0)-(null!=(a=null==(i=this.options.viewBox)?void 0:i.x1)?a:0),y:(r-o.top)/l+(t?this.scrollTop:0)-(null!=(a=null==(i=this.options.viewBox)?void 0:i.y1)?a:0),inTable:n};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(r,r),r}getTheme(){return this.internalProps.theme}getTargetColAt(e){return getTargetColAt(e,this)}getTargetRowAt(e){var t=getTargetRowAt(e,this);return t&&(t.row=Math.min(t.row,this.rowCount-1)),t}getTargetColAtConsiderRightFrozen(e,t){return getTargetColAtConsiderRightFrozen(e,t,this)}getTargetRowAtConsiderBottomFrozen(e,t){return getTargetRowAtConsiderBottomFrozen(e,t,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(e,t,i,r,o,n=!1){var a,l=!(null==(l=this.stateManager.select.ranges)||!l.length);this.stateManager.updateSelectPos(e,t,i,r,!1,null==(a=null!=o?o:null==(a=this.options.select)?void 0:a.makeSelectCellVisible)||a,n),this.stateManager.endSelectCells(!0,l)}selectCells(e){var{scrollLeft:t,scrollTop:i}=this;e.forEach((e,t)=>{var i;e.start.col===e.end.col&&e.start.row===e.end.row?this.stateManager.updateSelectPos(e.start.col,e.start.row,!1,1<=t,!1,null==(i=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||i,!0):(this.stateManager.updateSelectPos(e.start.col,e.start.row,!1,1<=t,!1,null==(i=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||i,!0),this.stateManager.updateInteractionState(InteractionState.grabing),this.stateManager.updateSelectPos(e.end.col,e.end.row,!1,1<=t,!1,null==(i=null==(i=this.options.select)?void 0:i.makeSelectCellVisible)||i,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(InteractionState[\\\"default\\\"])}),this.setScrollTop(i),this.setScrollLeft(t)}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(e){this.scenegraph.clearCells(),_setDataSource(this,e),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(e){this.internalProps.autoWrapText=e,this.options.autoWrapText=e}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(e){this.internalProps.enableLineBreak=e,this.options.enableLineBreak=e}updateAutoWrapText(e){this.internalProps.autoWrapText!==e&&(this.internalProps.autoWrapText=e,this.options.autoWrapText=e,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(e){this.internalProps.theme=themes_default.of(null!=e?e:themes_default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=e,setIconColor(this.internalProps.theme.functionalIconsStyle)}updateTheme(e){var t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=themes_default.of(null!=e?e:themes_default.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),setIconColor(this.internalProps.theme.functionalIconsStyle),this.options.theme=e,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getBodyField(e,t){return this.internalProps.layoutMap.getBody(e,t).field}getBodyColumnDefine(e,t){var i=this.internalProps.layoutMap.getBody(e,t);return null==i?void 0:i.define}getBodyColumnType(e,t){var i;return getProp2(\\\"cellType\\\",{cellType:null!=(i=null==(i=this.internalProps.layoutMap.getBody(e,t))?void 0:i.cellType)?i:\\\"text\\\"},e,t,this)}getCellType(e,t){return this.isSeriesNumberInHeader(e,t)?this.internalProps.layoutMap.getSeriesNumberHeader(e,t).cellType:getProp2(\\\"cellType\\\",{cellType:this.isHeader(e,t)?this.internalProps.layoutMap.getHeader(e,t).headerType:this.internalProps.layoutMap.getBody(e,t).cellType},e,t,this)}getHeaderField(e,t){return this.internalProps.layoutMap.getHeaderField(e,t)}getHeaderDefine(e,t){var i=this.internalProps.layoutMap.getHeader(e,t);return null==i?void 0:i.define}getCellLocation(e,t){return this.internalProps.layoutMap.getCellLocation(e,t)}getCellHeaderPaths(e,t){return this.internalProps.layoutMap.getCellHeaderPaths(e,t)}getHeadersDefine(e,t){for(var i=[];;){var r=this.getHeaderDefine(e,t);if(!r||!r.field&&!r.columns)break;i.push(r),t++}return i}_getHeaderLayoutMap(e,t){return this.internalProps.layoutMap.getHeader(e,t)}_getBodyLayoutMap(e,t){return this.internalProps.layoutMap.getBody(e,t)}getContext(){return this.internalProps.context}getRecordByCell(e,t){if(!this.internalProps.layoutMap.isHeader(e,t))return this.getCellOriginRecord(e,t)}getRecordByRowCol(e,t){return this.getRecordByCell(e,t)}getRecordStartRowByRecordIndex(e){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(e)}_getHeaderCellBySortState(t){var e=this.internalProps.layoutMap,i=e.headerObjects.find(e=>e&&e.field===t.field);if(i)return e.getHeaderCellAdressById(i.id)}getCellRange(e,t){if(this.internalProps.customMergeCell){var i=this.internalProps.customMergeCell(e,t,this);if(i&&i.range&&(isValid_default(i.text)||i.customLayout||i.customRender))return{start:{col:Math.max(i.range.start.col,0),row:Math.max(i.range.start.row,0)},end:{col:Math.min(i.range.end.col,this.colCount-1),row:Math.min(i.range.end.row,this.rowCount-1)}}}return null==(i=this.internalProps.layoutMap)?void 0:i.getCellRange(e,t)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(e,t){if(this.internalProps.customMergeCell){var i,r=this.internalProps.customMergeCell(e,t,this);if(r&&r.range&&(isValid_default(r.text)||r.customLayout||this.customRender))return r.style&&(i=this.internalProps.bodyHelper.getStyleClass(\\\"text\\\"),i=of(r.style,this.theme.bodyStyle,{col:e,row:t,table:this,value:r.text,dataValue:this.getCellOriginValue(e,t),cellHeaderPaths:this.getCellHeaderPaths(e,t)},i,this.options.autoWrapText,this.theme),r.style=i),r}}isCellRangeEqual(e,t,i,r){return this.internalProps.layoutMap.isCellRangeEqual(e,t,i,r)}_getLayoutCellId(e,t){return this.internalProps.layoutMap.getCellId(e,t)}getHeaderDescription(e,t){var i=this._getHeaderLayoutMap(e,t),r=null==i?void 0:i.define,r=null!=(r=null==r?void 0:r.description)?r:null==i?void 0:i.description;return\\\"function\\\"==typeof r?r({col:e,row:t,value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t)}):r}setDropDownMenuHighlight(e){this.stateManager.setDropDownMenuHighlight(e)}_dropDownMenuIsHighlight(e,t,i){return this.stateManager.dropDownMenuIsHighlight(e,t,i)}isSeriesNumberInBody(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(e,t)}isSeriesNumberInHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)}isHeader(e,t){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(e,t)}isColumnHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isColumnHeader(e,t)}isRowHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRowHeader(e,t)}isCornerHeader(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isCornerHeader(e,t)}isFrozenColumn(e,t){return this.isLeftFrozenColumn(e,t)||this.isRightFrozenColumn(e,t)}isLeftFrozenColumn(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenColumn(e,t)}isRightFrozenColumn(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isRightFrozenColumn(e,t)}isFrozenRow(e,t){return this.isTopFrozenRow(e,t)||this.isBottomFrozenRow(e,t)}isTopFrozenRow(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isFrozenRow(e,t)}isBottomFrozenRow(e,t){var i;return null==(i=this.internalProps.layoutMap)?void 0:i.isBottomFrozenRow(e,t)}getCellInfo(e,t){var i;if(0<=e&&0<=t)return i=this.isHeader(e,t)?this.getHeaderDefine(e,t):this.getBodyColumnDefine(e,t),{col:e,row:t,field:this.getHeaderField(e,t),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(e,t),title:null==i?void 0:i.title,cellType:this.getCellType(e,t),originData:this.getCellOriginRecord(e,t),cellRange:this.getCellRangeRelativeRect({col:e,row:t}),value:this.getCellValue(e,t),dataValue:this.getCellOriginValue(e,t),cellLocation:this.getCellLocation(e,t),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}_hasField(e,t,i){var r,o;return null!==e&&!this.internalProps.layoutMap.isHeader(t,i)&&(o=this.getRecordShowIndexByCell(t,i),null==(r=this.internalProps.dataSource)?void 0:r.hasField(o,e))}_getCellStyle(e,t){return getCellStyle(e,t,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(e,t){if(!(0<=e&&0<=t))return!1;if(this.isCellRangeEqual(e,t,e+1,t))return!1;if(\\\"none\\\"===this.internalProps.columnResizeMode)return!1;if(\\\"header\\\"===this.internalProps.columnResizeMode){if(!this.isHeader(e,t))return!1}else if(\\\"body\\\"===this.internalProps.columnResizeMode&&this.isHeader(e,t))return!1;var i=this.colWidthsLimit[e];return!(i&&i.min&&i.max)||i.max!==i.min}_canResizeRow(e,t){if(!(0<=e&&0<=t))return!1;if(this.isCellRangeEqual(e,t,e,t+1))return!1;if(\\\"none\\\"===this.internalProps.rowResizeMode)return!1;if(\\\"header\\\"===this.internalProps.rowResizeMode){if(!this.isHeader(e,t))return!1}else if(\\\"body\\\"===this.internalProps.rowResizeMode&&this.isHeader(e,t))return!1;return!0}_canDragHeaderPosition(e,t){if(this.isHeader(e,t)&&(this.stateManager.isSelected(e,t)||\\\"body\\\"===(null==(i=this.options.select)?void 0:i.headerSelectMode)&&checkCellInSelect(e,t,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||isCellDisableSelect(this,e,t))&&(\\\"disabled\\\"!==this.internalProps.frozenColDragHeaderMode||!this.isFrozenColumn(e))){if(this.stateManager.isSelected(e,t)){var i=this.stateManager.select.ranges[0];if(this.isColumnHeader(e,t)){if(i.end.row!==this.rowCount-1)return!1}else{if(!this.isRowHeader(e,t))return!1;if(i.end.col!==this.colCount-1)return!1}}i=this.getHeaderDefine(e,t);if(i){if(void 0!==i.dragHeader)return i.dragHeader;if(\\\"all\\\"===this.internalProps.dragHeaderMode)return!0;if(\\\"column\\\"===this.internalProps.dragHeaderMode){if(this.isColumnHeader(e,t))return!0}else if(\\\"row\\\"===this.internalProps.dragHeaderMode&&this.isRowHeader(e,t))return!0}}return!1}getCellIcons(e,t){let i,r,o,n;var a,l,s;return this.isHeader(e,t)?n=this.internalProps.headerHelper.getIcons(e,t):this.internalProps.layoutMap.isSeriesNumber(e,t)?(this.options.groupBy&&null!=(i=this.getCellRawRecord(e,t))&&i.vtableMerge||null!=(o=null==(r=this.internalProps.layoutMap.getSeriesNumberBody(e,t))?void 0:r.define)&&o.dragOrder&&(n=this.internalProps.rowSeriesNumberHelper.getIcons(e,t)),s=this.getCellValue(e,t),a=this.getCellOriginValue(e,t),l=this.internalProps.context,s=this.internalProps.bodyHelper.getIcons(e,t,s,a,l),0<(null==n?void 0:n.length)?n=n.concat(s):0<(null==s?void 0:s.length)&&(n=s)):(a=this.getCellValue(e,t),l=this.getCellOriginValue(e,t),s=this.internalProps.context,n=this.internalProps.bodyHelper.getIcons(e,t,a,l,s)),n}showDropDownMenu(e,t,i){let r=\\\"dropdown-menu\\\";i&&(r=Array.isArray(i.content)?\\\"dropdown-menu\\\":\\\"container\\\"),\\\"html\\\"===this.internalProps.menu.renderMode&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(e,t,r,i))}showTooltip(e,t,i){\\\"html\\\"===this.internalProps.tooltip.renderMode&&this.internalProps.tooltipHandler._bindToCell(e,t,i)}getCellStyle(e,t){var i=this._getCellStyle(e,t),r=getStyleTheme(i,this,e,t,getProp2).theme,{autoWrapText:o,lineClamp:n,textOverflow:a}=i;return{textAlign:r.text.textAlign,textBaseline:r.text.textBaseline,bgColor:isBoolean_default(r.group.fill)?getProp2(\\\"bgColor\\\",i,e,t,this):r.group.fill,color:isBoolean_default(r.text.fill)?getProp2(\\\"color\\\",i,e,t,this):r.text.fill,strokeColor:isBoolean_default(r.text.stroke)?getProp2(\\\"strokeColor\\\",i,e,t,this):r.text.stroke,fontFamily:r.text.fontFamily,fontSize:r.text.fontSize,fontWeight:r.text.fontWeight,fontVariant:r.text.fontVariant,fontStyle:r.text.fontStyle,lineHeight:r.text.lineHeight,autoWrapText:null!=o&&o,lineClamp:null!=n?n:\\\"auto\\\",textOverflow:a,borderColor:isBoolean_default(r.group.stroke)?getProp2(\\\"borderColor\\\",i,e,t,this):r.group.stroke,borderLineWidth:r.group.lineWidth,borderLineDash:r.group.lineDash,underline:!!r.text.underline,underlineDash:r.text.underlineDash,underlineOffset:r.text.underlineOffset,lineThrough:!!r.text.lineThrough,padding:r._vtable.padding,underlineWidth:r.text.underline,lineThroughLineWidth:r.text.lineThrough,_strokeArrayWidth:r.group.strokeArrayWidth,_strokeArrayColor:r.group.strokeArrayColor,_linkColor:getProp2(\\\"linkColor\\\",i,e,t,this)}}getAllBodyCells(t,e){const r=this.rowHeaderLevelCount,o=this.columnHeaderLevelCount,n=this.colCount-1,i=this.rowCount-1;return Array(Math.min(null!=e?e:2e3,i-o+1,this.rowCount)).fill(0).map((e,i)=>Array(Math.min(null!=t?t:2e3,n-r+1,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+r,i+o)))}getAllCells(t,e){const r=this.colCount-1,i=this.rowCount-1;return Array(Math.min(null!=e?e:2e3,1+i,this.rowCount)).fill(0).map((e,i)=>Array(Math.min(null!=t?t:2e3,1+r,this.colCount)).fill(0).map((e,t)=>this.getCellInfo(t+0,i+0)))}getAllColumnHeaderCells(){const r=this.rowHeaderLevelCount,t=this.colCount-1,e=this.columnHeaderLevelCount-1;return Array(1+e).fill(0).map((e,i)=>Array(t-r+1).fill(0).map((e,t)=>this.getCellInfo(t+r,i+0)))}getAllRowHeaderCells(){const r=this.columnHeaderLevelCount,t=this.rowHeaderLevelCount-1,e=this.rowCount-1;return Array(e-r+1).fill(0).map((e,i)=>Array(1+t).fill(0).map((e,t)=>this.getCellInfo(t+0,i+r)))}getCopyValue(){var e;if(0<(null==(e=null==(e=this.stateManager.select)?void 0:e.ranges)?void 0:e.length)){const d=this.stateManager.select.ranges;let t=Math.min(d[0].start.col,d[0].end.col),i=Math.max(d[0].start.col,d[0].end.col),r=Math.min(d[0].start.row,d[0].end.row),o=Math.max(d[0].start.row,d[0].end.row);d.forEach(e=>{t=Math.min(t,e.start.col,e.end.col),i=Math.max(i,e.start.col,e.end.col),r=Math.min(r,e.start.row,e.end.row),o=Math.max(o,e.start.row,e.end.row)});var l,s,h=(e,t,i)=>{var r,o,n=this.getCellRange(e,t);let a=n.start.col,l=n.start.row;return i&&(r=Math.min(i.start.col,i.end.col),o=Math.min(i.start.row,i.end.row),a=Math.max(r,n.start.col),l=Math.max(o,n.start.row)),a!==e||l!==t?\\\"\\\":this.getCellValue(e,t)};let n=\\\"\\\";for(let a=r;a<=o;a++)if((r=>{let o=!1;return d.forEach(e=>{var t=Math.min(e.start.row,e.end.row),i=Math.max(e.start.row,e.end.row);t<=r&&r<=i&&(o=!0)}),o})(a)){for(let e=t;e<=i;e++)(r=>{let o=!1;return d.forEach(e=>{var t=Math.min(e.start.col,e.end.col),i=Math.max(e.start.col,e.end.col);t<=r&&r<=i&&(o=!0)}),o})(e)&&(!(l=((n,a)=>{let l;return d.forEach(e=>{var t=Math.min(e.start.row,e.end.row),i=Math.max(e.start.row,e.end.row),r=Math.min(e.start.col,e.end.col),o=Math.max(e.start.col,e.end.col);r<=n&&n<=o&&t<=a&&a<=i&&(l=e)}),l})(e,a))||(s=h(e,a,l),\\\"undefined\\\"!=typeof Promise&&s instanceof Promise||(s=isValid_default(s)?\\\"\\\"+s:\\\"\\\",/^\\\\[object .*\\\\]$/.exec(s))||(n+=s),e<l.end.col)||e<i)&&(n+=\\\"\\\\t\\\");a<o&&(n+=\\\"\\\\r\\\\n\\\")}return n=null!=(e=this.options)&&e.formatCopyValue?this.options.formatCopyValue(n):n}return\\\"\\\"}getSelectedCellInfos(){var e;if(null==(e=this.stateManager.select)||!e.ranges)return null;const t=this.stateManager.select.ranges;if(!t.length)return[];let i=Math.min(t[0].start.col,t[0].end.col),r=Math.max(t[0].start.col,t[0].end.col),o=Math.min(t[0].start.row,t[0].end.row),n=Math.max(t[0].start.row,t[0].end.row);t.forEach(e=>{i=Math.min(i,e.start.col,e.end.col),r=Math.max(r,e.start.col,e.end.col),o=Math.min(o,e.start.row,e.end.row),n=Math.max(n,e.start.row,e.end.row)});var a=[];for(let h=o;h<=n;h++)if((r=>{let o=!1;return t.forEach(e=>{var t=Math.min(e.start.row,e.end.row),i=Math.max(e.start.row,e.end.row);t<=r&&r<=i&&(o=!0)}),o})(h)){var l,s=[];for(let e=i;e<=r;e++)(r=>{let o=!1;return t.forEach(e=>{var t=Math.min(e.start.col,e.end.col),i=Math.max(e.start.col,e.end.col);t<=r&&r<=i&&(o=!0)}),o})(e)&&((n,a)=>{let l;return t.forEach(e=>{var t=Math.min(e.start.row,e.end.row),i=Math.max(e.start.row,e.end.row),r=Math.min(e.start.col,e.end.col),o=Math.max(e.start.col,e.end.col);r<=n&&n<=o&&t<=a&&a<=i&&(l=e)}),l})(e,h)&&(l=this.getCellInfo(e,h),s.push(l));a.push(s)}return a}getSelectedCellRanges(){var e=this.stateManager.select.ranges;return e.length?cloneDeep(e):[]}measureText(e,t){return textMeasure.measureText(e,t)}measureTextBounds(e){return measureTextBounds(e)}getCustomRender(e,t){let i;var r;return i=\\\"body\\\"!==this.getCellLocation(e,t)?null==(r=this.getHeaderDefine(e,t))?void 0:r.headerCustomRender:(null==(r=this.getBodyColumnDefine(e,t))?void 0:r.customRender)||this.customRender}getCustomLayout(e,t){let i;var r;return i=\\\"body\\\"!==this.getCellLocation(e,t)?null==(r=this.getHeaderDefine(e,t))?void 0:r.headerCustomLayout:null==(r=this.getBodyColumnDefine(e,t))?void 0:r.customLayout}hasAutoImageColumn(){return void 0===this._hasAutoImageColumn&&(this._hasAutoImageColumn=hasAutoImageColumn(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var e,t=this.scenegraph.getCell(null==(t=null==(t=this.stateManager.hover)?void 0:t.cellPos)?void 0:t.col,null==(t=null==(t=this.stateManager.hover)?void 0:t.cellPos)?void 0:t.row);return\\\"chart\\\"===(null==(e=null==(e=null==t?void 0:t.getChildren())?void 0:e[0])?void 0:e.type)?t.getChildren()[0].activeChartInstance:null}cellIsInVisualView(e,t){var i=this.getDrawRange(),r=this.getCellRelativeRect(e,t);if(e<this.frozenColCount&&t<this.frozenRowCount)return!0;let o,n,a,l;if(1<=this.frozenRowCount&&(o=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),1<=this.frozenColCount&&(n=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),1<=this.bottomFrozenRowCount&&(a=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),1<=this.rightFrozenColCount&&(l=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),r.top>=i.top&&r.bottom<=i.bottom&&r.left>=i.left&&r.right<=i.right){if(this.isFrozenCell(e,t))return!0;if(r.top>=(null!=(i=null==o?void 0:o.bottom)?i:r.top)&&r.left>=(null!=(i=null==n?void 0:n.right)?i:r.left)&&r.bottom<=(null!=(i=null==a?void 0:a.top)?i:r.bottom)&&r.right<=(null!=(i=null==l?void 0:l.left)?i:r.right))return!0}return!1}getCustomMergeValue(e,t){if(this.internalProps.customMergeCell){var i=this.getCustomMerge(e,t);if(i)return i=i.text,i}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(e,t,i){var r=this.cellIsInVisualView(e,t),{scrollTop:o,scrollLeft:n}=this,a=(r||this.scrollToCell({col:e,row:t}),this.getCellRelativeRect(e,t)),{col:l,row:s}=(0<(null==(l=null==(l=this.stateManager.select)?void 0:l.ranges)?void 0:l.length)&&hideCellSelectBorder(this.scenegraph),this.stateManager.hover.cellPos);let h,d,u=(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute(\\\"visible\\\",!1),null!=i&&i.disableBackground&&(c=this.scenegraph.getCell(e,t),h=c.attribute.fill,c.setAttribute(\\\"fill\\\",\\\"transparent\\\")),null!=i&&i.disableBorder&&(c=this.scenegraph.getCell(e,t),d=c.attribute.stroke,c.setAttribute(\\\"stroke\\\",!1)),this.scenegraph.renderSceneGraph(),0);\\\"bottom-right\\\"===this.theme.cellBorderClipDirection&&(u=1);var c=this.scenegraph.stage.toCanvas(!1,(new AABBBounds).set(a.left+this.tableX+1,a.top+this.tableY+1,a.right+this.tableX-u,a.bottom+this.tableY-u));return r||(this.setScrollTop(o),this.setScrollLeft(n)),this.scenegraph.tableGroup.border.setAttribute(\\\"visible\\\",!0),h&&this.scenegraph.getCell(e,t).setAttribute(\\\"fill\\\",h),d&&this.scenegraph.getCell(e,t).setAttribute(\\\"stroke\\\",d),0<(null==(r=null==(a=this.stateManager.select)?void 0:a.ranges)?void 0:r.length)&&restoreCellSelectBorder(this.scenegraph),this.stateManager.updateHoverPos(l,s),this.scenegraph.updateNextFrame(),c.toDataURL()}exportCellRangeImg(e){var{scrollTop:t,scrollLeft:i}=this,r=Math.min(e.start.col,e.end.col),o=Math.min(e.start.row,e.end.row),n=Math.max(e.start.col,e.end.col),a=Math.max(e.start.row,e.end.row),l=this.cellIsInVisualView(r,o),s=this.cellIsInVisualView(n,a),r=(l&&s||this.scrollToCell({col:r,row:o}),this.getCellRangeRelativeRect({start:{col:r,row:o},end:{col:n,row:a}})),{col:a,row:o}=(0<(null==(n=null==(o=this.stateManager.select)?void 0:o.ranges)?void 0:n.length)&&hideCellSelectBorder(this.scenegraph),this.stateManager.hover.cellPos),n=(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph(),this.scenegraph.stage.toCanvas(!1,(new AABBBounds).set(r.left+this.tableX+1,r.top+this.tableY+1,r.right+this.tableX,r.bottom+this.tableY)).toDataURL());return l&&s||(this.setScrollTop(t),this.setScrollLeft(i)),0<(null==(l=null==(r=this.stateManager.select)?void 0:r.ranges)?void 0:l.length)&&restoreCellSelectBorder(this.scenegraph),this.stateManager.updateHoverPos(a,o),n}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(e=\\\"image/png\\\"){var t,i,r;if(\\\"node\\\"===this.options.mode)return this.render(),(t=this.scenegraph.stage)?(i=this.tableX+this.getAllColsWidth(),r=this.tableY+this.getAllRowsHeight(),i>=this.canvasWidth&&r>=this.canvasHeight?(t.render(),t.window.getImageBuffer(e)):this.scenegraph.stage.toCanvas(!1,(new AABBBounds).set(0,0,Math.min(this.canvasWidth,i),Math.min(this.canvasHeight,r))).toBuffer(e)):null}getBodyIndexByTableIndex(e,t){return{col:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberCount,row:t-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(e,t){return{col:e+this.rowHeaderLevelCount+this.leftRowSeriesNumberCount,row:t+this.columnHeaderLevelCount}}onVChartEvent(e,t,i){this._chartEventMap[e]||(this._chartEventMap[e]=[]),\\\"function\\\"==typeof t?this._chartEventMap[e].push({callback:t}):this._chartEventMap[e].push({callback:i,query:t})}offVChartEvent(e,t){this._chartEventMap[e]&&(this._chartEventMap[e]=t?this._chartEventMap[e].filter(e=>e.callback!==t):[])}_bindChartEvent(t){if(t)for(const i in this._chartEventMap)(this._chartEventMap[i]||[]).forEach(e=>{e.query?t.on(i,e.query,e.callback):t.on(i,e.callback)})}changeRecordOrder(e,t){}hasCustomCellStyle(e){var t;return null==(t=this.customCellStylePlugin)?void 0:t.hasCustomCellStyle(e)}registerCustomCellStyle(e,t){var i;null!=(i=this.customCellStylePlugin)&&i.registerCustomCellStyle(e,t)}arrangeCustomCellStyle(e,t,i){var r;null!=(r=this.customCellStylePlugin)&&r.arrangeCustomCellStyle(e,t,i)}isSeriesNumber(e,t){return this.internalProps.layoutMap.isSeriesNumber(e,t)}isHasSeriesNumber(){var e;return 0<(null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)}get leftRowSeriesNumberCount(){var e;return null!=(e=null==(e=this.internalProps.layoutMap)?void 0:e.leftRowSeriesNumberColumnCount)?e:0}setMinMaxLimitWidth(e=!1){var t,i,r,o=this.internalProps;for(let n=0;n<o.layoutMap.columnWidths.length;n++)this.internalProps._widthResizedColMap.has(n)||(({width:t,minWidth:i,maxWidth:r}=null!=(t=null==(t=o.layoutMap.columnWidths)?void 0:t[n])?t:{}),e&&t&&(\\\"string\\\"==typeof t&&\\\"auto\\\"!==t||\\\"number\\\"==typeof t&&0<t)&&this._setColWidth(n,t),i&&(\\\"number\\\"==typeof i&&0<i||\\\"string\\\"==typeof i)&&this.setMinColWidth(n,i),r&&(\\\"number\\\"==typeof r&&0<r||\\\"string\\\"==typeof r)&&this.setMaxColWidth(n,r))}setSortedIndexMap(e,t){var i;null!=(i=this.dataSource)&&i.setSortedIndexMap(e,t)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new ReactCustomLayout(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(e,t){this.scenegraph.component.showMoveCol(e,t,0),this.scenegraph.renderSceneGraph()}hideMoverLine(e,t){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(e,t){}scrollToRow(e,t){t?this.animationManager.scrollTo({row:e},t):this.scrollToCell({row:e})}scrollToCol(e,t){t?this.animationManager.scrollTo({col:e},t):this.scrollToCell({col:e})}scrollToCell(e,t){var i,r,o;t?this.animationManager.scrollTo(e,t):(i=this.getDrawRange(),isValid_default(e.col)&&e.col>=this.frozenColCount&&(o=this.getFrozenColsWidth(),r=this.getColsWidth(0,e.col-1),this.scrollLeft=Math.min(r-o,this.getAllColsWidth()-i.width)),isValid_default(e.row)&&e.row>=this.frozenRowCount&&(r=this.getFrozenRowsHeight(),o=this.getRowsHeight(0,e.row-1),this.scrollTop=Math.min(o-r,this.getAllRowsHeight()-i.height)),this.render())}checkHasColumnAutoWidth(){return checkHasColumnAutoWidth(this)}}),register_exports={},chartTypes=(__export(register_exports,{aggregator:()=>aggregator,chartModule:()=>chartModule,clearAll:()=>clearAll,editor:()=>editor,icon:()=>icon,theme:()=>theme3}),init_esbuild_inject(),init_esbuild_inject(),{}),editors=(init_esbuild_inject(),{});function get4(e){if(editors[e])return editors[e]}function register(e,t,i){var r=e[t];return e[t]=i,r}function theme3(e,t){return null!=t?register(themes,e,t):themes[e]}function icon(e,t){return null!=t?register(icons,e,t):icons[e]}function chartModule(e,t){return null!=t?register(chartTypes,e,t):chartTypes[e]}function editor(e,t){return null!=t?register(editors,e,t):editors[e]}function aggregator(e,t){null!=t&&register(registeredAggregators,e,t)}function clear(e){for(const t in e)delete e[t]}function clearAll(){clear(themes),clear(icons),clear(chartTypes),clear(editors),clear(registeredAggregators)}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var import_eventemitter32=__toESM(require_eventemitter3()),isType2=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),(e,t)=>Object.prototype.toString.call(e)===`[object ${t}]`),isType_default2=isType2,isBoolean3=(e,t=!1)=>t?\\\"boolean\\\"==typeof e:!0===e||!1===e||isType_default2(e,\\\"Boolean\\\"),isBoolean_default2=isBoolean3,isNil2=(init_esbuild_inject(),e=>null==e),isNil_default2=isNil2,isValid2=(init_esbuild_inject(),e=>null!=e),isValid_default2=isValid2,isObjectLike2=(init_esbuild_inject(),e=>\\\"object\\\"==typeof e&&null!==e),isObjectLike_default2=isObjectLike2,isPlainObject2=(init_esbuild_inject(),function(e){if(!isObjectLike_default2(e)||!isType_default2(e,\\\"Object\\\"))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}),isPlainObject_default2=isPlainObject2,isString3=(init_esbuild_inject(),(e,t=!1)=>{var i=typeof e;return t?\\\"string\\\"==i:\\\"string\\\"==i||isType_default2(e,\\\"String\\\")}),isString_default2=isString3,isArray2=(init_esbuild_inject(),e=>Array.isArray?Array.isArray(e):isType_default2(e,\\\"Array\\\")),isArray_default2=isArray2,isArrayLike2=(init_esbuild_inject(),function(e){return null!==e&&\\\"function\\\"!=typeof e&&Number.isFinite(e.length)}),isArrayLike_default2=isArrayLike2,isDate2=(init_esbuild_inject(),e=>isType_default2(e,\\\"Date\\\")),isDate_default2=isDate2,isNumber3=(init_esbuild_inject(),(e,t=!1)=>{var i=typeof e;return t?\\\"number\\\"==i:\\\"number\\\"==i||isType_default2(e,\\\"Number\\\")}),isNumber_default2=isNumber3;function cloneDeep2(e,t,i){if(!isValid_default2(e)||\\\"object\\\"!=typeof e||t&&t(e))return e;var r=isArray_default2(e),o=e.length,n=r?new Array(o):\\\"object\\\"==typeof e?{}:isBoolean_default2(e)||isNumber_default2(e)||isString_default2(e)?e:isDate_default2(e)?new Date(+e):void 0,a=r?void 0:Object.keys(Object(e));let l=-1;if(n)for(;++l<(a||e).length;){var s=a?a[l]:l,h=e[s];i&&i.includes(s.toString())?n[s]=h:n[s]=cloneDeep2(h,t,i)}return n}function baseMerge2(i,r,o=!1,n=!1){if(r&&i!==r&&isValid_default2(r)&&\\\"object\\\"==typeof r){var a=Object(r),l=[];for(const h in a)l.push(h);let e=l.length,t=-1;for(;e--;){var s=l[++t];!isValid_default2(a[s])||\\\"object\\\"!=typeof a[s]||n&&isArray_default2(i[s])?assignMergeValue2(i,s,a[s]):baseMergeDeep2(i,r,s,o,n)}}}function baseMergeDeep2(e,t,i,r=!1,o=!1){var n=e[i],a=t[i];let l=t[i],s=!0;if(isArray_default2(a)){if(r)l=[];else if(isArray_default2(n))l=n;else if(isArrayLike_default2(n)){l=new Array(n.length);let e=-1;for(var h=n.length;++e<h;)l[e]=n[e]}}else isPlainObject_default2(a)?l=\\\"function\\\"!=typeof n&&\\\"object\\\"==typeof n&&null!=n?n:{}:s=!1;s&&baseMerge2(l,a,r,o),assignMergeValue2(e,i,l)}function assignMergeValue2(e,t,i){(void 0===i||eq2(e[t],i))&&(void 0!==i||t in e)||(e[t]=i)}function eq2(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function merge2(e,...t){let i=-1;for(var r=t.length;++i<r;)baseMerge2(e,t[i],!0);return e}function isHTMLElement(e){try{return e instanceof Element}catch(t){const i=[\\\"children\\\",\\\"innerHTML\\\",\\\"classList\\\",\\\"setAttribute\\\",\\\"tagName\\\",\\\"getBoundingClientRect\\\"],r=Object.keys(e);return i.every(e=>r.includes(e))}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var fields=(t,e)=>{var i;if(null!=e&&e.fields&&0!==t.length){const r=e.fields,o=t[0],n={},a=[];for(const l in r)if(Object.prototype.hasOwnProperty.call(r,l)){const s=r[l];if(!s.type){let e=o;l in o||(e=null!=(i=t.find(e=>l in e))?i:o),s.type=\\\"number\\\"==typeof e[l]?\\\"linear\\\":\\\"ordinal\\\"}let e;if(\\\"number\\\"==typeof s.sortIndex&&(e={key:l,type:s.type,index:s.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:!0===s.sortReverse},a.push(e)),0<(null==(i=s.domain)?void 0:i.length))if(\\\"ordinal\\\"===s.type){s._domainCache={},n[l]=s;const h={};s.domain.forEach((e,t)=>{h[e]=t,s._domainCache[e]=t}),e&&(e.sortIndex=h,e.sortIndexCount=s.domain.length)}else 2<=s.domain.length&&(n[l]=s)}0<Object.keys(n).length&&(t=t.filter(e=>{for(const i in n){var t=n[i];if(\\\"ordinal\\\"===t.type){if(!(e[i]in t._domainCache))return!1}else if(t.domain[0]>e[i]||t.domain[1]<e[i])return!1}return!0})),a.sort((e,t)=>e.index-t.index),t.sort((e,t)=>sortData(e,t,a))}return t};function sortData(t,i,r){for(let n=0;n<r.length;n++){var o=r[n];let e=0;if(\\\"ordinal\\\"===o.type?(void 0===o.sortIndex[i[o.key]]&&(o.sortIndex[i[o.key]]=o.sortIndexCount++),void 0===o.sortIndex[t[o.key]]&&(o.sortIndex[t[o.key]]=o.sortIndexCount++),e=o.sortIndex[t[o.key]]-o.sortIndex[i[o.key]]):\\\"linear\\\"===o.type&&(e=t[o.key]-i[o.key]),0!==(e=o.sortReverse?-e:e))return e}return 0}init_esbuild_inject();var idIndex=0,maxId=1e8;function getUUID(e=\\\"dataset\\\"){return maxId<idIndex&&(idIndex=0),e+\\\"_\\\"+idIndex++}init_esbuild_inject();var DataViewDiffRank=\\\"_data-view-diff-rank\\\",DataView=class C12{constructor(e,t){var i;this.dataSet=e,this.options=t,this.isDataView=!0,this.target=new import_eventemitter32[\\\"default\\\"],this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(t={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(e=>{this.executeTransform(e,{pushHistory:t.pushHistory,emitMessage:!1}),this.isLastTransform(e)&&this.diffLastData()}),(this.isRunning=!1)!==t.emitMessage&&this.target.emit(\\\"change\\\",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit(\\\"markRunning\\\",[])},i=null!=t&&t.name?t.name:getUUID(\\\"dataview\\\"),this.name=i,null!=t&&t.history&&(this.history=t.history,this.historyData=[]),this.dataSet.setDataView(i,this),this.setFields(null==t?void 0:t.fields)}parse(e,t,i=!1){this.isRunning=!0,i&&this.target.emit(\\\"beforeParse\\\",[]),t&&(this.parseOption=t);var r,o=this.cloneParseData(e,t);return null!=t&&t.type?(r=(null!=(r=this.dataSet.getParser(t.type))?r:this.dataSet.getParser(\\\"bytejson\\\"))(o,t.options,this),this.rawData=o,this.parserData=r,this.history&&this.historyData.push(o,r),this.latestData=r):(this.parserData=o,this.rawData=o,this.history&&this.historyData.push(o),this.latestData=o),this.isRunning=!1,i&&this.target.emit(\\\"afterParse\\\",[]),this}transform(t,i=!0){if(this.isRunning=!0,t&&t.type){let e=!0;var r;\\\"fields\\\"===t.type&&(this._fields=t.options.fields,0<=(r=this.transformsArr.findIndex(e=>e.type===t.type)))&&(e=!1,this.transformsArr[r].options.fields=this._fields),e&&this.transformsArr.push(t),i&&(r=this.isLastTransform(t),this.executeTransform(t),r)&&this.diffLastData()}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(e){return this.transformsArr[this.transformsArr.length-1]===e}sortTransform(){2<=this.transformsArr.length&&this.transformsArr.sort((e,t)=>{var i;return(null!=(i=e.level)?i:0)-(null!=(i=t.level)?i:0)})}executeTransform(e,t={pushHistory:!0,emitMessage:!0}){var{pushHistory:i,emitMessage:r}=t,o=this.dataSet.getTransform(e.type)(this.latestData,e.options);this.history&&!1!==i&&this.historyData.push(o),this.latestData=o,!1!==r&&this.target.emit(\\\"change\\\",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(e){this._diffData=!0,this._diffKeys=e,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var e;if(this._diffData&&this.latestData.forEach&&null!=(e=this._diffKeys)&&e.length){const r=this._diffRank+1;if(0===this._diffRank)this.latestData.forEach(i=>{i[DataViewDiffRank]=r,this._diffMap.set(this._diffKeys.reduce((e,t)=>e+i[t],\\\"\\\"),i)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let e;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(i=>{i[DataViewDiffRank]=r,e=this._diffKeys.reduce((e,t)=>e+i[t],\\\"\\\"),(this._diffMap.get(e)?this.latestDataAUD.update:this.latestDataAUD.add).push(i),this._diffMap.set(e,i)}),this._diffMap.forEach((e,t)=>{e[DataViewDiffRank]<r&&(this.latestDataAUD.del.push(e),this._diffMap[\\\"delete\\\"](t))})}this._diffRank=r}}cloneParseData(e,t){let i=!1;return(i=e instanceof C12||!0!==(null==t?void 0:t.clone)?i:!0)?cloneDeep2(e):e}parseNewData(e,t){this.parse(e,t||this.parseOption),this.reRunAllTransform()}updateRawData(e,t){var i=this.cloneParseData(e,t);this.rawData=i,this.parserData=i,this.latestData=i,this.reRunAllTransform()}getFields(){var e;return this._fields||(\\\"dataview\\\"===(null==(e=this.parseOption)?void 0:e.type)&&1===this.rawData.length&&this.rawData[0].getFields?this.rawData[0].getFields():null)}setFields(e,t=!1){this._fields=e&&t?merge2({},this._fields,e):e;var i=this.transformsArr.find(e=>\\\"fields\\\"===e.type);!isNil_default2(this._fields)&&isNil_default2(i)?(this.dataSet.registerTransform(\\\"fields\\\",fields),this.transform({type:\\\"fields\\\",options:{fields:this._fields}},!1)):i&&(i.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}};function isDataView(e){return e instanceof DataView}function cloneDeepSpec(e,t=[\\\"data\\\"]){var i=e;if(!isValid_default2(i)||\\\"object\\\"!=typeof i)return i;if(isDataView(i)||isHTMLElement(i))return i;var r=isArray_default2(i),o=i.length,n=r?new Array(o):\\\"object\\\"==typeof i?{}:isBoolean_default2(i)||isNumber_default2(i)||isString_default2(i)?i:isDate_default2(i)?new Date(+i):void 0,a=r?void 0:Object.keys(Object(i));let l=-1;if(n)for(;++l<(a||i).length;){var s=a?a[l]:l,h=i[s];null!=t&&t.includes(s.toString())?n[s]=h:n[s]=cloneDeepSpec(h,t)}return n}init_esbuild_inject();var DEFAULT_TEXT_FONT_FAMILY3=\\\"PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol\\\",DEFAULT_TEXT_FONT_SIZE2=14,THEME_CONSTANTS={FONT_FAMILY:DEFAULT_TEXT_FONT_FAMILY3,LABEL_FONT_SIZE:14,MAP_LABEL_FONT_SIZE:10,TITLE_FONT_SIZE:18,AXIS_TICK_SIZE:4},commonAxis={domainLine:{visible:!0,style:{lineWidth:1,stroke:\\\"#D9DDE4\\\",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:\\\"#EBEDF2\\\",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:\\\"#EBEDF2\\\",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:THEME_CONSTANTS.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:\\\"#D9DDE4\\\",strokeOpacity:1}},subTick:{visible:!1,tickSize:THEME_CONSTANTS.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:\\\"#D9DDE4\\\",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:THEME_CONSTANTS.LABEL_FONT_SIZE,fill:\\\"#89909D\\\",fontWeight:\\\"normal\\\",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:THEME_CONSTANTS.LABEL_FONT_SIZE,fill:\\\"#333333\\\",fontWeight:\\\"normal\\\",fillOpacity:1}}},NO_AXISID_FRO_VTABLE=\\\"NO_AXISID_FRO_VTABLE\\\";function getRawChartSpec(e,t,i){var r,o=i.getCellHeaderPaths(e,t);let n;if(i.indicatorsAsCol){const a=null==(r=o.colHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===a)}else{const l=null==(r=o.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===l)}o=null==n?void 0:n.chartSpec;return\\\"function\\\"==typeof o?o({col:e,row:t,dataValue:i._table.getCellOriginValue(e,t)||\\\"\\\",value:i._table.getCellValue(e,t)||\\\"\\\",rect:i._table.getCellRangeRelativeRect(i._table.getCellRange(e,t)),table:i._table}):o}function isShareChartSpec(e,t,i){var r,o=i.getCellHeaderPaths(e,t);let n;if(i.indicatorsAsCol){const a=null==(r=o.colHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===a)}else{const l=null==(r=o.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===l)}return\\\"function\\\"!=typeof(null==n?void 0:n.chartSpec)}function isNoChartDataRenderNothing(e,t,i){var r,o=i.getCellHeaderPaths(e,t);let n;if(i.indicatorsAsCol){const a=null==(r=o.colHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===a)}else{const l=null==(r=o.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=i.columnObjects.find(e=>e.indicatorKey===l)}return null==n?void 0:n.noDataRenderNothing}function checkHasCartesianChart(e){let t=!1;for(let r=0;r<e.length;r++){var i=e[r];if(i.chartSpec&&\\\"wordCloud\\\"!==i.chartSpec.type&&\\\"radar\\\"!==i.chartSpec.type&&\\\"gauge\\\"!==i.chartSpec.type&&\\\"pie\\\"!==i.chartSpec.type&&\\\"funnel\\\"!==i.chartSpec.type&&\\\"rose\\\"!==i.chartSpec.type){t=!0;break}}return t}function isCartesianChart(e,t,i){let r=!0;var o=i.getRawChartSpec(e,t);return r=o&&\\\"pie\\\"!==o.type&&\\\"radar\\\"!==o.type&&\\\"gauge\\\"!==o.type&&\\\"wordCloud\\\"!==o.type&&\\\"funnel\\\"!==o.type&&\\\"rose\\\"!==o.type?r:!1}function isHasCartesianChartInline(t,i,r,o){let n=!1;if(o.indicatorsAsCol&&\\\"row\\\"===r||!o.indicatorsAsCol&&\\\"col\\\"===r)for(let e=0;e<o.indicatorsDefine.length;e++){var a=o.indicatorsDefine[e];if(a.chartSpec&&\\\"pie\\\"!==a.chartSpec.type&&\\\"wordCloud\\\"!==a.chartSpec.type&&\\\"radar\\\"!==a.chartSpec.type&&\\\"gauge\\\"!==a.chartSpec.type&&\\\"funnel\\\"!==a.chartSpec.type&&\\\"rose\\\"!==a.chartSpec.type){n=!0;break}}else{var l=o.getRawChartSpec(t,i);l?\\\"pie\\\"!==l.type&&\\\"radar\\\"!==l.type&&\\\"gauge\\\"!==l.type&&\\\"wordCloud\\\"!==l.type&&\\\"funnel\\\"!==l.type&&\\\"rose\\\"!==l.type&&(n=!0):n=!1}return n}function getChartSpec(e,t,i){let r=i.getRawChartSpec(e,t);return r?(i._table.isPivotChart()&&((r=cloneDeepSpec(r)).sortDataByAxis=!0,isArray_default(r.series)&&r.series.forEach(e=>{e.sortDataByAxis=!0}),\\\"gauge\\\"!==r.type&&\\\"rose\\\"!==r.type&&\\\"radar\\\"!==r.type&&(r.axes=i.getChartAxes(e,t)),r.padding=0,r.dataZoom=[]),r):null}function getChartAxes(a,l,s){const h=[];if(s.indicatorsAsCol){const d=s.getIndicatorKeyInChartSpec(a,l),u=s.getColKeysPath(a,l);d.forEach((e,t)=>{var{range:i,targetTicks:r,targetRange:o,axisOption:n}=getAxisRangeAndTicks(a,l,t,0===t?\\\"bottom\\\":\\\"top\\\",0===t?\\\"top\\\":\\\"bottom\\\",d,u,s);isNumber_default(null==n?void 0:n.min)&&(i.min=n.min),isNumber_default(null==n?void 0:n.max)&&(i.max=n.max),hasSameAxis(n,h)||h.push(merge({range:i,label:{style:{fontSize:DEFAULT_TEXT_FONT_SIZE2}}},n,{type:(null==n?void 0:n.type)||\\\"linear\\\",orient:0===t?\\\"bottom\\\":\\\"top\\\",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:null!=n&&n.seriesId?void 0:t,tick:{tickMode:getTickModeFunction(r,o,i,t)},sync:{axisId:NO_AXISID_FRO_VTABLE}}))});let e=s.getDimensionKeyInChartSpec(s.rowHeaderLevelCount,l);isArray_default(e)&&(e=e[0]);var t=s.dataset.cacheCollectedValues[e]||s.dataset.collectedValues[e]||[],i=s.getRowKeysPath(a,l),i=t[null!=i?i:\\\"\\\"],t=getAxisOption(a,l,\\\"left\\\",s).axisOption;h.push(merge({domain:\\\"linear\\\"!==(null==t?void 0:t.type)||Array.isArray(i)?Array.from(null!=i?i:[]):void 0,range:\\\"linear\\\"!==(null==t?void 0:t.type)||Array.isArray(i)?void 0:i,label:{style:{fontSize:DEFAULT_TEXT_FONT_SIZE2}}},t,{type:null!=(i=null==t?void 0:t.type)?i:\\\"band\\\",orient:\\\"left\\\",label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}else{const c=s.getIndicatorKeyInChartSpec(a,l),g=s.getRowKeysPath(a,l);c.forEach((e,t)=>{var{range:i,targetTicks:r,targetRange:o,axisOption:n}=getAxisRangeAndTicks(a,l,t,0===t?\\\"left\\\":\\\"right\\\",0===t?\\\"right\\\":\\\"left\\\",c,g,s);isNumber_default(null==n?void 0:n.min)&&(i.min=n.min),isNumber_default(null==n?void 0:n.max)&&(i.max=n.max),hasSameAxis(n,h)||h.push(merge({range:i,label:{style:{fontSize:DEFAULT_TEXT_FONT_SIZE2}}},n,{type:(null==n?void 0:n.type)||\\\"linear\\\",orient:0===t?\\\"left\\\":\\\"right\\\",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:null!=n&&n.seriesId?void 0:t,tick:{tickMode:getTickModeFunction(r,o,i,t)},sync:{axisId:NO_AXISID_FRO_VTABLE}}))});let e=s.getDimensionKeyInChartSpec(a,s.columnHeaderLevelCount);isArray_default(e)&&(e=e[0]);t=s.dataset.cacheCollectedValues[e]||s.dataset.collectedValues[e]||[],i=s.getColKeysPath(a,l),t=null!=(i=null==t?void 0:t[null!=i?i:\\\"\\\"])?i:[],i=getAxisOption(a,l,\\\"bottom\\\",s).axisOption;h.push(merge({domain:\\\"linear\\\"!==(null==i?void 0:i.type)||Array.isArray(t)?Array.from(null!=t?t:[]):void 0,range:\\\"linear\\\"!==(null==i?void 0:i.type)||Array.isArray(t)?void 0:t,label:{style:{fontSize:DEFAULT_TEXT_FONT_SIZE2}}},i,{type:null!=(t=null==i?void 0:i.type)?t:\\\"band\\\",orient:\\\"bottom\\\",visible:!0,label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}return h}function getChartDataId(e,t,i){var r;const o=i.getRawChartSpec(e,t);if(null!=o&&o.series){const n={};return null!=(r=o.data)&&r.id&&(n[o.data.id]=void 0),null!=o&&o.series.forEach(e=>{var t,i;null!=(i=e.data)&&i.fromDataId||(null!=(i=e.data)&&i.transforms?n[null!=(i=null!=(i=null==(i=e.data)?void 0:i.id)?i:null==(i=o.data)?void 0:i.id)?i:\\\"data\\\"]=void 0:(i=\\\"horizontal\\\"===e.direction?e.xField:e.yField,n[null!=(t=null!=(t=null==(t=e.data)?void 0:t.id)?t:null==(t=o.data)?void 0:t.id)?t:\\\"data\\\"]=null!=(t=e.data)&&t.id?i:void 0))}),n}return o.data.id}function checkHasChart(e){let t=!1;for(let i=0;i<e.columnObjects.length;i++)if(e.columnObjects[i].chartSpec){t=!0;break}return t}function hasSameAxis(i,e){return!!(i&&isArray_default(i.seriesId)&&0<i.seriesId.length&&0<e.filter(e=>!(e.orient!==i.orient||!e.seriesId||e.seriesId.length!==i.seriesId.length||!e.seriesId.every((e,t)=>e===i.seriesId[t]))).length)}function getCellRange2(o,n,a){var e,l;if(-1===o||-1===n)return{start:{col:o,row:n},end:{col:o,row:n}};if(a._cellRangeMap.has(`$${o}$`+n))return a._cellRangeMap.get(`$${o}$`+n);let s={start:{col:o,row:n},end:{col:o,row:n}};if(a.transpose)s=getCellRangeTranspose(o,n,a);else if(a.headerLevelCount<=n){if(a.headerLevelCount<=n&&null!=(e=null==(e=a.columnObjects[o-a.leftRowSeriesNumberColumnCount])?void 0:e.define)&&e.mergeCell){var i=a._table.getCellValue(o,n);for(let e=n-1;e>=a.headerLevelCount;e--){var r=a._table.getCellValue(o,e);if(\\\"boolean\\\"==typeof a.columnObjects[o-a.leftRowSeriesNumberColumnCount].define.mergeCell){if(i!==r)break}else if(!a.columnObjects[o-a.leftRowSeriesNumberColumnCount].define.mergeCell(i,r,{source:{col:o,row:n},target:{col:o,row:e},table:a._table}))break;s.start.row=e}for(let t=n+1;t<a.rowCount;t++){var h=a._table.getCellValue(o,t);if(\\\"boolean\\\"==typeof a.columnObjects[o-a.leftRowSeriesNumberColumnCount].define.mergeCell){if(i!==h)break}else if(!a.columnObjects[o-a.leftRowSeriesNumberColumnCount].define.mergeCell(i,h,{source:{col:o,row:n},target:{col:o,row:t},table:a._table}))break;s.end.row=t}}getTreeTitleMerge(o,n,s,a)}else{var d=a.getCellId(o,n);for(let e=o-1;0<=e&&d===a.getCellId(e,n);e--)s.start.col=e;for(let t=o+1;t<(null!=(l=a.colCount)?l:0)&&d===a.getCellId(t,n);t++)s.end.col=t;for(let i=n-1;0<=i&&d===a.getCellId(o,i);i--)s.start.row=i;for(let r=n+1;r<a.headerLevelCount&&d===a.getCellId(o,r);r++)s.end.row=r}return a._cellRangeMap.set(`$${o}$`+n,s),s}function getTreeTitleMerge(e,t,i,r){var o,n;\\\"tree\\\"===r.rowHierarchyType&&(n=r._table.getCellRawRecord(e,t),null!=(o=r._table.internalProps.rowSeriesNumber)&&o.enableTreeCheckbox?null!=n&&n.vtableMerge&&e>=r.leftRowSeriesNumberColumnCount&&(i.start.col=r.rowHeaderLevelCount+r.leftRowSeriesNumberColumnCount,i.end.col=r.colCount-1,i.start.row=i.end.row=t):null!=n&&n.vtableMerge&&(i.start.col=r.rowHeaderLevelCount,i.end.col=r.colCount-1,i.start.row=i.end.row=t))}function getCellRangeTranspose(o,n,a){var e,l,s={start:{col:o,row:n},end:{col:o,row:n}};if(a.headerLevelCount+a.leftRowSeriesNumberColumnCount<=o||-1===o&&-1===n){if(a.headerLevelCount+a.leftRowSeriesNumberColumnCount<=o&&null!=(e=null==(e=a.columnObjects[n])?void 0:e.define)&&e.mergeCell){var i=a._table.getCellValue(o,n);for(let e=o-1;e>=a.headerLevelCount+a.leftRowSeriesNumberColumnCount;e--){var r=a._table.getCellValue(e,n);if(\\\"boolean\\\"==typeof a.columnObjects[n].define.mergeCell){if(i!==r)break}else if(!a.columnObjects[n].define.mergeCell(i,r,{source:{col:o,row:n},target:{col:e,row:n},table:a._table}))break;s.start.col=e}for(let t=o+1;t<(null!=(h=a.colCount)?h:0);t++){var h=a._table.getCellValue(t,n);if(\\\"boolean\\\"==typeof a.columnObjects[n].define.mergeCell){if(i!==h)break}else if(!a.columnObjects[n].define.mergeCell(i,h,{source:{col:o,row:n},target:{col:t,row:n},table:a._table}))break;s.end.col=t}}}else{var d=a.getCellId(o,n);for(let e=n-1;0<=e&&d===a.getCellId(o,e);e--)s.start.row=e;for(let t=n+1;t<(null!=(l=a.rowCount)?l:0)&&d===a.getCellId(o,t);t++)s.end.row=t;for(let i=o-1;0<=i&&d===a.getCellId(i,n);i--)s.start.col=i;for(let r=o+1;r<a.headerLevelCount+a.leftRowSeriesNumberColumnCount&&d===a.getCellId(r,n);r++)s.end.col=r}return s}init_esbuild_inject();var SimpleHeaderLayoutMap=class{constructor(e,t,i,r){this.seqId=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=i,this._table=e,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this.hierarchyIndent=null!=r?r:20,this.hierarchyTextStartAlignment=e.options.hierarchyTextStartAlignment,this.columnTree=new DimensionTree(t,{seqId:0},null),this._headerObjectsIncludeHided=this._addHeaders(0,t,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(e=>!0!==e.define.hide),this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this.rowHierarchyType=checkHasTreeDefine(this)?\\\"tree\\\":\\\"grid\\\",this._hasAggregation=checkHasAggregation(this),this._hasAggregationOnBottomCount=checkHasAggregationOnBottom(this),this._hasAggregationOnTopCount=checkHasAggregationOnTop(this),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber)}handleRowSeriesNumber(e){var t;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map((e,t)=>{var i;return{id:this.seqId++,title:e.title,define:merge({field:\\\"_vtable_rowSeries_number_\\\"+t},e),cellType:null!=(i=e.cellType)?i:\\\"text\\\",headerType:\\\"checkbox\\\"===e.cellType?\\\"checkbox\\\":\\\"text\\\",style:e.style,width:e.width,format:e.format,field:null!=(i=e.field)?i:\\\"_vtable_rowSeries_number_\\\"+t,icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:e.title,define:merge({field:\\\"_vtable_rowSeries_number\\\"},e),cellType:null!=(t=e.cellType)?t:\\\"text\\\",headerType:\\\"checkbox\\\"===e.cellType?\\\"checkbox\\\":\\\"text\\\",style:e.style,width:e.width,format:e.format,field:\\\"_vtable_rowSeries_number\\\",icon:e.icon,headerIcon:e.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(e){this._transpose=e}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}isSeriesNumberInHeader(e,t){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&0<=t&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(t<this.headerLevelCount)return!0}if(0<this.rightRowSeriesNumberColumnCount&&0<=t&&e>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(t<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(e,t){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!0;if(t>=this.headerLevelCount)return!0}if(0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!0;if(t>=this.headerLevelCount)return!0}return!1}isSeriesNumber(e,t){if(isValid_default(e)&&isValid_default(t)){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&0<=t&&e<this.leftRowSeriesNumberColumnCount)return!0;if(0<this.rightRowSeriesNumberColumnCount&&0<=t&&e>=this.colCount-this.rightRowSeriesNumberColumnCount)return!0}return!1}getSeriesNumberHeader(e,t){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(t<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[e],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}return 0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&!this.transpose&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount){if(this.transpose)return this.leftRowSeriesNumberColumn[e];if(t>=this.headerLevelCount)return this.leftRowSeriesNumberColumn[e]}return 0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||t>=this.headerLevelCount)?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}isHeader(e,t){return!!(this.transpose&&e>=this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&0<=t&&t<this.headerLevelCount}isAggregation(e,t){if(this.hasAggregation){if(this.hasAggregationOnBottomCount)if(this.transpose){if(e>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(t>=this.rowCount-this.hasAggregationOnBottomCount)return!0;if(this.hasAggregationOnTopCount)if(this.transpose){if(e>=this.rowHeaderLevelCount&&e<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(t>=this.columnHeaderLevelCount&&t<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isTopAggregation(e,t){if(this.hasAggregationOnTopCount)if(this.transpose){if(e>=this.rowHeaderLevelCount&&e<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(t>=this.columnHeaderLevelCount&&t<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0;return!1}isBottomAggregation(e,t){if(this.hasAggregationOnBottomCount)if(this.transpose){if(e>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(t>=this.rowCount-this.hasAggregationOnBottomCount)return!0;return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(e,t){return this.getColumnDefine(e,t).vtable_aggregator}getAggregatorsByCellRange(t,i,r,e){let o=[];if(!this.transpose){for(let e=t;e<=r;e++){var n=this.getColumnDefine(e,i);n.vtable_aggregator&&(o=o.concat(Array.isArray(n.vtable_aggregator)?n.vtable_aggregator:[n.vtable_aggregator]))}return o}for(let l=i;l<=e;l++){var a=this.getColumnDefine(t,l);a.vtable_aggregator&&(o=o.concat(Array.isArray(a.vtable_aggregator)?a.vtable_aggregator:[a.vtable_aggregator]))}return[]}getAggregatorOnTop(e,t){const i=this.getColumnDefine(e,t),r=i.vtable_aggregator,o=i.aggregation;var n;return Array.isArray(o)?(n=o.reduce((e,t,i)=>(t.showOnTop&&e.push(i),e),[]).map(e=>r[e]),this.transpose?n[e-this.rowHeaderLevelCount]:n[t-this.columnHeaderLevelCount]):this.transpose&&e-this.rowHeaderLevelCount==0?null!=o&&o.showOnTop?r:null:!this.transpose&&t-this.columnHeaderLevelCount==0&&null!=o&&o.showOnTop?r:null}getAggregatorOnBottom(e,t){const i=this.getColumnDefine(e,t),r=i.vtable_aggregator,o=i.aggregation;var n;return Array.isArray(o)?(n=o.reduce((e,t,i)=>(t.showOnTop||e.push(i),e),[]).map(e=>r[e]),this.transpose?n[e-(this.colCount-this.hasAggregationOnBottomCount)]:n[t-(this.rowCount-this.hasAggregationOnBottomCount)]):this.transpose&&e-(this.colCount-this.hasAggregationOnBottomCount)==0?null!=o&&o.showOnTop?null:r:this.transpose||t-(this.rowCount-this.hasAggregationOnBottomCount)!=0||null!=o&&o.showOnTop?null:r}getAggregatorCellAddress(e,t,o,n){var a=[],l=this.hasAggregationOnTopCount,s=this.hasAggregationOnBottomCount;if(this.transpose){for(let i=t;i<=n;i++)if(this.getColumnDefine(e,i).vtable_aggregator){for(let e=0;e<l;e++)a.push({col:this.headerLevelCount+e,row:i});for(let t=0;t<s;t++)a.push({col:this.rowCount-s+t,row:i})}}else for(let r=e;r<=o;r++)if(this.getColumnDefine(r,t).vtable_aggregator){for(let e=0;e<l;e++)a.push({col:r,row:this.headerLevelCount+e});for(let t=0;t<s;t++)a.push({col:r,row:this.rowCount-s+t})}return a}getCellLocation(e,t){return this.isHeader(e,t)?this.transpose?\\\"rowHeader\\\":\\\"columnHeader\\\":\\\"body\\\"}isRowHeader(e,t){return!!(this.transpose&&e>=this.leftRowSeriesNumberColumnCount&&e<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(e,t){return!this.transpose&&0<=t&&t<=this.headerLevelCount-1&&e>=this.leftRowSeriesNumberColumnCount&&e<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(e,t){if(isValid_default(t)){if(0<=e&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(0<this.frozenColCount&&0<=e&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(isValid_default(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(0<this.rightFrozenColCount&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(isValid_default(t)){if(0<=t&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,0<this.frozenRowCount&&0<=t&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(isValid_default(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,0<this.bottomFrozenRowCount&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return 0<=e&&e<this.frozenColCount&&0<=t&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return 0<=e&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&0<=t&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(e,t){return!1}getColumnHeaderRange(){var e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var e;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:(null!=(e=this.colCount)?e:0)-1,row:(null!=(e=this.rowCount)?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:(null!=(e=this.colCount)?e:0)-1,row:(null!=(e=this.rowCount)?e:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(e){this._recordsCount=e}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){var e;return this.leftRowSeriesNumberColumnCount?((e=this.leftRowSeriesNumberColumn.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))).push(...this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))),e):this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))}getColumnWidthDefined(e){var t;if(0<=e){if(e<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[e];if(this.transpose){let r,o,n=0;if(e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let i;return this.columnObjects.forEach((e,t)=>{\\\"number\\\"==typeof e.width?n=Math.max(e.width,n):\\\"auto\\\"===e.width&&(i=!0),\\\"number\\\"==typeof e.minWidth&&(o=Math.max(e.minWidth,o)),\\\"number\\\"==typeof e.maxWidth&&(r=Math.max(e.maxWidth,r))}),{width:n=0<n?n:i?\\\"auto\\\":void 0,minWidth:o,maxWidth:r}}if(this.isRowHeader(e,0))return\\\"auto\\\"===(t=Array.isArray(this._table.defaultHeaderColWidth)?null!=(t=this._table.defaultHeaderColWidth[e])?t:this._table.defaultColWidth:this._table.defaultHeaderColWidth)?{width:\\\"auto\\\"}:{width:t}}return this._columns[e-this.leftRowSeriesNumberColumnCount]}}getCellId(e,t){var i;return this.transpose?e>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?null==(i=this._columns[t])?void 0:i.id:this.isSeriesNumber(e,t)?t+\\\"_series_number\\\":null==(i=this._headerCellIds[e-this.leftRowSeriesNumberColumnCount])?void 0:i[t]:this.isSeriesNumber(e,t)?this.rowSeriesNumberColumn[e].id:this.headerLevelCount<=t?null==(i=this._columns[e-this.leftRowSeriesNumberColumnCount])?void 0:i.id:null==(i=this._headerCellIds[t])?void 0:i[e-this.leftRowSeriesNumberColumnCount]}getHeader(e,t){var i;return this.isSeriesNumberInHeader(e,t)?this.getSeriesNumberHeader(e,t):(i=this.getCellId(e,t),this._headerObjectMap[i])}getHeaderField(e,t){var i;return this.isSeriesNumberInHeader(e,t)?null==(i=this.getSeriesNumberHeader(e,t))?void 0:i.field:this.isSeriesNumberInBody(e,t)?null==(i=this.getSeriesNumberBody(e,t))?void 0:i.field:(i=this.getCellId(e,t),(null==(i=this._headerObjectMap[i])?void 0:i.field)||(this.transpose?this._columns[t]&&this._columns[t].field:this._columns[e-this.leftRowSeriesNumberColumnCount]&&this._columns[e-this.leftRowSeriesNumberColumnCount].field))}getHeaderCellAdressById(t){for(let r=0;r<this._headerCellIds.length;r++){var i=this._headerCellIds[r];for(let e=0;e<i.length;e++)if(i[e]===t)return this.transpose?{col:r,row:e}:{col:e+this.leftRowSeriesNumberColumnCount,row:r}}}getHeaderCellAddressByField(t){var e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(e,t){return this.isSeriesNumber(e,t)?this.getSeriesNumberBody(e,t):this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(i){var r,o;if(this.transpose){for(let e=0;e<(null!=(r=this.rowCount)?r:0);e++)if(i===this._columns[e].id)return{start:{col:0,row:e},end:{col:0,row:e}}}else for(let t=this.leftRowSeriesNumberColumnCount;t<(null!=(o=this.colCount)?o:0);t++)if(i===this._columns[t-this.leftRowSeriesNumberColumnCount].id)return{start:{col:t,row:0},end:{col:t,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(e,t){return getCellRange2(e,t,this)}isCellRangeEqual(e,t,i,r){var o=this.getCellRange(e,t),n=this.getCellRange(i,r);return o.start.col===n.start.col&&o.end.col===n.end.col&&o.start.row===n.start.row&&o.end.row===n.end.row}getRecordShowIndexByCell(e,t){var i=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?e<i?-1:e-i:t<i?-1:t-i}getRecordStartRowByRecordIndex(e){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+e}_addHeaders(n,e,a,l){const s=[],h=this._newRow(n,l);return e.forEach(e=>{var t=this._columns.length,i=this.seqId++,r={id:i,title:null!=(r=e.title)?r:e.caption,headerIcon:e.headerIcon,field:e.field,style:e.headerStyle,headerType:null!=(r=e.headerType)?r:\\\"text\\\",dropDownMenu:e.dropDownMenu,define:e,columnWidthComputeMode:e.columnWidthComputeMode};s[i]=r;for(let o=n-1;0<=o;o--)this._headerCellIds[o]&&(this._headerCellIds[o][t]=a[o]);if(l?this._headerCellIds[n-1]&&(h[t]=this._headerCellIds[n-1][t]):h[t]=i,e.columns)e.columns.every(e=>e.hide)||this._addHeaders(n+1,e.columns,[...a,i],e.hideColumnsSubHeader||l).forEach(e=>s.push(e));else{r={id:this.seqId++,field:e.field,fieldFormat:e.fieldFormat,width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth,icon:e.icon,cellType:null!=(r=null!=(r=e.cellType)?r:e.columnType)?r:\\\"text\\\",chartModule:\\\"chartModule\\\"in e?e.chartModule:null,chartSpec:\\\"chartSpec\\\"in e?e.chartSpec:null,sparklineSpec:\\\"sparklineSpec\\\"in e?e.sparklineSpec:DefaultSparklineSpec,style:e.style,define:e,columnWidthComputeMode:e.columnWidthComputeMode,disableColumnResize:null==e?void 0:e.disableColumnResize,aggregation:e.aggregation,isChildNode:1<=n};if(this._columnsIncludeHided.push(r),!0!==e.hide){this._columns.push(r);for(let e=n+1;e<this._headerCellIds.length;e++)this._headerCellIds[e][t]=i}}}),s}_newRow(t,e=!1){if(this._headerCellIds[t]){var i=this._headerCellIds[t-1];if(i.length>this._headerCellIds[t].length)for(let e=this._headerCellIds[t].length;e<i.length;e++)this._headerCellIds[t][e]=i[e];return this._headerCellIds[t]}if(e)return[];var r=this._headerCellIds[t]=[];if(this._columns.length){var o=this._headerCellIds[t-1];for(let e=0;e<o.length;e++)r[e]=o[e]}return r}getCellHeaderPaths(i,r){if(!this.isSeriesNumber(i,r)){let e=[],t=[];return this.transpose?t=[{field:this._columns[r].field}]:e=[{field:this._columns[i-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:e,rowHeaderPaths:t,cellLocation:this.getCellLocation(i,r)}}}getParentCellId(e,t){if(0!==t)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)&&!this.isSeriesNumberInBody(e-1,t)?this.getCellId(e-1,t):void 0}canMoveHeaderPosition(e,t){var i,r;return!this.isSeriesNumberInHeader(t.col,t.row)&&!this.isSeriesNumberInHeader(e.col,e.row)&&(!this.transpose&&this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)?(r=this.getRecordShowIndexByCell(0,e.row),i=this.getRecordShowIndexByCell(0,t.row),this._table.dataSource.canChangeOrder(r,i)):(this.transpose&&this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode&&this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode?(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(e.col=e.col+this.leftRowSeriesNumberColumnCount,t.col=t.col+this.leftRowSeriesNumberColumnCount)),!(e.col<0||e.row<0||t.col<0||t.row<0||\\\"disabled\\\"===this._table.internalProps.frozenColDragHeaderMode&&this._table.isFrozenColumn(t.col)||(r=this.getCellRange(e.col,e.row),this.isColumnHeader(e.col,e.row)?this.getParentCellId(e.col,r.start.row)!==this.getParentCellId(t.col,r.start.row):!this.isRowHeader(e.col,e.row)||this.getParentCellId(r.start.col,e.row)!==this.getParentCellId(r.start.col,t.row)))))}moveHeaderPosition(i,r){if((null!=(n=this._table.options.dragOrder)&&n.validateDragOrderOnEnd(i,r)||null==(n=this._table.options.dragOrder)||!n.validateDragOrderOnEnd)&&this.canMoveHeaderPosition(i,r)){let t=this.getCellRange(i.col,i.row);if(this.isColumnHeader(i.col,i.row)){var o=t.end.col-t.start.col+1,n=this.getCellRange(r.col,t.start.row),a=r.col>=i.col?n.end.col-o+1:n.start.col;if(a===t.start.col)return null;for(let e=0;e<this._headerCellIds.length;e++){var l=this._headerCellIds[e].splice(t.start.col-this.leftRowSeriesNumberColumnCount,o);l.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[e],l)}var s=this._columns.splice(t.start.col-this.leftRowSeriesNumberColumnCount,o);return s.unshift(a-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,s),this.columnTree.movePosition(t.start.row,t.start.col-this.leftRowSeriesNumberColumnCount,a-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:t.start.col,targetIndex:a,sourceSize:o,targetSize:n.end.col-n.start.col+1,moveType:\\\"column\\\"}}if(this.isRowHeader(i.col,i.row)||this.isSeriesNumberInBody(i.col,i.row)&&this.transpose){var h=(t=this.isSeriesNumberInBody(i.col,i.row)?this.getCellRange(i.col+this.leftRowSeriesNumberColumnCount,i.row):t).end.row-t.start.row+1,s=this.getCellRange(t.start.col,r.row),d=r.row>=i.row?s.end.row-h+1:s.start.row;if(d===t.start.row)return null;for(let e=0;e<this._headerCellIds.length;e++){var u=this._headerCellIds[e].splice(t.start.row,h);u.unshift(d,0),Array.prototype.splice.apply(this._headerCellIds[e],u)}n=this._columns.splice(t.start.row,h);return n.unshift(d,0),Array.prototype.splice.apply(this._columns,n),this.columnTree.movePosition(t.start.col-this.leftRowSeriesNumberColumnCount,t.start.row,d+(r.row>i.row?t.end.row-t.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:t.start.row,targetIndex:d,sourceSize:h,targetSize:s.end.row-s.start.row+1,moveType:\\\"row\\\"}}if(this.isSeriesNumberInBody(i.col,i.row))return{sourceIndex:i.row,targetIndex:r.row,sourceSize:1,targetSize:1,moveType:\\\"row\\\"}}return null}toggleHierarchyState(e){return{addCellPositions:e.add.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e})),removeCellPositions:e.remove.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e}))}}setChartInstance(e,t,i){var r=this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount];\\\"function\\\"!=typeof r.chartSpec&&(r.chartInstance=i)}getChartInstance(e,t){return(this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return checkHasChart(this)}getAxisConfigInPivotChart(e,t){}isEmpty(e,t){return!1}isAxisCell(e,t){return!1}getChartAxes(e,t){return[]}isShareChartSpec(e,t){var i=this.getBody(e,t);return\\\"function\\\"!=typeof(null==i?void 0:i.chartSpec)}isNoChartDataRenderNothing(e,t){var i=this.getBody(e,t);return(null==i?void 0:i.define).noDataRenderNothing}getChartSpec(e,t){return this.getRawChartSpec(e,t)}getRawChartSpec(e,t){var i=this.getBody(e,t),i=null==i?void 0:i.chartSpec;return\\\"function\\\"==typeof i?i({col:e,row:t,dataValue:this._table.getCellOriginValue(e,t)||\\\"\\\",value:this._table.getCellValue(e,t)||\\\"\\\",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(e,t)),table:this._table}):i}getChartDataId(e,t){return getChartDataId(e,t,this)}release(){var e=this._table._getActiveChartInstance();null!=e&&e.release(),this.columnObjects.forEach(e=>{var t;null!=(t=e.chartInstance)&&t.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(e,t,i){var r=this._table.internalProps.layoutMap.getHeader(e,t);r.title=i,r.define.title=i}getColumnByField(r){var e;return null==(e=this.columnObjects)?void 0:e.reduce((e,t,i)=>(t.field===r&&e.push({col:i,columnDefine:t}),e),[])}getColumnByKey(r){let e,o;return{columnDefine:null==(e=this.columnObjects)?void 0:e.find((e,t)=>{var i;return(null==(i=e.define)?void 0:i.key)===r&&(o=t,!0)}),col:o}}getColumnDefine(e,t){if(0<=e)return(e<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[e]:this.transpose?this._columns[t]:this._columns[e-this.leftRowSeriesNumberColumnCount]).define}},EditManager=(init_esbuild_inject(),class{constructor(e){this.isValidatingValue=!1,this.listenersId=[],this.table=e,this.bindEvent()}bindEvent(){const o=this.table,e=o.on(TABLE_EVENT_TYPE.DBLCLICK_CELL,e=>{var t,i,{editCellTrigger:r=\\\"doubleclick\\\"}=o.options;r.includes(\\\"doubleclick\\\")&&(({col:r,row:t}=e),i=getCellEventArgsSet(e.federatedEvent),i=o.scenegraph.getResizeColAt(i.abstractPos.x,i.abstractPos.y,null==(i=i.eventArgs)?void 0:i.targetCell),o._canResizeColumn(i.col,i.row)&&0<=i.col||this.startEditCell(r,t))}),t=o.on(TABLE_EVENT_TYPE.CLICK_CELL,e=>{var t,{editCellTrigger:i=\\\"doubleclick\\\"}=o.options;(\\\"click\\\"===i||Array.isArray(i)&&i.includes(\\\"click\\\"))&&(({col:i,row:t}=e),this.startEditCell(i,t))});this.listenersId.push(e,t)}startEditCell(e,t,i){var r,o,n,a;this.editingEditor||!(r=this.table.getEditor(e,t))||null!=(n=null==(o=this.table.internalProps.layoutMap)?void 0:o.isAggregation)&&n.call(o,e,t)||(this.editingEditor||(this.editCell={col:e,row:t}),this.table._makeVisibleCell(e,t),this.editingEditor=r,o=isValid_default(i)?i:this.table.getCellOriginValue(e,t),a={rect:{left:(n=this.table.getCellRangeRelativeRect(this.table.getCellRange(e,t))).left,top:n.top,width:n.width,height:n.height}},e===this.table.colCount-1&&(a.rect.width=n.width-1),t===this.table.rowCount-1&&(a.rect.height=n.height-1),r.beginEditing,null!=(n=r.beginEditing)&&n.call(r,this.table.getElement(),a,o),r.bindSuccessCallback,null!=(n=r.bindSuccessCallback)&&n.call(r,()=>{this.completeEdit()}),null!=(n=r.onStart)&&n.call(r,{value:o,endEdit:()=>{this.completeEdit()},referencePosition:a,container:this.table.getElement(),col:e,row:t,table:this.table}))}completeEdit(e){if(this.editingEditor){if(this.isValidatingValue)return!1;var t=null==e?void 0:e.target,i=this.editingEditor;if(t)if(i.targetIsOnEditor){if(i.targetIsOnEditor(t))return!1}else if(!i.isEditorElement||i.isEditorElement(t))return!1;if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;const r=this.editingEditor.getValue(),o=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),n=null==(i=(t=this.editingEditor).validateValue)?void 0:i.call(t,r,o,this.editCell,this.table);return isPromise(n)?(this.isValidatingValue=!0,new Promise((t,i)=>{n.then(e=>{dealWithValidateValue(e,this,o,t)})[\\\"catch\\\"](e=>{this.isValidatingValue=!1,i(e)})})):dealWithValidateValue(n,this,o)}this.doExit()}return!0}doExit(){var e,t,i=null==(t=(e=this.editingEditor).getValue)?void 0:t.call(e),r=this.table.getCellRange(this.editCell.col,this.editCell.row),o=[];for(let a=r.start.row;a<=r.end.row;a++){var n=[];for(let e=r.start.col;e<=r.end.col;e++)n.push(i);o.push(n)}this.table.changeCellValues(r.start.col,r.start.row,o),this.editingEditor.exit,null!=(t=(e=this.editingEditor).exit)&&t.call(e),null!=(t=(e=this.editingEditor).onEnd)&&t.call(e),this.editingEditor=null,this.isValidatingValue=!1}cancelEdit(){var e,t;this.editingEditor&&(null!=(t=(e=this.editingEditor).exit)&&t.call(e),null!=(t=(e=this.editingEditor).onEnd)&&t.call(e),this.editingEditor=null)}release(){this.listenersId.forEach(e=>{this.table.off(e)})}});function dealWithValidateValue(e,t,i,r){return t.isValidatingValue=!1,\\\"validate-exit\\\"===e?(t.doExit(),null!=r&&r(!0),!0):\\\"invalidate-exit\\\"===e?(t.editingEditor.setValue(i),t.doExit(),null!=r&&r(!0),!0):\\\"validate-not-exit\\\"!==e&&\\\"invalidate-not-exit\\\"!==e&&!0===e?(t.doExit(),null!=r&&r(!0),!0):(null!=r&&r(!1),!1)}function getGroupByDataConfig(e){return isString_default(e)?{groupByRules:[e]}:isArray_default(e)?{groupByRules:e.map(e=>isString_default(e)?e:e.key)}:{}}function listTableChangeCellValue(e,i,r,t,o){if(t&&o.isHasEditorDefine(e,i)||!1===t){var n=o.getRecordShowIndexByCell(e,i),a=o.internalProps.layoutMap.getBody(e,i).field,l=o.getCellRawValue(e,i),s=o.getCellOriginValue(e,i),h=(o.isHeader(e,i)?o.internalProps.layoutMap.updateColumnTitle(e,i,r):o.dataSource.changeFieldValue(r,n,a,e,i,o),o.getCellRange(e,i)),d=o.internalProps.layoutMap.getAggregatorsByCell(e,i);if(d){if(Array.isArray(d))for(let e=0;e<(null==d?void 0:d.length);e++)d[e].recalculate();else d.recalculate();var u=o.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let e=0;e<u.length;e++){var c=o.getCellRange(u[e].col,u[e].row);for(let t=c.start.col;t<=c.end.col;t++)for(let e=c.start.row;e<=c.end.row;e++)o.scenegraph.updateCellContent(t,e)}}for(let t=h.start.col;t<=h.end.col;t++)for(let e=h.start.row;e<=h.end.row;e++)o.scenegraph.updateCellContent(t,e);\\\"adaptive\\\"===o.widthMode||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth?0===o.internalProps._widthResizedColMap.size&&o.scenegraph.recalculateColWidths():o.internalProps._widthResizedColMap.has(e)||(n=o.getColWidth(e),(a=computeColWidth(e,0,o.rowCount-1,o,!1))!==n&&o.scenegraph.updateColWidth(e,a-n)),\\\"adaptive\\\"===o.heightMode||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight?0===o.internalProps._heightResizedRowMap.size&&o.scenegraph.recalculateRowHeights():o.isAutoRowHeight(i)&&!o.internalProps._heightResizedRowMap.has(i)&&(a=o.getRowHeight(i),n=computeRowHeight(i,0,o.colCount-1,o),o.scenegraph.updateRowHeight(i,n-a));n=o.getCellOriginValue(e,i);s!==n&&o.fireListeners(TABLE_EVENT_TYPE.CHANGE_CELL_VALUE,{col:e,row:i,rawValue:l,currentValue:s,changedValue:n}),o.scenegraph.updateNextFrame()}}function listTableChangeCellValues(r,o,n,a,l){let s,h,e=r,d=o;var u=[],c=[];let t;for(let L=0;L<n.length&&!(o+L>l.rowCount-1);L++){var i=n[L],g=[],p=[];u.push(g),c.push(p);for(let e=0;e<i.length&&!(r+e>l.colCount-1);e++){t=getCellUpdateType(r+e,o+L,l,t);var f=l.getCellRawValue(r+e,o+L),f=(g.push(f),l.getCellOriginValue(r+e,o+L));p.push(f)}}for(let k=0;k<n.length&&!(o+k>l.rowCount-1);k++){d=o+k;var m,b,C,v,y,w,_=n[k];let t=r;for(let i=0;i<_.length&&!(r+i>l.colCount-1);i++){t=r+i;let e=!1;!1===a?e=!0:l.isHasEditorDefine(r+i,o+k)&&(C=l.getEditor(r+i,o+k),b=c[k][i],m=_[i],C=null==(h=null==(s=null==C?void 0:C.validateValue)?void 0:s.call(C,m,b))||h,e=!!isPromise(C)||!0===C||\\\"validate-exit\\\"===C||\\\"invalidate-exit\\\"===C),e&&(m=_[i],b=l.getRecordShowIndexByCell(r+i,o+k),C=l.internalProps.layoutMap.getBody(r+i,o+k).field,v=u[k][i],y=c[k][i],l.isHeader(r+i,o+k)?l.internalProps.layoutMap.updateColumnTitle(r+i,o+k,m):l.dataSource.changeFieldValue(m,b,C,r+i,o+k,l),y!==(w=l.getCellOriginValue(r+i,o+k)))&&l.fireListeners(TABLE_EVENT_TYPE.CHANGE_CELL_VALUE,{col:r+i,row:o+k,rawValue:v,currentValue:y,changedValue:w})}e=Math.max(e,t)}var S,x,R=l.getCellRange(r,o),T=l.getCellRange(e,d),A=l.internalProps.layoutMap.getAggregatorsByCellRange(R.start.col,R.start.row,T.end.col,T.end.row);if(A){for(let e=0;e<(null==A?void 0:A.length);e++)A[e].recalculate();if(\\\"normal\\\"===t){var P=l.internalProps.layoutMap.getAggregatorCellAddress(R.start.col,R.start.row,T.end.col,T.end.row);for(let e=0;e<P.length;e++){var B=l.getCellRange(P[e].col,P[e].row);for(let t=B.start.col;t<=B.end.col;t++)for(let e=B.start.row;e<=B.end.row;e++)l.scenegraph.updateCellContent(t,e)}}}if(\\\"group\\\"===t&&l.dataSource.updateRecordsForGroup([],[]),\\\"sort\\\"===t||\\\"group\\\"===t)l.dataSource.sortedIndexMap.clear(),sortRecords(l),l.refreshRowColCount(),l.internalProps.layoutMap.clearCellRangeMap(),l.scenegraph.clearCells(),l.scenegraph.createSceneGraph();else{for(let t=R.start.col;t<=T.end.col;t++)for(let e=R.start.row;e<=T.end.row;e++)l.scenegraph.updateCellContent(t,e);if(\\\"adaptive\\\"===l.widthMode||l.autoFillWidth&&l.getAllColsWidth()<=l.tableNoFrameWidth)0===l.internalProps._widthResizedColMap.size&&l.scenegraph.recalculateColWidths();else for(let e=r;e<=T.end.col;e++)l.internalProps._widthResizedColMap.has(e)||(S=l.getColWidth(e),(x=computeColWidth(e,0,l.rowCount-1,l,!1))!==S&&l.scenegraph.updateColWidth(e,x-S));if(\\\"adaptive\\\"===l.heightMode||l.autoFillHeight&&l.getAllRowsHeight()<=l.tableNoFrameHeight)l.scenegraph.recalculateRowHeights();else if(l.isAutoRowHeight(o)){var M,E,H=[],I=[];for(let e=o;e<=T.end.row;e++)l.rowHeightsMap.get(e)&&(M=l.getRowHeight(e),E=computeRowHeight(e,0,l.colCount-1,l),H.push(e),I.push(E-M));l.scenegraph.updateRowsHeight(H,I)}l.scenegraph.updateNextFrame()}}function getCellUpdateType(e,t,i,r){if(\\\"group\\\"===r)return r;if(\\\"sort\\\"===r&&!i.options.groupBy)return r;let o=\\\"normal\\\";return i.options.groupBy?o=\\\"group\\\":!i.isHeader(e,t)&&i.dataSource.lastOrderField&&i.getBodyField(e,t)===i.dataSource.lastOrderField&&(o=\\\"sort\\\"),o}function sortRecords(i){let e=i.sortState;(e=!e||Array.isArray(e)?e:[e])&&(e=e.map(e=>{var t;return e.orderFn=null!=(t=i._getSortFuncFromHeaderOption(void 0,e.field))?t:defaultOrderFn,e}),i.dataSource.sort(e))}function listTableAddRecord(e,r,o){if(o.options.groupBy)null!=(a=(t=o.dataSource).addRecordsForGroup)&&a.call(t,[e],r),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.sortState&&sortRecords(o),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph();else if(\\\"tree\\\"===o.dataSource.rowHierarchyType)null!=(a=(t=o.dataSource).addRecordsForTree)&&a.call(t,[e],r),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.sortState&&sortRecords(o),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph();else if(o.sortState)o.dataSource.addRecordForSorted(e),sortRecords(o),o.refreshRowColCount(),o.scenegraph.clearCells(),o.scenegraph.createSceneGraph();else{(void 0===r||r>o.dataSource.sourceLength)&&(r=o.dataSource.sourceLength);var n=o.transpose?o.rowHeaderLevelCount:o.columnHeaderLevelCount,t=(o.dataSource.addRecord(e,r),o.rowCount);if(o.refreshRowColCount(),0===o.scenegraph.proxy.totalActualBodyRowCount)o.scenegraph.clearCells(),o.scenegraph.createSceneGraph();else{var i=o.transpose?o.colCount:o.rowCount;if(o.pagination){var{perPageCount:a,currentPage:l}=o.pagination,l=a*(l||0)+a;if(r<l)if(r<l-a)o.scenegraph.clearCells(),o.scenegraph.createSceneGraph();else{var s=r-(l-a)+n;if(t-n===o.pagination.perPageCount){var h=[];for(let e=s;e<i;e++)o.transpose?h.push({col:e,row:0}):h.push({col:0,row:e});o.transpose?o.scenegraph.updateCol([],[],h):o.scenegraph.updateRow([],[],h)}else{var d=[];for(let e=s;e<Math.min(i,s+1);e++)o.transpose?d.push({col:e,row:0}):d.push({col:0,row:e});o.transpose?o.scenegraph.updateCol([],d,[]):o.scenegraph.updateRow([],d,[])}}}else{var u=[];for(let e=r+n;e<r+n+1;e++)o.transpose?u.push({col:e,row:0}):u.push({col:0,row:e});var c=[],g=o.internalProps.layoutMap.hasAggregationOnTopCount,l=o.internalProps.layoutMap.hasAggregationOnBottomCount;for(let t=n;t<n+g;t++)o.transpose?c.push({col:t,row:0}):c.push({col:0,row:t});for(let i=(o.transpose?o.colCount:o.rowCount)-l;i<(o.transpose?o.colCount:o.rowCount);i++)c.push(o.transpose?{col:i,row:0}:{col:0,row:i});o.transpose?o.scenegraph.updateCol([],u,[]):o.scenegraph.updateRow([],u,[])}}}}function listTableAddRecords(r,o,n){if(n.options.groupBy)null!=(i=(e=n.dataSource).addRecordsForGroup)&&i.call(e,r,o),n.refreshRowColCount(),n.internalProps.layoutMap.clearCellRangeMap(),n.sortState&&sortRecords(n),n.scenegraph.clearCells(),n.scenegraph.createSceneGraph();else if(\\\"tree\\\"===n.dataSource.rowHierarchyType)null!=(i=(e=n.dataSource).addRecordsForTree)&&i.call(e,r,o),n.refreshRowColCount(),n.internalProps.layoutMap.clearCellRangeMap(),n.sortState&&sortRecords(n),n.scenegraph.clearCells(),n.scenegraph.createSceneGraph();else if(n.sortState)n.dataSource.addRecordsForSorted(r),sortRecords(n),n.refreshRowColCount(),n.scenegraph.clearCells(),n.scenegraph.createSceneGraph();else{void 0===o||o>n.dataSource.sourceLength?o=n.dataSource.sourceLength:o<0&&(o=0);var a=n.transpose?n.rowHeaderLevelCount:n.columnHeaderLevelCount,e=(n.dataSource.addRecords(r,o),n.transpose?n.colCount:n.rowCount);if(n.refreshRowColCount(),0===n.scenegraph.proxy.totalActualBodyRowCount)n.scenegraph.clearCells(),n.scenegraph.createSceneGraph();else{var t=n.transpose?n.colCount:n.rowCount;if(n.pagination){var{perPageCount:i,currentPage:l}=n.pagination,l=i*(l||0)+i;if(o<l)if(o<l-i)n.scenegraph.clearCells(),n.scenegraph.createSceneGraph();else{var s=o-(l-i)+a;if(e-a===n.pagination.perPageCount){var h=[];for(let e=s;e<t;e++)n.transpose?h.push({col:e,row:0}):h.push({col:0,row:e});n.transpose?n.scenegraph.updateCol([],[],h):n.scenegraph.updateRow([],[],h)}else{var d=[];for(let e=s;e<Math.min(t,s+(Array.isArray(r)?r.length:1));e++)n.transpose?d.push({col:e,row:0}):d.push({col:0,row:e});n.transpose?n.scenegraph.updateCol([],d,[]):n.scenegraph.updateRow([],d,[])}}}else{var u=[];for(let e=o+a;e<o+a+(Array.isArray(r)?r.length:1);e++)n.transpose?u.push({col:e,row:0}):u.push({col:0,row:e});var c=n.internalProps.layoutMap.hasAggregationOnTopCount,l=n.internalProps.layoutMap.hasAggregationOnBottomCount,g=[];for(let t=a;t<a+c;t++)n.transpose?g.push({col:t,row:0}):g.push({col:0,row:t});for(let i=(n.transpose?n.colCount:n.rowCount)-l;i<(n.transpose?n.colCount:n.rowCount);i++)g.push(n.transpose?{col:i,row:0}:{col:0,row:i});n.transpose?n.scenegraph.updateCol([],u,g):n.scenegraph.updateRow([],u,g)}}}}function listTableDeleteRecords(e,r){if(0<(null==e?void 0:e.length))if(r.options.groupBy)null!=(l=(o=r.dataSource).deleteRecordsForGroup)&&l.call(o,e),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&sortRecords(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(\\\"tree\\\"===r.dataSource.rowHierarchyType)null!=(l=(o=r.dataSource).deleteRecordsForTree)&&l.call(o,e),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&sortRecords(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(r.sortState)r.dataSource.deleteRecordsForSorted(e),sortRecords(r),r.refreshRowColCount(),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{var o=r.dataSource.deleteRecords(e);if(0!==o.length){var i=r.transpose?r.colCount:r.rowCount,n=(r.refreshRowColCount(),r.transpose?r.colCount:r.rowCount),a=o.sort((e,t)=>e-t),l=a[0];if(r.pagination){var{perPageCount:o,currentPage:s}=r.pagination,s=o*(s||0)+o;if(l<s)if(l<s-o)r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{var h=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,d=r.internalProps.layoutMap.hasAggregationOnTopCount,u=[],c=[];for(let e=l-(s-o)+(r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount)+d;e<n;e++)r.transpose?u.push({col:e,row:0}):u.push({col:0,row:e});for(let t=h;t<h+d;t++)r.transpose?u.push({col:t,row:0}):u.push({col:0,row:t});if(n<i)for(let e=n;e<i;e++)r.transpose?c.push({col:e,row:0}):c.push({col:0,row:e});null!=(l=r.reactCustomLayout)&&l.clearCache(),r.transpose?r.scenegraph.updateCol(c,[],u):r.scenegraph.updateRow(c,[],u),null!=(s=r.reactCustomLayout)&&s.updateAllCustomCell()}}else{var g=[],p=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,f=r.internalProps.layoutMap.hasAggregationOnTopCount,o=r.internalProps.layoutMap.hasAggregationOnBottomCount;for(let e=0;e<a.length;e++){var m=a[e]+p+f;r.transpose?g.push({col:m,row:0}):g.push({col:0,row:m})}var b=[];for(let t=p;t<p+f;t++)r.transpose?b.push({col:t,row:0}):b.push({col:0,row:t});for(let i=(r.transpose?r.colCount:r.rowCount)-o;i<(r.transpose?r.colCount:r.rowCount);i++)b.push(r.transpose?{col:i,row:0}:{col:0,row:i});null!=(l=r.reactCustomLayout)&&l.clearCache(),r.transpose?r.scenegraph.updateCol(g,[],b):r.scenegraph.updateRow(g,[],b),null!=(s=r.reactCustomLayout)&&s.updateAllCustomCell()}}}}function listTableUpdateRecords(e,t,r){if(0<(null==t?void 0:t.length))if(r.options.groupBy)null!=(a=(o=r.dataSource).updateRecordsForGroup)&&a.call(o,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&sortRecords(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(\\\"tree\\\"===r.dataSource.rowHierarchyType)null!=(a=(o=r.dataSource).updateRecordsForTree)&&a.call(o,e,t),r.refreshRowColCount(),r.internalProps.layoutMap.clearCellRangeMap(),r.sortState&&sortRecords(r),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else if(r.sortState)r.dataSource.updateRecordsForSorted(e,t),sortRecords(r),r.refreshRowColCount(),r.scenegraph.clearCells(),r.scenegraph.createSceneGraph();else{var o=r.dataSource.updateRecords(e,t);if(0!==o.length){var n=o.map(e=>r.getBodyRowIndexByRecordIndex(e)).sort((e,t)=>e-t);if(r.pagination){var{perPageCount:i,currentPage:a}=r.pagination,l=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,s=r.internalProps.layoutMap.hasAggregationOnTopCount,h=i*(a||0)+i,d=[];for(let e=0;e<n.length;e++){var u=n[e];u<h&&h-i<=u&&(u=u-(h-i)+(r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount)+s,d.push(u))}if(1<=d.length){var c=[];for(let e=0;e<d.length;e++){var g=d[e];r.transpose?c.push({col:g,row:0}):c.push({col:0,row:g})}for(let t=l;t<l+s;t++)r.transpose?c.push({col:t,row:0}):c.push({col:0,row:t});r.transpose?r.scenegraph.updateCol([],[],c):r.scenegraph.updateRow([],[],c)}}else{var p=[],f=r.transpose?r.rowHeaderLevelCount:r.columnHeaderLevelCount,m=r.internalProps.layoutMap.hasAggregationOnTopCount,o=r.internalProps.layoutMap.hasAggregationOnBottomCount;for(let e=0;e<n.length;e++){var b=n[e]+f+m;r.transpose?p.push({col:b,row:0}):p.push({col:0,row:b})}for(let t=f;t<f+m;t++)r.transpose?p.push({col:t,row:0}):p.push({col:0,row:t});for(let i=(r.transpose?r.colCount:r.rowCount)-o;i<(r.transpose?r.colCount:r.rowCount);i++)p.push(r.transpose?{col:i,row:0}:{col:0,row:i});r.transpose?r.scenegraph.updateCol([],[],p):r.scenegraph.updateRow([],[],p)}}}}function fixUpdateRowRange(e,t,i,r){var o=[{col:t,row:i}],n=[],a=[],{addCellPositions:l,removeCellPositions:s}=e,h=r.scenegraph.proxy,{rowStart:d,rowLimit:u}=h;let c=h.rowEnd,g=1/0;for(let C=0;C<l.length;C++){var p=l[C].row;c-d+1===u?d<=p&&p<=c&&(g=Math.min(g,p)):(n.push({col:t,row:p}),c++)}var f=Math.min(d+u,r.rowCount-1-r.bottomFrozenRowCount),m=f<d+u;for(let v=0;v<s.length;v++){var b=s[s.length-v-1].row;b<d||b>c||(f<b||m?(a.push({col:t,row:b}),g--):g=Math.min(g,b))}if(g!==1/0)for(let e=g;e<=c;e++)o.push({col:t,row:e});return r.scenegraph.proxy.refreshRowCount(),{updateCells:o,addCells:n,removeCells:a}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var ListTable=class extends BaseTable{constructor(e,t){\\\"node\\\"===Env.mode?(t=e,e=null):e instanceof HTMLElement||(e=(t=e).container||null),super(e,t),this.showHeader=!0;var i,r=this.internalProps;r.frozenColDragHeaderMode=null!=(i=null==(i=t.dragOrder)?void 0:i.frozenColDragHeaderMode)?i:t.frozenColDragHeaderMode,this.pagination=t.pagination,r.sortState=t.sortState,r.multipleSort=!!t.multipleSort,r.dataConfig=t.groupBy?getGroupByDataConfig(t.groupBy):{},r.columns=t.columns?cloneDeepSpec(t.columns,[\\\"children\\\"]):t.header?cloneDeepSpec(t.header,[\\\"children\\\"]):[],generateAggregationForColumn(this),r.enableTreeNodeMerge=null!=(i=null!=(i=t.enableTreeNodeMerge)?i:isValid_default(t.groupBy))&&i,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=null==(i=t.showHeader)||i,this.internalProps.columnWidthConfig=t.columnWidthConfig,this.transpose=null!=(i=t.transpose)&&i,\\\"node\\\"!==Env.mode&&(this.editorManager=new EditManager(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:r.sortState}):this.setRecords([]),t.title&&(i=Factory2.getComponent(\\\"title\\\"),r.title=new i(t.title,this),this.scenegraph.resize()),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(r=this.internalProps.emptyTip)&&r.resetVisible():(i=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new i(this.options.emptyTip,this),null!=(r=this.internalProps.emptyTip)&&r.resetVisible())),t.enableTreeStickCell&&(i=Factory2.getComponent(\\\"listTreeStickCellPlugin\\\"),this.listTreeStickCellPlugin=new i(this)),setTimeout(()=>{this.fireListeners(TABLE_EVENT_TYPE.INITIALIZED,null)},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var e;return null==(e=this.dataSource)?void 0:e.records}get recordsCount(){return this.dataSource.records.length}updateColumns(e){var t,i,r={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=cloneDeepSpec(e,[\\\"children\\\"]),generateAggregationForColumn(this),this.options.columns=e,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),null!=(i=(t=this.dataSource).updateColumns)&&i.call(t,this.internalProps.columns),this.records&&checkHasAggregationOnColumnDefine(e)&&this.dataSource.processRecords(null!=(i=null==(t=this.dataSource.dataSourceObj)?void 0:t.records)?i:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(r.col,r.row),this.renderAsync(),this.eventManager.updateEventBinder()}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(e){this.internalProps.columns=e,generateAggregationForColumn(this),this.options.header=e,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var e;return null!=(e=this.internalProps.transpose)&&e}set transpose(e){this.internalProps.transpose!==e&&(this.internalProps.transpose=e,this.internalProps.layoutMap)&&(this.internalProps.layoutMap.transpose=e,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync())}getCellValue(t,i,e){if(-1===t||-1===i)return null;if(!e){var r=this.getCustomMergeValue(t,i);if(r)return r}r=this;if(r.internalProps.layoutMap.isSeriesNumber(t,i)){if(r.internalProps.layoutMap.isSeriesNumberInHeader(t,i))return o=r.internalProps.layoutMap.getSeriesNumberHeader(t,i).title,o;let e;if(this.options.groupBy){var o=r.getCellRawRecord(t,i);if(null!=o&&o.vtableMerge)return\\\"\\\";e=this.dataSource.getGroupSeriesNumber(i-this.columnHeaderLevelCount)}else e=i-this.columnHeaderLevelCount+1;var o=r.internalProps.layoutMap.getSeriesNumberBody(t,i).format;return\\\"function\\\"==typeof o?o(t,i,this,e):e}if(r.internalProps.layoutMap.isHeader(t,i))return o=r.internalProps.layoutMap.getHeader(t,i).title,\\\"function\\\"==typeof o?o():o;if(r.internalProps.layoutMap.isAggregation(t,i)){if(r.internalProps.layoutMap.isTopAggregation(t,i))return null!=(o=r.internalProps.layoutMap.getAggregatorOnTop(t,i))&&o.formatValue?o.formatValue(t,i,this):\\\"\\\";if(r.internalProps.layoutMap.isBottomAggregation(t,i))return null!=(o=r.internalProps.layoutMap.getAggregatorOnBottom(t,i))&&o.formatValue?o.formatValue(t,i,this):\\\"\\\"}var{field:o,fieldFormat:n}=r.internalProps.layoutMap.getBody(t,i);return r.getFieldData(n||o,t,i)}getCellOriginValue(e,t){if(-1===e||-1===t)return null;var i=this;if(i.internalProps.layoutMap.isSeriesNumber(e,t))return i.internalProps.layoutMap.isSeriesNumberInHeader(e,t)?(r=i.internalProps.layoutMap.getSeriesNumberHeader(e,t).title,r):(r=i.internalProps.layoutMap.getSeriesNumberBody(e,t).format,\\\"function\\\"==typeof r?r(e,t,this):t-this.columnHeaderLevelCount);if(i.internalProps.layoutMap.isHeader(e,t))return r=i.internalProps.layoutMap.getHeader(e,t).title,\\\"function\\\"==typeof r?r():r;if(i.internalProps.layoutMap.isAggregation(e,t)){if(i.internalProps.layoutMap.isTopAggregation(e,t))return null==(r=i.internalProps.layoutMap.getAggregatorOnTop(e,t))?void 0:r.value();if(i.internalProps.layoutMap.isBottomAggregation(e,t))return null==(r=i.internalProps.layoutMap.getAggregatorOnBottom(e,t))?void 0:r.value()}var r=i.internalProps.layoutMap.getBody(e,t).field;return i.getFieldData(r,e,t)}getCellRawValue(e,t){var i;return-1===e||-1===t?null:this.internalProps.layoutMap.isHeader(e,t)?(i=this.internalProps.layoutMap.getHeader(e,t).title,\\\"function\\\"==typeof i?i():i):(i=this.internalProps.layoutMap.getBody(e,t).field,this.getRawFieldData(i,e,t))}getRecordShowIndexByCell(e,t){var i=this.internalProps.layoutMap;return i.getRecordShowIndexByCell(e,t)}getRecordIndexByCell(e,t){var i=this.internalProps.layoutMap,i=i.getRecordShowIndexByCell(e,t);return this.dataSource.getRecordIndexPaths(i)}getTableIndexByRecordIndex(e){return this.transpose?this.dataSource.getTableIndex(e)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(e)+this.columnHeaderLevelCount}getTableIndexByField(t){var e=this.internalProps.layoutMap.columnObjects.find(e=>e.field===t);return e?(e=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id),this.transpose?e.start.row:e.start.col):-1}getCellAddrByFieldRecord(e,t){return this.transpose?{col:this.getTableIndexByRecordIndex(t),row:this.getTableIndexByField(e)}:{col:this.getTableIndexByField(e),row:this.getTableIndexByRecordIndex(t)}}getCellOriginRecord(e,t){var i=this.getRecordShowIndexByCell(e,t);if(-1<i)return this.dataSource.get(i)}getCellRawRecord(e,t){var i=this.getRecordShowIndexByCell(e,t);if(-1<i)return this.dataSource.getRaw(i)}_canResizeColumn(e,t){var i=super._canResizeColumn(e,t);if(i&&!this.transpose){var r=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount),o=this.internalProps.layoutMap.isSeriesNumber(e,t);if(null!=r&&r.disableColumnResize)return!1;if(o&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1}return i}updateOption(e){var t,i=this.internalProps;return super.updateOption(e),i.frozenColDragHeaderMode=null!=(t=null==(t=e.dragOrder)?void 0:t.frozenColDragHeaderMode)?t:e.frozenColDragHeaderMode,this.pagination=e.pagination,i.sortState=e.sortState,i.dataConfig=e.groupBy?getGroupByDataConfig(e.groupBy):{},this.showHeader=null==(t=e.showHeader)||t,i.columns=e.columns?cloneDeepSpec(e.columns,[\\\"children\\\"]):e.header?cloneDeepSpec(e.header,[\\\"children\\\"]):[],generateAggregationForColumn(this),i.enableTreeNodeMerge=null!=(t=null!=(t=e.enableTreeNodeMerge)?t:isValid_default(e.groupBy))&&t,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=null!=(t=e.transpose)&&t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=e.columnWidthConfig,i.releaseList&&(i.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),i.releaseList=null),e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:e.sortState}):(this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),e.title&&(t=Factory2.getComponent(\\\"title\\\"),i.title=new t(e.title,this),this.scenegraph.resize()),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(i=this.internalProps.emptyTip)&&i.resetVisible():(t=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new t(this.options.emptyTip,this),null!=(i=this.internalProps.emptyTip)&&i.resetVisible())),new Promise(e=>{setTimeout(e,0)})}updatePagination(e){this.pagination&&(\\\"number\\\"==typeof e.currentPage&&0<=e.currentPage&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var e=this.internalProps,t=this.transpose,i=this.showHeader;((e.layoutMap=new SimpleHeaderLayoutMap(this,null!=(e=e.columns)?e:[],i,this.options.hierarchyIndent)).transpose=t)||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t=this,i=t.internalProps.layoutMap;i&&(e=null!=(e=null==(e=t.internalProps.dataSource)?void 0:e.length)?e:0,i.recordsCount=e+(0<e?i.hasAggregationOnTopCount+i.hasAggregationOnBottomCount:0),t.transpose?(t.rowCount=null!=(e=i.rowCount)?e:0,t.colCount=null!=(e=i.colCount)?e:0,this.internalProps.frozenColCount=Math.max((null!=(e=i.headerLevelCount)?e:0)+i.leftRowSeriesNumberColumnCount,null!=(e=this.options.frozenColCount)?e:0),this.internalProps.frozenRowCount=null!=(e=this.options.frozenRowCount)?e:0,t.bottomFrozenRowCount!==(null!=(e=this.options.bottomFrozenRowCount)?e:0)&&(t.bottomFrozenRowCount=null!=(e=this.options.bottomFrozenRowCount)?e:0),t.rightFrozenColCount!==(null!=(e=this.options.rightFrozenColCount)?e:0)&&(t.rightFrozenColCount=null!=(e=this.options.rightFrozenColCount)?e:0)):(t.colCount=null!=(e=i.colCount)?e:0,t.rowCount=i.recordsCount*i.bodyRowSpanCount+i.headerLevelCount,this.internalProps.frozenColCount=null!=(e=this.options.frozenColCount)?e:0,t.frozenRowCount=Math.max(i.headerLevelCount,null!=(e=this.options.frozenRowCount)?e:0),t.bottomFrozenRowCount!==(null!=(i=this.options.bottomFrozenRowCount)?i:0)&&(t.bottomFrozenRowCount=null!=(e=this.options.bottomFrozenRowCount)?e:0),t.rightFrozenColCount!==(null!=(i=this.options.rightFrozenColCount)?i:0)&&(t.rightFrozenColCount=null!=(e=this.options.rightFrozenColCount)?e:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount))}getFieldData(e,t,i){var r;return null===e||this.internalProps.layoutMap.isHeader(t,i)?null:(r=this.getRecordShowIndexByCell(this.transpose?t-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:t,i),this.internalProps.dataSource.getField(r,e,t,i,this))}getRawFieldData(e,t,i){var r;return null===e||this.internalProps.layoutMap.isHeader(t,i)?null:(r=this.getRecordShowIndexByCell(t,i),this.internalProps.dataSource.getRawField(r,e,t,i,this))}_moveHeaderPosition(e,t){var i=this.getCellRange(e.col,e.row),r=this.getCellRange(t.col,t.row),o=this.internalProps.layoutMap.moveHeaderPosition(e,t);return o?(\\\"column\\\"===o.moveType?(this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,o.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):o.targetIndex>o.sourceIndex?this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex+o.sourceSize-o.targetSize,o.targetSize,o.targetIndex):this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex,o.targetSize,o.targetIndex),o):null}changeRecordOrder(e,t){t=this.transpose?(e=this.getRecordShowIndexByCell(e,0),this.getRecordShowIndexByCell(t,0)):(e=this.getRecordShowIndexByCell(0,e),this.getRecordShowIndexByCell(0,t)),this.dataSource.changeOrder(e,t)}getCellAddress(t,e){let i;for(let n=0;n<this.internalProps.records.length;n++){var r=this.internalProps.records[n];if(\\\"function\\\"==typeof t)t(r)&&(i=n);else{let e=!0;for(const a in t)if(r[a]!==t[a]){e=!1;break}e&&(i=n)}if(isValid_default(i))break}var o=this.getCellRangeByField(e,i);if(o)return{row:o.start.row,col:o.start.col}}getCellRangeByField(t,i){var r=this.internalProps.layoutMap,o=r.columnObjects.find(e=>e.field===t);if(o){o=r.getBodyLayoutRangeById(o.id);let e;return isValid_default(i)&&(e=r.getRecordStartRowByRecordIndex(i)),this.transpose?{start:{row:o.start.row,col:isValid_default(e)?e+o.start.col:void 0},end:{row:o.end.row,col:isValid_default(e)?e+o.end.col:void 0}}:{start:{col:o.start.col,row:isValid_default(e)?e+o.start.row:void 0},end:{col:o.end.col,row:isValid_default(e)?e+o.end.row:void 0}}}return null}getHierarchyState(e,t){var i;return this.options.groupBy&&(!isArray_default(this.options.groupBy)||0!==this.options.groupBy.length)||this.getBodyColumnDefine(e,t).tree?(i=this.getRecordShowIndexByCell(e,t),this.dataSource.getHierarchyState(i)):HierarchyState.none}toggleHierarchyState(e,t,i=!0){this.stateManager.updateHoverIcon(e,t,void 0,void 0);var r=this.getHierarchyState(e,t);r===HierarchyState.expand?(this._refreshHierarchyState(e,t,i),this.fireListeners(TABLE_EVENT_TYPE.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:HierarchyState.collapse})):r===HierarchyState.collapse&&(r=this.getCellOriginRecord(e,t),Array.isArray(r.children)&&this._refreshHierarchyState(e,t,i),this.fireListeners(TABLE_EVENT_TYPE.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:HierarchyState.expand,originData:r}))}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}_refreshHierarchyState(e,t,i=!0){let r,o,n=!1,a=!1;var l=this.internalProps.layoutMap.checkHasChart(),s=(l&&(this.autoFillWidth&&(n=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight)&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight),this.getRecordShowIndexByCell(e,t)),s=this.dataSource.toggleHierarchyState(s,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),s=this.internalProps.layoutMap.toggleHierarchyState(s);this.refreshRowColCount();for(let c=this.rowCount-this.bottomFrozenRowCount;c<this.rowCount;c++){var h=computeRowHeight(c,0,this.colCount-1,this);this._setRowHeight(c,h)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;var{updateCells:s,addCells:d,removeCells:u}=fixUpdateRowRange(s,e,t,this);null!=(r=this.reactCustomLayout)&&r.clearCache(),this.scenegraph.updateRow(u,d,s,i,!0),null!=(o=this.reactCustomLayout)&&o.updateAllCustomCell(),l&&(this.autoFillWidth&&!n&&(n=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!a&&(a=this.getAllRowsHeight()<=this.tableNoFrameHeight),\\\"adaptive\\\"===this.widthMode||n||\\\"adaptive\\\"===this.heightMode||a)&&this.scenegraph.updateChartSizeForResizeColWidth(-1)}_hasHierarchyTreeHeader(){var e;return null==(e=null!=(e=this.options.columns)?e:this.options.header)?void 0:e.some((e,t)=>e.tree)}getMenuInfo(e,t,i){return{field:this.getHeaderField(e,t),value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),event:void 0}}_getSortFuncFromHeaderOption(t,i,r){if(t=t||this.internalProps.columns,i&&t&&0<t.length)for(let e=0;e<t.length;e++){var o=t[e];if((r&&r===o.fieldKey||!r&&o.field===i)&&o.sort&&\\\"function\\\"==typeof o.sort)return o.sort;if(o.columns){o=this._getSortFuncFromHeaderOption(o.columns,i,r);if(o)return o}}}updateSortState(t,e=!0){var i;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let e=0;e<this.internalProps.sortState.length;e++)(t=null==(i=this.internalProps.sortState)?void 0:i[e])&&(t.order=\\\"normal\\\");else this.internalProps.sortState.order=\\\"normal\\\",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(e=>e.field)&&e&&this.internalProps.layoutMap.headerObjects.some(e=>!1!==e.define.sort)&&(this.dataSource.sort(t.map(t=>{var e=this._getSortFuncFromHeaderOption(this.internalProps.columns,t.field);return this.internalProps.layoutMap.headerObjects.find(e=>e&&e.field===t.field),{field:t.field,order:t.order,orderFn:null!=e?e:defaultOrderFn}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(e){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(e),sortRecords(this)):this.dataSource.updateFilterRules(e),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph()}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),isValid_default(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((e,t)=>Number(e)-Number(t)).map(e=>this.stateManager.checkedState.get(e));return this.options.groupBy&&(e=getGroupCheckboxState(this)),Array.from(e,e=>e[t])}return new Array(...this.stateManager.checkedState.values())}getCellCheckboxState(e,t){var i=this.getBodyColumnDefine(e,t),i=null==i?void 0:i.field,r=this.getCellType(e,t);if(isValid_default(i)&&(\\\"checkbox\\\"===r||\\\"switch\\\"===r))return r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(e,t)).toString(),null==(r=this.stateManager.checkedState.get(r))?void 0:r[i]}getRadioState(e){return isValid_default(e)?this.stateManager.radioState[e]:this.stateManager.radioState}getCellRadioState(e,t){return getCellRadioState(e,t,this)}setCellCheckboxState(e,t,i){setCellCheckboxState(e,t,i,this)}setCellRadioState(e,t,i){setCellRadioState(e,t,i,this)}getSwitchState(e){return this.getCheckboxState(e)}getCellSwitchState(e,t){return this.getCellCheckboxState(e,t)}setCellSwitchState(e,t,i){this.setCellCheckboxState(e,t,i)}setRecords(e,t){let i,r,o,n,a;null!=(i=this.internalProps.dataSource)&&i.release(),this.internalProps.releaseList=null==(r=this.internalProps.releaseList)?void 0:r.filter(e=>!e.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(t)||null!=t&&t.order?a=t:t?a=t.sortState:null===t&&(a=null),\\\"undefined\\\"!=typeof window&&window.performance.now();const l={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};var s;this.scenegraph.clearCells(),void 0!==a&&(null===a||!Array.isArray(a)&&isValid_default(a.field)||Array.isArray(a))&&(this.internalProps.sortState=!this.internalProps.multipleSort||Array.isArray(a)?a:[a],this.stateManager.setSortState(this.sortState)),e?(_setRecords(this,e),this.sortState&&(s=Array.isArray(this.sortState)?this.sortState:[this.sortState]).some(e=>e.order&&e.field&&\\\"normal\\\"!==e.order)&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(e=>!1!==e.define.sort)&&this.dataSource.sort(s.map(t=>{var e=this._getSortFuncFromHeaderOption(void 0,t.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(e=>e&&e.field===t.field),{field:t.field,order:t.order||\\\"asc\\\",orderFn:null!=e?e:defaultOrderFn}})),this.refreshRowColCount()):_setRecords(this,e),this.stateManager.initCheckedState(e),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(l.col,l.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(o=this.internalProps.emptyTip)&&o.resetVisible():(s=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new s(this.options.emptyTip,this),null!=(n=this.internalProps.emptyTip)&&n.resetVisible())),this.render(),isValid_default(l.col)&&isValid_default(l.row)&&0<=l.col&&0<=l.row&&setTimeout(()=>{var e;null!=(e=this.internalProps)&&e.tooltipHandler.showTooltip(l.col,l.row)},0)}setRecordChildren(e,t,i,r=!0){var o=this.getCellOriginRecord(t,i),n=(o.children=e,this.getRecordShowIndexByCell(t,i));this.dataSource.setRecord(o,n),this._refreshHierarchyState(t,i,r)}startEditCell(e,t,i){var r,o;isValid_default(e)&&isValid_default(t)?(this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,i)):null!=(r=this.stateManager.select)&&r.cellPos&&(({col:r,row:o}=this.stateManager.select.cellPos),isValid_default(r))&&isValid_default(o)&&this.editorManager.startEditCell(r,o,i)}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){var i,r=this.getBodyColumnDefine(e,t);let o=this.isHeader(e,t)?null!=(i=null==r?void 0:r.headerEditor)?i:this.options.headerEditor:null!=(i=null==r?void 0:r.editor)?i:this.options.editor;return\\\"string\\\"==typeof(o=\\\"function\\\"==typeof o?o({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||\\\"\\\",table:this}):o)?get4(o):o}isHasEditorDefine(e,t){var i,r=this.getBodyColumnDefine(e,t);let o=this.isHeader(e,t)?null!=(i=null==r?void 0:r.headerEditor)?i:this.options.headerEditor:null!=(i=null==r?void 0:r.editor)?i:this.options.editor;return\\\"function\\\"==typeof o&&(o=o({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||\\\"\\\",table:this})),isValid_default(o)}changeCellValue(e,t,i,r=!1){return listTableChangeCellValue(e,t,i,r,this)}changeCellValues(e,t,i,r=!1){return listTableChangeCellValues(e,t,i,r,this)}addRecord(e,t){var i;listTableAddRecord(e,t,this),null!=(i=this.internalProps.emptyTip)&&i.resetVisible()}addRecords(e,t){var i;listTableAddRecords(e,t,this),null!=(i=this.internalProps.emptyTip)&&i.resetVisible()}deleteRecords(e){var t;listTableDeleteRecords(e,this),null!=(t=this.internalProps.emptyTip)&&t.resetVisible()}updateRecords(e,t){listTableUpdateRecords(e,t,this)}_hasCustomRenderOrLayout(){var e,t=this.internalProps.layoutMap.headerObjects;if(this.options.customRender)return!0;for(let r=0;r<t.length;r++){var i=t[r];if(null!=(e=null==i?void 0:i.define)&&e.customLayout||null!=(e=null==i?void 0:i.define)&&e.headerCustomLayout||null!=(e=null==i?void 0:i.define)&&e.customRender||null!=(e=null==i?void 0:i.define)&&e.headerCustomRender)return!0}return!1}getAggregateValuesByField(e){var t=this.internalProps.layoutMap.getColumnByField(e),i=[];for(let n=0;n<t.length;n++){var r=t[n].columnDefine.aggregator;if(delete t[n].columnDefine,r){var o={col:t[n].col,aggregateValue:null};if(o.aggregateValue=[],Array.isArray(r))for(let e=0;e<r.length;e++)o.aggregateValue.push({aggregationType:r[e].type,value:r[e].value()});else o.aggregateValue.push({aggregationType:r.type,value:r.value()});i.push(o)}}return i}isAggregation(e,t){return this.internalProps.layoutMap.isAggregation(e,t)}getGroupTitleLevel(t,i){if(this.options.groupBy){var r=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,i)),o=null!=(o=this.dataSource.getGroupLength())?o:0;let e=isArray_default(r)?r.length-1:0;return e=0<o&&e===o?void 0:e}}getBodyRowIndexByRecordIndex(e){return Array.isArray(e)&&1===e.length&&(e=e[0]),this.dataSource.getTableIndex(e)}_parseColumnWidthConfig(e){for(let r=0;r<(null==e?void 0:e.length);r++){var t=e[r],i=t.key,t=t.width,i=this.internalProps.layoutMap.getColumnByKey(i);i.columnDefine&&(i=i.col,this.internalProps._widthResizedColMap.has(i)||(this._setColWidth(i,t),this.internalProps._widthResizedColMap.add(i)))}}release(){this.editorManager.release(),super.release()}},BaseMenu=(init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),class{constructor(e){this._table=e}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(e,t,i){return this._getMenuElement().bindToCell(this._table,e,t,i)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(e,t){return this._getMenuElement().pointInMenuElement(e,t)}getRootElement(){return this._getMenuElement().rootElement}}),CLASSNAME2=(init_esbuild_inject(),\\\"vtable__menu-element\\\"),HIDDEN_CLASSNAME2=CLASSNAME2+\\\"--hidden\\\",SHOWN_CLASSNAME2=CLASSNAME2+\\\"--shown\\\";function createMenuDomElement2(){return createElement(\\\"div\\\",[CLASSNAME2,HIDDEN_CLASSNAME2])}var MenuContainer=class{constructor(l){var e;this._handler=new EventHandler,this._rootElement=createMenuDomElement2(),this._rootElement.addEventListener(\\\"wheel\\\",e=>{e.stopPropagation()}),null!=(e=this._rootElement)&&e.addEventListener(\\\"mousedown\\\",e=>{e.stopPropagation(),e.preventDefault()}),null!=(e=this._rootElement)&&e.addEventListener(\\\"click\\\",e=>{var t,i,r,o,n,a;e.stopPropagation(),e.preventDefault(),this._rootElement.classList.contains(HIDDEN_CLASSNAME2)||(({col:t,row:i,dropDownIndex:a,menuKey:r,text:o,hasChildren:n}=e.target),\\\"number\\\"!=typeof a||n||(n=l.isPivotTable()?l.internalProps.layoutMap.getPivotDimensionInfo(t,i):l.getHeaderField(t,i),a=l._dropDownMenuIsHighlight(t,i,a),l.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLICK,{col:t,row:i,field:n,menuKey:r,text:o,highlight:a,cellLocation:l.getCellLocation(t,i),event:e}),l.fireListeners(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,null),l.fireListeners(TABLE_EVENT_TYPE.HIDE_MENU,null)),e.stopPropagation())}),null!=(e=this._rootElement)&&e.addEventListener(\\\"mousemove\\\",e=>{this._rootElement.classList.contains(HIDDEN_CLASSNAME2)||e.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();var e=this._rootElement;null!=e&&e.parentElement&&e.parentElement.removeChild(e),this._handler.release(),delete this._rootElement}bindToCell(e,t,i,r){var o=this._rootElement;if(this._menuInstanceInfo=r,null!=o&&o.classList.remove(SHOWN_CLASSNAME2),null!=o&&o.classList.add(HIDDEN_CLASSNAME2),this._canBindToCell(e,t,i)){if(o.innerHTML=\\\"\\\",o.appendChild(r.content),this._bindCell(e,t,i,r.position,r.referencePosition))return null!=o&&o.classList.add(SHOWN_CLASSNAME2),null!=o&&o.classList.remove(HIDDEN_CLASSNAME2),!0}else this.unbindFromCell();return!1}unbindFromCell(){var e=this._rootElement;this._menuInstanceInfo=void 0,null!=e&&e.parentElement&&(e.classList.remove(SHOWN_CLASSNAME2),e.classList.add(HIDDEN_CLASSNAME2))}_canBindToCell(e,t,i){var r=e.getCellRangeRelativeRect({col:t,row:i}),o=null!=(o=e.internalProps.menu.parentElement)?o:e.getElement(),{top:r,bottom:n,left:a,right:l}=r;return!!e.isFrozenCell(t,i)||!(n<e.getFrozenRowsHeight()||l<e.getFrozenColsWidth()||a>e.tableNoFrameWidth-e.getRightFrozenColsWidth()||r>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()||(({offsetHeight:n,offsetWidth:l}=o),n<r)||l<a)}_bindCell(o,e,t,n,a){var l=this._rootElement,s=null!=(s=o.internalProps.menu.parentElement)?s:o.getElement(),{width:h,height:d,left:u,top:c}=s.getBoundingClientRect();if(l){l.parentElement!==s&&s.appendChild(l),l.style.left=\\\"0px\\\";l.style.maxWidth=.8*h+\\\"px\\\";var g=l.clientWidth,p=l.clientHeight;let e,t,i=(n&&(e=n.x,t=n.y),a&&(e=a.rect.right-g,t=a.rect.bottom),t+p>d&&(t=d-p,e+=g-2),t<0&&(t/=2),0),r=0;return o.getElement()!==s&&(({left:d,top:p}=o.getElement().getBoundingClientRect()),i=p-c,r=d-u),l.style.top=t+i+\\\"px\\\",e<0?e=0:e+g>h&&(e=h-g),l.style.left=e+r+\\\"px\\\",!0}return!1}pointInMenuElement(e,t){var{x:i,y:r,width:o,height:n}=this._rootElement.getBoundingClientRect();return i-5<e&&e<i+o+5&&r-5<t&&t<r+n+5}},Menu=class extends BaseMenu{createMenuElementInternal(){return new MenuElement(this._table)}},Container2=class extends BaseMenu{createMenuElementInternal(){return new MenuContainer(this._table)}},MENU_INSTANCE_FACTORY={\\\"dropdown-menu\\\":function(e){return new Menu(e)},\\\"context-menu\\\":function(e){return new Menu(e)},container:e=>new Container2(e)};function getMenuInstanceInfo(t,i,r,o,e){var{lineHeight:n,textBaseline:a,textStick:l}=t._getCellStyle(i,r);let s=t.getCellRangeRelativeRect(t.getCellRange(i,r)),{left:h,right:d,bottom:u,top:c,width:g,height:p}=s=l?t.getVisibleCellRangeRelativeRect({col:i,row:r}):s;if(t.isHeader(i,r)&&({left:h,right:d,bottom:u,top:c,width:g,height:p}=t.internalProps.headerHelper.getDropDownIconRect(s,n,a||\\\"middle\\\")),null!=e&&e.content)return{type:o,position:e.position,referencePosition:null!=(l=e.referencePosition)?l:{rect:{left:h,right:d,top:c,bottom:u,width:g,height:p}},content:e.content};if(\\\"dropdown-menu\\\"!==o)return null;{let e=t.globalDropDownMenu;n=t._getHeaderLayoutMap(i,r),l=(e=null!=(a=n.dropDownMenu)?a:e,n.pivotInfo);return\\\"function\\\"==typeof e&&(e=e({row:r,col:i,table:t})),{type:o,referencePosition:{rect:{left:h,right:d,top:c,bottom:u,width:g,height:p}},content:e,pivotInfo:l}}}var MenuHandler2=class{constructor(e){this._table=e,this._menuInstances={},this._bindTableEvent(e)}release(){var e=this._menuInstances;for(const t in e)e[t].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(e,t,i,r){var o=this._attachInfo,n=this._getMenuInstanceInfo(e,t,i,r);!o||n&&o.instance===n.instance||(null!=(o=o.instance)&&o.unbindMenuElement(),this._attachInfo=null),n&&(({instance:o,info:n}=n),o)&&o.bindMenuElement(e,t,n)&&(n=this._table.getCellRange(e,t),this._attachInfo={range:n,instance:o})}_unbindFromCell(){var e=this._attachInfo;e&&(e=e.instance,null!=e&&e.unbindMenuElement(),this._attachInfo=null)}_isBindToCell(e,t){var i=this._attachInfo;return!!i&&cellInRange(i.range,e,t)}pointInMenuElement(e,t){var i;return!!this._attachInfo&&(i=this._attachInfo.instance,i.pointInMenuElement(e,t))}_bindTableEvent(o){o.on(TABLE_EVENT_TYPE.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,\\\"dropdown-menu\\\")}),o.on(TABLE_EVENT_TYPE.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),o.on(TABLE_EVENT_TYPE.CONTEXTMENU_CELL,t=>{var i;if(\\\"html\\\"===(null==(r=o.internalProps.menu)?void 0:r.renderMode)){var r=o._getMouseAbstractPoint(t.event,!1);let e=null;r.inTable&&\\\"function\\\"==typeof(null==(i=o.internalProps.menu)?void 0:i.contextMenuItems)?e=o.internalProps.menu.contextMenuItems(o.getHeaderField(t.col,t.row),t.row,t.col,o):r.inTable&&Array.isArray(null==(i=o.internalProps.menu)?void 0:i.contextMenuItems)&&(e=null==(i=o.internalProps.menu)?void 0:i.contextMenuItems),this._bindToCell(t.col,t.row,\\\"context-menu\\\",{content:e,position:{x:r.x,y:r.y}})}})}_getMenuInstanceInfo(e,t,i,r){var o=this._table,n=this._menuInstances,a=getMenuInstanceInfo(o,e,t,i,r);return a?{instance:n&&n[i]||n&&(n[i]=MENU_INSTANCE_FACTORY[i](o)),type:i,info:a}:null}containElement(e){var t;for(const i in this._menuInstances)if(null!=(t=this._menuInstances[i].getRootElement())&&t.contains(e))return!0;return!1}},registerMenu=()=>{Factory2.registerComponent(\\\"menuHandler\\\",MenuHandler2)};function createCellGroup(r,e,t,i,o,n,a,l,s,h,d,u,c,g,p,f,m,b,C){var v=r._getCellStyle(n,a),y=getFunctionalProp(\\\"padding\\\",v,n,a,r),y=(isValid_default(y)&&(d=y),null!=(y=null==m?void 0:m.text)&&y.textAlign&&(u=null==(y=null==m?void 0:m.text)?void 0:y.textAlign),null!=(y=null==m?void 0:m.text)&&y.textBaseline&&(c=null==(y=null==m?void 0:m.text)?void 0:y.textBaseline),r.isAutoRowHeight(a)),w=\\\"auto\\\"===l,_=null!=(_=v.autoWrapText)?_:r.internalProps.autoWrapText,v=v.lineClamp,S=getCellBorderStrokeWidth(n,a,m,r);let x;if(C&&(x=r.scenegraph.getCell(n,a,!0))&&\\\"cell\\\"===x.role&&x.setAttributes({x:i,y:o,width:s,height:h,lineWidth:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.lineWidth)?R:void 0,fill:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.fill)?R:void 0,stroke:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.stroke)?R:void 0,strokeArrayWidth:null!=S?S:void 0,strokeArrayColor:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.strokeArrayColor)?R:void 0,cursor:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.cursor)?R:void 0,lineDash:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.lineDash)?R:void 0,lineCap:\\\"butt\\\",clip:!0,cornerRadius:m.group.cornerRadius}),x&&\\\"cell\\\"===x.role||((x=new Group2({x:i,y:o,width:s,height:h,lineWidth:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.lineWidth)?R:void 0,fill:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.fill)?R:void 0,stroke:null!=(R=null==(R=null==m?void 0:m.group)?void 0:R.stroke)?R:void 0,strokeArrayWidth:null!=S?S:void 0,strokeArrayColor:null!=(S=null==(R=null==m?void 0:m.group)?void 0:R.strokeArrayColor)?S:void 0,cursor:null!=(S=null==(R=null==m?void 0:m.group)?void 0:R.cursor)?S:void 0,lineDash:null!=(S=null==(R=null==m?void 0:m.group)?void 0:R.lineDash)?S:void 0,lineCap:\\\"butt\\\",clip:!0,cornerRadius:m.group.cornerRadius})).role=\\\"cell\\\",x.col=n,x.row=a,null==t)||t.addCellGroup(x),p&&x.appendChild(p),f){var R=e;let i;if(g){let e=n,t=a;b&&(e=b.start.col,t=b.start.row),i=r.getCellIcons(e,t)}createCellContent(x,i,R,d,w,y,_,\\\"number\\\"==typeof v?v:void 0,x.attribute.width,x.attribute.height,u,c,r,m,b),null!=(S=null==m?void 0:m._vtable)&&S.marked&&((R=createArc({x:x.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:\\\"#3073F2\\\",pickable:!1})).name=\\\"mark\\\",x.appendChild(R))}return p&&x.setAttributes({width:Math.max(x.attribute.width,null!=(w=p.attribute.width)?w:0),height:Math.max(x.attribute.height,null!=(y=p.attribute.height)?y:0)}),x}init_esbuild_inject(),init_esbuild_inject();var registerTextCell=()=>{Factory2.registerFunction(\\\"createTextCellGroup\\\",createCellGroup)},ListTableSimple=(init_esbuild_inject(),registerTextCell(),class extends ListTable{});function diffCellAddress(e,t,i,r,o,n){var a,l=n.columnHeaderLevelCount,s=[],h=[];for(let g=0;g<i.length;g++)r.includes(i[g])||h.push(o[g]);for(let p=0;p<r.length;p++)i.includes(r[p])||(a={col:e,row:l+p},s.push(a));let d=n.getParentCellId(e,t),u=n.getRowHeaderCellAddressByCellId(d);var c=[];for(u&&c.push(u);d;)(d=n.getParentCellId(u.col,u.row))&&(u=n.getRowHeaderCellAddressByCellId(d),c.push(u));return{addCellPositionsRowDirection:s,removeCellPositionsRowDirection:h,updateCellPositionsRowDirection:c}}function diffCellAddressForGridTree(e,i,t,r,o,n){var a,l=n.columnHeaderLevelCount,s=[],h=[];for(let f=0;f<t.length;f++)r.includes(t[f])||h.push(o[f]);for(let m=0;m<r.length;m++)t.includes(r[m])||(a={col:e,row:l+m},s.push(a));let d=n.getParentCellId(e,i),u=n.getRowHeaderCellAddressByCellId(d);var c=[];for(u&&c.push(u);d;)(d=n.getParentCellId(u.col,u.row))&&(u=n.getRowHeaderCellAddressByCellId(d),c.push(u));var g=[],p=[];if(\\\"grid-tree\\\"===n.rowHierarchyType&&\\\"column\\\"===n.cornerSetting.titleOnDimension&&n.rowHeaderLevelCount!==n._cornerHeaderCellIds[0].length)if(n.rowHeaderLevelCount>n._cornerHeaderCellIds[0].length)for(let e=n._cornerHeaderCellIds[0].length;e<n.rowHeaderLevelCount;e++)g.push({col:e,row:i});else for(let t=n.rowHeaderLevelCount;t<n._cornerHeaderCellIds[0].length;t++)p.push({col:t,row:i});return{addCellPositionsRowDirection:s,removeCellPositionsRowDirection:h,updateCellPositionsRowDirection:c,addCellPositionsColumnDirection:g,removeCellPositionsColumnDirection:p}}function diffCellAddressForGridTreeOnColumn(i,e,t,r,o,n){var a,l=n.rowHeaderLevelCount,s=[],h=[];for(let f=0;f<t.length;f++)r.includes(t[f])||h.push(o[f]);for(let m=0;m<r.length;m++)t.includes(r[m])||(a={col:l+m,row:e},s.push(a));let d=n.getParentCellId(i,e),u=n.getRowHeaderCellAddressByCellId(d);var c=[];for(u&&c.push(u);u&&d;)(d=n.getParentCellId(u.col,u.row))&&(u=n.getRowHeaderCellAddressByCellId(d),c.push(u));var g=[],p=[];if(\\\"grid-tree\\\"===n.columnHierarchyType&&\\\"row\\\"===n.cornerSetting.titleOnDimension&&n.columnHeaderLevelCount!==n._cornerHeaderCellIds.length)if(n.columnHeaderLevelCount>n._cornerHeaderCellIds.length)for(let e=n._cornerHeaderCellIds.length;e<n.columnHeaderLevelCount;e++)g.push({col:i,row:e});else for(let t=n.columnHeaderLevelCount;t<n._cornerHeaderCellIds.length;t++)p.push({col:i,row:t});return{addCellPositionsColumnDirection:s,removeCellPositionsColumnDirection:h,updateCellPositionsColumnDirection:c,addCellPositionsRowDirection:g,removeCellPositionsRowDirection:p}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var defaultDimension={startInTotal:0,afterSpanLevel:0},PivotHeaderLayoutMap=class{constructor(e,t,i,r){var o;this.colIndex=0,this._showHeader=!0,this.columnHeaderObjs=[],this.rowHeaderObjs=[],this._cornerHeaderCellFullPathIds=[],this._columnHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds=[],this._rowHeaderCellFullPathIds_FULL=[],this._cornerHeaderCellIds=[],this._columnHeaderCellIds=[],this._rowHeaderCellIds=[],this._rowHeaderCellIds_FULL=[],this._columnWidths=[],this.columnPaths=[],this._headerObjects=[],this._headerObjectMap={},this._indicators=[],this.indicatorsAsCol=!0,this.hideIndicatorName=!1,this._showRowHeader=!0,this._showColumnHeader=!0,this._indicatorShowType=\\\"column\\\",this.rowHierarchyTextStartAlignment=!1,this.rowDimensionKeys=[],this.colDimensionKeys=[],this.indicatorKeys=[],this.indicatorDimensionKey=IndicatorDimensionKeyPlaceholder,this._rowHeaderExtensionTree={},this._extensionRowDimensionKeys=[],this.fullRowDimensionKeys=[],this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this._useGetBodyCache=!1,this._getBodyCache=new Map,this._useHeaderPathCache=!1,this._colHeaderPathCache=new Map,this._rowHeaderPathCache=new Map,this.sharedVar=e.layoutNodeId,\\\"tree\\\"===(this._table=e).options.rowHierarchyType&&(this.extensionRows=e.options.extensionRows),this.dataset=t,this._largeCellRangeCache=[],this._CellHeaderPathMap=new Map,this.rowTree=e.internalProps.rowTree,this.columnTree=e.internalProps.columnTree,this.rowsDefine=null!=(o=e.internalProps.rows)?o:[],this.columnsDefine=null!=(o=e.internalProps.columns)?o:[],this.indicatorsDefine=null!=(o=e.internalProps.indicators)?o:[],this.indicatorTitle=e.options.indicatorTitle,this.indicatorsAsCol=null==(o=e.options.indicatorsAsCol)||o,this.hideIndicatorName=null!=(o=e.options.hideIndicatorName)&&o,this.showRowHeader=null==(o=e.options.showRowHeader)||o,this.showColumnHeader=null==(o=e.options.showColumnHeader)||o,this.rowHeaderTitle=e.options.rowHeaderTitle,this.columnHeaderTitle=e.options.columnHeaderTitle,this.rowHierarchyType=null!=(o=e.options.rowHierarchyType)?o:\\\"grid\\\",this.columnHierarchyType=null!=(o=e.options.columnHierarchyType)?o:\\\"grid\\\",this.rowExpandLevel=null!=(o=e.options.rowExpandLevel)?o:1,this.columnExpandLevel=null!=(o=e.options.columnExpandLevel)?o:1,this.rowHierarchyIndent=null!=(o=e.options.rowHierarchyIndent)?o:20,this.rowHierarchyTextStartAlignment=e.options.rowHierarchyTextStartAlignment,this.cornerSetting=Object.assign({titleOnDimension:\\\"column\\\",forceShowHeader:!1},e.options.corner),null!=(o=null==(o=this._table.options)?void 0:o.customConfig)&&o.enablePivotPathCache&&(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()),t&&(this.rowTree=t.rowHeaderTree,this.columnTree=t.colHeaderTree),null!=(o=this.indicatorsDefine)&&o.forEach(e=>{\\\"string\\\"==typeof e?this.indicatorKeys.push(e):this.indicatorKeys.push(e.indicatorKey)}),this.columnDimensionTree=i,this.rowDimensionTree=r,this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),this.resetRowHeaderLevelCount(),this._table.isPivotChart()&&(this.hasTwoIndicatorAxes=this.indicatorsDefine.some(e=>{if(e.chartSpec&&e.chartSpec.series&&1<e.chartSpec.series.length){var t=null!=(t=null!=(t=e.chartSpec.axes)?t:this._table.pivotChartAxes)?t:[];if(!t.length||t.every(e=>e.orient!==(this.indicatorsAsCol?\\\"top\\\":\\\"right\\\")||!1!==e.visible))return!0}return!1})),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=transpose(this._rowHeaderCellFullPathIds_FULL),\\\"tree\\\"===e.options.rowHierarchyType&&1<=(null==(o=this.extensionRows)?void 0:o.length)&&(this.generateExtensionRowTree(),this.extensionRows.forEach(e=>{const t=[];e.rows.forEach(e=>{\\\"string\\\"==typeof e?t.push(e):t.push(e.dimensionKey)}),this._extensionRowDimensionKeys.push(t),this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(t)})),this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length);let n,a=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),l=(!this.dataset||this._table.isPivotChart()||0!==(null!=(o=null==(o=this.dataset.records)?void 0:o.length)?o:0)||this.dataset.customColTree||(a=this.columnsDefine.map(e=>\\\"string\\\"==typeof e?e:e.dimensionKey),this.indicatorsAsCol&&a.push(this.indicatorDimensionKey)),a=this.columnHeaderTitle?[\\\"\\\"].concat(a):a,[]);if(\\\"tree\\\"===this.rowHierarchyType&&1<=(null==(o=this.extensionRows)?void 0:o.length)){const s=[];s.push(this.rowDimensionKeys[0]),this._extensionRowDimensionKeys.forEach(e=>{s.push(e[0])}),l=this.extensionRows.reduce((e,t)=>e.concat(t.rows),[]),n=this.rowHeaderTitle?[\\\"\\\"].concat(s):s}else n=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),!this.dataset||this._table.isPivotChart()||0!==(null!=(o=null==(o=this.dataset.records)?void 0:o.length)?o:0)||this.dataset.customRowTree||(n=this.rowsDefine.map(e=>\\\"string\\\"==typeof e?e:e.dimensionKey),this.indicatorsAsCol)||n.push(this.indicatorDimensionKey),n=this.rowHeaderTitle?[\\\"\\\"].concat(n):n;this.cornerHeaderObjs=this._addCornerHeaders(a,n,this.columnsDefine.concat(...this.rowsDefine,...l)),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this.indicatorsAsCol&&!this.hideIndicatorName?this._indicatorShowType=\\\"column\\\":this.indicatorsAsCol||this.hideIndicatorName?this._indicatorShowType=\\\"none\\\":this._indicatorShowType=\\\"row\\\",this.generateCellIdsConsiderHideHeader(),this.setPagination(e.options.pagination),this._table.isPivotChart()&&(this._chartItemSpanSize=0,this._chartItemBandSize=0,this._indicators.find(e=>{null!=(i=null==e?void 0:e.style)&&i.padding&&(this._chartPadding=e.style.padding),null!=(i=e.chartSpec)&&i.barWidth&&\\\"number\\\"==typeof e.chartSpec.barWidth&&(this._chartItemSpanSize=null==(i=e.chartSpec)?void 0:i.barWidth);var t,i=null==(i=null==(i=e.chartSpec)?void 0:i.axes)?void 0:i.find(e=>\\\"band\\\"===e.type);return null!=i&&i.bandSize&&(this._chartItemBandSize=null==i?void 0:i.bandSize,this._chartPaddingInner=null!=(t=isArray_default(i.paddingInner)?i.paddingInner[0]:i.paddingInner)?t:0,this._chartPaddingOuter=null!=(t=isArray_default(i.paddingOuter)?i.paddingOuter[0]:i.paddingOuter)?t:0),0<this._chartItemSpanSize||(null!=(i=e.chartSpec.series)&&i.find(e=>(e.barWidth&&\\\"number\\\"==typeof e.barWidth&&(this._chartItemSpanSize=e.barWidth),0<this._chartItemSpanSize)),!1)})),this.handleRowSeriesNumber(e.internalProps.rowSeriesNumber),this.setColumnWidths()}handleRowSeriesNumber(e){var t;e&&(Array.isArray(e)?this.rowSeriesNumberColumn=e.map(e=>{var t;return{id:\\\"\\\",title:e.title,define:e,cellType:null!=(t=e.cellType)?t:\\\"text\\\",headerType:null!=(t=e.cellType)?t:\\\"text\\\",width:e.width,style:e.style,format:e.format,field:e.field,icon:e.icon}}):this.rowSeriesNumberColumn=[{id:\\\"\\\",title:e.title,define:e,cellType:null!=(t=e.cellType)?t:\\\"text\\\",headerType:null!=(t=e.cellType)?t:\\\"text\\\",style:e.style,width:e.width,format:e.format,field:\\\"\\\",icon:e.icon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(e=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}_generateColHeaderIds(){var e,t;if(1<=(null==(e=this.columnDimensionTree.tree.children)?void 0:e.length))if(\\\"grid-tree\\\"===this.columnHierarchyType)this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(e=null==(e=this.dataset.records)?void 0:e.length)?e:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&this.indicatorsAsCol&&this._getColumnHeaderTreeExpandedMaxLevelCount()<this.columnHeaderLevelCount){t=this.columnHeaderLevelCount-this._getColumnHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._columnHeaderCellFullPathIds.unshift([])}this._addHeaders(this._columnHeaderCellFullPathIds,t,this.columnDimensionTree.tree.children,[],this.columnHeaderObjs)}this.columnHeaderTitle&&(this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length),e=++this.sharedVar.seqId,t=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(e),this._columnHeaderCellFullPathIds.unshift(t),t={id:e,title:\\\"string\\\"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((e,t)=>\\\"string\\\"==typeof t?e:e+(e?\\\"/\\\"+t.title:\\\"\\\"+t.title),\\\"\\\"),field:void 0,headerType:null!=(t=null==(t=this.columnHeaderTitle)?void 0:t.headerType)?t:\\\"text\\\",style:null==(t=this.columnHeaderTitle)?void 0:t.headerStyle,define:{id:e,disableHeaderHover:!(null==(t=this.columnHeaderTitle)||!t.disableHeaderHover),disableHeaderSelect:!(null==(t=this.columnHeaderTitle)||!t.disableHeaderSelect)}},this.columnHeaderObjs.push(t),this._headerObjects[e]=t)}_generateRowHeaderIds(){var e,t;if(1<=(null==(e=this.rowDimensionTree.tree.children)?void 0:e.length))if(\\\"tree\\\"===this.rowHierarchyType)this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs);else if(\\\"grid-tree\\\"===this.rowHierarchyType)this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0);else{let t=0;if(this.dataset&&!this._table.isPivotChart()&&0===(null!=(e=null==(e=this.dataset.records)?void 0:e.length)?e:0)&&!this.dataset.customColTree&&!this.dataset.customRowTree&&!this.indicatorsAsCol&&this._getRowHeaderTreeExpandedMaxLevelCount()<this.rowHeaderLevelCount){t=this.rowHeaderLevelCount-this._getRowHeaderTreeExpandedMaxLevelCount();for(let e=0;e<t;e++)this._rowHeaderCellFullPathIds_FULL.unshift([])}this._addHeaders(this._rowHeaderCellFullPathIds_FULL,t,this.rowDimensionTree.tree.children,[],this.rowHeaderObjs)}this.rowHeaderTitle&&(this.sharedVar.seqId=Math.max(this.sharedVar.seqId,this._headerObjects.length),e=++this.sharedVar.seqId,t=Array(null!=(t=null==(t=this._rowHeaderCellFullPathIds_FULL[0])?void 0:t.length)?t:this.rowDimensionTree.tree.size).fill(e),this._rowHeaderCellFullPathIds_FULL.unshift(t),t={id:e,title:\\\"string\\\"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((e,t)=>\\\"string\\\"==typeof t?e:e+(e?\\\"/\\\"+t.title:\\\"\\\"+t.title),\\\"\\\"),field:void 0,headerType:null!=(t=null==(t=this.rowHeaderTitle)?void 0:t.headerType)?t:\\\"text\\\",style:null==(t=this.rowHeaderTitle)?void 0:t.headerStyle,define:{id:e,disableHeaderHover:!(null==(t=this.rowHeaderTitle)||!t.disableHeaderHover),disableHeaderSelect:!(null==(t=this.rowHeaderTitle)||!t.disableHeaderSelect)}},this.rowHeaderObjs.push(t),this._headerObjects[e]=t)}_getRowHeaderTreeExpandedMaxLevelCount(){return\\\"tree\\\"===this.rowHierarchyType?1:\\\"grid-tree\\\"!==this.rowHierarchyType||\\\"row\\\"===this.cornerSetting.titleOnDimension?this.rowDimensionTree.totalLevel:this.indicatorsAsCol?this.rowDimensionTree.expandedMaxLevel:this.rowDimensionTree.expandedMaxLevel+1}_getColumnHeaderTreeExpandedMaxLevelCount(){return\\\"grid-tree\\\"!==this.columnHierarchyType||\\\"column\\\"===this.cornerSetting.titleOnDimension?this.columnDimensionTree.totalLevel:!1===this.indicatorsAsCol?this.columnDimensionTree.expandedMaxLevel:this.columnDimensionTree.expandedMaxLevel+1}_addHeaders(t,e,i,r,o){const n=this;if(!t[e]){var a=e,l=t[a]=[];if(0!==n.colIndex){var s=t[a-1];for(let e=0;e<(null==s?void 0:s.length);e++)l[e]=s[e]}}for(let h=0;h<i.length;h++)dealHeader(i[h],t,o,r,e,this)}_addHeadersForTreeMode(t,e,i,r,o,n,a,l){const s=this;if(!t[e]){var h=e,d=t[h]=[];if(0!==s.colIndex){var u=t[h-1];for(let e=0;e<(null==u?void 0:u.length);e++)d[e]=u[e]}}for(let c=0;c<i.length;c++)dealHeaderForTreeMode(i[c],t,l,r,e,o,n,a,this)}_addHeadersForGridTreeMode(t,e,i,r,o,n,a,l,s,h){const d=this;if(!t[e]){var u=e,c=t[u]=[];if(0!==d.colIndex){var g=t[u-1];for(let e=0;e<(null==g?void 0:g.length);e++)c[e]=g[e]}}for(let p=0;p<i.length;p++)dealHeaderForGridTreeMode(i[p],t,s,r,e,o,n,a,l,h,this.indicatorsAsCol,this)}_addCornerHeaders(i,r,n){var o,t,a,l;this._cornerHeaderCellFullPathIds=[];const s=[],h=\\\"grid-tree\\\"===this.columnHierarchyType&&this._getColumnHeaderTreeExpandedMaxLevelCount()||this.columnHeaderLevelCount,d=\\\"grid-tree\\\"===this.rowHierarchyType&&this._getRowHeaderTreeExpandedMaxLevelCount()||this.rowHeaderLevelCount;if(\\\"all\\\"===this.cornerSetting.titleOnDimension)if(this.indicatorsAsCol){if(i)for(let t=0;t<h;t++){const c=i[t],g=++this.sharedVar.seqId,p=n.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===c),f={id:g,title:c===this.indicatorDimensionKey?this.indicatorTitle:p?p.title:\\\"axis\\\"===c?\\\"\\\":c,field:c,style:this.cornerSetting.headerStyle,headerType:null!=(o=this.cornerSetting.headerType)?o:\\\"text\\\",showSort:null==p?void 0:p.showSortInCorner,sort:null==p?void 0:p.sort,define:{showSort:null==p?void 0:p.showSortInCorner,sort:null==p?void 0:p.sort,dimensionKey:c,id:g,value:c,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==p?void 0:p.cornerDropDownMenu,headerIcon:null==p?void 0:p.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==p?void 0:p.title)?o:\\\"\\\",dimensionKey:c,isPivotCorner:!0},description:null==p?void 0:p.cornerDescription};s[g]=f,this._headerObjects[g]=f,this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]);for(let e=0;e<d;e++)this._cornerHeaderCellFullPathIds[t][e]=g}if(r)for(let e=0;e<d;e++){const m=r[e],b=++this.sharedVar.seqId,C=n.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===m),v={id:b,title:m===this.indicatorDimensionKey?this.indicatorTitle:C?C.title:\\\"axis\\\"===m?\\\"\\\":m,field:m,style:this.cornerSetting.headerStyle,headerType:null!=(t=this.cornerSetting.headerType)?t:\\\"text\\\",showSort:null==C?void 0:C.showSortInCorner,sort:null==C?void 0:C.sort,define:{showSort:null==C?void 0:C.showSortInCorner,sort:null==C?void 0:C.sort,dimensionKey:m,id:b,value:m,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==C?void 0:C.cornerDropDownMenu,headerIcon:null==C?void 0:C.cornerHeaderIcon,pivotInfo:{value:null!=(t=null==C?void 0:C.title)?t:\\\"\\\",dimensionKey:m,isPivotCorner:!0},description:null==C?void 0:C.cornerDescription};s[b]=v,this._headerObjects[b]=v,this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]||(this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1]=[]),this._cornerHeaderCellFullPathIds[this._cornerHeaderCellFullPathIds.length-1][e]=b}}else{if(r)for(let t=0;t<d;t++){const y=r[t],w=++this.sharedVar.seqId,_=n.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===y),S={id:w,title:y===this.indicatorDimensionKey?this.indicatorTitle:_?_.title:\\\"axis\\\"===y?\\\"\\\":y,field:y,style:this.cornerSetting.headerStyle,headerType:null!=(a=this.cornerSetting.headerType)?a:\\\"text\\\",showSort:null==_?void 0:_.showSortInCorner,sort:null==_?void 0:_.sort,define:{showSort:null==_?void 0:_.showSortInCorner,sort:null==_?void 0:_.sort,dimensionKey:y,id:w,value:y,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==_?void 0:_.cornerDropDownMenu,headerIcon:null==_?void 0:_.cornerHeaderIcon,pivotInfo:{value:null!=(a=null==_?void 0:_.title)?a:\\\"\\\",dimensionKey:y,isPivotCorner:!0},description:null==_?void 0:_.cornerDescription};s[w]=S,this._headerObjects[w]=S;for(let e=0;e<h;e++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][t]=w}if(i)for(let e=0;e<h;e++){const x=i[e],R=++this.sharedVar.seqId,T=n.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===x),A={id:R,title:x===this.indicatorDimensionKey?this.indicatorTitle:T?T.title:\\\"axis\\\"===x?\\\"\\\":x,field:x,style:this.cornerSetting.headerStyle,headerType:null!=(l=this.cornerSetting.headerType)?l:\\\"text\\\",showSort:null==T?void 0:T.showSortInCorner,sort:null==T?void 0:T.sort,define:{showSort:null==T?void 0:T.showSortInCorner,sort:null==T?void 0:T.sort,dimensionKey:x,id:R,value:x,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==T?void 0:T.cornerDropDownMenu,headerIcon:null==T?void 0:T.cornerHeaderIcon,pivotInfo:{value:null!=(l=null==T?void 0:T.title)?l:\\\"\\\",dimensionKey:x,isPivotCorner:!0},description:null==T?void 0:T.cornerDescription};s[R]=A,this._headerObjects[R]=A,this._cornerHeaderCellFullPathIds[e][this._cornerHeaderCellFullPathIds[e].length-1]=R}}else if(\\\"row\\\"===this.cornerSetting.titleOnDimension||\\\"column\\\"===this.cornerSetting.titleOnDimension){var e=\\\"row\\\"===(null==(e=this.cornerSetting)?void 0:e.titleOnDimension)?r:i;e&&e.forEach((t,i)=>{var r=++this.sharedVar.seqId,e=n.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t),o={id:r,title:t===this.indicatorDimensionKey?this.indicatorTitle:e?e.title:\\\"axis\\\"===t?\\\"\\\":t,field:t,style:this.cornerSetting.headerStyle,headerType:null!=(o=this.cornerSetting.headerType)?o:\\\"text\\\",showSort:null==e?void 0:e.showSortInCorner,sort:null==e?void 0:e.sort,define:{showSort:null==e?void 0:e.showSortInCorner,sort:null==e?void 0:e.sort,dimensionKey:t,id:r,value:t,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,headerEditor:this.cornerSetting.headerEditor,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect},dropDownMenu:null==e?void 0:e.cornerDropDownMenu,headerIcon:null==e?void 0:e.cornerHeaderIcon,pivotInfo:{value:null!=(o=null==e?void 0:e.title)?o:\\\"\\\",dimensionKey:t,isPivotCorner:!0},description:null==e?void 0:e.cornerDescription};if(s[r]=o,this._headerObjects[r]=o,\\\"column\\\"===this.cornerSetting.titleOnDimension){this._cornerHeaderCellFullPathIds[i]||(this._cornerHeaderCellFullPathIds[i]=[]);for(let e=0;e<this.rowHeaderLevelCount;e++)this._cornerHeaderCellFullPathIds[i][e]=r}else if(\\\"row\\\"===this.cornerSetting.titleOnDimension)for(let e=0;e<this.columnHeaderLevelCount;e++)this._cornerHeaderCellFullPathIds[e]||(this._cornerHeaderCellFullPathIds[e]=[]),this._cornerHeaderCellFullPathIds[e][i]=r})}else{var u=++this.sharedVar.seqId,e={id:u,title:\\\"\\\",field:\\\"维度名称\\\",style:this.cornerSetting.headerStyle,headerType:null!=(e=this.cornerSetting.headerType)?e:\\\"text\\\",define:{dimensionKey:\\\"维度名称\\\",id:u,headerCustomRender:this.cornerSetting.customRender,headerCustomLayout:this.cornerSetting.customLayout,disableHeaderHover:!!this.cornerSetting.disableHeaderHover,disableHeaderSelect:!!this.cornerSetting.disableHeaderSelect}};s[u]=e,this._headerObjects[u]=e;for(let t=0;t<this.columnHeaderLevelCount;t++)for(let e=0;e<this.rowHeaderLevelCount;e++)this._cornerHeaderCellFullPathIds[t]||(this._cornerHeaderCellFullPathIds[t]=[]),this._cornerHeaderCellFullPathIds[t][e]=u}return s}generateExtensionRowTree(){this.extensionRows.forEach((s,e)=>{var t=this._rowHeaderCellFullPathIds_FULL;this._rowHeaderCellFullPathIds_FULL=[],t.forEach((e,t)=>{var i,r=e[e.length-1];let o,n;this.colIndex=0,o=\\\"function\\\"==typeof s.rowTree?(i=this.findFullCellIds(e),s.rowTree(i.map(e=>({dimensionKey:this._headerObjects[e].field,value:this._headerObjects[e].title})))):cloneDeep(s.rowTree),this._rowHeaderExtensionTree[r]?(this._rowHeaderExtensionTree[r].reset(this._rowHeaderExtensionTree[r].tree.children),n=this._rowHeaderExtensionTree[r]):(n=new DimensionTree(null!=o?o:[],this.sharedVar,this.rowHierarchyType,void 0),this._rowHeaderExtensionTree[r]=n);var a=[];this._addHeadersForTreeMode(a,0,n.tree.children,[],n.totalLevel,!0,s.rows,this.rowHeaderObjs);for(let l=0;l<a[0].length;l++)this._rowHeaderCellFullPathIds_FULL.push(e.concat(a[0][l]))})})}setColumnWidths(){var t;const l=new Array(this.colCount).fill(void 0);if(this.leftRowSeriesNumberColumnCount&&(l[0]=this.leftRowSeriesNumberColumn[0]),this.showHeader&&this.showRowHeader)if(this.rowHeaderTitle&&(l[0+this.leftRowSeriesNumberColumnCount]={}),\\\"tree\\\"===this.rowHierarchyType){const r=this.rowDimensionKeys[0];r&&(t=null==(t=this.rowsDefine)?void 0:t.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===r))&&(l[0+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}),null!=(t=this._extensionRowDimensionKeys)&&t.forEach((e,t)=>{var i;const r=e[0];r&&(i=null==(i=this.extensionRows[t].rows)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===r))&&(l[t+1+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:i.width,minWidth:i.minWidth,maxWidth:i.maxWidth})})}else(0<this.rowDimensionTree.totalLevel?this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr():this.rowsDefine.map(e=>\\\"string\\\"==typeof e?e:e.dimensionKey)).forEach((t,e)=>{var i=null==(i=this.rowsDefine)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t);i&&(l[e+(this.rowHeaderTitle?1:0)+this.leftRowSeriesNumberColumnCount]={width:i.width,minWidth:i.minWidth,maxWidth:i.maxWidth})});if(this.indicatorsAsCol)for(let e=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount;e<this.colCount;e++){var i=this.getBody(e,this.columnHeaderLevelCount);l[e]={width:null==i?void 0:i.width,minWidth:null==i?void 0:i.minWidth,maxWidth:null==i?void 0:i.maxWidth}}else{let r,o,n,a=0;null!=(t=this._indicators)&&t.forEach((e,t)=>{var i;\\\"number\\\"==typeof e.width?a=Math.max(e.width,a):\\\"auto\\\"===e.width&&(n=!0),\\\"number\\\"==typeof e.minWidth&&(o=Math.max(e.minWidth,null!=(i=o)?i:0)),\\\"number\\\"==typeof e.maxWidth&&(r=Math.min(e.maxWidth,null!=(i=r)?i:Number.MAX_VALUE))}),a=0<a?a:n?\\\"auto\\\":void 0,l.fill({width:a,minWidth:o,maxWidth:r},this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,this.colCount-this.rightFrozenColCount)}this._columnWidths=l}get columnWidths(){return this._columnWidths}getColumnWidthDefined(e){return this._columnWidths[e]}get showHeader(){return this._showHeader}set showHeader(e){this._showHeader=e}get showColumnHeader(){return this._showColumnHeader}set showColumnHeader(e){this._showColumnHeader=e}get showRowHeader(){return this._showRowHeader}set showRowHeader(e){this._showRowHeader=e}get columnHeaderTitle(){return this._columnHeaderTitle}set columnHeaderTitle(e){this._columnHeaderTitle=e}get rowHeaderTitle(){return this._rowHeaderTitle}set rowHeaderTitle(e){this._rowHeaderTitle=e}getHeaderFieldKey(e,t){}getCellLocation(e,t){return this.isCornerHeader(e,t)?\\\"cornerHeader\\\":this.isColumnHeader(e,t)?\\\"columnHeader\\\":this.isRowHeader(e,t)?\\\"rowHeader\\\":\\\"body\\\"}isHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||0<=t&&t<this.columnHeaderLevelCount||e>=this.colCount-this.rightHeaderColCount||t>=this.rowCount-this.bottomHeaderRowCount}isCornerHeader(e,t){return 0<=e&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&0<=t&&t<this.columnHeaderLevelCount}isColumnHeader(e,t){return e>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&0<=t&&t<this.columnHeaderLevelCount}isRowHeader(e,t){return e>=this.leftRowSeriesNumberColumnCount&&e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount&&t>=this.columnHeaderLevelCount}isFrozen(e,t){return this.isFrozenColumn(e)||this.isRightFrozenColumn(e)||this.isBottomFrozenRow(t)||this.isFrozenRow(t)||this.isSeriesNumberInBody(e,t)||this.isSeriesNumberInHeader(e,t)}isFrozenColumn(e,t){if(isValid_default(t)){if(0<=e&&e<this.frozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(0<this.frozenColCount&&0<=e&&e<this.frozenColCount)return!0;return!1}isRightFrozenColumn(e,t){if(isValid_default(t)){if(e>=this.colCount-this.rightFrozenColCount&&t>=this.frozenRowCount&&t<this.rowCount-this.bottomFrozenRowCount)return!0}else if(0<this.rightFrozenColCount&&e>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(e,t){if(isValid_default(t)){if(0<=t&&t<this.frozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,0<this.frozenRowCount&&0<=t&&t<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(e,t){if(isValid_default(t)){if(t>=this.rowCount-this.bottomFrozenRowCount&&e>=this.frozenColCount&&e<this.colCount-this.rightFrozenColCount)return!0}else if(t=e,0<this.bottomFrozenRowCount&&t>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(e,t){return 0<=e&&e<this.frozenColCount&&0<=t&&t<this.frozenRowCount}isLeftBottomCorner(e,t){return 0<=e&&e<this.frozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&0<=t&&t<this.frozenRowCount}isRightBottomCorner(e,t){return e>=this.colCount-this.rightFrozenColCount&&t>=this.rowCount-this.bottomFrozenRowCount}getColumnHeaderRange(){return{start:{col:this.rowHeaderLevelCount,row:0},end:{col:this.colCount-1,row:this.columnHeaderLevelCount-1}}}getRowHeaderRange(){return{start:{col:0,row:this.columnHeaderLevelCount},end:{col:this.rowHeaderLevelCount-1,row:this.rowCount-1}}}getCornerHeaderRange(){return{start:{col:0,row:0},end:{col:this.rowHeaderLevelCount-1,row:this.columnHeaderLevelCount-1}}}getBodyRange(){return{start:{col:this.rowHeaderLevelCount,row:this.columnHeaderLevelCount},end:{col:this.colCount-1,row:this.rowCount-1}}}resetCellIds(){}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get headerLevelCount(){return this.columnHeaderLevelCount}resetColumnHeaderLevelCount(){var t;if(this.showHeader&&this.showColumnHeader){if(this._table.isPivotChart()&&this.indicatorsAsCol&&(null==(t=null==(t=this.dataset)?void 0:t.colKeys)||!t.length)&&0===(null==(t=null==(t=this.columnDimensionTree)?void 0:t.tree)?void 0:t.level)&&!this.hasTwoIndicatorAxes)return void(this.columnHeaderLevelCount=0);let e=this._getColumnHeaderTreeExpandedMaxLevelCount();this.indicatorsAsCol&&this.hideIndicatorName&&this.colDimensionKeys[this.colDimensionKeys.length-1]===this.indicatorDimensionKey&&e--,0!==e||!this.dataset||null!=(t=this.dataset.customColTree)&&t.length?!this.dataset||this._table.isPivotChart()||0!==(null!=(t=null==(t=this.dataset.records)?void 0:t.length)?t:0)||this.dataset.customColTree||\\\"column\\\"!==this.cornerSetting.titleOnDimension&&\\\"all\\\"!==this.cornerSetting.titleOnDimension||(e=null!=(t=this.columnsDefine.length)?t:0,!this.hideIndicatorName&&this.indicatorsAsCol&&e++):\\\"row\\\"===this.cornerSetting.titleOnDimension&&this.cornerSetting.forceShowHeader?e=1:this._table.isPivotChart()||0!==(null!=(t=null==(t=this.dataset.records)?void 0:t.length)?t:0)||\\\"column\\\"!==this.cornerSetting.titleOnDimension&&\\\"all\\\"!==this.cornerSetting.titleOnDimension||(e=null!=(t=this.columnsDefine.length)?t:0),this.columnHeaderTitle&&(e+=1),this._table.isPivotChart()&&this.indicatorsAsCol&&!this.hasTwoIndicatorAxes&&checkHasCartesianChart(this.indicatorsDefine)&&--e,void(this.columnHeaderLevelCount=e)}else this.columnHeaderLevelCount=!this.indicatorsAsCol||this.hideIndicatorName?0:1}resetRowHeaderLevelCount(){var t;if(this.showHeader&&this.showRowHeader){if(\\\"tree\\\"===this.rowHierarchyType)return i=null!=(i=null==(i=this.extensionRows)?void 0:i.length)?i:0,this.rowHeaderTitle?void(this.rowHeaderLevelCount=2+i):void(this.rowHeaderLevelCount=1+i);var i=this._getRowHeaderTreeExpandedMaxLevelCount();let e=i;0!==e||!this.dataset||null!=(t=this.dataset.customRowTree)&&t.length?!this.dataset||this._table.isPivotChart()||0!==(null!=(t=null==(t=this.dataset.records)?void 0:t.length)?t:0)||this.dataset.customRowTree||\\\"row\\\"!==this.cornerSetting.titleOnDimension&&\\\"all\\\"!==this.cornerSetting.titleOnDimension||(e=this.rowsDefine.length,this.hideIndicatorName)||this.indicatorsAsCol||e++:\\\"column\\\"===this.cornerSetting.titleOnDimension&&this.cornerSetting.forceShowHeader?e=1:this._table.isPivotChart()||0!==(null!=(t=null==(t=this.dataset.records)?void 0:t.length)?t:0)||\\\"row\\\"!==this.cornerSetting.titleOnDimension&&\\\"all\\\"!==this.cornerSetting.titleOnDimension||(e=null!=(t=this.rowsDefine.length)?t:0),!this.indicatorsAsCol&&this.hideIndicatorName&&this.rowDimensionKeys[this.rowDimensionKeys.length-1]===this.indicatorDimensionKey&&(e=i-1),this.rowHeaderTitle&&(e+=1),void(this.rowHeaderLevelCount=e)}else this.rowHeaderLevelCount=this.indicatorsAsCol||this.hideIndicatorName?0:1}get columnHeaderLevelCount(){return this._columnHeaderLevelCount}set columnHeaderLevelCount(e){this._columnHeaderLevelCount=e}get rowHeaderLevelCount(){return this._rowHeaderLevelCount}set rowHeaderLevelCount(e){this._rowHeaderLevelCount=e}get colCount(){var e;return(0<this._getColumnHeaderTreeExpandedMaxLevelCount()||this._table.isPivotChart()||0<(null==(e=this.dataset.records)?void 0:e.length)||this.dataset.records&&!Array.isArray(this.dataset.records)?null!=(e=null==(e=this._columnHeaderCellIds[0])?void 0:e.length)?e:this.columnDimensionTree.tree.size:0)+this.rowHeaderLevelCount+this.rightHeaderColCount+this.leftRowSeriesNumberColumnCount}get rowCount(){var e;return((this._table.records||this.dataset.records)&&(!Array.isArray(this._table.records)||0<this._table.records.length)&&0<(null==(e=this._indicators)?void 0:e.length)&&(null==(e=this._rowHeaderCellIds)||!e.length)?1:null!=(e=null==(e=this._rowHeaderCellIds)?void 0:e.length)?e:0)+this.columnHeaderLevelCount+this.bottomHeaderRowCount}get bodyRowSpanCount(){return this.rowDimensionTree.tree.size}get bottomFrozenRowCount(){var e;return this._table.isPivotChart()?!(1<=this.indicatorKeys.length&&checkHasCartesianChart(this.indicatorsDefine))||!1===(null==(e=this._table.pivotChartAxes.find(e=>\\\"bottom\\\"===e.orient))?void 0:e.visible)?0:(this.indicatorsAsCol,1):this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){var e;return this._table.isPivotChart()?!1!==(null==(e=this._table.pivotChartAxes.find(e=>\\\"right\\\"===e.orient))?void 0:e.visible)&&!this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0:this._table.internalProps.rightFrozenColCount?this.colCount-this.rowHeaderLevelCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:this.colCount-this.rowHeaderLevelCount:0}get bodyRowCount(){return this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount}get headerObjects(){return this._headerObjects}get columnObjects(){return this._indicators}getCellId(e,t){var i;if(0<=t&&0<=e)return this.isSeriesNumber(e,t)?\\\"\\\":this.isCornerHeader(e,t)?null==(i=this._cornerHeaderCellIds[t])?void 0:i[e-this.leftRowSeriesNumberColumnCount]:this.isColumnHeader(e,t)?null==(i=this._columnHeaderCellIds[t])?void 0:i[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]:this.isRowHeader(e,t)?null==(i=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])?void 0:i[e-this.leftRowSeriesNumberColumnCount]:this.isRightFrozenColumn(e,t)?null==(i=this._rowHeaderCellIds[t-this.columnHeaderLevelCount])?void 0:i[this.rowHeaderLevelCount-1]:!this.isBottomFrozenRow(e,t)||null==(i=this._columnHeaderCellIds[this.columnHeaderLevelCount-1])?void 0:i[e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount]}getHeader(e,t){var i;return this.isSeriesNumberInHeader(e,t)?this.getSeriesNumberHeader(e,t):(i=this.getCellId(e,t),null!=(i=this._headerObjectMap[i])?i:{id:void 0,field:\\\"\\\",headerType:\\\"text\\\",define:void 0})}getHeaderField(e,t){var i=this.getCellId(e,t);return(null==(i=this._headerObjectMap[i])?void 0:i.field)||(null==(i=this.getBody(e,t))?void 0:i.field)}getHeaderCellAdressById(t){for(let n=0;n<this._columnHeaderCellIds.length;n++){var i=this._columnHeaderCellIds[n];for(let e=0;e<i.length;e++)if(i[e]===t)return{col:e+this._table.frozenColCount,row:n}}for(let a=0;a<this._rowHeaderCellIds.length;a++){var r=this._rowHeaderCellIds[a];for(let e=0;e<r.length;e++)if(r[e]===t)return{col:e,row:a+this._table.frozenRowCount}}for(let l=0;l<this._cornerHeaderCellIds.length;l++){var o=this._cornerHeaderCellIds[l];for(let e=0;e<o.length;e++)if(o[e]===t)return{col:e,row:l}}}getHeaderCellAddressByField(t){var e=this.headerObjects.find(e=>e&&e.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(e,t){var i,r=this.getBodyWidthCache(e,t);if(r)return r;if(this.isSeriesNumber(e,t))return r=this.getSeriesNumberBody(e,t),this.setBodyWidthCache(e,t,r),r;var r=this.getCellHeaderPaths(e,t);if(this.indicatorsAsCol){const a=null==(i=null==(i=r.colHeaderPaths)?void 0:i.find(e=>e.indicatorKey))?void 0:i.indicatorKey,l=isValid_default(a)&&null!=(i=null!=(i=null==(i=this._indicators)?void 0:i.find(e=>e.indicatorKey===a))?i:this._indicators[0])?i:{id:\\\"\\\",field:void 0,indicatorKey:void 0,cellType:\\\"text\\\",define:void 0};return this.setBodyWidthCache(e,t,l),l}const o=null==(r=null==(i=r.rowHeaderPaths)?void 0:i.find(e=>e.indicatorKey))?void 0:r.indicatorKey,n=isValid_default(o)&&null!=(i=null!=(r=null==(i=this._indicators)?void 0:i.find(e=>e.indicatorKey===o))?r:this._indicators[0])?i:{id:\\\"\\\",field:void 0,indicatorKey:void 0,cellType:\\\"text\\\",define:void 0};return this.setBodyWidthCache(e,t,n),n}getCellRange(o,n){var a,l,s={start:{col:o,row:n},end:{col:o,row:n}};if(this.isHeader(o,n)&&-1!==o&&-1!==n&&!this.isRightFrozenColumn(o,n)&&!this.isBottomFrozenRow(o,n)){if(this._table.isPivotChart()){if(this.isLeftBottomCorner(o,n))return{start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.frozenColCount-1,row:this.rowCount-1}};if(this.isRightTopCorner(o,n))return{start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}};if(this.isRightBottomCorner(o,n))return{start:{col:this.colCount-this.rightFrozenColCount,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}}}for(let e=0;e<this._largeCellRangeCache.length;e++){var t=this._largeCellRangeCache[e];if(o>=t.start.col&&o<=t.end.col&&n>=t.start.row&&n<=t.end.row)return t}if(this.isHeader(o,n)&&-1!==o&&-1!==n){var h=this.getCellId(o,n);for(let e=o-1;0<=e&&h===this.getCellId(e,n);e--)s.start.col=e;for(let t=o+1;t<(null!=(a=this.colCount)?a:0)&&h===this.getCellId(t,n);t++)s.end.col=t;for(let i=n-1;0<=i&&h===this.getCellId(o,i);i--)s.start.row=i;for(let r=n+1;r<(null!=(l=this.rowCount)?l:0)&&!(h!==this.getCellId(o,r)||this.isSeriesNumberInHeader(o,n)&&r>=this.columnHeaderLevelCount);r++)s.end.row=r}(100<s.end.col-s.start.col||100<s.end.row-s.start.row)&&this._largeCellRangeCache.push(s)}return s}isCellRangeEqual(e,t,i,r){var o=this.getCellRange(e,t),n=this.getCellRange(i,r);return o.start.col===n.start.col&&o.end.col===n.end.col&&o.start.row===n.start.row&&o.end.row===n.end.row}getBodyIndexByRow(e){return e<this.columnHeaderLevelCount||e>=this.rowCount-this.bottomHeaderRowCount?-1:e-this.columnHeaderLevelCount}get bottomHeaderRowCount(){return this._table.isPivotChart()?this.bottomFrozenRowCount:0}get rightHeaderColCount(){return this._table.isPivotChart()?this.rightFrozenColCount:0}getBodyIndexByCol(e){return e<this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount||e>=this.colCount-this.rightHeaderColCount?-1:e-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount}getRecordStartRowByRecordIndex(e){return this.columnHeaderLevelCount+e}getRecordShowIndexByCell(e,t){}getCellHeaderPathsWithTreeNode(e,t){for(let c=0;c<this._largeCellRangeCache.length;c++){var i=this._largeCellRangeCache[c];if(e>=i.start.col&&e<=i.end.col&&t>=i.start.row&&t<=i.end.row){c;break}}let r=this.getColHeaderPathCache(e,t),o=this.getRowHeaderPathCache(e,t);const n=this.getBodyIndexByCol(e),a=this.getBodyIndexByRow(t)+this.currentPageStartIndex;if(!r&&0<=t&&0<=n){if(r=[],\\\"grid-tree\\\"===this.columnHierarchyType){const g=[];this._columnHeaderCellFullPathIds.map(e=>{g.push(e[n])});var l=this.getTreePathByCellIds(g);r.push(...l)}else r=this.columnDimensionTree.getTreePath(n,this.showHeader&&this.showColumnHeader?t-(this.columnHeaderTitle?1:0):this.columnDimensionTree.totalLevel);this.setColHeaderPathCache(e,t,r)}if(!o&&0<=e&&0<=a){if(o=[],\\\"tree\\\"===this.rowHierarchyType){var s=this._rowHeaderCellFullPathIds[a];let t=this.rowDimensionTree,i=0;for(;t;){var h=[];let e=s[i];for(h.push(e);;){var d=this._headerObjectMap[e];if(null==d||!d.parentCellId)break;h.unshift(d.parentCellId),e=d.parentCellId}var u=this.getTreePathByCellIds(h);o.push(...u),t=this._rowHeaderExtensionTree[s[i]],i++}}else\\\"grid-tree\\\"===this.rowHierarchyType?(l=this._rowHeaderCellFullPathIds[a],l=this.getTreePathByCellIds(l),o.push(...l)):o=this.rowDimensionTree.getTreePath(a,this.showHeader&&this.showRowHeader?e-(this.rowHeaderTitle?1:0)-this.leftRowSeriesNumberColumnCount:this.rowDimensionTree.totalLevel);this.setRowHeaderPathCache(e,t,o)}return{colHeaderPaths:r,rowHeaderPaths:o,cellLocation:this.getCellLocation(e,t)}}getTreePathByCellIds(e){var t=[];for(let r=0;r<e.length;r++){var i=e[r];0<r&&i===e[r-1]||null!=(i=this._headerObjects[i])&&i.define&&t.push(i.define)}return t}getCellHeaderPaths(e,t){var i;const r=this.getCellHeaderPathsWithTreeNode(e,t),o={colHeaderPaths:[],rowHeaderPaths:[],cellLocation:r.cellLocation};return null!=(i=r.colHeaderPaths)&&i.forEach(e=>{var t,i={};i.dimensionKey=e.dimensionKey,i.indicatorKey=e.indicatorKey,i.value=null!=(t=null!=(t=e.value)?t:null==(t=this.getIndicatorInfoByIndicatorKey(e.indicatorKey))?void 0:t.title)?t:\\\"\\\",i.virtual=e.virtual,i.role=e.role,o.colHeaderPaths.push(i)}),null!=(i=r.rowHeaderPaths)&&i.forEach(e=>{var t,i;\\\"axis\\\"!==e.dimensionKey&&((i={}).dimensionKey=e.dimensionKey,i.indicatorKey=e.indicatorKey,i.value=null!=(t=null!=(t=e.value)?t:null==(t=this.getIndicatorInfoByIndicatorKey(e.indicatorKey))?void 0:t.title)?t:\\\"\\\",i.virtual=e.virtual,i.role=e.role,o.rowHeaderPaths.push(i))}),o}getIndicatorInfoByIndicatorKey(t){var e;return null==(e=this.indicatorsDefine)?void 0:e.find(e=>\\\"string\\\"!=typeof e&&!!t&&e.indicatorKey===t)}findFullCellIds(t){var i=[];for(let o=0;o<t.length;o++){let e=t[o];for(i.push(e);;){var r=this._headerObjectMap[e];if(null==r||!r.parentCellId)break;i.unshift(r.parentCellId),e=r.parentCellId}}return i}getHeaderDimension(e,t){var i;if(this.isHeader(e,t)){const r=this.getHeader(e,t);return null!=(i=null==(i=this.rowsDefine)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===r.field))?i:null==(i=this.columnsDefine)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===r.field)}}isColumnIndicatorHeader(e,t){return\\\"column\\\"===this._indicatorShowType&&t===this.columnHeaderLevelCount-1&&e>=this.rowHeaderLevelCount}isRowIndicatorHeader(e,t){return\\\"row\\\"===this._indicatorShowType&&e===this.rowHeaderLevelCount-1&&t>=this.columnHeaderLevelCount}isIndicatorHeader(e,t){return this.isColumnIndicatorHeader(e,t)||this.isRowIndicatorHeader(e,t)}toggleHierarchyState(i,e){var t,r;this.colIndex=0;const o=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount,n=this._rowHeaderCellFullPathIds_FULL.slice(0),a=n.map((e,t)=>({col:i,row:t+this.columnHeaderLevelCount})),l=this.getHeader(i,e);l.define.hierarchyState=l.define.hierarchyState===HierarchyState.collapse?HierarchyState.expand:HierarchyState.collapse,this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this.resetRowHeaderLevelCount(),this._rowHeaderCellFullPathIds_FULL=[],this.rowDimensionKeys=this.rowDimensionTree.dimensionKeysIncludeVirtual.valueArr(),this.fullRowDimensionKeys=[],this.fullRowDimensionKeys=this.fullRowDimensionKeys.concat(this.rowDimensionKeys),\\\"tree\\\"===this.rowHierarchyType?this._addHeadersForTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,!0,this.rowsDefine,this.rowHeaderObjs):\\\"grid-tree\\\"===this.rowHierarchyType&&(this._addHeadersForGridTreeMode(this._rowHeaderCellFullPathIds_FULL,0,this.rowDimensionTree.tree.children,[],this.rowDimensionTree.totalLevel,this._getRowHeaderTreeExpandedMaxLevelCount(),!0,this.rowsDefine,this.rowHeaderObjs,!0),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.rowHeaderTitle&&(t=++this.sharedVar.seqId,r=Array(this.rowCount-this.columnHeaderLevelCount).fill(t),this._rowHeaderCellFullPathIds_FULL.unshift(r),r={id:t,title:\\\"string\\\"==typeof this.rowHeaderTitle.title?this.rowHeaderTitle.title:this.rowsDefine.reduce((e,t)=>\\\"string\\\"==typeof t?e:e+(e?\\\"/\\\"+t.title:\\\"\\\"+t.title),\\\"\\\"),field:void 0,headerType:null!=(r=null==(r=this.rowHeaderTitle)?void 0:r.headerType)?r:\\\"text\\\",style:null==(r=this.rowHeaderTitle)?void 0:r.headerStyle,define:{field:\\\"\\\",headerType:\\\"text\\\",cellType:\\\"text\\\",disableHeaderHover:!(null==(r=this.rowHeaderTitle)||!r.disableHeaderHover),disableHeaderSelect:!(null==(r=this.rowHeaderTitle)||!r.disableHeaderSelect)}},this.rowHeaderObjs.push(r),this._headerObjects[t]=r);let s;if(this._rowHeaderCellFullPathIds_FULL=transpose(this._rowHeaderCellFullPathIds_FULL),\\\"tree\\\"===this.rowHierarchyType&&1<=(null==(t=this.extensionRows)?void 0:t.length)&&this.generateExtensionRowTree(),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,\\\"tree\\\"===this.rowHierarchyType)s=diffCellAddress(i,e,n.map(e=>e[i-this.leftRowSeriesNumberColumnCount]),this._rowHeaderCellFullPathIds_FULL.map(e=>e[i-this.leftRowSeriesNumberColumnCount]),a,this);else{const h=(this.indicatorsAsCol?this.rowHeaderLevelCount-1:this.rowHeaderLevelCount-2)-this.leftRowSeriesNumberColumnCount;s=diffCellAddressForGridTree(i,e,n.map(e=>e[o]),this._rowHeaderCellFullPathIds_FULL.map(e=>e[h]),a,this)}return this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination),\\\"grid-tree\\\"===this.rowHierarchyType&&this.setColumnWidths(),s}toggleHierarchyStateForColumnTree(e,i){this.colIndex=0;var t=this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1,r=this._columnHeaderCellFullPathIds.slice(0),o=r[this.columnHeaderLevelCount-1].map((e,t)=>({col:t+this.rowHeaderLevelCount,row:i})),n=this.getHeader(e,i),n=(n.define.hierarchyState=n.define.hierarchyState===HierarchyState.collapse?HierarchyState.expand:HierarchyState.collapse,this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this.resetColumnHeaderLevelCount(),this._columnHeaderCellFullPathIds=[],this.colDimensionKeys=this.columnDimensionTree.dimensionKeysIncludeVirtual.valueArr(),\\\"grid-tree\\\"===this.columnHierarchyType&&(this._addHeadersForGridTreeMode(this._columnHeaderCellFullPathIds,0,this.columnDimensionTree.tree.children,[],this.columnDimensionTree.totalLevel,this._getColumnHeaderTreeExpandedMaxLevelCount(),!0,this.columnsDefine,this.columnHeaderObjs,!1),this.cornerHeaderObjs=this._addCornerHeaders(this.colDimensionKeys,this.rowDimensionKeys,this.columnsDefine.concat(...this.rowsDefine))),this.columnHeaderTitle&&(n=++this.sharedVar.seqId,a=Array(this.colCount-this.rowHeaderLevelCount-this.rightFrozenColCount).fill(n),this._columnHeaderCellFullPathIds.unshift(a),a={id:n,title:\\\"string\\\"==typeof this.columnHeaderTitle.title?this.columnHeaderTitle.title:this.columnsDefine.reduce((e,t)=>\\\"string\\\"==typeof t?e:e+(e?\\\"/\\\"+t.title:\\\"\\\"+t.title),\\\"\\\"),field:void 0,headerType:null!=(a=null==(a=this.columnHeaderTitle)?void 0:a.headerType)?a:\\\"text\\\",style:null==(a=this.columnHeaderTitle)?void 0:a.headerStyle,define:{id:n,disableHeaderHover:!(null==(a=this.columnHeaderTitle)||!a.disableHeaderHover),disableHeaderSelect:!(null==(a=this.columnHeaderTitle)||!a.disableHeaderSelect)}},this.columnHeaderObjs.push(a),this._headerObjects[n]=a),this.colIndex=0,this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.indicatorsAsCol?this.columnHeaderLevelCount-2:this.columnHeaderLevelCount-1),a=diffCellAddressForGridTreeOnColumn(e,i,r[t],this._columnHeaderCellFullPathIds[n],o,this);return this.generateCellIdsConsiderHideHeader(),\\\"grid-tree\\\"===this.columnHierarchyType&&this.setColumnWidths(),a}isHeaderForColWidth(e,t){return this.isHeader(e,t)}getHeaderForColWidth(e,t){return this.getHeader(e,t)}getPivotCellAdress(l){var s,h;if(Array.isArray(l)){let i,r,o=this.rowTree,n=this.columnTree;for(let a=0;a<l.length;a++){var d=l[a];if((d.isPivotCorner||!isValid_default(d.value))&&a===l.length-1){if(\\\"row\\\"===(null==(u=null==this?void 0:this.cornerSetting)?void 0:u.titleOnDimension)){let e=0;return-1===(e=\\\"grid\\\"===this.rowHierarchyType?this.rowDimensionKeys.indexOf(d.dimensionKey):e)?void 0:{col:(this.rowHeaderTitle?e+1:e)+this.leftRowSeriesNumberColumnCount,row:0}}var u=this.colDimensionKeys.indexOf(d.dimensionKey);return-1===u?void 0:{col:0+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderTitle?u+1:u}}let t=!1;for(let e=0;e<n.length;e++){var c=n[e];if((isValid_default(d.dimensionKey)&&c.dimensionKey===d.dimensionKey||isValid_default(d.indicatorKey)&&c.indicatorKey===d.indicatorKey)&&c.value===d.value){n=c.children,r=c,t=!0;break}}if(!t)for(let e=0;e<o.length;e++){var g=o[e];if((isValid_default(d.dimensionKey)&&g.dimensionKey===d.dimensionKey||isValid_default(d.indicatorKey)&&g.indicatorKey===d.indicatorKey)&&g.value===d.value){o=g.children,i=g;break}}}let e=0,t=0;return i?(t=this.columnHeaderLevelCount,({startInTotal:s,afterSpanLevel:h}=i),t+=s,{col:e=\\\"grid\\\"===this.rowHierarchyType?(this.rowHeaderTitle?h+1:h)+this.leftRowSeriesNumberColumnCount:0+this.leftRowSeriesNumberColumnCount,row:t}):r?(e=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,({startInTotal:s,afterSpanLevel:h}=r),e+=s,t=this.columnHeaderTitle?h+1:h,{col:e,row:t}):void 0}}getPivotDimensionInfo(e,t){let i,{colHeaderPaths:r,rowHeaderPaths:o}=this.getCellHeaderPaths(e,t),n=[];return r.length?r.forEach((e,t)=>{n.push({dimensionKey:e.dimensionKey,value:e.value,isPivotCorner:!1,indicatorKey:e.indicatorKey})}):o.length?o.forEach((e,t)=>{n.push({dimensionKey:e.dimensionKey,value:e.value,isPivotCorner:!1,indicatorKey:e.indicatorKey})}):this.isCornerHeader(e,t)&&(\\\"row\\\"===(null==(i=null==this?void 0:this.cornerSetting)?void 0:i.titleOnDimension)?n.push({dimensionKey:this.rowDimensionKeys[(this.rowHeaderTitle?e-1:e)-this.leftRowSeriesNumberColumnCount],isPivotCorner:!0}):n.push({dimensionKey:this.colDimensionKeys[this.columnHeaderTitle?t-1:t],isPivotCorner:!0})),n}getIndicatorKey(e,t){var i;return null==(i=this.getBody(e,t))?void 0:i.indicatorKey}getParentCellId(e,t){if(0!==t)return this.isColumnHeader(e,t)?this.getCellId(e,t-1):this.isRowHeader(e,t)?this.getCellId(e-1,t):void 0}getRowHeaderCellAddressByCellId(i){let r,o;if(this._rowHeaderCellIds.find((e,t)=>!!e.find((e,t)=>e===i&&(r=t,!0))&&(o=t,!0)),isValid_default(r)&&isValid_default(o))return{col:r,row:o+this.columnHeaderLevelCount}}canMoveHeaderPosition(e,t){if(!(this.isSeriesNumberInHeader(t.col,t.row)||this.isSeriesNumberInHeader(e.col,e.row)||this.isCornerHeader(t.col,t.row)||e.col<0||e.row<0||t.col<0||t.row<0)){this.isSeriesNumberInBody(t.col,t.row)&&this.isSeriesNumberInBody(e.col,e.row)&&(e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1);var i=this.getCellRange(e.col,e.row);if(this.isColumnHeader(e.col,e.row))return this.getParentCellId(e.col,i.start.row)===this.getParentCellId(t.col,i.start.row);if(this.isRowHeader(e.col,e.row)){if(\\\"tree\\\"!==this.rowHierarchyType)return this.getParentCellId(i.start.col,e.row)===this.getParentCellId(i.start.col,t.row);{const r=cloneDeep(this.getCellHeaderPathsWithTreeNode(e.col,e.row).rowHeaderPaths),o=cloneDeep(this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths);if(r.pop(),o.pop(),r.length<=o.length){if(r.length===o.length)return!r.find((e,t)=>e.dimensionKey!==o[t].dimensionKey||e.value!==o[t].value);if(0<r.length)for(let e=0;e<r.length;e++)if(r[e].startInTotal!==o[e].startInTotal)return!1;return!0}}}}return!1}moveHeaderPosition(t,i){if((null!=(s=this._table.options.dragOrder)&&s.validateDragOrderOnEnd(t,i)||null==(s=this._table.options.dragOrder)||!s.validateDragOrderOnEnd)&&this.canMoveHeaderPosition(t,i)&&!this.isCellRangeEqual(t.col,t.row,i.col,i.row)){var e,r,o,n,a=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){var l=a.end.col-a.start.col+1,s=this.getCellRange(i.col,a.start.row),h=i.col>=t.col?s.end.col-l+1:s.start.col;if(h===a.start.col)return null;for(let e=0;e<this._columnHeaderCellFullPathIds.length;e++){var d=this._columnHeaderCellFullPathIds[e].splice(a.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,l);d.unshift(h-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnHeaderCellFullPathIds[e],d)}var u=this._columnWidths.splice(a.start.col-this.leftRowSeriesNumberColumnCount,l);return u.unshift(h-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columnWidths,u),this.columnDimensionTree.movePosition(this.getCellHeaderPathsWithTreeNode(t.col,t.row).colHeaderPaths.length-1,a.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount,s.start.col-this.rowHeaderLevelCount-this.leftRowSeriesNumberColumnCount),this.columnDimensionTree.reset(this.columnDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:a.start.col,targetIndex:h,sourceSize:l,targetSize:s.end.col-s.start.col+1,moveType:\\\"column\\\"}}if(this.isRowHeader(t.col,t.row))return u=this.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths,s=this.getCellHeaderPathsWithTreeNode(i.col,i.row).rowHeaderPaths,e=u[u.length-1],s=s[u.length-1],r=e.size,(o=i.row>=t.row?s.startInTotal+s.size-r:s.startInTotal)===a.start.row-this.columnHeaderLevelCount?null:((n=this._rowHeaderCellIds.splice(a.start.row-this.columnHeaderLevelCount,r)).unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellIds,n),(n=this._rowHeaderCellFullPathIds.splice(a.start.row-this.columnHeaderLevelCount,r)).unshift(o-this.currentPageStartIndex,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds,n),(n=this._rowHeaderCellIds_FULL.splice(a.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,r)).unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellIds_FULL,n),(n=this._rowHeaderCellFullPathIds_FULL.splice(a.start.row-this.columnHeaderLevelCount+this.currentPageStartIndex,r)).unshift(o,0),Array.prototype.splice.apply(this._rowHeaderCellFullPathIds_FULL,n),this.rowDimensionTree.movePosition(u.length-1,a.start.row-this.columnHeaderLevelCount,o+(i.row>t.row?e.size-1:0)),this.rowDimensionTree.reset(this.rowDimensionTree.tree.children),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,{sourceIndex:a.start.row,targetIndex:o+this.columnHeaderLevelCount,sourceSize:r,targetSize:s.size,moveType:\\\"row\\\"})}return null}getCellAdressByHeaderPath(e){let d,u,c,g,p,f,m,b,C=!1,v=!1;if(Array.isArray(e)){if(e.length>this.rowDimensionKeys.length+this.colDimensionKeys.length)return;m=e.filter(e=>0<=this.colDimensionKeys.indexOf(e.dimensionKey)||0<=this.colDimensionKeys.indexOf(this.indicatorDimensionKey)&&e.indicatorKey),b=e.filter(e=>0<=this.rowDimensionKeys.indexOf(e.dimensionKey)||0<=this.rowDimensionKeys.indexOf(this.indicatorDimensionKey)&&e.indicatorKey)}else m=e.colHeaderPaths,b=e.rowHeaderPaths,\\\"body\\\"===(null==e?void 0:e.cellLocation)&&this._table.isPivotTable()&&(v=!0);if(Array.isArray(m)||Array.isArray(b)){if(null!=m&&m.sort((e,t)=>{var i;return this.colDimensionKeys.indexOf(null!=(i=e.dimensionKey)?i:this.indicatorDimensionKey)-this.colDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)}),null!=b&&b.sort((e,t)=>{var i;return this.fullRowDimensionKeys.indexOf(null!=(i=e.dimensionKey)?i:this.indicatorDimensionKey)-this.fullRowDimensionKeys.indexOf(null!=(i=t.dimensionKey)?i:this.indicatorDimensionKey)}),null!=m&&m.forEach(e=>{e.isPivotCorner&&(C=!0)}),null!=b&&b.forEach(e=>{e.isPivotCorner&&(C=!0)}),C)if(\\\"all\\\"===this.cornerSetting.titleOnDimension&&this.indicatorsAsCol&&0===m.length){for(let e=0;e<this.rowDimensionKeys.length;e++)if((null==(d=b[0])?void 0:d.dimensionKey)===this.rowDimensionKeys[e])return{col:e+this.leftRowSeriesNumberColumnCount,row:this.columnHeaderLevelCount-1}}else if(\\\"all\\\"!==this.cornerSetting.titleOnDimension||this.indicatorsAsCol||0!==b.length){if(\\\"row\\\"===this.cornerSetting.titleOnDimension||\\\"all\\\"===this.cornerSetting.titleOnDimension&&!this.indicatorsAsCol){for(let e=0;e<this.rowDimensionKeys.length;e++)if((null==(c=b[0])?void 0:c.dimensionKey)===this.rowDimensionKeys[e])return{col:e+this.leftRowSeriesNumberColumnCount,row:0}}else for(let t=0;t<this.colDimensionKeys.length;t++)if((null==(g=m[0])?void 0:g.dimensionKey)===this.colDimensionKeys[t])return{col:0,row:t}}else for(let e=0;e<this.colDimensionKeys.length;e++)if((null==(u=m[0])?void 0:u.dimensionKey)===this.colDimensionKeys[e])return{col:this.rowHeaderLevelCount-1,row:e};let e,i,t,r,o=!1,n=!1;1<=(null==m?void 0:m.length)&&1<=(null==b?void 0:b.length)&&(o=!0,n=!0),m.length>=this.columnHeaderLevelCount&&(o=!0),b.length>=this.rowHeaderLevelCount&&(n=!0);let a,l,s=this.rowTree,h=this.columnTree;if(m)for(let t=0;t<m.length;t++){var y=m[t];for(let e=0;e<h.length;e++){var w=h[e];if(!isValid_default(y.indicatorKey)&&w.dimensionKey===y.dimensionKey&&w.value===y.value||isValid_default(y.indicatorKey)&&w.indicatorKey===y.indicatorKey&&(isValid_default(w.value)&&isValid_default(y.value)&&y.value===w.value||!isValid_default(w.value)||!isValid_default(y.value))){h=w.children,(!o||null!=h&&h.length)&&o||(l=w);break}}}if(1<=(null==b?void 0:b.length))if(\\\"tree\\\"===this.rowHierarchyType){const T=b[b.length-1],A=this.headerObjects.filter(e=>((null==e?void 0:e.field)===T.dimensionKey||(null==e?void 0:e.field)===T.indicatorKey)&&(null==e?void 0:e.title)===T.value).map(e=>e.id),P=this._rowHeaderCellIds.filter(e=>0<=A.indexOf(e[e.length-1])).find(e=>{var t=this.findFullCellIds(e);return t.length===b.length&&t.every(e=>{const t=this._headerObjectMap[e];return b.find(e=>e.dimensionKey===t.field&&e.value===t.title)})});i=this._rowHeaderCellIds.indexOf(P)+this.columnHeaderLevelCount}else for(let t=0;t<b.length;t++){var _=b[t];for(let e=0;e<s.length;e++){var S=s[e];if(!isValid_default(_.indicatorKey)&&S.dimensionKey===_.dimensionKey&&S.value===_.value||isValid_default(_.indicatorKey)&&S.indicatorKey===_.indicatorKey&&(!isValid_default(_.value)||S.value===_.value)){s=S.children,(!n||null!=s&&s.length&&!s.some(e=>\\\"axis\\\"===e.dimensionKey))&&n||(a=S);break}}}var x,R;return(v||!o||!n||(a||isValid_default(i))&&l)&&((a||v)&&(i=this.columnHeaderLevelCount,({startInTotal:x,afterSpanLevel:R}=null!=(p=a)?p:defaultDimension),i+=null!=x?x:0,t=\\\"grid\\\"===this.rowHierarchyType?(this.rowHeaderTitle?R+1:R)+this.leftRowSeriesNumberColumnCount:0),(l||v)&&(e=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount,({startInTotal:x,afterSpanLevel:R}=null!=(f=l)?f:defaultDimension),e+=null!=x?x:0,r=this.columnHeaderTitle?R+1:R),isValid_default(e)||isValid_default(i))?{col:null!=e?e:t,row:null!=i?i:r}:void 0}}setChartInstance(e,t,i){var r,o=this.getCellHeaderPaths(e,t);let n;if(this.indicatorsAsCol){const a=null==(r=o.colHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=null==(r=this._indicators)?void 0:r.find(e=>e.indicatorKey===a)}else{const l=null==(r=o.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:r.indicatorKey;n=null==(o=this._indicators)?void 0:o.find(e=>e.indicatorKey===l)}\\\"function\\\"!=typeof(null==n?void 0:n.chartSpec)&&n&&(n.chartInstance=i)}getChartInstance(e,t){var i,r=this.getCellHeaderPaths(e,t);let o;if(this.indicatorsAsCol){const n=null==(i=r.colHeaderPaths.find(e=>e.indicatorKey))?void 0:i.indicatorKey;o=null==(i=this._indicators)?void 0:i.find(e=>e.indicatorKey===n)}else{const a=null==(i=r.rowHeaderPaths.find(e=>e.indicatorKey))?void 0:i.indicatorKey;o=null==(r=this._indicators)?void 0:r.find(e=>e.indicatorKey===a)}return null==o?void 0:o.chartInstance}checkHasChart(){return checkHasChart(this)}getDimension(t,e){var i;return\\\"column\\\"===e?null==(i=this.columnsDefine)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t):\\\"row\\\"!==e||null==(i=this.rowsDefine)?void 0:i.find(e=>\\\"string\\\"!=typeof e&&e.dimensionKey===t)}getAxisConfigInPivotChart(e,t){if((this.isFrozenColumn(e,t)||this.isRightFrozenColumn(e,t))&&isHasCartesianChartInline(e,t,\\\"row\\\",this)||(this.isFrozenRow(e,t)||this.isBottomFrozenRow(e,t))&&isHasCartesianChartInline(e,t,\\\"col\\\",this)){var i=Factory2.getFunction(\\\"getAxisConfigInPivotChart\\\")(e,t,this);if(!1!==(null==i?void 0:i.visible))return i}}isEmpty(e,t){return!(!this._table.isPivotChart()||!this.isLeftBottomCorner(e,t)&&!this.isRightBottomCorner(e,t)&&!this.isRightTopCorner(e,t))}isAxisCell(e,t){if(this._table.isPivotChart()&&1<=this.indicatorKeys.length&&checkHasCartesianChart(this.indicatorsDefine)){if(this.isBottomFrozenRow(e,t)&&isHasCartesianChartInline(e,t,\\\"col\\\",this)||this.isRightFrozenColumn(e,t)&&isHasCartesianChartInline(e,t,\\\"row\\\",this))return!0;if(this.isRowHeader(e,t)&&e===this.rowHeaderLevelCount-1&&isHasCartesianChartInline(e,t,\\\"row\\\",this))return!0;if(this.hasTwoIndicatorAxes&&this.indicatorsAsCol&&t===this.columnHeaderLevelCount-1&&isHasCartesianChartInline(e,t,\\\"col\\\",this))return!0}return!1}getChartAxes(e,t){if(isCartesianChart(e,t,this)||this.isAxisCell(e,t))return getChartAxes(e,t,this)}getRawChartSpec(e,t){return getRawChartSpec(e,t,this)}getChartSpec(e,t){return getChartSpec(e,t,this)}isShareChartSpec(e,t){return isShareChartSpec(e,t,this)}getChartDataId(e,t){return getChartDataId(e,t,this)}isNoChartDataRenderNothing(e,t){return isNoChartDataRenderNothing(e,t,this)}setPagination(e){var t,i;this.clearCellRangeMap(),this._table.internalProps.useOneRowHeightFillAll=!1,this.pagination=e,\\\"grid\\\"===this.rowHierarchyType&&isValid_default(null==(t=this.pagination)?void 0:t.perPageCount)&&isValid_default(null==(t=this.pagination)?void 0:t.currentPage)?(!1===this.indicatorsAsCol&&(this.pagination.perPageCount=Math.ceil(this.pagination.perPageCount/this.indicatorKeys.length)*this.indicatorKeys.length),({perPageCount:t,currentPage:i}=this.pagination),this.currentPageStartIndex=t*(i||0),this.currentPageEndIndex=this.currentPageStartIndex+t,this._rowHeaderCellIds=null==(i=this._rowHeaderCellIds_FULL)?void 0:i.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(t=this._rowHeaderCellFullPathIds_FULL)?void 0:t.slice(this.currentPageStartIndex,this.currentPageEndIndex)):(this.currentPageStartIndex=0,this.currentPageEndIndex=this._rowHeaderCellIds_FULL.length,this._rowHeaderCellIds=null==(i=this._rowHeaderCellIds_FULL)?void 0:i.slice(this.currentPageStartIndex,this.currentPageEndIndex),this._rowHeaderCellFullPathIds=null==(t=this._rowHeaderCellFullPathIds_FULL)?void 0:t.slice(this.currentPageStartIndex,this.currentPageEndIndex)),this.pagination&&(this.pagination.totalCount=null==(i=this._rowHeaderCellIds_FULL)?void 0:i.length)}release(){var e=this._table._getActiveChartInstance();null!=e&&e.release(),null!=(e=this._indicators)&&e.forEach(e=>{var t;null!=(t=e.chartInstance)&&t.release()})}getHeadNode(e,t){let i,r,o,n;var a=this.getCellHeaderPaths(e,t);return a.rowHeaderPaths&&0<(null!=(r=null==(i=a.rowHeaderPaths)?void 0:i.length)?r:0)?n=null==(o=a.rowHeaderPaths)?void 0:o.slice(0,a.rowHeaderPaths.length):a.colHeaderPaths&&0<a.colHeaderPaths.length&&(n=a.colHeaderPaths.slice(0,a.colHeaderPaths.length)),this.getHeadNodeByRowOrColDimensions(n,e,t)}getHeadNodeByRowOrColDimensions(l,e,t){var s;if(Array.isArray(l)){let i,r,o=this.rowTree,n=this.columnTree;isValid_default(t)&&isValid_default(e)&&\\\"tree\\\"===this.rowHierarchyType&&this.extensionRows&&e>=1+this.leftRowSeriesNumberColumnCount&&(s=this.getCellId(e-1,t),o=this._rowHeaderExtensionTree[s].tree.children);for(let a=0;a<l.length;a++){var h=l[a];if((h.isPivotCorner||!isValid_default(h.value))&&a===l.length-1)return;let t=!1;for(let e=0;e<n.length;e++){var d=n[e];if(isValid_default(h.dimensionKey)&&d.dimensionKey===h.dimensionKey&&d.value===h.value||isValid_default(h.indicatorKey)&&d.indicatorKey===h.indicatorKey&&(d.value===h.value||!isValid_default(h.value)||!isValid_default(d.value))){n=d.children,r=d,t=!0;break}}if(!t)for(let e=0;e<(null!=(u=null==o?void 0:o.length)?u:0);e++){var u=o[e];if(isValid_default(h.dimensionKey)&&u.dimensionKey===h.dimensionKey&&u.value===h.value||isValid_default(h.indicatorKey)&&u.indicatorKey===h.indicatorKey&&(u.value===h.value||!isValid_default(h.value)||!isValid_default(u.value))){o=u.children,i=u;break}}}return i||r||void 0}}clearCellRangeMap(){this._largeCellRangeCache.length=0,this._CellHeaderPathMap=new Map}getDimensionKeyInChartSpec(e,t){let i,r,o,n,a,l,s;if(!1===this.indicatorsAsCol)for(let e=0;e<this.indicatorsDefine.length;e++){var h=this.indicatorsDefine[e].chartSpec;if(h&&(s=null!=(i=h.xField)?i:null==(o=null==(r=null==h?void 0:h.series)?void 0:r[0])?void 0:o.xField))return s}else for(let t=0;t<this.indicatorsDefine.length;t++){var d=this.indicatorsDefine[t].chartSpec;if(d&&(s=null!=(n=d.yField)?n:null==(l=null==(a=null==d?void 0:d.series)?void 0:a[0])?void 0:l.yField))return s}return null}_generateChartState(){return{vtable_selected:{filter:i=>{var e;return 1<=this._table._selectedDataItemsInChart.length?!!this._table._selectedDataItemsInChart.find(e=>{for(const t in e)if(\\\"object\\\"!=typeof e[t]&&e[t]!==i[t])return!1;return!0}):!(null==(e=this._table._selectedDimensionInChart)||!e.length||!this._table._selectedDimensionInChart.every(e=>\\\"object\\\"==typeof e.value||i[e.key]===e.value))}},vtable_selected_reverse:{filter:i=>{var e;return 1<=this._table._selectedDataItemsInChart.length?!this._table._selectedDataItemsInChart.find(e=>{for(const t in e)if(\\\"object\\\"!=typeof e[t]&&e[t]!==i[t])return!1;return!0}):!(null==(e=this._table._selectedDimensionInChart)||!e.length||this._table._selectedDimensionInChart.every(e=>\\\"object\\\"==typeof e.value||i[e.key]===e.value))}}}}updateDataStateToChartInstance(e){var t;if(!1!==(null==(t=null==e?void 0:e.getSpec().select)?void 0:t.enable)){e=e||this._table._getActiveChartInstance();const r=this._generateChartState();this._indicators.forEach(e=>{var t,i=e.chartInstance;!1!==(null==(t=e.chartSpec.select)?void 0:t.enable)&&i.updateState(r)}),null!=e&&e.updateState(r)}}updateDataStateToActiveChartInstance(e){var t;!1!==(null==(t=null==e?void 0:e.getSpec().select)?void 0:t.enable)&&(e=e||this._table._getActiveChartInstance(),t=this._generateChartState(),null!=e)&&e.updateState(t)}getIndicatorKeyInChartSpec(e,t){const i=this.getRawChartSpec(e,t),r=[];if(i){if(i.series||i.xField||i.yField)return!1===this.indicatorsAsCol?i.series?i.series.forEach(e=>{var t=e.yField;r.push(t)}):r.push(i.yField):i.series?i.series.forEach(e=>{var t=e.xField;r.push(t)}):r.push(i.xField),r;if(i.valueField&&r.push(i.valueField),1<=r.length)return r}return null}getOptimunHeightForChart(e){var t,i,r=this.getCellHeaderPaths(this.rowHeaderLevelCount,e).rowHeaderPaths;let o,n;for(const l in this.dataset.collectValuesBy)if(\\\"yField\\\"===this.dataset.collectValuesBy[l].type&&!this.dataset.collectValuesBy[l].range){o=null==(t=this.dataset.collectedValues[l])?void 0:t[r.map(e=>e.value).join(this.dataset.stringJoinChar)];break}n=this._chartItemBandSize?scaleWholeRangeSize(null!=(i=null==o?void 0:o.length)?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter):(i=this._chartItemSpanSize||25,(null!=(a=null==o?void 0:o.length)?a:0)*(i+i/3));var a=getQuadProps(null!=(i=null!=(a=this._chartPadding)?a:this._table.theme.bodyStyle.padding)?i:0);return n+a[0]+a[2]}getOptimunWidthForChart(e){var t,i,r=this.getCellHeaderPaths(e,this.columnHeaderLevelCount).colHeaderPaths;let o,n;for(const l in this.dataset.collectValuesBy)if(\\\"xField\\\"===this.dataset.collectValuesBy[l].type&&!this.dataset.collectValuesBy[l].range){o=null==(t=this.dataset.collectedValues[l])?void 0:t[r.map(e=>e.value).join(this.dataset.stringJoinChar)];break}n=this._chartItemBandSize?scaleWholeRangeSize(null!=(i=null==o?void 0:o.length)?i:0,this._chartItemBandSize,this._chartPaddingInner,this._chartPaddingOuter):(i=this._chartItemSpanSize||25,(null!=(a=null==o?void 0:o.length)?a:0)*(i+i/3));var a=getQuadProps(null!=(i=null!=(a=this._chartPadding)?a:this._table.theme.bodyStyle.padding)?i:0);return n+a[1]+a[3]}get leftAxesCount(){var e;return!this._table.isPivotChart()||!1===(null==(e=this._table.pivotChartAxes.find(e=>\\\"left\\\"===e.orient))?void 0:e.visible)?0:(this.indicatorsAsCol,1)}get topAxesCount(){var e;return this._table.isPivotChart()&&!1!==(null==(e=this._table.pivotChartAxes.find(e=>\\\"top\\\"===e.orient))?void 0:e.visible)&&this.indicatorsAsCol&&this.hasTwoIndicatorAxes?1:0}get rightAxesCount(){return this.rightFrozenColCount}get bottomAxesCount(){return this.bottomFrozenRowCount}getColKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),r=[];return i.colHeaderPaths.length&&i.colHeaderPaths.forEach(e=>{e.dimensionKey&&r.push(e.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getRowKeysPath(e,t){const i=this.getCellHeaderPaths(e,t),r=[];return i.rowHeaderPaths.length&&i.rowHeaderPaths.forEach(e=>{e.dimensionKey&&r.push(e.value)}),null==r?void 0:r.join(this.dataset.stringJoinChar)}getIndicatorInfo(t,i=\\\"\\\"){var e;return null==(e=this.indicatorsDefine)?void 0:e.find(e=>\\\"string\\\"!=typeof e&&(t?e.indicatorKey===t:!!i&&e.title===i))}getLayoutColumnTree(){var e=[];return generateLayoutTree(e,this.columnDimensionTree.tree.children),e}getLayoutRowTree(){var e=[];return generateLayoutTree(e,this.rowDimensionTree.tree.children),e}getLayoutColumnTreeCount(){return countLayoutTree(this.columnDimensionTree.tree.children,\\\"tree\\\"===this.rowHierarchyType)}getLayoutRowTreeCount(){var e;let i=countLayoutTree(this.rowDimensionTree.tree.children,\\\"tree\\\"===this.rowHierarchyType);return null!=(e=this.extensionRows)&&e.forEach(e=>{var t;\\\"function\\\"!=typeof e.rowTree&&(t=countLayoutTree(e.rowTree,!0),i*=t)}),i}resetHeaderTree(){this.colIndex=0,this._rowHeaderCellFullPathIds_FULL=[],this._columnHeaderCellFullPathIds=[],this._columnHeaderCellIds=[];var e=this.dataset;this.rowTree=e.rowHeaderTree,this.columnTree=e.colHeaderTree;const r=this.rowDimensionTree.tree.children;null!=(e=this.rowTree)&&e.forEach((t,e)=>{var i=r.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);i&&this._table._syncHierarchyState(i,t)}),this.columnDimensionTree=new DimensionTree(null!=(e=this.columnTree)?e:[],this.sharedVar,this.columnHierarchyType,\\\"grid\\\"!==this.columnHierarchyType?this.columnExpandLevel:void 0),this.rowDimensionTree=new DimensionTree(null!=(e=this.rowTree)?e:[],this.sharedVar,this.rowHierarchyType,\\\"grid\\\"!==this.rowHierarchyType?this.rowExpandLevel:void 0),this.resetColumnHeaderLevelCount(),this._generateColHeaderIds(),this.colIndex=0,this._generateRowHeaderIds(),this._rowHeaderCellFullPathIds_FULL=transpose(this._rowHeaderCellFullPathIds_FULL),this._headerObjectMap=this._headerObjects.reduce((e,t)=>(e[t.id]=t,e),{}),this._CellHeaderPathMap=new Map,this._largeCellRangeCache.length=0,this.generateCellIdsConsiderHideHeader(),this.setPagination(this.pagination)}isSeriesNumberInHeader(e,t){return 0<this.leftRowSeriesNumberColumnCount&&0<=e&&0<=t&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount||0<this.rightRowSeriesNumberColumnCount&&0<=t&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount}isSeriesNumberInBody(e,t){return 0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount||0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount}isSeriesNumber(e,t){if(isValid_default(e)&&isValid_default(t)){if(0<this.leftRowSeriesNumberColumnCount&&0<=e&&0<=t&&e<this.leftRowSeriesNumberColumnCount)return!0;if(0<this.rightRowSeriesNumberColumnCount&&0<=t&&e>=this.colCount-this.rightRowSeriesNumberColumnCount)return!0}return!1}getSeriesNumberHeader(e,t){return 0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount?Object.assign({},this.leftRowSeriesNumberColumn[e],{style:Object.assign({},this._table.internalProps.theme.cornerHeaderStyle,this._table.internalProps.rowSeriesNumber.headerStyle)}):0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t<this.headerLevelCount&&t<this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}getSeriesNumberBody(e,t){return 0<this.leftRowSeriesNumberColumnCount&&0<=e&&e<this.leftRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.leftRowSeriesNumberColumn[e]:0<this.rightRowSeriesNumberColumnCount&&e>=this.colCount-this.rightRowSeriesNumberColumnCount&&t>=this.headerLevelCount?this.rightRowSeriesNumberColumn[e-(this.colCount-this.rightRowSeriesNumberColumnCount)]:void 0}changeTreeNodeTitle(e,t,i){this.getHeadNode(e,t).value=i;var r=this.getCellId(e,t);this._headerObjectMap[r].title=i}changeCornerTitle(e,t,i){var r;this.isCornerHeader(e,t)&&(r=this.getCellId(e,t),this._headerObjectMap[r].title=i)}generateCellIdsConsiderHideHeader(){var e;if(this._columnHeaderCellIds=this._columnHeaderCellFullPathIds.slice(),this.showColumnHeader||(this.indicatorsAsCol&&!this.hideIndicatorName?(e=this.colDimensionKeys.indexOf(IndicatorDimensionKeyPlaceholder),e=this._columnHeaderCellIds.splice(e,1),this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length),this._columnHeaderCellIds.push(e[0])):this._columnHeaderCellIds.splice(0,this._columnHeaderCellIds.length)),this._rowHeaderCellIds_FULL=this._rowHeaderCellFullPathIds_FULL.slice(),!this.showRowHeader)if(this.indicatorsAsCol||this.hideIndicatorName)this._rowHeaderCellIds_FULL.forEach((e,t)=>{var i=e.slice();i.splice(0,i.length),this._rowHeaderCellIds_FULL[t]=i});else{const o=this.rowDimensionKeys.indexOf(IndicatorDimensionKeyPlaceholder);this._rowHeaderCellIds_FULL.forEach((e,t)=>{var i=e.slice(),r=i.splice(o,1);i.splice(0,i.length),i.push(r[0]),this._rowHeaderCellIds_FULL[t]=i})}if(this._rowHeaderCellIds=this._rowHeaderCellIds_FULL.slice(),this._cornerHeaderCellIds=this._cornerHeaderCellFullPathIds.slice(),0===this.rowHeaderLevelCount||0===this.columnHeaderLevelCount)this._cornerHeaderCellIds=[];else if(\\\"row\\\"!==this.cornerSetting.titleOnDimension||this.showRowHeader)\\\"column\\\"!==this.cornerSetting.titleOnDimension||this.showColumnHeader||(this.indicatorsAsCol&&!this.hideIndicatorName?(e=this.colDimensionKeys.indexOf(IndicatorDimensionKeyPlaceholder),e=this._cornerHeaderCellIds.splice(e,1),this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length),this._cornerHeaderCellIds.push(e[0])):this._cornerHeaderCellIds.splice(0,this._cornerHeaderCellIds.length));else if(this.indicatorsAsCol||this.hideIndicatorName)this._cornerHeaderCellIds.forEach((e,t)=>{var i=e.slice();i.splice(0,i.length),this._cornerHeaderCellIds[t]=i});else{const n=this.rowDimensionKeys.indexOf(IndicatorDimensionKeyPlaceholder);this._cornerHeaderCellIds.forEach((e,t)=>{var i=e.slice(),r=i.splice(n,1);i.splice(0,i.length),i.push(r[0]),this._cornerHeaderCellIds[t]=i})}\\\"grid-tree\\\"===this.rowHierarchyType&&\\\"column\\\"===this.cornerSetting.titleOnDimension?this._cornerHeaderCellIds[0].length<this._rowHeaderCellIds[0].length?this._cornerHeaderCellIds.forEach((e,t)=>{var i=e.length;e.length=this._rowHeaderCellIds[0].length,e.fill(e[0],i)}):this._cornerHeaderCellIds[0].length>this._rowHeaderCellIds[0].length&&this._cornerHeaderCellIds.forEach((e,t)=>{e.length=this._rowHeaderCellIds[0].length}):\\\"grid-tree\\\"===this.columnHierarchyType&&\\\"row\\\"===this.cornerSetting.titleOnDimension&&((null==(e=this._cornerHeaderCellIds)?void 0:e.length)<(null==(e=this._columnHeaderCellIds)?void 0:e.length)?(e=this._cornerHeaderCellIds.length,this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length,this._cornerHeaderCellIds.fill(this._cornerHeaderCellIds[0],e)):(null==(e=this._cornerHeaderCellIds)?void 0:e.length)>(null==(e=this._columnHeaderCellIds)?void 0:e.length)&&(this._cornerHeaderCellIds.length=this._columnHeaderCellIds.length))}enableUseGetBodyCache(){this._useGetBodyCache=!0,this._getBodyCache.clear()}disableUseGetBodyCache(){this._useGetBodyCache=!1,this._getBodyCache.clear()}enableUseHeaderPathCache(){var e;null!=(e=null==(e=this._table.options)?void 0:e.customConfig)&&e.enablePivotPathCache?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!0,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}disableUseHeaderPathCache(){var e;null!=(e=null==(e=this._table.options)?void 0:e.customConfig)&&e.enablePivotPathCache?this._useHeaderPathCache=!0:(this._useHeaderPathCache=!1,this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear())}getBodyWidthCache(e,t){if(this._useGetBodyCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t))return this.indicatorsAsCol&&this._getBodyCache.has(e)?this._getBodyCache.get(e):!this.indicatorsAsCol&&this._getBodyCache.has(t)?this._getBodyCache.get(t):void 0}setBodyWidthCache(e,t,i){!this._useGetBodyCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||(this.indicatorsAsCol?this._getBodyCache.set(e,i):this._getBodyCache.set(t,i))}getColHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._colHeaderPathCache.has(e))return this._colHeaderPathCache.get(e)}setColHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._colHeaderPathCache.set(e,i)}getRowHeaderPathCache(e,t){if(this._useHeaderPathCache&&!this.isHeader(e,t)&&!this.isSeriesNumber(e,t)&&this._rowHeaderPathCache.has(t))return this._rowHeaderPathCache.get(t)}setRowHeaderPathCache(e,t,i){!this._useHeaderPathCache||this.isHeader(e,t)||this.isSeriesNumber(e,t)||this._rowHeaderPathCache.set(t,i)}clearHeaderPathCache(){this._colHeaderPathCache.clear(),this._rowHeaderPathCache.clear()}};function scaleWholeRangeSize(e,t,i,r){var o=bandSpace(e,i=1===i?0:i,r);return Math.ceil(o*(t/(1-i)))}function bandSpace(e,t,i){var r=1===e?e+2*i:e-t+2*i;return e?0<r?r:1:0}init_esbuild_inject();var FlatDataToObjects=class{constructor(e,t){this.tree={},this.beforeChangedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.stringJoinChar=String.fromCharCode(0),this.rowsIsTotal=[],this.colsIsTotal=[],this.dataConfig=e,t&&(this.records=t,\\\"undefined\\\"!=typeof window&&window.performance.now(),this.setRecords(t),\\\"undefined\\\"!=typeof window)&&window.performance.now()}changeDataConfig(e){this.dataConfig=e}setRecords(e){this.processRecords()}processRecords(){for(let t=0,i=this.records.length;t<i;t++){var e=this.records[t];this.processRecord(e)}}processRecord(o){var e;const n=[],a=[];for(let r=0,l=this.dataConfig.rows.length;r<l;r++){var t=this.dataConfig.rows[r];void 0!==o[t]&&t!==this.dataConfig.indicatorDimensionKey&&a.push(o[t])}for(let s=0,h=this.dataConfig.columns.length;s<h;s++){var i=this.dataConfig.columns[s];void 0!==o[i]&&i!==this.dataConfig.indicatorDimensionKey&&n.push(o[i])}null!=(e=this.dataConfig.indicators)&&e.forEach(e=>{var t=o[e],i=(void 0!==t&&(this.dataConfig.indicatorsAsCol?n:a).push(e),a.join(this.stringJoinChar)),r=n.join(this.stringJoinChar);0===a.length||this.rowFlatKeys[i]||(this.rowFlatKeys[i]=1),0===n.length||this.colFlatKeys[r]||(this.colFlatKeys[r]=1),0===n.length&&0===a.length||(this.tree[i]||(this.tree[i]={}),void 0!==t&&(this.tree[i][r]={value:t,record:o},(this.dataConfig.indicatorsAsCol?n:a).pop()))})}getTreeNode(r=[],o=[],n,e=!0){let t,i,a,l,s,h;if(\\\"string\\\"==typeof r)s=r;else{let i=!1;r.map((e,t)=>{e===n&&(r.splice(t,1),i=!0)}),i&&r.push(n),s=r.join(this.stringJoinChar)}if(\\\"string\\\"==typeof o)h=o;else{let i=!1;o.map((e,t)=>{e===n&&(o.splice(t,1),i=!0)}),i&&o.push(n),h=o.join(this.stringJoinChar)}return e?null!=(a=null==(i=null==(t=this.tree)?void 0:t[s])?void 0:i[h])?a:void 0:isValid_default(null==(l=this.beforeChangedTree[s])?void 0:l[h])?{value:this.beforeChangedTree[s][h].value,record:this.beforeChangedTree[s][h].record}:void 0}changeTreeNodeValue(r=[],o=[],n,e){let t,i,a,l,s,h,d,u,c;if(\\\"string\\\"==typeof r)u=r;else{let i=!1;r.map((e,t)=>{e===n&&(r.splice(t,1),i=!0)}),i&&r.push(n),u=r.join(this.stringJoinChar)}if(\\\"string\\\"==typeof o)c=o;else{let i=!1;o.map((e,t)=>{e===n&&(o.splice(t,1),i=!0)}),i&&o.push(n),c=o.join(this.stringJoinChar)}var g=null==(i=null==(t=this.tree[u])?void 0:t[c])?void 0:i.value,p=Object.assign({},null==(l=null==(a=this.tree[u])?void 0:a[c])?void 0:l.record);null!=(h=null==(s=this.tree[u])?void 0:s[c])&&h.record?(this.tree[u][c].record[n]=e,this.tree[u][c].value=e):(this.tree[u]||(this.tree[u]={}),this.tree[u][c]={record:this._buildRecord(r,o,n,e),value:e}),null!=(d=this.beforeChangedTree[u])&&d[c]||(this.beforeChangedTree[u]={},this.beforeChangedTree[u][c]={record:void 0,value:void 0},this.beforeChangedTree[u][c].record=p,this.beforeChangedTree[u][c].value=g)}_buildRecord(i=[],r=[],e,t){const o={},n=this.dataConfig.rows,a=this.dataConfig.columns;return n.forEach((e,t)=>{e!==this.dataConfig.indicatorDimensionKey&&(o[e]=i[t])}),a.forEach((e,t)=>{e!==this.dataConfig.indicatorDimensionKey&&(o[e]=r[t])}),o[e]=t,this.records.push(o),o}addRecords(e){for(let i=0,r=e.length;i<r;i++){var t=e[i];this.processRecord(t)}this.records.push(e)}changeRecordFieldValue(i,r,o){let e=!1;for(let t=0;t<this.dataConfig.indicators.length;t++)this.dataConfig.indicators[t]===i&&(e=!0);if(!e){for(let e=0,t=this.records.length;e<t;e++){var n=this.records[e];n[i]===r&&(n[i]=o)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}};function join(e,t){let i=\\\"\\\";for(let r=0;r<e.length;r++)i+=e[r],r!==e.length-1&&(i+=t);return i}init_esbuild_inject(),init_esbuild_inject();var Dataset=class{constructor(e,t,i,r,o,n,a,l,s,h,d,u,c,g){var p;this.tree={},this.changedTree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.colKeys_normal=[],this.rowKeys_normal=[],this.rowOrder=\\\"key_a_to_z\\\",this.colOrder=\\\"key_a_to_z\\\",this.sorted=!1,this.indicatorStatistics=[],this.stringJoinChar=String.fromCharCode(0),this.rowsIsTotal=[],this.colsIsTotal=[],this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.registerAggregators(),this.dataConfig=e,this.filterRules=null==(p=this.dataConfig)?void 0:p.filterRules,this.rowHierarchyType=null!=l?l:\\\"grid\\\",this.columnHierarchyType=null!=s?s:\\\"grid\\\",this.sortRules=null==(p=this.dataConfig)?void 0:p.sortRules,this.aggregationRules=null==(p=this.dataConfig)?void 0:p.aggregationRules,this.derivedFieldRules=null==(p=this.dataConfig)?void 0:p.derivedFieldRules,this.mappingRules=null==(p=this.dataConfig)?void 0:p.mappingRules,this.calculatedFieldRules=null==(p=this.dataConfig)?void 0:p.calculatedFieldRules,this.calculatedFiledKeys=null!=(p=null==(p=this.calculatedFieldRules)?void 0:p.map(e=>e.key))?p:[],this.calculatedFieldDependIndicatorKeys=null!=(p=null==(p=this.calculatedFieldRules)?void 0:p.reduce((e,t)=>{for(let i=0;i<t.dependIndicatorKeys.length;i++)-1===e.indexOf(t.dependIndicatorKeys[i])&&e.push(t.dependIndicatorKeys[i]);return e},[]))?p:[],this.totals=null==(p=this.dataConfig)?void 0:p.totals,this.rows=t,this.columns=i,this.indicatorKeys=r,this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys=[...r];for(let b=0;b<this.calculatedFieldDependIndicatorKeys.length;b++)-1===this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.indexOf(this.calculatedFieldDependIndicatorKeys[b])&&this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys.push(this.calculatedFieldDependIndicatorKeys[b]);if(this.indicatorsAsCol=n,this.indicators=o,this.customColTree=h,this.customRowTree=d,this.hasExtensionRowTree=c,this.parseCustomTreeToMatchRecords=g,this.parseCustomTreeToMatchRecords&&(this.customColTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customColTree,\\\"col\\\"),this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,\\\"row\\\"))),this.colGrandTotalLabel=null!=(p=null==(p=null==(p=this.totals)?void 0:p.column)?void 0:p.grandTotalLabel)?p:\\\"总计\\\",this.colSubTotalLabel=null!=(p=null==(p=null==(p=this.totals)?void 0:p.column)?void 0:p.subTotalLabel)?p:\\\"小计\\\",this.rowGrandTotalLabel=null!=(p=null==(p=null==(p=this.totals)?void 0:p.row)?void 0:p.grandTotalLabel)?p:\\\"总计\\\",this.rowSubTotalLabel=null!=(p=null==(p=null==(p=this.totals)?void 0:p.row)?void 0:p.subTotalLabel)?p:\\\"小计\\\",this.collectValuesBy=null==(p=this.dataConfig)?void 0:p.collectValuesBy,this.needSplitPositiveAndNegative=null!=u&&u,this.rowsIsTotal=new Array(null!=(p=null==(p=this.rows)?void 0:p.length)?p:0).fill(!1),this.colsIsTotal=new Array(null!=(p=null==(p=this.columns)?void 0:p.length)?p:0).fill(!1),null!=(p=this.totals)&&p.row&&!1!==this.totals.row.showSubTotals&&this.totals.row.subTotalsDimensions)for(let e=0,t=null!=(p=null==(p=null==(p=null==(p=this.totals)?void 0:p.row)?void 0:p.subTotalsDimensions)?void 0:p.length)?p:0;e<t;e++){var f=this.totals.row.subTotalsDimensions[e],f=this.rows.indexOf(f);this.rowsIsTotal[f]=!0}if(null!=(p=this.totals)&&p.column&&!1!==this.totals.column.showSubTotals&&this.totals.column.subTotalsDimensions)for(let e=0,t=null!=(p=null==(p=null==(p=null==(p=this.totals)?void 0:p.column)?void 0:p.subTotalsDimensions)?void 0:p.length)?p:0;e<t;e++){var m=this.totals.column.subTotalsDimensions[e],m=this.columns.indexOf(m);this.colsIsTotal[m]=!0}this.setRecords(a)}setRecords(e){var t;this.records=e,this.collectedValues={},this.cacheCollectedValues={},this.totalRecordsTree={},this.tree={},this.colFlatKeys={},this.rowFlatKeys={},this.colKeys=[],this.rowKeys=[],this.rowsHasValue=[],this.columnsHasValue=[],this.sorted=!1,e&&(this.records=e,\\\"undefined\\\"!=typeof window&&window.performance.now(),this.processRecords(),this.processCollectedValuesWithSumBy(),this.generateCollectedValuesSortRule(),this.processCollectedValuesWithSortBy(),\\\"undefined\\\"!=typeof window&&window.performance.now(),\\\"undefined\\\"!=typeof window&&window.performance.now(),this.totalStatistics(),\\\"undefined\\\"!=typeof window&&window.performance.now(),this.rowKeys_normal=this.rowKeys.slice(),this.colKeys_normal=this.colKeys.slice(),\\\"undefined\\\"!=typeof window&&window.performance.now(),this.sortKeys(),\\\"undefined\\\"!=typeof window&&window.performance.now(),\\\"undefined\\\"!=typeof window&&window.performance.now(),this.customRowTree?this.rowHeaderTree=this.customRowTree:\\\"tree\\\"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,(null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotalsOnTop)&&t):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotalsOnTop)&&t,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showSubTotalsOnTop)&&t),this.customColTree?this.colHeaderTree=this.customColTree:this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((e,t)=>this.columnsHasValue[t]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showGrandTotalsOnLeft)&&t,null!=(t=null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showSubTotalsOnLeft)&&t),\\\"undefined\\\"!=typeof window&&window.performance.now(),null!=(t=this.dataConfig))&&t.isPivotChart&&this.cacheDeminsionCollectedValues()}registerAggregator(e,t){registeredAggregators[e]=t}registerAggregators(){this.registerAggregator(AggregationType.RECORD,RecordAggregator),this.registerAggregator(AggregationType.SUM,SumAggregator),this.registerAggregator(AggregationType.COUNT,CountAggregator),this.registerAggregator(AggregationType.MAX,MaxAggregator),this.registerAggregator(AggregationType.MIN,MinAggregator),this.registerAggregator(AggregationType.AVG,AvgAggregator),this.registerAggregator(AggregationType.NONE,NoneAggregator),this.registerAggregator(AggregationType.RECALCULATE,RecalculateAggregator),this.registerAggregator(AggregationType.CUSTOM,CustomAggregator)}processCollectedValuesWithSumBy(){var e;for(const o in this.collectedValues)if(null!=(e=null==(e=this.collectValuesBy)?void 0:e[o])&&e.sumBy)for(const n in this.collectedValues[o]){let e;\\\"sum\\\"===(null==(r=this.collectValuesBy[o])?void 0:r.extendRange)?(e=Object.values(this.collectedValues[o][n]).reduce((e,t)=>e+t.value(),0),e+=Math.round(e/20)):(e=Object.values(this.collectedValues[o][n]).reduce((e,t)=>t.value()>e?t.value():e,Number.MIN_SAFE_INTEGER),\\\"max\\\"===(null==(r=this.collectValuesBy[o])?void 0:r.extendRange)?e+=Math.round(e/20):\\\"number\\\"==typeof(null==(r=this.collectValuesBy[o])?void 0:r.extendRange)&&(e=Math.max(e,null==(r=this.collectValuesBy[o])?void 0:r.extendRange)));var r=Object.values(this.collectedValues[o][n]).reduce((e,t)=>t.value()<e?t.value():e,Number.MAX_SAFE_INTEGER);let t,i;this.needSplitPositiveAndNegative&&(t=Object.values(this.collectedValues[o][n]).reduce((e,t)=>t.positiveValue()>e?t.positiveValue():e,Number.MIN_SAFE_INTEGER),i=Object.values(this.collectedValues[o][n]).reduce((e,t)=>t.negativeValue()<e?t.negativeValue():e,Number.MAX_SAFE_INTEGER)),this.collectedValues[o][n]={},this.collectedValues[o][n].max=e,this.collectedValues[o][n].min=r,this.needSplitPositiveAndNegative&&(this.collectedValues[o][n].positiveMax=t,this.collectedValues[o][n].negativeMin=i)}}processCollectedValuesWithSortBy(){var e;const r=this;for(const o in this.collectedValues)if(null!=(e=null==(e=this.collectValuesBy)?void 0:e[o])&&e.sortBy)for(const t in this.collectedValues[o])this.collectedValues[o][t]=this.collectedValues[o][t].sort((e,t)=>{var i;return(null!=(i=null==(i=r.collectValuesBy[o].sortBy)?void 0:i.indexOf(e))?i:-1)-(null!=(i=null==(i=r.collectValuesBy[o].sortBy)?void 0:i.indexOf(t))?i:-1)})}generateCollectedValuesSortRule(){for(const t in this.collectedValues)if(this.collectValuesBy&&this.collectValuesBy[t]&&!this.collectValuesBy[t].sortBy){let e=[];for(const i in this.collectedValues[t])Array.isArray(this.collectedValues[t][i])&&(e.push(...this.collectedValues[t][i]),e=Array.from(new Set(e)));0<e.length&&(this.collectValuesBy[t].sortBy=e)}}processRecords(){let e,t,i=!1;if(1<=(null!=(t=null==(e=this.filterRules)?void 0:e.length)?t:0)&&(i=!0),Array.isArray(this.records)){this.filteredRecords||(this.filteredRecords=[]);for(let e=0,t=this.records.length;e<t;e++){var r=this.records[e];i&&!this.filterRecord(r)||(this.filteredRecords.push(r),this.processRecord(r))}}else{this.filteredRecords||(this.filteredRecords={});for(const n in this.records)for(let e=0,t=this.records[n].length;e<t;e++){var o=this.records[n][e];i&&!this.filterRecord(o)||(this.filteredRecords[n]||(this.filteredRecords[n]=[]),this.filteredRecords[n].push(o),this.processRecord(o,n))}}this.rowFlatKeys={},this.colFlatKeys={}}filterRecord(t){let i,r,o=!0;if(this.filterRules)for(let e=0;e<this.filterRules.length;e++){var n=this.filterRules[e];if(n.filterKey){var a=t[n.filterKey];if(-1===(null==(i=n.filteredValues)?void 0:i.indexOf(a))){o=!1;break}}else if(null==(r=n.filterFunc)||!r.call(n,t)){o=!1;break}}return o}processRecord(r,o){var e,n,a,l,s,t,i,h,d;null!=(e=this.derivedFieldRules)&&e.forEach((e,t)=>{e.fieldName&&e.derivedFunc&&(r[e.fieldName]=e.derivedFunc(r))});for(const H in this.collectValuesBy)isValid_default(r[H])&&(this.collectedValues[H]||(this.collectedValues[H]={}),t=this.collectValuesBy[H].by.map(e=>r[e]).join(this.stringJoinChar),this.collectedValues[H][t]||(this.collectValuesBy[H].sumBy?this.collectedValues[H][t]={}:this.collectValuesBy[H].range?this.collectedValues[H][t]={min:Number.MAX_SAFE_INTEGER,max:Number.MIN_SAFE_INTEGER}:this.collectedValues[H][t]=[]),this.collectValuesBy[H].sumBy?(i=null==(i=this.collectValuesBy[H].sumBy)?void 0:i.map(e=>r[e]).join(this.stringJoinChar),this.collectedValues[H][t][i]||(this.collectedValues[H][t][i]=new registeredAggregators[AggregationType.SUM]({key:H,field:H,isRecord:void 0,needSplitPositiveAndNegative:this.needSplitPositiveAndNegative})),this.collectedValues[H][t][i].push(r)):this.collectValuesBy[H].range?(i=this.collectedValues[H][t],d=Math.max(r[H],i.max),h=Math.min(r[H],i.min),isNaN(d)||(i.max=d,i.min=h)):-1===(d=this.collectedValues[H][t]).indexOf(r[H])&&d.push(r[H]));let u=!1;var c=[],g=[];if(!this.parseCustomTreeToMatchRecords||null!=(e=this.dataConfig)&&e.isPivotChart||null==(e=this.customRowTree)||!e.length||o||this.hasExtensionRowTree){var p=[];g.push({rowKey:p,indicatorKey:o});for(let e=0,t=this.rows.length;e<t;e++){var f=this.rows[e];if(f in r)this.rowsHasValue[e]=!0,p.push(r[f]);else if(f!==IndicatorDimensionKeyPlaceholder){if(null!=(f=null==(f=null==(f=this.dataConfig)?void 0:f.totals)?void 0:f.row)&&f.showGrandTotals&&0===e&&!this.rows.find(e=>e in r)){p.push(this.rowGrandTotalLabel),u=!0;break}if(null!=(f=null==(f=null==(f=this.dataConfig)?void 0:f.totals)?void 0:f.row)&&f.subTotalsDimensions&&0<=(null==(f=null==(f=null==(f=this.dataConfig)?void 0:f.totals)?void 0:f.row)?void 0:f.subTotalsDimensions.indexOf(this.rows[e-1]))){\\\"tree\\\"!==this.rowHierarchyType&&p.push(this.rowSubTotalLabel),u=!0;break}}}}else{var m=this.getFieldMatchRowDimensionPaths(r);if(0<m.length)for(let r=0,e=m.length;r<e;r++){var b=m[r],C=[];let e;for(let t=0,i=b.length;t<i;t++)isValid_default(b[t].indicatorKey)?e=b[t].indicatorKey:C.push(b[t].value);g.push({rowKey:C,indicatorKey:e})}}if(!this.parseCustomTreeToMatchRecords||null!=(e=this.dataConfig)&&e.isPivotChart||null==(e=this.customColTree)||!e.length||o||this.hasExtensionRowTree){var v=[];c.push({colKey:v,indicatorKey:o});for(let e=0,t=this.columns.length;e<t;e++){var y=this.columns[e];if(y in r)this.columnsHasValue[e]=!0,v.push(r[y]);else if(y!==IndicatorDimensionKeyPlaceholder){if(null!=(y=null==(y=null==(y=this.dataConfig)?void 0:y.totals)?void 0:y.column)&&y.showGrandTotals&&0===e&&!this.columns.find(e=>e in r)){v.push(this.colGrandTotalLabel),u=!0;break}if(null!=(y=null==(y=null==(y=this.dataConfig)?void 0:y.totals)?void 0:y.column)&&y.subTotalsDimensions&&0<=(null==(y=null==(y=null==(y=this.dataConfig)?void 0:y.totals)?void 0:y.column)?void 0:y.subTotalsDimensions.indexOf(this.columns[e-1]))){v.push(this.colSubTotalLabel),u=!0;break}}}}else{var w=this.getFieldMatchColDimensionPaths(r);if(0<w.length)for(let r=0,e=w.length;r<e;r++){var _=w[r],F=[];let e;for(let t=0,i=_.length;t<i;t++)isValid_default(_[t].indicatorKey)?e=_[t].indicatorKey:F.push(_[t].value);c.push({colKey:F,indicatorKey:e})}}for(let I=0;I<g.length;I++){var S=g[I].rowKey;let i;this.indicatorsAsCol||(i=g[I].indicatorKey);for(let e=0;e<c.length;e++){var x,R,T,A=c[e].colKey,P=(this.indicatorsAsCol&&(i=c[e].indicatorKey),S.join(this.stringJoinChar)),B=A.join(this.stringJoinChar);if(u){this.totalRecordsTree[P]||(this.totalRecordsTree[P]={}),this.totalRecordsTree[P][B]||(this.totalRecordsTree[P][B]=[]);const k=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<k.length;t++)0<=this.calculatedFiledKeys.indexOf(k[t])?(x=null==(x=this.calculatedFieldRules)?void 0:x.find(e=>e.key===k[t]),null!=(R=null==(R=this.totalRecordsTree[P])?void 0:R[B])&&R[t]||(this.totalRecordsTree[P][B][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:k[t],field:k[t],isRecord:!0,formatFun:null==(R=null==(R=this.indicators)?void 0:R.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===k[t]))?void 0:R.format,calculateFun:null==x?void 0:x.calculateFun,dependAggregators:this.totalRecordsTree[P][B],dependIndicatorKeys:null==x?void 0:x.dependIndicatorKeys})),k[t]in r&&null!=(x=null==(R=this.totalRecordsTree[P])?void 0:R[B])&&x[t].push(r)):(R=this.getAggregatorRule(k[t]),null!=(n=null==(x=this.totalRecordsTree[P])?void 0:x[B])&&n[t]||(this.totalRecordsTree[P][B][t]=new registeredAggregators[null!=(n=null==R?void 0:R.aggregationType)?n:AggregationType.SUM]({key:k[t],field:null!=(n=null==R?void 0:R.field)?n:k[t],aggregationFun:null==R?void 0:R.aggregationFun,formatFun:null!=(n=null==R?void 0:R.formatFun)?n:null==(n=null==(n=this.indicators)?void 0:n.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===k[t]))?void 0:n.format})),k[t]in r&&null!=(n=null==(n=this.totalRecordsTree[P])?void 0:n[B])&&n[t].push(r));return}0===S.length||this.rowFlatKeys[P]||(this.rowKeys.push(S),this.rowFlatKeys[P]=1),0===A.length||this.colFlatKeys[B]||(this.colKeys.push(A),this.colFlatKeys[B]=1),this.tree[P]||(this.tree[P]={}),null!=(A=this.tree[P])&&A[B]||(this.tree[P][B]=[]);const L=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<L.length;t++)if(0<=this.calculatedFiledKeys.indexOf(L[t])){var M=null==(M=this.calculatedFieldRules)?void 0:M.find(e=>e.key===L[t]);null!=(E=null==(E=this.tree[P])?void 0:E[B])&&E[t]||(this.tree[P][B][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:L[t],field:L[t],isRecord:!0,formatFun:null==(E=null==(E=this.indicators)?void 0:E.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===L[t]))?void 0:E.format,calculateFun:null==M?void 0:M.calculateFun,dependAggregators:this.tree[P][B],dependIndicatorKeys:null==M?void 0:M.dependIndicatorKeys})),null!=(M=null==(E=this.tree[P])?void 0:E[B])&&M[t].push(r)}else{var E=this.getAggregatorRule(L[t]);let e=!1;i?o===i?L[t]===i&&(e=!0):L[t]===i&&L[t]in r&&(e=!0):null!=E&&E.field?\\\"string\\\"==typeof(null==E?void 0:E.field)?(null==E?void 0:E.field)in r&&(e=!0):null!=E&&E.field.find(e=>e in r)&&(e=!0):L[t]in r&&(e=!0),null!=(a=null==(M=this.tree[P])?void 0:M[B])&&a[t]||!e||(this.tree[P][B][t]=new registeredAggregators[null!=(a=null==E?void 0:E.aggregationType)?a:AggregationType.SUM]({key:L[t],field:null!=(a=null==E?void 0:E.field)?a:L[t],aggregationFun:null==E?void 0:E.aggregationFun,formatFun:null!=(a=null==E?void 0:E.formatFun)?a:null==(a=null==(a=this.indicators)?void 0:a.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===L[t]))?void 0:a.format})),!e||null!=(a=null==(a=this.tree[P])?void 0:a[B])&&a[t].push(r)}if(this.mappingRules)for(let t=0;t<this.indicatorKeys.length;t++)this.indicatorStatistics[t]||(T=this.getAggregatorRule(this.indicatorKeys[t]),this.indicatorStatistics[t]={max:new registeredAggregators[AggregationType.MAX]({key:this.indicatorKeys[t],field:this.indicatorKeys[t]}),min:new registeredAggregators[AggregationType.MIN]({key:this.indicatorKeys[t],field:this.indicatorKeys[t]}),total:new registeredAggregators[null!=(l=null==T?void 0:T.aggregationType)?l:AggregationType.SUM]({key:this.indicatorKeys[t],field:null!=(l=null==T?void 0:T.field)?l:this.indicatorKeys[t],aggregationFun:null==T?void 0:T.aggregationFun,formatFun:null!=(l=null==T?void 0:T.formatFun)?l:null==(l=null==(T=this.indicators)?void 0:T.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===this.indicatorKeys[t]))?void 0:l.format})}),this.indicatorStatistics[t].max.push(null==(l=null==(T=this.tree[P])?void 0:T[B])?void 0:l[t].value()),this.indicatorStatistics[t].min.push(null==(s=null==(s=this.tree[P])?void 0:s[B])?void 0:s[t].value()),this.indicatorStatistics[t].total.push(r)}}}updateSortRules(e){var t;this.sorted=!1,this.sortRules=e,this.sortKeys(),this.customRowTree||(\\\"tree\\\"===this.rowHierarchyType?this.rowHeaderTree=this.ArrToTree1(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,(null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotalsOnTop)&&t):this.rowHeaderTree=this.ArrToTree(this.rowKeys,this.rows.filter((e,t)=>this.rowsHasValue[t]),this.indicatorsAsCol?void 0:this.indicators,this.rowsIsTotal,(null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotals)||this.indicatorsAsCol&&0===this.rows.length,this.rowGrandTotalLabel,this.rowSubTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showGrandTotalsOnTop)&&t,null!=(t=null==(t=null==(t=this.totals)?void 0:t.row)?void 0:t.showSubTotalsOnTop)&&t)),this.customColTree||(this.colHeaderTree=this.ArrToTree(this.colKeys,this.columns.filter((e,t)=>this.columnsHasValue[t]),this.indicatorsAsCol?this.indicators:void 0,this.colsIsTotal,(null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showGrandTotals)||!this.indicatorsAsCol&&0===this.columns.length,this.colGrandTotalLabel,this.colSubTotalLabel,null!=(t=null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showGrandTotalsOnLeft)&&t,null!=(t=null==(t=null==(t=this.totals)?void 0:t.column)?void 0:t.showSubTotalsOnLeft)&&t))}updateFilterRules(e,t=!1){var i,r;if(this.filterRules=e,this.filteredRecords=void 0,t)this.tree={};else for(const o in this.tree)for(const n in this.tree[o])for(let e=0;e<this.tree[o][n].length;e++)null!=(i=this.tree[o][n][e])&&i.reset();this.collectedValues={},this.processRecords(),this.processCollectedValuesWithSumBy(),this.processCollectedValuesWithSortBy(),this.totalStatistics(),null!=(r=this.dataConfig)&&r.isPivotChart&&this.cacheDeminsionCollectedValues()}getAggregatorRule(i){var e;return null==(e=this.aggregationRules)?void 0:e.find((e,t)=>i===e.indicatorKey)}getAggregator(i=[],r=[],o,e=!0,n){var t,a=this.indicatorKeys.indexOf(o);let l,s;l=\\\"string\\\"==typeof i?i:(n&&\\\"row\\\"!==n.position||i.map((e,t)=>{e!==o||isValid_default(null==n?void 0:n.index)&&t!==n.index||i.splice(t,1)}),i.length<this.rows.length&&\\\"grid-tree\\\"===this.rowHierarchyType&&i[0]!==this.rowGrandTotalLabel&&null!=(h=null==(h=this.totals)?void 0:h.row)&&h.subTotalsDimensions&&1<=(null==(h=null==(h=null==(h=this.totals)?void 0:h.row)?void 0:h.subTotalsDimensions)?void 0:h.length)&&i[i.length-1]!==this.rowSubTotalLabel&&i.push(this.rowSubTotalLabel),join(i,this.stringJoinChar)),s=\\\"string\\\"==typeof r?r:(n&&\\\"col\\\"!==n.position||r.map((e,t)=>{e!==o||isValid_default(null==n?void 0:n.index)&&t!==n.index||r.splice(t,1)}),r.length<this.columns.length&&\\\"grid-tree\\\"===this.columnHierarchyType&&r[0]!==this.colGrandTotalLabel&&null!=(h=null==(h=this.totals)?void 0:h.column)&&h.subTotalsDimensions&&1<=(null==(h=null==(h=null==(h=this.totals)?void 0:h.column)?void 0:h.subTotalsDimensions)?void 0:h.length)&&r[r.length-1]!==this.colSubTotalLabel&&r.push(this.colSubTotalLabel),join(r,this.stringJoinChar));var h=null==(h=null==(h=this.tree[l])?void 0:h[s])?void 0:h[a];if(e&&isValid_default(null==(t=null==(t=this.changedTree[l])?void 0:t[s])?void 0:t[a])){const d=this.changedTree[l][s][a];return h?{value:()=>d,formatValue:h.formatValue,formatFun:h.formatFun,records:h.records,recalculate(){},push(){},deleteRecord(){},updateRecord(){},clearCacheValue(){},reset(){}}:{records:[],value:()=>d,push(){},deleteRecord(){},updateRecord(){},recalculate(){},formatValue:()=>d,clearCacheValue(){},reset(){}}}return h||{records:[],push(){},deleteRecord(){},updateRecord(){},recalculate(){},value:()=>null,clearCacheValue(){},reset(){}}}sortKeys(){var e;this.colKeys=this.colKeys_normal.slice(),this.rowKeys=this.rowKeys_normal.slice(),this.sorted||(this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rows,!0)),e=this.arrSort(this.columns,!1),this.colKeys.sort(e))}arrSort(h,d){let o;const u=this,c=(function(e){var i=[];for(let r=0,t=h.length;r<t;r++){o=h[r];if(u.sortRules)for(let e=0,t=u.sortRules.length;e<t;e++)u.sortRules[e].sortField===o&&i.push({field:o,fieldIndex:r,sortRule:u.sortRules[e],func:u.getSort(u.sortRules[e],d)})}return i}).call(this);return function(i,r){let e,o,t,n,a,l;for(let s=0;s<c.length;s++){if(null!=(e=(l=c[s]).sortRule)&&e.sortByIndicator){let e=i,t=r;l.fieldIndex<h.length-1&&(e=i.slice(0,l.fieldIndex+1),\\\"grid\\\"===u.rowHierarchyType&&d?e.push(u.rowSubTotalLabel):d||e.push(u.colSubTotalLabel),t=r.slice(0,l.fieldIndex+1),\\\"grid\\\"===u.rowHierarchyType&&d?t.push(u.rowSubTotalLabel):d||t.push(u.colSubTotalLabel)),a=l.func(e,t,null==(o=l.sortRule)?void 0:o.sortType)}else a=null==(t=l.func)?void 0:t.call(l,i[l.fieldIndex],r[l.fieldIndex],null==(n=l.sortRule)?void 0:n.sortType);if(0!==a)return a}return 0}}getSort(o,n){const a=this;return o.sortByIndicator?(e,t,i)=>{var r=function(e,t){return\\\"grid\\\"===a.rowHierarchyType&&e.length<a.rows.length&&e[e.length-1]!==a.rowSubTotalLabel&&e[e.length-1]!==a.rowGrandTotalLabel&&e.push(a.rowSubTotalLabel),t.length<a.columns.length&&t[t.length-1]!==a.colSubTotalLabel&&t[t.length-1]!==a.colGrandTotalLabel&&t.push(a.colSubTotalLabel),a.getAggregator(e,t,o.sortByIndicator).value()};return n?o.sortFunc?o.sortFunc(r(e,o.query),r(t,o.query),e,t,i):naturalSort(r(e,o.query),r(t,o.query),i):o.sortFunc?o.sortFunc(r(o.query,e),r(o.query,t),e,t,i):naturalSort(r(o.query,e),r(o.query,t),i)}:o.sortBy?sortBy(o.sortBy):o.sortFunc||(o.sortType?typeSort:naturalSort)}totalStatistics(){var e;const C=this,v=(i,r)=>{var o,n,a,e,l;if(null!=(a=null==(a=this.totalRecordsTree)?void 0:a[i])&&a[r])this.tree[i]||(this.tree[i]={}),this.tree[i][r]=null==(a=null==(a=this.totalRecordsTree)?void 0:a[i])?void 0:a[r];else{var s=r.split(this.stringJoinChar);if(null!=(a=null==(a=C.totals)?void 0:a.column)&&a.subTotalsDimensions&&0<(null==(a=null==(a=null==(a=C.totals)?void 0:a.column)?void 0:a.subTotalsDimensions)?void 0:a.length)&&!1!==C.totals.column.showSubTotals)for(let e=0,t=null==(a=null==(a=null==(a=C.totals)?void 0:a.column)?void 0:a.subTotalsDimensions)?void 0:a.length;e<t;e++){var h=C.totals.column.subTotalsDimensions[e],h=C.columns.indexOf(h);if(0<=h){var d,u,h=s.slice(0,h+1),c=(h.push(C.colSubTotalLabel),h.join(this.stringJoinChar));if(null!=(h=null==(h=this.totalRecordsTree)?void 0:h[i])&&h[c])return void(this.tree[i][c]=null==(h=null==(h=this.totalRecordsTree)?void 0:h[i])?void 0:h[c]);this.tree[i][c]||(this.tree[i][c]=[]);const m=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<m.length;t++)0<=this.calculatedFiledKeys.indexOf(m[t])?(d=null==(d=this.calculatedFieldRules)?void 0:d.find(e=>e.key===m[t]),null!=(u=null==(u=this.tree[i])?void 0:u[c])&&u[t]||(this.tree[i][c][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:m[t],field:m[t],isRecord:!0,formatFun:null==(u=null==(u=this.indicators)?void 0:u.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===m[t]))?void 0:u.format,calculateFun:null==d?void 0:d.calculateFun,dependAggregators:this.tree[i][c],dependIndicatorKeys:null==d?void 0:d.dependIndicatorKeys})),c!==r&&this.tree[i][c][t].push(null==(d=null==(u=C.tree[i])?void 0:u[r])?void 0:d[t])):(this.tree[i][c][t]||(u=this.getAggregatorRule(m[t]),this.tree[i][c][t]=new registeredAggregators[null!=(d=null==u?void 0:u.aggregationType)?d:AggregationType.SUM]({key:m[t],field:null!=(o=null==u?void 0:u.field)?o:m[t],aggregationFun:null==u?void 0:u.aggregationFun,formatFun:null!=(o=null==u?void 0:u.formatFun)?o:null==(o=null==(o=this.indicators)?void 0:o.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===m[t]))?void 0:o.format})),c!==r&&this.tree[i][c][t].push(null==(n=null==(o=C.tree[i])?void 0:o[r])?void 0:n[t]))}}if(null!=(a=null==(a=C.totals)?void 0:a.column)&&a.showGrandTotals||0===this.rows.length){var g,p,f=C.colGrandTotalLabel;if(null!=(a=null==(a=this.totalRecordsTree)?void 0:a[i])&&a[f])this.tree[i][f]=null==(a=null==(a=this.totalRecordsTree)?void 0:a[i])?void 0:a[f];else{this.tree[i][f]||(this.tree[i][f]=[]);const b=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<b.length;t++)0<=this.calculatedFiledKeys.indexOf(b[t])?(g=null==(g=this.calculatedFieldRules)?void 0:g.find(e=>e.key===b[t]),null!=(p=null==(p=this.tree[i])?void 0:p[f])&&p[t]||(this.tree[i][f][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:b[t],field:b[t],isRecord:!0,formatFun:null==(p=null==(p=this.indicators)?void 0:p.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===b[t]))?void 0:p.format,calculateFun:null==g?void 0:g.calculateFun,dependAggregators:this.tree[i][f],dependIndicatorKeys:null==g?void 0:g.dependIndicatorKeys})),f!==r&&this.tree[i][f][t].push(null==(g=null==(p=C.tree[i])?void 0:p[r])?void 0:g[t])):(this.tree[i][f][t]||(p=this.getAggregatorRule(b[t]),this.tree[i][f][t]=new registeredAggregators[null!=(g=null==p?void 0:p.aggregationType)?g:AggregationType.SUM]({key:b[t],field:null!=(e=null==p?void 0:p.field)?e:b[t],formatFun:null!=(e=null==p?void 0:p.formatFun)?e:null==(e=null==(e=this.indicators)?void 0:e.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===b[t]))?void 0:e.format})),f!==r&&this.tree[i][f][t].push(null==(l=null==(e=C.tree[i])?void 0:e[r])?void 0:l[t]))}}}};if(null!=(e=null==(e=null==C?void 0:C.totals)?void 0:e.column)&&e.subTotalsDimensions&&1<=(null==(e=null==(e=null==(e=null==C?void 0:C.totals)?void 0:e.column)?void 0:e.subTotalsDimensions)?void 0:e.length)||null!=(e=null==(e=null==C?void 0:C.totals)?void 0:e.row)&&e.subTotalsDimensions&&1<=(null==(e=null==(e=null==(e=null==C?void 0:C.totals)?void 0:e.row)?void 0:e.subTotalsDimensions)?void 0:e.length)||null!=(e=null==(e=null==C?void 0:C.totals)?void 0:e.column)&&e.showGrandTotals||null!=(e=null==(e=null==C?void 0:C.totals)?void 0:e.row)&&e.showGrandTotals){const y=[];Object.keys(C.tree).forEach(m=>{const b=m.split(this.stringJoinChar);Object.keys(C.tree[m]).forEach(i=>{var r,o,n,e,a;if(null!=(n=null==(n=C.totals)?void 0:n.row)&&n.subTotalsDimensions&&0<(null==(n=null==(n=null==(n=C.totals)?void 0:n.row)?void 0:n.subTotalsDimensions)?void 0:n.length)&&!1!==C.totals.row.showSubTotals)for(let e=0,t=null==(n=null==(n=null==(n=C.totals)?void 0:n.row)?void 0:n.subTotalsDimensions)?void 0:n.length;e<t;e++){var l=C.totals.row.subTotalsDimensions[e],l=C.rows.indexOf(l);if(0<=l&&l<C.rows.length-1){var s,h,l=b.slice(0,l+1),d=(\\\"tree\\\"!==this.rowHierarchyType&&l.push(C.rowSubTotalLabel),l.join(this.stringJoinChar));this.tree[d]||(this.tree[d]={},y.push(d)),this.tree[d][i]||(this.tree[d][i]=[]);const p=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<p.length;t++)this.tree[d][i][t]||(0<=this.calculatedFiledKeys.indexOf(p[t])?(s=null==(s=this.calculatedFieldRules)?void 0:s.find(e=>e.key===p[t]),this.tree[d][i][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:p[t],field:p[t],isRecord:!0,formatFun:null==(h=null==(h=this.indicators)?void 0:h.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===p[t]))?void 0:h.format,calculateFun:null==s?void 0:s.calculateFun,dependAggregators:this.tree[d][i],dependIndicatorKeys:null==s?void 0:s.dependIndicatorKeys})):(h=this.getAggregatorRule(p[t]),this.tree[d][i][t]=new registeredAggregators[null!=(s=null==h?void 0:h.aggregationType)?s:AggregationType.SUM]({key:p[t],field:null!=(r=null==h?void 0:h.field)?r:p[t],formatFun:null!=(r=null==h?void 0:h.formatFun)?r:null==(r=null==(r=this.indicators)?void 0:r.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===p[t]))?void 0:r.format}))),d!==m&&this.tree[d][i][t].push(null==(o=null==(r=C.tree[m])?void 0:r[i])?void 0:o[t])}}if(null!=(n=null==(n=C.totals)?void 0:n.row)&&n.showGrandTotals||0===this.columns.length){var u,c,g=C.rowGrandTotalLabel;this.tree[g]||(this.tree[g]={},y.push(g)),this.tree[g][i]||(this.tree[g][i]=[]);const f=this.indicatorKeysIncludeCalculatedFieldDependIndicatorKeys;for(let t=0;t<f.length;t++)this.tree[g][i][t]||(0<=this.calculatedFiledKeys.indexOf(f[t])?(u=null==(u=this.calculatedFieldRules)?void 0:u.find(e=>e.key===f[t]),this.tree[g][i][t]=new registeredAggregators[AggregationType.RECALCULATE]({key:f[t],field:f[t],isRecord:!0,formatFun:null==(c=null==(c=this.indicators)?void 0:c.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===f[t]))?void 0:c.format,calculateFun:null==u?void 0:u.calculateFun,dependAggregators:this.tree[g][i],dependIndicatorKeys:null==u?void 0:u.dependIndicatorKeys})):(c=this.getAggregatorRule(f[t]),this.tree[g][i][t]=new registeredAggregators[null!=(u=null==c?void 0:c.aggregationType)?u:AggregationType.SUM]({key:f[t],field:null!=(e=null==c?void 0:c.field)?e:f[t],formatFun:null!=(e=null==c?void 0:c.formatFun)?e:null==(e=null==(e=this.indicators)?void 0:e.find(e=>\\\"string\\\"!=typeof e&&e.indicatorKey===f[t]))?void 0:e.format}))),g!==m&&this.tree[g][i][t].push(null==(a=null==(e=C.tree[m])?void 0:e[i])?void 0:a[t])}v(m,i)})}),y.forEach(t=>{Object.keys(C.tree[t]).forEach(e=>{v(t,e)})})}for(const t in C.totalRecordsTree)for(const i in C.totalRecordsTree[t])v(t,i)}ArrToTree1(e,h,d,t,i,u){const c=[],g=this.stringJoinChar,p=new Map;function r(n,a){const l=[];let s;n.forEach((e,t)=>{l.push(e);var i,r=l.join(g);let o=p.get(r);o||(o={value:e,dimensionKey:h[t],children:t===n.length-1&&1<=(null!=(i=null==d?void 0:d.length)?i:0)?null==d?void 0:d.map(e=>\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[]},p.set(r,o),s?s.children.push(o):u&&a?c.unshift(o):c.push(o)),s=o})}return e.forEach(e=>r(e,!1)),t&&r([i],t),c}ArrToTree(e,s,h,d,t,i,u,r,c){let o,g=[];const p=this.stringJoinChar,f=new Map;var n;return null!=e&&e.length?e.forEach(e=>{{var a=e;const l=[];let n;a.forEach((e,t)=>{l.push(e);var i=l.join(p);let r=f.get(i);if(!r){if(r={value:e,dimensionKey:s[t],children:t===a.length-1&&1<=(null!=(o=null==h?void 0:h.length)?o:0)?null==h?void 0:h.map(e=>\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[]},d[t]){let e=null!=(o=r.children)?o:[];var o={value:u,dimensionKey:s[t+1],levelSpan:d.length-t-1,children:1<=(null!=(o=null==h?void 0:h.length)?o:0)?null==h?void 0:h.map(e=>\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}):[],role:\\\"sub-total\\\"};e.push(o),e=null!=(o=o.children)?o:[]}f.set(i,r),n?d[t-1]&&!c?n.children.splice(n.children.length-1,0,r):n.children.push(r):g.push(r)}n=r})}}):h&&(g=null==h?void 0:h.map(e=>{var t;return\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:null!=(t=e.title)?t:e.indicatorKey}})),t&&null!=e&&e.length&&(n={value:i,dimensionKey:s[0],levelSpan:d.length,children:null!=(o=null==h?void 0:h.map(e=>\\\"string\\\"==typeof e?{indicatorKey:e,value:e}:{indicatorKey:e.indicatorKey,value:e.title}))?o:[],role:\\\"grand-total\\\"},r?g.unshift(n):g.push(n)),g}cacheDeminsionCollectedValues(){for(const e in this.collectValuesBy)\\\"xField\\\"!==this.collectValuesBy[e].type&&\\\"yField\\\"!==this.collectValuesBy[e].type||(this.dataConfig.dimensionSortArray?this.cacheCollectedValues[e]=arraySortByAnotherArray(this.collectedValues[e],this.dataConfig.dimensionSortArray):this.cacheCollectedValues[e]=this.collectedValues[e])}changeTreeNodeValue(e=[],t=[],i,r){var o,n=this.indicatorKeys.indexOf(i),a=\\\"string\\\"==typeof e?e:e.join(this.stringJoinChar),l=\\\"string\\\"==typeof t?t:t.join(this.stringJoinChar),l=(null!=(o=this.changedTree[a])&&o[l]||(this.changedTree[a]||(this.changedTree[a]={}),this.changedTree[a][l]=[]),this.changedTree[a][l][n]=r,null==(a=null==(o=this.tree[a])?void 0:o[l])?void 0:a[n]);1===(null==l?void 0:l.records.length)&&(l.records[0][this.indicatorKeys[n]]=r)}changeRecordFieldValue(i,r,o){let e=!1;for(let t=0;t<this.indicatorKeys.length;t++)this.indicatorKeys[t]===i&&(e=!0);if(!e){if(Array.isArray(this.records))for(let e=0,t=this.records.length;e<t;e++){var n=this.records[e];n[i]===r&&(n[i]=o)}else for(const l in this.records)for(let e=0,t=this.records[l].length;e<t;e++){var a=this.records[l][e];a[i]===r&&(a[i]=o)}this.rowFlatKeys={},this.colFlatKeys={},this.tree={},this.processRecords()}}_rowTreeHasChanged(){this.hasExtensionRowTree||(this.customRowTreeDimensionPaths=this.customTreeToDimensionPathArr(this.customRowTree,\\\"row\\\"))}changeDataConfig(e){this.rows=e.rows,this.columns=e.columns}addRecords(e){for(let i=0,r=e.length;i<r;i++){var t=e[i];this.processRecord(t)}Array.isArray(this.records)&&this.records.push(e)}customTreeToDimensionPathArr(e,o){const n=[],a=this;return null!=e&&e.forEach(e=>function r(e,t){var i;e.virtual||(null!=(i=t[t.length-1])&&i.childKeys&&e.dimensionKey&&-1===t[t.length-1].childKeys.indexOf(e.dimensionKey)&&e.dimensionKey!==t[t.length-1].dimensionKey&&t[t.length-1].childKeys.push(e.dimensionKey),t.push({dimensionKey:isValid_default(e.indicatorKey)?void 0:e.dimensionKey,value:e.value,indicatorKey:e.indicatorKey,virtual:e.virtual})),0<(null==(i=e.children)?void 0:i.length)?(\\\"tree\\\"===a.rowHierarchyType&&\\\"row\\\"===o&&(t[t.length-1].childKeys=[],n.push([...t])),null!=(i=e.children)&&i.forEach(e=>r(e,[...t]))):n.push(t)}(e,[])),n}getFieldMatchColDimensionPaths(i){var e,r=[];for(let a=0;a<(null!=(e=null==(e=this.customColTreeDimensionPaths)?void 0:e.length)?e:0);a++){var o=this.customColTreeDimensionPaths[a];let e=!0;for(let t=0;t<o.length;t++){var n=o[t];if(n.dimensionKey&&i[n.dimensionKey]!==n.value||n.indicatorKey&&void 0===i[n.indicatorKey]){e=!1;break}}e&&r.push(o)}return r}getFieldMatchRowDimensionPaths(i){var e,r=[];for(let a=0;a<(null!=(e=null==(e=this.customRowTreeDimensionPaths)?void 0:e.length)?e:0);a++){var o=this.customRowTreeDimensionPaths[a];let e=!0;for(let t=0;t<o.length;t++){var n=o[t];if(n.dimensionKey&&i[n.dimensionKey]!==n.value||n.indicatorKey&&void 0===i[n.indicatorKey]){e=!1;break}if(n.childKeys&&t===o.length-1&&0<n.childKeys.length&&n.childKeys.find(e=>isValid_default(i[e]))){e=!1;break}}(e=!e||this.indicatorsAsCol||\\\"tree\\\"!==this.rowHierarchyType||o.find(e=>e.indicatorKey)?e:!1)&&r.push(o)}return r}};function arraySortByAnotherArray(e,o){return e.sort((e,t)=>{var i=o.indexOf(e),r=o.indexOf(t);return i<r?-1:r<i?1:0})}var PivotTable=class extends BaseTable{constructor(e,i){if(\\\"node\\\"===Env.mode?(i=e,e=null):e instanceof HTMLElement||(e=(i=e).container||null),super(e,i),this.layoutNodeId={seqId:0},i){i.rowHierarchyType||(i.rowHierarchyType=\\\"grid\\\"),i.columnHierarchyType||(i.columnHierarchyType=\\\"grid\\\"),i.layout&&Object.assign(i,i.layout),this.internalProps.columns=cloneDeep(i.columns),this.internalProps.rows=cloneDeep(i.rows),this.internalProps.indicators=cloneDeepSpec(i.indicators),null!=(t=i.indicators)&&t.forEach((e,t)=>{\\\"object\\\"==typeof e&&null!=e&&e.editor&&(this.internalProps.indicators[t].editor=e.editor)}),this.internalProps.columnTree=!i.indicatorsAsCol||null!=(t=i.columns)&&t.length||i.columnTree?cloneDeep(i.columnTree):[],this.internalProps.rowTree=i.indicatorsAsCol||null!=(t=i.rows)&&t.length||i.rowTree?cloneDeep(i.rowTree):[],this.internalProps.records=i.records,this.pagination=i.pagination,this.internalProps.columnResizeType=null!=(t=null!=(t=null==(t=i.resize)?void 0:t.columnResizeType)?t:i.columnResizeType)?t:\\\"column\\\",this.internalProps.rowResizeType=null!=(t=null!=(t=null==(t=i.resize)?void 0:t.rowResizeType)?t:i.rowResizeType)?t:\\\"row\\\",this.internalProps.dataConfig=cloneDeep(i.dataConfig),this.internalProps.columnWidthConfig=i.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=i.columnWidthConfigForRowHeader;var t=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(r=null==t?void 0:t[0])?void 0:r.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(r=i.customConfig)?void 0:r.enableDataAnalysis)){var r=new DimensionTree(null!=(r=this.internalProps.columnTree)?r:[],this.layoutNodeId,this.options.columnHierarchyType,\\\"grid\\\"!==this.options.columnHierarchyType?null!=(r=this.options.columnExpandLevel)?r:1:void 0),o=new DimensionTree(null!=(o=this.internalProps.rowTree)?o:[],this.layoutNodeId,this.options.rowHierarchyType,\\\"grid\\\"!==this.options.rowHierarchyType?null!=(o=this.options.rowExpandLevel)?o:1:void 0);this.internalProps.layoutMap=new PivotHeaderLayoutMap(this,null,r,o),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new FlatDataToObjects({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey},t))}else{var r=parseColKeyRowKeyForPivotTable(this,i),{rowKeys:o,columnKeys:n,indicatorKeys:a}=r;let{columnDimensionTree:e,rowDimensionTree:t}=r;this.dataset=new Dataset(this.internalProps.dataConfig,o,n,a,this.internalProps.indicators,null==(r=i.indicatorsAsCol)||r,i.records,i.rowHierarchyType,i.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!i.extensionRows,!!i.parseCustomTreeToMatchRecords),i.columnTree?e.hasHideNode&&(deleteHideIndicatorNode(e.tree.children,i.indicators,!0,this),e.reset(e.tree.children)):(!1!==i.indicatorsAsCol&&(this.dataset.colHeaderTree=supplementIndicatorNodesForCustomTree(this.dataset.colHeaderTree,i.indicators)),!1!==i.indicatorsAsCol&&i.indicators&&this.dataset.colHeaderTree&&deleteHideIndicatorNode(this.dataset.colHeaderTree,i.indicators,!1,this),e=new DimensionTree(null!=(o=this.dataset.colHeaderTree)?o:[],this.layoutNodeId,this.options.columnHierarchyType,\\\"grid\\\"!==this.options.columnHierarchyType?null!=(n=this.options.columnExpandLevel)?n:1:void 0)),i.rowTree?t.hasHideNode&&(deleteHideIndicatorNode(t.tree.children,i.indicators,!0,this),t.reset(t.tree.children)):(!1===i.indicatorsAsCol&&(this.dataset.rowHeaderTree=supplementIndicatorNodesForCustomTree(this.dataset.rowHeaderTree,i.indicators)),!1===i.indicatorsAsCol&&this.dataset.rowHeaderTree&&i.indicators&&deleteHideIndicatorNode(this.dataset.rowHeaderTree,i.indicators,!1,this),t=new DimensionTree(null!=(a=this.dataset.rowHeaderTree)?a:[],this.layoutNodeId,this.options.rowHierarchyType,\\\"grid\\\"!==this.options.rowHierarchyType?null!=(r=this.options.rowExpandLevel)?r:1:void 0)),this.internalProps.layoutMap=new PivotHeaderLayoutMap(this,this.dataset,e,t)}this._changePivotSortStateBySortRules(),0<(null!=(n=null==(o=i.pivotSortState)?void 0:o.length)?n:0)&&(this.pivotSortState=[],this.pivotSortState=i.pivotSortState),\\\"node\\\"!==Env.mode&&(this.editorManager=new EditManager(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.stateManager.initCheckedState(t),this.scenegraph.createSceneGraph(),i.title&&(a=Factory2.getComponent(\\\"title\\\"),this.internalProps.title=new a(i.title,this),this.scenegraph.resize()),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(r=this.internalProps.emptyTip)&&r.resetVisible():(o=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new o(this.options.emptyTip,this),null!=(n=this.internalProps.emptyTip)&&n.resetVisible())),setTimeout(()=>{this.fireListeners(TABLE_EVENT_TYPE.INITIALIZED,null)},0)}}static get EVENT_TYPE(){return PIVOT_TABLE_EVENT_TYPE}isListTable(){return!1}isPivotTable(){return!0}isPivotChart(){return!1}get recordsCount(){var e;return null==(e=this.records)?void 0:e.length}_canResizeColumn(e,t){var i=super._canResizeColumn(e,t);if(i){if(this.internalProps.layoutMap.isSeriesNumber(e,t)&&!0===this.internalProps.rowSeriesNumber.disableColumnResize)return!1;if(!this.internalProps.layoutMap.indicatorsAsCol){var r=this.internalProps.layoutMap.getBody(e,this.columnHeaderLevelCount);if(null!=r&&r.disableColumnResize)return!1}}return i}updateOption(i){var r=this.internalProps;if(super.updateOption(i),i.rowHierarchyType||(i.rowHierarchyType=\\\"grid\\\"),i.columnHierarchyType||(i.columnHierarchyType=\\\"grid\\\"),this.layoutNodeId={seqId:0},this.internalProps.columns=cloneDeep(i.columns),this.internalProps.rows=cloneDeep(i.rows),this.internalProps.indicators=null!=(o=i.indicators)&&o.length?cloneDeepSpec(i.indicators):[],null!=(o=i.indicators)&&o.forEach((e,t)=>{\\\"object\\\"==typeof e&&null!=e&&e.editor&&(this.internalProps.indicators[t].editor=e.editor)}),this.internalProps.columnTree=!i.indicatorsAsCol||null!=(o=i.columns)&&o.length||i.columnTree?cloneDeep(i.columnTree):[],this.internalProps.rowTree=i.indicatorsAsCol||null!=(o=i.rows)&&o.length||i.rowTree?cloneDeep(i.rowTree):[],i.records&&(this.internalProps.records=i.records),this.stateManager.initCheckedState(this.internalProps.records),this.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1),this.pagination=i.pagination,r.columnResizeType=null!=(o=null!=(o=null==(o=i.resize)?void 0:o.columnResizeType)?o:i.columnResizeType)?o:\\\"column\\\",r.rowResizeType=null!=(o=null!=(o=null==(o=i.resize)?void 0:o.rowResizeType)?o:i.rowResizeType)?o:\\\"row\\\",r.dataConfig=cloneDeep(i.dataConfig),this.internalProps.columnWidthConfig=i.columnWidthConfig,this.internalProps.columnWidthConfigForRowHeader=i.columnWidthConfigForRowHeader,\\\"grid\\\"!==(null==i?void 0:i.rowHierarchyType)&&\\\"grid\\\"!==this.internalProps.layoutMap.rowHierarchyType&&this.internalProps.layoutMap.rowExpandLevel===(null==i?void 0:i.rowExpandLevel)){const h=this.internalProps.layoutMap.rowDimensionTree.tree.children;null!=(o=this.internalProps.rowTree)&&o.forEach((t,e)=>{var i=h.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value);i&&this._syncHierarchyState(i,t)})}var o=this.internalProps.records;if(this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(n=null==o?void 0:o[0])?void 0:n.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),!1===(null==(n=i.customConfig)?void 0:n.enableDataAnalysis)){let e,t;i.columnTree&&(e=new DimensionTree(null!=(n=this.internalProps.columnTree)?n:[],this.layoutNodeId,this.options.columnHierarchyType,\\\"grid\\\"!==this.options.columnHierarchyType?null!=(n=this.options.columnExpandLevel)?n:1:void 0)),i.rowTree&&(t=new DimensionTree(null!=(n=this.internalProps.rowTree)?n:[],this.layoutNodeId,this.options.rowHierarchyType,\\\"grid\\\"!==this.options.rowHierarchyType?null!=(n=this.options.rowExpandLevel)?n:1:void 0)),r.layoutMap.clearHeaderPathCache(),r.layoutMap=new PivotHeaderLayoutMap(this,null,e,t),!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new FlatDataToObjects({rows:r.layoutMap.fullRowDimensionKeys,columns:r.layoutMap.colDimensionKeys,indicators:r.layoutMap.indicatorKeys,indicatorsAsCol:r.layoutMap.indicatorsAsCol,indicatorDimensionKey:r.layoutMap.indicatorDimensionKey},o))}else{var n=parseColKeyRowKeyForPivotTable(this,i),{rowKeys:a,columnKeys:l,indicatorKeys:s}=n;let{columnDimensionTree:e,rowDimensionTree:t}=n;this.dataset=new Dataset(r.dataConfig,a,l,s,this.internalProps.indicators,null==(n=i.indicatorsAsCol)||n,o,i.rowHierarchyType,i.columnHierarchyType,this.internalProps.columnTree,this.internalProps.rowTree,!1,!!i.extensionRows,!!i.parseCustomTreeToMatchRecords),i.columnTree?e.hasHideNode&&(deleteHideIndicatorNode(e.tree.children,i.indicators,!0,this),e.reset(e.tree.children)):(!1!==i.indicatorsAsCol&&(this.dataset.colHeaderTree=supplementIndicatorNodesForCustomTree(this.dataset.colHeaderTree,i.indicators)),!1!==i.indicatorsAsCol&&i.indicators&&this.dataset.colHeaderTree&&deleteHideIndicatorNode(this.dataset.colHeaderTree,i.indicators,!1,this),e=new DimensionTree(null!=(a=this.dataset.colHeaderTree)?a:[],this.layoutNodeId,this.options.columnHierarchyType,\\\"grid\\\"!==this.options.columnHierarchyType?null!=(l=this.options.columnExpandLevel)?l:1:void 0)),i.rowTree?t.hasHideNode&&(deleteHideIndicatorNode(t.tree.children,i.indicators,!0,this),t.reset(t.tree.children)):(!1===i.indicatorsAsCol&&(this.dataset.rowHeaderTree=supplementIndicatorNodesForCustomTree(this.dataset.rowHeaderTree,i.indicators)),!1===i.indicatorsAsCol&&this.dataset.rowHeaderTree&&i.indicators&&deleteHideIndicatorNode(this.dataset.rowHeaderTree,i.indicators,!1,this),t=new DimensionTree(null!=(s=this.dataset.rowHeaderTree)?s:[],this.layoutNodeId,this.options.rowHierarchyType,\\\"grid\\\"!==this.options.rowHierarchyType?null!=(n=this.options.rowExpandLevel)?n:1:void 0)),r.layoutMap=new PivotHeaderLayoutMap(this,this.dataset,e,t)}return this._changePivotSortStateBySortRules(),0<(null!=(a=null==(o=i.pivotSortState)?void 0:o.length)?a:0)&&(this.pivotSortState=[],this.pivotSortState=i.pivotSortState),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,r.releaseList&&(r.releaseList.forEach(e=>{var t;return null==(t=null==e?void 0:e.release)?void 0:t.call(e)}),r.releaseList=null),this.scenegraph.clearCells(),this.scenegraph.createSceneGraph(),i.title&&(l=Factory2.getComponent(\\\"title\\\"),this.internalProps.title=new l(i.title,this),this.scenegraph.resize()),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(s=this.internalProps.emptyTip)&&s.resetVisible():(n=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new n(this.options.emptyTip,this),null!=(o=this.internalProps.emptyTip)&&o.resetVisible())),new Promise(e=>{setTimeout(e,0)})}updatePagination(e){this.internalProps.layoutMap.clearHeaderPathCache(),e?(this.pagination||(this.pagination={currentPage:0,perPageCount:0}),\\\"number\\\"==typeof e.currentPage&&0<=e.currentPage&&(this.pagination.currentPage=e.currentPage),e.perPageCount&&(this.pagination.perPageCount=e.perPageCount||this.pagination.perPageCount),this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(this.pagination),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()):this.pagination&&(this.pagination=void 0,this.scenegraph.clearCells(),this.internalProps.layoutMap.setPagination(void 0),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render())}refreshHeader(){this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var e,t=this.internalProps.layoutMap;t&&(this.colCount=null!=(e=t.colCount)?e:0,this.rowCount=null!=(e=t.rowCount)?e:0,this.internalProps.frozenColCount=this.options.frozenColCount||(null!=(e=t.rowHeaderLevelCount)?e:0)+t.leftRowSeriesNumberColumnCount,this.frozenRowCount=Math.max(t.headerLevelCount,null!=(e=this.options.frozenRowCount)?e:0),this.bottomFrozenRowCount!==(null!=(t=this.options.bottomFrozenRowCount)?t:0)&&(this.bottomFrozenRowCount=null!=(e=this.options.bottomFrozenRowCount)?e:0),this.rightFrozenColCount!==(null!=(t=this.options.rightFrozenColCount)?t:0)&&(this.rightFrozenColCount=null!=(e=this.options.rightFrozenColCount)?e:0),this.stateManager.setFrozenCol(this.internalProps.frozenColCount),this.stateManager.setFrozenRow(this.frozenRowCount))}_getSortFuncFromHeaderOption(e,t,i){}get rowHierarchyType(){return this.internalProps.layoutMap.rowHierarchyType}get columnHierarchyType(){return this.internalProps.layoutMap.columnHierarchyType}_syncHierarchyState(r,e){var t;r.value===e.value&&r.dimensionKey===e.dimensionKey&&(e.hierarchyState=null!=(t=e.hierarchyState)?t:null!=e&&e.children?r.hierarchyState:void 0,null!=(t=null==e?void 0:e.children))&&t.forEach((t,e)=>{var i;null!=(i=null==r?void 0:r.children)&&i[e]&&t&&(i=r.children.find(e=>e.dimensionKey===t.dimensionKey&&e.value===t.value))&&this._syncHierarchyState(i,t)})}getRecordShowIndexByCell(e,t){}getTableIndexByRecordIndex(e){}getTableIndexByField(e){}getCellAddrByFieldRecord(e,t){}getBodyIndexByRow(e){var t=this.internalProps.layoutMap;return t.getBodyIndexByRow(e)}getBodyIndexByCol(e){var t=this.internalProps.layoutMap;return t.getBodyIndexByCol(e)}getFieldData(e,t,i){if(!this.internalProps.layoutMap.isHeader(t,i)){if(this.internalProps.recordsIsTwoDimensionalArray)return n=this.getBodyIndexByRow(i),o=this.getBodyIndexByCol(t),null==(n=this.records[n])?void 0:n[o];if(this.dataset){var o=this.internalProps.layoutMap.getCellHeaderPaths(t,i);if(o){let r;var n=null==(n=o.colHeaderPaths)?void 0:n.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),o=null==(o=o.rowHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),o=this.dataset.getAggregator(o,n,this.internalProps.layoutMap.getIndicatorKey(t,i),!0,r);if(o.records&&1<=o.records.length)return o.records[0][e]}}else if(this.flatDataToObjects)return o=(n=this.internalProps.layoutMap.getCellHeaderPaths(t,i)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=n.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),null==(n=this.flatDataToObjects.getTreeNode(n,o,this.internalProps.layoutMap.getBody(t,i).indicatorKey,!1))||!n.record||null==n?void 0:n.record[e]}}getCellValue(e,t,i){if(!i){var o=this.getCustomMergeValue(e,t);if(o)return o}if(this.internalProps.layoutMap.isSeriesNumber(e,t))return this.internalProps.layoutMap.isSeriesNumberInHeader(e,t)?(o=this.internalProps.layoutMap.getSeriesNumberHeader(e,t).title,o):(o=this.internalProps.layoutMap.getSeriesNumberBody(e,t).format,\\\"function\\\"==typeof o?o(e,t,this):t-this.columnHeaderLevelCount+1);if(this.internalProps.layoutMap.isHeader(e,t))return({title:o,fieldFormat:n}=this.internalProps.layoutMap.getHeader(e,t)),\\\"function\\\"==typeof n?n(o,e,t,this):o;if(this.internalProps.recordsIsTwoDimensionalArray)return n=this.internalProps.layoutMap.getBody(e,t).fieldFormat,o=this.getBodyIndexByRow(t),a=this.getBodyIndexByCol(e),a=null==(o=this.records[o])?void 0:o[a],\\\"function\\\"==typeof n?n(a,e,t,this):a;if(this.dataset){var o=this.internalProps.layoutMap.getCellHeaderPaths(e,t);let r;var n=null==(a=null==(n=o.colHeaderPaths)?void 0:n.filter(e=>!e.virtual))?void 0:a.map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),a=null==(o=null==(a=o.rowHeaderPaths)?void 0:a.filter(e=>!e.virtual))?void 0:o.map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),o=this.dataset.getAggregator(a,n,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r),a=this.internalProps.layoutMap.getBody(e,t).fieldFormat;return o.formatValue?o.formatValue(e,t,this):\\\"function\\\"==typeof a?a(null==o?void 0:o.value(),e,t,this):null!=(n=null==o?void 0:o.value())?n:\\\"\\\"}return this.flatDataToObjects?(o=(a=this.internalProps.layoutMap.getCellHeaderPaths(e,t)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=a.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),a=this.flatDataToObjects.getTreeNode(n,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey),n=this.internalProps.layoutMap.getBody(e,t).fieldFormat,\\\"function\\\"==typeof n?n(null==a?void 0:a.value,e,t,this):null!=(o=null==a?void 0:a.value)?o:\\\"\\\"):void 0}getCellOriginValue(e,t){if(this.internalProps.layoutMap.isHeader(e,t))return o=this.internalProps.layoutMap.getHeader(e,t).title,\\\"function\\\"==typeof o?o():o;if(this.internalProps.recordsIsTwoDimensionalArray)return o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e),null==(o=this.records[o])?void 0:o[i];if(this.dataset){let r;var i=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=null==(o=i.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=null==(i=i.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=this.dataset.getAggregator(i,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r);return i.value?i.value():void 0}return!this.flatDataToObjects||(i=(o=this.internalProps.layoutMap.getCellHeaderPaths(e,t)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),o=o.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),null==(o=this.flatDataToObjects.getTreeNode(o,i,this.internalProps.layoutMap.getBody(e,t).indicatorKey)))?void 0:o.value}getCellRawValue(e,t){if(this.internalProps.layoutMap.isHeader(e,t))return o=this.internalProps.layoutMap.getHeader(e,t).title,\\\"function\\\"==typeof o?o():o;if(this.internalProps.recordsIsTwoDimensionalArray)return o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e),null==(o=this.records[o])?void 0:o[i];if(this.dataset){let r;var i=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=null==(o=i.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=null==(i=i.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=this.dataset.getAggregator(i,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,r);return i.value?i.value():void 0}return!this.flatDataToObjects||(i=(o=this.internalProps.layoutMap.getCellHeaderPaths(e,t)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),o=o.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),null==(o=this.flatDataToObjects.getTreeNode(o,i,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1)))?void 0:o.value}getCellOriginRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray)return o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e),null==(o=this.records[o])?void 0:o[i];if(this.dataset){let r;var i=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=null==(o=i.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=null==(i=i.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value});return this.dataset.getAggregator(i,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!0,r).records}return this.flatDataToObjects?(o=(i=this.internalProps.layoutMap.getCellHeaderPaths(e,t)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=i.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),null==(i=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey))?void 0:i.record):void 0}}getCellRawRecord(e,t){if(!this.internalProps.layoutMap.isHeader(e,t)){if(this.internalProps.recordsIsTwoDimensionalArray)return o=this.getBodyIndexByRow(t),i=this.getBodyIndexByCol(e),null==(o=this.records[o])?void 0:o[i];if(this.dataset){let r;var i=this.internalProps.layoutMap.getCellHeaderPaths(e,t),o=null==(o=i.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"col\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value}),i=null==(i=i.rowHeaderPaths)?void 0:i.filter(e=>!e.virtual).map((e,t)=>{var i;return e.indicatorKey&&(r={position:\\\"row\\\",index:t}),null!=(i=e.indicatorKey)?i:e.value});return this.dataset.getAggregator(i,o,this.internalProps.layoutMap.getIndicatorKey(e,t),!1,r).records}return this.flatDataToObjects?(o=(i=this.internalProps.layoutMap.getCellHeaderPaths(e,t)).colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),i=i.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),null==(i=this.flatDataToObjects.getTreeNode(i,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,!1))?void 0:i.record):void 0}}updateSortRules(e,t,i){this.internalProps.dataConfig?this.internalProps.dataConfig.sortRules=e:this.internalProps.dataConfig={sortRules:e},this.dataset.updateSortRules(e),this._changePivotSortStateBySortRules();var r=this.internalProps.layoutMap;r.resetHeaderTree(),this.scenegraph.clearCells(),isNumber_default(t)&&isNumber_default(i)?(this.isRowHeader(t,i)?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):this.isCornerHeader(t,i)?\\\"column\\\"===r.cornerSetting.titleOnDimension?(this.setMinMaxLimitWidth(!0),this.internalProps._widthResizedColMap.clear()):\\\"row\\\"===r.cornerSetting.titleOnDimension&&this.internalProps._heightResizedRowMap.clear():this.isColumnHeader(t,i)&&this.internalProps._heightResizedRowMap.clear(),this.refreshRowColCount()):this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.createSceneGraph(!0),this.render()}_changePivotSortStateBySortRules(){this.pivotSortState=[];var e,t=null!=(e=null==(e=this.internalProps.dataConfig)?void 0:e.sortRules)?e:[];for(let n=0;n<t.length;n++){var i=t[n],r=[];if(i.sortByIndicator&&i.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1])){for(let e=0;e<i.query.length;e++)r.push({dimensionKey:(this.dataset.indicatorsAsCol?this.dataset.columns:this.dataset.rows)[e],value:i.query[e]});r.push({indicatorKey:i.sortByIndicator,value:null!=(o=null==(o=this.internalProps.layoutMap.getIndicatorInfo(i.sortByIndicator))?void 0:o.title)?o:i.sortByIndicator})}else r.push({dimensionKey:i.sortField,isPivotCorner:!0,value:i.sortField});var o=i.sortType?i.sortType.toUpperCase():\\\"ASC\\\";this.pivotSortState.push({dimensions:r,order:SortType[o]})}}_parseColumnWidthConfig(e){for(let t=0;t<(null==e?void 0:e.length);t++){var i=e[t],r=i.dimensions,i=i.width,o=this.getCellAddressByHeaderPaths(r);if(o&&o.col>=this.rowHeaderLevelCount){var n=this.getCellHeaderPaths(o.col,this.columnHeaderLevelCount);if(n.colHeaderPaths.length===r.length){let e=!0;for(let t=0;t<r.length;t++){const a=r[t];if(n.colHeaderPaths.findIndex((e,t)=>e.indicatorKey===a.indicatorKey||e.dimensionKey===a.dimensionKey&&e.value===a.value)<0){e=!1;break}}e&&!this.internalProps._widthResizedColMap.has(o.col)&&(this._setColWidth(o.col,i),this.internalProps._widthResizedColMap.add(o.col))}}else o&&o.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(o.col)||(this._setColWidth(o.col,i),this.internalProps._widthResizedColMap.add(o.col)))}}_parseColumnWidthConfigForRowHeader(e){for(let r=0;r<(null==e?void 0:e.length);r++){var t=e[r],i=t.dimensions,t=t.width,i=this.getCellAddressByHeaderPaths(i);i&&i.col<this.rowHeaderLevelCount&&(this.internalProps._widthResizedColMap.has(i.col)||(this._setColWidth(i.col,t),this.internalProps._widthResizedColMap.add(i.col)))}}updatePivotSortState(e){this.pivotSortState=e}sort(e,t,i){let r,o,n;this.isCornerHeader(e,t)?(s=this.getHeaderDefine(e,t),n=[],s={isPivotCorner:!0,dimensionKey:s.value,value:s.value},n.push(s)):n=this.isColumnHeader(e,t)?this.getCellHeaderPaths(e,t).colHeaderPaths:this.getCellHeaderPaths(e,t).rowHeaderPaths;var a=n[n.length-1].indicatorKey,l=this.getHeaderDefine(e,t);if(l.sort){if(this.dataset.sortRules){var s,h={};for(let e=this.dataset.sortRules.length-1;0<=e;e--){var d=this.dataset.sortRules[e];(l.dimensionKey&&d.sortField===l.dimensionKey||a&&d.sortField===(this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1]))&&(h[d.sortField]=d,this.dataset.sortRules.splice(e,1))}a?(s=this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],this.dataset.sortRules.push({sortField:s,sortType:SortType[i],sortByIndicator:a,query:n.reduce((e,t)=>(t.dimensionKey&&e.push(t.value),e),[]),sortFunc:null==(r=h[s])?void 0:r.sortFunc})):this.dataset.sortRules.push(Object.assign(null!=(o=h[l.dimensionKey])?o:{},{sortField:l.dimensionKey,sortType:SortType[i]}))}else this.dataset.sortRules=a?[{sortField:this.dataset.indicatorsAsCol?this.dataset.rows[this.dataset.rows.length-1]:this.dataset.columns[this.dataset.columns.length-1],sortType:SortType[i],sortByIndicator:a,query:n.reduce((e,t)=>(t.dimensionKey&&e.push(t.value),e),[])}]:[{sortField:l.dimensionKey,sortType:SortType[i]}];this.updateSortRules(this.dataset.sortRules,e,t)}}getPivotSortState(t,i){if(this.pivotSortState){var r=this.getCellRange(t,i);for(let e=0;e<this.pivotSortState.length;e++){var o=this.pivotSortState[e],n=o.dimensions,n=this.getCellAddressByHeaderPaths(n),o=o.order;if(n&&cellInRange(r,n.col,n.row))return o}}}_moveHeaderPosition(e,t){var i=this.getCellRange(e.col,e.row),r=this.getCellRange(t.col,t.row),o=this.internalProps.layoutMap.moveHeaderPosition(e,t);if(o){if(\\\"column\\\"===o.moveType){if(this.internalProps.recordsIsTwoDimensionalArray)for(let e=0;e<this.internalProps.records.length;e++){var n=this.internalProps.records[e].splice(o.sourceIndex-this.rowHeaderLevelCount,o.sourceSize);n.unshift(o.targetIndex-this.rowHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records[e],n)}this.colWidthsMap.exchangeOrder(i.start.col,i.end.col-i.start.col+1,r.start.col,r.end.col-r.start.col+1,o.targetIndex),this.setMinMaxLimitWidth()}else\\\"row\\\"===o.moveType&&(this.internalProps.recordsIsTwoDimensionalArray&&((i=this.internalProps.records.splice(o.sourceIndex-this.columnHeaderLevelCount,o.sourceSize)).unshift(o.targetIndex-this.columnHeaderLevelCount,0),Array.prototype.splice.apply(this.internalProps.records,i)),o.targetIndex>o.sourceIndex?this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex+o.sourceSize-o.targetSize,o.targetSize,o.targetIndex):this.rowHeightsMap.exchangeOrder(o.sourceIndex,o.sourceSize,o.targetIndex,o.targetSize,o.targetIndex));return o}return null}toggleHierarchyState(e,t,i=!0){this.internalProps.layoutMap.clearHeaderPathCache();var r=this.getHierarchyState(e,t);r===HierarchyState.expand?(this._refreshHierarchyState(e,t,i),this.fireListeners(PIVOT_TABLE_EVENT_TYPE.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:HierarchyState.collapse})):r===HierarchyState.collapse&&(r=this.internalProps.layoutMap.getHeadNode(e,t),Array.isArray(r.children)&&this._refreshHierarchyState(e,t,i),this.fireListeners(PIVOT_TABLE_EVENT_TYPE.TREE_HIERARCHY_STATE_CHANGE,{col:e,row:t,hierarchyState:HierarchyState.expand,originData:r}))}_refreshHierarchyState(e,t,i=!0,r){this.frozenColCount,this.frozenRowCount;var o,n=this.getBodyVisibleRowRange().rowStart;this.internalProps._oldRowCount=this.rowCount,this.internalProps._oldColCount=this.colCount;let a=!1,l=!1;this.stateManager.updateHoverIcon(e,t,void 0,void 0);var s=this.internalProps.layoutMap.checkHasChart(),h=(s&&(this.autoFillWidth&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight)&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),this.internalProps.layoutMap.isRowHeader(e,t)?this.internalProps.layoutMap.toggleHierarchyState(e,t):this.internalProps.layoutMap.toggleHierarchyStateForColumnTree(e,t));r&&r(),this.refreshRowColCount(),this.frozenColCount,this.frozenRowCount,this.clearCellStyleCache(),\\\"tree\\\"===this.rowHierarchyType&&this.scenegraph.updateHierarchyIcon(e,t),null!=(o=this.reactCustomLayout)&&o.clearCache(),\\\"grid-tree\\\"!==this.rowHierarchyType&&\\\"grid-tree\\\"!==this.columnHierarchyType?this.scenegraph.updateRow(h.removeCellPositionsRowDirection,h.addCellPositionsRowDirection,h.updateCellPositionsRowDirection,i):(this.internalProps.stick.changedCells.clear(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.scrollToRow(n)),null!=(o=this.reactCustomLayout)&&o.updateAllCustomCell(),s&&(this.autoFillWidth&&!a&&(a=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!l&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),\\\"adaptive\\\"===this.widthMode||a||\\\"adaptive\\\"===this.heightMode||l)&&this.scenegraph.updateChartSizeForResizeColWidth(-1),this.internalProps._oldRowCount=void 0,this.internalProps._oldColCount=void 0}getHeaderCellAddressByPath(e){return this.internalProps.layoutMap.getPivotCellAdress(e)}getCellAddressByHeaderPaths(e){return this.internalProps.layoutMap.getCellAdressByHeaderPath(e)}getHeaderPathByXY(e){var t=e?this.getCellAt(e.x+this.getFrozenColsWidth()+this.scrollLeft+1,e.y+this.getFrozenRowsHeight()+this.scrollTop+1):this.getCellAt(this.getFrozenColsWidth()+this.scrollLeft+1,this.getFrozenRowsHeight()+this.scrollTop+1);return this.internalProps.layoutMap.getCellHeaderPaths(t.col,t.row)}getHierarchyState(e,t){var i;return null==(i=this._getHeaderLayoutMap(e,t))?void 0:i.hierarchyState}getLayoutColumnTree(){return this.internalProps.layoutMap.getLayoutColumnTree()}getLayoutColumnTreeCount(){return this.internalProps.layoutMap.getLayoutColumnTreeCount()}getLayoutRowTree(){return this.internalProps.layoutMap.getLayoutRowTree()}getLayoutRowTreeCount(){return this.internalProps.layoutMap.getLayoutRowTreeCount()}getCellHeaderTreeNodes(e,t){return this.internalProps.layoutMap.getCellHeaderPathsWithTreeNode(e,t)}getMenuInfo(e,t,i){var r=this.internalProps.layoutMap.getPivotDimensionInfo(e,t);return{dimensionKey:r[r.length-1].dimensionKey,value:this.getCellValue(e,t),cellLocation:this.getCellLocation(e,t),isPivotCorner:this.isCornerHeader(e,t),event:void 0}}setRecords(i){var r,e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row},o=(this.options.records=this.internalProps.records=i,this.internalProps.recordsIsTwoDimensionalArray=!1,(null==(o=null==i?void 0:i[0])?void 0:o.constructor)===Array&&(this.internalProps.recordsIsTwoDimensionalArray=!0),this.options),n=this.internalProps;if(!1===(null==(r=this.options.customConfig)?void 0:r.enableDataAnalysis))!1===this.internalProps.recordsIsTwoDimensionalArray&&(this.flatDataToObjects=new FlatDataToObjects({rows:n.layoutMap.fullRowDimensionKeys,columns:n.layoutMap.colDimensionKeys,indicators:n.layoutMap.indicatorKeys,indicatorsAsCol:n.layoutMap.indicatorsAsCol,indicatorDimensionKey:n.layoutMap.indicatorDimensionKey},i));else{let e,t;this.dataset.setRecords(i),e=o.columnTree?n.layoutMap.columnDimensionTree:(!1!==o.indicatorsAsCol&&o.indicators&&this.dataset.colHeaderTree&&deleteHideIndicatorNode(this.dataset.colHeaderTree,o.indicators,!1,this),new DimensionTree(null!=(r=this.dataset.colHeaderTree)?r:[],this.layoutNodeId,this.options.columnHierarchyType,\\\"grid\\\"!==this.options.columnHierarchyType?null!=(r=this.options.columnExpandLevel)?r:1:void 0)),t=o.rowTree?n.layoutMap.rowDimensionTree:(!1===o.indicatorsAsCol&&this.dataset.rowHeaderTree&&o.indicators&&deleteHideIndicatorNode(this.dataset.rowHeaderTree,o.indicators,!1,this),new DimensionTree(null!=(r=this.dataset.rowHeaderTree)?r:[],this.layoutNodeId,this.options.rowHierarchyType,\\\"grid\\\"!==this.options.rowHierarchyType?null!=(r=this.options.rowExpandLevel)?r:1:void 0)),n.layoutMap=new PivotHeaderLayoutMap(this,this.dataset,e,t),this.pivotSortState=[],o.pivotSortState&&(this.pivotSortState=o.pivotSortState)}this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.eventManager.updateEventBinder(),this.options.emptyTip&&(this.internalProps.emptyTip?null!=(r=this.internalProps.emptyTip)&&r.resetVisible():(n=Factory2.getComponent(\\\"emptyTip\\\"),this.internalProps.emptyTip=new n(this.options.emptyTip,this),null!=(o=this.internalProps.emptyTip)&&o.resetVisible()))}startEditCell(e,t,i){var r,o;isValid_default(e)&&isValid_default(t)?(this.eventManager.isDraging=!1,this.selectCell(e,t),this.editorManager.startEditCell(e,t,i)):null!=(r=this.stateManager.select)&&r.cellPos&&(({col:r,row:o}=this.stateManager.select.cellPos),isValid_default(r))&&isValid_default(o)&&this.editorManager.startEditCell(r,o,i)}completeEditCell(){this.editorManager.completeEdit()}getEditor(e,t){let i,r,o,n;var a;return\\\"string\\\"==typeof(n=\\\"function\\\"==typeof(n=this.isCornerHeader(e,t)?null!=(i=null==(a=this.getHeaderDefine(e,t))?void 0:a.headerEditor)?i:this.options.headerEditor:this.isHeader(e,t)?null!=(r=null==(a=this.getHeaderDefine(e,t))?void 0:a.headerEditor)?r:this.options.headerEditor:null!=(o=null==(a=this.getBodyColumnDefine(e,t))?void 0:a.editor)?o:this.options.editor)?n({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||\\\"\\\",table:this}):n)?get4(n):n}isHasEditorDefine(e,t){var i=this.getBodyColumnDefine(e,t);let r=null!=(i=null==i?void 0:i.editor)?i:this.options.editor;return\\\"function\\\"==typeof r&&(r=r({col:e,row:t,dataValue:this.getCellOriginValue(e,t),value:this.getCellValue(e,t)||\\\"\\\",table:this})),isValid_default(r)}changeCellValue(i,r,o,e=!1){if(e&&this.isHasEditorDefine(i,r)||!1===e){let e=o;var n,a,l=this.getCellOriginValue(i,r),s=this.getCellRawValue(i,r),h=(\\\"number\\\"==typeof s&&isAllDigits(o)&&(e=parseFloat(o)),this._changeCellValueToDataSet(i,r,l,e),this.getCellRange(i,r));for(let t=h.start.col;t<=h.end.col;t++)for(let e=h.start.row;e<=h.end.row;e++)this.scenegraph.updateCellContent(t,e);\\\"adaptive\\\"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth?0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths():this.internalProps._widthResizedColMap.has(i)||(a=this.getColWidth(i),(n=computeColWidth(i,0,this.rowCount-1,this,!1))!==a&&this.scenegraph.updateColWidth(i,n-a)),\\\"adaptive\\\"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight?0===this.internalProps._heightResizedRowMap.size&&this.scenegraph.recalculateRowHeights():this.isAutoRowHeight(r)&&!this.internalProps._heightResizedRowMap.has(r)&&(n=this.getRowHeight(r),a=computeRowHeight(r,0,this.colCount-1,this),this.scenegraph.updateRowHeight(r,a-n)),l!==e&&this.fireListeners(TABLE_EVENT_TYPE.CHANGE_CELL_VALUE,{col:i,row:r,rawValue:s,currentValue:l,changedValue:e}),this.scenegraph.updateNextFrame()}}changeCellValues(i,r,o,n=!1){let a=i,l=r;var s=[],h=[];for(let R=0;R<o.length&&!(r+R>this.rowCount-1);R++){var t=o[R],d=[],u=[];s.push(d),h.push(u);for(let e=0;e<t.length&&!(i+e>this.colCount-1);e++){var c=this.getCellRawValue(i+e,r+R),c=(d.push(c),this.getCellOriginValue(i+e,r+R));u.push(c)}}for(let T=0;T<o.length&&!(r+T>this.rowCount-1);T++){l=r+T;var g=o[T];let e=i;for(let t=0;t<g.length&&!(i+t>this.colCount-1);t++)if(e=i+t,n&&this.isHasEditorDefine(i+t,r+T)||!1===n){var p=g[t];let e=p;var f=h[T][t],m=s[T][t],p=(\\\"number\\\"==typeof m&&isAllDigits(p)&&(e=parseFloat(p)),this._changeCellValueToDataSet(i+t,r+T,f,e),this.getCellOriginValue(i+t,r+T));p!==f&&this.fireListeners(TABLE_EVENT_TYPE.CHANGE_CELL_VALUE,{col:i+t,row:r+T,rawValue:m,currentValue:f,changedValue:p})}a=Math.max(a,e)}var b,C,v=this.getCellRange(i,r),y=this.getCellRange(a,l);for(let A=v.start.col;A<=y.end.col;A++)for(let e=v.start.row;e<=y.end.row;e++)this.scenegraph.updateCellContent(A,e);if(\\\"adaptive\\\"===this.widthMode||this.autoFillWidth&&this.getAllColsWidth()<=this.tableNoFrameWidth)0===this.internalProps._widthResizedColMap.size&&this.scenegraph.recalculateColWidths();else for(let e=i;e<=y.end.col;e++)this.internalProps._widthResizedColMap.has(e)||(b=this.getColWidth(e),(C=computeColWidth(e,0,this.rowCount-1,this,!1))!==b&&this.scenegraph.updateColWidth(e,C-b));if(\\\"adaptive\\\"===this.heightMode||this.autoFillHeight&&this.getAllRowsHeight()<=this.tableNoFrameHeight)this.scenegraph.recalculateRowHeights();else if(this.isAutoRowHeight(r)){var w,_,S=[],x=[];for(let e=r;e<=y.end.row;e++)this.rowHeightsMap.get(e)&&(w=this.getRowHeight(e),_=computeRowHeight(e,0,this.colCount-1,this),S.push(e),x.push(_-w));this.scenegraph.updateRowsHeight(S,x)}this.scenegraph.updateNextFrame()}_changeCellValueToDataSet(e,t,i,r){var o,n;this.internalProps.recordsIsTwoDimensionalArray?(n=this.getBodyIndexByRow(t),o=this.getBodyIndexByCol(e),this.records[n][o]=r):this.dataset?(n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),this.isCornerHeader(e,t)?this.internalProps.layoutMap.changeCornerTitle(e,t,r):this.isHeader(e,t)?(this.internalProps.layoutMap.changeTreeNodeTitle(e,t,r),this.isCornerHeader(e,t)||this.dataset.changeRecordFieldValue(null!=(o=n.colHeaderPaths)&&o.length?null!=(o=n.colHeaderPaths[n.colHeaderPaths.length-1].indicatorKey)?o:n.colHeaderPaths[n.colHeaderPaths.length-1].dimensionKey:null!=(o=n.rowHeaderPaths[n.rowHeaderPaths.length-1].indicatorKey)?o:n.rowHeaderPaths[n.rowHeaderPaths.length-1].dimensionKey,i,r)):(o=null==(o=n.colHeaderPaths)?void 0:o.filter(e=>!e.virtual).map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=null==(n=n.rowHeaderPaths)?void 0:n.filter(e=>!e.virtual).map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),this.dataset.changeTreeNodeValue(this.internalProps.layoutMap.indicatorsAsCol?n:n.slice(0,-1),this.internalProps.layoutMap.indicatorsAsCol?o.slice(0,-1):o,this.internalProps.layoutMap.getIndicatorKey(e,t),r))):this.flatDataToObjects&&(n=this.internalProps.layoutMap.getCellHeaderPaths(e,t),this.isHeader(e,t)?(this.internalProps.layoutMap.changeTreeNodeTitle(e,t,r),this.isCornerHeader(e,t)||this.flatDataToObjects.changeRecordFieldValue(null!=(o=n.colHeaderPaths)&&o.length?null!=(o=n.colHeaderPaths[n.colHeaderPaths.length-1].indicatorKey)?o:n.colHeaderPaths[n.colHeaderPaths.length-1].dimensionKey:null!=(o=n.rowHeaderPaths[n.rowHeaderPaths.length-1].indicatorKey)?o:n.rowHeaderPaths[n.rowHeaderPaths.length-1].dimensionKey,i,r)):(o=n.colHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),n=n.rowHeaderPaths.map(e=>{var t;return null!=(t=e.indicatorKey)?t:e.value}),this.flatDataToObjects.changeTreeNodeValue(n,o,this.internalProps.layoutMap.getBody(e,t).indicatorKey,r)))}_hasCustomRenderOrLayout(){if(this.options.customRender)return!0;var{columnsDefine:e,rowsDefine:t,indicatorsDefine:i}=this.internalProps.layoutMap;for(let a=0;a<e.length;a++){var r=e[a];if(\\\"string\\\"!=typeof r&&(r.headerCustomLayout||r.headerCustomRender))return!0}for(let l=0;l<t.length;l++){var o=t[l];if(\\\"string\\\"!=typeof o&&(o.headerCustomLayout||o.headerCustomRender))return!0}for(let s=0;s<i.length;s++){var n=i[s];if(\\\"string\\\"!=typeof n&&(n.customLayout||n.headerCustomLayout||n.customRender||n.headerCustomRender))return!0}return!1}changeRecordOrder(e,t){}setTreeNodeChildren(e,t,i,r){this.flatDataToObjects?(this.internalProps.layoutMap.getHeadNode(i,r).children=e,this._refreshHierarchyState(i,r,!0,()=>{this.flatDataToObjects.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys,indicators:this.internalProps.layoutMap.indicatorKeys,indicatorsAsCol:this.internalProps.layoutMap.indicatorsAsCol,indicatorDimensionKey:this.internalProps.layoutMap.indicatorDimensionKey}),this.flatDataToObjects.addRecords(t)})):(this.internalProps.layoutMap.getHeadNode(i,r).children=e,this._refreshHierarchyState(i,r,!0,()=>{this.dataset._rowTreeHasChanged(),this.dataset.changeDataConfig({rows:this.internalProps.layoutMap.fullRowDimensionKeys,columns:this.internalProps.layoutMap.colDimensionKeys}),this.dataset.addRecords(t)}))}updateFilterRules(e){this.internalProps.dataConfig.filterRules=e,this.dataset.updateFilterRules(e),this.renderWithRecreateCells()}getFilteredRecords(){var e;return null==(e=this.dataset)?void 0:e.filterRules}getCellPivotRole(e,t){var{cellLocation:i,colHeaderPaths:r,rowHeaderPaths:o}=this.getCellHeaderPaths(e,t);let n=r.length?\\\"normal\\\":void 0,a=o.length?\\\"normal\\\":void 0;return r.forEach(e=>{\\\"sub-total\\\"===e.role?n=\\\"sub-total\\\":\\\"grand-total\\\"===e.role&&(n=\\\"grand-total\\\")}),o.forEach(e=>{\\\"sub-total\\\"===e.role?a=\\\"sub-total\\\":\\\"grand-total\\\"===e.role&&(a=\\\"grand-total\\\")}),{colRole:n,rowRole:a,cellLocation:i}}setLoadingHierarchyState(e,t){this.scenegraph.setLoadingHierarchyState(e,t)}release(){this.internalProps.layoutMap.clearHeaderPathCache(),this.editorManager.release(),super.release()}},PivotTableSimple=(init_esbuild_inject(),registerTextCell(),class extends PivotTable{}),layout_exports={},Circle2=(__export(layout_exports,{Arc:()=>Arc2,CheckBox:()=>CheckBox,Circle:()=>Circle2,Container:()=>Container3,Group:()=>Group3,GroupElement:()=>GroupElement,Icon:()=>Icon2,Image:()=>Image3,Line:()=>Line,Radio:()=>Radio,Rect:()=>Rect3,Tag:()=>Tag2,Text:()=>Text2,percentCalc:()=>percentCalc}),init_esbuild_inject(),init_esbuild_inject(),class extends Circle{constructor(e){var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}}),Container3=(init_esbuild_inject(),class extends Group{constructor(e){e.direction&&(e.flexDirection=e.direction),!e.justifyContent||\\\"start\\\"!==e.justifyContent&&\\\"end\\\"!==e.justifyContent||(e.justifyContent=\\\"flex-\\\"+e.justifyContent),!e.alignItems||\\\"start\\\"!==e.alignItems&&\\\"end\\\"!==e.alignItems||(e.alignItems=\\\"flex-\\\"+e.alignItems),!e.alignContent||\\\"start\\\"!==e.alignContent&&\\\"end\\\"!==e.alignContent||(e.alignContent=\\\"flex-\\\"+e.alignContent),e.display=\\\"flex\\\",e.flexDirection||(e.flexDirection=\\\"row\\\"),e.clip=!0,e.fill=null==(t=null==e?void 0:e.background)?void 0:t.fill,e.stroke=null==(t=null==e?void 0:e.background)?void 0:t.stroke,e.lineWidth=null==(t=null==e?void 0:e.background)?void 0:t.lineWidth,e.cornerRadius=null==(t=null==e?void 0:e.background)?void 0:t.cornerRadius;var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}}),GroupElement=(init_esbuild_inject(),class extends Container3{constructor(e){e.flexWrap=\\\"nowrap\\\",super(e)}}),Icon2=(init_esbuild_inject(),class extends Image2{constructor(e){let t,i,r,o,n,a,l,s,h,d,u,c,g;isString_default(e.iconName)&&(g=get3()[e.iconName])&&(e.width=null!=(t=e.width)?t:g.width,e.height=null!=(i=e.height)?i:g.height,e.svg=g.svg,e.cursor=g.cursor),e.svg&&(e.image=e.svg);var p=isArray_default(e.boundsPadding),p=[null!=(o=null!=(r=e.marginTop)?r:p?e.boundsPadding[0]:e.boundsPadding)?o:0,null!=(a=null!=(n=e.marginRight)?n:p?e.boundsPadding[1]:e.boundsPadding)?a:0,null!=(h=null!=(l=e.marginBottom)?l:p?null!=(s=e.boundsPadding[2])?s:e.boundsPadding[0]:e.boundsPadding)?h:0,null!=(c=null!=(d=e.marginLeft)?d:p?null!=(u=e.boundsPadding[3])?u:e.boundsPadding[1]:e.boundsPadding)?c:0];e.boundsPadding=p,super(e),this.cache=g}}),Image3=(init_esbuild_inject(),class extends Image2{constructor(e){e.src&&(e.image=e.src),\\\"circle\\\"===e.shape&&(e.cornerRadius=e.width/2);var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}}),Rect3=(init_esbuild_inject(),class extends Rect{constructor(e){var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}}),Text2=(init_esbuild_inject(),class extends Text{constructor(e){e.textBaseline||(e.textBaseline=\\\"top\\\");var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,e.fill=null!=(t=e.fill)?t:\\\"#000\\\",super(e)}getSize(e){this.AABBBounds.width()}});function percentCalc(e,t=0){return{percent:e,delta:t}}init_esbuild_inject(),init_esbuild_inject();var Arc2=class extends Arc{constructor(e){var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}},Tag2=(init_esbuild_inject(),class extends Tag{constructor(e){var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}getSize(e){this.AABBBounds.width()}}),Group3=(init_esbuild_inject(),class extends Group{constructor(e){var t=isArray_default(e.boundsPadding),i=[null!=(i=null!=(i=e.marginTop)?i:t?e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginRight)?i:t?e.boundsPadding[1]:e.boundsPadding)?i:0,null!=(i=null!=(i=e.marginBottom)?i:t?null!=(i=e.boundsPadding[2])?i:e.boundsPadding[0]:e.boundsPadding)?i:0,null!=(t=null!=(i=e.marginLeft)?i:t?null!=(i=e.boundsPadding[3])?i:e.boundsPadding[1]:e.boundsPadding)?t:0];e.boundsPadding=i,super(e)}}),defalutHightlightCellStyle=(init_esbuild_inject(),registerForVrender(),init_esbuild_inject(),{bgColor:\\\"rgba(255, 255, 0, 0.2)\\\"}),defalutFocusHightlightCellStyle={bgColor:\\\"rgba(255, 155, 0, 0.2)\\\"};function defalultQueryMethod(e,t){return isValid_default(e)&&isValid_default(t)&&t.toString().includes(e)}var traitTagSchemas,SearchComponent=class{constructor(e){this.table=e.table,this.autoJump=e.autoJump||!1,this.skipHeader=e.skipHeader||!1,this.highlightCellStyle=e.highlightCellStyle||defalutHightlightCellStyle,this.focuseHighlightCellStyle=e.focuseHighlightCellStyle||defalutFocusHightlightCellStyle,this.queryMethod=e.queryMethod||defalultQueryMethod,this.callback=e.callback,this.table.registerCustomCellStyle(\\\"__search_component_highlight\\\",this.highlightCellStyle),this.table.registerCustomCellStyle(\\\"__search_component_focuse\\\",this.focuseHighlightCellStyle)}search(e){if(this.clear(),!(this.queryStr=e))return{index:0,results:this.queryResult};for(let t=0;t<this.table.rowCount;t++)for(let e=0;e<this.table.colCount;e++)if(!this.skipHeader||!this.table.isHeader(e,t)){var i=this.table.getCellValue(e,t);if(this.queryMethod(this.queryStr,i,{col:e,row:t,table:this.table})){var r=this.table.getCellRange(e,t);if(r.start.col!==r.end.col||r.start.row!==r.end.row){let e=!1;for(let t=this.queryResult.length-1;0<=t;t--)if(this.queryResult[t].col===r.start.col&&this.queryResult[t].row===r.start.row){e=!0;break}e||this.queryResult.push({col:r.start.col,row:r.start.row,range:r,value:i})}else this.queryResult.push({col:e,row:t,value:i})}}return this.updateCellStyle(),this.callback&&this.callback({queryStr:this.queryStr,results:this.queryResult},this.table),this.autoJump?this.next():{index:0,results:this.queryResult}}updateCellStyle(t=!0){if(this.queryResult){this.table.hasCustomCellStyle(\\\"__search_component_highlight\\\")||this.table.registerCustomCellStyle(\\\"__search_component_highlight\\\",this.highlightCellStyle),this.table.hasCustomCellStyle(\\\"__search_component_focuse\\\")||this.table.registerCustomCellStyle(\\\"__search_component_focuse\\\",this.focuseHighlightCellStyle);for(let e=0;e<this.queryResult.length;e++){var{col:i,row:r,range:o}=this.queryResult[e];o?this.table.arrangeCustomCellStyle({range:o},t?\\\"__search_component_highlight\\\":null):this.table.arrangeCustomCellStyle({col:i,row:r},t?\\\"__search_component_highlight\\\":null)}}}next(){var e,t,i;return this.queryResult.length?(({col:e,row:t,range:i}=(-1!==this.currentIndex&&(({col:t,row:i,range:e}=this.queryResult[this.currentIndex]),e?this.table.arrangeCustomCellStyle({range:e},\\\"__search_component_highlight\\\"):this.table.arrangeCustomCellStyle({col:t,row:i},\\\"__search_component_highlight\\\")),this.currentIndex++,this.currentIndex>=this.queryResult.length&&(this.currentIndex=0),this.queryResult[this.currentIndex])),i?this.table.arrangeCustomCellStyle({range:i},\\\"__search_component_focuse\\\"):this.table.arrangeCustomCellStyle({col:e,row:t},\\\"__search_component_focuse\\\"),this.jumpToCell(e,t),{index:this.currentIndex,results:this.queryResult}):{index:0,results:this.queryResult}}prev(){var e,t,i;return this.queryResult.length?(({col:e,row:t,range:i}=(-1!==this.currentIndex&&(({col:t,row:i,range:e}=this.queryResult[this.currentIndex]),e?this.table.arrangeCustomCellStyle({range:e},\\\"__search_component_highlight\\\"):this.table.arrangeCustomCellStyle({col:t,row:i},\\\"__search_component_highlight\\\")),this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.queryResult.length-1),this.queryResult[this.currentIndex])),i?this.table.arrangeCustomCellStyle({range:i},\\\"__search_component_focuse\\\"):this.table.arrangeCustomCellStyle({col:e,row:t},\\\"__search_component_focuse\\\"),this.jumpToCell(e,t),{index:this.currentIndex,results:this.queryResult}):{index:0,results:this.queryResult}}jumpToCell(e,t){var{rowStart:i,rowEnd:r}=this.table.getBodyVisibleRowRange(),{colStart:o,colEnd:n}=this.table.getBodyVisibleColRange();(t<=i||r<=t||e<=o||n<=e)&&this.table.scrollToCell({col:e,row:t})}clear(){this.updateCellStyle(null),this.queryStr=\\\"\\\",this.queryResult=[],this.currentIndex=-1}},cachedFieldTranslation=(init_esbuild_inject(),init_esbuild_inject(),{});function getSchemas(){return $tw.wiki.filterTiddlers(\\\"[all[shadows+tiddlers]tag[$:/SuperTag/TraitTag]]\\\").map(e=>$tw.wiki.getTiddler(e)?.fields?.schema).map(e=>{if(\\\"string\\\"==typeof e)try{return JSON.parse(e)}catch{return}}).filter(e=>void 0!==e)}function getFieldName(e){if(void 0!==cachedFieldTranslation[e])return cachedFieldTranslation[e]??e;void 0===traitTagSchemas&&(traitTagSchemas=getSchemas());var t=$tw.wiki.filterTiddlers(\\\"[[$:/language]get[text]get[name]else[en-GB]]\\\")[0];for(const o of traitTagSchemas)if(\\\"object\\\"===o.type&&void 0!==o.properties){var i=o[\\\"lingo-base\\\"];if(void 0!==i){var r=o.properties[e]?.title;if(r)return i=$tw.wiki.getTiddlerText(\\\"\\\"+i+t+\\\"/\\\"+r,e),cachedFieldTranslation[e]=i}}return cachedFieldTranslation[e]=null,e}var cachedEnumTranslation={};function getEnumName(e,t){if(\\\"string\\\"==typeof t&&null!==cachedEnumTranslation[e]){if(void 0!==cachedEnumTranslation[e]?.[t])return cachedEnumTranslation[e][t]??t;void 0===traitTagSchemas&&(traitTagSchemas=getSchemas());var i=$tw.wiki.filterTiddlers(\\\"[[$:/language]get[text]get[name]else[en-GB]]\\\")[0];for(const a of traitTagSchemas)if(\\\"object\\\"===a.type&&void 0!==a.properties){var r=a[\\\"lingo-base\\\"];if(void 0!==r){var o=a.properties[e],n=o?.[\\\"enum\\\"]?.findIndex(e=>e===t);if(void 0!==o&&void 0===n)return cachedEnumTranslation[e]=null,t;if(void 0!==n&&0<=n){n=o.options?.enum_titles?.[n];if(n)return o=$tw.wiki.getTiddlerText(\\\"\\\"+r+i+\\\"/\\\"+n,t),void 0===cachedEnumTranslation[e]&&(cachedEnumTranslation[e]={}),cachedEnumTranslation[e][t]=o}}}void 0===cachedEnumTranslation[e]&&(cachedEnumTranslation[e]={}),cachedEnumTranslation[e][t]=null}return t}function evalColumnJSString(e){try{var t=new Function(\\\"return \\\"+e)();if(void 0!==t)return t.map(e=>(void 0!==e.title?e.title=getFieldName(\\\"string\\\"==typeof e.title?e.title:e.title()):void 0!==e.field&&(e.title=getFieldName(String(e.field))),e))}catch(i){console.error(`hyper-table list-table failed to parse columns\\n\\n`+e,i)}}function handleChangeCellValue(e,t,i,r){var o;i!==r&&(\\\"string\\\"==typeof r||void 0===r||\\\"number\\\"==typeof r?$tw.wiki.setText(e,t,void 0,String(i)):Array.isArray(r)&&void 0!==(o=$tw.wiki.getTiddler(e)?.fields)&&(o={...o,[t]:String(i).split(\\\",\\\")},$tw.wiki.addTiddler(o)))}function onCellClickEvent(e,t){var i;\\\"title\\\"===e.field&&((i=e.originData?.title??e.value)?t.dispatchEvent({type:\\\"tm-navigate\\\",navigateTo:i,navigateFromTitle:t.getVariable(\\\"currentTiddler\\\")}):console.error(\\\"hyper-table list-table failed to get title field from event\\\",e))}function getTextFieldFormat(i,r){return e=>{var t=\\\"title\\\"===i?e.caption||e.title:String(e[i]??\\\"\\\");return r.wiki.renderText(\\\"text/plain\\\",\\\"text/vnd.tiddlywiki\\\",t,{variables:{currentTiddler:e.title},parentWidget:r})}}function parseColumnShortcut(e,i,r){return e.split(\\\"|\\\").map(e=>{let t;return r?.editable&&\\\"title\\\"!==e&&(t=\\\"text-editor\\\"),{cellType:\\\"text\\\",field:e,title:getFieldName(e),width:\\\"auto\\\",sort:!0,editor:t,fieldFormat:getTextFieldFormat(e,i)}})}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject();var InputEditor=class{constructor(e){this.editorType=\\\"Input\\\",this.editorConfig=e}createElement(){var e,t=document.createElement(\\\"input\\\");t.setAttribute(\\\"type\\\",\\\"text\\\"),null!=(e=this.editorConfig)&&e.readonly&&t.setAttribute(\\\"readonly\\\",\\\"\\\"+this.editorConfig.readonly),t.style.position=\\\"absolute\\\",t.style.padding=\\\"4px\\\",t.style.width=\\\"100%\\\",t.style.boxSizing=\\\"border-box\\\",t.style.backgroundColor=\\\"#FFFFFF\\\",this.element=t,this.container.appendChild(t),t.addEventListener(\\\"keydown\\\",e=>{\\\"a\\\"===e.key&&(e.ctrlKey||e.metaKey)&&e.stopPropagation()}),t.addEventListener(\\\"wheel\\\",e=>{e.preventDefault()})}setValue(e){this.element.value=void 0!==e?e:\\\"\\\"}getValue(){return this.element.value}onStart({value:e,referencePosition:t,container:i,endEdit:r}){this.container=i,this.successCallback=r,this.element||(this.createElement(),null!=e&&this.setValue(e),null!=t&&t.rect&&this.adjustPosition(t.rect)),this.element.focus()}adjustPosition(e){this.element.style.top=e.top+\\\"px\\\",this.element.style.left=e.left+\\\"px\\\",this.element.style.width=e.width+\\\"px\\\",this.element.style.height=e.height+\\\"px\\\"}endEditing(){}onEnd(){var e;null!=(e=this.container)&&e.contains(this.element)&&this.container.removeChild(this.element),this.element=void 0}isEditorElement(e){return e===this.element}validateValue(e,t,i,r){return!0}},DateInputEditor=(init_esbuild_inject(),class extends InputEditor{constructor(e){super(e),this.editorType=\\\"DateInput\\\",this.editorConfig=e}createElement(){var e=document.createElement(\\\"input\\\");e.setAttribute(\\\"type\\\",\\\"date\\\"),e.style.padding=\\\"4px\\\",e.style.width=\\\"100%\\\",e.style.boxSizing=\\\"border-box\\\",e.style.position=\\\"absolute\\\",e.style.backgroundColor=\\\"#FFFFFF\\\",this.element=e,this.container.appendChild(e),e.addEventListener(\\\"keydown\\\",e=>{\\\"a\\\"===e.key&&(e.ctrlKey||e.metaKey)&&e.stopPropagation()}),e.addEventListener(\\\"wheel\\\",e=>{e.preventDefault()})}}),TextAreaEditor=(init_esbuild_inject(),class{constructor(e){this.editorType=\\\"TextArea\\\",this.editorConfig=e||{}}createElement(){var e,t=document.createElement(\\\"textArea\\\");null!=(e=this.editorConfig)&&e.readonly&&t.setAttribute(\\\"readonly\\\",\\\"\\\"+this.editorConfig.readonly),t.style.resize=\\\"none\\\",t.style.position=\\\"absolute\\\",t.style.padding=\\\"4px\\\",t.style.width=\\\"100%\\\",t.style.height=\\\"100%\\\",t.style.boxSizing=\\\"border-box\\\",t.style.backgroundColor=\\\"#FFFFFF\\\",this.element=t,this.container.appendChild(t),t.addEventListener(\\\"keydown\\\",e=>{var t=\\\"a\\\"===e.key&&(e.ctrlKey||e.metaKey),i=\\\"Enter\\\"===e.key&&e.shiftKey;(t||i)&&e.stopPropagation()})}setValue(e){this.element.value=void 0!==e?e:\\\"\\\"}getValue(){return this.element.value}onStart({value:e,referencePosition:t,container:i,endEdit:r}){this.container=i,this.successCallback=r,this.element||(this.createElement(),null!=e&&this.setValue(e),null!=t&&t.rect&&this.adjustPosition(t.rect)),this.element.focus()}adjustPosition(e){this.element.style.top=e.top+\\\"px\\\",this.element.style.left=e.left+\\\"px\\\",this.element.style.width=e.width+\\\"px\\\",this.element.style.height=e.height+\\\"px\\\"}endEditing(){}onEnd(){this.container.removeChild(this.element),this.element=void 0}isEditorElement(e){return e===this.element}});function registerEditors(){var e=new InputEditor,t=new TextAreaEditor,i=new DateInputEditor;register_exports.editor(\\\"text-editor\\\",e),register_exports.editor(\\\"textarea-editor\\\",t),register_exports.editor(\\\"date-editor\\\",i)}function addTagRender(e,d){const u=$tw.wiki.getTiddlerData($tw.wiki.getTiddlerText(\\\"$:/palette\\\")??\\\"$:/palettes/Vanilla\\\"),c=d.wiki.filterTiddlers(d.getAttribute(\\\"omitTags\\\")??\\\"\\\");e.forEach(e=>{\\\"tags\\\"===e.field&&(e.customLayout=e=>{var t,i,{table:r,row:o,col:n,rect:a}=e,l=r.getRecordByCell(n,o),{height:a,width:n}=a??r.getCellRect(n,o),s=new layout_exports.Group({height:a,width:n,display:\\\"flex\\\",flexDirection:\\\"row\\\",flexWrap:\\\"wrap\\\",alignItems:\\\"center\\\"});if(void 0===l.tags||0===l.tags.length)return{renderDefault:!0,rootContainer:s};for(const h of Array.isArray(l.tags)?l.tags:String(l.tags).split(\\\",\\\"))c.includes(h)||(({backgroundColor:t,textColor:i}=getTagAndTextColor(h,u)),(i=new layout_exports.Tag({text:h,textStyle:{fontSize:10,fontFamily:\\\"sans-serif\\\",fill:i},panel:{visible:!0,fill:t,cornerRadius:5},space:5,boundsPadding:10})).addEventListener(\\\"dblclick\\\",()=>{onTagClickHandler(h,d)}),s.add(i));return{renderDefault:!1,rootContainer:s}})})}function onTagClickHandler(e,t){t.dispatchEvent({type:\\\"tm-navigate\\\",navigateTo:e,navigateFromTitle:t.getVariable(\\\"currentTiddler\\\")})}function getTagAndTextColor(e,t){var i,r=$tw.wiki.getTiddler(e)?.fields?.color??t[\\\"tag-background\\\"];let o;return void 0!==r&&(i=contrastColour(r,t[\\\"tag-background\\\"]??\\\"#f4f4f2\\\",t.foreground??\\\"rgb(51, 101, 238)\\\",t.background??\\\"#f4f4f2\\\"),o=Array.isArray(i)?`rgba(${i.join(\\\",\\\")})`:i),{backgroundColor:r,textColor:o}}init_esbuild_inject();var contrastColour=require(\\\"$:/core/modules/macros/contrastcolour.js\\\").run;function searchBar(t,e,i){var r=$tw.utils.domMaker(\\\"div\\\",{\\\"class\\\":\\\"tc-hyper-table-search-container tc-hyper-table-search-\\\"+i}),o=$tw.utils.domMaker(\\\"div\\\",{\\\"class\\\":\\\"tc-hyper-table-input-container\\\"});r.append(o);const n=$tw.utils.domMaker(\\\"input\\\",{\\\"class\\\":\\\"tc-hyper-table-search-input\\\",attributes:{tabindex:\\\"0\\\"}}),a=(o.append(n),$tw.utils.domMaker(\\\"button\\\",{\\\"class\\\":\\\"tc-hyper-table-clear-btn tc-hyper-table-hidden\\\"})),l=(a.innerText=\\\"×\\\",a.title=$tw.wiki.getTiddlerText(\\\"$:/language/Shortcuts/Input/Cancel/Hint\\\")??\\\"Clear\\\",o.append(a),$tw.utils.domMaker(\\\"span\\\",{\\\"class\\\":\\\"tc-hyper-table-search-result-count\\\"}));l.innerText=\\\"0/0\\\",r.append(l);var o=$tw.utils.domMaker(\\\"button\\\",{\\\"class\\\":\\\"tc-hyper-table-search-btn\\\"}),s=(o.innerText=$tw.wiki.getTiddlerText(\\\"$:/language/Search/Search\\\")??\\\"Search\\\",r.append(o),$tw.utils.domMaker(\\\"button\\\",{\\\"class\\\":\\\"tc-hyper-table-prev-btn\\\"})),h=(s.innerText=\\\"←\\\",s.title=$tw.wiki.getTiddlerText(\\\"$:/language/Shortcuts/Input/Up/Hint\\\")??\\\"Previous\\\",r.append(s),$tw.utils.domMaker(\\\"button\\\",{\\\"class\\\":\\\"tc-hyper-table-next-btn\\\"}));h.innerText=\\\"→\\\",h.title=$tw.wiki.getTiddlerText(\\\"$:/language/Shortcuts/Input/Down/Hint\\\")??\\\"Next\\\",r.append(h);const d=e=>{l.innerText=0===e.results.length?\\\"0/0\\\":e.index+1+\\\"/\\\"+e.results.length},u=()=>{n.value=\\\"\\\",t.clear(),l.innerText=\\\"0/0\\\",a.classList.add(\\\"tc-hyper-table-hidden\\\")};n.addEventListener(\\\"input\\\",()=>{0<n.value.length?a.classList.remove(\\\"tc-hyper-table-hidden\\\"):a.classList.add(\\\"tc-hyper-table-hidden\\\")}),o.addEventListener(\\\"click\\\",()=>{d(t.search(n.value))}),n.addEventListener(\\\"keydown\\\",e=>{\\\"Enter\\\"===e.key?0<t?.queryResult?.length?d(t.next()):d(t.search(n.value)):\\\"Escape\\\"===e.key&&u()}),a.addEventListener(\\\"click\\\",u),s.addEventListener(\\\"click\\\",()=>{0<t?.queryResult?.length&&d(t.prev())}),h.addEventListener(\\\"click\\\",()=>{0<t?.queryResult?.length&&d(t.next())}),\\\"top\\\"===i?e.prepend(r):e.append(r)}function parseWikiTextTable(e){var t=$tw.wiki.parseText(\\\"text/vnd.tiddlywiki\\\",e)?.tree;if(0<t?.length&&\\\"element\\\"===t[0]?.type&&\\\"table\\\"===t[0]?.tag){t=t[0].children?.find(e=>\\\"element\\\"===e.type&&\\\"tbody\\\"===e.tag)?.children;if(t){var i=t.filter(e=>\\\"element\\\"===e.type&&\\\"tr\\\"===e.tag);if(0!==i.length){const n=e=>{if(!e?.children)return\\\"\\\";const t=e=>e.map(e=>\\\"text\\\"===e.type?e.text||\\\"\\\":e.children?t(e.children):\\\"\\\").join(\\\"\\\");return t(e.children).trim()};t=i[0].children.filter(e=>\\\"element\\\"===e.type&&(\\\"th\\\"===e.tag||\\\"td\\\"===e.tag));if(0!==t.length){const a=[],l=[];t.forEach((e,t)=>{var i=n(e);let r=i?i.trim().replaceAll(/[^\\\\s\\\\w]/g,\\\"\\\").replaceAll(/\\\\s+/g,\\\"\\\").replace(/^(.)/,e=>e.toLowerCase()):\\\"column\\\"+(t+1);l.includes(r)&&(r=\\\"\\\"+r+t),l.push(r),a.push({field:r,title:i||\\\"Column \\\"+(t+1),width:\\\"auto\\\",sort:!0})});var r=[];for(let e=1;e<i.length;e++){var o=i[e].children.filter(e=>\\\"element\\\"===e.type&&(\\\"td\\\"===e.tag||\\\"th\\\"===e.tag));if(0!==o.length){const s={};o.forEach((e,t)=>{var i;t<l.length&&(i=l[t],s[i]=n(e))}),0<Object.keys(s).length&&r.push(s)}}return{records:r,columns:a}}}}}}init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),init_esbuild_inject(),registerMenu();var ListTableWidget=class extends import_widget.widget{constructor(){super(...arguments),this.previousFilterResult=[],this.tableContainerClassName=\\\"tc-hyper-table-list-table\\\"}refresh(t){var e=this.computeAttributes();if(0<$tw.utils.count(e))return this.refreshSelf(),!0;e=this.getAttribute(\\\"filter\\\");if(e){var i=Object.keys(t).filter(e=>t[e].modified);if(0<i.length){const r=this.wiki.filterTiddlers(e,this);if(0<r.length&&i.some(e=>r.includes(e)))return this.refreshSelf(),!0}if(Object.keys(t).filter(e=>t[e].deleted).some(e=>this.previousFilterResult.includes(e)))return this.refreshSelf(),!0}return!1}render(e,t){this.parentDomNode=e,this.computeAttributes(),this.execute();var{containerElement:i,tableContainerElement:r}=this.getContainerElement(),r={container:r,keyboardOptions:{copySelected:!0,pasteValueToCell:!0,selectAllOnCtrlA:!0,editCellOnEnter:!0,moveFocusCellOnTab:!0},...this.getCommonOptions(),...this.getRecordsAndColumns(),...this.getSortOptions(),...this.getOtherOptionFromString()??{}};this.tableInstance=new ListTableSimple(r),this.additionalFeatures(i),e.insertBefore(i,t),this.domNodes.push(i)}getRecordsAndColumns(){var e=this.parseTreeNode.children?.[0];if(\\\"text\\\"===e?.type){e=parseWikiTextTable(e.text);if(e)return e}return{records:this.getRecords(),columns:this.getListColumns()}}additionalFeatures(t){if(this.tableInstance){\\\"no\\\"!==this.getAttribute(\\\"titleNav\\\")&&this.tableInstance.on(ListTableSimple.EVENT_TYPE.DBLCLICK_CELL,e=>{onCellClickEvent(e,this)});var i=\\\"yes\\\"===this.getAttribute(\\\"editable\\\");i&&(registerEditors(),this.tableInstance.on(ListTableSimple.EVENT_TYPE.CHANGE_CELL_VALUE,this.handleChangeCellValue.bind(this)));let e=null;\\\"search-bar\\\"===this.getAttribute(\\\"search\\\")?e=\\\"bottom\\\":\\\"search-bar-top\\\"===this.getAttribute(\\\"search\\\")&&(e=\\\"top\\\"),e&&searchBar(new SearchComponent({table:this.tableInstance,autoJump:!0}),t,e)}}handleChangeCellValue(e){var{col:t,row:i,changedValue:r,currentValue:o}=e,i=this.tableInstance?.records?.[i-1],t=this.getListColumns()?.[t]?.field?.toString?.();i?.title&&\\\"string\\\"==typeof t&&this.wiki.tiddlerExists(i.title)&&handleChangeCellValue(i.title,t,r,o)}getContainerElement(){var e=this.getAttribute(\\\"height\\\")||\\\"400px\\\",t=this.getAttribute(\\\"width\\\")||\\\"100%\\\",i=$tw.utils.domMaker(\\\"p\\\",{\\\"class\\\":\\\"tc-hyper-table\\\"}),e=$tw.utils.domMaker(\\\"div\\\",{\\\"class\\\":this.tableContainerClassName,style:{height:e,width:t}});return i.append(e),{containerElement:i,tableContainerElement:e}}getCommonOptions(){var e=this.getAttribute(\\\"widthMode\\\")||\\\"adaptive\\\",t=\\\"dark\\\"===this.wiki.getTiddler(this.wiki.getTiddlerText(\\\"$:/palette\\\")??\\\"\\\")?.fields?.[\\\"color-scheme\\\"],i=this.getAttribute(\\\"lightTheme\\\")||\\\"DEFAULT\\\",r=this.getAttribute(\\\"darkTheme\\\")||\\\"DARK\\\";return{widthMode:e,theme:t?themes_exports[r]:themes_exports[i]}}getSortOptions(){var e=this.getAttribute(\\\"sort\\\",\\\"modified\\\");return{sortState:\\\"no\\\"===e?void 0:[{field:e,order:\\\"desc\\\"}]}}removeChildDomNodes(){void 0!==this.tableInstance&&(this.tableInstance=void 0),super.removeChildDomNodes()}getRecords(){var e=this.getAttribute(\\\"filter\\\"),t=this.getAttribute(\\\"records\\\")?.trim?.();let i=[];if(e){e=this.wiki.filterTiddlers(e,this);this.previousFilterResult=e,i=e.map(e=>this.wiki.getTiddler(e)?.fields).filter(e=>void 0!==e)}else if(t)try{var r=new Function(\\\"return \\\"+t)();void 0!==r&&(i=r)}catch(o){console.error(`hyper-table list-table failed to parse records\\n\\n`+t,o)}return i=i.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[e,getEnumName(e,t)])))}getListColumns(){var e,t=this.getAttribute(\\\"columns\\\")?.trim?.();let i=[{field:\\\"title\\\",title:\\\"Title\\\",width:\\\"auto\\\"}];return void 0!==(i=t?t.includes(\\\"|\\\")&&!t.includes(\\\"=>\\\")?(e=\\\"yes\\\"===this.getAttribute(\\\"editable\\\"),parseColumnShortcut(t,this,{editable:e})):evalColumnJSString(t):i)&&addTagRender(i,this),i}getOtherOptionFromString(){var e=this.getAttribute(\\\"options\\\")?.trim?.();if(e)try{return new Function(\\\"return \\\"+e)()}catch(t){console.error(`hyper-table list-table failed to parse options\\n\\n`+e,t)}}},PivotTableWidget=class extends ListTableWidget{constructor(){super(...arguments),this.tableContainerClassName=\\\"tc-hyper-table-pivot-table\\\"}render(e,t){this.parentDomNode=e,this.computeAttributes(),this.execute();var{containerElement:i,tableContainerElement:r}=this.getContainerElement(),r={container:r,keyboardOptions:{copySelected:!0,pasteValueToCell:!0,selectAllOnCtrlA:!0,editCellOnEnter:!0,moveFocusCellOnTab:!0},...this.getCommonOptions(),records:this.getRecords(),columns:this.getPivotOption(\\\"columns\\\",[\\\"tags\\\"]),rows:this.getPivotOption(\\\"rows\\\",[\\\"title\\\"]),indicators:this.getPivotOption(\\\"indicators\\\",[\\\"created\\\",\\\"modified\\\"]),...this.getOtherOptionFromString()??{}};this.tableInstance=new PivotTableSimple(r),this.additionalFeatures(i),e.insertBefore(i,t),this.domNodes.push(i)}getPivotOption(e,t){var i=this.getAttribute(e)?.trim?.();let r=t;if(i)try{var o=new Function(\\\"return \\\"+i)();void 0!==o&&(r=o)}catch(n){console.error(`hyper-table list-table failed to parse columns\\n\\n`+i,n)}return r}};exports.ListTableWidget=ListTableWidget,exports.PivotTableWidget=PivotTableWidget;\"},\"$:/plugins/linonetwo/hyper-table/widgets/table.css\":{\"title\":\"$:/plugins/linonetwo/hyper-table/widgets/table.css\",\"tags\":[\"$:/tags/Stylesheet\"],\"type\":\"text/css\",\"Modern.TiddlyDev#Origin\":\"../../temp_stylePlugin:src/hyper-table/widgets/search-bar/searchBar.css\",\"text\":\".tc-hyper-table-search-container{padding:5px 0;display:flex;align-items:center;gap:10px;width:100%;box-sizing:border-box;position:relative}.tc-hyper-table-search-top{margin-bottom:5px}.tc-hyper-table-search-bottom{margin-top:5px}.tc-hyper-table-search-input{padding:5px 25px 5px 5px;border-radius:4px;flex-grow:1;position:relative}.tc-hyper-table-next-btn,.tc-hyper-table-prev-btn,.tc-hyper-table-search-btn{padding:5px 10px;border:none;border-radius:4px;cursor:pointer}.tc-hyper-table-search-result-count{margin-left:10px;font-weight:700}.tc-hyper-table-clear-btn{position:absolute;right:5px;top:5px;background:0 0;border:none;cursor:pointer;font-size:16px;padding:0 5px;z-index:2}.tc-hyper-table-input-container{position:relative;flex-grow:1;display:flex}.tc-hyper-table-hidden{display:none!important}.tc-hyper-table{position:relative}\"}}}","title":"$:/plugins/linonetwo/hyper-table","type":"application/json","version":"1.4.1","Modern.TiddlyDev#SHA256-Hashed":"c38cd5b591913bf570cb7b34b1b8a8b23e77bfe76c7bbb159e2a64639ed01ac3","name":"High-Dimensional Tables 高维表格"}