{"title":"$:/plugins/oeyoews/markdown-it-spoiler","description":"markdown-it-spoiler","author":"oeyoews","version":"0.1.0","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"markdown-it-spoiler","meat#disabled":"yes","created":"2025-01-31","list":"readme","dependents":"","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/markdown-it-spoiler/readme\":{\"title\":\"$:/plugins/oeyoews/markdown-it-spoiler/readme\",\"text\":\"## markdownit spoiler\\n\\n```html\\n!!spoiler text!!\\n```\\n\\n\\n!!spoiler text!!\",\"type\":\"text/markdown\",\"description\":\"markdown-it-spoiler\"},\"$:/plugins/oeyoews/markdown-it-spoiler/markdown-it-spoiler.js\":{\"title\":\"$:/plugins/oeyoews/markdown-it-spoiler/markdown-it-spoiler.js\",\"text\":\"const e=(e,t)=>{const n=[];for(const o of t){if(33!==o.marker)continue;if(-1===o.end)continue;const s=t[o.end],r=e.tokens[o.token];r.type=\\\"spoiler_open\\\",r.tag=\\\"s-t\\\",r.nesting=1,r.markup=\\\"!!\\\",r.content=\\\"\\\";const i=e.tokens[s.token];i.type=\\\"spoiler_close\\\",i.tag=\\\"s-t\\\",i.nesting=-1,i.markup=\\\"!!\\\",i.content=\\\"\\\",\\\"text\\\"===e.tokens[s.token-1].type&&\\\"!\\\"===e.tokens[s.token-1].content&&n.push(s.token-1)}for(;n.length;){const t=n.pop();let o=t+1;for(;o<e.tokens.length&&\\\"spoiler_close\\\"===e.tokens[o].type;)o++;if(o--,t!==o){const n=e.tokens[o];e.tokens[o]=e.tokens[t],e.tokens[t]=n}}};module.exports=function(t,n=!1){t.inline.ruler.before(\\\"emphasis\\\",\\\"spoiler\\\",(e=>(t,n)=>{if(n)return!1;const o=t.pos,s=t.src.charCodeAt(o);if(33!==s)return!1;const r=t.scanDelims(t.pos,!0);let i=r.length;const l=String.fromCharCode(s);if(i<2)return!1;let c=!1;i%2&&(c=!0,e||(t.push(\\\"text\\\",\\\"\\\",0).content=l),i--);for(let e=0;e<i;e+=2)t.push(\\\"text\\\",\\\"\\\",0).content=l+l,t.delimiters.push({marker:s,length:0,jump:e/2,token:t.tokens.length-1,end:-1,open:r.can_open,close:r.can_close});return t.pos+=r.length,c&&e&&t.pos--,!0})(n)),t.inline.ruler2.before(\\\"emphasis\\\",\\\"spoiler\\\",(t=>{if(e(t,t.delimiters),t.tokens_meta)for(const n of t.tokens_meta)n&&n.delimiters&&e(t,n.delimiters)}))};\",\"type\":\"application/javascript\",\"module-type\":\"markdownit\"}}}"}