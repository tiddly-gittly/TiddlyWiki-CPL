{"title":"$:/plugins/dyp/sidenote&sidelink","version":"0.0.3","stability":"STABILITY_2_STABLE","name":"sidenote&sidelink","description":"条目行间批注","author":"dyp","source":"https://github.com/dyp1121054136/dyp-plugins-library","list":"readme usage history","plugin-priority":"","parent-plugin":"","dependents":"","plugin-type":"plugin","core-version":"5.3.7-prerelease","packaged-by":"Gatha on 3rd 六月 2025, 16:59:46","type":"application/json","text":"{\"tiddlers\":{\"$:/core/images/copy-sidenote\":{\"title\":\"$:/core/images/copy-sidenote\",\"created\":\"20240415062817395\",\"modified\":\"20250603085928658\",\"tags\":\"$:/tags/Image 图标 复制内容\",\"text\":\"\\\\parameters (size:\\\"22pt\\\")\\n\\n<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=<<size>> height=<<size>> class=\\\"bi bi-textarea-t tc-image-button\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M1.5 2.5A1.5 1.5 0 0 1 3 1h10a1.5 1.5 0 0 1 1.5 1.5v3.563a2 2 0 0 1 0 3.874V13.5A1.5 1.5 0 0 1 13 15H3a1.5 1.5 0 0 1-1.5-1.5V9.937a2 2 0 0 1 0-3.874V2.5zm1 3.563a2 2 0 0 1 0 3.874V13.5a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5V9.937a2 2 0 0 1 0-3.874V2.5A.5.5 0 0 0 13 2H3a.5.5 0 0 0-.5.5v3.563zM2 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm12 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z\\\"/>\\n  <path d=\\\"M11.434 4H4.566L4.5 5.994h.386c.21-1.252.612-1.446 2.173-1.495l.343-.011v6.343c0 .537-.116.665-1.049.748V12h3.294v-.421c-.938-.083-1.054-.21-1.054-.748V4.488l.348.01c1.56.05 1.963.244 2.173 1.496h.386L11.434 4z\\\"/>\\n</svg>\"},\"$:/core/images/sidelink\":{\"title\":\"$:/core/images/sidelink\",\"created\":\"20240303043314494\",\"modified\":\"20250603085928658\",\"tags\":\"$:/tags/Image 图标 条目行间批注\",\"text\":\"\\\\parameters (size:\\\"22pt\\\")\\n\\n<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=<<size>> height=<<size>> fill=\\\"currentColor\\\" class=\\\"bi bi-1-circle-fill\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312z\\\"/>\\n</svg>\"},\"$:/core/images/sidenote\":{\"title\":\"$:/core/images/sidenote\",\"created\":\"20240303042559962\",\"modified\":\"20250603085928658\",\"tags\":\"$:/tags/Image 图标 条目行间批注\",\"text\":\"\\\\parameters (size:\\\"22pt\\\")\\n\\n<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=<<size>> height=<<size>> fill=\\\"currentColor\\\" class=\\\"bi bi-1-circle\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002V12H7.971V5.338h-.065L6.072 6.656V5.385l1.899-1.383z\\\"/>\\n</svg>\"},\"$:/core/ui/EditorToolbar/sidelink\":{\"title\":\"$:/core/ui/EditorToolbar/sidelink\",\"caption\":\"添加sidelink批注\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]]\",\"created\":\"20240303043431671\",\"description\":\"添加sidelink批注\",\"icon\":\"$:/core/images/sidelink\",\"modified\":\"20250603085928658\",\"shortcuts\":\"((sidelink))\",\"tags\":\"条目行间批注 按钮 $:/tags/EditorToolbar\",\"text\":\"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"wrap-selection\\\"\\n\\tprefix='<<sidelink \\\"条目标题\\\" \\\"'\\n\\tsuffix='\\\">>'\\n/>\"},\"$:/core/ui/EditorToolbar/sidenote\":{\"title\":\"$:/core/ui/EditorToolbar/sidenote\",\"caption\":\"添加sidenote批注\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]]\",\"created\":\"20220706005949612\",\"description\":\"添加sidenote批注\",\"icon\":\"$:/core/images/sidenote\",\"modified\":\"20250603085928658\",\"shortcuts\":\"((sidenote))\",\"tags\":\"条目行间批注 按钮 $:/tags/EditorToolbar\",\"text\":\"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"wrap-selection\\\"\\n\\tprefix='<<sidenote \\\"小标题\\\" \\\"'\\n\\tsuffix='\\\">>'\\n/>\"},\"$:/plugins/dyp/sidenote&sidelink/history\":{\"title\":\"$:/plugins/dyp/sidenote&sidelink/history\",\"created\":\"20250603082709752\",\"modified\":\"20250603085928658\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"; v.0.0.3 2025-06-05\\n\\n# 优化widget [[details-positioning.js]]，修复了展开后内容闪烁的问题；\\n# 并减少向右偏移量，允许设置为负值，[[条目行间批注宏-widget版]] 设置 `offset=\\\"-55\\\"`；\\n# `.details-ji` 设置 `display: inline-block;` 和 `width: 0em;`，确保在行间可用，不影响排版。\\n\\n; v.0.0.2 2025-06-04\\n\\n# 调整了复制按钮的排版；\\n# 弹出批注背景颜色跟随主题条目背景颜色变化;\\n# 新增widget [[details-positioning.js]]，重构条目批注宏 [[条目行间批注宏-widget版]]，展开后内容相对于上标序号在水平方向上向右展开;\\n# 优化复制按钮悬停动画，避免闪烁 [[复制sidenote内容按钮样式css]]\\n\"},\"$:/plugins/dyp/sidenote&sidelink/readme\":{\"title\":\"$:/plugins/dyp/sidenote&sidelink/readme\",\"created\":\"20250603082636968\",\"modified\":\"20250603085928658\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"; 条目行间批注\"},\"$:/plugins/dyp/sidenote&sidelink/usage\":{\"title\":\"$:/plugins/dyp/sidenote&sidelink/usage\",\"created\":\"20250603082656393\",\"modified\":\"20250603085928658\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"; Sidenote & Sidelink: 条目侧边批注\\n\\\"\\\"\\\"\\n用法：\\n\\n`<<sidenote \\\"小标题\\\" \\\"内容\\\">>` （小标题和内容都可以重复，内容可以换行）\\n`<<sidelink \\\"条目标题\\\" \\\"小标题\\\">>` （链接到的条目标题不可重复，小标题可重复）\\n\\n文件：\\n[[条目行间批注宏-widget版]]\\n[[details-positioning.js]]\\n[[条目行间批注样式css]]\\n[[条目行间批注右上标序号样式css]]\\n[[复制sidenote内容按钮样式css]]\\n\\n示例：\\n[[sidenote宏演示]]\\n[[sidelink宏演示]]\\n\\n按钮：\\n[[添加sidenote批注|$:/core/ui/EditorToolbar/sidenote]]\\n[[添加sidelink批注|$:/core/ui/EditorToolbar/sidelink]]\\n\\n图标：\\n[[$:/core/images/sidenote]]\\n[[$:/core/images/sidelink]]\\n\\\"\\\"\\\"\\n\"},\"details-positioning.js\":{\"title\":\"details-positioning.js\",\"created\":\"20250604064318548\",\"modified\":\"20250604065232620\",\"module-type\":\"widget\",\"tags\":\"条目行间批注\",\"type\":\"application/javascript\",\"text\":\"/*\\\\  \\ntitle: $:/details-positioning.js  \\ntype: application/javascript  \\nmodule-type: widget  \\n  \\n带自定义定位功能的 Details widget，用于侧注  \\n  \\n\\\\*/  \\n(function(){  \\n  \\n\\\"use strict\\\";  \\n  \\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;  \\n  \\nvar DetailsPositioningWidget = function(parseTreeNode,options) {  \\n    this.initialise(parseTreeNode,options);  \\n};  \\n  \\n// 继承基础 widget 类  \\nDetailsPositioningWidget.prototype = new Widget();  \\n  \\n// 渲染方法  \\nDetailsPositioningWidget.prototype.render = function(parent,nextSibling) {  \\n    this.parentDomNode = parent;  \\n    this.computeAttributes();  \\n    this.execute();  \\n      \\n    // 创建 details 元素  \\n    var detailsNode = this.document.createElement(\\\"details\\\");  \\n    var summaryNode = this.document.createElement(\\\"summary\\\");  \\n      \\n    // 应用自定义类名  \\n    if(this.detailsClass) {  \\n        detailsNode.className = this.detailsClass;  \\n    }  \\n    if(this.summaryClass) {  \\n        summaryNode.className = this.summaryClass;  \\n    }  \\n      \\n    detailsNode.appendChild(summaryNode);  \\n      \\n    // 创建内容容器  \\n    var contentContainer = this.document.createElement(\\\"div\\\");  \\n    detailsNode.appendChild(contentContainer);  \\n      \\n    // 关键修复：初始状态下隐藏内容容器，防止闪烁  \\n    contentContainer.style.visibility = \\\"hidden\\\";  \\n    contentContainer.style.position = \\\"absolute\\\";  \\n    contentContainer.style.left = \\\"-9999px\\\";  \\n      \\n    // 根据是否有 summary 属性来决定渲染方式  \\n    if(this.summaryText) {  \\n        // 如果有 summary 属性，创建简单文本节点  \\n        var summarySpan = this.document.createElement(\\\"span\\\");  \\n        summarySpan.className = \\\"sidenote-t\\\";  \\n        summarySpan.appendChild(this.document.createTextNode(this.summaryText));  \\n        summaryNode.appendChild(summarySpan);  \\n          \\n        // 渲染所有子内容到内容容器  \\n        this.renderChildren(contentContainer, null);  \\n    } else {  \\n        // 如果没有 summary 属性，需要分别处理 summary 和内容  \\n        if(this.children.length > 0) {  \\n            // 第一个子元素作为 summary  \\n            this.children[0].render(summaryNode, null);  \\n              \\n            // 其余子元素作为详细内容  \\n            for(var i = 1; i < this.children.length; i++) {  \\n                this.children[i].render(contentContainer, null);  \\n            }  \\n        }  \\n    }  \\n      \\n    // 添加定位逻辑  \\n    var self = this;  \\n    detailsNode.addEventListener('toggle', function(event) {  \\n        if(event.target.open) {  \\n            // 展开时：立即应用定位，然后显示内容  \\n            self.positionDetails(event.target, summaryNode, contentContainer);  \\n        } else {  \\n            // 关闭时：隐藏内容并清理定位样式  \\n            self.hideContent(contentContainer);  \\n            self.clearPositioning(event.target);  \\n        }  \\n    });  \\n      \\n    parent.insertBefore(detailsNode, nextSibling);  \\n    this.domNodes.push(detailsNode);  \\n};  \\n  \\n// 执行方法 - 获取属性  \\nDetailsPositioningWidget.prototype.execute = function() {  \\n    this.summaryText = this.getAttribute(\\\"summary\\\", \\\"\\\");  \\n    this.detailsClass = this.getAttribute(\\\"detailsClass\\\", \\\"details-ji\\\");  \\n    this.summaryClass = this.getAttribute(\\\"summaryClass\\\", \\\"\\\");  \\n    this.position = this.getAttribute(\\\"position\\\", \\\"right\\\");  \\n    this.offset = parseInt(this.getAttribute(\\\"offset\\\", \\\"10\\\"));  \\n      \\n    // 创建子 widgets  \\n    this.makeChildWidgets();  \\n};  \\n  \\n// 隐藏内容的方法  \\nDetailsPositioningWidget.prototype.hideContent = function(contentContainer) {  \\n    contentContainer.style.visibility = \\\"hidden\\\";  \\n    contentContainer.style.position = \\\"absolute\\\";  \\n    contentContainer.style.left = \\\"-9999px\\\";  \\n};  \\n  \\n// 自定义定位逻辑  \\nDetailsPositioningWidget.prototype.positionDetails = function(detailsElement, summaryElement, contentContainer) {  \\n    var summaryRect = summaryElement.getBoundingClientRect();  \\n    var position = this.position;  \\n    var offset = this.offset;  \\n      \\n    // 获取计算后的字体大小来补偿 CSS 偏移  \\n    var computedStyle = window.getComputedStyle(detailsElement);  \\n    var fontSize = parseFloat(computedStyle.fontSize) || 16;  \\n    var topOffset = fontSize * 1.2; // 补偿 -1.2em 偏移  \\n      \\n    // 设置定位样式  \\n    detailsElement.style.position = \\\"fixed\\\";  \\n    detailsElement.style.zIndex = \\\"999\\\";  \\n      \\n    // 先设置位置  \\n    switch(position) {  \\n        case \\\"right\\\":  \\n            detailsElement.style.left = (summaryRect.right + offset) + \\\"px\\\";  \\n            detailsElement.style.top = (summaryRect.top + topOffset) + \\\"px\\\";  \\n            break;  \\n        case \\\"left\\\":  \\n            detailsElement.style.right = (window.innerWidth - summaryRect.left + offset) + \\\"px\\\";  \\n            detailsElement.style.top = (summaryRect.top + topOffset) + \\\"px\\\";  \\n            break;  \\n        case \\\"below\\\":  \\n            detailsElement.style.left = summaryRect.left + \\\"px\\\";  \\n            detailsElement.style.top = (summaryRect.bottom + offset) + \\\"px\\\";  \\n            break;  \\n        case \\\"above\\\":  \\n            detailsElement.style.left = summaryRect.left + \\\"px\\\";  \\n            detailsElement.style.bottom = (window.innerHeight - summaryRect.top + offset) + \\\"px\\\";  \\n            break;  \\n    }  \\n      \\n    // 显示内容容器  \\n    contentContainer.style.visibility = \\\"visible\\\";  \\n    contentContainer.style.position = \\\"static\\\";  \\n    contentContainer.style.left = \\\"auto\\\";  \\n      \\n    // 边界检测  \\n    var self = this;  \\n    requestAnimationFrame(function() {  \\n        var detailsRect = detailsElement.getBoundingClientRect();  \\n        if(detailsRect.right > window.innerWidth) {  \\n            detailsElement.style.left = (window.innerWidth - detailsRect.width - 10) + \\\"px\\\";  \\n        }  \\n        if(detailsRect.bottom > window.innerHeight) {  \\n            detailsElement.style.top = (window.innerHeight - detailsRect.height - 10) + \\\"px\\\";  \\n        }  \\n        if(detailsRect.left < 0) {  \\n            detailsElement.style.left = \\\"10px\\\";  \\n        }  \\n        if(detailsRect.top < 0) {  \\n            detailsElement.style.top = \\\"10px\\\";  \\n        }  \\n    });  \\n};  \\n  \\n// 清理定位样式  \\nDetailsPositioningWidget.prototype.clearPositioning = function(detailsElement) {  \\n    detailsElement.style.position = \\\"\\\";  \\n    detailsElement.style.left = \\\"\\\";  \\n    detailsElement.style.top = \\\"\\\";  \\n    detailsElement.style.right = \\\"\\\";  \\n    detailsElement.style.bottom = \\\"\\\";  \\n    detailsElement.style.zIndex = \\\"\\\";  \\n};  \\n  \\n// 刷新方法  \\nDetailsPositioningWidget.prototype.refresh = function(changedTiddlers) {  \\n    var changedAttributes = this.computeAttributes();  \\n    if(changedAttributes.summary || changedAttributes.detailsClass ||   \\n       changedAttributes.summaryClass || changedAttributes.position ||   \\n       changedAttributes.offset) {  \\n        this.refreshSelf();  \\n        return true;  \\n    }  \\n    return this.refreshChildren(changedTiddlers);  \\n};  \\n  \\nexports[\\\"details-positioning\\\"] = DetailsPositioningWidget;  \\n  \\n})();\\n\"},\"sidelink宏演示\":{\"title\":\"sidelink宏演示\",\"br\":\"2\",\"created\":\"20240303034723657\",\"modified\":\"20250603085928658\",\"tags\":\"条目行间批注\",\"text\":\"　　“耍龙灯”，也称为“舞龙灯”或是“龙舞”，是元宵节甚至是整个农历春节一个非常有代表性的活动。这个活动的历史极为悠久，可以一直追溯到上古时代，但见于文字则是在距今一千多年以前的汉代。东汉着名的文学家、天文学家张衡在《西京赋》里就对龙舞有相当精彩和生动的描写。一直到今天，由于中华民族向来崇尚龙，总把龙视为吉祥的象征，因此耍龙灯不仅流行于我国各地，即使着眼于全球，只要有华人的地方，每逢农历春节也经常会看到耍龙灯这个充满欢乐喜庆的活动。<<sidelink \\\"条目标题1\\\" \\\"小标题\\\">>\\n\\n　　除了耍龙灯，元宵节还有很多其他的习俗，譬如以下几种：\\n\\n　　吃元宵。由于我国幅员辽阔，各地饮食习惯还是颇为不同，因此在元宵节这天，北方是“滚元宵”，南方是“包汤圆”，做法和口感都不同。<<sidelink \\\"条目标题2\\\" \\\"小标题\\\">>\\n\\n　　闹花灯。这恐怕是元宵节最具代表性的活动了，始于西汉，兴盛于隋唐，之后便一直沿袭传于后世。到了今天，在元宵节当天，各地也都还会有热热闹闹的赏花灯活动，其实就是古人的闹花灯。在很多人的心目中，整个农历春节从大年夜开始，仿佛要到元宵节看了花灯以后，才算正式画下一个圆满的句点。\\n\\n　　猜灯谜。这是一个充满许多巧思的活动，恐怕也是所有元宵节习俗当中最与时俱进的活动。因为在传统的形式之下，每一个时代都会有人以当代的素材来创造新的谜语。比方说，“暗访山东”，要猜一个国家，名字是两个字，结果谜底是“秘鲁”，以“秘”来表示“暗访”，“鲁”则是山东的简称，这就是一个现代的灯谜。<<sidelink \\\"条目标题3\\\" \\\"小标题\\\">>\\n\\n　　放天灯。传说在很久以前，有一个地方，人们在春节期间因为躲避盗匪侵袭而四处奔逃，后来就以燃放天灯作为互报平安的信号。由于大家避难回家那天正好是元宵节，从此每年一到元宵节，大家都会以放天灯这样的仪式来庆祝，逐渐就变成了一项民俗。到了现代，“天灯”被称为“祈福灯”或“平安灯”，大家都会在天灯上写下一些美好的祝愿。<<sidelink \\\"条目标题4\\\" \\\"小标题\\\">>\\n\\n　　提灯笼。灯笼的制作很能展现工匠们的智慧和技巧，而每年以该年所属生肖为主题的应景小花灯，更是深受孩子们的喜爱，总能大大增加年节活泼愉快的气氛。<<sidelink \\\"条目标题5\\\" \\\"小标题\\\">>\"},\"sidenote宏演示\":{\"title\":\"sidenote宏演示\",\"br\":\"2\",\"created\":\"20240303034806768\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注\",\"text\":\"　　“耍龙灯”，也称为“舞龙灯”或是“龙舞”，是元宵节甚至是整个农历春节一个非常有代表性的活动。这个活动的历史极为悠久，可以一直追溯到上古时代，但见于文字则是在距今一千多年以前的汉代。东汉着名的文学家、天文学家张衡在《西京赋》里就对龙舞有相当精彩和生动的描写。一直到今天，由于中华民族向来崇尚龙，总把龙视为吉祥的象征，因此耍龙灯不仅流行于我国各地，即使着眼于全球，只要有华人的地方，每逢农历春节也经常会看到耍龙灯这个充满欢乐喜庆的活动。<<sidenote \\\"小标题\\\" \\\"　　此外，元宵节始于距今两千多年前的西汉，涉及西汉初年一段惨烈的历史。\\n\\n　　首先，这个节日是汉文帝所定下来的。汉文帝是汉高祖刘邦的第四子，汉惠帝的弟弟，是西汉第五位皇帝。\\n\\n　　虽然“兄终弟及”也是过去封建制度的原则，就是说哥哥过世之后由弟弟来继承皇位，但这样的情况毕竟还是少数，多半还是采取“父死子继”的做法，而汉文帝之所以能够从哥哥的手里接过大位，自然是有特殊的原因。\\\">>\\n\\n　　除了耍龙灯，元宵节还有很多其他的习俗，譬如以下几种：\\n\\n　　吃元宵。由于我国幅员辽阔，各地饮食习惯还是颇为不同，因此在元宵节这天，北方是“滚元宵”，南方是“包汤圆”，做法和口感都不同。<<sidenote \\\"小标题\\\" \\\"内容\\\">>\\n\\n　　闹花灯。这恐怕是元宵节最具代表性的活动了，始于西汉，兴盛于隋唐，之后便一直沿袭传于后世。到了今天，在元宵节当天，各地也都还会有热热闹闹的赏花灯活动，其实就是古人的闹花灯。在很多人的心目中，整个农历春节从大年夜开始，仿佛要到元宵节看了花灯以后，才算正式画下一个圆满的句点。\\n\\n　　猜灯谜。这是一个充满许多巧思的活动，恐怕也是所有元宵节习俗当中最与时俱进的活动。因为在传统的形式之下，每一个时代都会有人以当代的素材来创造新的谜语。比方说，“暗访山东”，要猜一个国家，名字是两个字，结果谜底是“秘鲁”，以“秘”来表示“暗访”，“鲁”则是山东的简称，这就是一个现代的灯谜。<<sidenote \\\"小标题\\\" \\\"内容\\\">>\\n\\n　　放天灯。传说在很久以前，有一个地方，人们在春节期间因为躲避盗匪侵袭而四处奔逃，后来就以燃放天灯作为互报平安的信号。由于大家避难回家那天正好是元宵节，从此每年一到元宵节，大家都会以放天灯这样的仪式来庆祝，逐渐就变成了一项民俗。到了现代，“天灯”被称为“祈福灯”或“平安灯”，大家都会在天灯上写下一些美好的祝愿。<<sidenote \\\"小标题\\\" \\\"内容\\\">>\\n\\n　　提灯笼。灯笼的制作很能展现工匠们的智慧和技巧，而每年以该年所属生肖为主题的应景小花灯，更是深受孩子们的喜爱，总能大大增加年节活泼愉快的气氛。<<sidenote \\\"小标题\\\" \\\"内容\\\">>\"},\"复制sidenote内容按钮\":{\"title\":\"复制sidenote内容按钮\",\"created\":\"20240504030633452\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注\",\"text\":\"\\\\whitespace trim\\n<span class=\\\"sidenote-copy-btn\\\">\\n<$button class=\\\"tc-btn-invisible\\\" tooltip=\\\"复制sidenote内容\\\"><$action-sendmessage $message=\\\"tm-copy-to-clipboard\\\" $param=<<copyContent>> />{{$:/core/images/copy-sidenote|20px}}</$button>\\n</span>\\n\"},\"复制sidenote内容按钮样式css\":{\"title\":\"复制sidenote内容按钮样式css\",\"created\":\"20250604010901498\",\"modified\":\"20250604013925008\",\"tags\":\"条目行间批注 样式 $:/tags/Stylesheet\",\"text\":\".sidenote-copy-btn {\\n  opacity: 0.5;\\n/* 优化悬停动画：使用will-change提示浏览器优化 */\\n  will-change: opacity; /* 提示浏览器优化透明度动画 */\\n  transition: opacity 0.3s ease; /* 平滑过渡 */\\n  -webkit-tap-highlight-color: transparent;\\n  box-shadow: none; /* 去除盒阴影 */\\n  float: right;\\n  transform: translateY(-2.2em);\\n  /* 确保元素在移动时保持其正常流动 */\\n  display: inline-block;\\n  margin-right: 10px;\\n}\\n\\n.sidenote-copy-btn:hover {\\n  opacity: 1;\\n}\\n\\n.sidenote-copy-btn svg {  \\n    width: 22px;  \\n    height: 22px;  \\n}  \\n\"},\"条目标题1\":{\"title\":\"条目标题1\",\"br\":\"2\",\"created\":\"20240125114438850\",\"modified\":\"20250603085928659\",\"tags\":\"sidelink宏演示 条目行间批注\",\"text\":\"　　此外，元宵节始于距今两千多年前的西汉，涉及西汉初年一段惨烈的历史。\\n　　首先，这个节日是汉文帝所定下来的。汉文帝是汉高祖刘邦的第四子，汉惠帝的弟弟，是西汉第五位皇帝。\\n　　虽然“兄终弟及”也是过去封建制度的原则，就是说哥哥过世之后由弟弟来继承皇位，但这样的情况毕竟还是少数，多半还是采取“父死子继”的做法，而汉文帝之所以能够从哥哥的手里接过大位，自然是有特殊的原因。\\n\"},\"条目标题2\":{\"title\":\"条目标题2\",\"created\":\"20240125114617887\",\"modified\":\"20250603085928659\",\"tags\":\"sidelink宏演示 条目行间批注\",\"text\":\"内容\"},\"条目标题3\":{\"title\":\"条目标题3\",\"created\":\"20240125114630566\",\"modified\":\"20250603085928659\",\"tags\":\"sidelink宏演示 条目行间批注\",\"text\":\"内容\"},\"条目标题4\":{\"title\":\"条目标题4\",\"created\":\"20240125114636213\",\"modified\":\"20250603085928659\",\"tags\":\"sidelink宏演示 条目行间批注\",\"text\":\"内容\"},\"条目标题5\":{\"title\":\"条目标题5\",\"created\":\"20240125114641242\",\"modified\":\"20250603085928659\",\"tags\":\"sidelink宏演示 条目行间批注\",\"text\":\"内容\"},\"条目行间批注\":{\"title\":\"条目行间批注\",\"created\":\"20240326143853789\",\"list\":\"$:/core/images/sidelink $:/core/images/sidenote $:/core/ui/EditorToolbar/sidelink $:/core/ui/EditorToolbar/sidenote 条目标题1 条目标题2 条目标题3 条目标题4 条目标题5 条目行间批注编辑宏1 条目行间批注编辑宏2 条目行间批注宏 条目行间批注教程 条目行间批注样式css sidelink宏演示 sidenote宏演示\",\"modified\":\"20250603085928659\",\"tags\":\"导出\",\"text\":\"<<filter-pill \\\"[tag[条目行间批注]][[条目行间批注]][[$:/core/images/copy-sidenote]]\\\" 条目行间批注>>\"},\"条目行间批注sidenote开启编辑模式\":{\"title\":\"条目行间批注sidenote开启编辑模式\",\"created\":\"20240503160544088\",\"edit-text\":\"no\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注\",\"text\":\"\\\\whitespace trim\\n<span class=\\\"sidenote-edit-btn\\\">\\n<$button class=\\\"tc-btn-invisible\\\" tooltip=\\\"开启/关闭编辑模式\\\">\\n\\n<!-- 默认图标 -->\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]!has:field[edit-text]]\\\">\\n{{$:/core/images/edit-button|20px}}\\n</$list>\\n\\n<!-- 激活时图标 -->\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]field:edit-text[yes]]\\\">\\n{{$:/core/images/close-button|20px}}\\n</$list>\\n\\n<!-- 取消激活时图标 -->\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]field:edit-text[no]]\\\">\\n{{$:/core/images/edit-button|20px}}\\n</$list>\\n\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]!has:field[edit-text]]\\\">\\n<$action-setfield $tiddler=\\\"条目行间批注sidenote开启编辑模式\\\" $field=\\\"edit-text\\\" $value=\\\"yes\\\"/>\\n</$list>\\n\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]field:edit-text[yes]]\\\">\\n<$action-setfield $tiddler=\\\"条目行间批注sidenote开启编辑模式\\\" $field=\\\"edit-text\\\" $value=\\\"no\\\"/>\\n</$list>\\n\\n<$list filter=\\\"[[条目行间批注sidenote开启编辑模式]field:edit-text[no]]\\\">\\n<$action-setfield $tiddler=\\\"条目行间批注sidenote开启编辑模式\\\" $field=\\\"edit-text\\\" $value=\\\"yes\\\"/>\\n</$list>\\n\\n</$button>\\n</span>\"},\"条目行间批注右上标序号样式css\":{\"title\":\"条目行间批注右上标序号样式css\",\"created\":\"20250603082015818\",\"modified\":\"20250603085928659\",\"tags\":\"$:/tags/Stylesheet 样式 条目行间批注\",\"text\":\"/* 计数器样式 - 适中尺寸版 */  \\n.details-ji summary::before {  \\n  content: counter(sidenote);  \\n  position: absolute;  \\n  top: -0.5em;  \\n  left: 100%;  \\n  margin-left: 0.1em;  \\n  font-size: 0.85em; /* 适中的字体大小 */  \\n  min-width: 1.3em; /* 适中的最小宽度 */  \\n  width: auto;  \\n  height: 1.3em; /* 适中的高度 */  \\n  line-height: 1.3em;  \\n  text-align: center;  \\n  color: #1A4975;  \\n  background-color: #B1D3E9;  \\n  border-radius: 50%;  \\n  opacity: 0.8;  \\n  z-index: 1;  \\n  padding: 0 0.15em; /* 稍微减小内边距 */  \\n  box-sizing: border-box;  \\n}\\n  \\n/* 调整小标题summary样式以支持精确定位 */  \\n.details-ji summary {  \\n  position: relative; /* 改为相对定位作为定位基准 */  \\n  display: inline-block;  \\n  padding-top: 0; /* 移除多余的padding */  \\n  cursor: pointer;  \\n  transition: all 0.3s cubic-bezier(.25,.8,.25,1);  \\n  counter-increment: sidenote;  \\n  font-size: 0.8em;  \\n  vertical-align: baseline; /* 与文字基线对齐 */  \\n}\"},\"条目行间批注宏-widget版\":{\"title\":\"条目行间批注宏-widget版\",\"created\":\"20240303034605399\",\"modified\":\"20250604070216636\",\"tags\":\"条目行间批注 $:/tags/Macro\",\"text\":\"<!-- 样式css已添加硬式换行，宏定义避免空格空行，以免影响内容排版 -->\\n\\\\define sidenote(title, content)    \\n<$details-positioning summary=\\\"$title$\\\" detailsClass=\\\"details-ji sidenote\\\" summaryClass=\\\"sidenote-t\\\" position=\\\"right\\\" offset=\\\"-55\\\"><$set name=\\\"copyContent\\\" value=\\\"$content$\\\">{{||复制sidenote内容按钮}}</$set><blockquote class=\\\"zhedie\\\">$content$</blockquote></$details-positioning>    \\n\\\\end\\n  \\n\\\\define sidelink(link, title)    \\n<$details-positioning detailsClass=\\\"details-ji sidelink\\\" summaryClass=\\\"sidenote-t\\\" position=\\\"right\\\" offset=\\\"-55\\\"><span class=\\\"sidenote-t\\\"><$link to=\\\"$link$\\\" tooltip=\\\"跳转到引用条目\\\">$title$</$link></span><blockquote class=\\\"zhedie\\\"><$transclude tiddler=\\\"$link$\\\"/></blockquote></$details-positioning>  \\n\\\\end\\n\"},\"条目行间批注宏\":{\"title\":\"条目行间批注宏\",\"created\":\"20240303034605399\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注\",\"text\":\"<!-- 样式css已添加硬式换行，宏定义避免空格空行，以免影响内容排版 -->\\n\\\\define sidenote(title, content)    \\n<details class=\\\"details-ji sidenote\\\"><summary><span class=\\\"sidenote-t\\\">$title$</span></summary>{{||复制sidenote内容按钮}}<blockquote class=\\\"zhedie\\\">$content$</blockquote></details>    \\n\\\\end\\n\\n\\\\define sidelink(link, title)\\n\\n<details class=\\\"details-ji sidelink\\\"><summary><span class=\\\"sidenote-t\\\"><$link to=$link$ tooltip=\\\"跳转到引用条目\\\">$title$</$link></span></summary><blockquote class=\\\"zhedie\\\"><$transclude tiddler=$link$></blockquote></details>\\n\\\\end\\n\"},\"条目行间批注宏代码备份\":{\"title\":\"条目行间批注宏代码备份\",\"created\":\"20240503184744313\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注\",\"text\":\"<!-- 样式css已添加硬式换行，宏定义避免空格空行，以免影响内容排版 -->\\n\\\\define sidenote(title, content)\\n\\n<details class=\\\"details-ji sidenote\\\">\\n<summary>\\n\\n<$list filter={{{[[条目行间批注sidenote开启编辑模式]get[edit-text]]+[match[no]]}}}>\\n$title$\\n</$list>\\n\\n<$list filter={{{[[条目行间批注sidenote开启编辑模式]get[edit-text]]+[match[yes]]}}}>\\n<textarea class=\\\"sidenote-edit-textarea-t\\\">\\n$title$\\n</textarea>\\n</$list>\\n</summary>\\n\\n{{||条目行间批注sidenote开启编辑模式}}\\n\\n<blockquote class=\\\"zhedie\\\">\\n\\n<$list filter={{{[[条目行间批注sidenote开启编辑模式]get[edit-text]]+[match[no]]}}}>\\n$content$\\n</$list>\\n\\n<$list filter={{{[[条目行间批注sidenote开启编辑模式]get[edit-text]]+[match[yes]]}}}>\\n<textarea class=\\\"sidenote-edit-textarea\\\">\\n$content$\\n</textarea>\\n</$list>\\n\\n</blockquote>\\n</details>\\n\\\\end\\n\\n\\\\define sidelink(link, title)\\n\\n<details class=\\\"details-ji sidelink\\\">\\n<summary>\\n\\n<$list filter={{{[[条目行间批注sidelink开启编辑模式]get[edit-text]]+[match[no]]}}}>\\n<$link to=$link$ tooltip=\\\"跳转到引用条目\\\">\\n$title$\\n</$link>\\n</$list>\\n\\n<$list filter={{{[[条目行间批注sidelink开启编辑模式]get[edit-text]]+[match[yes]]}}}>\\n\\n<textarea class=\\\"sidenote-edit-textarea-t\\\">\\n$title$</textarea>\\n</$list>\\n\\n</summary>\\n\\n{{||条目行间批注sidelink开启编辑模式}}\\n\\n<blockquote class=\\\"zhedie\\\">\\n\\n<$list filter={{{[[条目行间批注sidelink开启编辑模式]get[edit-text]]+[match[yes]]}}}>\\n\\n<$edit-text tiddler=<<__link__>> tag=\\\"textarea\\\" class=\\\"sidenote-edit-textarea\\\"/>\\n</$list>\\n\\n<$list filter={{{[[条目行间批注sidelink开启编辑模式]get[edit-text]]+[match[no]]}}}>\\n<$transclude tiddler=$link$>\\n</$list>\\n\\n</blockquote>\\n</details>\\n\\\\end\"},\"条目行间批注教程\":{\"title\":\"条目行间批注教程\",\"created\":\"20240303034408059\",\"modified\":\"20250603085928659\",\"tags\":\"教程 条目行间批注\",\"text\":\"; Sidenote & Sidelink: 条目侧边批注\\n\\\"\\\"\\\"\\n用法：\\n\\n`<<sidenote \\\"小标题\\\" \\\"内容\\\">>` （小标题和内容都可以重复，内容可以换行）\\n`<<sidelink \\\"条目标题\\\" \\\"小标题\\\">>` （链接到的条目标题不可重复，小标题可重复）\\n\\n文件：\\n[[条目行间批注宏]]\\n[[条目行间批注样式css]]\\n\\n示例：\\n[[sidenote宏演示]]\\n[[sidelink宏演示]]\\n\\n按钮：\\n[[添加sidenote批注|$:/core/ui/EditorToolbar/sidenote]]\\n[[添加sidelink批注|$:/core/ui/EditorToolbar/sidelink]]\\n\\n图标：\\n[[$:/core/images/sidenote]]\\n[[$:/core/images/sidelink]]\\n\\\"\\\"\\\"\"},\"条目行间批注样式css\":{\"title\":\"条目行间批注样式css\",\"created\":\"20240303034841182\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注 $:/tags/Stylesheet\",\"type\":\"\",\"text\":\"/* 内容部分blockquote缩进块样式 */\\n.zhedie {\\n  margin: 0.8em; \\n  padding-left: 0; /* 清除默认缩进 */\\n  text-align: justify; /* 两端对齐 */\\n  max-height: 100px; /* 最大高度 */\\n  overflow-y: auto; /* 超出最大高度时滚动 */\\n  border: none; /* 清除默认左边框 */\\n  word-break: normal; \\n  word-wrap: break-word; \\n  white-space: pre-line;\\n}\\n\\n.zhedie::-webkit-scrollbar {\\n  display: none; /* 隐藏滚动条 */\\n}\\n\\n/* details折叠块整体样式 */\\n.details-ji {\\n  position: relative;\\n  display: inline-block; /* 确保在行间可用，不影响排版 */\\n  top: -1.2em; /* 向上移动 */\\n  right: 1em; /* 向左移动 */\\n  width: 0em; /* 宽度自适应auto改成0em */\\n  text-indent: 0 !important; /* 避免折叠按钮缩进 */\\n}\\n\\n/* 鼠标悬停时的样式 */\\n.details-ji summary:hover {\\n  transform: translateY(3px); /* 按钮悬停时的位置变化 */\\n}\\n\\n/* 初始化计数器 */\\nbody {\\n    counter-reset: sidenote;\\n}\\n\\n/* details内容展开时的样式 */\\n.details-ji[open] {\\n  /* 移除  position: fixed; z-index: 999; top: 50%; left: 50%; transform: translate(-50%, -50%); */  \\n  /* 这些值将通过 JavaScript 动态设置 */  \\n  width: auto;\\n  height: auto;\\n  max-width: 300px; /* 最大宽度 */\\n  background-color: <<colour tiddler-background>>;\\n  border-radius: 8px;  /* 圆角 */\\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 阴影 */\\n}\\n\\n.details-ji[open] summary {\\n  position: relative;\\n  display: inline;\\n  margin-left: 0.8em; \\n  padding-top: 0.5em;\\n  padding-right: 4em; /* 展开后即使内容为空也预留一定宽度*/\\n  font-size: 1em;\\n  font-weight: bold;\\n  max-height: none; /* 不限制高度 */\\n  overflow: visible; /* 显示内容 */\\n  opacity: 1; /* 显示元素本身 */\\n}\\n\\n/* 展开后计数器展示在小标题之后 */\\n.details-ji[open] summary::after {\\n  content: counter(sidenote);\\n  position: absolute;\\n  margin-left: 0.5em; /* 增加小标题和计数器间距 */\\n  margin-top: 0.2em;\\n  font-size: 0.9em;\\n  font-weight: bold; \\n  width: 1.3em; \\n  height: 1.3em; \\n  line-height: 1.3em; \\n  text-align: center;\\n  color: #1A4975;\\n  background-color: #B1D3E9; \\n  border-radius: 50%;\\n  opacity: 0.8;\\n}\\n\\n/* 展开后计数器展示在小标题之前 */\\n.details-ji[open] summary::before {\\n  display: none; /* 隐藏 */\\n}\\n\"},\"条目行间批注编辑模式样式css\":{\"title\":\"条目行间批注编辑模式样式css\",\"created\":\"20240503161757247\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注 样式 $:/tags/Stylesheet\",\"type\":\"text/css\",\"text\":\"/* 编辑模式有bug暂时放弃 */\\n\\n/* 按钮样式 */\\n.sidenote-edit-btn,.sidenote-t {\\n  display: none; /* 默认隐藏 */\\n}\\n\\n.details-ji[open] .sidenote-edit-btn {\\n  display: inline; \\n}\\n\\n.details-ji[open] .sidenote-t {\\n  display: inline-block; \\n}\\n\\n.sidenote-edit-btn {\\n  margin-left: 20px;\\n  margin-right: 20px;\\n  opacity: 0.5;\\n  transition: opacity 0.3s ease; /* 平滑过渡 */\\n  -webkit-tap-highlight-color: transparent;\\n  box-shadow: none; /* 去除盒阴影 */\\n}\\n\\n.sidenote-edit-btn:hover {\\n  opacity: 1;\\n}\\n\\n/* 文本框样式 */\\n.sidenote-edit-textarea {\\n  font-size: 17px; \\n  color: #333; \\n  background-color: #f5f5f5; \\n  border: 1px solid #ddd; \\n  padding: 10px;\\n  width: 100%;\\n  height: 200px;\\n  resize: none; /* 禁止用户调整文本框的大小 */\\n}\\n\\n.sidenote-edit-textarea-t {\\n  font-size: 17px; \\n  color: #333; \\n  background-color: #f5f5f5; \\n  border: 1px solid #ddd; \\n  padding: 10px;\\n  width: 100%;\\n  height: auto;\\n  resize: none; /* 禁止用户调整文本框的大小 */\\n}\"},\"正则表达式匹配sidenote并替换内容\":{\"title\":\"正则表达式匹配sidenote并替换内容\",\"created\":\"20240505194001113\",\"modified\":\"20250603085928659\",\"tags\":\"条目行间批注 教程\",\"text\":\"查找所有sidenote：\\n<<code src:\\\"\\\"\\\"<<sidenote\\\\s+\\\"([^\\\\\\\"]+)\\\"\\\\s+\\\"([^\\\\\\\"]+)\\\">>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n添加结果定位锚点成为唯一选项，例：\\n<<code src:\\\"\\\"\\\"<<sidenote\\\\s+\\\"([^\\\\\\\"]+)\\\"\\\\s+\\\"([^\\\\\\\"]+)\\\">><<result 1>>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n仅修改内容可以替换为：\\n<<code src:\\\"\\\"\\\"<<sidenote \\\"$1\\\" \\\"新内容\\\">><<result 1>>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n注：匹配到唯一结果后可以点击 `编辑` 按钮，抓取整个宏的内容进行修改。\\n\\n<br/>\\n新小标题：\\n<<code src:\\\"\\\"\\\"<<sidenote \\\"新小标题\\\" \\\"$2\\\">>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n新内容：\\n<<code src:\\\"\\\"\\\"<<sidenote \\\"$1\\\" \\\"新内容\\\">>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n示例：\\n\\n查找任意小标题，以缩进两字符加以“此外，”开头的内容：\\n<<code src:\\\"\\\"\\\"<<sidenote\\\\s+\\\"([^\\\\\\\"]+)\\\"\\\\s+\\\"　　此外，([^\\\\\\\"]+)\\\">>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\\n替换为新内容（之前匹配的空格和开头字符也会被删除）：\\n<<code src:\\\"\\\"\\\"<<sidenote \\\"$1\\\" \\\"新内容\\\">>\\n\\\"\\\"\\\" language:\\\"tw\\\">>\"}}}"}