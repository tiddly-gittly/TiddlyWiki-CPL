{"title":"$:/plugins/EvidentlyCube/AdvancedPerformance","name":"Advanced Performance","version":"1.1.4","core-version":">=5.2.3","description":"Additional functionalities to measure your TW's performance.","author":"Maurycy Zarzycki","source":"https://github.com/EvidentlyCube/TW5-AdvancedPerformance","plugin-type":"plugin","list":"readme license history","dependents":"","type":"application/json","text":"{\"tiddlers\":{\"$:/plugins/EvidentlyCube/AdvancedPerformance/history\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/history\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"* ''1.1.4'' -- Two fixes:\\n** `other` refresh now correctly ignores subfilters when calculating its duration\\n** Tabs ''Median'' and ''Average'' now display subfilters just like other tabs do\\n* ''1.1.3'' -- Filters that run as subfilters are now explicitly marked in the tables.\\n* ''1.1.2'' -- Fixed a bug where in certain situations, startup script loading order would cause performance tracking to be delayed by //one refresh//\\n* ''1.1.1'' -- Colors are now taken from the current palette so that it works with dark ones too\\n* ''1.1.0'':\\n** Added option to filter the tables of filters to only show ones that run during specific refreshes\\n** Filters that run outside the defined refresh mechanism are now also counted and grouped as \\\"other\\\"\\n* ''1.0.1'' -- Fixed Z-index on the UI elements to (try to) be always on top + filters with variables now display correctly,\\n  rather than the variables being treated as HTML tags\\n* ''1.0.0'' -- Initial release\\n* ''0.0.1'' -- Development version\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/icon\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/icon\",\"text\":\"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\",\"type\":\"image/png\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/license\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/license\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"This plugin is licensed under the MIT license.\\n\\nCopyright 2022 Maurycy Zarzycki\\n\\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \\\"Software\\\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/readme\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/readme\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\n[[Github|https://github.com/EvidentlyCube/TW5-PluginShowcase/tree/main/plugins/EvidentlyCube/TW5-AdvancedPerformance]]\\n\\n----\\n\\n! Features\\n\\nExpand TiddlyWiki's performance instrumentation and make its results available directly in your wiki,\\nwithout having to use developer console of the browser.\\n\\n!! How to Use\\n\\n* Install the plugin\\n* Enable //Performance Instrumentation// (Control Panel -> Settings -> Performance Instrumentation)\\n* Save wiki\\n* Refresh the page\\n\\nThe bottom widget will now be available and advanced instrumentation will happen. The functionality of this plugin can be easily toggled off by disabling //Performance Instrumentation// and refreshing the page.\\n\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/perf.js\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/perf.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/EvidentlyCube/AdvancedPerformance/perf.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nCleans up data after a TaskList is removed\\n\\\\*/\\n\\n(function(){\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n// Export name and synchronous status\\nexports.name = \\\"evidentlycube-adv-perf--performance\\\";\\nexports.before = [\\\"startup\\\"];\\nexports.synchronous = true;\\nexports.startup = function() {\\n\\tif ($tw.node) {\\n\\t\\treturn;\\n\\t}\\n\\n\\t$tw.Performance.prototype.showGreeting = function() {\\n\\t\\tthis.refreshTimes = {};\\n\\t\\tthis.refreshTimesHistory = [];\\n\\t\\tthis.currentRefreshName = \\\"other\\\";\\n\\n\\t\\tthis.resetRefreshTimes();\\n\\t};\\n\\n\\t$tw.Performance.prototype.log = function() {\\n\\t\\tconsole.log(\\\"Please use the UI instead\\\");\\n\\t};\\n\\n\\t$tw.Performance.prototype.report = function(name,fn) {\\n\\t\\tvar self = this;\\n\\t\\tif(this.enabled) {\\n\\t\\t\\treturn function() {\\n\\t\\t\\t\\tself.currentRefreshName = name;\\n\\t\\t\\t\\tself.refreshTimes[name] = {\\n\\t\\t\\t\\t\\ttimeTaken: 0,\\n\\t\\t\\t\\t\\tfilterLogs: {}\\n\\t\\t\\t\\t};\\n\\n\\t\\t\\t\\tvar startTime = $tw.utils.timer(),\\n\\t\\t\\t\\t\\tresult = fn.apply(this,arguments),\\n\\t\\t\\t\\t\\ttimeTaken = $tw.utils.timer(startTime);\\n\\n\\t\\t\\t\\tself.refreshTimes[name].timeTaken = timeTaken;\\n\\t\\t\\t\\tself.currentRefreshName = \\\"other\\\";\\n\\n\\t\\t\\t\\treturn result;\\n\\t\\t\\t};\\n\\t\\t} else {\\n\\t\\t\\treturn fn;\\n\\t\\t}\\n\\t};\\n\\n\\t$tw.Performance.prototype.resetRefreshTimes = function() {\\n\\t\\tthis.refreshTimes = {\\n\\t\\t\\tother: {\\n\\t\\t\\t\\ttimeTaken: 0,\\n\\t\\t\\t\\tfilterLogs: {}\\n\\t\\t\\t}\\n\\t\\t};\\n\\t};\\n\\n\\t$tw.Performance.prototype.storeRefresh = function(log) {\\n\\t\\tthis.refreshTimesHistory.push(log);\\n\\n\\t\\tif (this.refreshTimesHistory.length > 50) {\\n\\t\\t\\tthis.refreshTimesHistory.shift();\\n\\t\\t}\\n\\t}\\n\\n\\t$tw.Performance.prototype.measure = function(name,fn) {\\n\\t\\tvar self = this;\\n\\t\\tif(this.enabled) {\\n\\t\\t\\tvar storeLog = function(name, takenTime, measures) {\\n\\t\\t\\t\\tif (self.isInsideFilter) {\\n\\t\\t\\t\\t\\tname = `~${name}`;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(!(name in measures)) {\\n\\t\\t\\t\\t\\tmeasures[name] = {\\n\\t\\t\\t\\t\\t\\tlastUse: 0,\\n\\t\\t\\t\\t\\t\\tlongestRun: 0,\\n\\t\\t\\t\\t\\t\\tshortestRun: Number.MAX_SAFE_INTEGER,\\n\\t\\t\\t\\t\\t\\ttotalCalls: 0,\\n\\t\\t\\t\\t\\t\\ttotalTime: 0,\\n\\t\\t\\t\\t\\t\\tisSub: self.isInsideFilter,\\n\\t\\t\\t\\t\\t\\ttimes: []\\n\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tmeasures[name].lastUse = Date.now();\\n\\t\\t\\t\\tmeasures[name].totalCalls++;\\n\\t\\t\\t\\tmeasures[name].longestRun = Math.max(takenTime, measures[name].longestRun);\\n\\t\\t\\t\\tmeasures[name].shortestRun = Math.min(takenTime, measures[name].shortestRun);\\n\\t\\t\\t\\tmeasures[name].totalTime += takenTime;\\n\\t\\t\\t\\tmeasures[name].times.push(takenTime);\\n\\t\\t\\t};\\n\\n\\t\\t\\treturn function() {\\n\\t\\t\\t\\tvar startTime = $tw.utils.timer();\\n\\t\\t\\t\\tvar isInsideFilter = self.isInsideFilter || false;\\n\\t\\t\\t\\tif (!isInsideFilter) {\\n\\t\\t\\t\\t\\tself.isInsideFilter = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvar result = fn.apply(this,arguments);\\n\\t\\t\\t\\tif (!isInsideFilter) {\\n\\t\\t\\t\\t\\tself.isInsideFilter = false;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvar takenTime = $tw.utils.timer(startTime);\\n\\n\\t\\t\\t\\tstoreLog(name, takenTime, self.measures);\\n\\t\\t\\t\\tstoreLog(name, takenTime, self.refreshTimes[self.currentRefreshName].filterLogs);\\n\\n\\t\\t\\t\\treturn result;\\n\\t\\t\\t};\\n\\t\\t} else {\\n\\t\\t\\treturn fn;\\n\\t\\t}\\n\\t};\\n};\\n\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/ui.js\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/ui.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/EvidentlyCube/AdvancedPerformance/ui.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nCleans up data after a TaskList is removed\\n\\\\*/\\n\\n(function () {\\n\\n\\t/*jslint node: false, browser: true */\\n\\t/*global $tw: false */\\n\\t\\\"use strict\\\";\\n\\n\\t// Export name and synchronous status\\n\\texports.name = \\\"evidentlycube-adv-perf--footer\\\";\\n\\texports.after = [\\\"startup\\\", \\\"render\\\"];\\n\\texports.synchronous = true;\\n\\texports.startup = function () {\\n\\t\\tif ($tw.node) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\n\\t\\tvar refreshIdCounter = 1;\\n\\t\\tvar footerText = $tw.wiki.getTiddlerText('$:/config/Performance/Instrumentation') !== \\\"yes\\\"\\n\\t\\t\\t? \\\"Performance instrumentation has been enabled, please save your wiki and refresh it to allow collecting data\\\"\\n\\t\\t\\t: \\\"\\\";\\n\\t\\tvar isShowingDetails = false;\\n\\t\\tvar selectedTab = \\\"ec_ap-tab--refresh-logs\\\";\\n\\n\\t\\tvar onClickCapture = function(event) {\\n\\t\\t\\tswitch(event.target.getAttribute('data-ec-ap')) {\\n\\t\\t\\t\\tcase 'show-details':\\n\\t\\t\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\t\\t\\tevent.preventDefault();\\n\\n\\t\\t\\t\\t\\tisShowingDetails = true;\\n\\t\\t\\t\\t\\tshowDetails();\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'clear-data':\\n\\t\\t\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\t\\t\\tevent.preventDefault();\\n\\n\\t\\t\\t\\t\\tclearPerfData();\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'close':\\n\\t\\t\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\t\\t\\tevent.preventDefault();\\n\\n\\t\\t\\t\\t\\tisShowingDetails = false;\\n\\t\\t\\t\\t\\tshowDetails();\\n\\t\\t\\t\\t\\tbreak;\\n\\n\\t\\t\\t\\tcase 'tab':\\n\\t\\t\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\t\\t\\tevent.preventDefault();\\n\\n\\t\\t\\t\\t\\tselectedTab = event.target.getAttribute('data-for') || selectedTab;\\n\\t\\t\\t\\t\\trefreshTabs();\\n\\t\\t\\t\\t\\tbreak;\\n\\n\\t\\t\\t\\tcase 'filter-all':\\n\\t\\t\\t\\tcase 'filter-limit':\\n\\t\\t\\t\\t\\t// these are handled in onClick\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tvar onClick = function(event) {\\n\\t\\t\\tswitch(event.target.getAttribute('data-ec-ap')) {\\n\\t\\t\\t\\tcase 'filter-limit':\\n\\t\\t\\t\\t\\tvar selectedFilterCount = document.querySelectorAll('input[data-ec-ap=\\\"filter-limit\\\"]:checked').length;\\n\\n\\t\\t\\t\\t\\tvar all = document.querySelector('input[data-ec-ap=\\\"filter-all\\\"]');\\n\\t\\t\\t\\t\\tif (selectedFilterCount === 0) {\\n\\t\\t\\t\\t\\t\\tall.checked = true;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tall.checked = false;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\trefreshFilterTabs();\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\tcase 'filter-all':\\n\\t\\t\\t\\t\\tvar checked = !event.target.checked;\\n\\t\\t\\t\\t\\tdocument.querySelectorAll('input[data-ec-ap=\\\"filter-limit\\\"]').forEach(function(checkbox) {\\n\\t\\t\\t\\t\\t\\tcheckbox.checked = checked;\\n\\t\\t\\t\\t\\t})\\n\\t\\t\\t\\t\\trefreshFilterTabs();\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t};\\n\\n\\t\\tdocument.querySelector('body').addEventListener('click', onClickCapture, true);\\n\\t\\tdocument.querySelector('body').addEventListener('click', onClick);\\n\\n\\t\\tvar clearPerfData = function() {\\n\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\tevent.preventDefault();\\n\\n\\t\\t\\t$tw.perf.measures = {};\\n\\t\\t\\t$tw.perf.refreshTimesHistory = [];\\n\\t\\t\\t$tw.perf.resetRefreshTimes();\\n\\n\\t\\t\\tfooterText = \\\"Performance data was cleared, please interact with the wiki to start collecting data\\\";\\n\\n\\t\\t\\tshowDetails();\\n\\t\\t\\trefreshFooter();\\n\\t\\t}\\n\\n\\t\\tvar refreshTabs = function() {\\n\\t\\t\\tdocument.querySelectorAll('.ec_ap-tab-header').forEach(function(element) {\\n\\t\\t\\t\\tif (element.getAttribute('data-for') === selectedTab) {\\n\\t\\t\\t\\t\\telement.classList.add('selected');\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\telement.classList.remove('selected');\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t\\tdocument.querySelectorAll('#ec_ap-tabs > *').forEach(function(element) {\\n\\t\\t\\t\\tif (element.classList.contains(selectedTab)) {\\n\\t\\t\\t\\t\\telement.classList.add('selected');\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\telement.classList.remove('selected');\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t};\\n\\n\\t\\tvar getFilteredMeasures = function() {\\n\\t\\t\\tvar allFilter = document.querySelector('input[data-ec-ap=\\\"filter-all\\\"]');\\n\\t\\t\\tvar checkedBoxes = document.querySelectorAll('input[data-ec-ap=\\\"filter-limit\\\"]:checked');\\n\\n\\t\\t\\t// If not filtering by refresh then take the global measures\\n\\t\\t\\tif (allFilter.checked === true) {\\n\\t\\t\\t\\treturn $tw.perf.measures;\\n\\t\\t\\t}\\n\\n\\t\\t\\t// Otherwise we need to construct them\\n\\t\\t\\tvar ids = new Set();\\n\\t\\t\\tvar measures = {};\\n\\n\\t\\t\\tvar storeMeasure = function(name, logs) {\\n\\t\\t\\t\\tif(!(name in measures)) {\\n\\t\\t\\t\\t\\tmeasures[name] = JSON.parse(JSON.stringify(logs));\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\tmeasures[name].lastUse = Math.max(measures[name].lastUse, logs);\\n\\t\\t\\t\\tmeasures[name].totalCalls += logs.totalCalls;\\n\\t\\t\\t\\tmeasures[name].longestRun = Math.max(logs.longestRun, measures[name].longestRun);\\n\\t\\t\\t\\tmeasures[name].shortestRun = Math.min(logs.longestRun, measures[name].shortestRun);\\n\\t\\t\\t\\tmeasures[name].totalTime += logs.longestRun;\\n\\t\\t\\t\\tmeasures[name].times.push.apply(measures[name].times, logs.times);\\n\\t\\t\\t};\\n\\n\\t\\t\\tcheckedBoxes.forEach(function(checkbox) {\\n\\t\\t\\t\\tids.add(checkbox.getAttribute('data-id') + ':' + checkbox.getAttribute('data-key'));\\n\\t\\t\\t});\\n\\n\\t\\t\\t$tw.perf.refreshTimesHistory.forEach(function(measure) {\\n\\t\\t\\t\\t$tw.utils.each(measure.refreshTimes, function(refreshTimes, name) {\\n\\t\\t\\t\\t\\tvar id = measure.id + ':' + name;\\n\\t\\t\\t\\t\\tif (!ids.has(id)) {\\n\\t\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t$tw.utils.each(refreshTimes.filterLogs, function(logs, filterName) {\\n\\t\\t\\t\\t\\t\\tstoreMeasure(filterName, logs);\\n\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t});\\n\\t\\t\\t});\\n\\n\\t\\t\\treturn measures;\\n\\t\\t}\\n\\n\\t\\tvar showDetails = function() {\\n\\t\\t\\tif (!isShowingDetails) {\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap-wrap').style.display = \\\"none\\\";\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tdocument.querySelector('#ec_ap-wrap').style.display = \\\"block\\\";\\n\\n\\t\\t\\trefreshTabs();\\n\\n\\t\\t\\tvar dm = $tw.utils.domMaker;\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--last-refreshes'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\t{name: 'Refresh time', field: 'time'},\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) {\\n\\t\\t\\t\\t\\t\\treturn Object.values(m.refreshTimes).reduce(function(sum, next) { return sum + next.timeTaken}, 0).toFixed(2) + \\\"ms\\\";\\n\\t\\t\\t\\t\\t}},\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tname: 'Individual times',\\n\\t\\t\\t\\t\\t\\tgetText: function(m) {\\n\\t\\t\\t\\t\\t\\t\\treturn Object.keys(m.refreshTimes).map(function(key) {\\n\\t\\t\\t\\t\\t\\t\\t\\tvar id = \\\"ec-ap-checkbox--\\\" + key + \\\"-\\\" + m.id;\\n\\t\\t\\t\\t\\t\\t\\t\\tvar checkbox = dm('input', {attributes: {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tid: id,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttype: 'checkbox',\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t'data-id': m.id,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t'data-key': key,\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t'data-ec-ap': 'filter-limit'\\n\\t\\t\\t\\t\\t\\t\\t\\t}});\\n\\t\\t\\t\\t\\t\\t\\t\\tvar text = dm('span', {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttext: key + \\\": \\\" + m.refreshTimes[key].timeTaken.toFixed(2) + \\\"ms\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\t\\t\\t\\t\\t\\t\\t\\ttext.innerHTML = \\\"&nbsp;\\\" + text.innerHTML + \\\"&nbsp;\\\";\\n\\n\\t\\t\\t\\t\\t\\t\\t\\tvar filterCount = Object.keys(m.refreshTimes[key].filterLogs).length;\\n\\t\\t\\t\\t\\t\\t\\t\\tvar text2 = dm('span', {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tclass: 'ec_ap-muted',\\n\\t\\t\\t\\t\\t\\t\\t\\t\\ttext: '(' + filterCount + \\\" filter\\\"+(filterCount !== '1' ? 's' : '')+\\\" executed)\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\t\\t\\t\\t\\treturn dm('label', {children: [checkbox, text, text2], attributes: {'for': id}}).outerHTML;\\n\\t\\t\\t\\t\\t\\t\\t}).join(\\\"<br>\\\");\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t{\\n\\t\\t\\t\\t\\t\\tname: 'Changed tiddlers',\\n\\t\\t\\t\\t\\t\\tgetText: function(m) {\\n\\t\\t\\t\\t\\t\\t\\treturn m.changedTiddlerNames.length;\\n\\t\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t\\tgetTitle: function(m) {\\n\\t\\t\\t\\t\\t\\t\\treturn m.changedTiddlerNames.join(\\\"\\\\n\\\");\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t},\\n\\t\\t\\t\\t\\t{name: \\\"Temp\\\", getText: function(m) { return m.tempTiddlers; }},\\n\\t\\t\\t\\t\\t{name: \\\"State\\\", getText: function(m) { return m.stateTiddlers; }},\\n\\t\\t\\t\\t\\t{name: \\\"System\\\", getText: function(m) { return m.systemTiddlers; }},\\n\\t\\t\\t\\t\\t{name: \\\"Main\\\", getText: function(m) { return m.mainTiddlers; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\t$tw.perf.refreshTimesHistory.reverse()\\n\\t\\t\\t);\\n\\n\\t\\t\\trefreshFilterTabs();\\n\\t\\t};\\n\\n\\t\\tvar refreshFilterTabs = function() {\\n\\n\\t\\t\\tvar measures = [];\\n\\t\\t\\t$tw.utils.each(getFilteredMeasures(), function(measure, filterName) {\\n\\t\\t\\t\\tvar lastTen = measure.times.slice(-10);\\n\\t\\t\\t\\tvar timesSorted = measure.times.concat();\\n\\t\\t\\t\\ttimesSorted.sort();\\n\\n\\t\\t\\t\\tvar half = Math.floor(timesSorted.length / 2);\\n\\n\\t\\t\\t\\tmeasures.push({\\n\\t\\t\\t\\t\\tfilterName: filterName\\n\\t\\t\\t\\t\\t\\t.replace(/^~?filter:\\\\s*/, '')\\n\\t\\t\\t\\t\\t\\t.replace(/</g, '&lt;')\\n\\t\\t\\t\\t\\t\\t.replace(/>/g, '&gt;'),\\n\\t\\t\\t\\t\\tisSub: measure.isSub,\\n\\t\\t\\t\\t\\tlastUse: measure.lastUse,\\n\\t\\t\\t\\t\\tlongestRun: measure.longestRun,\\n\\t\\t\\t\\t\\tshortestRun: measure.shortestRun,\\n\\t\\t\\t\\t\\ttotalCalls: measure.totalCalls,\\n\\t\\t\\t\\t\\ttotalTime: measure.totalTime,\\n\\t\\t\\t\\t\\ttotalTimeLastTen: lastTen.reduce(function(sum, next) { return sum + next; }, 0),\\n\\t\\t\\t\\t\\ttimes: measure.times,\\n\\t\\t\\t\\t\\ttimesSorted: timesSorted,\\n\\t\\t\\t\\t\\ttimesLastTen: lastTen,\\n\\t\\t\\t\\t\\taverage: measure.totalTime / measure.totalCalls,\\n\\t\\t\\t\\t\\tmedian: timesSorted.length % 2\\n\\t\\t\\t\\t\\t\\t? timesSorted[half]\\n\\t\\t\\t\\t\\t\\t: (timesSorted[half - 1] + timesSorted[half]) / 2\\n\\t\\t\\t\\t});\\n\\t\\t\\t});\\n\\n\\t\\t\\tvar recordsToShow = 50;\\n\\t\\t\\tvar mostUsedFilters = measures.concat().sort(createSortByCallback(['totalCalls', 'lastUse']));\\n\\t\\t\\tvar singleLongestExecution = measures.concat().sort(createSortByCallback(['longestRun', 'lastUse']));\\n\\t\\t\\tvar totalLongestExecution = measures.concat().sort(createSortByCallback(['totalTime', 'lastUse']));\\n\\t\\t\\tvar averageLongest = measures.concat().sort(createSortByCallback(['average', 'lastUse']));\\n\\t\\t\\tvar medianLongest = measures.concat().sort(createSortByCallback(['median', 'lastUse']));\\n\\n\\t\\t\\tvar filterNameColumn = {\\n\\t\\t\\t\\tname: 'Filter',\\n\\t\\t\\t\\tfield: 'filterName',\\n\\t\\t\\t\\tgetText: function (m) {\\n\\t\\t\\t\\t\\tif (m.isSub) {\\n\\t\\t\\t\\t\\t\\treturn `<small><em>Sub-filter: ${m.filterName}</em></small>`;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\treturn m.filterName;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t},\\n\\t\\t\\t\\tgetTitle: function (m) {\\n\\t\\t\\t\\t\\treturn m.isSub\\n\\t\\t\\t\\t\\t\\t? \\\"This was executed as a sub-filter to another filter. Sub-filter's time is included in the main filter's duration but the duration is not double counted for the 'Refresh logs' tab.\\\"\\n\\t\\t\\t\\t\\t\\t: '';\\n\\t\\t\\t\\t}\\n\\t\\t\\t};\\n\\n\\t\\t\\tvar totalTimeColumn = {\\n\\t\\t\\t\\tname: 'Total time (last 10)',\\n\\t\\t\\t\\tgetText: function(m) { return m.totalTimeLastTen.toFixed(2) + 'ms'; },\\n\\t\\t\\t\\tgetTitle: function(m) { return m.timesLastTen.map(function(x) { return x.toFixed(2) + 'ms'}).join(\\\"\\\\n\\\"); }\\n\\t\\t\\t};\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--most-used'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\tfilterNameColumn,\\n\\t\\t\\t\\t\\t{name: 'Uses', field: 'totalCalls' },\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) { return m.totalTime.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\ttotalTimeColumn,\\n\\t\\t\\t\\t\\t{name: 'Longest run', getText: function(m) { return m.longestRun.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Average time', getText: function(m) { return m.average.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Median time', getText: function(m) { return m.median.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\tmostUsedFilters.slice(0, recordsToShow)\\n\\t\\t\\t);\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--single-longest'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\tfilterNameColumn,\\n\\t\\t\\t\\t\\t{name: 'Longest run', getText: function(m) { return m.longestRun.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Uses', field: 'totalCalls' },\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) { return m.totalTime.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\ttotalTimeColumn,\\n\\t\\t\\t\\t\\t{name: 'Average time', getText: function(m) { return m.average.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Median time', getText: function(m) { return m.median.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\tsingleLongestExecution.slice(0, recordsToShow)\\n\\t\\t\\t);\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--total-longest'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\tfilterNameColumn,\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) { return m.totalTime.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Uses', field: 'totalCalls' },\\n\\t\\t\\t\\t\\ttotalTimeColumn,\\n\\t\\t\\t\\t\\t{name: 'Longest run', getText: function(m) { return m.longestRun.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Average time', getText: function(m) { return m.average.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Median time', getText: function(m) { return m.median.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\ttotalLongestExecution.slice(0, recordsToShow)\\n\\t\\t\\t);\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--average'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\tfilterNameColumn,\\n\\t\\t\\t\\t\\t{name: 'Average time', getText: function(m) { return m.average.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Uses', field: 'totalCalls' },\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) { return m.totalTime.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\ttotalTimeColumn,\\n\\t\\t\\t\\t\\t{name: 'Longest run', getText: function(m) { return m.longestRun.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Median time', getText: function(m) { return m.median.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\taverageLongest.slice(0, recordsToShow)\\n\\t\\t\\t);\\n\\n\\t\\t\\tcreateTable(\\n\\t\\t\\t\\tdocument.querySelector('#ec_ap--median'),\\n\\t\\t\\t\\t[\\n\\t\\t\\t\\t\\tfilterNameColumn,\\n\\t\\t\\t\\t\\t{name: 'Median time', getText: function(m) { return m.median.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Uses', field: 'totalCalls' },\\n\\t\\t\\t\\t\\t{name: 'Total time', getText: function(m) { return m.totalTime.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\ttotalTimeColumn,\\n\\t\\t\\t\\t\\t{name: 'Longest run', getText: function(m) { return m.longestRun.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t\\t{name: 'Average time', getText: function(m) { return m.average.toFixed(2) + 'ms'; }},\\n\\t\\t\\t\\t],\\n\\t\\t\\t\\tmedianLongest.slice(0, recordsToShow)\\n\\t\\t\\t);\\n\\t\\t};\\n\\n\\t\\tvar createSortByCallback = function(fields, reverse) {\\n\\t\\t\\tvar orderMultiplier = reverse ? -1 : 1;\\n\\n\\t\\t\\treturn function(left, right) {\\n\\t\\t\\t\\tfor(var i = 0; i < fields.length; i++) {\\n\\t\\t\\t\\t\\tvar field = fields[i];\\n\\t\\t\\t\\t\\tif (left[field] !== right[field]) {\\n\\t\\t\\t\\t\\t\\treturn (right[field] - left[field]) * orderMultiplier;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\treturn left.filterName.localeCompare(right.filterName) * orderMultiplier;\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tvar createTable = function(tableElement, headers, measures) {\\n\\t\\t\\tvar dm = $tw.utils.domMaker;\\n\\t\\t\\tvar theadThs = headers.map(function(header) {\\n\\t\\t\\t\\treturn dm('th', {text: header.name});\\n\\t\\t\\t});\\n\\t\\t\\tvar theadTr = dm(\\\"tr\\\", {children: theadThs});\\n\\t\\t\\tvar tbodyTrs = measures.map(function(measure) {\\n\\t\\t\\t\\tvar tds = headers.map(function(header) {\\n\\t\\t\\t\\t\\tvar title = header.getTitle ? header.getTitle(measure) : '';\\n\\t\\t\\t\\t\\tvar content = dm('span', {\\n\\t\\t\\t\\t\\t\\tclass: title ? 'ec_ap-annotated' : '',\\n\\t\\t\\t\\t\\t\\tinnerHTML: header.getText ? header.getText(measure) : measure[header.field],\\n\\t\\t\\t\\t\\t\\tattributes: {title: header.getTitle ? header.getTitle(measure) : ''}\\n\\t\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\t\\treturn dm('td', {children: [content]});\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\treturn dm('tr', {children: tds});\\n\\t\\t\\t});\\n\\t\\t\\tvar thead = dm('thead', {children: [theadTr]});\\n\\t\\t\\tvar tbody = dm('tbody', {children: tbodyTrs});\\n\\t\\t\\tvar table = dm('table', {children: [thead, tbody]});\\n\\n\\t\\t\\ttableElement.innerHTML = table.innerHTML;\\n\\t\\t}\\n\\n\\t\\tvar refreshFooter = function() {\\n\\t\\t\\tvar hasMeasurements = Object.keys($tw.perf.measures).length > 0;\\n\\n\\t\\t\\tif (!hasMeasurements) {\\n\\t\\t\\t\\tdocument.querySelectorAll('#ec_ap-footer > *').forEach(function(element) {\\n\\t\\t\\t\\t\\telement.style.display = \\\"none\\\";\\n\\t\\t\\t\\t});\\n\\n\\t\\t\\t\\tvar message = document.querySelector('#ec_ap-message')\\n\\t\\t\\t\\tmessage.style.display = \\\"block\\\";\\n\\t\\t\\t\\tmessage.innerText = footerText;\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\n\\t\\t\\tdocument.querySelectorAll('#ec_ap-footer > *').forEach(function(element) {\\n\\t\\t\\t\\telement.style.display = null;\\n\\t\\t\\t});\\n\\t\\t\\tdocument.querySelector('#ec_ap-message').style.display = \\\"none\\\";\\n\\n\\t\\t\\treturn false;\\n\\t\\t}\\n\\n\\t\\t$tw.wiki.addEventListener(\\\"change\\\", function (changes) {\\n\\t\\t\\tif (!document.querySelector('#ec_ap-footer') || refreshFooter()) {\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\n\\t\\t\\tvar tempTiddlers = 0;\\n\\t\\t\\tvar systemTiddlers = 0;\\n\\t\\t\\tvar stateTiddlers = 0;\\n\\t\\t\\tvar mainTiddlers = 0;\\n\\t\\t\\tvar totalTiddlers = 0;\\n\\t\\t\\tvar totalTime = 0;\\n\\t\\t\\tvar refreshTimes = JSON.parse(JSON.stringify($tw.perf.refreshTimes));\\n\\t\\t\\tvar refreshHtmls = [];\\n\\n\\t\\t\\t$tw.utils.each(changes, function(_, tiddler) {\\n\\t\\t\\t\\tif (tiddler.startsWith('$:/temp/')) {\\n\\t\\t\\t\\t\\ttempTiddlers++;\\n\\t\\t\\t\\t} else if (tiddler.startsWith('$:/state/')) {\\n\\t\\t\\t\\t\\tstateTiddlers++;\\n\\t\\t\\t\\t} else if (tiddler.startsWith('$:/')) {\\n\\t\\t\\t\\t\\tsystemTiddlers++;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tmainTiddlers++;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\ttotalTiddlers++;\\n\\t\\t\\t});\\n\\n\\t\\t\\t$tw.utils.each(refreshTimes, function(data, name) {\\n\\t\\t\\t\\tif (name === 'other') {\\n\\t\\t\\t\\t\\t// Precalculate other's time taken because it contains all filters that run outside refreshes\\n\\t\\t\\t\\t\\trefreshTimes[name].timeTaken = Object.values(data.filterLogs).reduce(function(total, measure) {\\n\\t\\t\\t\\t\\t\\treturn total + (measure.isSub ? 0 : measure.totalTime);\\n\\t\\t\\t\\t\\t}, 0);\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\ttotalTime += data.timeTaken;\\n\\t\\t\\t\\trefreshHtmls.push(\\n\\t\\t\\t\\t\\t'<span title=\\\"'\\n\\t\\t\\t\\t\\t+ name +\\n\\t\\t\\t\\t\\t'\\\">'\\n\\t\\t\\t\\t\\t+ data.timeTaken.toFixed(2)\\n\\t\\t\\t\\t\\t+ 'ms</span>'\\n\\t\\t\\t\\t);\\n\\t\\t\\t});\\n\\n\\t\\t\\tvar now = new Date();\\n\\t\\t\\tvar time = now.getHours().toString().padStart(2, \\\"0\\\")\\n\\t\\t\\t\\t+ \\\":\\\"\\n\\t\\t\\t\\t+ now.getMinutes().toString().padStart(2, \\\"0\\\")\\n\\t\\t\\t\\t+ \\\":\\\"\\n\\t\\t\\t\\t+ now.getSeconds().toString().padStart(2, \\\"0\\\")\\n\\t\\t\\t\\t+ \\\".\\\"\\n\\t\\t\\t\\t+ (now.getTime() % 1000).toString().padStart(3, \\\"0\\\");\\n\\n\\t\\t\\t$tw.perf.storeRefresh({\\n\\t\\t\\t\\tid: refreshIdCounter++,\\n\\t\\t\\t\\ttime: time,\\n\\t\\t\\t\\ttempTiddlers: tempTiddlers,\\n\\t\\t\\t\\tstateTiddlers: stateTiddlers,\\n\\t\\t\\t\\tsystemTiddlers: systemTiddlers,\\n\\t\\t\\t\\tmainTiddlers: mainTiddlers,\\n\\t\\t\\t\\ttotalTiddlers: totalTiddlers,\\n\\t\\t\\t\\tchangedTiddlerNames: Object.keys(changes),\\n\\t\\t\\t\\trefreshTimes: refreshTimes\\n\\t\\t\\t});\\n\\n\\t\\t\\tdocument.querySelector('#ec_ap-last-refresh').innerText = time;\\n\\t\\t\\tdocument.querySelector('#ec_ap-total-time').innerText = totalTime.toFixed(2) + \\\"ms\\\";\\n\\t\\t\\tdocument.querySelector('#ec_ap-times').innerHTML = '(' + refreshHtmls.join(\\\" | \\\") + ')';\\n\\t\\t\\tdocument.querySelector('#ec_ap-tiddlers').innerHTML = totalTiddlers;\\n\\t\\t\\tdocument.querySelector('#ec_ap-tiddlers-temp').innerHTML = \\\"Temp=\\\" + tempTiddlers;\\n\\t\\t\\tdocument.querySelector('#ec_ap-tiddlers-state').innerHTML = \\\"State=\\\" + stateTiddlers;\\n\\t\\t\\tdocument.querySelector('#ec_ap-tiddlers-system').innerHTML = \\\"System=\\\" + systemTiddlers;\\n\\t\\t\\tdocument.querySelector('#ec_ap-tiddlers-main').innerHTML = \\\"Main=\\\" + mainTiddlers;\\n\\n\\t\\t\\t// Clear current refresh times to avoid outdated `mainRender` polluting our logs\\n\\t\\t\\t$tw.perf.resetRefreshTimes();\\n\\t\\t});\\n\\t};\\n\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/EvidentlyCube/AdvancedPerformance/ui\":{\"title\":\"$:/plugins/EvidentlyCube/AdvancedPerformance/ui\",\"tags\":\"$:/tags/PageTemplate\",\"text\":\"<$list filter=\\\"[[$:/config/Performance/Instrumentation]get[text]match[yes]]\\\">\\n<style>\\n#ec_ap-footer {\\n\\tposition: fixed;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tbackground: <<colour tiddler-background>>;\\n\\tpadding: 4px;\\n\\tborder-top: 1px solid #888;\\n\\theight: 24px;\\n\\tline-height: 16px;\\n\\tbox-sizing: border-box;\\n\\tdisplay: flex;\\n\\tjustify-content: space-around;\\n\\tz-index: 999999;\\n}\\n.ec_ap-muted {\\n\\tfont-style: italic;\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n.tc-drafts-list {\\n\\tbottom: 24px;\\n}\\n#ec_ap-wrap {\\n\\tdisplay: none;\\n\\tposition: fixed;\\n\\tleft: 0;\\n\\tright: 0;\\n\\ttop: 0;\\n\\tbottom: 0;\\n\\tbox-sizing: border-box;\\n\\tpadding: 2em;\\n\\tz-index: 999999;\\n}\\n#ec_ap-cover {\\n\\tposition: fixed;\\n\\tleft: 0;\\n\\tright: 0;\\n\\ttop: 0;\\n\\tbottom: 0;\\n\\tbox-sizing: border-box;\\n\\tbackground: <<colour modal-backdrop>>;\\n\\topacity: 0.75;\\n}\\n#ec_ap-container {\\n\\twidth: 100%;\\n\\theight: 100%;\\n\\tmargin: auto;\\n\\tbackground: <<colour modal-background>>;\\n\\tmax-width: 1024px;\\n\\tbox-sizing: border-box;\\n\\tborder-radius: 2em;\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\tposition: relative;\\n\\tz-index: 1;\\n}\\n#ec_ap-container > h1 {\\n\\tpadding: 1em;\\n\\tmargin: 0;\\n\\tdisplay: flex;\\n\\twidth: 100%;\\n\\tgap: 1em;\\n}\\n#ec_ap-container > h1 span:first-child {\\n\\tflex-grow: 1;\\n}\\n\\n#ec_ap-tab-headers {\\n\\tdisplay: flex;\\n\\tflex-wrap: wrap;\\n\\tmargin: auto;\\n\\twidth: 100%;\\n}\\n#ec_ap-tab-headers > div{\\n\\tflex: 1 0 auto;\\n\\ttext-align: center;\\n\\tfont-size: 20px;\\n\\tbackground: <<colour tiddler-background>>;\\n\\tline-height: 30px;\\n\\tvertical-align: middle;\\n\\twhite-space: nowrap;\\n\\tpadding: 0 2em;\\n\\tcursor: pointer;\\n}\\n#ec_ap-tab-headers > div.selected {\\n\\tbackground: <<colour page-background>>;\\n}\\n#ec_ap-tabs {\\n\\tbackground: <<colour page-background>>;\\n\\tflex-grow: 1;\\n\\tpadding: 1em;\\n\\toverflow-y: scroll;\\n}\\n#ec_ap-tabs td {\\n\\tpadding: 2px 7px;\\n}\\n#ec_ap-tabs td:first-child {\\n\\tfont-family: monospace;\\n\\tword-break: break-all;\\n}\\n#ec_ap-tabs td:not(:first-child) {\\n\\ttext-align: right;\\n}\\n.ec_ap-annotated {\\n\\tborder-bottom: 1px dotted #888;\\n}\\n#ec_ap-tabs > *:not(.selected) {\\n\\tdisplay: none;\\n}\\n.ec_ap-header-button {\\n\\tfloat: right;\\n\\tfont-variant: small-caps;\\n\\tfont-size: 0.75em;\\n\\tcursor: pointer;\\n}\\n</style>\\n<div id=\\\"ec_ap-footer\\\">\\n\\t<div id=\\\"ec_ap-message\\\" style=\\\"display: none\\\"></div>\\n\\t<div>\\n\\t\\t<strong>Last refresh:</strong> <span id=\\\"ec_ap-last-refresh\\\"></span>\\n\\t</div>\\n\\t<div>\\n\\t\\t<strong>Time taken:</strong> <span id=\\\"ec_ap-total-time\\\"></span> <span id=\\\"ec_ap-times\\\" class=\\\"ec_ap-muted\\\"></span>\\n\\t</div>\\n\\t<div>\\n\\t\\t<strong>Tiddlers refreshed:</strong> <span id=\\\"ec_ap-tiddlers\\\"></span> <span class=\\\"ec_ap-muted\\\">(\\n\\t\\t\\t<span id=\\\"ec_ap-tiddlers-temp\\\"></span>,\\n\\t\\t\\t<span id=\\\"ec_ap-tiddlers-state\\\"></span>,\\n\\t\\t\\t<span id=\\\"ec_ap-tiddlers-system\\\"></span>,\\n\\t\\t\\t<span id=\\\"ec_ap-tiddlers-main\\\"></span>\\n\\t\\t)</span>\\n\\t</div>\\n\\t<a id=\\\"ec_ap-show-details\\\" class=\\\"tc-tiddlylink\\\" href=\\\"#\\\" data-ec-ap=\\\"show-details\\\">Show details</a>\\n</div>\\n<div id=\\\"ec_ap-wrap\\\">\\n<div id=\\\"ec_ap-cover\\\"></div>\\n<div id=\\\"ec_ap-container\\\">\\n\\t<h1>\\n\\t\\t<span>Performance reports:</span>\\n\\t\\t<a\\n\\t\\t\\tid=\\\"ec_ap-clear\\\"\\n\\t\\t\\tclass=\\\"ec_ap-header-button tc-tiddlylink\\\"\\n\\t\\t\\ttitle=\\\"Clicking this will clear all performance data collected so far releasing memory and emptying the results\\\"\\n\\t\\t\\tdata-ec-ap=\\\"clear-data\\\"\\n\\t\\t>\\n\\t\\t\\tclear data\\n\\t\\t</a>\\n\\t\\t<a id=\\\"ec_ap-close\\\" class=\\\"ec_ap-header-button tc-tiddlylink\\\" data-ec-ap=\\\"close\\\">close</a>\\n\\t</h1>\\n\\t<div id=\\\"ec_ap-tab-headers\\\">\\n\\t\\t<div class=\\\"ec_ap-tab-header selected\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--refresh-logs\\\">Refresh logs</div>\\n\\t\\t<div class=\\\"ec_ap-tab-header\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--median\\\">Median (filters)</div>\\n\\t\\t<div class=\\\"ec_ap-tab-header\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--average\\\">Average (filters)</div>\\n\\t\\t<div class=\\\"ec_ap-tab-header\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--total-longest\\\">Total longest (filter)</div>\\n\\t\\t<div class=\\\"ec_ap-tab-header\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--single-longest\\\">Single longest (filter)</div>\\n\\t\\t<div class=\\\"ec_ap-tab-header\\\" data-ec-ap=\\\"tab\\\" data-for=\\\"ec_ap-tab--most-used\\\">Most used filters</div>\\n\\t</div>\\n\\t<div id=\\\"ec_ap-tabs\\\">\\n\\t\\t<div class=\\\"ec_ap-tab--refresh-logs selected\\\">\\n\\t\\t\\t<h2>Latest page refreshes</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tThis displays the times and lists of tiddlers of the last 50 refreshes that TiddlyWiki has processed.<br>\\n\\t\\t\\t\\tA refresh usually occurs when a tiddler state is changed and something on the page has to be updated because of that.<br>\\n\\t\\t\\t\\t<br>\\n\\t\\t\\t\\tLong refresh times may indicate among others: large lists that need to be completely rebuilt; too many and complicated\\n\\t\\t\\t\\tstructure of your tiddlers (or too many tiddlers open at once).\\n\\t\\t\\t</p>\\n\\t\\t\\t<hr>\\n\\t\\t\\t<input type=\\\"checkbox\\\" data-ec-ap=\\\"filter-all\\\" id=\\\"ec_ap-all\\\" checked>\\n\\t\\t\\t<label for=\\\"ec_ap-all\\\"> Show filter logs from all refreshes</label>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tYou can limit what filter appears in other tabs by selecting checkboxes below. \\\"other\\\" refers to all\\n\\t\\t\\t\\tfilters that run outside any TW refresh mechanism.\\n\\t\\t\\t</p>\\n\\n\\t\\t\\t<table id=\\\"ec_ap--last-refreshes\\\"></table>\\n\\t\\t</div>\\n\\t\\t<div class=\\\"ec_ap-tab--most-used\\\">\\n\\t\\t\\t<h2>Most used filters</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tDisplays filter information sorted by which filter was used the largest number of times. This is unlikely to be\\n\\t\\t\\t\\tvery helpful in locating places to improve but might be interesting to look at.\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\n\\t\\t\\t<hr>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\" data-ec-ap=\\\"filter-limit-all\\\">\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\t\\t\\t<table id=\\\"ec_ap--most-used\\\"></table>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\\"ec_ap-tab--single-longest\\\">\\n\\t\\t\\t<h2>Single longest execution</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tDisplays filter information sorted by which filter took the most time in a single execution. This can\\n\\t\\t\\t\\thelp you locate the filters that take the most time on a single execution. Keep in mind:\\n\\t\\t\\t</p>\\n\\t\\t\\t<ul id=\\\"ec_ap-times\\\" class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\t<li>\\n\\t\\t\\t\\t\\tA filter that runs for a long time once can still take less time than a short filter that runs\\n\\t\\t\\t\\t\\tmultiple times.\\n\\t\\t\\t\\t</li>\\n\\t\\t\\t\\t<li>\\n\\t\\t\\t\\t\\tCertain filters (notably ''backlinks'') can take a lot of time the first time they run, after which\\n\\t\\t\\t\\t\\tthey are very quick. Keep an eye on median, average and inspect the last 10 executions to get a better\\n\\t\\t\\t\\t\\tpicture.\\n\\t\\t\\t\\t</li>\\n\\t\\t\\t</ul>\\n\\n\\t\\t\\t<hr>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\t\\t\\t<table id=\\\"ec_ap--single-longest\\\"></table>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\\"ec_ap-tab--total-longest\\\">\\n\\t\\t\\t<h2>Total longest execution</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tDisplays filter information sorted by which filter took the total most time in all executions. This can\\n\\t\\t\\t\\thelp you locate the filters that are short but run so many times they are a problem. Keep in mind:\\n\\t\\t\\t</p>\\n\\t\\t\\t<ul id=\\\"ec_ap-times\\\" class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\t<li>\\n\\t\\t\\t\\t\\tCertain filters (notably ''backlinks'') can take a lot of time the first time they run, after which\\n\\t\\t\\t\\t\\tthey are very quick. Keep an eye on median, average and inspect the last 10 executions to get a better\\n\\t\\t\\t\\t\\tpicture.\\n\\t\\t\\t\\t</li>\\n\\t\\t\\t</ul>\\n\\n\\t\\t\\t<hr>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\t\\t\\t<table id=\\\"ec_ap--total-longest\\\"></table>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\\"ec_ap-tab--average\\\">\\n\\t\\t\\t<h2>Longest average execution</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tDisplays filter information sorted by how much time a filter takes on average. Keep in mind:\\n\\t\\t\\t</p>\\n\\t\\t\\t<ul id=\\\"ec_ap-times\\\" class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\t<li>\\n\\t\\t\\t\\t\\tCertain filters (notably ''backlinks'') can take a lot of time the first time they run, after which\\n\\t\\t\\t\\t\\tthey are very quick, increasing the average. Keep an eye on median and inspect the last 10\\n\\t\\t\\t\\t\\texecutions to get a better picture.\\n\\t\\t\\t\\t</li>\\n\\t\\t\\t</ul>\\n\\n\\t\\t\\t<hr>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\t\\t\\t<table id=\\\"ec_ap--average\\\"></table>\\n\\t\\t</div>\\n\\n\\t\\t<div class=\\\"ec_ap-tab--median\\\">\\n\\t\\t\\t<h2>Longest median execution</h2>\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tDisplays filter information sorted by median of all execution times. This can be helpful in filtering out\\n\\t\\t\\t\\toutliers that take a lot of time the first time they run (like ''backlinks'').\\n\\t\\t\\t</p>\\n\\n\\t\\t\\t<hr>\\n\\n\\t\\t\\t<p class=\\\"ec_ap-muted\\\">\\n\\t\\t\\t\\tMouse over <em>Total time (last 10)</em> to see how many ms the last 10 executions of this filter took.\\n\\t\\t\\t</p>\\n\\t\\t\\t<table id=\\\"ec_ap--median\\\"></table>\\n\\t\\t</div>\\n\\t</div>\\n</div>\\n</div>\\n</$list>\"}}}"}