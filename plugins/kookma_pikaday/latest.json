{"title":"$:/plugins/kookma/pikaday","name":"Pikaday","description":"Date picker from Projectify","author":"Nicolas Petton, Mohammad Rahmani","version":"0.6.0","core-version":">=5.2.3","source":"https://github.com/kookma/TW-Pikaday","list":"readme history license","plugin-type":"plugin","dependents":"","type":"application/json","text":"{\"tiddlers\":{\"$:/config/projectify/FirstDayOfWeek\":{\"title\":\"$:/config/projectify/FirstDayOfWeek\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"1\"},\"$:/plugins/kookma/pikaday/history\":{\"title\":\"$:/plugins/kookma/pikaday/history\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Full change log  https://kookma.github.io/TW-Pikaday/#ChangeLog\\n\\n* ''0.5.4'' -- 2020.09.27 -- minor bug fixes\\n* ''0.5.2'' -- 2020.08.18 -- minor bug fixes\\n* ''0.5.1'' -- 2020.08.12 -- stable release\\n* ''0.2.0'' -- 2020.08.08 -- polished and first stable release\\n* ''0.1.0'' -- 2022.08.07 -- extracted from Projectify\\n\"},\"$:/plugins/kookma/pikaday/images/calendar-event\":{\"title\":\"$:/plugins/kookma/pikaday/images/calendar-event\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"1em\\\" height=\\\"1em\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-calendar3-event\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z\\\"/>\\n  <path d=\\\"M12 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\\\"/>\\n</svg>\\n\"},\"$:/plugins/kookma/pikaday/images/calendar\":{\"title\":\"$:/plugins/kookma/pikaday/images/calendar\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<svg width=\\\"20px\\\" height=\\\"20px\\\" viewBox=\\\"0 0 16 16\\\" class=\\\"bi bi-calendar-week\\\" fill=\\\"currentColor\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n  <path fill-rule=\\\"evenodd\\\" d=\\\"M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z\\\"/>\\n  <path d=\\\"M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z\\\"/>\\n</svg>\\n\"},\"$:/plugins/kookma/pikaday/images/slash-circle\":{\"title\":\"$:/plugins/kookma/pikaday/images/slash-circle\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20px\\\" height=\\\"20px\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-slash-circle\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z\\\"/>\\n  <path d=\\\"M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708z\\\"/>\\n</svg>\\n\"},\"$:/plugins/kookma/pikaday/images/sun\":{\"title\":\"$:/plugins/kookma/pikaday/images/sun\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16px\\\" height=\\\"16px\\\" fill=\\\"currentColor\\\" class=\\\"bi bi-brightness-high\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z\\\"/>\\n</svg>\\n\"},\"$:/language/projectify/Calendar\":{\"title\":\"$:/language/projectify/Calendar\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Calendar\"},\"$:/language/projectify/Clear\":{\"title\":\"$:/language/projectify/Clear\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Clear\"},\"$:/language/projectify/DateFormat\":{\"title\":\"$:/language/projectify/DateFormat\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"DDth mmm\"},\"$:/language/projectify/FirstDayOfWeek\":{\"title\":\"$:/language/projectify/FirstDayOfWeek\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"First day of week\"},\"$:/language/projectify/NextWeek\":{\"title\":\"$:/language/projectify/NextWeek\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Next week\"},\"$:/language/projectify/Schedule/Caption\":{\"title\":\"$:/language/projectify/Schedule/Caption\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Schedule\"},\"$:/language/projectify/Today\":{\"title\":\"$:/language/projectify/Today\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Today\"},\"$:/language/projectify/Tomorrow\":{\"title\":\"$:/language/projectify/Tomorrow\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Tomorrow\"},\"$:/language/projectify/Yesterday\":{\"title\":\"$:/language/projectify/Yesterday\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Yesterday\"},\"$:/plugins/kookma/pikaday/lib/pikaday.css\":{\"title\":\"$:/plugins/kookma/pikaday/lib/pikaday.css\",\"text\":\"/*!\\n * Pikaday\\n * Copyright © 2014 David Bushell | BSD & MIT license | https://dbushell.com/\\n */\\n\\n.pika-single {\\n    z-index: 9999;\\n    display: block;\\n    position: relative;\\n    color: #333;\\n    background: #fff;\\n    border: 1px solid #ccc;\\n    border-bottom-color: #bbb;\\n    font-family: \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif;\\n}\\n\\n/*\\nclear child float (pika-lendar), using the famous micro clearfix hack\\nhttp://nicolasgallagher.com/micro-clearfix-hack/\\n*/\\n.pika-single:before,\\n.pika-single:after {\\n    content: \\\" \\\";\\n    display: table;\\n}\\n.pika-single:after { clear: both }\\n\\n.pika-single.is-hidden {\\n    display: none;\\n}\\n\\n.pika-single.is-bound {\\n    position: absolute;\\n    box-shadow: 0 5px 15px -5px rgba(0,0,0,.5);\\n}\\n\\n.pika-lendar {\\n    float: left;\\n    width: 240px;\\n    margin: 8px;\\n}\\n\\n.pika-title {\\n    position: relative;\\n    text-align: center;\\n}\\n\\n.pika-label {\\n    display: inline-block;\\n    position: relative;\\n    z-index: 9999;\\n    overflow: hidden;\\n    margin: 0;\\n    padding: 5px 3px;\\n    font-size: 14px;\\n    line-height: 20px;\\n    font-weight: bold;\\n    background-color: #fff;\\n}\\n.pika-title select {\\n    cursor: pointer;\\n    position: absolute;\\n    z-index: 9998;\\n    margin: 0;\\n    left: 0;\\n    top: 5px;\\n    opacity: 0;\\n}\\n\\n.pika-prev,\\n.pika-next {\\n    display: block;\\n    cursor: pointer;\\n    position: relative;\\n    outline: none;\\n    border: 0;\\n    padding: 0;\\n    width: 20px;\\n    height: 30px;\\n    /* hide text using text-indent trick, using width value (it's enough) */\\n    text-indent: 20px;\\n    white-space: nowrap;\\n    overflow: hidden;\\n    background-color: transparent;\\n    background-position: center center;\\n    background-repeat: no-repeat;\\n    background-size: 75% 75%;\\n    opacity: .5;\\n}\\n\\n.pika-prev:hover,\\n.pika-next:hover {\\n    opacity: 1;\\n}\\n\\n.pika-prev,\\n.is-rtl .pika-next {\\n    float: left;\\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAUklEQVR42u3VMQoAIBADQf8Pgj+OD9hG2CtONJB2ymQkKe0HbwAP0xucDiQWARITIDEBEnMgMQ8S8+AqBIl6kKgHiXqQqAeJepBo/z38J/U0uAHlaBkBl9I4GwAAAABJRU5ErkJggg==');\\n}\\n\\n.pika-next,\\n.is-rtl .pika-prev {\\n    float: right;\\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAeCAYAAAAsEj5rAAAAU0lEQVR42u3VOwoAMAgE0dwfAnNjU26bYkBCFGwfiL9VVWoO+BJ4Gf3gtsEKKoFBNTCoCAYVwaAiGNQGMUHMkjGbgjk2mIONuXo0nC8XnCf1JXgArVIZAQh5TKYAAAAASUVORK5CYII=');\\n}\\n\\n.pika-prev.is-disabled,\\n.pika-next.is-disabled {\\n    cursor: default;\\n    opacity: .2;\\n}\\n\\n.pika-select {\\n    display: inline-block;\\n}\\n\\n.pika-table {\\n    width: 100%;\\n    border-collapse: collapse;\\n    border-spacing: 0;\\n    border: 0;\\n}\\n\\n.pika-table th,\\n.pika-table td {\\n    width: 14.285714285714286%;\\n    padding: 0;\\n}\\n\\n.pika-table th {\\n    color: #999;\\n    font-size: 12px;\\n    line-height: 25px;\\n    font-weight: bold;\\n    text-align: center;\\n}\\n\\n.pika-button {\\n    cursor: pointer;\\n    display: block;\\n    box-sizing: border-box;\\n    -moz-box-sizing: border-box;\\n    outline: none;\\n    border: 0;\\n    margin: 0;\\n    width: 100%;\\n    padding: 5px;\\n    color: #666;\\n    font-size: 12px;\\n    line-height: 15px;\\n    text-align: right;\\n    background: #f5f5f5;\\n    height: initial;\\n}\\n\\n.pika-week {\\n    font-size: 11px;\\n    color: #999;\\n}\\n\\n.is-today .pika-button {\\n    color: #33aaff;\\n    font-weight: bold;\\n}\\n\\n.is-selected .pika-button,\\n.has-event .pika-button {\\n    color: #fff;\\n    font-weight: bold;\\n    background: #33aaff;\\n    box-shadow: inset 0 1px 3px #178fe5;\\n    border-radius: 3px;\\n}\\n\\n.has-event .pika-button {\\n    background: #005da9;\\n    box-shadow: inset 0 1px 3px #0076c9;\\n}\\n\\n.is-disabled .pika-button,\\n.is-inrange .pika-button {\\n    background: #D5E9F7;\\n}\\n\\n.is-startrange .pika-button {\\n    color: #fff;\\n    background: #6CB31D;\\n    box-shadow: none;\\n    border-radius: 3px;\\n}\\n\\n.is-endrange .pika-button {\\n    color: #fff;\\n    background: #33aaff;\\n    box-shadow: none;\\n    border-radius: 3px;\\n}\\n\\n.is-disabled .pika-button {\\n    pointer-events: none;\\n    cursor: default;\\n    color: #999;\\n    opacity: .3;\\n}\\n\\n.is-outside-current-month .pika-button {\\n    color: #999;\\n    opacity: .3;\\n}\\n\\n.is-selection-disabled {\\n    pointer-events: none;\\n    cursor: default;\\n}\\n\\n.pika-button:hover,\\n.pika-row.pick-whole-week:hover .pika-button {\\n    color: #fff;\\n    background: #ff8000;\\n    box-shadow: none;\\n    border-radius: 3px;\\n}\\n\\n/* styling for abbr */\\n.pika-table abbr {\\n    border-bottom: none;\\n    cursor: help;\\n}\\n\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/css\"},\"$:/plugins/kookma/pikaday/lib/pikaday.js\":{\"title\":\"$:/plugins/kookma/pikaday/lib/pikaday.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/nico/projectify/lib/pikaday.js\\ntype: application/javascript\\nmodule-type: library\\n\\\\*/\\n\\n/*!\\n * Pikaday\\n *\\n * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday\\n */\\n\\n(function (root, factory)\\n{\\n    'use strict';\\n\\n    var moment;\\n    if (typeof exports === 'object') {\\n        // CommonJS module\\n        // Load moment.js as an optional dependency\\n        try { moment = require('moment'); } catch (e) {}\\n        module.exports = factory(moment);\\n    } else if (typeof define === 'function' && define.amd) {\\n        // AMD. Register as an anonymous module.\\n        define(function (req)\\n        {\\n            // Load moment.js as an optional dependency\\n            var id = 'moment';\\n            try { moment = req(id); } catch (e) {}\\n            return factory(moment);\\n        });\\n    } else {\\n        root.Pikaday = factory(root.moment);\\n    }\\n}(this, function (moment)\\n{\\n    'use strict';\\n\\n    /**\\n     * feature detection and helper functions\\n     */\\n    var hasMoment = typeof moment === 'function',\\n\\n    addEvent = function(el, e, callback, capture)\\n    {\\n        if (!!window.addEventListener) {\\n            el.addEventListener(e, callback, !!capture);\\n        } else {\\n            el.attachEvent('on' + e, callback);\\n        }\\n    },\\n\\n    removeEvent = function(el, e, callback, capture)\\n    {\\n        if (!!window.addEventListener) {\\n            el.removeEventListener(e, callback, !!capture);\\n        } else {\\n            el.detachEvent('on' + e, callback);\\n        }\\n    },\\n\\n    trim = function(str)\\n    {\\n        return str.trim ? str.trim() : str.replace(/^\\\\s+|\\\\s+$/g,'');\\n    },\\n\\n    hasClass = function(el, cn)\\n    {\\n        return (' ' + el.className + ' ').indexOf(' ' + cn + ' ') !== -1;\\n    },\\n\\n    addClass = function(el, cn)\\n    {\\n        if (!hasClass(el, cn)) {\\n            el.className = (el.className === '') ? cn : el.className + ' ' + cn;\\n        }\\n    },\\n\\n    removeClass = function(el, cn)\\n    {\\n        el.className = trim((' ' + el.className + ' ').replace(' ' + cn + ' ', ' '));\\n    },\\n\\n    isArray = function(obj)\\n    {\\n        return (/Array/).test(Object.prototype.toString.call(obj));\\n    },\\n\\n    isDate = function(obj)\\n    {\\n        return (/Date/).test(Object.prototype.toString.call(obj)) && !isNaN(obj.getTime());\\n    },\\n\\n    isWeekend = function(date)\\n    {\\n        var day = date.getDay();\\n        return day === 0 || day === 6;\\n    },\\n\\n    isLeapYear = function(year)\\n    {\\n        // solution lifted from date.js (MIT license): https://github.com/datejs/Datejs\\n        return ((year % 4 === 0 && year % 100 !== 0) || year % 400 === 0);\\n    },\\n\\n    getDaysInMonth = function(year, month)\\n    {\\n        return [31, isLeapYear(year) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month];\\n    },\\n\\n    setToStartOfDay = function(date)\\n    {\\n        if (isDate(date)) date.setHours(0,0,0,0);\\n    },\\n\\n    compareDates = function(a,b)\\n    {\\n        // weak date comparison (use setToStartOfDay(date) to ensure correct result)\\n        return a.getTime() === b.getTime();\\n    },\\n\\n    extend = function(to, from, overwrite)\\n    {\\n        var prop, hasProp;\\n        for (prop in from) {\\n            hasProp = to[prop] !== undefined;\\n            if (hasProp && typeof from[prop] === 'object' && from[prop] !== null && from[prop].nodeName === undefined) {\\n                if (isDate(from[prop])) {\\n                    if (overwrite) {\\n                        to[prop] = new Date(from[prop].getTime());\\n                    }\\n                }\\n                else if (isArray(from[prop])) {\\n                    if (overwrite) {\\n                        to[prop] = from[prop].slice(0);\\n                    }\\n                } else {\\n                    to[prop] = extend({}, from[prop], overwrite);\\n                }\\n            } else if (overwrite || !hasProp) {\\n                to[prop] = from[prop];\\n            }\\n        }\\n        return to;\\n    },\\n\\n    fireEvent = function(el, eventName, data)\\n    {\\n        var ev;\\n\\n        if (document.createEvent) {\\n            ev = document.createEvent('HTMLEvents');\\n            ev.initEvent(eventName, true, false);\\n            ev = extend(ev, data);\\n            el.dispatchEvent(ev);\\n        } else if (document.createEventObject) {\\n            ev = document.createEventObject();\\n            ev = extend(ev, data);\\n            el.fireEvent('on' + eventName, ev);\\n        }\\n    },\\n\\n    adjustCalendar = function(calendar) {\\n        if (calendar.month < 0) {\\n            calendar.year -= Math.ceil(Math.abs(calendar.month)/12);\\n            calendar.month += 12;\\n        }\\n        if (calendar.month > 11) {\\n            calendar.year += Math.floor(Math.abs(calendar.month)/12);\\n            calendar.month -= 12;\\n        }\\n        return calendar;\\n    },\\n\\n    /**\\n     * defaults and localisation\\n     */\\n    defaults = {\\n\\n        // bind the picker to a form field\\n        field: null,\\n\\n        // automatically show/hide the picker on `field` focus (default `true` if `field` is set)\\n        bound: undefined,\\n\\n        // data-attribute on the input field with an aria assistance text (only applied when `bound` is set)\\n        ariaLabel: 'Use the arrow keys to pick a date',\\n\\n        // position of the datepicker, relative to the field (default to bottom & left)\\n        // ('bottom' & 'left' keywords are not used, 'top' & 'right' are modifier on the bottom/left position)\\n        position: 'bottom left',\\n\\n        // automatically fit in the viewport even if it means repositioning from the position option\\n        reposition: true,\\n\\n        // the default output format for `.toString()` and `field` value\\n        format: 'YYYY-MM-DD',\\n\\n        // the toString function which gets passed a current date object and format\\n        // and returns a string\\n        toString: null,\\n\\n        // used to create date object from current input string\\n        parse: null,\\n\\n        // the initial date to view when first opened\\n        defaultDate: null,\\n\\n        // make the `defaultDate` the initial selected value\\n        setDefaultDate: false,\\n\\n        // first day of week (0: Sunday, 1: Monday etc)\\n        firstDay: 0,\\n\\n        // minimum number of days in the week that gets week number one\\n        // default ISO 8601, week 01 is the week with the first Thursday (4)\\n        firstWeekOfYearMinDays: 4,\\n\\n        // the default flag for moment's strict date parsing\\n        formatStrict: false,\\n\\n        // the minimum/earliest date that can be selected\\n        minDate: null,\\n        // the maximum/latest date that can be selected\\n        maxDate: null,\\n\\n        // number of years either side, or array of upper/lower range\\n        yearRange: 10,\\n\\n        // show week numbers at head of row\\n        showWeekNumber: false,\\n\\n        // Week picker mode\\n        pickWholeWeek: false,\\n\\n        // used internally (don't config outside)\\n        minYear: 0,\\n        maxYear: 9999,\\n        minMonth: undefined,\\n        maxMonth: undefined,\\n\\n        startRange: null,\\n        endRange: null,\\n\\n        isRTL: false,\\n\\n        // Additional text to append to the year in the calendar title\\n        yearSuffix: '',\\n\\n        // Render the month after year in the calendar title\\n        showMonthAfterYear: false,\\n\\n        // Render days of the calendar grid that fall in the next or previous month\\n        showDaysInNextAndPreviousMonths: false,\\n\\n        // Allows user to select days that fall in the next or previous month\\n        enableSelectionDaysInNextAndPreviousMonths: false,\\n\\n        // how many months are visible\\n        numberOfMonths: 1,\\n\\n        // when numberOfMonths is used, this will help you to choose where the main calendar will be (default `left`, can be set to `right`)\\n        // only used for the first display or when a selected date is not visible\\n        mainCalendar: 'left',\\n\\n        // Specify a DOM element to render the calendar in\\n        container: undefined,\\n\\n        // Blur field when date is selected\\n        blurFieldOnSelect : true,\\n\\n        // internationalization\\n        i18n: {\\n            previousMonth : 'Previous Month',\\n            nextMonth     : 'Next Month',\\n            months        : ['January','February','March','April','May','June','July','August','September','October','November','December'],\\n            weekdays      : ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],\\n            weekdaysShort : ['Sun','Mon','Tue','Wed','Thu','Fri','Sat']\\n        },\\n\\n        // Theme Classname\\n        theme: null,\\n\\n        // events array\\n        events: [],\\n\\n        // callback function\\n        onSelect: null,\\n        onOpen: null,\\n        onClose: null,\\n        onDraw: null,\\n\\n        // Enable keyboard input\\n        keyboardInput: true\\n    },\\n\\n\\n    /**\\n     * templating functions to abstract HTML rendering\\n     */\\n    renderDayName = function(opts, day, abbr)\\n    {\\n        day += opts.firstDay;\\n        while (day >= 7) {\\n            day -= 7;\\n        }\\n        return abbr ? opts.i18n.weekdaysShort[day] : opts.i18n.weekdays[day];\\n    },\\n\\n    renderDay = function(opts)\\n    {\\n        var arr = [];\\n        var ariaSelected = 'false';\\n        if (opts.isEmpty) {\\n            if (opts.showDaysInNextAndPreviousMonths) {\\n                arr.push('is-outside-current-month');\\n\\n                if(!opts.enableSelectionDaysInNextAndPreviousMonths) {\\n                    arr.push('is-selection-disabled');\\n                }\\n\\n            } else {\\n                return '<td class=\\\"is-empty\\\"></td>';\\n            }\\n        }\\n        if (opts.isDisabled) {\\n            arr.push('is-disabled');\\n        }\\n        if (opts.isToday) {\\n            arr.push('is-today');\\n        }\\n        if (opts.isSelected) {\\n            arr.push('is-selected');\\n            ariaSelected = 'true';\\n        }\\n        if (opts.hasEvent) {\\n            arr.push('has-event');\\n        }\\n        if (opts.isInRange) {\\n            arr.push('is-inrange');\\n        }\\n        if (opts.isStartRange) {\\n            arr.push('is-startrange');\\n        }\\n        if (opts.isEndRange) {\\n            arr.push('is-endrange');\\n        }\\n        return '<td data-day=\\\"' + opts.day + '\\\" class=\\\"' + arr.join(' ') + '\\\" aria-selected=\\\"' + ariaSelected + '\\\">' +\\n                 '<button class=\\\"pika-button pika-day\\\" type=\\\"button\\\" ' +\\n                    'data-pika-year=\\\"' + opts.year + '\\\" data-pika-month=\\\"' + opts.month + '\\\" data-pika-day=\\\"' + opts.day + '\\\">' +\\n                        opts.day +\\n                 '</button>' +\\n               '</td>';\\n    },\\n\\n    isoWeek = function(date, firstWeekOfYearMinDays) {\\n        // Ensure we're at the start of the day.\\n        date.setHours(0, 0, 0, 0);\\n\\n        // Thursday in current week decides the year because January 4th\\n        // is always in the first week according to ISO8601.\\n        var yearDay        = date.getDate(),\\n            weekDay        = date.getDay(),\\n            dayInFirstWeek = firstWeekOfYearMinDays,\\n            dayShift       = dayInFirstWeek - 1, // counting starts at 0\\n            daysPerWeek    = 7,\\n            prevWeekDay    = function(day) { return (day + daysPerWeek - 1) % daysPerWeek; };\\n\\n        // Adjust to Thursday in week 1 and count number of weeks from date to week 1.\\n        date.setDate(yearDay + dayShift - prevWeekDay(weekDay));\\n\\n        var jan4th      = new Date(date.getFullYear(), 0, dayInFirstWeek),\\n            msPerDay    = 24 * 60 * 60 * 1000,\\n            daysBetween = (date.getTime() - jan4th.getTime()) / msPerDay,\\n            weekNum     = 1 + Math.round((daysBetween - dayShift + prevWeekDay(jan4th.getDay())) / daysPerWeek);\\n\\n        return weekNum;\\n    },\\n\\n    renderWeek = function (d, m, y, firstWeekOfYearMinDays) {\\n        var date = new Date(y, m, d),\\n            week = hasMoment ? moment(date).isoWeek() : isoWeek(date, firstWeekOfYearMinDays);\\n\\n        return '<td class=\\\"pika-week\\\">' + week + '</td>';\\n    },\\n\\n    renderRow = function(days, isRTL, pickWholeWeek, isRowSelected)\\n    {\\n        return '<tr class=\\\"pika-row' + (pickWholeWeek ? ' pick-whole-week' : '') + (isRowSelected ? ' is-selected' : '') + '\\\">' + (isRTL ? days.reverse() : days).join('') + '</tr>';\\n    },\\n\\n    renderBody = function(rows)\\n    {\\n        return '<tbody>' + rows.join('') + '</tbody>';\\n    },\\n\\n    renderHead = function(opts)\\n    {\\n        var i, arr = [];\\n        if (opts.showWeekNumber) {\\n            arr.push('<th></th>');\\n        }\\n        for (i = 0; i < 7; i++) {\\n            arr.push('<th scope=\\\"col\\\"><abbr title=\\\"' + renderDayName(opts, i) + '\\\">' + renderDayName(opts, i, true) + '</abbr></th>');\\n        }\\n        return '<thead><tr>' + (opts.isRTL ? arr.reverse() : arr).join('') + '</tr></thead>';\\n    },\\n\\n    renderTitle = function(instance, c, year, month, refYear, randId)\\n    {\\n        var i, j, arr,\\n            opts = instance._o,\\n            isMinYear = year === opts.minYear,\\n            isMaxYear = year === opts.maxYear,\\n            html = '<div id=\\\"' + randId + '\\\" class=\\\"pika-title\\\" role=\\\"heading\\\" aria-live=\\\"assertive\\\">',\\n            monthHtml,\\n            yearHtml,\\n            prev = true,\\n            next = true;\\n\\n        for (arr = [], i = 0; i < 12; i++) {\\n            arr.push('<option value=\\\"' + (year === refYear ? i - c : 12 + i - c) + '\\\"' +\\n                (i === month ? ' selected=\\\"selected\\\"': '') +\\n                ((isMinYear && i < opts.minMonth) || (isMaxYear && i > opts.maxMonth) ? ' disabled=\\\"disabled\\\"' : '') + '>' +\\n                opts.i18n.months[i] + '</option>');\\n        }\\n\\n        monthHtml = '<div class=\\\"pika-label\\\">' + opts.i18n.months[month] + '<select class=\\\"pika-select pika-select-month\\\" tabindex=\\\"-1\\\">' + arr.join('') + '</select></div>';\\n\\n        if (isArray(opts.yearRange)) {\\n            i = opts.yearRange[0];\\n            j = opts.yearRange[1] + 1;\\n        } else {\\n            i = year - opts.yearRange;\\n            j = 1 + year + opts.yearRange;\\n        }\\n\\n        for (arr = []; i < j && i <= opts.maxYear; i++) {\\n            if (i >= opts.minYear) {\\n                arr.push('<option value=\\\"' + i + '\\\"' + (i === year ? ' selected=\\\"selected\\\"': '') + '>' + (i) + '</option>');\\n            }\\n        }\\n        yearHtml = '<div class=\\\"pika-label\\\">' + year + opts.yearSuffix + '<select class=\\\"pika-select pika-select-year\\\" tabindex=\\\"-1\\\">' + arr.join('') + '</select></div>';\\n\\n        if (opts.showMonthAfterYear) {\\n            html += yearHtml + monthHtml;\\n        } else {\\n            html += monthHtml + yearHtml;\\n        }\\n\\n        if (isMinYear && (month === 0 || opts.minMonth >= month)) {\\n            prev = false;\\n        }\\n\\n        if (isMaxYear && (month === 11 || opts.maxMonth <= month)) {\\n            next = false;\\n        }\\n\\n        if (c === 0) {\\n            html += '<button class=\\\"pika-prev' + (prev ? '' : ' is-disabled') + '\\\" type=\\\"button\\\">' + opts.i18n.previousMonth + '</button>';\\n        }\\n        if (c === (instance._o.numberOfMonths - 1) ) {\\n            html += '<button class=\\\"pika-next' + (next ? '' : ' is-disabled') + '\\\" type=\\\"button\\\">' + opts.i18n.nextMonth + '</button>';\\n        }\\n\\n        return html += '</div>';\\n    },\\n\\n    renderTable = function(opts, data, randId)\\n    {\\n        return '<table cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" class=\\\"pika-table\\\" role=\\\"grid\\\" aria-labelledby=\\\"' + randId + '\\\">' + renderHead(opts) + renderBody(data) + '</table>';\\n    },\\n\\n\\n    /**\\n     * Pikaday constructor\\n     */\\n    Pikaday = function(options)\\n    {\\n        var self = this,\\n            opts = self.config(options);\\n\\n        self._onMouseDown = function(e)\\n        {\\n            if (!self._v) {\\n                return;\\n            }\\n            e = e || window.event;\\n            var target = e.target || e.srcElement;\\n            if (!target) {\\n                return;\\n            }\\n\\n            if (!hasClass(target, 'is-disabled')) {\\n                if (hasClass(target, 'pika-button') && !hasClass(target, 'is-empty') && !hasClass(target.parentNode, 'is-disabled')) {\\n                    self.setDate(new Date(target.getAttribute('data-pika-year'), target.getAttribute('data-pika-month'), target.getAttribute('data-pika-day')));\\n                    if (opts.bound) {\\n                        setTimeout(function() {\\n                            self.hide();\\n                            if (opts.blurFieldOnSelect && opts.field) {\\n                                opts.field.blur();\\n                            }\\n                        }, 100);\\n                    }\\n                }\\n                else if (hasClass(target, 'pika-prev')) {\\n                    self.prevMonth();\\n                }\\n                else if (hasClass(target, 'pika-next')) {\\n                    self.nextMonth();\\n                }\\n            }\\n            if (!hasClass(target, 'pika-select')) {\\n                // if this is touch event prevent mouse events emulation\\n                if (e.preventDefault) {\\n                    e.preventDefault();\\n                } else {\\n                    e.returnValue = false;\\n                    return false;\\n                }\\n            } else {\\n                self._c = true;\\n            }\\n        };\\n\\n        self._onChange = function(e)\\n        {\\n            e = e || window.event;\\n            var target = e.target || e.srcElement;\\n            if (!target) {\\n                return;\\n            }\\n            if (hasClass(target, 'pika-select-month')) {\\n                self.gotoMonth(target.value);\\n            }\\n            else if (hasClass(target, 'pika-select-year')) {\\n                self.gotoYear(target.value);\\n            }\\n        };\\n\\n        self._onKeyChange = function(e)\\n        {\\n            e = e || window.event;\\n\\n            if (self.isVisible()) {\\n\\n                switch(e.keyCode){\\n                    case 13:\\n                    case 27:\\n                        if (opts.field) {\\n                            opts.field.blur();\\n                        }\\n                        break;\\n                    case 37:\\n                        self.adjustDate('subtract', 1);\\n                        break;\\n                    case 38:\\n                        self.adjustDate('subtract', 7);\\n                        break;\\n                    case 39:\\n                        self.adjustDate('add', 1);\\n                        break;\\n                    case 40:\\n                        self.adjustDate('add', 7);\\n                        break;\\n                    case 8:\\n                    case 46:\\n                        self.setDate(null);\\n                        break;\\n                }\\n            }\\n        };\\n\\n        self._parseFieldValue = function()\\n        {\\n            if (opts.parse) {\\n                return opts.parse(opts.field.value, opts.format);\\n            } else if (hasMoment) {\\n                var date = moment(opts.field.value, opts.format, opts.formatStrict);\\n                return (date && date.isValid()) ? date.toDate() : null;\\n            } else {\\n                return new Date(Date.parse(opts.field.value));\\n            }\\n        };\\n\\n        self._onInputChange = function(e)\\n        {\\n            var date;\\n\\n            if (e.firedBy === self) {\\n                return;\\n            }\\n            date = self._parseFieldValue();\\n            if (isDate(date)) {\\n              self.setDate(date);\\n            }\\n            if (!self._v) {\\n                self.show();\\n            }\\n        };\\n\\n        self._onInputFocus = function()\\n        {\\n            self.show();\\n        };\\n\\n        self._onInputClick = function()\\n        {\\n            self.show();\\n        };\\n\\n        self._onInputBlur = function()\\n        {\\n            // IE allows pika div to gain focus; catch blur the input field\\n            var pEl = document.activeElement;\\n            do {\\n                if (hasClass(pEl, 'pika-single')) {\\n                    return;\\n                }\\n            }\\n            while ((pEl = pEl.parentNode));\\n\\n            if (!self._c) {\\n                self._b = setTimeout(function() {\\n                    self.hide();\\n                }, 50);\\n            }\\n            self._c = false;\\n        };\\n\\n        self._onClick = function(e)\\n        {\\n            e = e || window.event;\\n            var target = e.target || e.srcElement,\\n                pEl = target;\\n            if (!target) {\\n                return;\\n            }\\n            if (!hasEventListeners && hasClass(target, 'pika-select')) {\\n                if (!target.onchange) {\\n                    target.setAttribute('onchange', 'return;');\\n                    addEvent(target, 'change', self._onChange);\\n                }\\n            }\\n            do {\\n                if (hasClass(pEl, 'pika-single') || pEl === opts.trigger) {\\n                    return;\\n                }\\n            }\\n            while ((pEl = pEl.parentNode));\\n            if (self._v && target !== opts.trigger && pEl !== opts.trigger) {\\n                self.hide();\\n            }\\n        };\\n\\n        self.el = document.createElement('div');\\n        self.el.className = 'pika-single' + (opts.isRTL ? ' is-rtl' : '') + (opts.theme ? ' ' + opts.theme : '');\\n\\n        addEvent(self.el, 'mousedown', self._onMouseDown, true);\\n        addEvent(self.el, 'touchend', self._onMouseDown, true);\\n        addEvent(self.el, 'change', self._onChange);\\n\\n        if (opts.keyboardInput) {\\n            addEvent(document, 'keydown', self._onKeyChange);\\n        }\\n\\n        if (opts.field) {\\n            if (opts.container) {\\n                opts.container.appendChild(self.el);\\n            } else if (opts.bound) {\\n                document.body.appendChild(self.el);\\n            } else {\\n                opts.field.parentNode.insertBefore(self.el, opts.field.nextSibling);\\n            }\\n            addEvent(opts.field, 'change', self._onInputChange);\\n\\n            if (!opts.defaultDate) {\\n                opts.defaultDate = self._parseFieldValue();\\n                opts.setDefaultDate = true;\\n            }\\n        }\\n\\n        var defDate = opts.defaultDate;\\n\\n        if (isDate(defDate)) {\\n            if (opts.setDefaultDate) {\\n                self.setDate(defDate, true);\\n            } else {\\n                self.gotoDate(defDate);\\n            }\\n        } else {\\n            self.gotoDate(new Date());\\n        }\\n\\n        if (opts.bound) {\\n            this.hide();\\n            self.el.className += ' is-bound';\\n            addEvent(opts.trigger, 'click', self._onInputClick);\\n            addEvent(opts.trigger, 'focus', self._onInputFocus);\\n            addEvent(opts.trigger, 'blur', self._onInputBlur);\\n        } else {\\n            this.show();\\n        }\\n    };\\n\\n\\n    /**\\n     * public Pikaday API\\n     */\\n    Pikaday.prototype = {\\n\\n\\n        /**\\n         * configure functionality\\n         */\\n        config: function(options)\\n        {\\n            if (!this._o) {\\n                this._o = extend({}, defaults, true);\\n            }\\n\\n            var opts = extend(this._o, options, true);\\n\\n            opts.isRTL = !!opts.isRTL;\\n\\n            opts.field = (opts.field && opts.field.nodeName) ? opts.field : null;\\n\\n            opts.theme = (typeof opts.theme) === 'string' && opts.theme ? opts.theme : null;\\n\\n            opts.bound = !!(opts.bound !== undefined ? opts.field && opts.bound : opts.field);\\n\\n            opts.trigger = (opts.trigger && opts.trigger.nodeName) ? opts.trigger : opts.field;\\n\\n            opts.disableWeekends = !!opts.disableWeekends;\\n\\n            opts.disableDayFn = (typeof opts.disableDayFn) === 'function' ? opts.disableDayFn : null;\\n\\n            var nom = parseInt(opts.numberOfMonths, 10) || 1;\\n            opts.numberOfMonths = nom > 4 ? 4 : nom;\\n\\n            if (!isDate(opts.minDate)) {\\n                opts.minDate = false;\\n            }\\n            if (!isDate(opts.maxDate)) {\\n                opts.maxDate = false;\\n            }\\n            if ((opts.minDate && opts.maxDate) && opts.maxDate < opts.minDate) {\\n                opts.maxDate = opts.minDate = false;\\n            }\\n            if (opts.minDate) {\\n                this.setMinDate(opts.minDate);\\n            }\\n            if (opts.maxDate) {\\n                this.setMaxDate(opts.maxDate);\\n            }\\n\\n            if (isArray(opts.yearRange)) {\\n                var fallback = new Date().getFullYear() - 10;\\n                opts.yearRange[0] = parseInt(opts.yearRange[0], 10) || fallback;\\n                opts.yearRange[1] = parseInt(opts.yearRange[1], 10) || fallback;\\n            } else {\\n                opts.yearRange = Math.abs(parseInt(opts.yearRange, 10)) || defaults.yearRange;\\n                if (opts.yearRange > 100) {\\n                    opts.yearRange = 100;\\n                }\\n            }\\n\\n            return opts;\\n        },\\n\\n        /**\\n         * return a formatted string of the current selection (using Moment.js if available)\\n         */\\n        toString: function(format)\\n        {\\n            format = format || this._o.format;\\n            if (!isDate(this._d)) {\\n                return '';\\n            }\\n            if (this._o.toString) {\\n              return this._o.toString(this._d, format);\\n            }\\n            if (hasMoment) {\\n              return moment(this._d).format(format);\\n            }\\n            return this._d.toDateString();\\n        },\\n\\n        /**\\n         * return a Moment.js object of the current selection (if available)\\n         */\\n        getMoment: function()\\n        {\\n            return hasMoment ? moment(this._d) : null;\\n        },\\n\\n        /**\\n         * set the current selection from a Moment.js object (if available)\\n         */\\n        setMoment: function(date, preventOnSelect)\\n        {\\n            if (hasMoment && moment.isMoment(date)) {\\n                this.setDate(date.toDate(), preventOnSelect);\\n            }\\n        },\\n\\n        /**\\n         * return a Date object of the current selection\\n         */\\n        getDate: function()\\n        {\\n            return isDate(this._d) ? new Date(this._d.getTime()) : null;\\n        },\\n\\n        /**\\n         * set the current selection\\n         */\\n        setDate: function(date, preventOnSelect)\\n        {\\n            if (!date) {\\n                this._d = null;\\n\\n                if (this._o.field) {\\n                    this._o.field.value = '';\\n                    fireEvent(this._o.field, 'change', { firedBy: this });\\n                }\\n\\n                return this.draw();\\n            }\\n            if (typeof date === 'string') {\\n                date = new Date(Date.parse(date));\\n            }\\n            if (!isDate(date)) {\\n                return;\\n            }\\n\\n            var min = this._o.minDate,\\n                max = this._o.maxDate;\\n\\n            if (isDate(min) && date < min) {\\n                date = min;\\n            } else if (isDate(max) && date > max) {\\n                date = max;\\n            }\\n\\n            this._d = new Date(date.getTime());\\n            setToStartOfDay(this._d);\\n            this.gotoDate(this._d);\\n\\n            if (this._o.field) {\\n                this._o.field.value = this.toString();\\n                fireEvent(this._o.field, 'change', { firedBy: this });\\n            }\\n            if (!preventOnSelect && typeof this._o.onSelect === 'function') {\\n                this._o.onSelect.call(this, this.getDate());\\n            }\\n        },\\n\\n        /**\\n         * clear and reset the date\\n         */\\n        clear: function()\\n        {\\n            this.setDate(null);\\n        },\\n\\n        /**\\n         * change view to a specific date\\n         */\\n        gotoDate: function(date)\\n        {\\n            var newCalendar = true;\\n\\n            if (!isDate(date)) {\\n                return;\\n            }\\n\\n            if (this.calendars) {\\n                var firstVisibleDate = new Date(this.calendars[0].year, this.calendars[0].month, 1),\\n                    lastVisibleDate = new Date(this.calendars[this.calendars.length-1].year, this.calendars[this.calendars.length-1].month, 1),\\n                    visibleDate = date.getTime();\\n                // get the end of the month\\n                lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);\\n                lastVisibleDate.setDate(lastVisibleDate.getDate()-1);\\n                newCalendar = (visibleDate < firstVisibleDate.getTime() || lastVisibleDate.getTime() < visibleDate);\\n            }\\n\\n            if (newCalendar) {\\n                this.calendars = [{\\n                    month: date.getMonth(),\\n                    year: date.getFullYear()\\n                }];\\n                if (this._o.mainCalendar === 'right') {\\n                    this.calendars[0].month += 1 - this._o.numberOfMonths;\\n                }\\n            }\\n\\n            this.adjustCalendars();\\n        },\\n\\n        adjustDate: function(sign, days) {\\n\\n            var day = this.getDate() || new Date();\\n            var difference = parseInt(days)*24*60*60*1000;\\n\\n            var newDay;\\n\\n            if (sign === 'add') {\\n                newDay = new Date(day.valueOf() + difference);\\n            } else if (sign === 'subtract') {\\n                newDay = new Date(day.valueOf() - difference);\\n            }\\n\\n            this.setDate(newDay);\\n        },\\n\\n        adjustCalendars: function() {\\n            this.calendars[0] = adjustCalendar(this.calendars[0]);\\n            for (var c = 1; c < this._o.numberOfMonths; c++) {\\n                this.calendars[c] = adjustCalendar({\\n                    month: this.calendars[0].month + c,\\n                    year: this.calendars[0].year\\n                });\\n            }\\n            this.draw();\\n        },\\n\\n        gotoToday: function()\\n        {\\n            this.gotoDate(new Date());\\n        },\\n\\n        /**\\n         * change view to a specific month (zero-index, e.g. 0: January)\\n         */\\n        gotoMonth: function(month)\\n        {\\n            if (!isNaN(month)) {\\n                this.calendars[0].month = parseInt(month, 10);\\n                this.adjustCalendars();\\n            }\\n        },\\n\\n        nextMonth: function()\\n        {\\n            this.calendars[0].month++;\\n            this.adjustCalendars();\\n        },\\n\\n        prevMonth: function()\\n        {\\n            this.calendars[0].month--;\\n            this.adjustCalendars();\\n        },\\n\\n        /**\\n         * change view to a specific full year (e.g. \\\"2012\\\")\\n         */\\n        gotoYear: function(year)\\n        {\\n            if (!isNaN(year)) {\\n                this.calendars[0].year = parseInt(year, 10);\\n                this.adjustCalendars();\\n            }\\n        },\\n\\n        /**\\n         * change the minDate\\n         */\\n        setMinDate: function(value)\\n        {\\n            if(value instanceof Date) {\\n                setToStartOfDay(value);\\n                this._o.minDate = value;\\n                this._o.minYear  = value.getFullYear();\\n                this._o.minMonth = value.getMonth();\\n            } else {\\n                this._o.minDate = defaults.minDate;\\n                this._o.minYear  = defaults.minYear;\\n                this._o.minMonth = defaults.minMonth;\\n                this._o.startRange = defaults.startRange;\\n            }\\n\\n            this.draw();\\n        },\\n\\n        /**\\n         * change the maxDate\\n         */\\n        setMaxDate: function(value)\\n        {\\n            if(value instanceof Date) {\\n                setToStartOfDay(value);\\n                this._o.maxDate = value;\\n                this._o.maxYear = value.getFullYear();\\n                this._o.maxMonth = value.getMonth();\\n            } else {\\n                this._o.maxDate = defaults.maxDate;\\n                this._o.maxYear = defaults.maxYear;\\n                this._o.maxMonth = defaults.maxMonth;\\n                this._o.endRange = defaults.endRange;\\n            }\\n\\n            this.draw();\\n        },\\n\\n        setStartRange: function(value)\\n        {\\n            this._o.startRange = value;\\n        },\\n\\n        setEndRange: function(value)\\n        {\\n            this._o.endRange = value;\\n        },\\n\\n        /**\\n         * refresh the HTML\\n         */\\n        draw: function(force)\\n        {\\n            if (!this._v && !force) {\\n                return;\\n            }\\n            var opts = this._o,\\n                minYear = opts.minYear,\\n                maxYear = opts.maxYear,\\n                minMonth = opts.minMonth,\\n                maxMonth = opts.maxMonth,\\n                html = '',\\n                randId;\\n\\n            if (this._y <= minYear) {\\n                this._y = minYear;\\n                if (!isNaN(minMonth) && this._m < minMonth) {\\n                    this._m = minMonth;\\n                }\\n            }\\n            if (this._y >= maxYear) {\\n                this._y = maxYear;\\n                if (!isNaN(maxMonth) && this._m > maxMonth) {\\n                    this._m = maxMonth;\\n                }\\n            }\\n\\n            for (var c = 0; c < opts.numberOfMonths; c++) {\\n                randId = 'pika-title-' + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 2);\\n                html += '<div class=\\\"pika-lendar\\\">' + renderTitle(this, c, this.calendars[c].year, this.calendars[c].month, this.calendars[0].year, randId) + this.render(this.calendars[c].year, this.calendars[c].month, randId) + '</div>';\\n            }\\n\\n            this.el.innerHTML = html;\\n\\n            if (opts.bound) {\\n                if(opts.field.type !== 'hidden') {\\n                    setTimeout(function() {\\n                        opts.trigger.focus();\\n                    }, 1);\\n                }\\n            }\\n\\n            if (typeof this._o.onDraw === 'function') {\\n                this._o.onDraw(this);\\n            }\\n\\n            if (opts.bound) {\\n                // let the screen reader user know to use arrow keys\\n                opts.field.setAttribute('aria-label', opts.ariaLabel);\\n            }\\n        },\\n\\n        adjustPosition: function()\\n        {\\n            var field, pEl, width, height, viewportWidth, viewportHeight, scrollTop, left, top, clientRect, leftAligned, bottomAligned;\\n\\n            if (this._o.container) return;\\n\\n            this.el.style.position = 'absolute';\\n\\n            field = this._o.trigger;\\n            pEl = field;\\n            width = this.el.offsetWidth;\\n            height = this.el.offsetHeight;\\n            viewportWidth = window.innerWidth || document.documentElement.clientWidth;\\n            viewportHeight = window.innerHeight || document.documentElement.clientHeight;\\n            scrollTop = window.pageYOffset || document.body.scrollTop || document.documentElement.scrollTop;\\n            leftAligned = true;\\n            bottomAligned = true;\\n\\n            if (typeof field.getBoundingClientRect === 'function') {\\n                clientRect = field.getBoundingClientRect();\\n                left = clientRect.left + window.pageXOffset;\\n                top = clientRect.bottom + window.pageYOffset;\\n            } else {\\n                left = pEl.offsetLeft;\\n                top  = pEl.offsetTop + pEl.offsetHeight;\\n                while((pEl = pEl.offsetParent)) {\\n                    left += pEl.offsetLeft;\\n                    top  += pEl.offsetTop;\\n                }\\n            }\\n\\n            // default position is bottom & left\\n            if ((this._o.reposition && left + width > viewportWidth) ||\\n                (\\n                    this._o.position.indexOf('right') > -1 &&\\n                    left - width + field.offsetWidth > 0\\n                )\\n            ) {\\n                left = left - width + field.offsetWidth;\\n                leftAligned = false;\\n            }\\n            if ((this._o.reposition && top + height > viewportHeight + scrollTop) ||\\n                (\\n                    this._o.position.indexOf('top') > -1 &&\\n                    top - height - field.offsetHeight > 0\\n                )\\n            ) {\\n                top = top - height - field.offsetHeight;\\n                bottomAligned = false;\\n            }\\n\\n            this.el.style.left = left + 'px';\\n            this.el.style.top = top + 'px';\\n\\n            addClass(this.el, leftAligned ? 'left-aligned' : 'right-aligned');\\n            addClass(this.el, bottomAligned ? 'bottom-aligned' : 'top-aligned');\\n            removeClass(this.el, !leftAligned ? 'left-aligned' : 'right-aligned');\\n            removeClass(this.el, !bottomAligned ? 'bottom-aligned' : 'top-aligned');\\n        },\\n\\n        /**\\n         * render HTML for a particular month\\n         */\\n        render: function(year, month, randId)\\n        {\\n            var opts   = this._o,\\n                now    = new Date(),\\n                days   = getDaysInMonth(year, month),\\n                before = new Date(year, month, 1).getDay(),\\n                data   = [],\\n                row    = [];\\n            setToStartOfDay(now);\\n            if (opts.firstDay > 0) {\\n                before -= opts.firstDay;\\n                if (before < 0) {\\n                    before += 7;\\n                }\\n            }\\n            var previousMonth = month === 0 ? 11 : month - 1,\\n                nextMonth = month === 11 ? 0 : month + 1,\\n                yearOfPreviousMonth = month === 0 ? year - 1 : year,\\n                yearOfNextMonth = month === 11 ? year + 1 : year,\\n                daysInPreviousMonth = getDaysInMonth(yearOfPreviousMonth, previousMonth);\\n            var cells = days + before,\\n                after = cells;\\n            while(after > 7) {\\n                after -= 7;\\n            }\\n            cells += 7 - after;\\n            var isWeekSelected = false;\\n            for (var i = 0, r = 0; i < cells; i++)\\n            {\\n                var day = new Date(year, month, 1 + (i - before)),\\n                    isSelected = isDate(this._d) ? compareDates(day, this._d) : false,\\n                    isToday = compareDates(day, now),\\n                    hasEvent = opts.events.indexOf(day.toDateString()) !== -1 ? true : false,\\n                    isEmpty = i < before || i >= (days + before),\\n                    dayNumber = 1 + (i - before),\\n                    monthNumber = month,\\n                    yearNumber = year,\\n                    isStartRange = opts.startRange && compareDates(opts.startRange, day),\\n                    isEndRange = opts.endRange && compareDates(opts.endRange, day),\\n                    isInRange = opts.startRange && opts.endRange && opts.startRange < day && day < opts.endRange,\\n                    isDisabled = (opts.minDate && day < opts.minDate) ||\\n                                 (opts.maxDate && day > opts.maxDate) ||\\n                                 (opts.disableWeekends && isWeekend(day)) ||\\n                                 (opts.disableDayFn && opts.disableDayFn(day));\\n\\n                if (isEmpty) {\\n                    if (i < before) {\\n                        dayNumber = daysInPreviousMonth + dayNumber;\\n                        monthNumber = previousMonth;\\n                        yearNumber = yearOfPreviousMonth;\\n                    } else {\\n                        dayNumber = dayNumber - days;\\n                        monthNumber = nextMonth;\\n                        yearNumber = yearOfNextMonth;\\n                    }\\n                }\\n\\n                var dayConfig = {\\n                        day: dayNumber,\\n                        month: monthNumber,\\n                        year: yearNumber,\\n                        hasEvent: hasEvent,\\n                        isSelected: isSelected,\\n                        isToday: isToday,\\n                        isDisabled: isDisabled,\\n                        isEmpty: isEmpty,\\n                        isStartRange: isStartRange,\\n                        isEndRange: isEndRange,\\n                        isInRange: isInRange,\\n                        showDaysInNextAndPreviousMonths: opts.showDaysInNextAndPreviousMonths,\\n                        enableSelectionDaysInNextAndPreviousMonths: opts.enableSelectionDaysInNextAndPreviousMonths\\n                    };\\n\\n                if (opts.pickWholeWeek && isSelected) {\\n                    isWeekSelected = true;\\n                }\\n\\n                row.push(renderDay(dayConfig));\\n\\n                if (++r === 7) {\\n                    if (opts.showWeekNumber) {\\n                        row.unshift(renderWeek(i - before, month, year, opts.firstWeekOfYearMinDays));\\n                    }\\n                    data.push(renderRow(row, opts.isRTL, opts.pickWholeWeek, isWeekSelected));\\n                    row = [];\\n                    r = 0;\\n                    isWeekSelected = false;\\n                }\\n            }\\n            return renderTable(opts, data, randId);\\n        },\\n\\n        isVisible: function()\\n        {\\n            return this._v;\\n        },\\n\\n        show: function()\\n        {\\n            if (!this.isVisible()) {\\n                this._v = true;\\n                this.draw();\\n                removeClass(this.el, 'is-hidden');\\n                if (this._o.bound) {\\n                    addEvent(document, 'click', this._onClick);\\n                    this.adjustPosition();\\n                }\\n                if (typeof this._o.onOpen === 'function') {\\n                    this._o.onOpen.call(this);\\n                }\\n            }\\n        },\\n\\n        hide: function()\\n        {\\n            var v = this._v;\\n            if (v !== false) {\\n                if (this._o.bound) {\\n                    removeEvent(document, 'click', this._onClick);\\n                }\\n\\n                if (!this._o.container) {\\n                    this.el.style.position = 'static'; // reset\\n                    this.el.style.left = 'auto';\\n                    this.el.style.top = 'auto';\\n                }\\n                addClass(this.el, 'is-hidden');\\n                this._v = false;\\n                if (v !== undefined && typeof this._o.onClose === 'function') {\\n                    this._o.onClose.call(this);\\n                }\\n            }\\n        },\\n\\n        /**\\n         * GAME OVER\\n         */\\n        destroy: function()\\n        {\\n            var opts = this._o;\\n\\n            this.hide();\\n            removeEvent(this.el, 'mousedown', this._onMouseDown, true);\\n            removeEvent(this.el, 'touchend', this._onMouseDown, true);\\n            removeEvent(this.el, 'change', this._onChange);\\n            if (opts.keyboardInput) {\\n                removeEvent(document, 'keydown', this._onKeyChange);\\n            }\\n            if (opts.field) {\\n                removeEvent(opts.field, 'change', this._onInputChange);\\n                if (opts.bound) {\\n                    removeEvent(opts.trigger, 'click', this._onInputClick);\\n                    removeEvent(opts.trigger, 'focus', this._onInputFocus);\\n                    removeEvent(opts.trigger, 'blur', this._onInputBlur);\\n                }\\n            }\\n            if (this.el.parentNode) {\\n                this.el.parentNode.removeChild(this.el);\\n            }\\n        }\\n\\n    };\\n\\n    return Pikaday;\\n}));\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/kookma/pikaday/license\":{\"title\":\"$:/plugins/kookma/pikaday/license\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"Distributed under an MIT license.\\n\\nCopyright (c) 2022 [[Mohammad Rahmani|https://github.com/kookma]]\\n\\n\\nMIT License Copyright (c) 2020-2021 [[Nicolas Petton|https://nicolas.petton.fr]] nicolas@petton.fr\\n\\n\\n<<<\\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \\\"Software\\\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\\n\\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\\n\\nTHE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\\n<<<\"},\"$:/plugins/kookma/pikaday/macros/filters\":{\"title\":\"$:/plugins/kookma/pikaday/macros/filters\",\"tags\":\"$:/tags/Macro\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\whitespace trim\\n\\n\\\\define py-is-overdue()\\n[all[current]!tag[Done]!tag[done]!has[draft.of]!days:due[-1]]\\n\\\\end\\n\\n\\\\define py-is-not-overdue()\\n[all[current]!has[draft.of]] -[!days:due[-1]]\\n\\\\end\\n\\n\\\\define py-is-due-yesterday()\\n[all[current]!has[draft.of]days:due[-1]]\\n\\\\end\\n\\n\\\\define py-is-due-today()\\n[all[current]!has[draft.of]days:due[0]]\\n\\\\end\\n\\n\\\\define py-is-due-later()\\n[all[current]!has[draft.of]!days:due[1]]\\n\\\\end\\n\\n\\\\define py-is-due-tomorrow()\\n[all[current]!has[draft.of]days:due[1]]\\n\\\\end\\n\\n\\\\define py-is-not-scheduled()\\n[all[current]!has[draft.of]!has[due]]\\n\\\\end\\n\\n\\\\define py-is-scheduled()\\n[all[current]!has[draft.of]has[due]]\\n\\\\end\\n\\n<!--\\nThe rason to use both tags: done and Done is to support both of them.\\n--> \\n\"},\"$:/plugins/kookma/pikaday/readme\":{\"title\":\"$:/plugins/kookma/pikaday/readme\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"; Pikaday\\nA date-picker with calendar widget to pick a date and set to `due` field of target tiddler. This is a derived plugin from Projectify by [[Nicolas Petton|https://nicolas.petton.fr]] nicolas@petton.fr\\n\\n;Code and demo\\nFor learning plugin features, syntax, tutorial and examples see the plugin demo and code pages\\n\\n* Demo: https://kookma.github.io/TW-Pikaday/\\n* Code: https://github.com/kookma/TW-Pikaday\\n\"},\"$:/plugins/kookma/pikaday/styles/date-picker\":{\"title\":\"$:/plugins/kookma/pikaday/styles/date-picker\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\\n\\n.py-date-picker .py-date-today {\\n  color: <<colour primary>>;\\n}\\n\\n.py-date-picker .py-date-today svg {\\n  fill: <<colour primary>>;\\n}\\n\\n.py-date-picker .py-date-clear {\\n  color: #e73939;\\n}\\n\\n.py-date-picker .py-date-clear svg {\\n  fill: #e73939;\\n}\\n\\n.py-date-picker .pika-single {\\n  margin: 0;\\n  border: 0;\\n  padding: 6px;\\n  color: <<colour foreground>>;\\n  background: transparent;\\n}\\n\\n.py-date-picker .pika-lendar {\\n  margin: 0;\\n  border: 0;\\n  width: 100%;\\n}\\n\\n.py-date-picker .pika-lendar .pika-table {\\n  margin: 0;\\n}\\n\\n.py-date-picker .pika-lendar .pika-table th {\\n  background: transparent;\\n  font-weight: bold;\\n  color: <<colour muted-foreground>>;\\n}\\n\\n.py-date-picker .pika-lendar button,\\n.py-date-picker .pika-button {\\n  border-radius: 0;\\n  background-color: transparent;\\n  text-align: center;\\n}\\n\\n.py-date-picker .pika-button {\\n  padding: 6px 8px !important;\\n}\\n\\n.py-date-picker .pika-prev,\\n.py-date-picker .pika-next {\\n  padding: 4px;\\n  width: 20px;\\n}\\n\\n.py-date-picker .pika-lendar button:hover,\\n.py-date-picker .pika-lendar button:active,\\n.py-date-picker .pika-next {\\n  background-color: <<colour primary>>;\\n  color: <<colour background>>;\\n  border-radius: 3px;\\n}\\n\\n.py-date-picker .pika-lendar .is-selected .pika-button,\\n.py-date-picker .pika-lendar .has-event .pika-button {\\n  background: <<colour muted-foreground>>;\\n  color: <<colour tiddler-background>>;\\n  box-shadow: none;\\n  border-radius: 3px;\\n}\\n\\n.py-date-picker .pika-label {\\n  background-color: transparent;\\n  color: <<colour foreground>>;\\n}\\n\\n.py-date-picker .pika-lendar table th,\\n.py-date-picker .pika-lendar table td {\\n  border: 0 none;\\n}\\n\"},\"$:/plugins/kookma/pikaday/styles/form-control\":{\"title\":\"$:/plugins/kookma/pikaday/styles/form-control\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\\n\\n.py-btn {\\n  border-radius: 1.5em;\\n  border: 1px solid #ccc;\\n  background: <<colour tiddler-background>>;\\n  padding: .3em 1em;\\n  cursor: pointer;\\n  transition: box-shadow ease-in .1s;\\n}\\n\\n.py-btn:focus {\\n  outline: 0 none;\\n}\\n\\n.py-btn:active {\\n  box-shadow: 0 0 0 0.2rem rgba(0,0,0,.08);\\n}\\n\\n.py-btn.btn-small {\\n  font-size: .9em;\\n  padding: .2em .8em;\\n}\\n\\n\"},\"$:/plugins/kookma/pikaday/styles/settings\":{\"title\":\"$:/plugins/kookma/pikaday/styles/settings\",\"text\":\"/* used in ui settings tab */\\nlabel.kk-pk-label {\\n\\tdisplay:inline-block;\\n\\twidth: 120px;\\n\\tmargin-bottom:0.4em;\\n}\\n.kk-pk-input {\\n\\twidth:180px;\\n}\\n\\n\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/css\"},\"$:/plugins/kookma/pikaday/styles/stylesheet\":{\"title\":\"$:/plugins/kookma/pikaday/styles/stylesheet\",\"tags\":\"$:/tags/Stylesheet\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\n.tc-drop-down.py-drop-down {\\n  min-width: 200px;\\n}\\n\\n.tc-drop-down.py-drop-down .tc-btn-invisible {\\n  font-size: 14px;\\n  line-height: 2em;\\n}\\n\\n.tc-drop-down.py-drop-down .tc-btn-invisible svg {\\n    margin-right: 6px;\\n}\\n\\n.tc-drop-down.py-drop-down hr {\\n  margin: 2px 0;\\n  padding: 0;\\n  border: 0;\\n  border-bottom: 1px solid <<colour muted-foreground>>;\\n}\\n\\n\\n\\n.py-due-date.py-overdue {\\n  color: <<colour background>>;\\n  background: #e73939;\\n  border-color: #e73939;\\n  font-weight: bold;\\n}\\n\\n\"},\"$:/plugins/kookma/pikaday/ui/buttons/TodoDueDate\":{\"title\":\"$:/plugins/kookma/pikaday/ui/buttons/TodoDueDate\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\define lingo-base() $:/language/projectify/\\n\\n<$vars popupTiddler=<<qualify \\\"$:/state/projectify/due-date-dropdown\\\">>>\\n  <$list filter=<<py-is-overdue>>>\\n    <$button class=\\\"py-btn py-due-date py-overdue\\\" popup=<<popupTiddler>>>\\n      <$list\\n        filter=<<py-is-due-yesterday>>\\n        emptyMessage=\\\"\\\"\\\"<$view field=\\\"due\\\" format=\\\"relativedate\\\"/>\\\"\\\"\\\"\\n      >\\n\\t<<lingo Yesterday>>\\n      </$list>\\n    </$button>\\n  </$list>\\n  <$list filter=<<py-is-not-overdue>>>\\n    <$list filter=<<py-is-due-today>>>\\n      <$button class=\\\"py-btn py-due-date py-due-today\\\" popup=<<popupTiddler>>>\\n      {{$:/plugins/kookma/pikaday/images/calendar}} <<lingo Today>>\\n    </$button>\\n    </$list>\\n    <$list filter=<<py-is-due-later>>>\\n      <$button class=\\\"py-btn py-due-date\\\" popup=<<popupTiddler>>>\\n\\t{{$:/plugins/kookma/pikaday/images/calendar}}\\n\\t<$list\\n\\t  filter=<<py-is-due-tomorrow>>\\n\\t  emptyMessage=\\\"\\\"\\\"<$view field=\\\"due\\\" format=\\\"date\\\" template={{$:/language/projectify/DateFormat}}/>\\\"\\\"\\\"\\n\\t>\\n\\t  <<lingo Tomorrow>>\\n\\t</$list>\\n      </$button>\\n    </$list>\\n    <$list filter=<<py-is-not-scheduled>>>\\n      <$button class=\\\"py-btn py-due-date py-not-scheduled\\\" popup=<<popupTiddler>>>\\n\\t{{$:/plugins/kookma/pikaday/images/calendar}}\\n\\t<<lingo Schedule/Caption>>\\n      </$button>\\n    </$list>\\n  </$list>\\n\\n  <$reveal state=<<popupTiddler>> type=\\\"popup\\\" position=\\\"belowleft\\\" animate=\\\"no\\\">\\n    <div class=\\\"tc-drop-down py-drop-down py-date-picker\\\">\\n      {{||$:/plugins/kookma/pikaday/ui/forms/TodoDueDate}}\\n    </div>\\n  </$reveal>\\n</$vars>\\n\"},\"$:/plugins/kookma/pikaday/ui/config/Calendar\":{\"title\":\"$:/plugins/kookma/pikaday/ui/config/Calendar\",\"caption\":\"{{$:/language/projectify/Calendar}}\",\"list-before\":\"$:/plugins/nico/projectify/ui/config/Dashboard\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\define lingo-base() $:/language/projectify/\\n\\n\\\\define select-first-day-of-week()\\n<$select tiddler=\\\"$:/config/projectify/FirstDayOfWeek\\\" default=\\\"1\\\">\\n  <option value=\\\"6\\\">{{$:/language/Date/Long/Day/6}}</option>\\n  <option value=\\\"0\\\">{{$:/language/Date/Long/Day/0}}</option>\\n  <option value=\\\"1\\\">{{$:/language/Date/Long/Day/1}}</option>\\n</$select>\\n\\\\end\\n\\n<label class=\\\"kk-pk-label\\\"><<lingo FirstDayOfWeek>></label><<select-first-day-of-week>>\\n\"},\"$:/plugins/kookma/pikaday/ui/ControlPanel/Settings\":{\"title\":\"$:/plugins/kookma/pikaday/ui/ControlPanel/Settings\",\"caption\":\"Pikaday\",\"tags\":\"$:/tags/ControlPanel/SettingsTab $:/tags/MoreSideBar\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"These settings let you customise the behaviour of Pikaday plugin.\\n\\n---\\n\\n;Show Pikaday setting in more sidebar\\n:<$checkbox tiddler=\\\"$:/plugins/kookma/pikaday/ui/ControlPanel/Settings\\\" tag=\\\"$:/tags/MoreSideBar\\\"> Show setting in more sidebar</$checkbox>\\n\\n;Options\\n:{{$:/plugins/kookma/pikaday/ui/config/Calendar}}\\n: <label class=\\\"kk-pk-label\\\">Date format</label><$edit-text tiddler=\\\"$:/language/projectify/DateFormat\\\" tag=input default=\\\"\\\" placeholder=\\\"date format e.g. DDth mmm\\\" class=\\\"kk-pk-input\\\"/>\\n\\n:<small>Hint: See [[DateFormat|https://tiddlywiki.com/#DateFormat]] for representation of dates.</small>\"},\"$:/plugins/kookma/pikaday/ui/forms/TodoDueDate\":{\"title\":\"$:/plugins/kookma/pikaday/ui/forms/TodoDueDate\",\"tags\":\"\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\define lingo-base() $:/language/projectify/\\n\\n<$py-date-today>{{$:/plugins/kookma/pikaday/images/sun}} <<lingo Today>></$py-date-today>\\n<$py-date-tomorrow>{{$:/plugins/kookma/pikaday/images/calendar-event}} <<lingo Tomorrow>></$py-date-tomorrow>\\n<$py-date-next-week>{{$:/plugins/kookma/pikaday/images/calendar}} <<lingo NextWeek>></$py-date-next-week>\\n<$py-date-clear>{{$:/plugins/kookma/pikaday/images/slash-circle}} <<lingo Clear>></$py-date-clear>\\n<hr/>\\n<$py-date-calendar/>\\n\"},\"$:/plugins/kookma/pikaday/ui/widgets/date-picker.js\":{\"title\":\"$:/plugins/kookma/pikaday/ui/widgets/date-picker.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/kookma/pikaday/ui/widgets/date-picker.js\\ntype: application/javascript\\nmodule-type: widget\\n\\npy-date-picker widget factory.\\n\\nThis widget is intended to be used within a drop-down (with the tc-drop-down CSS\\nclass). See $:/plugins/kookma/pikaday/ui/buttons/TodoDueDate for usages.\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\nvar Pikaday = require(\\\"$:/plugins/kookma/pikaday/lib/pikaday.js\\\");\\n\\nfunction getToday () {\\n\\treturn new Date();\\n};\\n\\nfunction getTomorrow () {\\n\\tlet today = getToday();\\n\\tlet tomorrow = new Date(today);\\n\\ttomorrow.setDate(today.getDate() + 1);\\n\\treturn tomorrow;\\n};\\n\\nfunction getNextMonday () {\\n\\tlet tomorrow = getTomorrow();\\n\\tlet monday = new Date(tomorrow);\\n\\tmonday.setDate(monday.getDate() + (1 + 6 - tomorrow.getDay()) % 7);\\n\\treturn monday;\\n};\\n\\nvar AbstractDatePickerWidget = function() {};\\nAbstractDatePickerWidget.prototype = new Widget();\\n\\n\\n/*\\nCompute the internal state of the widget\\n*/\\nAbstractDatePickerWidget.prototype.execute = function () {\\n\\tthis.title = this.getAttribute(\\\"tiddler\\\", this.getVariable(\\\"currentTiddler\\\"));\\n\\tthis.field = this.getAttribute(\\\"field\\\", \\\"due\\\");\\n\\tthis.makeChildWidgets();\\n};\\n\\n/*\\nSelectively refreshes the widget if needed. Returns true if the widget or any of\\nits children needed re-rendering\\n*/\\nAbstractDatePickerWidget.prototype.refresh = function(changedTiddlers) {\\n\\tlet changedAttributes = this.computeAttributes();\\n\\n\\tif(changedAttributes.tiddler || changedAttributes.field) {\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t} else {\\n\\t\\treturn false;\\n\\t}\\n};\\n\\nAbstractDatePickerWidget.prototype.getTiddler = function() {\\n\\tvar tiddler = this.wiki.getTiddler(this.title);\\n\\tif(!tiddler) {\\n\\t\\tthis.wiki.addTiddler({title: this.title});\\n\\t\\ttiddler = this.wiki.getTiddler(this.title);\\n\\t}\\n\\n\\treturn tiddler;\\n};\\n\\nAbstractDatePickerWidget.prototype.getValue = function() {\\n\\treturn $tw.utils.parseDate(this.getTiddler().getFieldString(this.field));\\n};\\n\\nAbstractDatePickerWidget.prototype.setValue = function (date) {\\n\\tlet updateFields = {\\n\\t\\ttitle: this.title,\\n\\t\\t[this.field]: date ? this.formatDate(date) : undefined\\n\\t};\\n\\n\\tthis.wiki.addTiddler(\\n\\t\\tnew $tw.Tiddler(\\n\\t\\t\\tthis.wiki.getCreationFields(),\\n\\t\\t\\tthis.getTiddler(),\\n\\t\\t\\tupdateFields,\\n\\t\\t\\tthis.wiki.getModificationFields()\\n\\t\\t)\\n\\t);\\n\\n\\t$tw.rootWidget.dispatchEvent({type: \\\"tm-auto-save-wiki\\\"});\\n};\\n\\nAbstractDatePickerWidget.prototype.formatDate = function(date) {\\n\\t// TW format is YYYYMMDDHHmmssSSS\\n\\treturn `${date.getFullYear()}${this.formatMonth(date)}${this.formatDay(date)}120000000`;\\n};\\n\\nAbstractDatePickerWidget.prototype.formatMonth = function(date) {\\n\\tlet month = `${date.getMonth() + 1}`;\\n\\tif (month.length === 1) {\\n\\t\\tmonth = `0${month}`;\\n\\t}\\n\\n\\treturn month;\\n};\\n\\nAbstractDatePickerWidget.prototype.formatDay = function(date) {\\n\\tlet day = `${date.getDate()}`;\\n\\tif (day.length === 1) {\\n\\t\\tday = `0${day}`;\\n\\t}\\n\\n\\treturn day;\\n};\\n\\nvar factory = function(getDate, cssClass) {\\n\\tvar PickerWidget = function(parseTreeNode,options) {\\n\\t\\tthis.initialise(parseTreeNode,options);\\n\\t};\\n\\n\\tPickerWidget.prototype = new AbstractDatePickerWidget();\\n\\n\\tPickerWidget.prototype.render = function(parent,nextSibling) {\\n\\t\\tthis.parentDomNode = parent;\\n\\t\\tthis.computeAttributes();\\n\\t\\tthis.execute();\\n\\n\\t\\tthis.domNode = this.createDomNode();\\n\\n\\t\\tparent.insertBefore(this.domNode, nextSibling);\\n\\t\\tthis.renderChildren(this.domNode, null);\\n\\t\\tthis.domNodes.push(this.domNode);\\n\\t};\\n\\n\\tPickerWidget.prototype.createDomNode = function() {\\n\\t\\tlet btn = document.createElement(\\\"button\\\");\\n\\t\\tbtn.classList.add(\\\"tc-btn-invisible\\\", cssClass);\\n\\t\\tbtn.addEventListener(\\\"click\\\", () => {\\n\\t\\t\\tthis.setValue(getDate());\\n\\t\\t});\\n\\n\\t\\treturn btn;\\n\\t};\\n\\n\\treturn PickerWidget;\\n};\\n\\nvar CalendarWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\nCalendarWidget.prototype = new AbstractDatePickerWidget();\\n\\nCalendarWidget.prototype.render = function(parent,nextSibling) {\\n\\tthis.parentDomNode = parent;\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\n\\tthis.domNode = this.renderCalendar();\\n\\n\\tparent.insertBefore(this.domNode, nextSibling);\\n\\tthis.renderChildren(this.domNode, null);\\n\\tthis.domNodes.push(this.domNode);\\n};\\n\\nCalendarWidget.prototype.renderCalendar = function() {\\n\\tlet calendar = new Pikaday({\\n\\t\\tfirstDay: parseInt(this.wiki.getTiddlerText(\\\"$:/config/projectify/FirstDayOfWeek\\\")),\\n\\t\\tkeyboardInput: false,\\n\\t\\ti18n: this.getLabels(),\\n\\t\\tonSelect: () => {\\n\\t\\t\\tthis.setValue(calendar.getDate());\\n\\t\\t\\t// Close the popup\\n\\t\\t\\t$tw.popup.cancel(0);\\n\\t\\t},\\n\\t\\tonDraw: fixPopupClosing\\n\\t});\\n\\n\\tcalendar.setDate(this.getValue(), true);\\n\\n\\t// Prevent the month and year pickers click events from closing the TW\\n\\t// popup. This function is called on each redraw (when a new month is\\n\\t// selected).\\n\\tfunction fixPopupClosing() {\\n\\t\\tsetTimeout(() => {\\n\\t\\t\\tcalendar.el.querySelectorAll(\\\".pika-label\\\").forEach((elt) => {\\n\\t\\t\\t\\telt.classList.add(\\\"tc-popup-handle\\\");\\n\\t\\t\\t});\\n\\t\\t}, 0);\\n\\t}\\n\\n\\treturn calendar.el;\\n};\\n\\nCalendarWidget.prototype.getLabels = function() {\\n\\treturn {\\n        previousMonth : \\\"Previous Month\\\",\\n        nextMonth     : \\\"Next Month\\\",\\n        months        : this.getMonthLabels(),\\n        monthsShort   : this.getShortMonthLabels(),\\n        weekdays      : this.getDayLabels(),\\n        weekdaysShort : this.getShortDayLabels(),\\n    };\\n};\\n\\nCalendarWidget.prototype.getMonthLabels = function() {\\n\\treturn this._mapRange(12, i => this._getDateLabel(`Long/Month/${i+1}`));\\n};\\n\\nCalendarWidget.prototype.getShortMonthLabels = function() {\\n\\treturn this._mapRange(12, i => this._getDateLabel(`Short/Month/${i+1}`));\\n};\\n\\nCalendarWidget.prototype.getDayLabels = function() {\\n\\treturn this._mapRange(7, i => this._getDateLabel(`Long/Day/${i}`));\\n};\\n\\nCalendarWidget.prototype.getShortDayLabels = function() {\\n\\treturn this._mapRange(7, i => this._getDateLabel(`Short/Day/${i}`));\\n};\\n\\nCalendarWidget.prototype._mapRange = function(n, f) {\\n\\treturn Array.from(new Array(n)).map((_, i) => f(i));\\n};\\n\\nCalendarWidget.prototype._getDateLabel = function(title) {\\n\\treturn this.wiki.getTextReference(`$:/language/Date/${title}`);\\n};\\n\\nexports[\\\"py-date-today\\\"] = factory(getToday, \\\"py-date-today\\\");\\nexports[\\\"py-date-tomorrow\\\"] = factory(getTomorrow, \\\"py-date-tomorrow\\\");\\nexports[\\\"py-date-next-week\\\"] = factory(getNextMonday, \\\"py-date-next-week\\\");\\nexports[\\\"py-date-clear\\\"] = factory(function() {return undefined;}, \\\"py-date-clear\\\");\\nexports[\\\"py-date-calendar\\\"] = CalendarWidget;\\n\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}