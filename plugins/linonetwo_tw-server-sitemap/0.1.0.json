{"author":"LinOnetwo","core-version":">=5.1.22","dependents":"","description":"Description of this plugin","list":"readme config tree","plugin-type":"plugin","stability":"STABILITY_2_STABLE","text":"{\"tiddlers\":{\"$:/plugins/linonetwo/tw-server-sitemap/config\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/config\",\"tags\":\"$:/tags/ControlPanel/SettingsTab\",\"caption\":\"Sitemap\",\"text\":\"Config of tw-server-sitemap plugin.\\n\\n---\\n\\n!! Sitemap Config\\n\\n;Your Website base URL: (for example, `https://tidgi.fun/` or `https://wiki.onetwo.ren`)\\n:<$edit-text tiddler=\\\"$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL\\\" tabindex=-1 focus=false cancelPopups=\\\"yes\\\" fileDrop=no tag=\\\"input\\\" />\\n;Use hash version of URL in the sitemap\\n:<$checkbox tiddler=\\\"$:/plugins/linonetwo/tw-server-sitemap/configs/UseHashVersion\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"\\\"> URL with `/#:` will result in loading dynamic version of your wiki, which have full features, but is larger than the static version. </$checkbox>\"},\"$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL\",\"text\":\"https://tidgi.fun/\"},\"$:/plugins/linonetwo/tw-server-sitemap/configs/UseHashVersion\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/configs/UseHashVersion\",\"text\":\"no\"},\"$:/plugins/linonetwo/tw-server-sitemap/readme\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/readme\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\function full-sitemap-link()\\n[{$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL}addsuffix[sitemap.xml]]\\n\\\\end\\n\\\\function full-robots-link()\\n[{$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL}addsuffix[robots.txt]]\\n\\\\end\\n\\n!! Read Me\\n\\nGenerate Sitemap for your Nodejs based server.\\n\\nUse this with your NodeJS based wiki server, or your [[blog served with TidGi|https://tidgi.fun/#TidGi%20Feature%20Handbook%2FBlogging%20With%20NAT%20Traversal]].\\n\\n!! Contents Links\\n\\nSitemap: <a href=<<full-sitemap-link>> target=\\\"_blank\\\"><$text text=<<full-sitemap-link>>/></a>\\n\\nRobots: <a href=<<full-robots-link>> target=\\\"_blank\\\"><$text text=<<full-robots-link>>/></a>\\n\\n> Based on {{$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL}}\\n>\\n> [[configs/WebsiteURL|$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL]] in [[$:/plugins/linonetwo/tw-server-sitemap/config]]\"},\"robots.txt\":{\"title\":\"robots.txt\",\"_render_template\":\"$:/plugins/linonetwo/tw-server-sitemap/template/txt\",\"_render_type\":\"text/plain\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"User-agent: *\\n\\nAllow: /\\n\\nSitemap: {{sitemapserver}}sitemap.xml\"},\"sitemap.xml\":{\"title\":\"sitemap.xml\",\"_render_template\":\"$:/plugins/linonetwo/tw-server-sitemap/template/xml\",\"_render_type\":\"application/xml\",\"code-body\":\"yes\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"\\\\define tv-wikilink-template() #$uri_encoded$\\n\\\\define tv-config-toolbar-icons() no\\n\\\\define tv-config-toolbar-text() no\\n\\\\define tv-config-toolbar-class() tc-btn-invisible\\n\\n`<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n<urlset xmlns=\\\"http://www.sitemaps.org/schemas/sitemap/0.9\\\">`\\n<$transclude $variable=\\\"sitemapentries\\\" filter=\\\"[!is[system]!sort[modifed]]\\\" $output=\\\"text/raw\\\" $mode=\\\"block\\\" />\\n`</urlset>`\"},\"$:/plugins/linonetwo/tw-server-sitemap/template/txt\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/template/txt\",\"code-body\":\"yes\",\"text\":\"\\\\define tv-config-static() yes\\n\\n<$transclude mode=\\\"block\\\" $output=\\\"text/html\\\"/>\"},\"$:/plugins/linonetwo/tw-server-sitemap/template/xml\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/template/xml\",\"code-body\":\"yes\",\"text\":\"\\\\whitespace trim\\n\\\\define tv-config-static() yes\\n\\\\define tv-wikilink-template() $uri_encoded$\\n\\\\import [subfilter{$:/core/config/GlobalImportFilter}]\\n\\n<$transclude mode=\\\"block\\\"/>\"},\"$:/plugins/linonetwo/tw-server-sitemap/tree\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/tree\",\"type\":\"text/vnd.tiddlywiki\",\"text\":\"<<tree prefix:\\\"$:/plugins/linonetwo/tw-server-sitemap/\\\">>\"},\"$:/plugins/linonetwo/tw-server-sitemap/sitemapentries.js\":{\"title\":\"$:/plugins/linonetwo/tw-server-sitemap/sitemapentries.js\",\"type\":\"application/javascript\",\"module-type\":\"macro\",\"Modern.TiddlyDev#Origin\":\"sitemapentries.ts\",\"text\":\"\\\"use strict\\\";exports.name=\\\"sitemapentries\\\",exports.params=[{name:\\\"filter\\\"}];var escapify=e=>e.replaceAll(/</gm,\\\"&lt;\\\").replaceAll(/>/gm,\\\"&gt;\\\").replaceAll(/&/gm,\\\"&amp;\\\").replaceAll(/\\\"/gm,\\\"&quot;\\\").replaceAll(/'/gm,\\\"&apos;\\\"),twDateToWebDate=e=>$tw.utils.formatDateString(e,\\\"YYYY-0MM-0DD\\\"),stringify=e=>{let t=\\\"\\\",i=$tw.wiki.getTiddlerText(\\\"$:/plugins/linonetwo/tw-server-sitemap/configs/WebsiteURL\\\",\\\"\\\");i.endsWith(\\\"/\\\")||(i+=\\\"/\\\");const r=\\\"yes\\\"===$tw.wiki.getTiddlerText(\\\"$:/plugins/linonetwo/tw-server-sitemap/configs/UseHashVersion\\\",\\\"no\\\");return e.forEach(e=>{t=(t+=\\\"\\\\t<url>\\\\n\\\")+`\\t\\t<loc>${i}${r?\\\"#:\\\":\\\"\\\"}${e.title.replaceAll(\\\" \\\",\\\"%2520\\\")}</loc>\\n`,e.modified&&(t+=\\\"\\\\t\\\\t<lastmod>\\\"+twDateToWebDate($tw.utils.parseDate(e.modified))+\\\"</lastmod>\\\\n\\\"),t+=\\\"\\\\t\\\\t<changefreq>\\\",\\\"index\\\"===e.title.toLowerCase()||\\\"home\\\"===e.title.toLowerCase()?t+=\\\"weekly\\\":t+=\\\"monthly\\\",t+=\\\"</changefreq>\\\\n\\\\t\\\\t<priority>\\\",\\\"index\\\"===e.title.toLowerCase()||\\\"home\\\"===e.title.toLowerCase()?t+=\\\"1.0\\\":void 0===e.color?t+=\\\"0.5\\\":t+=\\\"0.8\\\",t+=\\\"</priority>\\\\n\\\\t</url>\\\\n\\\"}),t};exports.run=function(e){var t=[];for(const l of $tw.wiki.filterTiddlers(e)){var i=$tw.wiki.getTiddler(l);if(i){var r={};for(const o in i.fields)r[o]=escapify(i.getFieldString(o));t.push(r)}}return stringify(t)};\"}}}","title":"$:/plugins/linonetwo/tw-server-sitemap","type":"application/json","version":"0.1.0","Modern.TiddlyDev#SHA256-Hashed":"c514eb3645a5d3eed1099bcf0d6ec05462004b256ed88b82294b12addeaa6551","name":"Sitemap for server"}