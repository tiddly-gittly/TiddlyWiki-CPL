{"title":"$:/plugins/oeyoews/vue-rss","description":"vue-rss","author":"oeyoews","version":"0.1.0","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"vue-rss","meat#disabled":"yes","qrcode":"yes","created":"2024-03-14","dependents":"$:/plugins/oeyoews/neotw-vue3","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/vue-rss/components/Header.js\":{\"text\":\"module.exports={name:\\\"Header\\\",props:{channel:{type:Object,required:!0}},template:'\\\\n  <h2> {{ channel.title }}</h2>\\\\n  <table>\\\\n        <tr>\\\\n          <td>\\\\n            Updated\\\\n          </td>\\\\n          <td>\\\\n            {{ channel.update }}\\\\n          </td>\\\\n        </tr>\\\\n        <tr v-show=\\\"channel.link\\\">\\\\n          <td>\\\\n            Link\\\\n          </td>\\\\n          <td>\\\\n            <a :href=\\\"channel.link\\\" target=\\\"_blank\\\">\\\\n              {{ channel.link }}\\\\n            </a>\\\\n          </td>\\\\n        </tr>\\\\n        <tr v-show=\\\"channel.description\\\">\\\\n          <td>\\\\n            Description\\\\n          </td>\\\\n          <td>\\\\n            {{ channel.description }}\\\\n          </td>\\\\n        </tr>\\\\n      </table>'};\",\"title\":\"$:/plugins/oeyoews/vue-rss/components/Header.js\",\"hide-body\":\"yes\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/vue-rss/components/Paginator.js\":{\"text\":\"module.exports={name:\\\"Paginator\\\",props:{pages:{type:Number,required:!0},currentPage:Number},methods:{changePage(e){e>=1&&e<=this.pages&&this.$emit(\\\"next\\\",e)}},template:'<div class=\\\"flex justify-center items-center gap-2\\\" v-if=\\\"pages > 1\\\">\\\\n        <button class=\\\"size-8\\\"\\\\n          @click=\\\"changePage(currentPage - 1)\\\" :disabled=\\\"currentPage === 1\\\"\\\\n          :class=\\\"{ \\\\'cursor-not-allowed\\\\': currentPage === 1 }\\\">\\\\n<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"1.78em\\\" height=\\\"1em\\\" viewBox=\\\"0 0 16 9\\\"><path fill=\\\"currentColor\\\" d=\\\"M12.5 5h-9c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h9c.28 0 .5.22.5.5s-.22.5-.5.5\\\"/><path fill=\\\"currentColor\\\" d=\\\"M6 8.5a.47.47 0 0 1-.35-.15l-3.5-3.5c-.2-.2-.2-.51 0-.71L5.65.65c.2-.2.51-.2.71 0c.2.2.2.51 0 .71L3.21 4.51l3.15 3.15c.2.2.2.51 0 .71c-.1.1-.23.15-.35.15Z\\\"/></svg>\\\\n          </button>\\\\n        <div>\\\\n          {{ currentPage }} / {{ pages}}\\\\n        </div>\\\\n        <button class=\\\"size-8\\\"\\\\n          @click=\\\"changePage(currentPage + 1)\\\" :disabled=\\\"currentPage >= pages\\\"\\\\n          :class=\\\"{ \\\\'cursor-not-allowed\\\\': currentPage >= pages }\\\">\\\\n<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"1.78em\\\" height=\\\"1em\\\" viewBox=\\\"0 0 16 9\\\"><path fill=\\\"currentColor\\\" d=\\\"M12.5 5h-9c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h9c.28 0 .5.22.5.5s-.22.5-.5.5\\\"/><path fill=\\\"currentColor\\\" d=\\\"M10 8.5a.47.47 0 0 1-.35-.15c-.2-.2-.2-.51 0-.71l3.15-3.15l-3.15-3.15c-.2-.2-.2-.51 0-.71c.2-.2.51-.2.71 0l3.5 3.5c.2.2.2.51 0 .71l-3.5 3.5c-.1.1-.23.15-.35.15Z\\\"/></svg>\\\\n          </button>\\\\n      </div>'};\",\"title\":\"$:/plugins/oeyoews/vue-rss/components/Paginator.js\",\"hide-body\":\"yes\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/vue-rss/templates/app.vue\":{\"text\":\"<template>\\n\\n  <div class=\\\"bg-rose-500\\\" v-if=\\\"isSafari\\\">Rss plugin not supported your browser.</div>\\n\\n  <div class=\\\"bg-rose-600\\\" v-if=\\\"!loading && error.length > 0\\\">[{{ rss }}]: {{error}}</div>\\n  <div v-if=\\\"loading\\\"> loading ...</div>\\n  <template v-else>\\n    <!-- Header -->\\n    <div :class=\\\"card\\\" v-if=\\\"error.length === 0\\\">\\n      <Header :channel=\\\"channel\\\" />\\n    </div>\\n\\n    <!-- list -->\\n    <div v-for=\\\"(item, index) in paginatedItems\\\" :key=\\\"item\\\" class=\\\"group\\\" :class=\\\"card\\\">\\n\\n      <!-- title -->\\n      <h2 class=\\\"mb-2 text-base\\\"> {{ order + index }}. {{item.title}}</h2>\\n\\n      <!-- info -->\\n      <div class=\\\"flex items-center gap-2 text-sm text-gray-400 mb-2\\\">\\n        <img\\n          onerror=\\\"this.onerror=null;this.src=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' viewBox='0 0 24 24'%3E%3Cpath fill='%23c5c9c9' d='m12 0l10.23 6v12L12 24L1.77 18V6zm3.961 17.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79 1.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036 1.054-.658 1.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597 1.105-.842 2.321a5.351 5.351 0 0 0-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985 2.138.764 3.514 2.752 3.52c.625-.048.324-.007.904-.118l-.015.082a1.87 1.87 0 0 0 .865 1.718c-.27.771-.805 1.389-1.173 2.097c.138.881 1.031 2.057 1.4 2.225c.326.147 1.036.149 1.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736 1.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123 1.535.22 2.31.222c.336-.017.67-.03 1.001-.093c.106.27.402 1.025.404 1.239c.007.601-.219 1.205-.121 1.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572 1.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z'/%3E%3C/svg%3E`;\\\"\\n          crossorigin=\\\"anonymous\\\" :src=\\\"item.src\\\" alt=\\\"\\\" class=\\\"size-8 object-cover rounded-full\\\"\\n          referrerpolicy=\\\"no-referrer\\\">\\n        <a :href=\\\"item.link\\\" v-if=\\\"item.link\\\" target=\\\"_blank\\\" rel=\\\"noreferer noopener\\\">\\n          Link\\n        </a>\\n        <div v-if=\\\"item.update\\\">{{item.update}}</div>\\n        <button @click=\\\"open(item)\\\" class=\\\"transition-all opacity-0 group-hover:opacity-100\\\">Open</button>\\n      </div>\\n    </div>\\n\\n    <Paginator :currentPage=\\\"currentPage\\\" :pages=\\\"pages\\\" @next=\\\"changePage\\\" />\\n  </template>\\n</template>\",\"title\":\"$:/plugins/oeyoews/vue-rss/templates/app.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/vue-rss/readme\":{\"title\":\"$:/plugins/oeyoews/vue-rss/readme\",\"description\":\"vue-rss\",\"text\":\"!! Usage\\n\\n```\\n<$vue-rss rss=\\\"https://talk.tiddlywiki.org/latest.rss\\\" />\\n```\\n\\n!! Example\\n\\n<$vue-rss rss=\\\"https://www.ajplus.net/stories?format=rss\\\" />\\n\\n<$vue-rss />\\n\\n<$vue-rss rss=\\\"https://tiddlywiki.substack.com/feed\\\"/>\\n\\n<$vue-rss rss=\\\"https://talk.tiddlywiki.org/latest.rss\\\" />\\n\\n<hr />\\n\\n!! Tips\\n\\n* more rss address please check https://docs.rsshub.app/\\n* rsshub radar chrome extension can help you find some website rss address\\n\\n!! NOTE\\n\\n* This plugin uses https://corsproxy.io/ for proxy forwarding, which require a special network environment for some countries\\n* proxy has cdn cache\\n\\n!! Roadmap\\n\\n* support IOS: proxy forwarding not supported by IOS now\\n* support save single article convert to tiddler\\n\\n<!-- plugin template readme -->\\n\\n!! Motivation\\n\\n* rss to html, to md\\n* https://talk.tiddlywiki.org/t/fun-with-feeds-a-proof-of-concept-rss-reader/6490/\\n\\n\\n<!-- your plugin motivation, or why you write this plugin -->\\n\"},\"$:/plugins/oeyoews/vue-rss/app.js\":{\"title\":\"$:/plugins/oeyoews/vue-rss/app.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-rss/app.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nconst{toRaw:e,ref:t,watchEffect:n}=window.Vue,r=require(\\\"$:/plugins/oeyoews/neotw-vue3/getTemplate.js\\\"),s=require(\\\"./components/Header\\\"),o=require(\\\"./components/Paginator\\\");function i(e){var t=new Date(e),n=new Date,r=Math.abs(n-t)/1e3,s={\\\"年\\\":31536e3,\\\"月\\\":2592e3,\\\"周\\\":604800,\\\"天\\\":86400,\\\"小时\\\":3600,\\\"分钟\\\":60,\\\"秒\\\":1},o=\\\"\\\";for(var i in s){var a=Math.floor(r/s[i]);if(a>0){o+=a+\\\" \\\"+i+\\\"前\\\";break}}return o}const a=\\\"Safari\\\"===(()=>{const e=navigator.userAgent;let t=\\\"Unknown\\\";return/Chrome/.test(e)?t=\\\"Chrome\\\":/Firefox/.test(e)?t=\\\"Firefox\\\":/Safari/.test(e)?t=\\\"Safari\\\":/Edge/.test(e)?t=\\\"Edge\\\":/MSIE|Trident/.test(e)&&(t=\\\"Internet Explorer\\\"),t})();module.exports=(c=\\\"https://talk.tiddlywiki.org/posts.rss\\\",l=\\\"https://corsproxy.io/?\\\")=>({setup(){const e=t([]),r=t(!0),s=t(1),o=t([]),i=t(0),d=t(0),m=t(\\\"p-2 rounded border-solid border my-4 flex flex-col justify-between text-base dark:bg-dimmed-800 hover:shadow-sm bg-transparent border-dimmed-200 dark:border-dimmed-700 hover:outline outline-dimmed-200 hover:outline-1 dark:outline-dimmed-700\\\"),g=\\\"data:image/svg+xml,\\\"+encodeURIComponent('<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"1em\\\" height=\\\"1em\\\" viewBox=\\\"0 0 24 24\\\"><path fill=\\\"currentColor\\\" d=\\\"m12 0l10.23 6v12L12 24L1.77 18V6zm3.961 17.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79 1.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036 1.054-.658 1.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597 1.105-.842 2.321a5.351 5.351 0 0 0-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985 2.138.764 3.514 2.752 3.52c.625-.048.324-.007.904-.118l-.015.082a1.87 1.87 0 0 0 .865 1.718c-.27.771-.805 1.389-1.173 2.097c.138.881 1.031 2.057 1.4 2.225c.326.147 1.036.149 1.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736 1.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123 1.535.22 2.31.222c.336-.017.67-.03 1.001-.093c.106.27.402 1.025.404 1.239c.007.601-.219 1.205-.121 1.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572 1.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z\\\"/></svg>'),h=t({title:\\\"\\\",link:\\\"\\\",description:\\\"\\\",update:\\\"\\\"});n((()=>{d.value=10*(s.value-1)+1;const t=10*(s.value-1),n=t+10,r=e.value.slice(t,n);r.length>0&&(o.value=r)}));const p=t(\\\"\\\");return{card:m,icon:g,proxy:l,rss:c,error:p,order:d,rssItems:e,loading:r,channel:h,isSafari:a,currentPage:s,pages:i,itemsPerPage:10,paginatedItems:o}},mounted(){a?this.loading=!1:this.fetchRSS()},methods:{open(e){const t=e.title;$tw.wiki.addTiddler({title:\\\"$:/temp/oeyoews/rss/content\\\",caption:t,link:e.link,text:e.summary}),$tw.modal.display(\\\"$:/plugins/oeyoews/vue-rss/modal\\\")},getContent(e,t){const n=e?.getElementsByTagName(t)[0]?.textContent;return n||\\\"\\\"},getImg(e){try{let t=this.getContent(e,\\\"content\\\");t||(t=this.getContent(e,\\\"description\\\"));const n=(new DOMParser).parseFromString(t,\\\"text/html\\\");let r=n.getElementsByTagName(\\\"img\\\")[0]?.src;return r||(r=this.icon),r}catch(e){return this.icon}},async fetchRSS(){let t=c;this.proxy&&(t=this.proxy+c);try{const r=this.getContent,s=new DOMParser,o=await fetch(t);if(!o)return void console.error(\\\"fetch error for\\\"+t);const a=await o.text(),c=s.parseFromString(a,\\\"text/xml\\\");let l=c.getElementsByTagName(\\\"item\\\");if(!l)return;l.length||(l=c.getElementsByTagName(\\\"entry\\\"));let d=c.getElementsByTagName(\\\"channel\\\")[0];d||(d=c),this.channel.title=r(d,\\\"title\\\"),this.channel.link=r(d,\\\"link\\\"),this.channel.description=r(d,\\\"description\\\");let m=r(d,\\\"lastBuildDate\\\");m||(m=r(d,\\\"pubDate\\\")),m||(m=r(d,\\\"updated\\\")),m&&(this.channel.update=i(m));for(var n=0;n<l.length;n++){const e=l[n],t=r(e,\\\"title\\\");let s=r(e,\\\"description\\\");const o=r(e,\\\"pubDate\\\"),a=r(e,\\\"link\\\"),c=this.getImg(e);let d=r(e,\\\"content\\\");d||(d=r(e,\\\"content:encoded\\\")),d&&(s+=d),this.rssItems.push({title:t,link:a,update:i(o),summary:s,src:c})}this.pages=Math.ceil(e(this.rssItems.length)/this.itemsPerPage),this.loading=!1}catch(e){this.error=e,this.loading=!1,console.error(e)}},changePage(e){\\\"number\\\"==typeof e&&(e<1||e>this.pages?console.warn(\\\"page out of range\\\"):this.currentPage=e)}},components:{Header:s,Paginator:o},template:r(\\\"$:/plugins/oeyoews/vue-rss/templates/app.vue\\\")});\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/vue-rss/modal\":{\"title\":\"$:/plugins/oeyoews/vue-rss/modal\",\"class\":\"o-tm\",\"mask-closable\":\"yes\",\"subtitle\":\"{{$:/plugins/oeyoews/vue-rss/save}}\",\"text\":\"<div class=\\\"antialiased prose prose-gray max-w-none prose-img:my-0 prose-a:no-underline prose-h2:mt-4 prose-blockquote:not-italic dark:prose-invert dark:prose-pre:bg-[#282c34] dark:prose-pre:text-white prose-p:mt-0\\\">\\n<$transclude tiddler=\\\"$:/temp/oeyoews/rss/content\\\"/>\\n</div>\\n\"},\"$:/plugins/oeyoews/vue-rss/save-notify\":{\"title\":\"$:/plugins/oeyoews/vue-rss/save-notify\",\"text\":\"Saved\"},\"$:/plugins/oeyoews/vue-rss/save\":{\"title\":\"$:/plugins/oeyoews/vue-rss/save\",\"text\":\"<$let tiddler=\\\"$:/temp/oeyoews/rss/content\\\" >\\n<div class=\\\"flex justify-between\\\">\\n<$view tiddler=<<tiddler>> field=\\\"caption\\\" />\\n<div class=\\\"flex items-center\\\">\\n<$button class=\\\"bg-transparent\\\">\\n  <span class=\\\"hover:bg-gray-200 dark:hover:bg-gray-700 transition-all rounded px-2 py-1 text-xs\\\">Save</span>\\n<$action-setfield\\n\\t$tiddler={{{ [<tiddler>get[caption]] }}}\\n\\ttext={{{ [<tiddler>get[text]] }}}\\n\\tlink={{{ [<tiddler>get[link]] }}}\\n\\ttags=\\\"RssArticle\\\" />\\n<$action-sendmessage $message=\\\"tm-notify\\\" $param=\\\"$:/plugins/oeyoews/vue-rss/save-notify\\\"/>\\n</$button>\\n\\n<$button class=\\\"bg-transparent\\\">\\n  <span class=\\\"hover:bg-gray-200 dark:hover:bg-gray-700 transition-all rounded px-2 py-1 text-xs\\\">Esc</span>\\n<$action-sendmessage $message=\\\"tm-close-tiddler\\\" $param=<<currentTiddler>>/>\\n</$button>\\n</div>\\n</div>\\n</$let>\"},\"$:/plugins/oeyoews/vue-rss/styles\":{\"title\":\"$:/plugins/oeyoews/vue-rss/styles\",\"tags\":\"$:/tags/Stylesheet\",\"text\":\".rss-enter-active {\\n  transition: opacity 0.5s ease;\\n}\\n\\n.rss-enter-from,\\n.rss-leave-to {\\n  opacity: 0;\\n}\"},\"$:/plugins/oeyoews/vue-rss/widget.js\":{\"title\":\"$:/plugins/oeyoews/vue-rss/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-rss/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nvue-rss widget\\n\\n\\\\*/\\nconst{widget:e}=require(\\\"$:/core/modules/widgets/widget.js\\\");exports[\\\"vue-rss\\\"]=class extends e{constructor(e,r){super(e,r)}render(e,r){if(!$tw.browser)return;if(this.computeAttributes(),this.execute(),this.document.isTiddlyWikiFakeDom)return;window.Vue||(window.Vue=require(\\\"$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js\\\"));const{rss:t,proxy:o}=this.attributes,{createApp:s}=window.Vue,i=require(\\\"./app\\\"),n=this.document.createElement(\\\"div\\\");try{const u=s(i(t,o));u.config.errorHandler=e=>{const r=`[Vue3](${u.version}): `+e;console.error(r),n.textContent=r,n.style.color=\\\"red\\\"},u.mount(n),e.insertBefore(n,r),this.domNodes.push(n)}catch(e){console.error(e)}}};\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}