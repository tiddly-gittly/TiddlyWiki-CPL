{"title":"$:/plugins/oeyoews/neotw-notion-gallery","description":"neotw-notion-gallery","author":"oeyoews","version":"0.2.0","core-version":">=5.3.1","type":"application/json","plugin-type":"plugin","meta#disabled":"yes","name":"neotw-notion-gallery","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-notion-gallery/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/icon\",\"text\":\"<svg width=\\\"21\\\" height=\\\"23\\\" viewBox=\\\"0 0 21 23\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\r\\n<path d=\\\"M19.2787 0L20.5575 0.75V2.25L19.2787 3L18 2.25V0.75L19.2787 0ZM19.7739 2.23612L19.7931 2.23362C19.8072 2.22825 19.8206 2.2235 19.8291 2.20988C19.8575 2.16875 19.7845 2.15212 19.7584 2.1065C19.7322 2.061 19.6245 1.811 19.7061 1.741C19.7878 1.671 19.876 1.64225 19.9097 1.57662C19.9244 1.54712 19.9395 1.51725 19.9434 1.48388C19.9632 1.50038 19.9787 1.51575 20.0055 1.51663C20.0764 1.52113 20.1372 1.43437 20.1689 1.35225C20.1857 1.30175 20.1994 1.24825 20.1961 1.199C20.1875 1.104 20.1977 1.00125 20.2736 0.938125C20.1987 0.975875 20.1277 1.02437 20.043 1.03675C19.9962 1.0225 19.9492 1.00975 19.8996 1.01175C19.8754 0.980125 19.8426 0.920875 19.8 0.914C19.7275 0.94 19.7254 1.05213 19.6948 1.20413C19.6477 1.19083 19.5993 1.18274 19.5505 1.18C19.483 1.17562 19.373 1.19675 19.2957 1.1945C19.2184 1.19225 19.0662 1.12425 18.9396 1.13888C18.8887 1.14513 18.8375 1.15388 18.7903 1.17525C18.7614 1.18838 18.7196 1.22787 18.6986 1.23375C18.4874 1.29287 18.1434 1.29038 18.2138 0.971C18.2193 0.9465 18.2208 0.924375 18.21 0.918875C18.1963 0.912 18.1888 0.926375 18.1808 0.94225C18.0576 1.2095 18.2762 1.3815 18.5247 1.38225C18.6029 1.37625 18.5653 1.38137 18.6378 1.3675L18.6359 1.37775C18.6328 1.41998 18.6412 1.46227 18.6602 1.50009C18.6793 1.53792 18.7082 1.56986 18.744 1.5925C18.7103 1.68887 18.6434 1.76612 18.5974 1.85462C18.6146 1.96475 18.7262 2.11175 18.7724 2.13275C18.8131 2.15113 18.9019 2.15137 18.9224 2.12162C18.9298 2.10775 18.9249 2.07775 18.9169 2.06238C18.9515 2.10088 18.9982 2.15437 19.0435 2.18012C19.0706 2.19312 19.0977 2.20138 19.1281 2.20263L19.1669 2.20062C19.1861 2.1965 19.2089 2.19337 19.2219 2.17625C19.2364 2.15125 19.2227 2.08175 19.1624 2.07675C19.102 2.07175 19.063 2.049 19.0074 1.9665C18.9618 1.88675 19.017 1.77687 19.0356 1.69837C19.1312 1.71375 19.2275 1.72588 19.3244 1.72613C19.3664 1.724 19.4081 1.72237 19.4495 1.7145C19.4628 1.74825 19.4997 1.84262 19.5 1.86937C19.5009 1.9445 19.4726 2.02 19.4849 2.09525C19.4924 2.11737 19.4855 2.15925 19.5286 2.161L19.5771 2.16325L19.6105 2.16225C19.6531 2.23388 19.6901 2.23375 19.7739 2.23612ZM18.8341 2.02863L18.8263 2.02163C18.8033 1.99688 18.7438 1.95362 18.7548 1.9135C18.7641 1.88375 18.7814 1.85637 18.7951 1.82812L18.7946 1.831C18.7921 1.86625 18.7873 1.901 18.7986 1.93562C18.8334 1.96412 18.8815 2.00938 18.9134 2.04025C18.8961 2.0355 18.8634 2.02563 18.8471 2.032L18.8341 2.02863Z\\\" fill=\\\"black\\\"/>\\r\\n<path d=\\\"M3.5728 4.78761C4.2448 5.33321 4.496 5.29161 5.7584 5.20681L17.6512 4.49321C17.904 4.49321 17.6944 4.24201 17.6096 4.20041L15.6336 2.77161C15.256 2.47721 14.752 2.14121 13.7856 2.22601L2.2688 3.06601C1.8496 3.10761 1.7648 3.31721 1.9328 3.48521L3.5728 4.78761ZM4.2864 7.55881V20.0724C4.2864 20.7444 4.6224 20.9972 5.3792 20.9556L18.4512 20.1988C19.2064 20.1572 19.2912 19.6948 19.2912 19.1492V6.71881C19.2912 6.17481 19.0816 5.87881 18.6192 5.92041L4.9584 6.71881C4.4544 6.76041 4.2864 7.01321 4.2864 7.55881ZM17.1904 8.23081C17.2736 8.60841 17.1904 8.98601 16.8112 9.02921L16.1808 9.15401V18.3924C15.6352 18.6868 15.1296 18.8564 14.7088 18.8564C14.0368 18.8564 13.8688 18.6452 13.3648 18.0148L9.2448 11.5476V17.8052L10.5488 18.0996C10.5488 18.0996 10.5488 18.8548 9.4976 18.8548L6.5984 19.0228C6.5136 18.8548 6.5984 18.4356 6.8928 18.3508L7.648 18.1428V9.86761L6.6 9.78441C6.5152 9.40681 6.7248 8.86121 7.3136 8.81801L10.424 8.61001L14.712 15.1604V9.36521L13.6192 9.23881C13.5344 8.77641 13.8704 8.44041 14.2912 8.39881L17.192 8.23081H17.1904ZM1.3024 1.93161L13.2816 1.05001C14.752 0.922014 15.1296 1.00841 16.0544 1.68041L19.8784 4.36841C20.5104 4.82921 20.72 4.95561 20.72 5.45961V20.1988C20.72 21.1236 20.384 21.6708 19.2064 21.7524L5.296 22.5924C4.4128 22.6356 3.992 22.5092 3.5296 21.9204L0.7136 18.2676C0.2096 17.5956 0 17.0916 0 16.5028V3.40041C0 2.64521 0.336 2.01481 1.3024 1.93161Z\\\" fill=\\\"black\\\"/>\\r\\n</svg>\\r\\n\",\"type\":\"image/svg+xml\"},\"$:/plugins/oeyoews/neotw-notion-gallery/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/readme\",\"description\":\"卡片视图\",\"text\":\"\\r\\n!! 插件介绍(@deprecated)\\n\\n> 支持书单，博客，日志等卡片视图\\n\\nps: 支持豆瓣图片链接 (不受防盗链影响)\\r\\npss: 建议开启浏览器 GPU 加速，浏览效果更佳 (tailwindcss 影响)\\n\\n!! 使用方法\\n\\n```bash\\r\\n<$cards />\\n\\n## 可选参数filter, filter 默认为 [!is[system]!has[draft.of]!sort[created]limit[9]]\\r\\n<$cards filter=\\\"[tag[Journal]limit[9]]\\\"/>\\n\\n## 指定某一个(或者多个)固定tiddler\\r\\n<$cards filter=\\\"[[$:/core/ui/ControlPanel/Plugins]] [[GettingStarted]]\\\" />\\n\\n## 杂合(混用)\\r\\n## tiddler 的筛选器用法没有明确的术语表达,导致教程只能`show me the code`, 不像大众化的编程语言(比如JS,React,Vue),官方统一制定了术语, 比较浅显易懂\\r\\n<$cards filter=\\\"[[GettingStarted]] [!is[system]!has[draft.of]!sort[modified]!is[shadow]limit[8]]\\\" />\\r\\n```\\n\\n> 图片默认使用每个 tiddler 的 page-cover 字段，如果 page-cover 字段不存在，则使用 `https://source.unsplash.com/random/1920x1080?fm=blurhash&${title}`\\n\\n> 依赖插件：tailwindcss\\n\\n> 默认使用 (16:9)1920x1080 的分辨率 (分辨率越大 (图片质量越高), 图片加载速度就相对较慢)\\n\\n> 已经借助 tailwindcss 对页面进行了防抖动处理，图片按需加载\\n\\n> 之所以目前仅仅显示图片，而不是像 notion 的 gallery 布局，是因为由于 filter 的不同会导致不同的样式，此插件目前处于 beta 阶段，暂时不打算支持类似 notion 的动态字段配置 (时间有限，理论上是完全可以做到)\\n\\n!! Recipes\\n\\n> 每个 tiddler 的标题不要像论文标题那样过长 (也许我正文的部分还没你的标题长 😀), 尽量简短扼要\\n\\n!! 显示最近更新动态\\n\\n<$cards />\\n\\n!! 最近的日志\\n\\n<$cards filter=\\\"[tag[Journal]limit[9]]\\\"/>\\n\\n<!-- > 其实使用 wikitext 可以很快写一个，但是 wikitext 的 enlist, set, var(用法), 每次都记不住 (文档搜索真的不好用), 头疼 -->\\r\\n<!-- 会有闪烁，由于 tailwindcss 为加载完成应用样式 -->\\n\\n<!-- 事实证明 js 写的 widget 更具有扩展性，灵活性 -->\\n\\n!! v1.TODO\\n\\n* 修复 //xxx 开头的链接 // 符号丢失\\r\\n* add title params\\r\\n* support gallery to show all images(暂时不做)\\r\\n* 自动生成 today jounal card(use bing today wallpaper)(暂时不做)\\r\\n* 图片默认启用，或者部分可选择性启用，图片加载速度较慢\\r\\n* 🟩 icon: 不使用 icon 字段 (改用 page-icon),这里借助 iconify 插件\\r\\n* 🟥 sort(filter): add dynamic filter interface\\r\\n* 🟥 peek: 实现 peek, 支持全屏，tm-modal 可以借鉴 (灵活性不够), 但是全屏还是要另外想办法 square\\r\\n* 🟥 tag: tag 可点击，可以修改 tag\\r\\n* 🟥 dropmenu: 支持 tiddler 的删除，复制 (clone), 链接复制，重命名，star(favourite 提供支持)\\r\\n* 🟥 UI: 添加 title(支持修改), tag(tag manager)\\r\\n* 🟥 支持新增 tiddler\\r\\n* 🟥 search: current filter tiddler search\\r\\n* 🟥 view: 支持 gallary-table-magazine 的切换，支持字段可视化实时编辑\\r\\n* 支持列出所有的插件：使用 plugin-name 代替过长的 title\\n\\n> 如果过于复杂并且有时间的话，可能会引入 xstate 进行状态管理\\n\\n> 这里绝对保证不了 1:1 完全复刻 notion\\n\\n> ps: notion 的功能太花哨了 (复刻到 tiddlywiki 需要很多精力), 如果想要更好的体验，可以直接使用 notion\\r\\n\"},\"$:/plugins/oeyoews/neotw-notion-gallery/config.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/config.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/config.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nmodule.exports={imageField:\\\"page-cover\\\",maxCards:30,resoultion:\\\"1920x1080\\\",imageSource:\\\"https://source.unsplash.com/random\\\"};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-notion-gallery/createCard.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/createCard.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/createCard.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nmodule.exports=function(e,t,i,s,l,r=!0){const a=$tw.utils.domMaker,c=a(\\\"iconify-icon\\\",{class:\\\"mx-1\\\",attributes:{icon:l||\\\"simple-icons:tiddlywiki\\\"}}),n=a(\\\"h3\\\",{class:\\\"delay-100 text-[22px] cursor-pointer flex justify-center items-center truncate m-0 absolute inset-0 backdrop-blur-lg text-black rounded-md ease-in-out transition-all scale-0 group-hover:scale-105\\\",text:t||e,children:[c],attributes:{title:\\\"点击查看\\\"}}),o=a(\\\"div\\\",{children:[n]});n.addEventListener(\\\"click\\\",(()=>s(e)));const d=a(\\\"img\\\",{class:\\\"object-cover w-full h-full rounded-md group-hover:scale-105 transition-all duration-800 ease-in-out shadow-md aspect-video\\\",attributes:{\\\"data-src\\\":i,alt:t||e}});\\\"false\\\"===r&&d.classList.remove(\\\"aspect-video\\\");const u=a(\\\"div\\\",{class:\\\"flex flex-col items-center justify-center p-0 group relative\\\",children:[d,o]});return u.addEventListener(\\\"contextmenu\\\",(e=>{e.preventDefault()})),{imageNode:d,item:u}};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-notion-gallery/meta\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/meta\",\"tags\":\"$:/tags/RawMarkupWikified/TopHead\",\"text\":\"`<meta name=\\\"referrer\\\" content=\\\"never\\\" />`\\n\"},\"$:/plugins/oeyoews/neotw-notion-gallery/ninecard\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/ninecard\",\"tags\":\"$:/tags/Macro\",\"text\":\"\\\\procedure card(title)\\r\\n<div class=\\\"rounded-xl not-prose transition-all relative hover:scale-105 shadow-sm duration-300\\\">\\r\\n\\t<$oimg src={{{ [<title>addprefix[https://source.unsplash.com/random/1920x1080?fm=blurhash&]] }}} />\\r\\n\\t<$avatar class=\\\"h-8 shadow outline outline-2 outline-white absolute top-2 left-2 scale-0 group-hover:scale-100\\\"/>\\r\\n<$link to=<<title>> class=\\\"text-indigo-600 truncate capitalize absolute text-white bottom-0 left-0 group-hover:text-sky-400 backdrop-blur-lg rounded p-2 w-full\\\"/>\\r\\n</div>\\r\\n\\\\end\\n\\n\\\\procedure ninecards(subfilter:\\\"[!is[system]]\\\", limit:9)\\r\\n<div class=\\\"grid grid-cols-1 md:grid-cols-3 gap-8\\\">\\r\\n<$list filter='[!is[system]!sort[modified]!has[draft.of]subfilter<subfilter>limit<limit>]'  >\\r\\n<$transclude $variable=\\\"card\\\" title={{!!title}} />\\r\\n</$list>\\r\\n</div>\\r\\n\\\\end\"},\"table-view/widget\":{\"title\":\"table-view/widget\",\"text\":\"/*\\\\\\ntitle: table-view/widget\\ntype: application/javascript\\nmodule-type: widget\\n\\ntable-view widget\\n\\n\\\\*/\\n!function(){\\\"use strict\\\";const t=require(\\\"$:/core/modules/widgets/widget.js\\\").widget;exports.ntable=class extends t{constructor(t,e){super(t,e)}render(t,e){if(!$tw.browser)return;this.parentDomNode=t,this.computeAttributes(),this.execute();const s=$tw.utils.domMaker,r=s(\\\"button\\\",{text:\\\"titleBtn\\\"}),o=s(\\\"button\\\",{text:\\\"tagBtn\\\"}),i=s(\\\"div\\\",{class:\\\"flex flex-row overflow-scroll justify-start space-x-4 border-t border-t-gray-200\\\",children:[r,o]}),n=s(\\\"div\\\",{class:\\\"ntable\\\",children:[i]});t.insertBefore(n,e),this.domNodes.push(n)}}}();\",\"type\":\"application/javascript\",\"module-type\":\"widget\"},\"$:/plugins/oeyoews/neotw-notion-gallery/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-notion-gallery/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-notion-gallery/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-notion-gallery widget\\n\\n\\\\*/\\nconst{widget:t}=require(\\\"$:/core/modules/widgets/widget.js\\\"),e=require(\\\"./createCard\\\"),i=require(\\\"./config\\\");class s extends t{constructor(t,e){super(t,e),this.maxCards=i.maxCards,this.count=9,this.subfilter=`[!is[system]!sort[modified]limit[${this.count}]]`}render(t,s){if(!$tw.browser)return;const r=new $tw.utils.Logger(\\\"neotw-notion-gallery\\\");$tw.modules.titles[\\\"tailwindcss.min.js\\\"]||r.alert(\\\"The plugin 'oeyoews/neotw-notion-gallery' requires the 'tiddlywiki/tailwindcss-plus' plugin to be installed\\\");const d=(new $tw.ImageObserver).observer;this.parentDomNode=t,this.computeAttributes(),this.execute();const o=$tw.wiki,l=t=>(this.parentWidget.dispatchEvent({type:\\\"tm-navigate\\\",param:t,navigateTo:t}),!1),{imageField:n,resoultion:a,imageSource:c}=i,{filter:h=this.subfilter,standard:u,count:m,cols:f=3}=this.attributes;this.count=m;const g=this.removedFilterDraftTiddlers(h||this.subfilter),p=document.createElement(\\\"div\\\"),w=`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-${f} gap-8 m-4`;p.classList.add(...w.split(\\\" \\\")),(t=>t.slice(0,this.count).map((t=>{const{fields:e}=o.getTiddler(t)||{fields:{}};if(!e)return;let i=e[n],s=e[\\\"page-icon\\\"];return i&&(i.startsWith(\\\"//\\\")||i.startsWith(\\\"http\\\"))||(i=`${c}/${a}?fm=blurhash&${e.title}`),{title:e?.title,caption:e?.caption,cover:i,icon:s}})))(g).forEach((({title:t,caption:i,cover:s,icon:r})=>{const{imageNode:o,item:n}=e(t,i,s,l,r,u);p.appendChild(n),d.observe(o)})),t.insertBefore(p,s),this.domNodes.push(p)}isChanged(t){let e=this.removedFilterDraftTiddlers();const{filteredTiddlers:i,notExistTiddlers:s}=this.removedDraftTiddlers(Object.keys(t));let r=i.some((t=>e.includes(t)));return s.length&&(r=!0),r}removedDraftTiddlers(t){let e=[];return{filteredTiddlers:t.filter((t=>$tw.wiki.tiddlerExists(t)?!(!t.startsWith(\\\"$:/plugins/books\\\")&&t.startsWith(\\\"$:/\\\")||t.startsWith(\\\"Draft of\\\")):(e.push(t),!1))),notExistTiddlers:e}}removedFilterDraftTiddlers(t=this.subfilter){const e=$tw.wiki.filterTiddlers(t);return this.removedDraftTiddlers(e).filteredTiddlers}refresh(t){return!!this.isChanged(t)&&(this.refreshSelf(),!0)}}exports.cards=s,exports.ninecards=s;\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}