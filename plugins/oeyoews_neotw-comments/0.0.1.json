{"title":"$:/plugins/oeyoews/neotw-comments","description":"neotw-comments","author":"oeyoews","version":"0.0.1","core-version":">=5.3.4","type":"application/json","plugin-type":"plugin","name":"neotw-comments","meat#disabled":"yes","qrcode":"yes","created":"20250301","dependents":"$:/plugins/oeyoews/neotw-vue3 $:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","stability":"STABILITY_2_STABLE","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-comments/components/CommentList.js\":{\"text\":\"const{ref:e,onMounted:t}=window.Vue,l=require(\\\"../../neotw-vue3/getTemplate.js\\\");module.exports={props:{tiddler:{type:String,required:!0}},setup(l){const m=e([]),n=e(\\\"\\\"),o=e(null),d=e(\\\"\\\"),{getComments:i,addComment:u,deleteComment:r,editComment:a,getTime:s}=require(\\\"../lib.js\\\"),p=()=>{m.value=i(l.tiddler)};return t((()=>{p()})),{comments:m,newComment:n,editingComment:o,editText:d,getTime:s,handleAddComment:()=>{n.value.trim()&&(u(l.tiddler,\\\"oeyoews\\\",n.value),n.value=\\\"\\\",p())},handleDeleteComment:e=>{r(l.tiddler,e),p()},startEditing:e=>{o.value=e.created,d.value=e.text},handleEditComment:()=>{d.value.trim()&&(a(l.tiddler,o.value,d.value),o.value=null,p())},isHttps:\\\"https:\\\"===window.location.protocol}},template:l(\\\"$:/plugins/oeyoews/neotw-comments/templates/commentList.vue\\\")};\",\"title\":\"$:/plugins/oeyoews/neotw-comments/components/CommentList.js\",\"module-type\":\"library\",\"type\":\"application/javascript\"},\"$:/plugins/oeyoews/neotw-comments/templates/app.vue\":{\"text\":\"<div class=\\\"neotw-comments\\\">\\n  <CommentList :tiddler=\\\"currentTiddler\\\" />\\n</div>\",\"title\":\"$:/plugins/oeyoews/neotw-comments/templates/app.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/neotw-comments/templates/commentList.vue\":{\"text\":\"<div class=\\\"comments-container\\\">\\n\\t<div class=\\\"new-comment\\\" v-if=\\\"!isHttps\\\">\\n\\t\\t<textarea @keyup.ctrl.enter=\\\"handleAddComment\\\" v-model=\\\"newComment\\\" placeholder=\\\"ÂÜô‰∏ã‰Ω†ÁöÑËØÑËÆ∫...\\\"\\n\\t\\t\\tclass=\\\"w-full p-2 border rounded\\\"></textarea>\\n\\t\\t<div class=\\\"flex justify-end\\\">\\n\\t\\t\\t<button @click=\\\"handleAddComment\\\" class=\\\"mt-2 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600\\\">\\n\\t\\t\\t\\tÂèëË°®ËØÑËÆ∫\\n\\t\\t\\t</button>\\n\\t\\t</div>\\n\\t</div>\\n\\n\\t<div class=\\\"comments-list mt-4\\\" v-if=\\\"comments?.length>0\\\">\\n\\t\\t<div v-for=\\\"comment in comments\\\" :key=\\\"comment.created\\\" class=\\\"comment-item border-b py-4\\\">\\n\\t\\t\\t<div class=\\\"flex justify-between items-start\\\">\\n\\t\\t\\t\\t<div class=\\\"comment-content\\\">\\n\\t\\t\\t\\t\\t<div v-if=\\\"editingComment !== comment.created\\\">\\n\\t\\t\\t\\t\\t\\t{{ comment.text }}\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div v-else>\\n\\t\\t\\t\\t\\t\\t<textarea v-model=\\\"editText\\\" class=\\\"w-full p-2 border rounded\\\"></textarea>\\n\\t\\t\\t\\t\\t\\t<button @click=\\\"handleEditComment\\\"\\n\\t\\t\\t\\t\\t\\t\\tclass=\\\"mt-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\\\">\\n\\t\\t\\t\\t\\t\\t\\t‰øùÂ≠ò\\n\\t\\t\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div class=\\\"comment-actions\\\">\\n\\t\\t\\t\\t\\t<button v-if=\\\"editingComment !== comment.created\\\" @click=\\\"startEditing(comment)\\\"\\n\\t\\t\\t\\t\\t\\tclass=\\\"text-blue-500 hover:text-blue-700 mr-2\\\">\\n\\t\\t\\t\\t\\t\\tÁºñËæë\\n\\t\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t\\t<button @click=\\\"handleDeleteComment(comment.created)\\\" class=\\\"text-red-500 hover:text-red-700\\\">\\n\\t\\t\\t\\t\\t\\tÂà†Èô§\\n\\t\\t\\t\\t\\t</button>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\\\"comment-meta text-sm text-gray-500 mt-2\\\">\\n\\t\\t\\t\\t{{ comment.author }} ¬∑ {{getTime(comment.created)}}\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t</div>\\n</div>\",\"title\":\"$:/plugins/oeyoews/neotw-comments/templates/commentList.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/neotw-comments/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-comments/readme\",\"description\":\"neotw-comments\",\"text\":\"[[Âú®Á∫øÊñáÊ°£|https://neotw.vercel.app/docs/plugins/neotw-comments]]\\n\\n* ‰∏çËÄÉËôëÈáçÂëΩÂêçÁöÑÈóÆÈ¢òÔºöÂ¶ÇÊûú‰∏ç‰ΩøÁî® title, ËÄåÊòØ‰ΩøÁî®ÂÖ∂‰ªñÁöÑÂ≠óÊÆµÔºåÂú®ÂÜôÂÖ•ÁöÑÊó∂ÂÄôËøòË¶ÅÈáçÊñ∞Ê†πÊçÆÂ≠óÊÆµÂéªÊü•Êâæ title.\"},\"$:/plugins/oeyoews/neotw-comments/app.js\":{\"title\":\"$:/plugins/oeyoews/neotw-comments/app.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-comments/app.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nconst e=require(\\\"../neotw-vue3/getTemplate.js\\\"),t=require(\\\"./components/CommentList.js\\\");module.exports=({tiddler:o})=>({components:{CommentList:t},template:e(\\\"$:/plugins/oeyoews/neotw-comments/templates/app.vue\\\"),setup:()=>({currentTiddler:o}),mounted(){}});\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-comments/lib.js\":{\"title\":\"$:/plugins/oeyoews/neotw-comments/lib.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-comments/lib.js\\ntype: application/javascript\\nmodule-type: library\\n\\\\*/\\nconst e=e=>`$:/comments-${e}`,t=t=>{const d=e(t),n=$tw.wiki.getTiddler(d);return n?JSON.parse(n.fields.comments||\\\"[]\\\"):[]},d=(t,d)=>{const n=e(t);0===d.length?$tw.wiki.deleteTiddler(n):$tw.wiki.addTiddler(new $tw.Tiddler({title:n,type:\\\"application/json\\\",comments:JSON.stringify(d,null,0)}))};module.exports={addComment:(e,n,i)=>{const l=(new Date).toISOString().replace(/[-T:.Z]/g,\\\"\\\"),r=t(e);r.push({author:n,text:i,created:l}),d(e,r)},getComments:t,deleteComment:(e,n)=>{const i=t(e),l=i.filter((e=>e.created!==n));l.length!==i.length&&d(e,l)},editComment:(e,n,i)=>{let l=t(e),r=!1;l=l.map((e=>e.created===n?(r=!0,{...e,text:i}):e)),r&&d(e,l)},getTime:e=>new Date(e.slice(0,14).replace(/(\\\\d{4})(\\\\d{2})(\\\\d{2})(\\\\d{2})(\\\\d{2})(\\\\d{2})/,\\\"$1-$2-$3T$4:$5:$6Z\\\")).toISOString().replace(RegExp(/[TZ]/g),\\\" \\\").trim()};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-comments/viewTemplate\":{\"title\":\"$:/plugins/oeyoews/neotw-comments/viewTemplate\",\"tags\":\"$:/tags/ViewTemplate\",\"text\":\"<$list filter=\\\"[all[current]tag[Journal]] [all[current]tag[ü§îthoughts]] [all[current]field:comments[yes]]\\\">\\n<$neotw-comments />\\n</$list>\"},\"$:/plugins/oeyoews/neotw-comments/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-comments/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-comments/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-comments widget\\n\\n\\\\*/\\nconst{widget:e}=require(\\\"$:/core/modules/widgets/widget.js\\\");exports[\\\"neotw-comments\\\"]=class extends e{constructor(e,r){super(e,r)}render(e,r){if(!$tw.browser)return;if(this.computeAttributes(),this.execute(),this.document.isTiddlyWikiFakeDom)return;const t=this.getVariable(\\\"currentTiddler\\\");window.Vue||(window.Vue=require(\\\"$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js\\\"));const{createApp:o}=window.Vue,s=require(\\\"./app\\\"),n=this.document.createElement(\\\"div\\\");try{\\n/** @type {{ use: Function, component: (string, Object) }} */\\nconst i=o(s({tiddler:t}));i.config.errorHandler=e=>{const r=`[Vue3](${i.version}): `+e.message;console.error(r),n.textContent=r,n.style.color=\\\"red\\\"},i.mount(n),e.insertBefore(n,r),this.domNodes.push(n)}catch(e){console.error(e.message)}}refresh(){return!1}};\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}