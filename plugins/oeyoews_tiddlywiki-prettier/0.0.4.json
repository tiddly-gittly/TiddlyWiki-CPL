{"title":"$:/plugins/oeyoews/tiddlywiki-prettier","description":"tiddlywiki-prettier","author":"oeyoews","version":"0.0.4","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"tiddlywiki-prettier","meat#disabled":"yes","qrcode":"yes","created":"2024-02-03","dependents":"","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/tiddlywiki-prettier/readme\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/readme\",\"text\":\"<center>\\n<video width=\\\"300\\\" controls style=\\\"border-radius:8px;\\\">\\n  <source src=\\\"https://github.com/oeyoews/tiddlywiki-starter-kit/assets/72405338/0733a637-c606-4df5-b505-34ea614b22ef\\\" type=\\\"video/mp4\\\">\\n</video>\\n</center>\\n\\n\\n## Tiddlywiki Prettier\\n\\n* support markdown\\n\\n## Option\\n\\n<$checkbox tag=\\\"$:/tags/RawMarkup\\\" tiddler=\\\"$:/plugins/oeyoews/tiddlywiki-prettier/scripts\\\">\\nUse Prettier CDN\\n</$checkbox>\\n\\n## TODO\\n\\n* support css, html, js with prettier plugins\\n* support markdown-it-prettier(markdownit not support async, must use prettier 2.8.0)\\n\\n\",\"type\":\"text/markdown\",\"description\":\"tiddlywiki-prettier\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/format.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/format.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-prettier/format.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\n/**\\n * Asynchronously formats the given text using Prettier.\\n *\\n * @param {string} text - The text to be formatted\\n * @param {string} type - The type of parser to be used\\n * @return {Promise<string>} The formatted text\\n */\\nmodule.exports=async function(i,r=\\\"markdown\\\"){const t=require(\\\"./option\\\");if(window.prettier&&window.prettierPlugins){if(this.prettier=window.prettier,this.plugins=window.prettierPlugins,this.plugins.markdown)return await this.prettier.format(i,{parser:r,plugins:[this.plugins[r]],...t});console.warn(\\\"Miss prettier markdown plugin\\\")}};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/formatTiddler.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/formatTiddler.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-prettier/formatTiddler.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\n/**\\n * Asynchronously formats the given text using Prettier.\\n *\\n * @param {string} text - The text to be formatted\\n * @param {string} type - The type of parser to be used\\n * @return {Promise<string>} The formatted text\\n */\\nmodule.exports=async function(t,e=\\\"markdown\\\"){const i=$tw.wiki.getTiddlerText(t);try{const e=require(\\\"./format\\\"),r=await e(i);if(!r)return;$tw.wiki.setText(t,\\\"text\\\",\\\"\\\",r,{suppressTimestamp:!0}),$tw.notifier.display(\\\"$:/plugins/oeyoews/tiddlywiki-prettier/notify/prettier\\\")}catch(t){console.warn(t)}};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/icon\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/icon\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"tc-image-prettier-button\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\" viewBox=\\\"0 0 439 512\\\"><path d=\\\"M304.805 24.381H12.145C-4.408 23.629-3.685.134 12.145 0h292.66c15.91.24 16.48 23.565 0 24.381M12.14 121.905c-16.548-.752-15.825-24.247 0-24.381h170.763c15.906.24 16.475 23.565 0 24.38zm121.905-48.762c-16.548-.752-15.825-24.247 0-24.381H377.95c15.907.24 16.475 23.565 0 24.38zm195.141 24.38c15.906.242 16.478 23.566.002 24.382h-97.62c-16.547-.752-15.824-24.247 0-24.381zm48.669 24.382c-16.548-.752-15.825-24.247 0-24.381h24.476c15.907.24 16.475 23.565 0 24.38zM12.14 170.667c-16.548-.752-15.825-24.247 0-24.381H61c15.906.24 16.475 23.565 0 24.38zm292.572 0c-16.548-.752-15.825-24.247 0-24.381h122c15.906.24 16.475 23.565 0 24.38zm-195.048 0c-16.548-.752-15.825-24.247 0-24.381h24.477c15.906.24 16.475 23.565 0 24.38zM12.141 463.238c-16.548-.752-15.825-24.247 0-24.38H61c15.906.24 16.475 23.564 0 24.38zm97.524 0c-16.548-.752-15.825-24.247 0-24.38h24.477c15.906.24 16.475 23.564 0 24.38zm195.048-243.81c-16.548-.751-15.825-24.246 0-24.38h122c15.906.24 16.475 23.565 0 24.38zm-292.572 0c-16.548-.751-15.825-24.246 0-24.38h122c15.907.24 16.476 23.565 0 24.38zm0 195.048c-16.548-.752-15.825-24.247 0-24.38h122c15.907.24 16.476 23.564 0 24.38zm0 97.524c-16.548-.752-15.825-24.247 0-24.381h122c15.907.241 16.476 23.565 0 24.381zm0-243.81c-16.548-.751-15.825-24.246 0-24.38h24.477c15.906.24 16.475 23.565 0 24.38zm73.143 0c-16.548-.751-15.825-24.246 0-24.38h73.239c15.906.24 16.475 23.565 0 24.38zm121.905 0c-16.548-.751-15.825-24.246 0-24.38h195.143c15.907.24 16.475 23.565 0 24.38zm97.524 48.762c-16.548-.751-15.825-24.246 0-24.38h73.238c15.907.24 16.475 23.565 0 24.38zm-146.286 0c-16.548-.751-15.825-24.246 0-24.38h97.62c15.906.24 16.475 23.565 0 24.38zm-146.286 0c-16.548-.751-15.825-24.246 0-24.38h97.62c15.906.24 16.475 23.565 0 24.38zm0 48.762c-16.548-.751-15.825-24.246 0-24.38h24.477c15.906.24 16.475 23.564 0 24.38zm73.143 0c-16.548-.751-15.825-24.246 0-24.38h219.524c15.907.24 16.476 23.564 0 24.38zM12.141 73.143c-16.548-.752-15.825-24.247 0-24.381h73.192c15.968.24 16.539 23.565 0 24.38z\\\"/></svg>\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/notify/prettier\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/notify/prettier\",\"text\":\"prettier done\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/option.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/option.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-prettier/option.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\nmodule.exports={endOfLine:\\\"auto\\\"};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/scripts\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/scripts\",\"type\":\"application/javascript\",\"tags\":\"$:/tags/RawMarkup\",\"text\":\"<script src=\\\"https://unpkg.com/prettier@3.2.4/standalone.js\\\"></script>\\n<script src=\\\"https://unpkg.com/prettier@3.2.4/plugins/markdown.js\\\"></script>\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/startup.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-prettier/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\\\*/\\nexports.name=\\\"prettier-startup-hook\\\",exports.platforms=[\\\"browser\\\"],exports.after=[\\\"startup\\\"],exports.synchronous=!0,exports.startup=()=>{const t=require(\\\"./formatTiddler\\\");$tw.rootWidget.addEventListener(\\\"om-prettier-tiddler\\\",(r=>{const e=r.navigateFromTitle||r?.paramObject?.title||r.tiddlerTitle;t(e)}))};\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/EditToolbar\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/EditToolbar\",\"tags\":\"$:/tags/ViewToolbar\",\"list-before\":\"$:/core/ui/Buttons/close\",\"description\":\"prettier tiddler\",\"caption\":\"Prettier\",\"text\":\"\\\\whitespace trim\\n<$list filter=\\\"[all[current]!is[system]type[text/markdown]]\\\">\\n<$button message=\\\"om-prettier-tiddler\\\" tooltip=\\\"prettier tiddler\\\" aria-label=\\\"prettier\\\" class=<<tv-config-toolbar-class>>>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/oeyoews/tiddlywiki-prettier/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n  <$text text=\\\"Prettier\\\"/>\\n</span>\\n</$list>\\n</$button>\\n</$list>\\n\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/EditorToolbar\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/EditorToolbar\",\"caption\":\"prettier\",\"condition\":\"[<targetTiddler>type[text/markdown]]\",\"icon\":\"$:/plugins/oeyoews/tiddlywiki-prettier/icon\",\"tags\":\"$:/tags/EditorToolbar\",\"text\":\"\\n<!-- TODO: use tm-focus-selector, to focus on prettier done -->\\n<$action-sendmessage $message=\\\"om-prettier-tiddler\\\" title=<<targetTiddler>> />\\n\"},\"$:/plugins/oeyoews/tiddlywiki-prettier/widget.js\":{\"title\":\"$:/plugins/oeyoews/tiddlywiki-prettier/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/tiddlywiki-prettier/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\ntiddlywiki-prettier widget\\n\\n\\\\*/\\nconst{widget:t}=require(\\\"$:/core/modules/widgets/widget.js\\\");exports.prettier=class extends t{constructor(t,e){super(t,e),this.prettier=null,this.plugins=null,this.formatedText=\\\"\\\"}render(t,e){if(!$tw.browser)return;const r=require(\\\"./format\\\");if(this.document.isTiddlyWikiFakeDom)return;this.computeAttributes(),this.execute();const s=$tw.utils.domMaker,i=s(\\\"button\\\",{text:\\\"format\\\"});i.addEventListener(\\\"click\\\",(async()=>{this.formatedText=await r(\\\"* 测试，\\\",\\\"markdown\\\"),console.log(this.formatedText)}));const o=s(\\\"div\\\",{children:[i]});t.insertBefore(o,e),this.domNodes.push(o)}};\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}