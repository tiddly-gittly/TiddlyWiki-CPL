{"title":"$:/plugins/oeyoews/neotw-tour","description":"Neotw Tour","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"Neotw Tour","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-tour/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-tour/readme\",\"description\":\"Neotw Tour\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n!! Driver.js TiddlyWiki Plugin\\n\\nThis is a plugin designed to add guided tutorial functionality to TiddlyWiki. It utilizes the https://github.com/kamranahmedse/driver.js library to highlight page elements and display pop-up windows.\\n\\n!! 示例\\n\\n<h1 id=\\\"h1\\\">H1</h1>\\n<h2 id='h2'>H2</h2>\\n\\n<$tour class=\\\"p-2\\\"/>\\n\\n!! 使用\\n\\n* 可以使用键盘上的方向键\\n\\n!! TODO\\n\\n* update to 1.2.0\\n\\n</div>\"},\"ask/startup.js\":{\"title\":\"ask/startup.js\",\"text\":\"/*\\\\\\ntitle: ask/startup.js\\ntype: application/javascript\\n// module-type: startup\\n\\n\\\\*/\\n!function(){\\\"use strict\\\";exports.name=\\\"-startup-hook\\\",exports.platforms=[\\\"browser\\\"],exports.after=[\\\"startup\\\"],exports.synchronous=!0,exports.startup=()=>{Swal.fire({title:\\\"是否需要引导教程\\\",icon:\\\"info\\\",showCancelButton:!0,confirmButtonText:\\\"需要，我是新手\\\",cancelButtonText:\\\"我是老手，不需要\\\"}).then((t=>{t.value&&driver({showProgress:!0,animate:!0,showButtons:[\\\"next\\\",\\\"previous\\\",\\\"close\\\"],allowClose:!1,steps:[{element:\\\"#stx-story-top\\\",popover:{title:\\\"侧边工具栏\\\",description:\\\"自定义工具栏\\\",position:\\\"left\\\"}},{element:document.querySelector(\\\"center\\\"),popover:{title:\\\"TiddlyWiki 主页展示\\\",description:\\\"自定义 TiddlyWiki 主页展示\\\",position:\\\"left\\\"}}]}).drive()}))}}();\",\"type\":\"application/javascript\",\"// module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-tour/demo.json\":{\"text\":\"[\\n  {\\n    \\\"element\\\": \\\".tc-story-river\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"stroy river\\\",\\n      \\\"description\\\": \\\"tc-story-river\\\",\\n      \\\"position\\\": \\\"right\\\"\\n    }\\n  },\\n  {\\n    \\\"element\\\": \\\".tc-tiddler-title\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"Tiddler Title\\\",\\n      \\\"description\\\": \\\"Tiddler Title\\\"\\n    }\\n  },\\n  {\\n    \\\"element\\\": \\\".tc-subtitle\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"subtitle\\\",\\n      \\\"description\\\": \\\"subTitle\\\",\\n      \\\"position\\\": \\\"bottom\\\"\\n    }\\n  }\\n]\",\"type\":\"application/json\",\"title\":\"$:/plugins/oeyoews/neotw-tour/demo.json\"},\"$:/plugins/oeyoews/neotw-tour/driver-startup.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tour/driver-startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tour/driver-startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nmodule\\n\\n\\\\*/\\nexports.name=\\\"driver-startup-hook\\\",exports.platforms=[\\\"browser\\\"],exports.after=[\\\"startup\\\"],exports.synchronous=!0,exports.startup=()=>{require(\\\"./driver.min.js\\\"),window.driver=window.driver.js.driver;const{tour:r}=require(\\\"./tour.js\\\");$tw.rootWidget.addEventListener(\\\"om-tours\\\",r)};\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"driver.min.css\":{\"title\":\"driver.min.css\",\"text\":\".driver-active .driver-overlay,\\n.driver-active * {\\n  pointer-events: none;\\n}\\n.driver-active .driver-active-element,\\n.driver-active .driver-active-element *,\\n.driver-popover,\\n.driver-popover * {\\n  pointer-events: auto;\\n}\\n@keyframes animate-fade-in {\\n  0% {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n.driver-fade .driver-overlay {\\n  animation: animate-fade-in 0.2s ease-in-out;\\n}\\n.driver-fade .driver-popover {\\n  animation: animate-fade-in 0.2s;\\n}\\n.driver-popover {\\n  all: unset;\\n  box-sizing: border-box;\\n  color: #2d2d2d;\\n  margin: 0;\\n  padding: 15px;\\n  border-radius: 5px;\\n  min-width: 250px;\\n  max-width: 300px;\\n  box-shadow: 0 1px 10px #0006;\\n  z-index: 1000000000;\\n  position: fixed;\\n  top: 0;\\n  right: 0;\\n  background-color: #fff;\\n}\\n.driver-popover * {\\n  font-family:\\n    Helvetica Neue,\\n    Inter,\\n    ui-sans-serif,\\n    'Apple Color Emoji',\\n    Helvetica,\\n    Arial,\\n    sans-serif;\\n}\\n.driver-popover-title {\\n  font: 19px / normal sans-serif;\\n  font-weight: 700;\\n  display: block;\\n  position: relative;\\n  line-height: 1.5;\\n  zoom: 1;\\n  margin: 0;\\n}\\n.driver-popover-close-btn {\\n  all: unset;\\n  position: absolute;\\n  top: 0;\\n  right: 0;\\n  width: 32px;\\n  height: 28px;\\n  cursor: pointer;\\n  font-size: 18px;\\n  font-weight: 500;\\n  color: #d2d2d2;\\n  z-index: 1;\\n  text-align: center;\\n  transition: color;\\n  transition-duration: 0.2s;\\n}\\n.driver-popover-close-btn:hover {\\n  color: #2d2d2d;\\n}\\n.driver-popover-title[style*='block'] + .driver-popover-description {\\n  margin-top: 5px;\\n}\\n.driver-popover-description {\\n  margin-bottom: 0;\\n  font: 14px / normal sans-serif;\\n  line-height: 1.5;\\n  font-weight: 400;\\n  zoom: 1;\\n}\\n.driver-popover-footer {\\n  margin-top: 15px;\\n  text-align: right;\\n  zoom: 1;\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n}\\n.driver-popover-progress-text {\\n  font-size: 13px;\\n  font-weight: 400;\\n  color: #a2a2a2;\\n  zoom: 1;\\n}\\n.driver-popover-footer button {\\n  all: unset;\\n  display: inline-block;\\n  box-sizing: border-box;\\n  padding: 3px 7px;\\n  text-decoration: none;\\n  text-shadow: 1px 1px 0 #fff;\\n  background-color: #fff;\\n  color: #2d2d2d;\\n  font: 12px / normal sans-serif;\\n  cursor: pointer;\\n  outline: 0;\\n  zoom: 1;\\n  line-height: 1.3;\\n  border: 1px solid #ccc;\\n  border-radius: 3px;\\n}\\n.driver-popover-footer .driver-popover-btn-disabled {\\n  opacity: 0.5;\\n  pointer-events: none;\\n}\\n:not(body):has(> .driver-active-element) {\\n  overflow: hidden !important;\\n}\\n.driver-popover-footer button:hover {\\n  background-color: #f7f7f7;\\n}\\n.driver-popover-navigation-btns {\\n  display: flex;\\n  flex-grow: 1;\\n  justify-content: flex-end;\\n}\\n.driver-popover-navigation-btns button + button {\\n  margin-left: 4px;\\n}\\n.driver-popover-arrow {\\n  content: '';\\n  position: absolute;\\n  border: 5px solid #fff;\\n}\\n.driver-popover-arrow-side-over {\\n  display: none;\\n}\\n.driver-popover-arrow-side-left {\\n  left: 100%;\\n  border-right-color: transparent;\\n  border-bottom-color: transparent;\\n  border-top-color: transparent;\\n}\\n.driver-popover-arrow-side-right {\\n  right: 100%;\\n  border-left-color: transparent;\\n  border-bottom-color: transparent;\\n  border-top-color: transparent;\\n}\\n.driver-popover-arrow-side-top {\\n  top: 100%;\\n  border-right-color: transparent;\\n  border-bottom-color: transparent;\\n  border-left-color: transparent;\\n}\\n.driver-popover-arrow-side-bottom {\\n  bottom: 100%;\\n  border-left-color: transparent;\\n  border-top-color: transparent;\\n  border-right-color: transparent;\\n}\\n.driver-popover-arrow-side-center {\\n  display: none;\\n}\\n.driver-popover-arrow-side-left.driver-popover-arrow-align-start,\\n.driver-popover-arrow-side-right.driver-popover-arrow-align-start {\\n  top: 15px;\\n}\\n.driver-popover-arrow-side-top.driver-popover-arrow-align-start,\\n.driver-popover-arrow-side-bottom.driver-popover-arrow-align-start {\\n  left: 15px;\\n}\\n.driver-popover-arrow-align-end.driver-popover-arrow-side-left,\\n.driver-popover-arrow-align-end.driver-popover-arrow-side-right {\\n  bottom: 15px;\\n}\\n.driver-popover-arrow-side-top.driver-popover-arrow-align-end,\\n.driver-popover-arrow-side-bottom.driver-popover-arrow-align-end {\\n  right: 15px;\\n}\\n.driver-popover-arrow-side-left.driver-popover-arrow-align-center,\\n.driver-popover-arrow-side-right.driver-popover-arrow-align-center {\\n  top: 50%;\\n  margin-top: -5px;\\n}\\n.driver-popover-arrow-side-top.driver-popover-arrow-align-center,\\n.driver-popover-arrow-side-bottom.driver-popover-arrow-align-center {\\n  left: 50%;\\n  margin-left: -5px;\\n}\\n.driver-popover-arrow-none {\\n  display: none;\\n}\\n\",\"tags\":\"$:/tags/Stylesheet\"},\"$:/plugins/oeyoews/neotw-tour/driver.min.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tour/driver.min.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tour/driver.min.js\\ntype: application/javascript\\nmodule-type: library\\n\\ndriver.min.js\\n\\\\*/\\nthis.driver = this.driver || {};\\nthis.driver.js = (function (N) {\\n  'use strict';\\n  let O = {};\\n  function z(e = {}) {\\n    O = {\\n      animate: !0,\\n      allowClose: !0,\\n      overlayOpacity: 0.7,\\n      smoothScroll: !1,\\n      showProgress: !1,\\n      stagePadding: 10,\\n      stageRadius: 5,\\n      popoverOffset: 10,\\n      showButtons: ['next', 'previous', 'close'],\\n      disableButtons: [],\\n      overlayColor: '#000',\\n      ...e,\\n    };\\n  }\\n  function s(e) {\\n    return e ? O[e] : O;\\n  }\\n  function W(e, t, o, n) {\\n    return (e /= n / 2) < 1\\n      ? (o / 2) * e * e + t\\n      : (-o / 2) * (--e * (e - 2) - 1) + t;\\n  }\\n  function D(e) {\\n    if (!e || re(e)) return;\\n    const t = s('smoothScroll');\\n    e.scrollIntoView({\\n      behavior: !t || ie(e) ? 'auto' : 'smooth',\\n      inline: 'center',\\n      block: 'center',\\n    });\\n  }\\n  function ie(e) {\\n    if (!e || !e.parentElement) return;\\n    const t = e.parentElement;\\n    return t.scrollHeight > t.clientHeight;\\n  }\\n  function re(e) {\\n    const t = e.getBoundingClientRect();\\n    return (\\n      t.top >= 0 &&\\n      t.left >= 0 &&\\n      t.bottom <=\\n        (window.innerHeight || document.documentElement.clientHeight) &&\\n      t.right <= (window.innerWidth || document.documentElement.clientWidth)\\n    );\\n  }\\n  let _ = {};\\n  function b(e, t) {\\n    _[e] = t;\\n  }\\n  function d(e) {\\n    return e ? _[e] : _;\\n  }\\n  function F() {\\n    _ = {};\\n  }\\n  let T = {};\\n  function I(e, t) {\\n    T[e] = t;\\n  }\\n  function L(e) {\\n    var t;\\n    (t = T[e]) == null || t.call(T);\\n  }\\n  function se() {\\n    T = {};\\n  }\\n  function ae(e, t, o, n) {\\n    let p = d('__activeStagePosition');\\n    const a = p || o.getBoundingClientRect(),\\n      f = n.getBoundingClientRect(),\\n      w = W(e, a.x, f.x - a.x, t),\\n      i = W(e, a.y, f.y - a.y, t),\\n      h = W(e, a.width, f.width - a.width, t),\\n      r = W(e, a.height, f.height - a.height, t);\\n    (p = { x: w, y: i, width: h, height: r }),\\n      V(p),\\n      b('__activeStagePosition', p);\\n  }\\n  function q(e) {\\n    if (!e) return;\\n    const t = e.getBoundingClientRect(),\\n      o = { x: t.x, y: t.y, width: t.width, height: t.height };\\n    b('__activeStagePosition', o), V(o);\\n  }\\n  function le() {\\n    const e = d('__activeStagePosition'),\\n      t = d('__overlaySvg');\\n    if (!e) return;\\n    if (!t) {\\n      console.warn('No stage svg found.');\\n      return;\\n    }\\n    const o = window.innerWidth,\\n      n = window.innerHeight;\\n    t.setAttribute('viewBox', `0 0 ${o} ${n}`);\\n  }\\n  function ce(e) {\\n    const t = de(e);\\n    document.body.appendChild(t),\\n      K(t, o => {\\n        o.target.tagName === 'path' && L('overlayClick');\\n      }),\\n      b('__overlaySvg', t);\\n  }\\n  function V(e) {\\n    const t = d('__overlaySvg');\\n    if (!t) {\\n      ce(e);\\n      return;\\n    }\\n    const o = t.firstElementChild;\\n    if ((o == null ? void 0 : o.tagName) !== 'path')\\n      throw new Error('no path element found in stage svg');\\n    o.setAttribute('d', X(e));\\n  }\\n  function de(e) {\\n    const t = window.innerWidth,\\n      o = window.innerHeight,\\n      n = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\\n    n.classList.add('driver-overlay', 'driver-overlay-animated'),\\n      n.setAttribute('viewBox', `0 0 ${t} ${o}`),\\n      n.setAttribute('xmlSpace', 'preserve'),\\n      n.setAttribute('xmlnsXlink', 'http://www.w3.org/1999/xlink'),\\n      n.setAttribute('version', '1.1'),\\n      n.setAttribute('preserveAspectRatio', 'xMinYMin slice'),\\n      (n.style.fillRule = 'evenodd'),\\n      (n.style.clipRule = 'evenodd'),\\n      (n.style.strokeLinejoin = 'round'),\\n      (n.style.strokeMiterlimit = '2'),\\n      (n.style.zIndex = '10000'),\\n      (n.style.position = 'fixed'),\\n      (n.style.top = '0'),\\n      (n.style.left = '0'),\\n      (n.style.width = '100%'),\\n      (n.style.height = '100%');\\n    const p = document.createElementNS('http://www.w3.org/2000/svg', 'path');\\n    return (\\n      p.setAttribute('d', X(e)),\\n      (p.style.fill = s('overlayColor') || 'rgb(0,0,0)'),\\n      (p.style.opacity = `${s('overlayOpacity')}`),\\n      (p.style.pointerEvents = 'auto'),\\n      (p.style.cursor = 'auto'),\\n      n.appendChild(p),\\n      n\\n    );\\n  }\\n  function X(e) {\\n    const t = window.innerWidth,\\n      o = window.innerHeight,\\n      n = s('stagePadding') || 0,\\n      p = s('stageRadius') || 0,\\n      a = e.width + n * 2,\\n      f = e.height + n * 2,\\n      w = Math.min(p, a / 2, f / 2),\\n      i = Math.floor(Math.max(w, 0)),\\n      h = e.x - n + i,\\n      r = e.y - n,\\n      l = a - i * 2,\\n      c = f - i * 2;\\n    return `M${t},0L0,0L0,${o}L${t},${o}L${t},0Z\\n    M${h},${r} h${l} a${i},${i} 0 0 1 ${i},${i} v${c} a${i},${i} 0 0 1 -${i},${i} h-${l} a${i},${i} 0 0 1 -${i},-${i} v-${c} a${i},${i} 0 0 1 ${i},-${i} z`;\\n  }\\n  function pe() {\\n    const e = d('__overlaySvg');\\n    e && e.remove();\\n  }\\n  function ue() {\\n    const e = document.getElementById('driver-dummy-element');\\n    if (e) return e;\\n    let t = document.createElement('div');\\n    return (\\n      (t.id = 'driver-dummy-element'),\\n      (t.style.width = '0'),\\n      (t.style.height = '0'),\\n      (t.style.pointerEvents = 'none'),\\n      (t.style.opacity = '0'),\\n      (t.style.position = 'fixed'),\\n      (t.style.top = '50%'),\\n      (t.style.left = '50%'),\\n      document.body.appendChild(t),\\n      t\\n    );\\n  }\\n  function Y(e) {\\n    const { element: t } = e;\\n    let o = typeof t == 'string' ? document.querySelector(t) : t;\\n    o || (o = ue()), he(o, e);\\n  }\\n  function ve() {\\n    const e = d('activeElement'),\\n      t = d('activeStep');\\n    e && (q(e), le(), U(e, t));\\n  }\\n  function he(e, t) {\\n    const n = Date.now(),\\n      p = d('activeStep'),\\n      a = d('activeElement') || e,\\n      f = !a || a === e,\\n      w = e.id === 'driver-dummy-element',\\n      i = a.id === 'driver-dummy-element',\\n      h = s('animate'),\\n      r = t.onHighlightStarted || s('onHighlightStarted'),\\n      l = (t == null ? void 0 : t.onHighlighted) || s('onHighlighted'),\\n      c = (p == null ? void 0 : p.onDeselected) || s('onDeselected'),\\n      m = s(),\\n      g = d();\\n    !f && c && c(i ? void 0 : a, p, { config: m, state: g }),\\n      r && r(w ? void 0 : e, t, { config: m, state: g });\\n    const u = !f && h;\\n    let v = !1;\\n    me();\\n    const P = () => {\\n      if (d('__transitionCallback') !== P) return;\\n      const k = Date.now() - n,\\n        y = 400 - k <= 400 / 2;\\n      t.popover && y && !v && u && (Q(e, t), (v = !0)),\\n        s('animate') && k < 400\\n          ? ae(k, 400, a, e)\\n          : (q(e),\\n            l && l(w ? void 0 : e, t, { config: s(), state: d() }),\\n            b('__transitionCallback', void 0),\\n            b('previousStep', p),\\n            b('previousElement', a),\\n            b('activeStep', t),\\n            b('activeElement', e)),\\n        window.requestAnimationFrame(P);\\n    };\\n    b('__transitionCallback', P),\\n      window.requestAnimationFrame(P),\\n      D(e),\\n      !u && t.popover && Q(e, t),\\n      a.classList.remove('driver-active-element'),\\n      e.classList.add('driver-active-element');\\n  }\\n  function fe() {\\n    var e;\\n    (e = document.getElementById('driver-dummy-element')) == null || e.remove(),\\n      document.querySelectorAll('.driver-active-element').forEach(t => {\\n        t.classList.remove('driver-active-element');\\n      });\\n  }\\n  function $() {\\n    const e = d('__resizeTimeout');\\n    e && window.cancelAnimationFrame(e),\\n      b('__resizeTimeout', window.requestAnimationFrame(ve));\\n  }\\n  function j(e) {\\n    s('allowKeyboardControl');\\n    e.key === 'Escape'\\n      ? L('escapePress')\\n      : e.key === 'ArrowRight'\\n      ? L('arrowRightPress')\\n      : e.key === 'ArrowLeft' && L('arrowLeftPress');\\n  }\\n  function K(e, t, o) {\\n    const n = (a, f) => {\\n      const w = a.target;\\n      e.contains(w) &&\\n        ((!o || o(w)) &&\\n          (a.preventDefault(),\\n          a.stopPropagation(),\\n          a.stopImmediatePropagation()),\\n        f == null || f(a));\\n    };\\n    document.addEventListener('pointerdown', n, !0),\\n      document.addEventListener('mousedown', n, !0),\\n      document.addEventListener('pointerup', n, !0),\\n      document.addEventListener('mouseup', n, !0),\\n      document.addEventListener(\\n        'click',\\n        a => {\\n          n(a, t);\\n        },\\n        !0,\\n      );\\n  }\\n  function ge() {\\n    window.addEventListener('keyup', j, !1),\\n      window.addEventListener('resize', $),\\n      window.addEventListener('scroll', $);\\n  }\\n  function we() {\\n    window.removeEventListener('keyup', j),\\n      window.removeEventListener('resize', $),\\n      window.removeEventListener('scroll', $);\\n  }\\n  function me() {\\n    const e = d('popover');\\n    e && (e.wrapper.style.display = 'none');\\n  }\\n  function Q(e, t) {\\n    var k, C;\\n    let o = d('popover');\\n    o && document.body.removeChild(o.wrapper),\\n      (o = xe()),\\n      document.body.appendChild(o.wrapper);\\n    const {\\n      title: n,\\n      description: p,\\n      showButtons: a,\\n      disableButtons: f,\\n      showProgress: w,\\n      nextBtnText: i = s('nextBtnText') || 'Next &rarr;',\\n      prevBtnText: h = s('prevBtnText') || '&larr; Previous',\\n      progressText: r = s('progressText') || '{current} of {total}',\\n    } = t.popover || {};\\n    (o.nextButton.innerHTML = i),\\n      (o.previousButton.innerHTML = h),\\n      (o.progress.innerHTML = r),\\n      n\\n        ? ((o.title.innerText = n), (o.title.style.display = 'block'))\\n        : (o.title.style.display = 'none'),\\n      p\\n        ? ((o.description.innerHTML = p),\\n          (o.description.style.display = 'block'))\\n        : (o.description.style.display = 'none');\\n    const l = a || s('showButtons'),\\n      c = w || s('showProgress') || !1,\\n      m =\\n        (l == null ? void 0 : l.includes('next')) ||\\n        (l == null ? void 0 : l.includes('previous')) ||\\n        c;\\n    (o.closeButton.style.display = l.includes('close') ? 'block' : 'none'),\\n      m\\n        ? ((o.footer.style.display = 'flex'),\\n          (o.progress.style.display = c ? 'block' : 'none'),\\n          (o.nextButton.style.display = l.includes('next') ? 'block' : 'none'),\\n          (o.previousButton.style.display = l.includes('previous')\\n            ? 'block'\\n            : 'none'))\\n        : (o.footer.style.display = 'none');\\n    const g = f || s('disableButtons') || [];\\n    g != null &&\\n      g.includes('next') &&\\n      o.nextButton.classList.add('driver-popover-btn-disabled'),\\n      g != null &&\\n        g.includes('previous') &&\\n        o.previousButton.classList.add('driver-popover-btn-disabled'),\\n      g != null &&\\n        g.includes('close') &&\\n        o.closeButton.classList.add('driver-popover-btn-disabled');\\n    const u = o.wrapper;\\n    (u.style.display = 'block'),\\n      (u.style.left = ''),\\n      (u.style.top = ''),\\n      (u.style.bottom = ''),\\n      (u.style.right = '');\\n    const v = o.arrow;\\n    v.className = 'driver-popover-arrow';\\n    const P =\\n      ((k = t.popover) == null ? void 0 : k.popoverClass) ||\\n      s('popoverClass') ||\\n      '';\\n    (u.className = `driver-popover ${P}`.trim()),\\n      K(\\n        o.wrapper,\\n        y => {\\n          var A, M, R;\\n          const x = y.target,\\n            H =\\n              ((A = t.popover) == null ? void 0 : A.onNextClick) ||\\n              s('onNextClick'),\\n            E =\\n              ((M = t.popover) == null ? void 0 : M.onPrevClick) ||\\n              s('onPrevClick'),\\n            B =\\n              ((R = t.popover) == null ? void 0 : R.onCloseClick) ||\\n              s('onCloseClick');\\n          if (x.classList.contains('driver-popover-next-btn'))\\n            return H ? H(e, t, { config: s(), state: d() }) : L('nextClick');\\n          if (x.classList.contains('driver-popover-prev-btn'))\\n            return E ? E(e, t, { config: s(), state: d() }) : L('prevClick');\\n          if (x.classList.contains('driver-popover-close-btn'))\\n            return B ? B(e, t, { config: s(), state: d() }) : L('closeClick');\\n        },\\n        y =>\\n          !(o != null && o.description.contains(y)) &&\\n          !(o != null && o.title.contains(y)) &&\\n          y.className.includes('driver-popover'),\\n      ),\\n      b('popover', o);\\n    const S =\\n      ((C = t.popover) == null ? void 0 : C.onPopoverRender) ||\\n      s('onPopoverRender');\\n    S && S(o, { config: s(), state: d() }), U(e, t), D(u);\\n  }\\n  function Z() {\\n    const e = d('popover');\\n    if (!(e != null && e.wrapper)) return;\\n    const t = e.wrapper.getBoundingClientRect(),\\n      o = s('stagePadding') || 0,\\n      n = s('popoverOffset') || 0;\\n    return {\\n      width: t.width + o + n,\\n      height: t.height + o + n,\\n      realWidth: t.width,\\n      realHeight: t.height,\\n    };\\n  }\\n  function G(e, t) {\\n    const {\\n      elementDimensions: o,\\n      popoverDimensions: n,\\n      popoverPadding: p,\\n      popoverArrowDimensions: a,\\n    } = t;\\n    return e === 'start'\\n      ? Math.max(\\n          Math.min(o.top - p, window.innerHeight - n.realHeight - a.width),\\n          a.width,\\n        )\\n      : e === 'end'\\n      ? Math.max(\\n          Math.min(\\n            o.top - (n == null ? void 0 : n.realHeight) + o.height + p,\\n            window.innerHeight - (n == null ? void 0 : n.realHeight) - a.width,\\n          ),\\n          a.width,\\n        )\\n      : e === 'center'\\n      ? Math.max(\\n          Math.min(\\n            o.top + o.height / 2 - (n == null ? void 0 : n.realHeight) / 2,\\n            window.innerHeight - (n == null ? void 0 : n.realHeight) - a.width,\\n          ),\\n          a.width,\\n        )\\n      : 0;\\n  }\\n  function J(e, t) {\\n    const {\\n      elementDimensions: o,\\n      popoverDimensions: n,\\n      popoverPadding: p,\\n      popoverArrowDimensions: a,\\n    } = t;\\n    return e === 'start'\\n      ? Math.max(\\n          Math.min(o.left - p, window.innerWidth - n.realWidth - a.width),\\n          a.width,\\n        )\\n      : e === 'end'\\n      ? Math.max(\\n          Math.min(\\n            o.left - (n == null ? void 0 : n.realWidth) + o.width + p,\\n            window.innerWidth - (n == null ? void 0 : n.realWidth) - a.width,\\n          ),\\n          a.width,\\n        )\\n      : e === 'center'\\n      ? Math.max(\\n          Math.min(\\n            o.left + o.width / 2 - (n == null ? void 0 : n.realWidth) / 2,\\n            window.innerWidth - (n == null ? void 0 : n.realWidth) - a.width,\\n          ),\\n          a.width,\\n        )\\n      : 0;\\n  }\\n  function U(e, t) {\\n    const o = d('popover');\\n    if (!o) return;\\n    const { align: n = 'start', side: p = 'left' } =\\n        (t == null ? void 0 : t.popover) || {},\\n      a = n,\\n      f = e.id === 'driver-dummy-element' ? 'over' : p,\\n      w = s('stagePadding') || 0,\\n      i = Z(),\\n      h = o.arrow.getBoundingClientRect(),\\n      r = e.getBoundingClientRect(),\\n      l = r.top - i.height;\\n    let c = l >= 0;\\n    const m = window.innerHeight - (r.bottom + i.height);\\n    let g = m >= 0;\\n    const u = r.left - i.width;\\n    let v = u >= 0;\\n    const P = window.innerWidth - (r.right + i.width);\\n    let S = P >= 0;\\n    const k = !c && !g && !v && !S;\\n    let C = f;\\n    if (\\n      (f === 'top' && c\\n        ? (S = v = g = !1)\\n        : f === 'bottom' && g\\n        ? (S = v = c = !1)\\n        : f === 'left' && v\\n        ? (S = c = g = !1)\\n        : f === 'right' && S && (v = c = g = !1),\\n      f === 'over')\\n    ) {\\n      const y = window.innerWidth / 2 - i.realWidth / 2,\\n        x = window.innerHeight / 2 - i.realHeight / 2;\\n      (o.wrapper.style.left = `${y}px`),\\n        (o.wrapper.style.right = 'auto'),\\n        (o.wrapper.style.top = `${x}px`),\\n        (o.wrapper.style.bottom = 'auto');\\n    } else if (k) {\\n      const y = window.innerWidth / 2 - (i == null ? void 0 : i.realWidth) / 2,\\n        x = 10;\\n      (o.wrapper.style.left = `${y}px`),\\n        (o.wrapper.style.right = 'auto'),\\n        (o.wrapper.style.bottom = `${x}px`),\\n        (o.wrapper.style.top = 'auto');\\n    } else if (v) {\\n      const y = Math.min(\\n          u,\\n          window.innerWidth - (i == null ? void 0 : i.realWidth) - h.width,\\n        ),\\n        x = G(a, {\\n          elementDimensions: r,\\n          popoverDimensions: i,\\n          popoverPadding: w,\\n          popoverArrowDimensions: h,\\n        });\\n      (o.wrapper.style.left = `${y}px`),\\n        (o.wrapper.style.top = `${x}px`),\\n        (o.wrapper.style.bottom = 'auto'),\\n        (o.wrapper.style.right = 'auto'),\\n        (C = 'left');\\n    } else if (S) {\\n      const y = Math.min(\\n          P,\\n          window.innerWidth - (i == null ? void 0 : i.realWidth) - h.width,\\n        ),\\n        x = G(a, {\\n          elementDimensions: r,\\n          popoverDimensions: i,\\n          popoverPadding: w,\\n          popoverArrowDimensions: h,\\n        });\\n      (o.wrapper.style.right = `${y}px`),\\n        (o.wrapper.style.top = `${x}px`),\\n        (o.wrapper.style.bottom = 'auto'),\\n        (o.wrapper.style.left = 'auto'),\\n        (C = 'right');\\n    } else if (c) {\\n      const y = Math.min(l, window.innerHeight - i.realHeight - h.width);\\n      let x = J(a, {\\n        elementDimensions: r,\\n        popoverDimensions: i,\\n        popoverPadding: w,\\n        popoverArrowDimensions: h,\\n      });\\n      (o.wrapper.style.top = `${y}px`),\\n        (o.wrapper.style.left = `${x}px`),\\n        (o.wrapper.style.bottom = 'auto'),\\n        (o.wrapper.style.right = 'auto'),\\n        (C = 'top');\\n    } else if (g) {\\n      const y = Math.min(\\n        m,\\n        window.innerHeight - (i == null ? void 0 : i.realHeight) - h.width,\\n      );\\n      let x = J(a, {\\n        elementDimensions: r,\\n        popoverDimensions: i,\\n        popoverPadding: w,\\n        popoverArrowDimensions: h,\\n      });\\n      (o.wrapper.style.left = `${x}px`),\\n        (o.wrapper.style.bottom = `${y}px`),\\n        (o.wrapper.style.top = 'auto'),\\n        (o.wrapper.style.right = 'auto'),\\n        (C = 'bottom');\\n    }\\n    k ? o.arrow.classList.add('driver-popover-arrow-none') : ye(a, C, e);\\n  }\\n  function ye(e, t, o) {\\n    const n = d('popover');\\n    if (!n) return;\\n    const p = o.getBoundingClientRect(),\\n      a = Z(),\\n      f = n.arrow,\\n      w = a.width,\\n      i = window.innerWidth,\\n      h = p.width,\\n      r = p.left,\\n      l = a.height,\\n      c = window.innerHeight,\\n      m = p.top,\\n      g = p.height;\\n    f.className = 'driver-popover-arrow';\\n    let u = t,\\n      v = e;\\n    t === 'top'\\n      ? (r + h <= 0\\n          ? ((u = 'right'), (v = 'end'))\\n          : r + h - w <= 0 && ((u = 'top'), (v = 'start')),\\n        r >= i\\n          ? ((u = 'left'), (v = 'end'))\\n          : r + w >= i && ((u = 'top'), (v = 'end')))\\n      : t === 'bottom'\\n      ? (r + h <= 0\\n          ? ((u = 'right'), (v = 'start'))\\n          : r + h - w <= 0 && ((u = 'bottom'), (v = 'start')),\\n        r >= i\\n          ? ((u = 'left'), (v = 'start'))\\n          : r + w >= i && ((u = 'bottom'), (v = 'end')))\\n      : t === 'left'\\n      ? (m + g <= 0\\n          ? ((u = 'bottom'), (v = 'end'))\\n          : m + g - l <= 0 && ((u = 'left'), (v = 'start')),\\n        m >= c\\n          ? ((u = 'top'), (v = 'end'))\\n          : m + l >= c && ((u = 'left'), (v = 'end')))\\n      : t === 'right' &&\\n        (m + g <= 0\\n          ? ((u = 'bottom'), (v = 'start'))\\n          : m + g - l <= 0 && ((u = 'right'), (v = 'start')),\\n        m >= c\\n          ? ((u = 'top'), (v = 'start'))\\n          : m + l >= c && ((u = 'right'), (v = 'end'))),\\n      u\\n        ? (f.classList.add(`driver-popover-arrow-side-${u}`),\\n          f.classList.add(`driver-popover-arrow-align-${v}`))\\n        : f.classList.add('driver-popover-arrow-none');\\n  }\\n  function xe() {\\n    const e = document.createElement('div');\\n    e.classList.add('driver-popover');\\n    const t = document.createElement('div');\\n    t.classList.add('driver-popover-arrow');\\n    const o = document.createElement('div');\\n    o.classList.add('driver-popover-title'),\\n      (o.style.display = 'none'),\\n      (o.innerText = 'Popover Title');\\n    const n = document.createElement('div');\\n    n.classList.add('driver-popover-description'),\\n      (n.style.display = 'none'),\\n      (n.innerText = 'Popover description is here');\\n    const p = document.createElement('button');\\n    p.classList.add('driver-popover-close-btn'), (p.innerHTML = '&times;');\\n    const a = document.createElement('div');\\n    a.classList.add('driver-popover-footer');\\n    const f = document.createElement('span');\\n    f.classList.add('driver-popover-progress-text'), (f.innerText = '');\\n    const w = document.createElement('span');\\n    w.classList.add('driver-popover-navigation-btns');\\n    const i = document.createElement('button');\\n    i.classList.add('driver-popover-prev-btn'),\\n      (i.innerHTML = '&larr; Previous');\\n    const h = document.createElement('button');\\n    return (\\n      h.classList.add('driver-popover-next-btn'),\\n      (h.innerHTML = 'Next &rarr;'),\\n      w.appendChild(i),\\n      w.appendChild(h),\\n      a.appendChild(f),\\n      a.appendChild(w),\\n      e.appendChild(p),\\n      e.appendChild(t),\\n      e.appendChild(o),\\n      e.appendChild(n),\\n      e.appendChild(a),\\n      {\\n        wrapper: e,\\n        arrow: t,\\n        title: o,\\n        description: n,\\n        footer: a,\\n        previousButton: i,\\n        nextButton: h,\\n        closeButton: p,\\n        footerButtons: w,\\n        progress: f,\\n      }\\n    );\\n  }\\n  function Ce() {\\n    var t;\\n    const e = d('popover');\\n    e && ((t = e.wrapper.parentElement) == null || t.removeChild(e.wrapper));\\n  }\\n  const Se = '';\\n  function be(e = {}) {\\n    z(e);\\n    function t() {\\n      s('allowClose') && h();\\n    }\\n    function o() {\\n      const r = d('activeIndex'),\\n        l = s('steps') || [];\\n      if (typeof r > 'u') return;\\n      const c = r + 1;\\n      l[c] ? i(c) : h();\\n    }\\n    function n() {\\n      const r = d('activeIndex'),\\n        l = s('steps') || [];\\n      if (typeof r > 'u') return;\\n      const c = r - 1;\\n      l[c] ? i(c) : h();\\n    }\\n    function p(r) {\\n      (s('steps') || [])[r] ? i(r) : h();\\n    }\\n    function a() {\\n      var v;\\n      if (d('__transitionCallback')) return;\\n      const l = d('activeIndex'),\\n        c = d('activeStep'),\\n        m = d('activeElement');\\n      if (typeof l > 'u' || typeof c > 'u' || typeof d('activeIndex') > 'u')\\n        return;\\n      const u =\\n        ((v = c.popover) == null ? void 0 : v.onPrevClick) || s('onPrevClick');\\n      if (u) return u(m, c, { config: s(), state: d() });\\n      n();\\n    }\\n    function f() {\\n      var u;\\n      if (d('__transitionCallback')) return;\\n      const l = d('activeIndex'),\\n        c = d('activeStep'),\\n        m = d('activeElement');\\n      if (typeof l > 'u' || typeof c > 'u') return;\\n      const g =\\n        ((u = c.popover) == null ? void 0 : u.onNextClick) || s('onNextClick');\\n      if (g) return g(m, c, { config: s(), state: d() });\\n      o();\\n    }\\n    function w() {\\n      d('isInitialized') ||\\n        (b('isInitialized', !0),\\n        document.body.classList.add(\\n          'driver-active',\\n          s('animate') ? 'driver-fade' : 'driver-simple',\\n        ),\\n        ge(),\\n        I('overlayClick', t),\\n        I('escapePress', t),\\n        I('arrowLeftPress', a),\\n        I('arrowRightPress', f));\\n    }\\n    function i(r = 0) {\\n      var B, A, M, R, ee, te, oe, ne;\\n      const l = s('steps');\\n      if (!l) {\\n        console.error('No steps to drive through'), h();\\n        return;\\n      }\\n      if (!l[r]) {\\n        h();\\n        return;\\n      }\\n      b('activeIndex', r);\\n      const c = l[r],\\n        m = l[r + 1],\\n        g = l[r - 1],\\n        u =\\n          ((B = c.popover) == null ? void 0 : B.doneBtnText) ||\\n          s('doneBtnText') ||\\n          'Done',\\n        v = s('allowClose'),\\n        P =\\n          typeof ((A = c.popover) == null ? void 0 : A.showProgress) < 'u'\\n            ? (M = c.popover) == null\\n              ? void 0\\n              : M.showProgress\\n            : s('showProgress'),\\n        k = (\\n          ((R = c.popover) == null ? void 0 : R.progressText) ||\\n          s('progressText') ||\\n          '{{current}} of {{total}}'\\n        )\\n          .replace('{{current}}', `${r + 1}`)\\n          .replace('{{total}}', `${l.length}`),\\n        C =\\n          ((ee = c.popover) == null ? void 0 : ee.showButtons) ||\\n          s('showButtons'),\\n        y = ['next', 'previous', ...(v ? ['close'] : [])].filter(\\n          Pe => !(C != null && C.length) || C.includes(Pe),\\n        ),\\n        x =\\n          ((te = c.popover) == null ? void 0 : te.onNextClick) ||\\n          s('onNextClick'),\\n        H =\\n          ((oe = c.popover) == null ? void 0 : oe.onPrevClick) ||\\n          s('onPrevClick'),\\n        E =\\n          ((ne = c.popover) == null ? void 0 : ne.onCloseClick) ||\\n          s('onCloseClick');\\n      Y({\\n        ...c,\\n        popover: {\\n          showButtons: y,\\n          nextBtnText: m ? void 0 : u,\\n          disableButtons: [...(g ? [] : ['previous'])],\\n          showProgress: P,\\n          progressText: k,\\n          onNextClick:\\n            x ||\\n            (() => {\\n              m ? i(r + 1) : h();\\n            }),\\n          onPrevClick:\\n            H ||\\n            (() => {\\n              i(r - 1);\\n            }),\\n          onCloseClick:\\n            E ||\\n            (() => {\\n              h();\\n            }),\\n          ...((c == null ? void 0 : c.popover) || {}),\\n        },\\n      });\\n    }\\n    function h(r = !0) {\\n      const l = d('activeElement'),\\n        c = d('activeStep'),\\n        m = s('onDestroyStarted');\\n      if (r && m) {\\n        const v = !l || (l == null ? void 0 : l.id) === 'driver-dummy-element';\\n        m(v ? void 0 : l, c, { config: s(), state: d() });\\n        return;\\n      }\\n      const g = (c == null ? void 0 : c.onDeselected) || s('onDeselected'),\\n        u = s('onDestroyed');\\n      if (\\n        (document.body.classList.remove(\\n          'driver-active',\\n          'driver-fade',\\n          'driver-simple',\\n        ),\\n        we(),\\n        Ce(),\\n        fe(),\\n        pe(),\\n        se(),\\n        F(),\\n        l && c)\\n      ) {\\n        const v = l.id === 'driver-dummy-element';\\n        g && g(v ? void 0 : l, c, { config: s(), state: d() }),\\n          u && u(v ? void 0 : l, c, { config: s(), state: d() });\\n      }\\n    }\\n    return {\\n      isActive: () => d('isInitialized') || !1,\\n      refresh: $,\\n      drive: (r = 0) => {\\n        w(), i(r);\\n      },\\n      setConfig: z,\\n      setSteps: r => {\\n        F(), z({ ...s(), steps: r });\\n      },\\n      getConfig: s,\\n      getState: d,\\n      getActiveIndex: () => d('activeIndex'),\\n      isFirstStep: () => d('activeIndex') === 0,\\n      isLastStep: () => {\\n        const r = s('steps') || [],\\n          l = d('activeIndex');\\n        return l !== void 0 && l === r.length - 1;\\n      },\\n      getActiveStep: () => d('activeStep'),\\n      getActiveElement: () => d('activeElement'),\\n      getPreviousElement: () => d('previousElement'),\\n      getPreviousStep: () => d('previousStep'),\\n      moveNext: o,\\n      movePrevious: n,\\n      moveTo: p,\\n      hasNextStep: () => {\\n        const r = s('steps') || [],\\n          l = d('activeIndex');\\n        return l !== void 0 && r[l + 1];\\n      },\\n      hasPreviousStep: () => {\\n        const r = s('steps') || [],\\n          l = d('activeIndex');\\n        return l !== void 0 && r[l - 1];\\n      },\\n      highlight: r => {\\n        w(),\\n          Y({\\n            ...r,\\n            popover: r.popover\\n              ? {\\n                  showButtons: [],\\n                  showProgress: !1,\\n                  progressText: '',\\n                  ...r.popover,\\n                }\\n              : void 0,\\n          });\\n      },\\n      destroy: () => {\\n        h(!1);\\n      },\\n    };\\n  }\\n  return (\\n    (N.driver = be),\\n    Object.defineProperty(N, Symbol.toStringTag, { value: 'Module' }),\\n    N\\n  );\\n})({});\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-tour/tour.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tour/tour.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tour/tour.js\\ntype: application/javascript\\nmodule-type: library\\n\\ntour 🪧\\n\\\\*/\\nmodule.exports={tour:function(){const e=[{element:document.querySelector(\\\"center\\\"),popover:{title:\\\"TiddlyWiki 主页展示\\\",description:\\\"自定义 TiddlyWiki 主页展示\\\",position:\\\"left\\\"}},{element:\\\"#stx-story-top\\\",popover:{title:\\\"侧边工具栏\\\",description:\\\"自定义工具栏\\\",position:\\\"left\\\"}},{element:document.querySelector('[aria-label=\\\"player\\\"]'),popover:{title:\\\"Player\\\",description:\\\"音乐播放器\\\",position:\\\"left\\\"}},{element:document.querySelector('[aria-label=\\\"home\\\"]'),popover:{title:\\\"Home\\\",description:\\\"进入故事河\\\",position:\\\"left\\\",onNextClick:()=>{confetti(),t.moveNext()}}}],t=driver({showProgress:!0,animate:!0,showButtons:[\\\"next\\\",\\\"previous\\\",\\\"close\\\"],allowClose:!1,steps:e});t.drive()}};\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-tour/tour.json\":{\"text\":\"[\\n  {\\n    \\\"element\\\": \\\"center\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"TiddlyWiki 主页展示\\\",\\n      \\\"description\\\": \\\"自定义 TiddlyWiki 主页展示\\\"\\n    }\\n  },\\n  {\\n    \\\"element\\\": \\\"#stx-story-top\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"侧边工具栏\\\",\\n      \\\"description\\\": \\\"自定义工具栏\\\"\\n    }\\n  },\\n  {\\n    \\\"element\\\": \\\"[aria-label=\\\\\\\"player\\\\\\\"]\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"Player\\\",\\n      \\\"description\\\": \\\"音乐播放器\\\"\\n    }\\n  },\\n  {\\n    \\\"element\\\": \\\"[aria-label=\\\\\\\"home\\\\\\\"]\\\",\\n    \\\"popover\\\": {\\n      \\\"title\\\": \\\"Home\\\",\\n      \\\"description\\\": \\\"故事河\\\"\\n    }\\n  }\\n]\\n\",\"type\":\"application/json\",\"title\":\"$:/plugins/oeyoews/neotw-tour/tour.json\"},\"$:/plugins/oeyoews/neotw-tour/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tour/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tour/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-tour widget\\n\\\\*/\\nconst{widget:t}=require(\\\"$:/core/modules/widgets/widget.js\\\");exports.tour=class extends t{constructor(t,e){super(t,e),this.steps=[]}render(t,e){if(!$tw.browser)return;if(this.document.isTiddlyWikiFakeDom)return;this.computeAttributes(),this.execute();const{tiddler:s=\\\"$:/plugins/oeyoews/neotw-tour/demo.json\\\",text:i=\\\"Tour Guide\\\"}=this.attributes;this.steps=$tw.wiki.getTiddlerData(s);const r=$tw.utils.domMaker(\\\"button\\\",{text:i,eventListeners:[{name:\\\"click\\\",handlerObject:this,handlerMethod:\\\"handlerClick\\\"}]});t.insertBefore(r,e),this.domNodes.push(r)}handlerClick(){driver({showProgress:!0,animate:!0,showButtons:[\\\"next\\\",\\\"previous\\\",\\\"close\\\"],allowClose:!0,steps:this.steps}).drive(),!this.steps&&this.highlightWarning()}highlightWarning(){driverObj.highlight({popover:{description:\\\"<img src='https://cdn-icons-png.flaticon.com/128/6598/6598519.png' style='height: 202.5px; width: 270px;' />\\\"}})}};\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}