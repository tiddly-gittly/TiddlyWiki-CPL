{"title":"$:/plugins/oeyoews/neotw-dialog","description":"neotw-dialog","author":"oeyoews","version":"0.0.1","core-version":">=5.3.4","type":"application/json","plugin-type":"plugin","name":"neotw-dialog","meat#disabled":"yes","qrcode":"yes","created":"20250223","dependents":"","stability":"STABILITY_2_STABLE","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-dialog/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-dialog/readme\",\"description\":\"neotw-dialog\",\"text\":\"[[在线文档|https://tiddlywiki-starter-kit.oeyoews.top/docs/plugins/neotw-dialog]]\"},\"$:/plugins/oeyoews/neotw-dialog/dialog.js\":{\"title\":\"$:/plugins/oeyoews/neotw-dialog/dialog.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-dialog/dialog.js\\ntype: application/javascript\\n// module-type: library\\nmodule-type: global\\n\\nneotw-dialog\\n\\n\\\\*/\\n\\n/**\\n * 弹出对话框\\n *\\n * @param {'confirm' | 'alert'' | 'prompt'} type - 弹窗类型\\n * @param {string} title - 弹窗标题\\n * @param {string} message - 弹窗消息\\n * @returns {Promise} - 弹窗关闭后的值\\n */\\nasync function showDialog(type, title, message) {\\n  return new Promise((resolve) => {\\n    // 创建遮罩层\\n    const overlay = document.createElement('div');\\n    overlay.className =\\n      'fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black bg-opacity-50 opacity-0 transition-opacity duration-300 cursor-pointer';\\n\\n    // 创建弹窗\\n    const modal = document.createElement('div');\\n    modal.className =\\n      'bg-white p-3 rounded-lg shadow-lg max-w-sm w-full transform scale-90 opacity-0 transition-all duration-300';\\n\\n    // 创建标题\\n    const titleElement = document.createElement('h2');\\n    titleElement.className = 'text-lg font-semibold mb-4 mt--';\\n    titleElement.textContent = title;\\n\\n    // 创建消息\\n    const messageElement = document.createElement('p');\\n    messageElement.className = 'mb-4';\\n    messageElement.textContent = message || '';\\n\\n    // 创建输入框（仅在prompt类型时需要）\\n    const inputElement =\\n      type === 'prompt' ? document.createElement('input') : null;\\n    if (inputElement) {\\n      inputElement.className =\\n        'w-full p-2 border rounded-sm mb-4 dark:bg-white';\\n      inputElement?.focus();\\n      inputElement.addEventListener('keydown', (event) => {\\n        // enter to close modal\\n        if (event.keyCode === 13) {\\n          event.preventDefault();\\n          closeDialog(inputElement.value);\\n        }\\n      });\\n    }\\n\\n    // 创建按钮容器\\n    const buttonContainer = document.createElement('div');\\n    buttonContainer.className = 'flex justify-end space-x-2';\\n\\n    // 创建确认按钮\\n    const confirmButton = document.createElement('button');\\n    confirmButton.className = 'px-4 py-2 bg-blue-500 text-white rounded';\\n    confirmButton.textContent = type === 'alert' ? '确定' : '确认';\\n\\n    // 创建取消按钮（仅在confirm和prompt类型时需要）\\n    const cancelButton =\\n      type !== 'alert' ? document.createElement('button') : null;\\n    if (cancelButton) {\\n      cancelButton.className = 'px-4 py-2 bg-gray-300 rounded';\\n      cancelButton.textContent = '取消';\\n    }\\n\\n    // 关闭弹窗的函数\\n    const closeDialog = (value) => {\\n      modal.classList.add('scale-90', 'opacity-0'); // 添加隐藏动画\\n      overlay.classList.add('opacity-0'); // 遮罩淡出\\n\\n      // 等待动画完成再移除\\n      modal.addEventListener(\\n        'transitionend',\\n        () => {\\n          document.body.removeChild(overlay);\\n          resolve(value);\\n        },\\n        { once: true },\\n      );\\n    };\\n\\n    // 按钮事件绑定\\n    confirmButton.onclick = () =>\\n      closeDialog(type === 'prompt' ? inputElement.value : true);\\n    if (cancelButton) cancelButton.onclick = () => closeDialog(false);\\n\\n    // 遮罩层点击关闭弹窗\\n    overlay.onclick = (e) => {\\n      if (e.target === overlay) closeDialog(null);\\n    };\\n\\n    // 组装DOM\\n    modal.appendChild(titleElement);\\n    modal.appendChild(messageElement);\\n    if (inputElement) modal.appendChild(inputElement);\\n    if (cancelButton) buttonContainer.appendChild(cancelButton);\\n    buttonContainer.appendChild(confirmButton);\\n    modal.appendChild(buttonContainer);\\n    overlay.appendChild(modal);\\n    document.body.appendChild(overlay);\\n\\n    // **触发进入动画**\\n    requestAnimationFrame(() => {\\n      overlay.classList.remove('opacity-0');\\n      modal.classList.remove('scale-90', 'opacity-0');\\n    });\\n  });\\n}\\n\\nexports.showDialog = showDialog;\\n\",\"type\":\"application/javascript\",\"// module-type\":\"library\",\"module-type\":\"global\"},\"$:/plugins/oeyoews/neotw-dialog/startup.js\":{\"title\":\"$:/plugins/oeyoews/neotw-dialog/startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-dialog/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nneotw-dialog startup\\n\\n\\\\*/\\n\\nexports.name = 'neotw-dialog-startup-hook';\\nexports.platforms = ['browser'];\\nexports.after = ['startup'];\\nexports.synchronous = true;\\nexports.startup = () => {\\n  // your code here\\n  console.log('neotw-dialog-startup-hook');\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-dialog/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-dialog/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-dialog/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-dialog widget\\n\\n\\\\*/\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\n\\nclass NeotwDialogWidget extends Widget {\\n  constructor(parseTreeNode, options) {\\n    super(parseTreeNode, options);\\n  }\\n\\n  render(parent, nextSibling) {\\n    if (!$tw.browser) return;\\n\\n    this.computeAttributes();\\n    this.execute();\\n\\n    const ssr = this.document.isTiddlyWikiFakeDom;\\n    if (ssr) return;\\n\\n    const createElement = $tw.utils.domMaker;\\n\\n    const btn = createElement('button', {\\n      text: 'Click me',\\n      class: 'rounded-sm p-1',\\n    });\\n\\n    const domNode = createElement('div', {\\n      // text: 'example',\\n      // class: 'underline font-bold',\\n      children: [btn],\\n    });\\n\\n    parent.insertBefore(domNode, nextSibling);\\n    this.domNodes.push(domNode);\\n  }\\n}\\n\\n/** @description neotw-dialog widget */\\nexports['widget-4a7vf1nw'] = NeotwDialogWidget;\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}