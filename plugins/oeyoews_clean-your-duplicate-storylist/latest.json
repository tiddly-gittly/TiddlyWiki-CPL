{"title":"$:/plugins/oeyoews/clean-your-duplicate-storylist","description":"clean-your-duplicate-storylist","author":"oeyoews","version":"0.0.1","core-version":">=5.3.4","type":"application/json","plugin-type":"plugin","name":"clean-your-duplicate-storylist","meat#disabled":"yes","qrcode":"yes","created":"2025/01-25","dependents":"","stability":"STABILITY_2_STABLE","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/clean-your-duplicate-storylist/readme\":{\"title\":\"$:/plugins/oeyoews/clean-your-duplicate-storylist/readme\",\"description\":\"clean-your-duplicate-storylist\",\"text\":\"[[在线文档|https://neotw.vercel.app/docs/plugins/clean-your-duplicate-storylist]]\"},\"$:/plugins/oeyoews/clean-your-duplicate-storylist/startup.js\":{\"title\":\"$:/plugins/oeyoews/clean-your-duplicate-storylist/startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/clean-your-duplicate-storylist/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\nclean-your-duplicate-storylist startup\\n\\n\\\\*/\\nexports.name = 'clean-your-duplicate-storylist';\\nexports.platforms = ['browser'];\\nexports.after = ['startup'];\\nexports.synchronous = true;\\n\\nexports.startup = () => {\\n  // 在线wiki不检测\\n  if (window.location.protocol === 'https:') return;\\n  // 页面加载完成后检查异常tid\\n  window.addEventListener('DOMContentLoaded', () => {\\n    // 找到所有 .tid 结尾的条目\\n    const filter = '[suffix[.tid]] [prefix[Draft]!has[draft.of]]';\\n    const maybeStoryListTiddlers = $tw.wiki.filterTiddlers(filter);\\n    const stateTiddler = '$:/state/clean-your-duplicate-storylist/has-error';\\n    if (maybeStoryListTiddlers.length > 1) {\\n      $tw.wiki.addTiddler({\\n        title: stateTiddler,\\n        class: 'o-tm',\\n        'mask-closable': 'yes',\\n        caption: 'StoryList条目检查',\\n        // <$link to=<<currentTiddler>> tooltip=\\\"Custom tooltip\\\"> </$link>\\n        text: `发现了${maybeStoryListTiddlers.length}个异常的条目, 点击查看详情.\\n      <ol>\\n        <$list filter=\\\"${filter}\\\" >\\n          <li> <<currentTiddler>> </li>\\n        </$list>\\n      </ol>\\n       `,\\n      });\\n      $tw.modal.display(stateTiddler);\\n      new $tw.Story().navigateTiddler('$:/AdvancedSearch');\\n    }\\n  });\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"}}}"}