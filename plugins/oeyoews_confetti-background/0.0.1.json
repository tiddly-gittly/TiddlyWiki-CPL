{"title":"$:/plugins/oeyoews/confetti-background","description":"confetti-background","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"confetti-background","meat#disabled":"yes","qrcode":"yes","created":"2023-12-30","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-v4","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/confetti-background/readme\":{\"title\":\"$:/plugins/oeyoews/confetti-background/readme\",\"text\":\"<!-- plugin template readme -->\\n\\n## Motivation\\n\\n- https://github.com/Agezao/confetti-js\\n\\n<!-- your plugin motivation, or why you write this plugin -->\\n\",\"type\":\"text/markdown\",\"description\":\"confetti-background\"},\"$:/plugins/oeyoews/confetti-background/confetti.min.js\":{\"title\":\"$:/plugins/oeyoews/confetti-background/confetti.min.js\",\"text\":\"!(function (e, t) {\\n  'object' == typeof exports && 'undefined' != typeof module\\n    ? (module.exports = t())\\n    : 'function' == typeof define && define.amd\\n    ? define(t)\\n    : ((e = e || self).ConfettiGenerator = t());\\n})(this, function () {\\n  'use strict';\\n  return function (e) {\\n    var a = {\\n      target: 'confetti-holder',\\n      max: 80,\\n      size: 1,\\n      animate: !0,\\n      respawn: !0,\\n      props: ['circle', 'square', 'triangle', 'line'],\\n      colors: [\\n        [165, 104, 246],\\n        [230, 61, 135],\\n        [0, 199, 228],\\n        [253, 214, 126],\\n      ],\\n      clock: 25,\\n      interval: null,\\n      rotate: !1,\\n      start_from_edge: !1,\\n      width: window.innerWidth,\\n      height: window.innerHeight,\\n    };\\n    if (\\n      (e &&\\n        (e.target && (a.target = e.target),\\n        e.max && (a.max = e.max),\\n        e.size && (a.size = e.size),\\n        null != e.animate && (a.animate = e.animate),\\n        null != e.respawn && (a.respawn = e.respawn),\\n        e.props && (a.props = e.props),\\n        e.colors && (a.colors = e.colors),\\n        e.clock && (a.clock = e.clock),\\n        null != e.start_from_edge && (a.start_from_edge = e.start_from_edge),\\n        e.width && (a.width = e.width),\\n        e.height && (a.height = e.height),\\n        null != e.rotate && (a.rotate = e.rotate)),\\n      'object' != typeof a.target && 'string' != typeof a.target)\\n    )\\n      throw new TypeError('The target parameter should be a node or string');\\n    if (\\n      ('object' == typeof a.target &&\\n        (null === a.target || !a.target instanceof HTMLCanvasElement)) ||\\n      ('string' == typeof a.target &&\\n        (null === document.getElementById(a.target) ||\\n          !document.getElementById(a.target) instanceof HTMLCanvasElement))\\n    )\\n      throw new ReferenceError(\\n        'The target element does not exist or is not a canvas element'\\n      );\\n    var t =\\n        'object' == typeof a.target\\n          ? a.target\\n          : document.getElementById(a.target),\\n      o = t.getContext('2d'),\\n      r = [];\\n    function n(e, t) {\\n      e = e || 1;\\n      var r = Math.random() * e;\\n      return t ? Math.floor(r) : r;\\n    }\\n    var i = a.props.reduce(function (e, t) {\\n      return e + (t.weight || 1);\\n    }, 0);\\n    function s() {\\n      var e =\\n        a.props[\\n          (function () {\\n            for (var e = Math.random() * i, t = 0; t < a.props.length; ++t) {\\n              var r = a.props[t].weight || 1;\\n              if (e < r) return t;\\n              e -= r;\\n            }\\n          })()\\n        ];\\n      return {\\n        prop: e.type ? e.type : e,\\n        x: n(a.width),\\n        y: a.start_from_edge\\n          ? a.clock < 0\\n            ? parseFloat(a.height) + 10\\n            : -10\\n          : n(a.height),\\n        src: e.src,\\n        radius: n(4) + 1,\\n        size: e.size,\\n        rotate: a.rotate,\\n        line: Math.floor(n(65) - 30),\\n        angles: [n(10, !0) + 2, n(10, !0) + 2, n(10, !0) + 2, n(10, !0) + 2],\\n        color: a.colors[n(a.colors.length, !0)],\\n        rotation: (n(360, !0) * Math.PI) / 180,\\n        speed: n(a.clock / 7) + a.clock / 30,\\n      };\\n    }\\n    function l(e) {\\n      if (e)\\n        switch (\\n          ((o.fillStyle = o.strokeStyle =\\n            'rgba(' + e.color + ', ' + (3 < e.radius ? 0.8 : 0.4) + ')'),\\n          o.beginPath(),\\n          e.prop)\\n        ) {\\n          case 'circle':\\n            o.moveTo(e.x, e.y),\\n              o.arc(e.x, e.y, e.radius * a.size, 0, 2 * Math.PI, !0),\\n              o.fill();\\n            break;\\n          case 'triangle':\\n            o.moveTo(e.x, e.y),\\n              o.lineTo(e.x + e.angles[0] * a.size, e.y + e.angles[1] * a.size),\\n              o.lineTo(e.x + e.angles[2] * a.size, e.y + e.angles[3] * a.size),\\n              o.closePath(),\\n              o.fill();\\n            break;\\n          case 'line':\\n            o.moveTo(e.x, e.y),\\n              o.lineTo(e.x + e.line * a.size, e.y + 5 * e.radius),\\n              (o.lineWidth = 2 * a.size),\\n              o.stroke();\\n            break;\\n          case 'square':\\n            o.save(),\\n              o.translate(e.x + 15, e.y + 5),\\n              o.rotate(e.rotation),\\n              o.fillRect(-15 * a.size, -5 * a.size, 15 * a.size, 5 * a.size),\\n              o.restore();\\n            break;\\n          case 'svg':\\n            o.save();\\n            var t = new window.Image();\\n            t.src = e.src;\\n            var r = e.size || 15;\\n            o.translate(e.x + r / 2, e.y + r / 2),\\n              e.rotate && o.rotate(e.rotation),\\n              o.drawImage(\\n                t,\\n                (-r / 2) * a.size,\\n                (-r / 2) * a.size,\\n                r * a.size,\\n                r * a.size\\n              ),\\n              o.restore();\\n        }\\n    }\\n    function c() {\\n      (a.animate = !1),\\n        clearInterval(a.interval),\\n        requestAnimationFrame(function () {\\n          o.clearRect(0, 0, t.width, t.height);\\n          var e = t.width;\\n          (t.width = 1), (t.width = e);\\n        });\\n    }\\n    return {\\n      render: function () {\\n        (t.width = a.width), (t.height = a.height), (r = []);\\n        for (var e = 0; e < a.max; e++) r.push(s());\\n        return requestAnimationFrame(function e() {\\n          for (var t in (o.clearRect(0, 0, a.width, a.height), r)) l(r[t]);\\n          !(function () {\\n            for (var e = 0; e < a.max; e++) {\\n              var t = r[e];\\n              t &&\\n                (a.animate && (t.y += t.speed),\\n                t.rotate && (t.rotation += t.speed / 35),\\n                ((0 <= t.speed && a.height < t.y) ||\\n                  (t.speed < 0 && t.y < 0)) &&\\n                  (a.respawn\\n                    ? ((r[e] = t),\\n                      (r[e].x = n(a.width, !0)),\\n                      (r[e].y = t.speed < 0 ? parseFloat(a.height) : -10))\\n                    : (r[e] = void 0)));\\n            }\\n            r.every(function (e) {\\n              return void 0 === e;\\n            }) && c();\\n          })(),\\n            a.animate && requestAnimationFrame(e);\\n        });\\n      },\\n      clear: c,\\n    };\\n  };\\n});\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/confetti-background/pageTemplate\":{\"title\":\"$:/plugins/oeyoews/confetti-background/pageTemplate\",\"tags\":\"$:/tags/PageTemplate\",\"text\":\"<div class=\\\"fixed inset-0 pointer-events-none print:hidden -z-10\\\">\\n\\t<$confettibg />\\n</div>\"},\"$:/plugins/oeyoews/confetti-background/widget.js\":{\"title\":\"$:/plugins/oeyoews/confetti-background/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/confetti-background/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nconfetti-background widget\\n\\n\\\\*/\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\n\\nclass ConfettiBgWidget extends Widget {\\n  constructor(parseTreeNode, options) {\\n    super(parseTreeNode, options);\\n  }\\n\\n  render(parent, nextSibling) {\\n    if (!$tw.browser) return;\\n\\n    this.computeAttributes();\\n    this.execute();\\n\\n    const ConfettiGenerator = require('./confetti.min.js');\\n\\n    const canvasNode = this.document.createElement('canvas');\\n    if (canvasNode.isTiddlyWikiFakeDom) return;\\n\\n    const {\\n      width = window.innerWidth,\\n      height = window.innerHeight,\\n      size = '0.8',\\n    } = this.attributes;\\n    const options = {\\n      target: canvasNode,\\n      max: '25',\\n      size,\\n      animate: true,\\n      props: ['circle'],\\n      colors: [\\n        [165, 104, 246],\\n        [230, 61, 135],\\n        [0, 199, 228],\\n        [253, 214, 126],\\n      ],\\n      clock: '3',\\n      rotate: true,\\n      start_from_edge: false,\\n      respawn: true,\\n      width,\\n      height,\\n    };\\n\\n    const confetti = new ConfettiGenerator(options);\\n    // confetti.clear()\\n    confetti.render();\\n\\n    parent.insertBefore(canvasNode, nextSibling);\\n    this.domNodes.push(canvasNode);\\n  }\\n\\n  refresh() {\\n    return false;\\n  }\\n}\\n\\n/**\\n * @description confetti-background widget\\n */\\nexports.confettibg = ConfettiBgWidget;\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}