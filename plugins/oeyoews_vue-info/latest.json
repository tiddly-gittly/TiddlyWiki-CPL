{"title":"$:/plugins/oeyoews/vue-info","description":"vue-info","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"vue-info","meat#disabled":"yes","qrcode":"yes","created":"2024-03-10","dependents":"$:/plugins/oeyoews/neotw-vue3","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/vue-info/templates/Text.vue\":{\"text\":\"<template>\\n\\t<!-- bg-gray-200 dark:bg-gray-700  -->\\n\\t<div class=\\\"flex items-center rounded-md px-2 py-1 shrink-0 cursor-pointer gap-1\\\"\\n\\t\\t:class=\\\"[`border-${color}-400/70`, 'border-[2px]','border-solid', `bg-${color}-500/20`]\\\">\\n\\t\\t<div v-html=\\\"icon\\\" class=\\\"flex\\\" />\\n\\t\\t<div class=\\\"font-semibold\\\" :class=\\\"[`text-${color}-500`]\\\">{{ text }}\\n\\t\\t</div>\\n\\t\\t<div class=\\\"text-sm text-gray-600 dark:text-gray-400\\\">\\n\\t\\t\\t<count-to :start-val=\\\"0\\\" :end-val=\\\"number\\\" :duration=\\\"2000\\\"></count-to>\\n\\t\\t</div>\\n\\t</div>\\n</template>\",\"title\":\"$:/plugins/oeyoews/vue-info/templates/Text.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/vue-info/templates/widget.vue\":{\"text\":\"<template>\\n  <div class=\\\"hidden md:flex items-center space-x-4 flex-wrap gap-2 justify-center text-sm mb-4 scale-75\\\"\\n    @click=\\\"gotoTiddler\\\">\\n    <Text v-for=\\\"(item, key) in textItems\\\" :key=\\\"key\\\" :text=\\\"item.text\\\" :color=\\\"item.color\\\" :number=\\\"item.number\\\"\\n      :icon=\\\"item.icon\\\" :data-title=\\\"item.title\\\" />\\n\\n  </div>\\n</template>\",\"title\":\"$:/plugins/oeyoews/vue-info/templates/widget.vue\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/vue-info/components/count.js\":{\"text\":\"const { onMounted, ref } = window.Vue;\\n\\nmodule.exports = {\\n  name: 'CountTo',\\n  props: {\\n    startVal: {\\n      type: [Number, String],\\n      default: 0,\\n    },\\n    endVal: {\\n      type: [Number, String],\\n      required: true,\\n    },\\n    duration: {\\n      type: Number,\\n      default: 2000,\\n    },\\n  },\\n  setup(props) {\\n    let currentVal = ref();\\n    if (typeof props.endVal !== 'number') {\\n      return {\\n        currentVal: props.endVal,\\n      };\\n    } else {\\n      currentVal.value = props.startVal;\\n    }\\n    onMounted(() => {\\n      const startTime = performance.now();\\n      const animate = (currentTime) => {\\n        const elapsedTime = currentTime - startTime;\\n        if (elapsedTime < props.duration) {\\n          const progress = elapsedTime / props.duration;\\n          currentVal.value = Math.round(\\n            props.startVal + (props.endVal - props.startVal) * progress,\\n          );\\n          requestAnimationFrame(animate);\\n        } else {\\n          currentVal.value = props.endVal.toLocaleString();\\n        }\\n      };\\n      requestAnimationFrame(animate);\\n    });\\n    return {\\n      currentVal,\\n    };\\n  },\\n  template: `<span>{{ currentVal }}</span>`,\\n};\\n\",\"title\":\"$:/plugins/oeyoews/vue-info/components/count.js\",\"module-type\":\"library\",\"type\":\"application/javascript\"},\"$:/plugins/oeyoews/vue-info/readme\":{\"title\":\"$:/plugins/oeyoews/vue-info/readme\",\"text\":\"<!-- plugin template readme -->\\n\\n<$vue-neotw-info />\\n\\n* 显示 tiddlywiki 的信息\\n\\n## Motivation\\n\\n<!-- your plugin motivation, or why you write this plugin -->\\n\",\"type\":\"text/markdown\",\"description\":\"vue-info\"},\"$:/plugins/oeyoews/vue-info/component.js\":{\"title\":\"$:/plugins/oeyoews/vue-info/component.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-info/component.js\\ntype: application/javascript\\nmodule-type: library\\n\\n\\\\*/\\n\\nconst { ref } = window.Vue;\\n\\nconst getTemplate = require('$:/plugins/oeyoews/neotw-vue3/getTemplate');\\n\\nconst goto = new $tw.Story();\\nconst getString = (filter) => {\\n  return $tw.wiki.filterTiddlers(filter);\\n};\\n\\nconst plugins = getString('[plugin-type[plugin]]').length;\\nconst tags = getString('[tags[]]').length;\\nconst version = $tw.version.replace(/-/g, ' ');\\nconst startup =\\n  $tw.wiki.getTiddler('_state-neotw-startup-times')?.fields?.times || 0;\\n\\nconst iinfo = `<svg\\n        xmlns=\\\"http://www.w3.org/2000/svg\\\"\\n        width=\\\"20\\\"\\n        height=\\\"20\\\"\\n        viewBox=\\\"0 0 24 24\\\"\\n        fill=\\\"none\\\"\\n        stroke=\\\"currentColor\\\"\\n        stroke-width=\\\"2\\\"\\n        stroke-linecap=\\\"round\\\"\\n        stroke-linejoin=\\\"round\\\"\\n        class=\\\"text-red-500\\\"\\n      >\\n        <circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"10\\\"></circle>\\n        <line x1=\\\"12\\\" x2=\\\"12\\\" y1=\\\"8\\\" y2=\\\"12\\\"></line>\\n        <line x1=\\\"12\\\" x2=\\\"12.01\\\" y1=\\\"16\\\" y2=\\\"16\\\"></line>\\n      </svg>`;\\n\\nconst iplugin = `<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"text-green-500\\\"\\n width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\"><path fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"2\\\" d=\\\"M16.75 6H20a1 1 0 0 1 1 1v3.25a.75.75 0 0 1-.75.75H20a2 2 0 1 0 0 4h.25a.75.75 0 0 1 .75.75V20a1 1 0 0 1-1 1h-3.25a.75.75 0 0 1-.75-.75V20a2 2 0 1 0-4 0v.25a.75.75 0 0 1-.75.75H7a1 1 0 0 1-1-1v-4.25a.75.75 0 0 0-.75-.75H5a2 2 0 1 1 0-4h.25a.75.75 0 0 0 .75-.75V7a1 1 0 0 1 1-1h4.25a.75.75 0 0 0 .75-.75V5a2 2 0 1 1 4 0v.25c0 .414.336.75.75.75\\\"/></svg>`;\\n\\nconst itag = `<svg\\n        xmlns=\\\"http://www.w3.org/2000/svg\\\"\\n        width=\\\"20\\\"\\n        height=\\\"20\\\"\\n        viewBox=\\\"0 0 24 24\\\"\\n        fill=\\\"none\\\"\\n        stroke=\\\"currentColor\\\"\\n        stroke-width=\\\"2\\\"\\n        stroke-linecap=\\\"round\\\"\\n        stroke-linejoin=\\\"round\\\"\\n        class=\\\"text-yellow-500\\\"\\n      >\\n        <path\\n          d=\\\"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z\\\"\\n        ></path>\\n        <path d=\\\"M7 7h.01\\\"></path>\\n      </svg>`;\\n\\nconst itiddler = `<svg\\n        xmlns=\\\"http://www.w3.org/2000/svg\\\"\\n        width=\\\"20\\\"\\n        height=\\\"20\\\"\\n        viewBox=\\\"0 0 24 24\\\"\\n        fill=\\\"none\\\"\\n        stroke=\\\"currentColor\\\"\\n        stroke-width=\\\"2\\\"\\n        stroke-linecap=\\\"round\\\"\\n        stroke-linejoin=\\\"round\\\"\\n        class=\\\"text-blue-500\\\"\\n      >\\n        <path\\n          d=\\\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\\\"\\n        ></path>\\n        <polyline points=\\\"14 2 14 8 20 8\\\"></polyline>\\n      </svg>`;\\nconst ihg = `<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\"><g><path fill=\\\"currentColor\\\" d=\\\"M7 3H17V7.2L12 12L7 7.2V3Z\\\"><animate id=\\\"eosIconsHourglass0\\\" fill=\\\"freeze\\\" attributeName=\\\"opacity\\\" begin=\\\"0;eosIconsHourglass1.end\\\" dur=\\\"2s\\\" from=\\\"1\\\" to=\\\"0\\\" class=\\\"text-gray-500\\\" /></path><path fill=\\\"currentColor\\\" d=\\\"M17 21H7V16.8L12 12L17 16.8V21Z\\\"><animate fill=\\\"freeze\\\" attributeName=\\\"opacity\\\" begin=\\\"0;eosIconsHourglass1.end\\\" dur=\\\"2s\\\" from=\\\"0\\\" to=\\\"1\\\"/></path><path fill=\\\"currentColor\\\" d=\\\"M6 2V8H6.01L6 8.01L10 12L6 16L6.01 16.01H6V22H18V16.01H17.99L18 16L14 12L18 8.01L17.99 8H18V2H6ZM16 16.5V20H8V16.5L12 12.5L16 16.5ZM12 11.5L8 7.5V4H16V7.5L12 11.5Z\\\"/><animateTransform id=\\\"eosIconsHourglass1\\\" attributeName=\\\"transform\\\" attributeType=\\\"XML\\\" begin=\\\"eosIconsHourglass0.end\\\" dur=\\\"0.5s\\\" from=\\\"0 12 12\\\" to=\\\"180 12 12\\\" type=\\\"rotate\\\"/></g></svg>`;\\n\\nconst iversion = `<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"text-purple-500\\\" > <path d=\\\"m12 14 4-4\\\"></path> <path d=\\\"M3.34 19a10 10 0 1 1 17.32 0\\\"></path> </svg>`;\\n\\nconst app = () => {\\n  const component = {\\n    setup() {\\n      const tiddlers = ref(getString('[!is[system]]').length);\\n      const update = ref(\\n        getString(\\n          '[!is[system]!prefix[$:/]!has[draft.of]!sort[modified]limit[1]get[modified]format:relativedate[]]',\\n        )[0],\\n      );\\n      return {\\n        textItems: {\\n          version: {\\n            text: 'Version',\\n            color: 'purple',\\n            number: version,\\n            icon: iversion,\\n            title: 'version',\\n          },\\n          update: {\\n            text: 'Update',\\n            color: 'red',\\n            number: update,\\n            icon: iinfo,\\n            title: 'update',\\n          },\\n          plugins: {\\n            text: 'Plugins',\\n            color: 'green',\\n            number: plugins,\\n            icon: iplugin,\\n            title: 'plugin',\\n          },\\n          tags: {\\n            text: 'Tags',\\n            color: 'yellow',\\n            number: tags,\\n            icon: itag,\\n            title: 'tag',\\n          },\\n          tiddlers: {\\n            text: 'Tiddlers',\\n            color: 'blue',\\n            number: tiddlers,\\n            icon: itiddler,\\n            title: 'tiddler',\\n          },\\n          startup: {\\n            text: 'Startup',\\n            color: 'blue',\\n            number: startup,\\n            icon: ihg,\\n            title: 'tiddler',\\n          },\\n        },\\n      };\\n    },\\n\\n    methods: {\\n      gotoTiddler(e) {\\n        const target = e.target.parentNode.dataset.title;\\n        if (!target) return;\\n        switch (target) {\\n          case 'plugin':\\n            goto.navigateTiddler('$:/core/ui/ControlPanel/Plugins');\\n            break;\\n          default:\\n            goto.navigateTiddler('$:/ControlPanel');\\n            break;\\n        }\\n      },\\n    },\\n\\n    template: getTemplate('$:/plugins/oeyoews/vue-info/templates/widget.vue'),\\n  };\\n  return component;\\n};\\n\\nmodule.exports = app;\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/vue-info/widget.js\":{\"title\":\"$:/plugins/oeyoews/vue-info/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/vue-info/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nvue-info widget\\n\\n\\\\*/\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\n\\nclass InfoWidget extends Widget {\\n  constructor(parseTreeNode, options) {\\n    super(parseTreeNode, options);\\n  }\\n\\n  render(parent, nextSibling) {\\n    if (!$tw.browser) return;\\n\\n    this.computeAttributes();\\n    this.execute();\\n\\n    const ssr = this.document.isTiddlyWikiFakeDom;\\n    if (ssr) return;\\n\\n    const vuelib = '$:/plugins/oeyoews/neotw-vue3/vue.global.prod.js';\\n\\n    if (!window.Vue) {\\n      window.Vue = require(vuelib);\\n    }\\n    const { createApp } = window.Vue;\\n    const component = require('./component');\\n\\n    const domNode = this.document.createElement('div');\\n    const getTemplate = require('$:/plugins/oeyoews/neotw-vue3/getTemplate');\\n    const TextTemplate = getTemplate(\\n      '$:/plugins/oeyoews/vue-info/templates/Text.vue',\\n    );\\n    try {\\n      /** @type {{ use: Function; component: Function }} */\\n      const app = createApp(component());\\n\\n      const CountTo = require('./components/count');\\n      const Text = {\\n        template: TextTemplate,\\n        components: { CountTo },\\n        props: {\\n          text: { type: String },\\n          icon: { type: String },\\n          color: { type: String },\\n          number: { type: [Number, String] },\\n        },\\n      };\\n\\n      app.component('Text', Text);\\n      app.component('CountTo', CountTo);\\n\\n      app.config.errorHandler = (err) => {\\n        const text = `[Vue3](${app.version}): ` + err;\\n        console.error(text);\\n        domNode.textContent = text;\\n        domNode.style.color = 'red';\\n      };\\n\\n      // 挂载\\n      app.mount(domNode);\\n\\n      parent.insertBefore(domNode, nextSibling);\\n      this.domNodes.push(domNode);\\n    } catch (e) {\\n      console.error(e.message);\\n    }\\n  }\\n}\\n\\n/** @description vue-info widget */\\nexports['vue-neotw-info'] = InfoWidget;\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}